---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:29
Job ID:    2266829
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:34
Job ID:    2266829
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.058 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 20.981 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 17.331 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 92.029 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.993 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.104 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   13.918020	   12.380543	
   10.000000	    6.081980	   12.380543	
   10.000000	    6.081980	    7.619457	
   10.000000	   13.918020	    7.619457	
   10.000000	   12.152481	   11.322735	
   10.000000	    7.847519	   11.322735	
   10.000000	    7.847519	    8.677265	
   10.000000	   12.152481	    8.677265	
   10.000000	   10.000000	   12.662987	
   10.000000	   10.000000	    7.337013	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.186 ms
Set up communicators.

--set up spincomm took 2.340 ms

--set up kptcomm took 0.360 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 23, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 23 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 23, mbQ = nbQ = 64
rank = 0, nr_Hp = 23, nc_Hp = 23
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.299 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.617 ms

Calculate_SplineDerivRadFun took 0.200 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.847 ms.
time spent on vectorized spline interp: 2.939 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.779 ms.
time spent on vectorized spline interp: 2.016 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.526 ms.
time spent on vectorized spline interp: 1.791 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.603 ms.

Calculating rb for all atom types took 16.512 ms
----------------------
Estimated memory usage
Total: 1.36 GB
orbitals             : 1.03 GB
global sized vectors : 213.62 MB
subspace matrices : 12.40 kB
others : 126.65 MB
----------------------------------------------
Estimated memory usage per processor: 116.10 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.058 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -30.0000000213342, sum_int_rho = 29.5792404108892
PosCharge = 30.000000021334, NegCharge = -29.579240410889, scal_fac = 1.014224828109
After scaling, int_rho = 30.0000000213342, PosCharge + NegCharge - NetCharge = -3.908e-14
--Calculate Vref took 0.672 ms
--Calculate rho_guess took 3.995 ms

 integral of b = -30.0000000213342,
 int{b} + Nelectron + NetCharge = -2.133e-08,
 Esc = -80.3550376776725,
 MPI_Reduce took 8.747 ms

Calculating b & b_ref took 21.920 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.064 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.115 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.076 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.612 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.006 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.007 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.002 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.008 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 47.962 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133408, int_b + int_rho = -2.838e-13, checking this took 0.089 ms
2-norm of RHS = 761.9113271653224, which took 0.406 ms

iter_count = 420, r_2norm = 7.114e-04, tol*||rhs|| = 7.619e-04

Anderson update took 267.057 ms, out of which F'*F took 119.369 ms; b-Ax took 796.914 ms, out of which Lap took 710.075 ms
Solving Poisson took 1756.425 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.391 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.822 ms
Total time for convolution: 	 convolve: 5.191344 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.823 ms
Total time for convolution: 	 convolve: 5.196754 
Total time for convolution: 	 convolve: 5.166665 
Total time for convolution: 	 convolve: 5.172762 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 2.612 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.232 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.463 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
rank = 0, XC calculation took 24708.907 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 4.959 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.118 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.207 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.157 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.863 ms
    Lanczos iter 54, eigmin  = -0.989955822, eigmax = 264.940150507, err_eigmin = 5.594e-04, err_eigmax = 9.967e-03
rank =   0, Lanczos took 150.993 ms, eigmin = -0.989955822420, eigmax = 267.589552012335

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.249798, lowerbound = -1.089956, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1810.322 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 24.213 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.559 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 27.804 ms
rank =  0, finding HY took 29.377 ms
rank =  0, distributing HY into block cyclic form took 24.243 ms
rank =  0, finding Y'*HY took 6.610 ms
Rank 0, Project_Hamiltonian used 88.104 ms
Total time for projection: 88.154 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.872 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.317 ms
rank = 0, Solve_Generalized_EigenProblem used 1.194 ms
    first calculated eigval = 2.695086488325838
    last  calculated eigval = 3.256139334616799
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =   2.86501620651554
lambda[   7] =   2.87437270522976
lambda[   8] =   2.89491094562644
lambda[   9] =   2.93072675114729
lambda[  10] =   2.95427778917662
lambda[  11] =   2.96623231456621
lambda[  12] =   2.98291296391370
lambda[  13] =   3.00125927502573
lambda[  14] =   3.02493816661038
lambda[  15] =   3.05686505213918
lambda[  16] =   3.07125422937819
lambda[  17] =   3.09374855729867
lambda[  18] =   3.12745686341250
lambda[  19] =   3.15465912609864
lambda[  20] =   3.16245472170443
lambda[  21] =   3.17684761047130
lambda[  22] =   3.21676048530488
lambda[  23] =   3.25613933461680
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 1.220 ms
rank =  0, subspace rotation using ScaLAPACK took 10.181 ms
rank =  0, Distributing orbital back into band + domain format took 22.529 ms
rank = 0, Subspace_Rotation used 32.761 ms

Total time for subspace rotation: 32.766 ms
rank = 0, Efermi =   3.064059640845 calculate fermi energy took 0.066 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.356139, lowerbound = -1.089956, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1794.800 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 22.609 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.318 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.965 ms
rank =  0, finding HY took 29.191 ms
rank =  0, distributing HY into block cyclic form took 21.874 ms
rank =  0, finding Y'*HY took 6.164 ms
Rank 0, Project_Hamiltonian used 83.251 ms
Total time for projection: 83.257 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.232 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.122 ms
rank = 0, Solve_Generalized_EigenProblem used 0.359 ms
    first calculated eigval = -0.844679010914708
    last  calculated eigval = 0.463066055493830
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.24179508867270
lambda[   7] =  -0.20520144698949
lambda[   8] =  -0.16658020531978
lambda[   9] =  -0.10648149936600
lambda[  10] =  -0.00346632264744
lambda[  11] =   0.04446706185299
lambda[  12] =   0.14100542873737
lambda[  13] =   0.20080116921712
lambda[  14] =   0.26722851907538
lambda[  15] =   0.28879828880871
lambda[  16] =   0.30757692919979
lambda[  17] =   0.32204961869452
lambda[  18] =   0.34107238339963
lambda[  19] =   0.36318657038177
lambda[  20] =   0.38209248462540
lambda[  21] =   0.40357510229488
lambda[  22] =   0.42502281659132
lambda[  23] =   0.46306605549383
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.369 ms
rank =  0, subspace rotation using ScaLAPACK took 10.118 ms
rank =  0, Distributing orbital back into band + domain format took 22.552 ms
rank = 0, Subspace_Rotation used 32.705 ms

Total time for subspace rotation: 32.711 ms
rank = 0, Efermi =   0.298187536069 calculate fermi energy took 0.035 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.563066, lowerbound = -1.089956, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1797.835 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 22.801 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.636 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.472 ms
rank =  0, finding HY took 29.210 ms
rank =  0, distributing HY into block cyclic form took 21.929 ms
rank =  0, finding Y'*HY took 5.826 ms
Rank 0, Project_Hamiltonian used 83.507 ms
Total time for projection: 83.511 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.251 ms
    first calculated eigval = -0.993108535059799
    last  calculated eigval = 0.165922931536453
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.56728850578186
lambda[   7] =  -0.56159509258804
lambda[   8] =  -0.52416275091598
lambda[   9] =  -0.48175345176430
lambda[  10] =  -0.44813094893367
lambda[  11] =  -0.43237459535591
lambda[  12] =  -0.35863131536701
lambda[  13] =  -0.33676346203819
lambda[  14] =  -0.28461025947399
lambda[  15] =  -0.20124452694373
lambda[  16] =  -0.10107506634894
lambda[  17] =  -0.08367117304511
lambda[  18] =   0.07916524904307
lambda[  19] =   0.08121691563859
lambda[  20] =   0.09767888799348
lambda[  21] =   0.11433140979753
lambda[  22] =   0.13723741366269
lambda[  23] =   0.16592293153645
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.260 ms
rank =  0, subspace rotation using ScaLAPACK took 10.104 ms
rank =  0, Distributing orbital back into band + domain format took 22.849 ms
rank = 0, Subspace_Rotation used 32.986 ms

Total time for subspace rotation: 32.990 ms
rank = 0, Efermi =  -0.130183298777 calculate fermi energy took 0.038 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.265923, lowerbound = -1.089956, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1820.338 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 22.468 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.418 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.921 ms
rank =  0, finding HY took 29.401 ms
rank =  0, distributing HY into block cyclic form took 22.072 ms
rank =  0, finding Y'*HY took 5.999 ms
Rank 0, Project_Hamiltonian used 83.443 ms
Total time for projection: 83.449 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.163 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.104 ms
rank = 0, Solve_Generalized_EigenProblem used 0.272 ms
    first calculated eigval = -0.993507889644210
    last  calculated eigval = 0.100525130373479
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.57919718104550
lambda[   7] =  -0.57019677547902
lambda[   8] =  -0.53448893288161
lambda[   9] =  -0.48961369719978
lambda[  10] =  -0.45439535458652
lambda[  11] =  -0.44637373306271
lambda[  12] =  -0.37506420831473
lambda[  13] =  -0.36652779480326
lambda[  14] =  -0.32415054147817
lambda[  15] =  -0.31323676325227
lambda[  16] =  -0.16277631927847
lambda[  17] =  -0.12962125979964
lambda[  18] =   0.01792176981206
lambda[  19] =   0.02609536349019
lambda[  20] =   0.04552159653899
lambda[  21] =   0.06838481898259
lambda[  22] =   0.08861970944711
lambda[  23] =   0.10052513037348
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.281 ms
rank =  0, subspace rotation using ScaLAPACK took 10.145 ms
rank =  0, Distributing orbital back into band + domain format took 23.282 ms
rank = 0, Subspace_Rotation used 33.478 ms

Total time for subspace rotation: 33.484 ms
rank = 0, Efermi =  -0.191884551778 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 6.491 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.628 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.570 ms
rank = 0, Calculating density took 7869.004 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.125 ms
rank = 0, D2D took 2.228 ms
rank = 0, Transfering density took 2.235 ms
Etot    =   -47.303418328853
Eband   =   -17.172709387009
E1      =    34.899432663508
E2      =   -13.675593951924
E3      =   -17.022958735060
Exc     =   -15.373656614024
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 4.730e+00, dEband = 1.717e+00
rank = 0, Calculating/Estimating energy took 1.004 ms, Etot = -47.303418329, dEtot = 4.730e+00, dEband = 1.717e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 57.7793377182681, which took 0.106 ms

iter_count = 96, r_2norm = 1.666e-03, tol*||rhs|| = 2.311e-03

Anderson update took 56.247 ms, out of which F'*F took 26.140 ms; b-Ax took 177.510 ms, out of which Lap took 157.803 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 400.553 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133424, int_b + int_rho = -1.201e-13, checking this took 0.112 ms
2-norm of RHS = 757.4462966129630, which took 1.034 ms

iter_count = 282, r_2norm = 7.159e-04, tol*||rhs|| = 7.574e-04

Anderson update took 165.624 ms, out of which F'*F took 77.086 ms; b-Ax took 524.930 ms, out of which Lap took 467.892 ms
Solving Poisson took 1164.526 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.404 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.256920 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.204 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.309194 
Total time for convolution: 	 convolve: 5.216178 
Total time for convolution: 	 convolve: 5.213405 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.401 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.381 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.540 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.301 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.880 ms

This SCF took 34551.375 ms, scf error = 1.794e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.200525, lowerbound = -0.993508, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1801.342 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 22.519 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.576 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.139 ms
rank =  0, finding HY took 29.520 ms
rank =  0, distributing HY into block cyclic form took 53.079 ms
rank =  0, finding Y'*HY took 5.644 ms
Rank 0, Project_Hamiltonian used 114.437 ms
Total time for projection: 114.468 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.201 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.307 ms
    first calculated eigval = -0.968329651251392
    last  calculated eigval = 0.073173339451359
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.54732643807559
lambda[   7] =  -0.54491749535358
lambda[   8] =  -0.51012866339128
lambda[   9] =  -0.46433796702792
lambda[  10] =  -0.43575859048852
lambda[  11] =  -0.41983099271681
lambda[  12] =  -0.35485903011783
lambda[  13] =  -0.33653615107935
lambda[  14] =  -0.30582862970042
lambda[  15] =  -0.28499396092366
lambda[  16] =  -0.14423314581387
lambda[  17] =  -0.11428260100395
lambda[  18] =  -0.01472062718716
lambda[  19] =   0.01603730958440
lambda[  20] =   0.02623721102257
lambda[  21] =   0.03895242489163
lambda[  22] =   0.05938700184024
lambda[  23] =   0.07317333945136
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.324 ms
rank =  0, subspace rotation using ScaLAPACK took 10.262 ms
rank =  0, Distributing orbital back into band + domain format took 22.721 ms
rank = 0, Subspace_Rotation used 33.016 ms

Total time for subspace rotation: 33.022 ms
rank = 0, Efermi =  -0.173341378233 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 6.545 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.761 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.845 ms
rank = 0, Calculating density took 1969.629 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.950 ms
rank = 0, D2D took 2.055 ms
rank = 0, Transfering density took 2.061 ms
Etot    =   -47.249901790608
Eband   =   -16.402070356756
E1      =    34.197299543771
E2      =   -13.622752087233
E3      =   -17.227456287088
Exc     =   -15.540301673632
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 5.352e-03, dEband = 7.706e-02
rank = 0, Calculating/Estimating energy took 0.998 ms, Etot = -47.249901791, dEtot = 5.352e-03, dEband = 7.706e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 13.9952309722259, which took 0.103 ms

iter_count = 102, r_2norm = 5.401e-04, tol*||rhs|| = 5.598e-04

Anderson update took 60.122 ms, out of which F'*F took 27.744 ms; b-Ax took 189.743 ms, out of which Lap took 168.916 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 432.447 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133409, int_b + int_rho = -2.765e-13, checking this took 0.101 ms
2-norm of RHS = 750.2502647634770, which took 0.144 ms

iter_count = 306, r_2norm = 6.600e-04, tol*||rhs|| = 7.503e-04

Anderson update took 182.928 ms, out of which F'*F took 84.332 ms; b-Ax took 572.750 ms, out of which Lap took 513.673 ms
Solving Poisson took 1272.362 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.222391 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.247071 
Total time for convolution: 	 convolve: 5.268660 
Total time for convolution: 	 convolve: 5.265721 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.387 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.533 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.892 ms

This SCF took 28857.689 ms, scf error = 1.256e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.173173, lowerbound = -0.968330, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1797.287 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 22.435 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.254 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.723 ms
rank =  0, finding HY took 29.543 ms
rank =  0, distributing HY into block cyclic form took 22.496 ms
rank =  0, finding Y'*HY took 5.453 ms
Rank 0, Project_Hamiltonian used 84.284 ms
Total time for projection: 84.305 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.191 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.289 ms
    first calculated eigval = -0.912416286466568
    last  calculated eigval = 0.065296520465413
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.48715404015232
lambda[   7] =  -0.47821375575422
lambda[   8] =  -0.45391999670652
lambda[   9] =  -0.40626362030105
lambda[  10] =  -0.39501488127169
lambda[  11] =  -0.35972537262333
lambda[  12] =  -0.31024059294774
lambda[  13] =  -0.27163883504018
lambda[  14] =  -0.26401990193205
lambda[  15] =  -0.21857482536978
lambda[  16] =  -0.09761169360294
lambda[  17] =  -0.07279130789870
lambda[  18] =  -0.02554166179860
lambda[  19] =   0.01630565469771
lambda[  20] =   0.02349922683673
lambda[  21] =   0.02744714120274
lambda[  22] =   0.05037615783044
lambda[  23] =   0.06529652046541
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.345 ms
rank =  0, subspace rotation using ScaLAPACK took 10.262 ms
rank =  0, Distributing orbital back into band + domain format took 23.403 ms
rank = 0, Subspace_Rotation used 33.701 ms

Total time for subspace rotation: 33.705 ms
rank = 0, Efermi =  -0.126719926090 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.496 ms
rank = 0, --- Calculate rho: reduce over all band groups took 15.496 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.544 ms
rank = 0, Calculating density took 1937.318 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.919 ms
rank = 0, D2D took 2.026 ms
rank = 0, Transfering density took 2.033 ms
Etot    =   -47.187717461590
Eband   =   -14.681304735480
E1      =    32.731155294035
E2      =   -13.334678140136
E3      =   -17.732213968186
Exc     =   -15.949422450154
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 6.218e-03, dEband = 1.721e-01
rank = 0, Calculating/Estimating energy took 1.018 ms, Etot = -47.187717462, dEtot = 6.218e-03, dEband = 1.721e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 8.5436446183576, which took 0.056 ms

iter_count = 102, r_2norm = 2.536e-04, tol*||rhs|| = 3.417e-04

Anderson update took 59.252 ms, out of which F'*F took 27.719 ms; b-Ax took 191.384 ms, out of which Lap took 170.416 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 432.602 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133415, int_b + int_rho = -2.183e-13, checking this took 0.129 ms
2-norm of RHS = 751.5416841282004, which took 0.163 ms

iter_count = 246, r_2norm = 6.777e-04, tol*||rhs|| = 7.515e-04

Anderson update took 147.192 ms, out of which F'*F took 71.759 ms; b-Ax took 509.313 ms, out of which Lap took 459.730 ms
Solving Poisson took 1078.917 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.200462 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.247236 
Total time for convolution: 	 convolve: 5.213469 
Total time for convolution: 	 convolve: 5.239093 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.390 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
---Transfer Veff_loc: D2D took 3.610 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.223 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.881 ms

This SCF took 28525.279 ms, scf error = 3.032e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.165297, lowerbound = -0.912416, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1806.903 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 22.632 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 10.344 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 33.004 ms
rank =  0, finding HY took 25.686 ms
rank =  0, distributing HY into block cyclic form took 22.643 ms
rank =  0, finding Y'*HY took 5.874 ms
Rank 0, Project_Hamiltonian used 87.291 ms
Total time for projection: 87.322 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.187 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.117 ms
rank = 0, Solve_Generalized_EigenProblem used 0.308 ms
    first calculated eigval = -0.911078874660331
    last  calculated eigval = 0.061219077070737
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.48361872218361
lambda[   7] =  -0.47679472863778
lambda[   8] =  -0.44939187385552
lambda[   9] =  -0.40163940610288
lambda[  10] =  -0.39378590145600
lambda[  11] =  -0.35648529739489
lambda[  12] =  -0.31050720146247
lambda[  13] =  -0.27260678719780
lambda[  14] =  -0.26133799546161
lambda[  15] =  -0.21825064828400
lambda[  16] =  -0.09772842127458
lambda[  17] =  -0.07029053687459
lambda[  18] =  -0.02809356375740
lambda[  19] =   0.01438483723145
lambda[  20] =   0.01972110077219
lambda[  21] =   0.02275955272925
lambda[  22] =   0.04355827913047
lambda[  23] =   0.06121907707074
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.328 ms
rank =  0, subspace rotation using ScaLAPACK took 10.201 ms
rank =  0, Distributing orbital back into band + domain format took 23.178 ms
rank = 0, Subspace_Rotation used 33.415 ms

Total time for subspace rotation: 33.420 ms
rank = 0, Efermi =  -0.126836653812 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 6.968 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.514 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.986 ms
rank = 0, Calculating density took 1948.605 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.014 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.121 ms
rank = 0, D2D took 2.235 ms
rank = 0, Transfering density took 2.244 ms
Etot    =   -47.186086661918
Eband   =   -14.621137446523
E1      =    32.739345844161
E2      =   -13.262638170010
E3      =   -17.743626414082
Exc     =   -15.955521965336
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 1.631e-04, dEband = 6.017e-03
rank = 0, Calculating/Estimating energy took 0.985 ms, Etot = -47.186086662, dEtot = 1.631e-04, dEband = 6.017e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 2.2032658860997, which took 0.050 ms

iter_count = 108, r_2norm = 8.373e-05, tol*||rhs|| = 8.813e-05

Anderson update took 69.278 ms, out of which F'*F took 30.515 ms; b-Ax took 208.671 ms, out of which Lap took 186.039 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 471.464 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133406, int_b + int_rho = -3.056e-13, checking this took 0.133 ms
2-norm of RHS = 752.7053769969770, which took 0.133 ms

iter_count = 258, r_2norm = 7.109e-04, tol*||rhs|| = 7.527e-04

Anderson update took 152.884 ms, out of which F'*F took 72.585 ms; b-Ax took 494.606 ms, out of which Lap took 442.373 ms
Solving Poisson took 1076.597 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.239690 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.392 ms
Total time for convolution: 	 convolve: 5.222991 
Total time for convolution: 	 convolve: 5.250922 
Total time for convolution: 	 convolve: 5.272401 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.391 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 3.564 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.744 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.348 ms

This SCF took 28660.071 ms, scf error = 1.711e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.161219, lowerbound = -0.911079, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1802.922 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 22.584 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.591 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.203 ms
rank =  0, finding HY took 29.136 ms
rank =  0, distributing HY into block cyclic form took 22.166 ms
rank =  0, finding Y'*HY took 5.870 ms
Rank 0, Project_Hamiltonian used 83.438 ms
Total time for projection: 83.461 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.185 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.105 ms
rank = 0, Solve_Generalized_EigenProblem used 0.296 ms
    first calculated eigval = -0.905530528523218
    last  calculated eigval = 0.059112807690132
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47655879954701
lambda[   7] =  -0.47108742355209
lambda[   8] =  -0.44162841982993
lambda[   9] =  -0.39398675363297
lambda[  10] =  -0.38947868253995
lambda[  11] =  -0.34942180977196
lambda[  12] =  -0.30672424088665
lambda[  13] =  -0.26804732232240
lambda[  14] =  -0.25662621757042
lambda[  15] =  -0.21293865562706
lambda[  16] =  -0.09408690568311
lambda[  17] =  -0.06553708104714
lambda[  18] =  -0.02860455654239
lambda[  19] =   0.01376167264294
lambda[  20] =   0.01769690593068
lambda[  21] =   0.02145636767159
lambda[  22] =   0.04018323998903
lambda[  23] =   0.05911280769013
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.315 ms
rank =  0, subspace rotation using ScaLAPACK took 10.149 ms
rank =  0, Distributing orbital back into band + domain format took 25.702 ms
rank = 0, Subspace_Rotation used 35.880 ms

Total time for subspace rotation: 35.885 ms
rank = 0, Efermi =  -0.123195138248 calculate fermi energy took 1.134 ms
rank = 0, --- Calculate rho: sum over local bands took 6.514 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.102 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 1943.006 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.915 ms
rank = 0, D2D took 2.013 ms
rank = 0, Transfering density took 2.016 ms
Etot    =   -47.184405930626
Eband   =   -14.446324164897
E1      =    32.667692773774
E2      =   -13.148355360520
E3      =   -17.787421332127
Exc     =   -15.986513553838
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 1.681e-04, dEband = 1.748e-02
rank = 0, Calculating/Estimating energy took 0.997 ms, Etot = -47.184405931, dEtot = 1.681e-04, dEband = 1.748e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7621564227313, which took 0.062 ms

iter_count = 114, r_2norm = 2.168e-05, tol*||rhs|| = 3.049e-05

Anderson update took 72.003 ms, out of which F'*F took 32.247 ms; b-Ax took 221.927 ms, out of which Lap took 200.485 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.603 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133414, int_b + int_rho = -2.256e-13, checking this took 0.117 ms
2-norm of RHS = 752.9905547082968, which took 0.158 ms

iter_count = 240, r_2norm = 6.896e-04, tol*||rhs|| = 7.530e-04

Anderson update took 144.964 ms, out of which F'*F took 67.686 ms; b-Ax took 449.358 ms, out of which Lap took 403.747 ms
Solving Poisson took 992.577 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.919 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.215868 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.380 ms
Total time for convolution: 	 convolve: 5.241906 
Total time for convolution: 	 convolve: 5.234624 
Total time for convolution: 	 convolve: 5.242904 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.398 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 3.510 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.018 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.578 ms

This SCF took 28516.237 ms, scf error = 6.208e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.159113, lowerbound = -0.905531, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1808.964 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.146 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.736 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.918 ms
rank =  0, finding HY took 29.023 ms
rank =  0, distributing HY into block cyclic form took 22.573 ms
rank =  0, finding Y'*HY took 5.650 ms
Rank 0, Project_Hamiltonian used 83.215 ms
Total time for projection: 83.239 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.151 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.106 ms
rank = 0, Solve_Generalized_EigenProblem used 0.262 ms
    first calculated eigval = -0.901155654279584
    last  calculated eigval = 0.056655269335032
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47295082106339
lambda[   7] =  -0.46705002868344
lambda[   8] =  -0.43838956491925
lambda[   9] =  -0.39092413824503
lambda[  10] =  -0.38599130715216
lambda[  11] =  -0.34574016051871
lambda[  12] =  -0.30241495817065
lambda[  13] =  -0.26273583132594
lambda[  14] =  -0.25424446906563
lambda[  15] =  -0.20825448776930
lambda[  16] =  -0.09032159978796
lambda[  17] =  -0.06302918655971
lambda[  18] =  -0.02879298036894
lambda[  19] =   0.01323258698114
lambda[  20] =   0.01648088718114
lambda[  21] =   0.02127037384105
lambda[  22] =   0.03779336320516
lambda[  23] =   0.05665526933503
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.280 ms
rank =  0, subspace rotation using ScaLAPACK took 10.168 ms
rank =  0, Distributing orbital back into band + domain format took 22.851 ms
rank = 0, Subspace_Rotation used 33.054 ms

Total time for subspace rotation: 33.060 ms
rank = 0, Efermi =  -0.119429832297 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 6.796 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.898 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.578 ms
rank = 0, Calculating density took 1944.972 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.883 ms
rank = 0, D2D took 1.991 ms
rank = 0, Transfering density took 1.993 ms
Etot    =   -47.183866813313
Eband   =   -14.331083528063
E1      =    32.609134017310
E2      =   -13.085865607027
E3      =   -17.809586712464
Exc     =   -16.002331943738
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 5.391e-05, dEband = 1.152e-02
rank = 0, Calculating/Estimating energy took 1.013 ms, Etot = -47.183866813, dEtot = 5.391e-05, dEband = 1.152e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6365482612210, which took 0.142 ms

iter_count = 108, r_2norm = 2.218e-05, tol*||rhs|| = 2.546e-05

Anderson update took 63.340 ms, out of which F'*F took 29.639 ms; b-Ax took 202.576 ms, out of which Lap took 178.764 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.219 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133420, int_b + int_rho = -1.673e-13, checking this took 0.900 ms
2-norm of RHS = 753.3292720029876, which took 0.171 ms

iter_count = 240, r_2norm = 6.468e-04, tol*||rhs|| = 7.533e-04

Anderson update took 140.642 ms, out of which F'*F took 65.769 ms; b-Ax took 459.982 ms, out of which Lap took 409.408 ms
Solving Poisson took 1015.020 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.251680 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.233163 
Total time for convolution: 	 convolve: 5.240861 
Total time for convolution: 	 convolve: 5.237929 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.877 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.630 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.382 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.420 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.424 ms
---Transfer Veff_loc: D2D took 3.498 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.284 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.822 ms

This SCF took 28552.090 ms, scf error = 3.435e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.156655, lowerbound = -0.901156, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1798.404 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.485 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.672 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.195 ms
rank =  0, finding HY took 28.882 ms
rank =  0, distributing HY into block cyclic form took 22.274 ms
rank =  0, finding Y'*HY took 5.722 ms
Rank 0, Project_Hamiltonian used 83.131 ms
Total time for projection: 83.155 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.187 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.293 ms
    first calculated eigval = -0.897999710312220
    last  calculated eigval = 0.053866533975996
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46991875924649
lambda[   7] =  -0.46394961713195
lambda[   8] =  -0.43561997055321
lambda[   9] =  -0.38806243348217
lambda[  10] =  -0.38310076929485
lambda[  11] =  -0.34294906121459
lambda[  12] =  -0.29948308816611
lambda[  13] =  -0.25947410042601
lambda[  14] =  -0.25148401765146
lambda[  15] =  -0.20513085659714
lambda[  16] =  -0.08763262058489
lambda[  17] =  -0.06028159323980
lambda[  18] =  -0.02822382791687
lambda[  19] =   0.01320511744882
lambda[  20] =   0.01694907909675
lambda[  21] =   0.02196278447619
lambda[  22] =   0.03742739819212
lambda[  23] =   0.05386653397600
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.331 ms
rank =  0, subspace rotation using ScaLAPACK took 10.128 ms
rank =  0, Distributing orbital back into band + domain format took 22.590 ms
rank = 0, Subspace_Rotation used 32.750 ms

Total time for subspace rotation: 32.755 ms
rank = 0, Efermi =  -0.116740853158 calculate fermi energy took 0.086 ms
rank = 0, --- Calculate rho: sum over local bands took 6.753 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.084 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1934.339 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.909 ms
rank = 0, D2D took 2.009 ms
rank = 0, Transfering density took 2.012 ms
Etot    =   -47.183570318919
Eband   =   -14.241218085027
E1      =    32.572249741223
E2      =   -13.029618964175
E3      =   -17.819513475049
Exc     =   -16.008696736026
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 2.965e-05, dEband = 8.987e-03
rank = 0, Calculating/Estimating energy took 1.024 ms, Etot = -47.183570319, dEtot = 2.965e-05, dEband = 8.987e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2834563756217, which took 0.057 ms

iter_count = 114, r_2norm = 7.630e-06, tol*||rhs|| = 1.134e-05

Anderson update took 66.986 ms, out of which F'*F took 31.276 ms; b-Ax took 211.890 ms, out of which Lap took 189.000 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 480.395 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133404, int_b + int_rho = -3.274e-13, checking this took 0.113 ms
2-norm of RHS = 753.3004167790548, which took 0.094 ms

iter_count = 228, r_2norm = 6.188e-04, tol*||rhs|| = 7.533e-04

Anderson update took 132.980 ms, out of which F'*F took 62.536 ms; b-Ax took 434.938 ms, out of which Lap took 386.067 ms
Solving Poisson took 955.399 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.208098 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.409 ms
Total time for convolution: 	 convolve: 5.197906 
Total time for convolution: 	 convolve: 5.243579 
Total time for convolution: 	 convolve: 5.351850 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.741 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.583 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.094 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.403 ms
---Transfer Veff_loc: D2D took 3.544 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.249 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.831 ms

This SCF took 28535.339 ms, scf error = 2.072e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.153867, lowerbound = -0.898000, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1801.492 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 22.691 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.672 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.412 ms
rank =  0, finding HY took 28.883 ms
rank =  0, distributing HY into block cyclic form took 22.158 ms
rank =  0, finding Y'*HY took 5.685 ms
Rank 0, Project_Hamiltonian used 83.200 ms
Total time for projection: 83.222 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.166 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.110 ms
rank = 0, Solve_Generalized_EigenProblem used 0.281 ms
    first calculated eigval = -0.895125899625208
    last  calculated eigval = 0.051123660264984
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46727681727951
lambda[   7] =  -0.46093018933250
lambda[   8] =  -0.43328643252358
lambda[   9] =  -0.38561927891903
lambda[  10] =  -0.38051845799253
lambda[  11] =  -0.34045798770101
lambda[  12] =  -0.29673617642716
lambda[  13] =  -0.25624150415394
lambda[  14] =  -0.24903227532361
lambda[  15] =  -0.20207338181652
lambda[  16] =  -0.08501756095758
lambda[  17] =  -0.05781673395128
lambda[  18] =  -0.02720901609164
lambda[  19] =   0.01369150077695
lambda[  20] =   0.01859089226640
lambda[  21] =   0.02296172742537
lambda[  22] =   0.03704086220389
lambda[  23] =   0.05112366026498
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.314 ms
rank =  0, subspace rotation using ScaLAPACK took 10.131 ms
rank =  0, Distributing orbital back into band + domain format took 22.687 ms
rank = 0, Subspace_Rotation used 32.854 ms

Total time for subspace rotation: 32.858 ms
rank = 0, Efermi =  -0.114125793428 calculate fermi energy took 0.121 ms
rank = 0, --- Calculate rho: sum over local bands took 6.739 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.909 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.583 ms
rank = 0, Calculating density took 1937.331 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.975 ms
rank = 0, D2D took 2.072 ms
rank = 0, Transfering density took 2.075 ms
Etot    =   -47.183493088052
Eband   =   -14.158777727600
E1      =    32.525305259567
E2      =   -12.991542262026
E3      =   -17.830309202213
Exc     =   -16.016834405946
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 7.723e-06, dEband = 8.244e-03
rank = 0, Calculating/Estimating energy took 1.235 ms, Etot = -47.183493088, dEtot = 7.723e-06, dEband = 8.244e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1787773870255, which took 0.064 ms

iter_count = 108, r_2norm = 7.066e-06, tol*||rhs|| = 7.151e-06

Anderson update took 63.828 ms, out of which F'*F took 29.557 ms; b-Ax took 206.581 ms, out of which Lap took 183.666 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.180 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133422, int_b + int_rho = -1.455e-13, checking this took 0.107 ms
2-norm of RHS = 753.2881847568387, which took 0.147 ms

iter_count = 216, r_2norm = 7.374e-04, tol*||rhs|| = 7.533e-04

Anderson update took 126.497 ms, out of which F'*F took 60.120 ms; b-Ax took 410.097 ms, out of which Lap took 365.584 ms
Solving Poisson took 901.258 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.211788 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.400 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.396 ms
Total time for convolution: 	 convolve: 5.322769 
Total time for convolution: 	 convolve: 5.215084 
Total time for convolution: 	 convolve: 5.244818 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.585 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.551 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.446 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.035 ms

This SCF took 28456.681 ms, scf error = 1.278e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.151124, lowerbound = -0.895126, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1801.948 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 22.344 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.796 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.175 ms
rank =  0, finding HY took 28.759 ms
rank =  0, distributing HY into block cyclic form took 22.661 ms
rank =  0, finding Y'*HY took 5.547 ms
Rank 0, Project_Hamiltonian used 83.211 ms
Total time for projection: 83.242 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.188 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.291 ms
    first calculated eigval = -0.893596813398097
    last  calculated eigval = 0.049176557703203
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46571832481887
lambda[   7] =  -0.45945498119996
lambda[   8] =  -0.43174353301695
lambda[   9] =  -0.38407529142926
lambda[  10] =  -0.37899605640129
lambda[  11] =  -0.33894927105589
lambda[  12] =  -0.29520715034589
lambda[  13] =  -0.25467173545470
lambda[  14] =  -0.24751740631328
lambda[  15] =  -0.20052702168337
lambda[  16] =  -0.08349245739085
lambda[  17] =  -0.05623672805955
lambda[  18] =  -0.02465161357766
lambda[  19] =   0.01581997216553
lambda[  20] =   0.02191310060485
lambda[  21] =   0.02597785489175
lambda[  22] =   0.03573819274810
lambda[  23] =   0.04917655770320
==subpsace eigenproblem: bcast eigvals took 0.110 ms
Total time for solving subspace eigenvalue problem: 0.411 ms
rank =  0, subspace rotation using ScaLAPACK took 10.204 ms
rank =  0, Distributing orbital back into band + domain format took 22.362 ms
rank = 0, Subspace_Rotation used 32.598 ms

Total time for subspace rotation: 32.604 ms
rank = 0, Efermi =  -0.112600689903 calculate fermi energy took 0.089 ms
rank = 0, --- Calculate rho: sum over local bands took 6.699 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.431 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.597 ms
rank = 0, Calculating density took 1938.180 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.988 ms
rank = 0, D2D took 2.086 ms
rank = 0, Transfering density took 2.089 ms
Etot    =   -47.183547844173
Eband   =   -14.112964738973
E1      =    32.504938340408
E2      =   -12.965666463799
E3      =   -17.831664795240
Exc     =   -16.017815026333
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 5.476e-06, dEband = 4.581e-03
rank = 0, Calculating/Estimating energy took 1.033 ms, Etot = -47.183547844, dEtot = 5.476e-06, dEband = 4.581e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1054461348948, which took 0.055 ms

iter_count = 114, r_2norm = 2.940e-06, tol*||rhs|| = 4.218e-06

Anderson update took 67.690 ms, out of which F'*F took 31.072 ms; b-Ax took 214.495 ms, out of which Lap took 191.311 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.806 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133418, int_b + int_rho = -1.892e-13, checking this took 0.187 ms
2-norm of RHS = 753.2729789077332, which took 0.147 ms

iter_count = 192, r_2norm = 6.525e-04, tol*||rhs|| = 7.533e-04

Anderson update took 111.506 ms, out of which F'*F took 52.999 ms; b-Ax took 365.237 ms, out of which Lap took 324.681 ms
Solving Poisson took 803.028 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.289141 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.250927 
Total time for convolution: 	 convolve: 6.420838 
Total time for convolution: 	 convolve: 5.327730 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.582 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.232 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.859 ms

This SCF took 29629.447 ms, scf error = 6.661e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.149177, lowerbound = -0.893597, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1807.883 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.396 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.764 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.205 ms
rank =  0, finding HY took 28.919 ms
rank =  0, distributing HY into block cyclic form took 22.403 ms
rank =  0, finding Y'*HY took 5.447 ms
Rank 0, Project_Hamiltonian used 83.038 ms
Total time for projection: 83.068 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.164 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.270 ms
    first calculated eigval = -0.892647996644887
    last  calculated eigval = 0.045772225774062
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46482178476014
lambda[   7] =  -0.45851829601327
lambda[   8] =  -0.43088666910643
lambda[   9] =  -0.38320257489212
lambda[  10] =  -0.37811790789234
lambda[  11] =  -0.33807273267041
lambda[  12] =  -0.29430039359746
lambda[  13] =  -0.25372105485928
lambda[  14] =  -0.24667223397321
lambda[  15] =  -0.19959798305292
lambda[  16] =  -0.08258934298749
lambda[  17] =  -0.05537735889892
lambda[  18] =  -0.02294709359701
lambda[  19] =   0.01755112613056
lambda[  20] =   0.02364911970746
lambda[  21] =   0.02812922704824
lambda[  22] =   0.03417109082247
lambda[  23] =   0.04577222577406
==subpsace eigenproblem: bcast eigvals took 0.076 ms
Total time for solving subspace eigenvalue problem: 0.356 ms
rank =  0, subspace rotation using ScaLAPACK took 10.505 ms
rank =  0, Distributing orbital back into band + domain format took 22.828 ms
rank = 0, Subspace_Rotation used 33.373 ms

Total time for subspace rotation: 33.378 ms
rank = 0, Efermi =  -0.111697575428 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 6.636 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.297 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.577 ms
rank = 0, Calculating density took 1944.390 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 1.969 ms
rank = 0, D2D took 2.077 ms
rank = 0, Transfering density took 2.084 ms
Etot    =   -47.183611617768
Eband   =   -14.085795746528
E1      =    32.490251178866
E2      =   -12.952606683261
E3      =   -17.834242427226
Exc     =   -16.019878482281
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 6.377e-06, dEband = 2.717e-03
rank = 0, Calculating/Estimating energy took 1.026 ms, Etot = -47.183611618, dEtot = 6.377e-06, dEband = 2.717e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0841864677571, which took 0.065 ms

iter_count = 114, r_2norm = 2.299e-06, tol*||rhs|| = 3.367e-06

Anderson update took 67.158 ms, out of which F'*F took 31.218 ms; b-Ax took 217.126 ms, out of which Lap took 192.662 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.863 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133427, int_b + int_rho = -1.019e-13, checking this took 0.114 ms
2-norm of RHS = 753.2900175025799, which took 0.101 ms

iter_count = 180, r_2norm = 7.520e-04, tol*||rhs|| = 7.533e-04

Anderson update took 105.564 ms, out of which F'*F took 49.446 ms; b-Ax took 340.704 ms, out of which Lap took 303.403 ms
Solving Poisson took 751.737 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.215013 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.231561 
Total time for convolution: 	 convolve: 5.265089 
Total time for convolution: 	 convolve: 5.228336 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 3.505 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.675 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.221 ms

This SCF took 28237.720 ms, scf error = 4.913e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.145772, lowerbound = -0.892648, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1798.321 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 22.649 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.645 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.331 ms
rank =  0, finding HY took 29.262 ms
rank =  0, distributing HY into block cyclic form took 22.374 ms
rank =  0, finding Y'*HY took 5.520 ms
Rank 0, Project_Hamiltonian used 83.555 ms
Total time for projection: 83.584 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.172 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.273 ms
    first calculated eigval = -0.891939431759303
    last  calculated eigval = 0.042519445458712
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46417674263055
lambda[   7] =  -0.45785311118926
lambda[   8] =  -0.43027629823940
lambda[   9] =  -0.38256947938942
lambda[  10] =  -0.37743507438648
lambda[  11] =  -0.33745611912255
lambda[  12] =  -0.29362227328051
lambda[  13] =  -0.25309419609689
lambda[  14] =  -0.24600764216238
lambda[  15] =  -0.19898029434551
lambda[  16] =  -0.08191925641716
lambda[  17] =  -0.05473231819966
lambda[  18] =  -0.02115977103404
lambda[  19] =   0.01983210112252
lambda[  20] =   0.02496192875913
lambda[  21] =   0.03026336375619
lambda[  22] =   0.03364481431621
lambda[  23] =   0.04251944545871
==subpsace eigenproblem: bcast eigvals took 0.071 ms
Total time for solving subspace eigenvalue problem: 0.354 ms
rank =  0, subspace rotation using ScaLAPACK took 10.118 ms
rank =  0, Distributing orbital back into band + domain format took 22.730 ms
rank = 0, Subspace_Rotation used 32.886 ms

Total time for subspace rotation: 32.892 ms
rank = 0, Efermi =  -0.111027489010 calculate fermi energy took 0.079 ms
rank = 0, --- Calculate rho: sum over local bands took 6.718 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.284 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.568 ms
rank = 0, Calculating density took 1934.918 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.899 ms
rank = 0, D2D took 2.000 ms
rank = 0, Transfering density took 2.004 ms
Etot    =   -47.183684201310
Eband   =   -14.066145827924
E1      =    32.480775038385
E2      =   -12.942136338368
E3      =   -17.835342600815
Exc     =   -16.020754672640
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 7.258e-06, dEband = 1.965e-03
rank = 0, Calculating/Estimating energy took 1.038 ms, Etot = -47.183684201, dEtot = 7.258e-06, dEband = 1.965e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0560443368873, which took 0.080 ms

iter_count = 108, r_2norm = 1.929e-06, tol*||rhs|| = 2.242e-06

Anderson update took 63.041 ms, out of which F'*F took 29.560 ms; b-Ax took 204.314 ms, out of which Lap took 181.859 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.228 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133421, int_b + int_rho = -1.601e-13, checking this took 0.112 ms
2-norm of RHS = 753.3052998799815, which took 0.140 ms

iter_count = 180, r_2norm = 6.210e-04, tol*||rhs|| = 7.533e-04

Anderson update took 104.973 ms, out of which F'*F took 49.425 ms; b-Ax took 338.443 ms, out of which Lap took 300.911 ms
Solving Poisson took 751.038 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.222339 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.251778 
Total time for convolution: 	 convolve: 5.211514 
Total time for convolution: 	 convolve: 5.292226 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.835 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.222 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 3.550 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.285 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.875 ms

This SCF took 28387.732 ms, scf error = 3.378e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.142519, lowerbound = -0.891939, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1808.974 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 25.831 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.476 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 29.349 ms
rank =  0, finding HY took 27.681 ms
rank =  0, distributing HY into block cyclic form took 22.833 ms
rank =  0, finding Y'*HY took 5.459 ms
Rank 0, Project_Hamiltonian used 85.385 ms
Total time for projection: 85.401 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.165 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.065 ms
rank = 0, Solve_Generalized_EigenProblem used 1.260 ms
    first calculated eigval = -0.891222209526049
    last  calculated eigval = 0.040512369189059
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46351347137270
lambda[   7] =  -0.45716186957280
lambda[   8] =  -0.42964584098655
lambda[   9] =  -0.38192018023930
lambda[  10] =  -0.37673936285836
lambda[  11] =  -0.33681803341634
lambda[  12] =  -0.29292733126102
lambda[  13] =  -0.25243537265972
lambda[  14] =  -0.24532883950348
lambda[  15] =  -0.19833084595741
lambda[  16] =  -0.08123717199800
lambda[  17] =  -0.05407684185173
lambda[  18] =  -0.01839210827156
lambda[  19] =   0.02369830141183
lambda[  20] =   0.02659118856219
lambda[  21] =   0.03280340837101
lambda[  22] =   0.03479680409771
lambda[  23] =   0.04051236918906
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 1.287 ms
rank =  0, subspace rotation using ScaLAPACK took 10.191 ms
rank =  0, Distributing orbital back into band + domain format took 22.718 ms
rank = 0, Subspace_Rotation used 32.938 ms

Total time for subspace rotation: 32.944 ms
rank = 0, Efermi =  -0.110345404398 calculate fermi energy took 0.074 ms
rank = 0, --- Calculate rho: sum over local bands took 6.815 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.039 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.616 ms
rank = 0, Calculating density took 1948.243 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 2.005 ms
rank = 0, D2D took 2.105 ms
rank = 0, Transfering density took 2.108 ms
Etot    =   -47.183755254508
Eband   =   -14.045899965363
E1      =    32.470723863445
E2      =   -12.931597313367
E3      =   -17.836704533763
Exc     =   -16.021843321407
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 7.105e-06, dEband = 2.025e-03
rank = 0, Calculating/Estimating energy took 1.035 ms, Etot = -47.183755255, dEtot = 7.105e-06, dEband = 2.025e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0433868741602, which took 0.052 ms

iter_count = 114, r_2norm = 1.068e-06, tol*||rhs|| = 1.735e-06

Anderson update took 66.119 ms, out of which F'*F took 31.319 ms; b-Ax took 215.445 ms, out of which Lap took 190.686 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.611 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133418, int_b + int_rho = -1.819e-13, checking this took 0.204 ms
2-norm of RHS = 753.3081648154608, which took 0.141 ms

iter_count = 150, r_2norm = 6.248e-04, tol*||rhs|| = 7.533e-04

Anderson update took 88.334 ms, out of which F'*F took 41.768 ms; b-Ax took 284.530 ms, out of which Lap took 253.152 ms
Solving Poisson took 626.696 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.234393 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.225557 
Total time for convolution: 	 convolve: 5.210250 
Total time for convolution: 	 convolve: 5.244864 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.887 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.428 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 3.474 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.351 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.862 ms

This SCF took 28118.601 ms, scf error = 2.101e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.140512, lowerbound = -0.891222, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1799.660 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 22.661 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.615 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.365 ms
rank =  0, finding HY took 28.949 ms
rank =  0, distributing HY into block cyclic form took 22.116 ms
rank =  0, finding Y'*HY took 5.797 ms
Rank 0, Project_Hamiltonian used 83.388 ms
Total time for projection: 83.423 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.210 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.126 ms
rank = 0, Solve_Generalized_EigenProblem used 0.340 ms
    first calculated eigval = -0.890977193022734
    last  calculated eigval = 0.039161450743619
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46327429525287
lambda[   7] =  -0.45691180055095
lambda[   8] =  -0.42941525469462
lambda[   9] =  -0.38168610991404
lambda[  10] =  -0.37649837293784
lambda[  11] =  -0.33658610827696
lambda[  12] =  -0.29268712253938
lambda[  13] =  -0.25219211545620
lambda[  14] =  -0.24508931312339
lambda[  15] =  -0.19808864310006
lambda[  16] =  -0.08099864771838
lambda[  17] =  -0.05385900904920
lambda[  18] =  -0.01715507504668
lambda[  19] =   0.02508073993132
lambda[  20] =   0.02703407745664
lambda[  21] =   0.03326435353900
lambda[  22] =   0.03523227150285
lambda[  23] =   0.03916145074362
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.376 ms
rank =  0, subspace rotation using ScaLAPACK took 10.228 ms
rank =  0, Distributing orbital back into band + domain format took 22.740 ms
rank = 0, Subspace_Rotation used 33.000 ms

Total time for subspace rotation: 33.005 ms
rank = 0, Efermi =  -0.110106880311 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 6.614 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.313 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.555 ms
rank = 0, Calculating density took 1936.109 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.904 ms
rank = 0, D2D took 2.008 ms
rank = 0, Transfering density took 2.014 ms
Etot    =   -47.183803231963
Eband   =   -14.038657008444
E1      =    32.467026625218
E2      =   -12.927890216341
E3      =   -17.837242426462
Exc     =   -16.022267813228
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 4.798e-06, dEband = 7.243e-04
rank = 0, Calculating/Estimating energy took 1.008 ms, Etot = -47.183803232, dEtot = 4.798e-06, dEband = 7.243e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0261330985642, which took 0.061 ms

iter_count = 114, r_2norm = 6.704e-07, tol*||rhs|| = 1.045e-06

Anderson update took 66.629 ms, out of which F'*F took 31.403 ms; b-Ax took 216.091 ms, out of which Lap took 192.050 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 480.771 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133431, int_b + int_rho = -5.821e-14, checking this took 0.119 ms
2-norm of RHS = 753.3105800326747, which took 0.157 ms

iter_count = 150, r_2norm = 6.891e-04, tol*||rhs|| = 7.533e-04

Anderson update took 87.973 ms, out of which F'*F took 41.531 ms; b-Ax took 282.289 ms, out of which Lap took 251.308 ms
Solving Poisson took 625.188 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.256677 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.319330 
Total time for convolution: 	 convolve: 5.260124 
Total time for convolution: 	 convolve: 5.220007 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.479 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.275 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.799 ms

This SCF took 28234.112 ms, scf error = 1.593e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.139161, lowerbound = -0.890977, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1803.938 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.474 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.590 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.103 ms
rank =  0, finding HY took 28.911 ms
rank =  0, distributing HY into block cyclic form took 22.179 ms
rank =  0, finding Y'*HY took 5.706 ms
Rank 0, Project_Hamiltonian used 82.964 ms
Total time for projection: 82.990 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.171 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.276 ms
    first calculated eigval = -0.890859733102362
    last  calculated eigval = 0.039578020878491
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46313290661268
lambda[   7] =  -0.45678273805425
lambda[   8] =  -0.42926194670906
lambda[   9] =  -0.38154238671506
lambda[  10] =  -0.37635441822699
lambda[  11] =  -0.33644468585476
lambda[  12] =  -0.29255419679631
lambda[  13] =  -0.25206722797005
lambda[  14] =  -0.24493651843863
lambda[  15] =  -0.19795852302215
lambda[  16] =  -0.08086843288032
lambda[  17] =  -0.05373164793402
lambda[  18] =  -0.01604448875846
lambda[  19] =   0.02572874750575
lambda[  20] =   0.02746141163786
lambda[  21] =   0.03413280475266
lambda[  22] =   0.03627112438697
lambda[  23] =   0.03957802087849
==subpsace eigenproblem: bcast eigvals took 0.092 ms
Total time for solving subspace eigenvalue problem: 0.379 ms
rank =  0, subspace rotation using ScaLAPACK took 10.154 ms
rank =  0, Distributing orbital back into band + domain format took 22.658 ms
rank = 0, Subspace_Rotation used 32.862 ms

Total time for subspace rotation: 32.868 ms
rank = 0, Efermi =  -0.109976665352 calculate fermi energy took 0.154 ms
rank = 0, --- Calculate rho: sum over local bands took 6.780 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.146 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.569 ms
rank = 0, Calculating density took 1940.013 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.918 ms
rank = 0, D2D took 2.014 ms
rank = 0, Transfering density took 2.017 ms
Etot    =   -47.183852044130
Eband   =   -14.034562312074
E1      =    32.465392503521
E2      =   -12.925420714164
E3      =   -17.837087858436
Exc     =   -16.022153129864
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 4.881e-06, dEband = 4.095e-04
rank = 0, Calculating/Estimating energy took 1.051 ms, Etot = -47.183852044, dEtot = 4.881e-06, dEband = 4.095e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0231246854010, which took 0.057 ms

iter_count = 114, r_2norm = 5.915e-07, tol*||rhs|| = 9.250e-07

Anderson update took 66.736 ms, out of which F'*F took 31.484 ms; b-Ax took 213.329 ms, out of which Lap took 189.620 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 480.479 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133418, int_b + int_rho = -1.855e-13, checking this took 0.094 ms
2-norm of RHS = 753.3084485460033, which took 0.110 ms

iter_count = 108, r_2norm = 6.217e-04, tol*||rhs|| = 7.533e-04

Anderson update took 63.493 ms, out of which F'*F took 29.739 ms; b-Ax took 204.310 ms, out of which Lap took 181.658 ms
Solving Poisson took 451.770 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.225199 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.264798 
Total time for convolution: 	 convolve: 5.311251 
Total time for convolution: 	 convolve: 5.207508 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.581 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 3.511 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.290 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.837 ms

This SCF took 28026.500 ms, scf error = 1.218e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.139578, lowerbound = -0.890860, upperbound = 267.589552

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1807.998 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 22.846 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.499 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.379 ms
rank =  0, finding HY took 29.037 ms
rank =  0, distributing HY into block cyclic form took 22.092 ms
rank =  0, finding Y'*HY took 5.728 ms
Rank 0, Project_Hamiltonian used 83.310 ms
Total time for projection: 83.342 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.201 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.108 ms
rank = 0, Solve_Generalized_EigenProblem used 0.314 ms
    first calculated eigval = -0.890758900958421
    last  calculated eigval = 0.039842248164270
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46304502688058
lambda[   7] =  -0.45668347525826
lambda[   8] =  -0.42918092452441
lambda[   9] =  -0.38146006409793
lambda[  10] =  -0.37626151822499
lambda[  11] =  -0.33635821920526
lambda[  12] =  -0.29245573977109
lambda[  13] =  -0.25196450411312
lambda[  14] =  -0.24485197816901
lambda[  15] =  -0.19786197387322
lambda[  16] =  -0.08077774056866
lambda[  17] =  -0.05365130791373
lambda[  18] =  -0.01572987310628
lambda[  19] =   0.02614057295648
lambda[  20] =   0.02754159169382
lambda[  21] =   0.03417647666899
lambda[  22] =   0.03649863861171
lambda[  23] =   0.03984224816427
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.356 ms
rank =  0, subspace rotation using ScaLAPACK took 10.179 ms
rank =  0, Distributing orbital back into band + domain format took 22.648 ms
rank = 0, Subspace_Rotation used 32.868 ms

Total time for subspace rotation: 32.874 ms
rank = 0, Efermi =  -0.109885973045 calculate fermi energy took 0.084 ms
rank = 0, --- Calculate rho: sum over local bands took 6.785 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.131 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.581 ms
rank = 0, Calculating density took 1944.266 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.915 ms
rank = 0, D2D took 2.021 ms
rank = 0, Transfering density took 2.023 ms
Etot    =   -47.183861073845
Eband   =   -14.031772634875
E1      =    32.463811942067
E2      =   -12.924155905898
E3      =   -17.837329634237
Exc     =   -16.022348242860
Esc     =   -80.355037677672
Entropy =    -0.000000000640
dE = 9.030e-07, dEband = 2.790e-04
rank = 0, Calculating/Estimating energy took 1.030 ms, Etot = -47.183861074, dEtot = 9.030e-07, dEband = 2.790e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0205073818904, which took 0.059 ms

iter_count = 108, r_2norm = 7.972e-07, tol*||rhs|| = 8.203e-07

Anderson update took 63.148 ms, out of which F'*F took 29.946 ms; b-Ax took 203.897 ms, out of which Lap took 181.310 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.650 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002133437, int_rho =  30.00000002133415, int_b + int_rho = -2.219e-13, checking this took 0.115 ms
2-norm of RHS = 753.3079157882596, which took 0.085 ms

iter_count = 114, r_2norm = 6.291e-04, tol*||rhs|| = 7.533e-04

Anderson update took 67.166 ms, out of which F'*F took 30.868 ms; b-Ax took 242.727 ms, out of which Lap took 218.432 ms
Solving Poisson took 504.388 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.134 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.257679 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.279339 
Total time for convolution: 	 convolve: 5.233362 
Total time for convolution: 	 convolve: 5.320261 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 3.598 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.223 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.858 ms

This SCF took 28254.008 ms, scf error = 9.110e-05
The last 18 occupations of kpoints #1 are (Nelectron = 30):
lambda[   6] =  -0.46304502688058, occ[   6] =   2.00000000000000
lambda[   7] =  -0.45668347525826, occ[   7] =   2.00000000000000
lambda[   8] =  -0.42918092452441, occ[   8] =   2.00000000000000
lambda[   9] =  -0.38146006409793, occ[   9] =   2.00000000000000
lambda[  10] =  -0.37626151822499, occ[  10] =   2.00000000000000
lambda[  11] =  -0.33635821920526, occ[  11] =   2.00000000000000
lambda[  12] =  -0.29245573977109, occ[  12] =   2.00000000000000
lambda[  13] =  -0.25196450411312, occ[  13] =   2.00000000000000
lambda[  14] =  -0.24485197816901, occ[  14] =   2.00000000000000
lambda[  15] =  -0.19786197387322, occ[  15] =   2.00000000000000
lambda[  16] =  -0.08077774056866, occ[  16] =   0.00000002133420
lambda[  17] =  -0.05365130791373, occ[  17] =   0.00000000000000
lambda[  18] =  -0.01572987310628, occ[  18] =   0.00000000000000
lambda[  19] =   0.02614057295648, occ[  19] =   0.00000000000000
lambda[  20] =   0.02754159169382, occ[  20] =   0.00000000000000
lambda[  21] =   0.03417647666899, occ[  21] =   0.00000000000000
lambda[  22] =   0.03649863861171, occ[  22] =   0.00000000000000
lambda[  23] =   0.03984224816427, occ[  23] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 21 (90%) = 0.000000000000000.
Occupation of state 23 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.989 ms, time for Allreduce/Reduce: 11.264 ms 
Time for calculating local force components: 24.931 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000000140590  -0.04442035614364  -0.02711121472220
 -0.00000000188070   0.04442022881666  -0.02711108747316
 -0.00000002999633   0.04442017679792   0.02711111425503
 -0.00000002035844  -0.04442024234844   0.02711108400759
  0.00000037853985  -0.09228762212819   0.03780105407707
 -0.00000004635585   0.09228644515054   0.03780250787644
 -0.00000042254638   0.09228927731090  -0.03780492023809
 -0.00000055199907  -0.09228850408017  -0.03780407096551
  0.00000039386455   0.00000010212800  -0.84992069260137
 -0.00000086492560  -0.00000012206440   0.84992449789172
force_loc = 
  0.00000021240793   0.04512997466282   0.02798131842578
 -0.00000051124512  -0.04512896680263   0.02797925590435
  0.00000002774885  -0.04512921195117  -0.02798014150104
  0.00000036484490   0.04513056053636  -0.02798047921297
  0.00000265744081   0.08939839677451  -0.03682707552682
  0.00000060430725  -0.08939898130055  -0.03683344103155
 -0.00000189045215  -0.08939889739867   0.03683000117103
 -0.00000557957677   0.08939798407608   0.03683164155859
  0.00000051654179   0.00000260736673   0.82874454588107
 -0.00000535615412  -0.00000608631215  -0.82874879670573
Time for calculating nonlocal force components: 49.890 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000016562109   0.00030281401774  -0.00260939133084
[0m[32m  0.00000005348243  -0.00030284508996  -0.00260953437135
[0m[32m -0.00000009562397  -0.00030274986367   0.00260934480998
[0m[32m -0.00000036153677   0.00030269493401   0.00260954600877
[0m[32m  0.00000006890394   0.00000006521179   0.02158650267807
[0m[32m -0.00000024268263  -0.00000001994801  -0.02158667106792
[0mTime for calculating XC forces components: 34.292 ms
 Cartesian force = 
  0.00000126430567   0.00070994628394   0.00087061392389
  0.00000054017782  -0.00070841022120   0.00086867865149
  0.00000105105616  -0.00070870738849  -0.00086851702570
  0.00000139779010   0.00071064595268  -0.00086888498507
  0.00000425490539  -0.00258608357117  -0.00163490256029
  0.00000166473747   0.00258494652479  -0.00163995730615
 -0.00000135531886   0.00258795781332   0.00163493596322
 -0.00000543980897  -0.00258749730532   0.00163762682215
  0.00000203261393   0.00000310247128   0.00041086617808
 -0.00000541045871  -0.00000590055980  -0.00041045966162
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.390 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.362 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.200 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Time for printing density: 397.292 ms
The program took 461.983 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:35:17
Job ID:        2266829
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:34:36,vmem=8472K,walltime=00:07:53,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-018-6-1
---------------------------------------
