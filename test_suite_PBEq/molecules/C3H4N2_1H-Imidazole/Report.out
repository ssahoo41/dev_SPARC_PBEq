---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:56
Job ID:    2266799
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:22:01
Job ID:    2266799
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.061 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 24.483 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 9.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 13.703 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 90.616 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.953 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.082 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    9.956823	   13.790607	   10.000000	
    6.017379	   11.055629	   10.000000	
   13.982621	   11.132496	   10.000000	
   12.250183	    6.209393	   10.000000	
    7.923082	   10.336921	   10.000000	
   12.097504	   10.371301	   10.000000	
   11.184128	    7.943630	   10.000000	
    9.980149	   11.893354	   10.000000	
    8.569864	    7.933484	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.160 ms
Set up communicators.

--set up spincomm took 2.281 ms

--set up kptcomm took 0.360 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.008 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.078 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.863 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.901 ms

Calculate_SplineDerivRadFun took 0.209 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.261 ms.
time spent on vectorized spline interp: 2.749 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.989 ms.
time spent on vectorized spline interp: 1.626 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.500 ms.
time spent on vectorized spline interp: 1.638 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.625 ms.

Calculating rb for all atom types took 15.396 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.897 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.011 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000238222, sum_int_rho = 25.5859338960825
PosCharge = 26.000000023822, NegCharge = -25.585933896082, scal_fac = 1.016183350173
After scaling, int_rho = 26.0000000238222, PosCharge + NegCharge - NetCharge = 5.684e-14
--Calculate Vref took 0.581 ms
--Calculate rho_guess took 3.162 ms

 integral of b = -26.0000000238222,
 int{b} + Nelectron + NetCharge = -2.382e-08,
 Esc = -70.0053747179356,
 MPI_Reduce took 10.201 ms

Calculating b & b_ref took 21.316 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.042 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.052 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 39.104 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382231, int_b + int_rho = 2.328e-13, checking this took 0.093 ms
2-norm of RHS = 724.7440811510019, which took 0.748 ms

iter_count = 420, r_2norm = 6.829e-04, tol*||rhs|| = 7.247e-04

Anderson update took 232.959 ms, out of which F'*F took 106.759 ms; b-Ax took 721.245 ms, out of which Lap took 644.804 ms
Solving Poisson took 1528.747 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.421 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
Total time for convolution: 	 convolve: 5.158209 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.372 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
Total time for convolution: 	 convolve: 5.247290 
Total time for convolution: 	 convolve: 5.218399 
Total time for convolution: 	 convolve: 5.211546 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.820 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.500 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
rank = 0, XC calculation took 24728.645 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 2.172 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.123 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.418 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.136 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.719 ms
    Lanczos iter 53, eigmin  = -1.031929400, eigmax = 264.934666682, err_eigmin = 5.698e-04, err_eigmax = 9.627e-03
rank =   0, Lanczos took 121.035 ms, eigmin = -1.031929400183, eigmax = 267.584013348661

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.226042, lowerbound = -1.131929, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1743.830 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.438 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.889 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 24.361 ms
rank =  0, finding HY took 30.671 ms
rank =  0, distributing HY into block cyclic form took 19.140 ms
rank =  0, finding Y'*HY took 5.728 ms
Rank 0, Project_Hamiltonian used 79.928 ms
Total time for projection: 79.937 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.368 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.117 ms
rank = 0, Solve_Generalized_EigenProblem used 0.491 ms
    first calculated eigval = 2.688190365201353
    last  calculated eigval = 3.228313489844919
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.80780360502176
lambda[   5] =   2.85320031459780
lambda[   6] =   2.89260335045025
lambda[   7] =   2.91989724293613
lambda[   8] =   2.93991567973786
lambda[   9] =   2.94368289655543
lambda[  10] =   2.98427019837344
lambda[  11] =   2.99272103989759
lambda[  12] =   3.01934194797530
lambda[  13] =   3.06397138769458
lambda[  14] =   3.09385805686043
lambda[  15] =   3.10004255595042
lambda[  16] =   3.12514877278628
lambda[  17] =   3.13935379507258
lambda[  18] =   3.14155279372314
lambda[  19] =   3.17820421267904
lambda[  20] =   3.22831348984492
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.531 ms
rank =  0, subspace rotation using ScaLAPACK took 4.140 ms
rank =  0, Distributing orbital back into band + domain format took 17.543 ms
rank = 0, Subspace_Rotation used 21.698 ms

Total time for subspace rotation: 21.704 ms
rank = 0, Efermi =   3.078905053916 calculate fermi energy took 0.071 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.328313, lowerbound = -1.131929, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1768.899 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.231 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.977 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 26.237 ms
rank =  0, finding HY took 30.313 ms
rank =  0, distributing HY into block cyclic form took 17.802 ms
rank =  0, finding Y'*HY took 5.496 ms
Rank 0, Project_Hamiltonian used 79.880 ms
Total time for projection: 79.891 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.731090908580488
    last  calculated eigval = 0.453514724492561
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.40215538080858
lambda[   5] =  -0.27680304535731
lambda[   6] =  -0.23033951736334
lambda[   7] =  -0.16963543180391
lambda[   8] =  -0.04567950855507
lambda[   9] =   0.02822192858847
lambda[  10] =   0.12906231945876
lambda[  11] =   0.16764544563793
lambda[  12] =   0.19626517727913
lambda[  13] =   0.26573017012522
lambda[  14] =   0.28070974012879
lambda[  15] =   0.30870873250105
lambda[  16] =   0.33192920286379
lambda[  17] =   0.37781476811109
lambda[  18] =   0.38426685381016
lambda[  19] =   0.41536725743230
lambda[  20] =   0.45351472449256
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 3.751 ms
rank =  0, Distributing orbital back into band + domain format took 17.334 ms
rank = 0, Subspace_Rotation used 21.100 ms

Total time for subspace rotation: 21.105 ms
rank = 0, Efermi =   0.273219955346 calculate fermi energy took 0.031 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.553515, lowerbound = -1.131929, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1795.078 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.066 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.833 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 21.928 ms
rank =  0, finding HY took 30.267 ms
rank =  0, distributing HY into block cyclic form took 17.759 ms
rank =  0, finding Y'*HY took 5.395 ms
Rank 0, Project_Hamiltonian used 75.377 ms
Total time for projection: 75.381 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -1.034807527238525
    last  calculated eigval = 0.153251555631900
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.65448996341607
lambda[   5] =  -0.63941407869925
lambda[   6] =  -0.60218680560739
lambda[   7] =  -0.50558974910580
lambda[   8] =  -0.48981729163734
lambda[   9] =  -0.46270765251383
lambda[  10] =  -0.45602396829690
lambda[  11] =  -0.33642628993982
lambda[  12] =  -0.31877496873698
lambda[  13] =  -0.26624696174225
lambda[  14] =  -0.05073792515208
lambda[  15] =   0.00249227968118
lambda[  16] =   0.07863826629226
lambda[  17] =   0.09560835550193
lambda[  18] =   0.12262072631887
lambda[  19] =   0.13476399604317
lambda[  20] =   0.15325155563190
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 4.060 ms
rank =  0, Distributing orbital back into band + domain format took 19.542 ms
rank = 0, Subspace_Rotation used 23.616 ms

Total time for subspace rotation: 23.621 ms
rank = 0, Efermi =  -0.079746633584 calculate fermi energy took 0.032 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.253252, lowerbound = -1.131929, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1794.231 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.757 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.093 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.878 ms
rank =  0, finding HY took 30.299 ms
rank =  0, distributing HY into block cyclic form took 17.746 ms
rank =  0, finding Y'*HY took 5.485 ms
Rank 0, Project_Hamiltonian used 75.432 ms
Total time for projection: 75.436 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.107 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.163 ms
    first calculated eigval = -1.035271498222152
    last  calculated eigval = 0.087543085477831
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.65568906978807
lambda[   5] =  -0.64154386451224
lambda[   6] =  -0.61006486839277
lambda[   7] =  -0.50803227155987
lambda[   8] =  -0.49507161449842
lambda[   9] =  -0.47427223105080
lambda[  10] =  -0.46841081849336
lambda[  11] =  -0.35278887349780
lambda[  12] =  -0.34194991758702
lambda[  13] =  -0.29605683987440
lambda[  14] =  -0.08797704779047
lambda[  15] =  -0.06252204809073
lambda[  16] =   0.00501594309754
lambda[  17] =   0.04464606404890
lambda[  18] =   0.06447142329825
lambda[  19] =   0.07857515290642
lambda[  20] =   0.08754308547783
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 4.196 ms
rank =  0, Distributing orbital back into band + domain format took 16.670 ms
rank = 0, Subspace_Rotation used 20.880 ms

Total time for subspace rotation: 20.885 ms
rank = 0, Efermi =  -0.116985756256 calculate fermi energy took 0.028 ms
rank = 0, --- Calculate rho: sum over local bands took 3.592 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.443 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.319 ms
rank = 0, Calculating density took 7632.994 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.706 ms
rank = 0, D2D took 3.417 ms
rank = 0, Transfering density took 3.426 ms
Etot    =   -41.297693943752
Eband   =   -15.140886203220
E1      =    30.319734151274
E2      =   -12.023215306498
E3      =   -14.909158791687
Exc     =   -13.403541271343
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 4.589e+00, dEband = 1.682e+00
rank = 0, Calculating/Estimating energy took 1.466 ms, Etot = -41.297693944, dEtot = 4.589e+00, dEband = 1.682e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 50.1991521300241, which took 0.046 ms

iter_count = 96, r_2norm = 1.786e-03, tol*||rhs|| = 2.008e-03

Anderson update took 51.917 ms, out of which F'*F took 24.036 ms; b-Ax took 162.916 ms, out of which Lap took 146.196 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.437 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382210, int_b + int_rho = 2.910e-14, checking this took 0.107 ms
2-norm of RHS = 720.2968342742807, which took 0.128 ms

iter_count = 288, r_2norm = 6.145e-04, tol*||rhs|| = 7.203e-04

Anderson update took 154.608 ms, out of which F'*F took 72.735 ms; b-Ax took 490.983 ms, out of which Lap took 439.409 ms
Solving Poisson took 1038.517 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.854 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.164734 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.367637 
Total time for convolution: 	 convolve: 5.087169 
Total time for convolution: 	 convolve: 5.119598 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.273 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 1.252 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.352 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.624 ms

This SCF took 33780.519 ms, scf error = 1.693e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.187543, lowerbound = -1.035271, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1734.692 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.867 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.146 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.038 ms
rank =  0, finding HY took 30.338 ms
rank =  0, distributing HY into block cyclic form took 17.981 ms
rank =  0, finding Y'*HY took 5.834 ms
Rank 0, Project_Hamiltonian used 76.223 ms
Total time for projection: 76.234 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.168 ms
    first calculated eigval = -1.005246071512722
    last  calculated eigval = 0.065951867785509
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62687717476145
lambda[   5] =  -0.61241405420389
lambda[   6] =  -0.58369400227753
lambda[   7] =  -0.47559621212454
lambda[   8] =  -0.46756103795993
lambda[   9] =  -0.44523683056861
lambda[  10] =  -0.44418329165613
lambda[  11] =  -0.31430850176038
lambda[  12] =  -0.31251356270466
lambda[  13] =  -0.27175176188994
lambda[  14] =  -0.07142119348330
lambda[  15] =  -0.04421821047057
lambda[  16] =  -0.02447462313866
lambda[  17] =   0.02182812835634
lambda[  18] =   0.03757404293532
lambda[  19] =   0.04331188085174
lambda[  20] =   0.06595186778551
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 4.033 ms
rank =  0, Distributing orbital back into band + domain format took 20.707 ms
rank = 0, Subspace_Rotation used 24.753 ms

Total time for subspace rotation: 24.760 ms
rank = 0, Efermi =  -0.100429901938 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.500 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.495 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.219 ms
rank = 0, Calculating density took 1844.617 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.891 ms
rank = 0, D2D took 1.004 ms
rank = 0, Transfering density took 1.006 ms
Etot    =   -41.239096752123
Eband   =   -14.370497394448
E1      =    29.652276647265
E2      =   -11.943872903565
E3      =   -15.095063360355
Exc     =   -13.554437550212
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 6.511e-03, dEband = 8.560e-02
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -41.239096752, dEtot = 6.511e-03, dEband = 8.560e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 17.0313011750142, which took 0.131 ms

iter_count = 102, r_2norm = 6.256e-04, tol*||rhs|| = 6.813e-04

Anderson update took 55.046 ms, out of which F'*F took 25.497 ms; b-Ax took 173.243 ms, out of which Lap took 155.351 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.544 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382222, int_b + int_rho = 1.455e-13, checking this took 0.103 ms
2-norm of RHS = 714.3044328072131, which took 0.118 ms

iter_count = 306, r_2norm = 6.247e-04, tol*||rhs|| = 7.143e-04

Anderson update took 164.563 ms, out of which F'*F took 76.936 ms; b-Ax took 517.998 ms, out of which Lap took 463.729 ms
Solving Poisson took 1102.338 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.078689 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.100643 
Total time for convolution: 	 convolve: 5.092378 
Total time for convolution: 	 convolve: 5.077821 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.582 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.394 ms
---Transfer Veff_loc: D2D took 1.269 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.343 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.633 ms

This SCF took 27750.341 ms, scf error = 1.157e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.165952, lowerbound = -1.005246, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1744.762 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.885 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.401 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 26.310 ms
rank =  0, finding HY took 30.471 ms
rank =  0, distributing HY into block cyclic form took 18.793 ms
rank =  0, finding Y'*HY took 6.136 ms
Rank 0, Project_Hamiltonian used 81.742 ms
Total time for projection: 81.755 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -0.952387620392293
    last  calculated eigval = 0.058227644014231
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57790504977476
lambda[   5] =  -0.55724180109734
lambda[   6] =  -0.53218568163909
lambda[   7] =  -0.41665710797601
lambda[   8] =  -0.41428249514540
lambda[   9] =  -0.40442159298918
lambda[  10] =  -0.38581704492309
lambda[  11] =  -0.26943364104071
lambda[  12] =  -0.24904348994541
lambda[  13] =  -0.22586687466855
lambda[  14] =  -0.03358764871900
lambda[  15] =  -0.03168954461135
lambda[  16] =   0.00021760712481
lambda[  17] =   0.01214386850794
lambda[  18] =   0.02633083185605
lambda[  19] =   0.03197386514110
lambda[  20] =   0.05822764401423
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 8.115 ms
rank =  0, Distributing orbital back into band + domain format took 17.116 ms
rank = 0, Subspace_Rotation used 25.253 ms

Total time for subspace rotation: 25.259 ms
rank = 0, Efermi =  -0.062693730662 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.496 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.506 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.202 ms
rank = 0, Calculating density took 1860.749 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.641 ms
rank = 0, D2D took 0.782 ms
rank = 0, Transfering density took 0.785 ms
Etot    =   -41.187353826939
Eband   =   -12.994007157403
E1      =    28.510757040322
E2      =   -11.690187085501
E3      =   -15.462523415039
Exc     =   -13.851439491744
Esc     =   -70.005374717936
Entropy =    -0.000000000719
dE = 5.749e-03, dEband = 1.529e-01
rank = 0, Calculating/Estimating energy took 0.899 ms, Etot = -41.187353827, dEtot = 5.749e-03, dEband = 1.529e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.7335529560390, which took 0.132 ms

iter_count = 108, r_2norm = 1.538e-04, tol*||rhs|| = 2.293e-04

Anderson update took 57.851 ms, out of which F'*F took 26.958 ms; b-Ax took 182.889 ms, out of which Lap took 163.447 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.010 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382211, int_b + int_rho = 3.274e-14, checking this took 0.104 ms
2-norm of RHS = 714.7735494713812, which took 0.132 ms

iter_count = 276, r_2norm = 5.710e-04, tol*||rhs|| = 7.148e-04

Anderson update took 148.625 ms, out of which F'*F took 69.222 ms; b-Ax took 466.779 ms, out of which Lap took 417.769 ms
Solving Poisson took 993.238 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.079308 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.079913 
Total time for convolution: 	 convolve: 5.077273 
Total time for convolution: 	 convolve: 5.093743 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.351 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.413 ms
---Transfer Veff_loc: D2D took 1.286 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.338 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.645 ms

This SCF took 27581.388 ms, scf error = 3.562e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.158228, lowerbound = -0.952388, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1779.110 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.060 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.058 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 23.143 ms
rank =  0, finding HY took 29.331 ms
rank =  0, distributing HY into block cyclic form took 17.730 ms
rank =  0, finding Y'*HY took 5.347 ms
Rank 0, Project_Hamiltonian used 75.578 ms
Total time for projection: 75.590 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.622 ms
rank = 0, Solve_Generalized_EigenProblem used 1.149 ms
    first calculated eigval = -0.942123359119606
    last  calculated eigval = 0.052176521898070
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56833804069956
lambda[   5] =  -0.54524660512643
lambda[   6] =  -0.51863511242801
lambda[   7] =  -0.40430630941222
lambda[   8] =  -0.40132904055934
lambda[   9] =  -0.39597707782643
lambda[  10] =  -0.37223478917039
lambda[  11] =  -0.26291135637285
lambda[  12] =  -0.24026175407615
lambda[  13] =  -0.21550874241522
lambda[  14] =  -0.03470300174757
lambda[  15] =  -0.02319592531363
lambda[  16] =   0.00616981170104
lambda[  17] =   0.00990304897363
lambda[  18] =   0.02292296938584
lambda[  19] =   0.02638757652043
lambda[  20] =   0.05217652189807
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.164 ms
rank =  0, subspace rotation using ScaLAPACK took 7.273 ms
rank =  0, Distributing orbital back into band + domain format took 17.429 ms
rank = 0, Subspace_Rotation used 24.715 ms

Total time for subspace rotation: 24.720 ms
rank = 0, Efermi =  -0.063711710474 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.374 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.835 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.475 ms
rank = 0, Calculating density took 1889.381 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.887 ms
rank = 0, D2D took 1.042 ms
rank = 0, Transfering density took 1.044 ms
Etot    =   -41.183116139198
Eband   =   -12.714102131179
E1      =    28.340572287918
E2      =   -11.566752234710
E3      =   -15.537984118438
Exc     =   -13.908947930437
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 4.709e-04, dEband = 3.110e-02
rank = 0, Calculating/Estimating energy took 0.911 ms, Etot = -41.183116139, dEtot = 4.709e-04, dEband = 3.110e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.0881122703208, which took 0.066 ms

iter_count = 108, r_2norm = 7.548e-05, tol*||rhs|| = 8.352e-05

Anderson update took 58.333 ms, out of which F'*F took 27.397 ms; b-Ax took 183.693 ms, out of which Lap took 164.119 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.203 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382216, int_b + int_rho = 8.731e-14, checking this took 0.122 ms
2-norm of RHS = 715.7112395992718, which took 0.145 ms

iter_count = 264, r_2norm = 6.793e-04, tol*||rhs|| = 7.157e-04

Anderson update took 141.615 ms, out of which F'*F took 65.560 ms; b-Ax took 444.103 ms, out of which Lap took 396.680 ms
Solving Poisson took 948.987 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.098672 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.157 ms
Total time for convolution: 	 convolve: 5.076755 
Total time for convolution: 	 convolve: 5.073260 
Total time for convolution: 	 convolve: 5.072905 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.383 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.172 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 1.288 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.108 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.424 ms

This SCF took 27542.482 ms, scf error = 1.585e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.152177, lowerbound = -0.942123, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1773.823 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.727 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.132 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.804 ms
rank =  0, Distribute data + matrix mult took 23.133 ms
rank =  0, finding HY took 28.224 ms
rank =  0, distributing HY into block cyclic form took 17.774 ms
rank =  0, finding Y'*HY took 5.331 ms
Rank 0, Project_Hamiltonian used 74.497 ms
Total time for projection: 74.523 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -0.936397333881500
    last  calculated eigval = 0.045149135875789
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56262299190297
lambda[   5] =  -0.53885160782693
lambda[   6] =  -0.51153498955980
lambda[   7] =  -0.39781334234357
lambda[   8] =  -0.39436039507669
lambda[   9] =  -0.39086077285969
lambda[  10] =  -0.36456454912201
lambda[  11] =  -0.25757808672748
lambda[  12] =  -0.23302573805402
lambda[  13] =  -0.21037565029302
lambda[  14] =  -0.03502190011078
lambda[  15] =  -0.01864195026267
lambda[  16] =   0.00611669117613
lambda[  17] =   0.01266107793107
lambda[  18] =   0.02056622783214
lambda[  19] =   0.02415282145185
lambda[  20] =   0.04514913587579
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 7.247 ms
rank =  0, Distributing orbital back into band + domain format took 17.431 ms
rank = 0, Subspace_Rotation used 24.690 ms

Total time for subspace rotation: 24.695 ms
rank = 0, Efermi =  -0.064030608566 calculate fermi energy took 2.224 ms
rank = 0, --- Calculate rho: sum over local bands took 4.562 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.182 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.241 ms
rank = 0, Calculating density took 1882.508 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.856 ms
rank = 0, D2D took 0.987 ms
rank = 0, Transfering density took 0.995 ms
Etot    =   -41.181356569083
Eband   =   -12.551816182657
E1      =    28.274957237584
E2      =   -11.460341723298
E3      =   -15.575365953113
Exc     =   -13.934830581774
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 1.955e-04, dEband = 1.803e-02
rank = 0, Calculating/Estimating energy took 0.910 ms, Etot = -41.181356569, dEtot = 1.955e-04, dEband = 1.803e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8876025082255, which took 0.080 ms

iter_count = 114, r_2norm = 2.313e-05, tol*||rhs|| = 3.550e-05

Anderson update took 60.978 ms, out of which F'*F took 28.576 ms; b-Ax took 194.109 ms, out of which Lap took 173.351 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.437 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382213, int_b + int_rho = 5.821e-14, checking this took 0.126 ms
2-norm of RHS = 715.9823625712887, which took 0.122 ms

iter_count = 240, r_2norm = 6.072e-04, tol*||rhs|| = 7.160e-04

Anderson update took 129.235 ms, out of which F'*F took 60.512 ms; b-Ax took 411.939 ms, out of which Lap took 368.839 ms
Solving Poisson took 864.193 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.189 ms
Total time for convolution: 	 convolve: 5.073352 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.076668 
Total time for convolution: 	 convolve: 5.073745 
Total time for convolution: 	 convolve: 5.073106 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.585 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 1.455 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.689 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.173 ms

This SCF took 27451.433 ms, scf error = 5.787e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.145149, lowerbound = -0.936397, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1729.205 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.777 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.138 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.940 ms
rank =  0, finding HY took 28.887 ms
rank =  0, distributing HY into block cyclic form took 17.639 ms
rank =  0, finding Y'*HY took 5.412 ms
Rank 0, Project_Hamiltonian used 73.906 ms
Total time for projection: 73.919 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.934093176135940
    last  calculated eigval = 0.037418292998318
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56050086953937
lambda[   5] =  -0.53666156507580
lambda[   6] =  -0.50968697393814
lambda[   7] =  -0.39569772434431
lambda[   8] =  -0.39240658955407
lambda[   9] =  -0.38865736534191
lambda[  10] =  -0.36224162415774
lambda[  11] =  -0.25479283834260
lambda[  12] =  -0.22962060459963
lambda[  13] =  -0.20848872880060
lambda[  14] =  -0.03517641382540
lambda[  15] =  -0.01699636560390
lambda[  16] =   0.00493758139441
lambda[  17] =   0.01429663681427
lambda[  18] =   0.01901703641823
lambda[  19] =   0.02331065573254
lambda[  20] =   0.03741829299832
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 7.243 ms
rank =  0, Distributing orbital back into band + domain format took 17.377 ms
rank = 0, Subspace_Rotation used 24.632 ms

Total time for subspace rotation: 24.638 ms
rank = 0, Efermi =  -0.064185122262 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.439 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.379 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.251 ms
rank = 0, Calculating density took 1836.529 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.825 ms
rank = 0, D2D took 0.977 ms
rank = 0, Transfering density took 0.980 ms
Etot    =   -41.180956786465
Eband   =   -12.492107120231
E1      =    28.252740982228
E2      =   -11.420411808022
E3      =   -15.582687463490
Exc     =   -13.939315201326
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 4.442e-05, dEband = 6.634e-03
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -41.180956786, dEtot = 4.442e-05, dEband = 6.634e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4129006481739, which took 0.143 ms

iter_count = 114, r_2norm = 1.267e-05, tol*||rhs|| = 1.652e-05

Anderson update took 61.104 ms, out of which F'*F took 28.433 ms; b-Ax took 193.171 ms, out of which Lap took 172.457 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.514 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382210, int_b + int_rho = 2.547e-14, checking this took 0.099 ms
2-norm of RHS = 716.2340979248983, which took 0.128 ms

iter_count = 252, r_2norm = 5.956e-04, tol*||rhs|| = 7.162e-04

Anderson update took 134.762 ms, out of which F'*F took 62.730 ms; b-Ax took 426.252 ms, out of which Lap took 380.623 ms
Solving Poisson took 906.785 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.071980 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.072778 
Total time for convolution: 	 convolve: 5.070475 
Total time for convolution: 	 convolve: 5.076949 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.583 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.171 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.473 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.227 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.320 ms

This SCF took 27458.981 ms, scf error = 3.848e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.137418, lowerbound = -0.934093, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1732.744 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.875 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.044 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.947 ms
rank =  0, finding HY took 29.005 ms
rank =  0, distributing HY into block cyclic form took 17.654 ms
rank =  0, finding Y'*HY took 5.488 ms
Rank 0, Project_Hamiltonian used 74.121 ms
Total time for projection: 74.134 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -0.929327872796072
    last  calculated eigval = 0.032096281890115
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55647253201705
lambda[   5] =  -0.53193513430351
lambda[   6] =  -0.50544259936513
lambda[   7] =  -0.39117286468722
lambda[   8] =  -0.38813122934834
lambda[   9] =  -0.38414723842948
lambda[  10] =  -0.35748848128422
lambda[  11] =  -0.25010729892761
lambda[  12] =  -0.22419676285519
lambda[  13] =  -0.20383204155935
lambda[  14] =  -0.03509528257909
lambda[  15] =  -0.01304359039533
lambda[  16] =   0.00450924089133
lambda[  17] =   0.01783540482532
lambda[  18] =   0.01955842560249
lambda[  19] =   0.02329360670497
lambda[  20] =   0.03209628189012
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 7.247 ms
rank =  0, Distributing orbital back into band + domain format took 17.312 ms
rank = 0, Subspace_Rotation used 24.571 ms

Total time for subspace rotation: 24.577 ms
rank = 0, Efermi =  -0.064103991063 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.431 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.503 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.269 ms
rank = 0, Calculating density took 1839.962 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.829 ms
rank = 0, D2D took 0.956 ms
rank = 0, Transfering density took 0.960 ms
Etot    =   -41.180471981437
Eband   =   -12.371862183505
E1      =    28.196225269250
E2      =   -11.352732563575
E3      =   -15.596574220295
Exc     =   -13.948767132405
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 5.387e-05, dEband = 1.336e-02
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -41.180471981, dEtot = 5.387e-05, dEband = 1.336e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3048001974240, which took 0.100 ms

iter_count = 114, r_2norm = 7.775e-06, tol*||rhs|| = 1.219e-05

Anderson update took 60.757 ms, out of which F'*F took 28.093 ms; b-Ax took 192.270 ms, out of which Lap took 171.189 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.659 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382215, int_b + int_rho = 7.276e-14, checking this took 0.077 ms
2-norm of RHS = 716.2046629828221, which took 0.131 ms

iter_count = 228, r_2norm = 7.055e-04, tol*||rhs|| = 7.162e-04

Anderson update took 120.985 ms, out of which F'*F took 56.827 ms; b-Ax took 386.629 ms, out of which Lap took 344.936 ms
Solving Poisson took 818.594 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.073958 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.682 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.079881 
Total time for convolution: 	 convolve: 5.082762 
Total time for convolution: 	 convolve: 5.078796 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.186 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.458 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.697 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.197 ms

This SCF took 27603.947 ms, scf error = 1.994e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.132096, lowerbound = -0.929328, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1731.248 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.668 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.020 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.806 ms
rank =  0, Distribute data + matrix mult took 22.508 ms
rank =  0, finding HY took 28.968 ms
rank =  0, distributing HY into block cyclic form took 17.732 ms
rank =  0, finding Y'*HY took 6.200 ms
Rank 0, Project_Hamiltonian used 75.437 ms
Total time for projection: 75.450 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.193 ms
    first calculated eigval = -0.926587296632383
    last  calculated eigval = 0.030220395832731
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55415048629363
lambda[   5] =  -0.52914296812381
lambda[   6] =  -0.50280111158012
lambda[   7] =  -0.38849357064706
lambda[   8] =  -0.38550001138838
lambda[   9] =  -0.38151205175257
lambda[  10] =  -0.35461189824226
lambda[  11] =  -0.24735289629299
lambda[  12] =  -0.22081309129272
lambda[  13] =  -0.20098373595340
lambda[  14] =  -0.03416010420872
lambda[  15] =  -0.01042565760136
lambda[  16] =   0.00530341847927
lambda[  17] =   0.01959454475430
lambda[  18] =   0.02106885190447
lambda[  19] =   0.02306098068150
lambda[  20] =   0.03022039583273
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 7.243 ms
rank =  0, Distributing orbital back into band + domain format took 17.393 ms
rank = 0, Subspace_Rotation used 24.648 ms

Total time for subspace rotation: 24.654 ms
rank = 0, Efermi =  -0.063168812664 calculate fermi energy took 0.088 ms
rank = 0, --- Calculate rho: sum over local bands took 4.421 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.363 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.251 ms
rank = 0, Calculating density took 1839.747 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.832 ms
rank = 0, D2D took 0.983 ms
rank = 0, Transfering density took 0.987 ms
Etot    =   -41.180386885635
Eband   =   -12.299890954774
E1      =    28.157755471184
E2      =   -11.317444249964
E3      =   -15.603974757970
Exc     =   -13.954295691331
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 9.455e-06, dEband = 7.997e-03
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -41.180386886, dEtot = 9.455e-06, dEband = 7.997e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1958141915845, which took 0.055 ms

iter_count = 114, r_2norm = 6.159e-06, tol*||rhs|| = 7.833e-06

Anderson update took 60.528 ms, out of which F'*F took 28.232 ms; b-Ax took 192.361 ms, out of which Lap took 171.555 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.047 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382226, int_b + int_rho = 1.819e-13, checking this took 0.105 ms
2-norm of RHS = 716.2219143360230, which took 0.112 ms

iter_count = 210, r_2norm = 6.523e-04, tol*||rhs|| = 7.162e-04

Anderson update took 112.565 ms, out of which F'*F took 52.176 ms; b-Ax took 355.345 ms, out of which Lap took 316.410 ms
Solving Poisson took 754.343 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 5.074243 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.266 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.075914 
Total time for convolution: 	 convolve: 5.082130 
Total time for convolution: 	 convolve: 5.078093 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 1.471 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.719 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.220 ms

This SCF took 27315.350 ms, scf error = 1.334e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.130220, lowerbound = -0.926587, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1731.277 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.789 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.106 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.918 ms
rank =  0, finding HY took 29.013 ms
rank =  0, distributing HY into block cyclic form took 17.711 ms
rank =  0, finding Y'*HY took 5.369 ms
Rank 0, Project_Hamiltonian used 74.037 ms
Total time for projection: 74.049 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.925957417813778
    last  calculated eigval = 0.029737863963944
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55352781466422
lambda[   5] =  -0.52850959418244
lambda[   6] =  -0.50213231557161
lambda[   7] =  -0.38786493202395
lambda[   8] =  -0.38487733335586
lambda[   9] =  -0.38081281995868
lambda[  10] =  -0.35392457861437
lambda[  11] =  -0.24665992280884
lambda[  12] =  -0.22018470974381
lambda[  13] =  -0.20031392769598
lambda[  14] =  -0.03296971705504
lambda[  15] =  -0.00965536919339
lambda[  16] =   0.00621156393155
lambda[  17] =   0.02044444266305
lambda[  18] =   0.02097040141674
lambda[  19] =   0.02316293101362
lambda[  20] =   0.02973786396394
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 7.258 ms
rank =  0, Distributing orbital back into band + domain format took 17.369 ms
rank = 0, Subspace_Rotation used 24.639 ms

Total time for subspace rotation: 24.645 ms
rank = 0, Efermi =  -0.061978425533 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.410 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.454 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.241 ms
rank = 0, Calculating density took 1838.387 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.834 ms
rank = 0, D2D took 1.863 ms
rank = 0, Transfering density took 1.867 ms
Etot    =   -41.180460168866
Eband   =   -12.283060081947
E1      =    28.152069727710
E2      =   -11.306263366851
E3      =   -15.603579087907
Exc     =   -13.953937550740
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 8.143e-06, dEband = 1.870e-03
rank = 0, Calculating/Estimating energy took 0.884 ms, Etot = -41.180460169, dEtot = 8.143e-06, dEband = 1.870e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1246171654492, which took 0.097 ms

iter_count = 114, r_2norm = 3.258e-06, tol*||rhs|| = 4.985e-06

Anderson update took 60.595 ms, out of which F'*F took 28.110 ms; b-Ax took 192.348 ms, out of which Lap took 171.271 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.500 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382216, int_b + int_rho = 9.095e-14, checking this took 0.115 ms
2-norm of RHS = 716.1771828491633, which took 0.102 ms

iter_count = 216, r_2norm = 6.295e-04, tol*||rhs|| = 7.162e-04

Anderson update took 115.036 ms, out of which F'*F took 53.756 ms; b-Ax took 369.097 ms, out of which Lap took 329.827 ms
Solving Poisson took 778.199 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.074628 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.077923 
Total time for convolution: 	 convolve: 5.080383 
Total time for convolution: 	 convolve: 5.080061 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.721 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.577 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 1.916 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.774 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.730 ms

This SCF took 27335.843 ms, scf error = 9.356e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.129738, lowerbound = -0.925957, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1732.028 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.767 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.060 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.851 ms
rank =  0, finding HY took 29.017 ms
rank =  0, distributing HY into block cyclic form took 17.761 ms
rank =  0, finding Y'*HY took 5.327 ms
Rank 0, Project_Hamiltonian used 73.982 ms
Total time for projection: 73.995 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -0.924571262631267
    last  calculated eigval = 0.031693929612045
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55223729002513
lambda[   5] =  -0.52709193229101
lambda[   6] =  -0.50077066367441
lambda[   7] =  -0.38646928012593
lambda[   8] =  -0.38351495565128
lambda[   9] =  -0.37942937369819
lambda[  10] =  -0.35245475442085
lambda[  11] =  -0.24524810227446
lambda[  12] =  -0.21874457587741
lambda[  13] =  -0.19887892403743
lambda[  14] =  -0.02934983766434
lambda[  15] =  -0.00810196071337
lambda[  16] =   0.00997687535273
lambda[  17] =   0.02276165015821
lambda[  18] =   0.02320776955432
lambda[  19] =   0.02515049728223
lambda[  20] =   0.03169392961205
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 7.275 ms
rank =  0, Distributing orbital back into band + domain format took 17.356 ms
rank = 0, Subspace_Rotation used 24.644 ms

Total time for subspace rotation: 24.651 ms
rank = 0, Efermi =  -0.058358546114 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.433 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.405 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.283 ms
rank = 0, Calculating density took 1840.054 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.698 ms
rank = 0, D2D took 0.810 ms
rank = 0, Transfering density took 0.813 ms
Etot    =   -41.180516612293
Eband   =   -12.246740711772
E1      =    28.133036246628
E2      =   -11.288522120117
E3      =   -15.606000915632
Exc     =   -13.955960464251
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 6.271e-06, dEband = 4.035e-03
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -41.180516612, dEtot = 6.271e-06, dEband = 4.035e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0908815918331, which took 0.082 ms

iter_count = 114, r_2norm = 2.714e-06, tol*||rhs|| = 3.635e-06

Anderson update took 60.713 ms, out of which F'*F took 28.208 ms; b-Ax took 192.285 ms, out of which Lap took 171.537 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.086 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382215, int_b + int_rho = 7.276e-14, checking this took 0.117 ms
2-norm of RHS = 716.1788902157765, which took 0.109 ms

iter_count = 180, r_2norm = 6.400e-04, tol*||rhs|| = 7.162e-04

Anderson update took 95.609 ms, out of which F'*F took 44.729 ms; b-Ax took 305.033 ms, out of which Lap took 271.517 ms
Solving Poisson took 646.835 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.074322 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.076019 
Total time for convolution: 	 convolve: 5.076703 
Total time for convolution: 	 convolve: 5.075800 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 1.467 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.715 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.213 ms

This SCF took 27191.292 ms, scf error = 5.597e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.131694, lowerbound = -0.924571, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1728.999 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.013 ms
rank =  0, Distribute orbital to block cyclic format took 17.763 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.064 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.849 ms
rank =  0, finding HY took 28.986 ms
rank =  0, distributing HY into block cyclic form took 17.770 ms
rank =  0, finding Y'*HY took 5.314 ms
Rank 0, Project_Hamiltonian used 73.955 ms
Total time for projection: 73.967 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.923956298543574
    last  calculated eigval = 0.031763867458942
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55167618914327
lambda[   5] =  -0.52648181256286
lambda[   6] =  -0.50020365889174
lambda[   7] =  -0.38587510661856
lambda[   8] =  -0.38293433815689
lambda[   9] =  -0.37883890631457
lambda[  10] =  -0.35183889139215
lambda[  11] =  -0.24463313077637
lambda[  12] =  -0.21810544096305
lambda[  13] =  -0.19827630145546
lambda[  14] =  -0.02768752788716
lambda[  15] =  -0.00754980513744
lambda[  16] =   0.01146171579473
lambda[  17] =   0.02326584016542
lambda[  18] =   0.02392972638516
lambda[  19] =   0.02583932672171
lambda[  20] =   0.03176386745894
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 7.386 ms
rank =  0, Distributing orbital back into band + domain format took 16.973 ms
rank = 0, Subspace_Rotation used 24.378 ms

Total time for subspace rotation: 24.383 ms
rank = 0, Efermi =  -0.056696236370 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.295 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.648 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.247 ms
rank = 0, Calculating density took 1835.884 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.749 ms
rank = 0, D2D took 1.218 ms
rank = 0, Transfering density took 1.225 ms
Etot    =   -41.180609288789
Eband   =   -12.231081513175
E1      =    28.124781336911
E2      =   -11.280764998408
E3      =   -15.607340181018
Exc     =   -13.957039573303
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 1.030e-05, dEband = 1.740e-03
rank = 0, Calculating/Estimating energy took 1.526 ms, Etot = -41.180609289, dEtot = 1.030e-05, dEband = 1.740e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0682416445340, which took 0.098 ms

iter_count = 108, r_2norm = 2.548e-06, tol*||rhs|| = 2.730e-06

Anderson update took 57.272 ms, out of which F'*F took 26.706 ms; b-Ax took 182.139 ms, out of which Lap took 162.171 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.932 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382213, int_b + int_rho = 5.821e-14, checking this took 0.104 ms
2-norm of RHS = 716.2096350977115, which took 0.107 ms

iter_count = 192, r_2norm = 6.363e-04, tol*||rhs|| = 7.162e-04

Anderson update took 102.244 ms, out of which F'*F took 47.646 ms; b-Ax took 326.916 ms, out of which Lap took 291.658 ms
Solving Poisson took 690.433 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.097872 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.082222 
Total time for convolution: 	 convolve: 5.084034 
Total time for convolution: 	 convolve: 5.082594 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.815 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.586 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 1.424 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.713 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.169 ms

This SCF took 27276.075 ms, scf error = 4.375e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.131764, lowerbound = -0.923956, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1730.319 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.745 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.062 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 21.828 ms
rank =  0, finding HY took 28.992 ms
rank =  0, distributing HY into block cyclic form took 17.782 ms
rank =  0, finding Y'*HY took 5.345 ms
Rank 0, Project_Hamiltonian used 73.974 ms
Total time for projection: 73.987 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -0.923338784713648
    last  calculated eigval = 0.033092164732182
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55108634702867
lambda[   5] =  -0.52587676744716
lambda[   6] =  -0.49960257583814
lambda[   7] =  -0.38527960597142
lambda[   8] =  -0.38234453514931
lambda[   9] =  -0.37820832733360
lambda[  10] =  -0.35124699315214
lambda[  11] =  -0.24403247773687
lambda[  12] =  -0.21759433547654
lambda[  13] =  -0.19765054339949
lambda[  14] =  -0.02366859107999
lambda[  15] =  -0.00694586856087
lambda[  16] =   0.01480168463408
lambda[  17] =   0.02427958696784
lambda[  18] =   0.02590283700179
lambda[  19] =   0.02826436206047
lambda[  20] =   0.03309216473218
==subpsace eigenproblem: bcast eigvals took 0.036 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 7.238 ms
rank =  0, Distributing orbital back into band + domain format took 17.092 ms
rank = 0, Subspace_Rotation used 24.348 ms

Total time for subspace rotation: 24.354 ms
rank = 0, Efermi =  -0.052677299529 calculate fermi energy took 0.261 ms
rank = 0, --- Calculate rho: sum over local bands took 4.398 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.027 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.234 ms
rank = 0, Calculating density took 1837.904 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.885 ms
rank = 0, D2D took 1.987 ms
rank = 0, Transfering density took 1.994 ms
Etot    =   -41.180746902960
Eband   =   -12.215570639925
E1      =    28.118025636180
E2      =   -11.271819675765
E3      =   -15.607793141755
Exc     =   -13.957439998087
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 1.529e-05, dEband = 1.723e-03
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -41.180746903, dEtot = 1.529e-05, dEband = 1.723e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0502069831228, which took 0.058 ms

iter_count = 114, r_2norm = 1.298e-06, tol*||rhs|| = 2.008e-06

Anderson update took 60.130 ms, out of which F'*F took 28.038 ms; b-Ax took 196.698 ms, out of which Lap took 171.689 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 444.174 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382211, int_b + int_rho = 3.274e-14, checking this took 0.104 ms
2-norm of RHS = 716.2103532410453, which took 0.109 ms

iter_count = 150, r_2norm = 6.568e-04, tol*||rhs|| = 7.162e-04

Anderson update took 79.416 ms, out of which F'*F took 37.359 ms; b-Ax took 255.821 ms, out of which Lap took 227.915 ms
Solving Poisson took 540.115 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.080233 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.108131 
Total time for convolution: 	 convolve: 5.080652 
Total time for convolution: 	 convolve: 5.075472 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.821 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.408 ms
---Transfer Veff_loc: D2D took 1.465 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.691 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.187 ms

This SCF took 27158.360 ms, scf error = 2.741e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.133092, lowerbound = -0.923339, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1731.368 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.763 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.130 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.917 ms
rank =  0, finding HY took 28.984 ms
rank =  0, distributing HY into block cyclic form took 17.796 ms
rank =  0, finding Y'*HY took 5.349 ms
Rank 0, Project_Hamiltonian used 74.071 ms
Total time for projection: 74.084 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.923123895261474
    last  calculated eigval = 0.033442617043992
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55087938829971
lambda[   5] =  -0.52566113139340
lambda[   6] =  -0.49939525093481
lambda[   7] =  -0.38507129624771
lambda[   8] =  -0.38213880452413
lambda[   9] =  -0.37799642981970
lambda[  10] =  -0.35103876826870
lambda[  11] =  -0.24380738070216
lambda[  12] =  -0.21733852402379
lambda[  13] =  -0.19744932920957
lambda[  14] =  -0.02254024248536
lambda[  15] =  -0.00678842296344
lambda[  16] =   0.01445195258751
lambda[  17] =   0.02447563680892
lambda[  18] =   0.02609198780202
lambda[  19] =   0.02891808207075
lambda[  20] =   0.03344261704399
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 7.235 ms
rank =  0, Distributing orbital back into band + domain format took 16.990 ms
rank = 0, Subspace_Rotation used 24.242 ms

Total time for subspace rotation: 24.249 ms
rank = 0, Efermi =  -0.051548950952 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.232 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.699 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.248 ms
rank = 0, Calculating density took 1838.227 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
rank = 0, D2D took 0.920 ms
rank = 0, Transfering density took 0.928 ms
Etot    =   -41.180788128844
Eband   =   -12.209968479500
E1      =    28.115062974275
E2      =   -11.269045202378
E3      =   -15.608254944426
Exc     =   -13.957808051775
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 4.581e-06, dEband = 6.225e-04
rank = 0, Calculating/Estimating energy took 1.608 ms, Etot = -41.180788129, dEtot = 4.581e-06, dEband = 6.225e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0407231192325, which took 0.049 ms

iter_count = 108, r_2norm = 1.610e-06, tol*||rhs|| = 1.629e-06

Anderson update took 57.277 ms, out of which F'*F took 26.748 ms; b-Ax took 182.285 ms, out of which Lap took 162.283 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.133 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382221, int_b + int_rho = 1.382e-13, checking this took 0.105 ms
2-norm of RHS = 716.2136536109048, which took 0.089 ms

iter_count = 144, r_2norm = 6.056e-04, tol*||rhs|| = 7.162e-04

Anderson update took 76.622 ms, out of which F'*F took 35.848 ms; b-Ax took 244.216 ms, out of which Lap took 217.755 ms
Solving Poisson took 518.376 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.077293 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.099186 
Total time for convolution: 	 convolve: 5.122858 
Total time for convolution: 	 convolve: 5.081752 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.559 ms
---Transfer Veff_loc: D2D took 1.472 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.713 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.213 ms

This SCF took 27118.205 ms, scf error = 2.065e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133443, lowerbound = -0.923124, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1722.198 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.819 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.079 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.925 ms
rank =  0, finding HY took 29.073 ms
rank =  0, distributing HY into block cyclic form took 17.649 ms
rank =  0, finding Y'*HY took 5.383 ms
Rank 0, Project_Hamiltonian used 74.085 ms
Total time for projection: 74.098 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.923037883864257
    last  calculated eigval = 0.034312533975288
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55078008608690
lambda[   5] =  -0.52556755457247
lambda[   6] =  -0.49929395719406
lambda[   7] =  -0.38497804086766
lambda[   8] =  -0.38204758127113
lambda[   9] =  -0.37789818998053
lambda[  10] =  -0.35095048373126
lambda[  11] =  -0.24371876510883
lambda[  12] =  -0.21726242644812
lambda[  13] =  -0.19736017711229
lambda[  14] =  -0.02162581058029
lambda[  15] =  -0.00670570555703
lambda[  16] =   0.01396113672447
lambda[  17] =   0.02458216138019
lambda[  18] =   0.02683893879688
lambda[  19] =   0.02984686647242
lambda[  20] =   0.03431253397529
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 7.231 ms
rank =  0, Distributing orbital back into band + domain format took 17.372 ms
rank = 0, Subspace_Rotation used 24.614 ms

Total time for subspace rotation: 24.620 ms
rank = 0, Efermi =  -0.050634519019 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.394 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.512 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.247 ms
rank = 0, Calculating density took 1829.390 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.820 ms
rank = 0, D2D took 0.970 ms
rank = 0, Transfering density took 0.973 ms
Etot    =   -41.180819963869
Eband   =   -12.207613463018
E1      =    28.114147638500
E2      =   -11.267596188957
E3      =   -15.608176483378
Exc     =   -13.957752093038
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 3.537e-06, dEband = 2.617e-04
rank = 0, Calculating/Estimating energy took 0.916 ms, Etot = -41.180819964, dEtot = 3.537e-06, dEband = 2.617e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0374957736450, which took 0.094 ms

iter_count = 108, r_2norm = 1.492e-06, tol*||rhs|| = 1.500e-06

Anderson update took 57.342 ms, out of which F'*F took 26.694 ms; b-Ax took 181.949 ms, out of which Lap took 162.360 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.408 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382220, int_b + int_rho = 1.273e-13, checking this took 0.133 ms
2-norm of RHS = 716.2123838206389, which took 0.086 ms

iter_count = 126, r_2norm = 6.487e-04, tol*||rhs|| = 7.162e-04

Anderson update took 66.878 ms, out of which F'*F took 31.322 ms; b-Ax took 213.340 ms, out of which Lap took 189.845 ms
Solving Poisson took 453.572 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.078920 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.075749 
Total time for convolution: 	 convolve: 5.077809 
Total time for convolution: 	 convolve: 5.078320 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.468 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.001 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.716 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.215 ms

This SCF took 26981.146 ms, scf error = 1.872e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.134313, lowerbound = -0.923038, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1733.233 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 25.733 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.937 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 29.697 ms
rank =  0, finding HY took 29.045 ms
rank =  0, distributing HY into block cyclic form took 17.717 ms
rank =  0, finding Y'*HY took 5.319 ms
Rank 0, Project_Hamiltonian used 81.810 ms
Total time for projection: 81.828 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -0.922881770510884
    last  calculated eigval = 0.034515955460851
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55063936757898
lambda[   5] =  -0.52542176572343
lambda[   6] =  -0.49916009870611
lambda[   7] =  -0.38483616825814
lambda[   8] =  -0.38191161857042
lambda[   9] =  -0.37775458567530
lambda[  10] =  -0.35080873864525
lambda[  11] =  -0.24357645505013
lambda[  12] =  -0.21712419776641
lambda[  13] =  -0.19722213342288
lambda[  14] =  -0.02163855597947
lambda[  15] =  -0.00660641096187
lambda[  16] =   0.01357969046031
lambda[  17] =   0.02460884659802
lambda[  18] =   0.02712833997473
lambda[  19] =   0.02964545197411
lambda[  20] =   0.03451595546085
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 7.235 ms
rank =  0, Distributing orbital back into band + domain format took 17.342 ms
rank = 0, Subspace_Rotation used 24.591 ms

Total time for subspace rotation: 24.597 ms
rank = 0, Efermi =  -0.050647264430 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 4.408 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.430 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.266 ms
rank = 0, Calculating density took 1848.093 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.833 ms
rank = 0, D2D took 0.970 ms
rank = 0, Transfering density took 0.977 ms
Etot    =   -41.180843015489
Eband   =   -12.203897475059
E1      =    28.112131288080
E2      =   -11.265805086234
E3      =   -15.608477980427
Exc     =   -13.957985176525
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 2.561e-06, dEband = 4.129e-04
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -41.180843015, dEtot = 2.561e-06, dEband = 4.129e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0240012657899, which took 0.106 ms

iter_count = 108, r_2norm = 9.076e-07, tol*||rhs|| = 9.601e-07

Anderson update took 57.312 ms, out of which F'*F took 26.672 ms; b-Ax took 182.271 ms, out of which Lap took 162.360 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.091 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382223, int_b + int_rho = 1.528e-13, checking this took 0.114 ms
2-norm of RHS = 716.2148442382347, which took 0.100 ms

iter_count = 150, r_2norm = 5.946e-04, tol*||rhs|| = 7.162e-04

Anderson update took 79.603 ms, out of which F'*F took 37.221 ms; b-Ax took 254.612 ms, out of which Lap took 226.798 ms
Solving Poisson took 539.737 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.085495 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.087628 
Total time for convolution: 	 convolve: 5.079542 
Total time for convolution: 	 convolve: 5.084225 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 1.453 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.789 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.296 ms

This SCF took 27114.220 ms, scf error = 1.532e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.134516, lowerbound = -0.922882, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1729.542 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.759 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.094 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 21.883 ms
rank =  0, finding HY took 28.999 ms
rank =  0, distributing HY into block cyclic form took 17.674 ms
rank =  0, finding Y'*HY took 5.357 ms
Rank 0, Project_Hamiltonian used 73.943 ms
Total time for projection: 73.956 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.922641435073839
    last  calculated eigval = 0.035502408035648
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55042328483599
lambda[   5] =  -0.52520944611662
lambda[   6] =  -0.49895433927082
lambda[   7] =  -0.38462785081643
lambda[   8] =  -0.38170794281115
lambda[   9] =  -0.37753099392888
lambda[  10] =  -0.35060086045385
lambda[  11] =  -0.24336213472384
lambda[  12] =  -0.21693818024072
lambda[  13] =  -0.19701409441253
lambda[  14] =  -0.02160046822902
lambda[  15] =  -0.00643723239889
lambda[  16] =   0.01372695638218
lambda[  17] =   0.02469914982590
lambda[  18] =   0.02794553139294
lambda[  19] =   0.02972494803731
lambda[  20] =   0.03550240803565
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 7.231 ms
rank =  0, Distributing orbital back into band + domain format took 17.429 ms
rank = 0, Subspace_Rotation used 24.673 ms

Total time for subspace rotation: 24.678 ms
rank = 0, Efermi =  -0.050609176674 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.437 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.424 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.441 ms
rank = 0, Calculating density took 1836.803 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.873 ms
rank = 0, D2D took 1.002 ms
rank = 0, Transfering density took 1.004 ms
Etot    =   -41.180867709785
Eband   =   -12.198352165024
E1      =    28.109508985238
E2      =   -11.262774937216
E3      =   -15.608743051386
Exc     =   -13.958167799955
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 2.744e-06, dEband = 6.161e-04
rank = 0, Calculating/Estimating energy took 0.890 ms, Etot = -41.180867710, dEtot = 2.744e-06, dEband = 6.161e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0217308358952, which took 0.091 ms

iter_count = 108, r_2norm = 8.512e-07, tol*||rhs|| = 8.692e-07

Anderson update took 57.221 ms, out of which F'*F took 26.711 ms; b-Ax took 182.118 ms, out of which Lap took 162.510 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.636 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382215, int_b + int_rho = 8.004e-14, checking this took 0.110 ms
2-norm of RHS = 716.2147269507932, which took 0.799 ms

iter_count = 108, r_2norm = 6.209e-04, tol*||rhs|| = 7.162e-04

Anderson update took 57.297 ms, out of which F'*F took 27.023 ms; b-Ax took 183.359 ms, out of which Lap took 163.362 ms
Solving Poisson took 390.187 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.074152 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.087120 
Total time for convolution: 	 convolve: 5.078299 
Total time for convolution: 	 convolve: 5.075921 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 1.432 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.673 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.134 ms

This SCF took 26925.984 ms, scf error = 1.155e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.135502, lowerbound = -0.922641, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1734.879 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.860 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.022 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 21.913 ms
rank =  0, finding HY took 29.019 ms
rank =  0, distributing HY into block cyclic form took 16.984 ms
rank =  0, finding Y'*HY took 6.993 ms
Rank 0, Project_Hamiltonian used 74.936 ms
Total time for projection: 74.947 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.922618350255658
    last  calculated eigval = 0.036431847413906
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55039359390944
lambda[   5] =  -0.52518156668655
lambda[   6] =  -0.49892266296113
lambda[   7] =  -0.38459876646229
lambda[   8] =  -0.38167703377781
lambda[   9] =  -0.37750417114069
lambda[  10] =  -0.35057297527411
lambda[  11] =  -0.24333820347781
lambda[  12] =  -0.21691903038740
lambda[  13] =  -0.19698546419977
lambda[  14] =  -0.02129088951556
lambda[  15] =  -0.00641183567952
lambda[  16] =   0.01392902112467
lambda[  17] =   0.02471338808615
lambda[  18] =   0.02836573924405
lambda[  19] =   0.02990376877634
lambda[  20] =   0.03643184741391
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 7.241 ms
rank =  0, Distributing orbital back into band + domain format took 17.417 ms
rank = 0, Subspace_Rotation used 24.671 ms

Total time for subspace rotation: 24.676 ms
rank = 0, Efermi =  -0.050299597945 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.402 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.492 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.232 ms
rank = 0, Calculating density took 1842.948 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.835 ms
rank = 0, D2D took 0.967 ms
rank = 0, Transfering density took 0.970 ms
Etot    =   -41.180865859856
Eband   =   -12.197650041564
E1      =    28.109223759569
E2      =   -11.262363036529
E3      =   -15.608726828037
Exc     =   -13.958154723779
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 2.055e-07, dEband = 7.801e-05
rank = 0, Calculating/Estimating energy took 0.901 ms, Etot = -41.180865860, dEtot = 2.055e-07, dEband = 7.801e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0232861746978, which took 1.069 ms

iter_count = 108, r_2norm = 7.840e-07, tol*||rhs|| = 9.314e-07

Anderson update took 57.644 ms, out of which F'*F took 26.963 ms; b-Ax took 183.428 ms, out of which Lap took 163.793 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.915 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382209, int_b + int_rho = 1.455e-14, checking this took 0.098 ms
2-norm of RHS = 716.2154046083153, which took 0.114 ms

iter_count = 108, r_2norm = 7.063e-04, tol*||rhs|| = 7.162e-04

Anderson update took 57.709 ms, out of which F'*F took 27.205 ms; b-Ax took 183.425 ms, out of which Lap took 164.121 ms
Solving Poisson took 390.233 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.075900 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.094297 
Total time for convolution: 	 convolve: 5.078308 
Total time for convolution: 	 convolve: 5.074127 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.391 ms
---Transfer Veff_loc: D2D took 1.438 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.714 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.183 ms

This SCF took 26937.518 ms, scf error = 1.152e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.136432, lowerbound = -0.922618, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1736.381 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.026 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.866 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 21.921 ms
rank =  0, finding HY took 29.112 ms
rank =  0, distributing HY into block cyclic form took 17.608 ms
rank =  0, finding Y'*HY took 5.340 ms
Rank 0, Project_Hamiltonian used 74.010 ms
Total time for projection: 74.020 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -0.922648874586707
    last  calculated eigval = 0.037189420929035
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55040991142812
lambda[   5] =  -0.52520043397141
lambda[   6] =  -0.49893590674452
lambda[   7] =  -0.38461552618956
lambda[   8] =  -0.38169119457675
lambda[   9] =  -0.37752640140382
lambda[  10] =  -0.35058940311888
lambda[  11] =  -0.24336141041552
lambda[  12] =  -0.21694354074377
lambda[  13] =  -0.19700232791438
lambda[  14] =  -0.02137326845614
lambda[  15] =  -0.00644837406967
lambda[  16] =   0.01393668662498
lambda[  17] =   0.02464709672663
lambda[  18] =   0.02852351211693
lambda[  19] =   0.02979272103818
lambda[  20] =   0.03718942092903
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 7.207 ms
rank =  0, Distributing orbital back into band + domain format took 17.359 ms
rank = 0, Subspace_Rotation used 24.578 ms

Total time for subspace rotation: 24.584 ms
rank = 0, Efermi =  -0.050381976879 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.405 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.413 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.273 ms
rank = 0, Calculating density took 1843.393 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.836 ms
rank = 0, D2D took 0.987 ms
rank = 0, Transfering density took 0.990 ms
Etot    =   -41.180868644926
Eband   =   -12.198166580169
E1      =    28.109572344611
E2      =   -11.262561645690
E3      =   -15.608585290945
Exc     =   -13.958046627356
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 3.095e-07, dEband = 5.739e-05
rank = 0, Calculating/Estimating energy took 0.971 ms, Etot = -41.180868645, dEtot = 3.095e-07, dEband = 5.739e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0230975196541, which took 0.129 ms

iter_count = 108, r_2norm = 7.966e-07, tol*||rhs|| = 9.239e-07

Anderson update took 57.490 ms, out of which F'*F took 27.052 ms; b-Ax took 183.712 ms, out of which Lap took 164.109 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.477 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382215, int_b + int_rho = 8.004e-14, checking this took 0.108 ms
2-norm of RHS = 716.2151771971936, which took 0.097 ms

iter_count = 78, r_2norm = 6.388e-04, tol*||rhs|| = 7.162e-04

Anderson update took 41.828 ms, out of which F'*F took 19.565 ms; b-Ax took 133.265 ms, out of which Lap took 118.785 ms
Solving Poisson took 283.794 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.077198 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.075860 
Total time for convolution: 	 convolve: 5.097625 
Total time for convolution: 	 convolve: 5.078176 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 1.461 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.711 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.203 ms

This SCF took 26836.326 ms, scf error = 1.220e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.137189, lowerbound = -0.922649, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1737.931 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.780 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.961 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 21.766 ms
rank =  0, finding HY took 28.971 ms
rank =  0, distributing HY into block cyclic form took 17.698 ms
rank =  0, finding Y'*HY took 5.357 ms
Rank 0, Project_Hamiltonian used 73.820 ms
Total time for projection: 73.833 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.922630206249117
    last  calculated eigval = 0.037292369161978
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55039095610986
lambda[   5] =  -0.52517900786595
lambda[   6] =  -0.49891320122762
lambda[   7] =  -0.38459398982724
lambda[   8] =  -0.38166802467509
lambda[   9] =  -0.37750539436591
lambda[  10] =  -0.35056737154511
lambda[  11] =  -0.24334058574964
lambda[  12] =  -0.21692152555737
lambda[  13] =  -0.19697900970668
lambda[  14] =  -0.02088256431472
lambda[  15] =  -0.00640700225494
lambda[  16] =   0.01421446884198
lambda[  17] =   0.02469972927862
lambda[  18] =   0.02875974049276
lambda[  19] =   0.03002422417529
lambda[  20] =   0.03729236916198
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 7.253 ms
rank =  0, Distributing orbital back into band + domain format took 17.399 ms
rank = 0, Subspace_Rotation used 24.664 ms

Total time for subspace rotation: 24.669 ms
rank = 0, Efermi =  -0.049891272788 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.442 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.378 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.246 ms
rank = 0, Calculating density took 1844.846 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 0.894 ms
rank = 0, D2D took 1.566 ms
rank = 0, Transfering density took 1.571 ms
Etot    =   -41.180870951322
Eband   =   -12.197614973416
E1      =    28.109332275425
E2      =   -11.262246989631
E3      =   -15.608598182226
Exc     =   -13.958058706541
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 2.563e-07, dEband = 6.129e-05
rank = 0, Calculating/Estimating energy took 1.028 ms, Etot = -41.180870951, dEtot = 2.563e-07, dEband = 6.129e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0260143724830, which took 0.102 ms

iter_count = 108, r_2norm = 7.656e-07, tol*||rhs|| = 1.041e-06

Anderson update took 57.605 ms, out of which F'*F took 26.979 ms; b-Ax took 183.475 ms, out of which Lap took 163.833 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.253 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382232, int_b + int_rho = 2.437e-13, checking this took 0.104 ms
2-norm of RHS = 716.2134716068172, which took 0.119 ms

iter_count = 126, r_2norm = 6.907e-04, tol*||rhs|| = 7.162e-04

Anderson update took 67.394 ms, out of which F'*F took 31.513 ms; b-Ax took 213.825 ms, out of which Lap took 191.014 ms
Solving Poisson took 454.969 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.076533 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.074286 
Total time for convolution: 	 convolve: 5.078833 
Total time for convolution: 	 convolve: 5.078447 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.141 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 1.453 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.698 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.182 ms

This SCF took 26998.888 ms, scf error = 1.317e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.137292, lowerbound = -0.922630, upperbound = 267.584013

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1728.089 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.800 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.090 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.914 ms
rank =  0, finding HY took 28.984 ms
rank =  0, distributing HY into block cyclic form took 17.682 ms
rank =  0, finding Y'*HY took 5.370 ms
Rank 0, Project_Hamiltonian used 73.976 ms
Total time for projection: 73.987 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.922647872017010
    last  calculated eigval = 0.035286686481805
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55041295852301
lambda[   5] =  -0.52521046013467
lambda[   6] =  -0.49894748397035
lambda[   7] =  -0.38462550972522
lambda[   8] =  -0.38170080648528
lambda[   9] =  -0.37753340147833
lambda[  10] =  -0.35060764856502
lambda[  11] =  -0.24337401341884
lambda[  12] =  -0.21696949821048
lambda[  13] =  -0.19701601222017
lambda[  14] =  -0.02302903071958
lambda[  15] =  -0.00650586868117
lambda[  16] =   0.01251069605981
lambda[  17] =   0.02443722838346
lambda[  18] =   0.02703382272543
lambda[  19] =   0.02806232579325
lambda[  20] =   0.03528668648180
==subpsace eigenproblem: bcast eigvals took 0.049 ms
Total time for solving subspace eigenvalue problem: 0.228 ms
rank =  0, subspace rotation using ScaLAPACK took 7.232 ms
rank =  0, Distributing orbital back into band + domain format took 17.416 ms
rank = 0, Subspace_Rotation used 24.685 ms

Total time for subspace rotation: 24.690 ms
rank = 0, Efermi =  -0.052037739166 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 4.354 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.612 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.219 ms
rank = 0, Calculating density took 1835.295 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.860 ms
rank = 0, D2D took 0.971 ms
rank = 0, Transfering density took 0.978 ms
Etot    =   -41.180876468359
Eband   =   -12.198434228077
E1      =    28.109563589969
E2      =   -11.262825440988
E3      =   -15.608593664562
Exc     =   -13.958050217152
Esc     =   -70.005374717936
Entropy =    -0.000000000712
dE = 6.130e-07, dEband = 9.103e-05
rank = 0, Calculating/Estimating energy took 1.061 ms, Etot = -41.180876468, dEtot = 6.130e-07, dEband = 9.103e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0254434813987, which took 0.111 ms

iter_count = 108, r_2norm = 7.599e-07, tol*||rhs|| = 1.018e-06

Anderson update took 57.787 ms, out of which F'*F took 26.923 ms; b-Ax took 183.410 ms, out of which Lap took 163.785 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.058 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002382207, int_rho =  26.00000002382217, int_b + int_rho = 1.019e-13, checking this took 0.108 ms
2-norm of RHS = 716.2120547242208, which took 0.117 ms

iter_count = 90, r_2norm = 6.730e-04, tol*||rhs|| = 7.162e-04

Anderson update took 48.221 ms, out of which F'*F took 22.470 ms; b-Ax took 153.236 ms, out of which Lap took 136.870 ms
Solving Poisson took 326.630 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.081914 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.095015 
Total time for convolution: 	 convolve: 5.078508 
Total time for convolution: 	 convolve: 5.079029 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.599 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 1.473 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.443 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.941 ms

This SCF took 26892.449 ms, scf error = 9.932e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.55041295852301, occ[   4] =   2.00000000000000
lambda[   5] =  -0.52521046013467, occ[   5] =   2.00000000000000
lambda[   6] =  -0.49894748397035, occ[   6] =   2.00000000000000
lambda[   7] =  -0.38462550972522, occ[   7] =   2.00000000000000
lambda[   8] =  -0.38170080648528, occ[   8] =   2.00000000000000
lambda[   9] =  -0.37753340147833, occ[   9] =   2.00000000000000
lambda[  10] =  -0.35060764856502, occ[  10] =   2.00000000000000
lambda[  11] =  -0.24337401341884, occ[  11] =   2.00000000000000
lambda[  12] =  -0.21696949821048, occ[  12] =   2.00000000000000
lambda[  13] =  -0.19701601222017, occ[  13] =   2.00000000000000
lambda[  14] =  -0.02302903071958, occ[  14] =   0.00000002382217
lambda[  15] =  -0.00650586868117, occ[  15] =   0.00000000000000
lambda[  16] =   0.01251069605981, occ[  16] =   0.00000000000000
lambda[  17] =   0.02443722838346, occ[  17] =   0.00000000000000
lambda[  18] =   0.02703382272543, occ[  18] =   0.00000000000000
lambda[  19] =   0.02806232579325, occ[  19] =   0.00000000000000
lambda[  20] =   0.03528668648180, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.697 ms, time for Allreduce/Reduce: 10.689 ms 
Time for calculating local force components: 22.483 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00097509579665  -0.06787857923927  -0.00000000592088
  0.05051216643564  -0.01792723253479   0.00000000872749
 -0.04972966108192  -0.01894511150571   0.00000005253704
 -0.02769570410821   0.04524255114103  -0.00000000785295
  0.13148012439560   0.05511427389601   0.00000011819224
 -0.13700506874395   0.13710596812829  -0.00000087697169
 -0.08458929443461   0.02435624009944  -0.00000024669984
  0.00849005156054  -0.02331853266304   0.00000126421396
  0.48779799723568   0.71985710678236  -0.00000050082909
force_loc = 
 -0.00067275481454   0.07299347294911  -0.00000029553044
 -0.05430826730740   0.01946231408890  -0.00000005164841
  0.05290224392046   0.02046062377049  -0.00000072916004
  0.02964697459535  -0.04865103466744   0.00000029469410
 -0.13408871568609  -0.04859120591173   0.00000004130740
  0.13464107324491  -0.12876188554205  -0.00000499246023
  0.07990998047205  -0.02936591217621   0.00000479942561
 -0.00589979892436   0.02220082066200   0.00000141671509
 -0.47089775590452  -0.70569534410180   0.00000366468463
Time for calculating nonlocal force components: 41.746 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00129708029473  -0.00541260809366  -0.00000002217831
[0m[32m  0.00158551393383  -0.00770301633606  -0.00000027072862
[0m[32m  0.00215536127395   0.00340570798978   0.00000034164722
[0m[32m -0.00099692937008  -0.00149245434321   0.00000004999506
[0m[32m -0.01298285602730  -0.01623302183201   0.00000025209461
[0mTime for calculating XC forces components: 31.615 ms
 Cartesian force = 
  0.00030981918578   0.00509010031424  -0.00000077970176
 -0.00378862266809   0.00151028815851  -0.00000052117135
  0.00318006104221   0.00149071886918  -0.00000115487344
  0.00195874869082  -0.00343327692201  -0.00000019140929
 -0.00389819338155   0.00108566649502  -0.00000034092911
 -0.00077100336154   0.00061627285458  -0.00000661841098
 -0.00251647448493  -0.00162875748260   0.00000441612255
  0.00160080146976  -0.00263495973985   0.00000225267366
  0.00392486350753  -0.00209605254706   0.00000293769971
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.203 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Time for printing density: 389.393 ms
The program took 579.391 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:31:42
Job ID:        2266799
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:57:48,vmem=8408K,walltime=00:09:49,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-011-8-2
---------------------------------------
