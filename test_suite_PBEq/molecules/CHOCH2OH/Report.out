---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:24
Job ID:    2266918
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:29
Job ID:    2266918
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.085 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 1.117 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 8.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 0.794 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 10.029 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.973 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.100 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    6.830079	   10.890692	   10.000000	
   10.309732	    7.222620	   10.000000	
    6.844934	    9.057458	   10.000000	
    9.839371	   12.777380	   11.664645	
    9.839371	   12.777380	    8.335355	
   13.169921	    9.768501	   10.000000	
    9.365245	   11.610997	   10.000000	
   11.114046	    9.357571	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.179 ms
Set up communicators.

--set up spincomm took 3.878 ms

--set up kptcomm took 0.343 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 19, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 19 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 19, mbQ = nbQ = 64
rank = 0, nr_Hp = 19, nc_Hp = 19
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.041 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.686 ms

Calculate_SplineDerivRadFun took 0.227 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.782 ms.
time spent on vectorized spline interp: 3.105 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.723 ms.
time spent on vectorized spline interp: 1.358 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.290 ms.
time spent on vectorized spline interp: 1.683 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.323 ms.

Calculating rb for all atom types took 16.290 ms
----------------------
Estimated memory usage
Total: 1.16 GB
orbitals             : 869.75 MB
global sized vectors : 213.62 MB
subspace matrices : 8.46 kB
others : 108.34 MB
----------------------------------------------
Estimated memory usage per processor: 99.31 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.833 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.015 ms
Calculating pseudocharge density ... 
the global sum of int_b = -24.0000000226315, sum_int_rho = 23.5965867219627
PosCharge = 24.000000022631, NegCharge = -23.596586721963, scal_fac = 1.017096256566
After scaling, int_rho = 24.0000000226316, PosCharge + NegCharge - NetCharge = -1.208e-13
--Calculate Vref took 0.478 ms
--Calculate rho_guess took 2.604 ms

 integral of b = -24.0000000226315,
 int{b} + Nelectron + NetCharge = -2.263e-08,
 Esc = -74.5470561965944,
 MPI_Reduce took 8.152 ms

Calculating b & b_ref took 17.743 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.072 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.086 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.100 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.632 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.638 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263155, int_b + int_rho = 1.164e-13, checking this took 7.363 ms
2-norm of RHS = 697.5322725859887, which took 0.502 ms

iter_count = 420, r_2norm = 5.946e-04, tol*||rhs|| = 6.975e-04

Anderson update took 253.770 ms, out of which F'*F took 106.124 ms; b-Ax took 717.526 ms, out of which Lap took 645.172 ms
Solving Poisson took 1548.442 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.412 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.821 ms
Total time for convolution: 	 convolve: 5.144693 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 42.648 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.786 ms
Total time for convolution: 	 convolve: 5.148494 
Total time for convolution: 	 convolve: 5.182717 
Total time for convolution: 	 convolve: 5.140774 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.685 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.455 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
rank = 0, XC calculation took 24567.066 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 4.822 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.056 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.008 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.151 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.664 ms
    Lanczos iter 53, eigmin  = -1.059504493, eigmax = 264.930022129, err_eigmin = 6.859e-04, err_eigmax = 9.637e-03
rank =   0, Lanczos took 120.555 ms, eigmin = -1.059504493270, eigmax = 267.579322350460

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.209909, lowerbound = -1.159504, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1440.969 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.876 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.697 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.605 ms
rank =  0, finding HY took 24.513 ms
rank =  0, distributing HY into block cyclic form took 20.448 ms
rank =  0, finding Y'*HY took 4.025 ms
Rank 0, Project_Hamiltonian used 71.638 ms
Total time for projection: 72.181 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.454 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.108 ms
rank = 0, Solve_Generalized_EigenProblem used 1.568 ms
    first calculated eigval = 2.753210866345162
    last  calculated eigval = 3.254402679929175
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =   2.78430255352920
lambda[   4] =   2.84547116598904
lambda[   5] =   2.87060145272581
lambda[   6] =   2.90929579411601
lambda[   7] =   2.92648816993020
lambda[   8] =   2.95488146936105
lambda[   9] =   2.98666656307790
lambda[  10] =   3.00053245802605
lambda[  11] =   3.00700710512281
lambda[  12] =   3.03419657984626
lambda[  13] =   3.07433118428720
lambda[  14] =   3.11988041784773
lambda[  15] =   3.12804013245716
lambda[  16] =   3.15926915758646
lambda[  17] =   3.18098932476727
lambda[  18] =   3.22427331246866
lambda[  19] =   3.25440267992917
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 1.590 ms
rank =  0, subspace rotation using ScaLAPACK took 6.788 ms
rank =  0, Distributing orbital back into band + domain format took 17.644 ms
rank = 0, Subspace_Rotation used 24.450 ms

Total time for subspace rotation: 24.454 ms
rank = 0, Efermi =   3.054264009406 calculate fermi energy took 0.047 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.354403, lowerbound = -1.159504, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1432.504 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 16.951 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.563 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.532 ms
rank =  0, finding HY took 23.676 ms
rank =  0, distributing HY into block cyclic form took 17.110 ms
rank =  0, finding Y'*HY took 3.634 ms
Rank 0, Project_Hamiltonian used 63.996 ms
Total time for projection: 64.001 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.150 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.257 ms
    first calculated eigval = -0.961684648661524
    last  calculated eigval = 0.456791958318579
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.46962496700475
lambda[   4] =  -0.26074290511492
lambda[   5] =  -0.20541473630299
lambda[   6] =  -0.13472513744342
lambda[   7] =  -0.05277352269239
lambda[   8] =   0.08128499469430
lambda[   9] =   0.12305215883587
lambda[  10] =   0.17465065988061
lambda[  11] =   0.19741986163349
lambda[  12] =   0.27854976531234
lambda[  13] =   0.31199411043973
lambda[  14] =   0.33602599558135
lambda[  15] =   0.34479446298146
lambda[  16] =   0.35717020081111
lambda[  17] =   0.38167227769046
lambda[  18] =   0.42264755164366
lambda[  19] =   0.45679195831858
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.266 ms
rank =  0, subspace rotation using ScaLAPACK took 6.815 ms
rank =  0, Distributing orbital back into band + domain format took 17.146 ms
rank = 0, Subspace_Rotation used 23.980 ms

Total time for subspace rotation: 23.985 ms
rank = 0, Efermi =   0.295271950925 calculate fermi energy took 0.023 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.556792, lowerbound = -1.159504, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1439.979 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.022 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.690 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.331 ms
rank =  0, finding HY took 23.748 ms
rank =  0, distributing HY into block cyclic form took 17.113 ms
rank =  0, finding Y'*HY took 3.630 ms
Rank 0, Project_Hamiltonian used 64.852 ms
Total time for projection: 64.856 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -1.067066627274660
    last  calculated eigval = 0.158565949036197
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.76500600022661
lambda[   4] =  -0.61718842275245
lambda[   5] =  -0.54388203354782
lambda[   6] =  -0.52180511349904
lambda[   7] =  -0.50811733767187
lambda[   8] =  -0.45339058771988
lambda[   9] =  -0.40431254078954
lambda[  10] =  -0.39083069282374
lambda[  11] =  -0.31131618826357
lambda[  12] =  -0.25798422663767
lambda[  13] =  -0.05857737675206
lambda[  14] =   0.04732188084105
lambda[  15] =   0.08299469078822
lambda[  16] =   0.09991189484251
lambda[  17] =   0.12786991564290
lambda[  18] =   0.13974102174900
lambda[  19] =   0.15856594903620
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 7.621 ms
rank =  0, Distributing orbital back into band + domain format took 16.725 ms
rank = 0, Subspace_Rotation used 24.366 ms

Total time for subspace rotation: 24.370 ms
rank = 0, Efermi =  -0.087632383085 calculate fermi energy took 0.024 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.258566, lowerbound = -1.159504, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1442.171 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 16.950 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.507 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.472 ms
rank =  0, finding HY took 23.727 ms
rank =  0, distributing HY into block cyclic form took 17.031 ms
rank =  0, finding Y'*HY took 3.719 ms
Rank 0, Project_Hamiltonian used 63.976 ms
Total time for projection: 63.980 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -1.067172262287570
    last  calculated eigval = 0.087746744230692
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.76611168826552
lambda[   4] =  -0.62006214884678
lambda[   5] =  -0.55161320729119
lambda[   6] =  -0.52597726508659
lambda[   7] =  -0.51679599174404
lambda[   8] =  -0.47208906669495
lambda[   9] =  -0.41529941965000
lambda[  10] =  -0.41101471461448
lambda[  11] =  -0.33733290413392
lambda[  12] =  -0.31134914355262
lambda[  13] =  -0.12377000135342
lambda[  14] =  -0.00477924317272
lambda[  15] =   0.03951254545085
lambda[  16] =   0.05011394970154
lambda[  17] =   0.06728117491775
lambda[  18] =   0.07184380773604
lambda[  19] =   0.08774674423069
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.225 ms
rank =  0, subspace rotation using ScaLAPACK took 6.778 ms
rank =  0, Distributing orbital back into band + domain format took 17.203 ms
rank = 0, Subspace_Rotation used 23.996 ms

Total time for subspace rotation: 24.000 ms
rank = 0, Efermi =  -0.152825007765 calculate fermi energy took 0.026 ms
rank = 0, --- Calculate rho: sum over local bands took 5.138 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.493 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.599 ms
rank = 0, Calculating density took 6259.943 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.851 ms
rank = 0, D2D took 1.954 ms
rank = 0, Transfering density took 1.960 ms
Etot    =   -47.558148634827
Eband   =   -14.056475068197
E1      =    27.421197289795
E2      =   -12.007827984808
E3      =   -15.215555686006
Exc     =   -13.599198329968
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 5.945e+00, dEband = 1.757e+00
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -47.558148635, dEtot = 5.945e+00, dEband = 1.757e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 67.0418505890311, which took 0.624 ms

iter_count = 90, r_2norm = 2.304e-03, tol*||rhs|| = 2.682e-03

Anderson update took 48.371 ms, out of which F'*F took 22.469 ms; b-Ax took 151.605 ms, out of which Lap took 135.868 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.507 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263165, int_b + int_rho = 2.146e-13, checking this took 0.105 ms
2-norm of RHS = 693.5068637751809, which took 0.218 ms

iter_count = 282, r_2norm = 6.182e-04, tol*||rhs|| = 6.935e-04

Anderson update took 151.256 ms, out of which F'*F took 70.531 ms; b-Ax took 473.518 ms, out of which Lap took 425.138 ms
Solving Poisson took 1011.616 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.397 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.315054 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.177063 
Total time for convolution: 	 convolve: 5.207702 
Total time for convolution: 	 convolve: 5.194233 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.157 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.153 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 3.548 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.852 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.440 ms

This SCF took 32544.371 ms, scf error = 1.413e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.187747, lowerbound = -1.067172, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1446.210 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.073 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.526 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.618 ms
rank =  0, finding HY took 23.844 ms
rank =  0, distributing HY into block cyclic form took 19.413 ms
rank =  0, finding Y'*HY took 3.541 ms
Rank 0, Project_Hamiltonian used 66.449 ms
Total time for projection: 66.461 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -1.040476951853932
    last  calculated eigval = 0.067879085506390
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.73923873751906
lambda[   4] =  -0.59678688255798
lambda[   5] =  -0.52929376008935
lambda[   6] =  -0.49753576764611
lambda[   7] =  -0.49245520202108
lambda[   8] =  -0.44378096164510
lambda[   9] =  -0.39132433669988
lambda[  10] =  -0.38134299081009
lambda[  11] =  -0.30331015868496
lambda[  12] =  -0.28604159873837
lambda[  13] =  -0.11706141010265
lambda[  14] =  -0.01598546325260
lambda[  15] =   0.00458107334826
lambda[  16] =   0.02775620989422
lambda[  17] =   0.03917710371622
lambda[  18] =   0.04499238436008
lambda[  19] =   0.06787908550639
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 7.770 ms
rank =  0, Distributing orbital back into band + domain format took 16.831 ms
rank = 0, Subspace_Rotation used 24.619 ms

Total time for subspace rotation: 24.625 ms
rank = 0, Efermi =  -0.146116416518 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.342 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.328 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.597 ms
rank = 0, Calculating density took 1554.760 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.844 ms
rank = 0, D2D took 1.946 ms
rank = 0, Transfering density took 1.952 ms
Etot    =   -47.517984139651
Eband   =   -13.405992149217
E1      =    26.872235658457
E2      =   -11.909913528428
E3      =   -15.393934947312
Exc     =   -13.741019927359
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 5.021e-03, dEband = 8.131e-02
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -47.517984140, dEtot = 5.021e-03, dEband = 8.131e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 25.7588035130306, which took 0.066 ms

iter_count = 96, r_2norm = 8.989e-04, tol*||rhs|| = 1.030e-03

Anderson update took 51.168 ms, out of which F'*F took 24.158 ms; b-Ax took 161.950 ms, out of which Lap took 145.531 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 352.405 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263154, int_b + int_rho = 1.128e-13, checking this took 0.108 ms
2-norm of RHS = 689.7303176264143, which took 0.149 ms

iter_count = 294, r_2norm = 6.049e-04, tol*||rhs|| = 6.897e-04

Anderson update took 156.384 ms, out of which F'*F took 73.395 ms; b-Ax took 498.198 ms, out of which Lap took 446.560 ms
Solving Poisson took 1054.139 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.179851 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.263 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.168485 
Total time for convolution: 	 convolve: 5.220283 
Total time for convolution: 	 convolve: 5.262929 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.503 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.761 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.302 ms

This SCF took 27842.051 ms, scf error = 9.545e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.167879, lowerbound = -1.040477, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1425.492 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.178 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.766 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.960 ms
rank =  0, finding HY took 24.879 ms
rank =  0, distributing HY into block cyclic form took 17.220 ms
rank =  0, finding Y'*HY took 3.822 ms
Rank 0, Project_Hamiltonian used 66.914 ms
Total time for projection: 66.925 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.212 ms
    first calculated eigval = -1.006498858332216
    last  calculated eigval = 0.059804912140558
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.69500849193966
lambda[   4] =  -0.55938752358011
lambda[   5] =  -0.49404227077788
lambda[   6] =  -0.45741796684529
lambda[   7] =  -0.45337838390103
lambda[   8] =  -0.40499181179660
lambda[   9] =  -0.36628306926954
lambda[  10] =  -0.33514571762776
lambda[  11] =  -0.25800412369389
lambda[  12] =  -0.25257268595491
lambda[  13] =  -0.09567241340110
lambda[  14] =  -0.02391050391269
lambda[  15] =  -0.00118963752839
lambda[  16] =   0.01823137508721
lambda[  17] =   0.03005305558259
lambda[  18] =   0.04136927738751
lambda[  19] =   0.05980491214056
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 7.812 ms
rank =  0, Distributing orbital back into band + domain format took 16.954 ms
rank = 0, Subspace_Rotation used 24.785 ms

Total time for subspace rotation: 24.792 ms
rank = 0, Efermi =  -0.124727419802 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.400 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.294 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.595 ms
rank = 0, Calculating density took 1534.558 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.853 ms
rank = 0, D2D took 1.959 ms
rank = 0, Transfering density took 1.965 ms
Etot    =   -47.487788418675
Eband   =   -12.486032407458
E1      =    26.128767980769
E2      =   -11.707467935312
E3      =   -15.668607445795
Exc     =   -13.959543175822
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 3.774e-03, dEband = 1.150e-01
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -47.487788419, dEtot = 3.774e-03, dEband = 1.150e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.0350612348438, which took 0.612 ms

iter_count = 102, r_2norm = 2.079e-04, tol*||rhs|| = 2.814e-04

Anderson update took 54.254 ms, out of which F'*F took 25.807 ms; b-Ax took 174.068 ms, out of which Lap took 156.067 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.481 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263166, int_b + int_rho = 2.328e-13, checking this took 0.111 ms
2-norm of RHS = 690.5478687385332, which took 0.147 ms

iter_count = 276, r_2norm = 5.752e-04, tol*||rhs|| = 6.905e-04

Anderson update took 147.370 ms, out of which F'*F took 69.773 ms; b-Ax took 468.955 ms, out of which Lap took 421.806 ms
Solving Poisson took 990.434 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.300086 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.205207 
Total time for convolution: 	 convolve: 5.273988 
Total time for convolution: 	 convolve: 5.186174 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.342 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.187 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.500 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.741 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.274 ms

This SCF took 27888.300 ms, scf error = 3.547e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.159805, lowerbound = -1.006499, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1420.294 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.634 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.578 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.231 ms
rank =  0, finding HY took 23.693 ms
rank =  0, distributing HY into block cyclic form took 17.058 ms
rank =  0, finding Y'*HY took 3.593 ms
Rank 0, Project_Hamiltonian used 64.610 ms
Total time for projection: 64.622 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.688 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.270 ms
rank = 0, Solve_Generalized_EigenProblem used 0.967 ms
    first calculated eigval = -0.998991961934623
    last  calculated eigval = 0.054331877762830
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.68039541634854
lambda[   4] =  -0.54770909040952
lambda[   5] =  -0.48315474476626
lambda[   6] =  -0.44729439060862
lambda[   7] =  -0.44066454831627
lambda[   8] =  -0.39488824559387
lambda[   9] =  -0.36018592927191
lambda[  10] =  -0.32759671412485
lambda[  11] =  -0.25107525615808
lambda[  12] =  -0.24436976989848
lambda[  13] =  -0.08778084431352
lambda[  14] =  -0.02807274752159
lambda[  15] =  -0.00130114740115
lambda[  16] =   0.01439894216059
lambda[  17] =   0.02580086564029
lambda[  18] =   0.04066499090048
lambda[  19] =   0.05433187776283
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.684 ms
rank =  0, subspace rotation using ScaLAPACK took 7.277 ms
rank =  0, Distributing orbital back into band + domain format took 16.818 ms
rank = 0, Subspace_Rotation used 24.113 ms

Total time for subspace rotation: 24.119 ms
rank = 0, Efermi =  -0.116835850759 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.397 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.287 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.679 ms
rank = 0, Calculating density took 1528.213 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.012 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.992 ms
rank = 0, D2D took 2.101 ms
rank = 0, Transfering density took 2.108 ms
Etot    =   -47.483917348279
Eband   =   -12.262476003825
E1      =    25.988845091815
E2      =   -11.611065017726
E3      =   -15.741853798980
Exc     =   -14.016149055703
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 4.839e-04, dEband = 2.794e-02
rank = 0, Calculating/Estimating energy took 0.904 ms, Etot = -47.483917348, dEtot = 4.839e-04, dEband = 2.794e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.2627151529767, which took 0.113 ms

iter_count = 108, r_2norm = 7.347e-05, tol*||rhs|| = 9.051e-05

Anderson update took 57.667 ms, out of which F'*F took 27.158 ms; b-Ax took 183.174 ms, out of which Lap took 164.771 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.332 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263164, int_b + int_rho = 2.110e-13, checking this took 0.103 ms
2-norm of RHS = 691.0971876962622, which took 0.157 ms

iter_count = 252, r_2norm = 6.690e-04, tol*||rhs|| = 6.911e-04

Anderson update took 135.093 ms, out of which F'*F took 62.748 ms; b-Ax took 425.995 ms, out of which Lap took 382.071 ms
Solving Poisson took 902.517 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.169183 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.553 ms
Total time for convolution: 	 convolve: 5.300056 
Total time for convolution: 	 convolve: 5.228698 
Total time for convolution: 	 convolve: 5.204265 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.617 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.018 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.529 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.490 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.056 ms

This SCF took 27749.017 ms, scf error = 1.197e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.154332, lowerbound = -0.998992, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1422.444 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 18.129 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.908 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.063 ms
rank =  0, finding HY took 23.116 ms
rank =  0, distributing HY into block cyclic form took 17.083 ms
rank =  0, finding Y'*HY took 4.004 ms
Rank 0, Project_Hamiltonian used 66.301 ms
Total time for projection: 66.319 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -0.994657977215034
    last  calculated eigval = 0.049784990544463
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.67627931852811
lambda[   4] =  -0.54369475804180
lambda[   5] =  -0.47917144975469
lambda[   6] =  -0.44285848044319
lambda[   7] =  -0.43661612086536
lambda[   8] =  -0.39025510411451
lambda[   9] =  -0.35637308247350
lambda[  10] =  -0.32369545511874
lambda[  11] =  -0.24737373406174
lambda[  12] =  -0.23986110709998
lambda[  13] =  -0.08463688900127
lambda[  14] =  -0.02956089684509
lambda[  15] =  -0.00163414587037
lambda[  16] =   0.01277521154613
lambda[  17] =   0.02323479507341
lambda[  18] =   0.03978539603910
lambda[  19] =   0.04978499054446
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 7.217 ms
rank =  0, Distributing orbital back into band + domain format took 16.834 ms
rank = 0, Subspace_Rotation used 24.065 ms

Total time for subspace rotation: 24.070 ms
rank = 0, Efermi =  -0.113691895526 calculate fermi energy took 0.601 ms
rank = 0, --- Calculate rho: sum over local bands took 5.500 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.062 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.555 ms
rank = 0, Calculating density took 1529.853 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.836 ms
rank = 0, D2D took 1.942 ms
rank = 0, Transfering density took 1.949 ms
Etot    =   -47.483155117293
Eband   =   -12.164185821003
E1      =    25.940670856763
E2      =   -11.554181266815
E3      =   -15.770270558778
Exc     =   -14.037035781374
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 9.528e-05, dEband = 1.229e-02
rank = 0, Calculating/Estimating energy took 0.934 ms, Etot = -47.483155117, dEtot = 9.528e-05, dEband = 1.229e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0592375588108, which took 0.056 ms

iter_count = 108, r_2norm = 3.781e-05, tol*||rhs|| = 4.237e-05

Anderson update took 57.577 ms, out of which F'*F took 27.282 ms; b-Ax took 183.302 ms, out of which Lap took 164.554 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.327 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263168, int_b + int_rho = 2.474e-13, checking this took 0.110 ms
2-norm of RHS = 691.5151252581837, which took 0.136 ms

iter_count = 240, r_2norm = 6.545e-04, tol*||rhs|| = 6.915e-04

Anderson update took 128.106 ms, out of which F'*F took 60.415 ms; b-Ax took 411.413 ms, out of which Lap took 369.017 ms
Solving Poisson took 861.371 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.172 ms
Total time for convolution: 	 convolve: 5.213545 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.246078 
Total time for convolution: 	 convolve: 5.184230 
Total time for convolution: 	 convolve: 5.210114 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.539 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.205 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.781 ms

This SCF took 27667.096 ms, scf error = 5.464e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.149785, lowerbound = -0.994658, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1426.619 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.729 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.584 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.328 ms
rank =  0, finding HY took 23.736 ms
rank =  0, distributing HY into block cyclic form took 16.956 ms
rank =  0, finding Y'*HY took 3.603 ms
Rank 0, Project_Hamiltonian used 64.653 ms
Total time for projection: 64.665 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -0.992899950364057
    last  calculated eigval = 0.045161882531627
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.67491300268567
lambda[   4] =  -0.54199346498737
lambda[   5] =  -0.47742004923218
lambda[   6] =  -0.44100461463809
lambda[   7] =  -0.43508820394249
lambda[   8] =  -0.38851229090716
lambda[   9] =  -0.35475238024549
lambda[  10] =  -0.32114808798225
lambda[  11] =  -0.24485869805021
lambda[  12] =  -0.23829760453346
lambda[  13] =  -0.08345189135847
lambda[  14] =  -0.03005058576255
lambda[  15] =  -0.00201110476139
lambda[  16] =   0.01215504047951
lambda[  17] =   0.02164235953905
lambda[  18] =   0.03892037004031
lambda[  19] =   0.04516188253163
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.244 ms
rank =  0, subspace rotation using ScaLAPACK took 7.243 ms
rank =  0, Distributing orbital back into band + domain format took 16.695 ms
rank = 0, Subspace_Rotation used 23.953 ms

Total time for subspace rotation: 23.957 ms
rank = 0, Efermi =  -0.112506897815 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.371 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.206 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.597 ms
rank = 0, Calculating density took 1531.838 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.832 ms
rank = 0, D2D took 1.927 ms
rank = 0, Transfering density took 1.929 ms
Etot    =   -47.482931504267
Eband   =   -12.118904290422
E1      =    25.928140463971
E2      =   -11.518956357729
E3      =   -15.777311124100
Exc     =   -14.041378962373
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 2.795e-05, dEband = 5.660e-03
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -47.482931504, dEtot = 2.795e-05, dEband = 5.660e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5513292650600, which took 0.107 ms

iter_count = 108, r_2norm = 2.043e-05, tol*||rhs|| = 2.205e-05

Anderson update took 58.098 ms, out of which F'*F took 27.479 ms; b-Ax took 184.538 ms, out of which Lap took 165.531 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.882 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263162, int_b + int_rho = 1.855e-13, checking this took 0.107 ms
2-norm of RHS = 691.6703674777136, which took 0.115 ms

iter_count = 234, r_2norm = 6.680e-04, tol*||rhs|| = 6.917e-04

Anderson update took 125.282 ms, out of which F'*F took 58.282 ms; b-Ax took 395.191 ms, out of which Lap took 354.016 ms
Solving Poisson took 839.459 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.187470 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.219547 
Total time for convolution: 	 convolve: 5.199132 
Total time for convolution: 	 convolve: 5.206523 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.029 ms
---Transfer Veff_loc: D2D took 4.268 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.975 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.278 ms

This SCF took 27608.552 ms, scf error = 2.792e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.145162, lowerbound = -0.992900, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1425.481 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.679 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.509 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.205 ms
rank =  0, finding HY took 23.762 ms
rank =  0, distributing HY into block cyclic form took 17.015 ms
rank =  0, finding Y'*HY took 3.607 ms
Rank 0, Project_Hamiltonian used 64.621 ms
Total time for projection: 64.634 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.205 ms
    first calculated eigval = -0.990813598633650
    last  calculated eigval = 0.040566434626214
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.67248799736112
lambda[   4] =  -0.53965141593749
lambda[   5] =  -0.47510382299288
lambda[   6] =  -0.43858978516450
lambda[   7] =  -0.43282287070380
lambda[   8] =  -0.38628034333826
lambda[   9] =  -0.35290880927910
lambda[  10] =  -0.31787793560357
lambda[  11] =  -0.24173337275918
lambda[  12] =  -0.23644729195317
lambda[  13] =  -0.08191602173099
lambda[  14] =  -0.02993185517522
lambda[  15] =  -0.00200388483342
lambda[  16] =   0.01217415007540
lambda[  17] =   0.02081065787126
lambda[  18] =   0.03813774139617
lambda[  19] =   0.04056643462621
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 0.265 ms
rank =  0, subspace rotation using ScaLAPACK took 7.204 ms
rank =  0, Distributing orbital back into band + domain format took 16.851 ms
rank = 0, Subspace_Rotation used 24.069 ms

Total time for subspace rotation: 24.074 ms
rank = 0, Efermi =  -0.110971028178 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.403 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.255 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.561 ms
rank = 0, Calculating density took 1530.848 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.836 ms
rank = 0, D2D took 1.933 ms
rank = 0, Transfering density took 1.936 ms
Etot    =   -47.482822221824
Eband   =   -12.060094215381
E1      =    25.898670415347
E2      =   -11.486932380423
E3      =   -15.787236423165
Exc     =   -14.048511028107
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 1.366e-05, dEband = 7.351e-03
rank = 0, Calculating/Estimating energy took 0.937 ms, Etot = -47.482822222, dEtot = 1.366e-05, dEband = 7.351e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2366148515880, which took 0.059 ms

iter_count = 114, r_2norm = 6.554e-06, tol*||rhs|| = 9.465e-06

Anderson update took 60.736 ms, out of which F'*F took 28.759 ms; b-Ax took 192.543 ms, out of which Lap took 172.600 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.449 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263167, int_b + int_rho = 2.437e-13, checking this took 0.124 ms
2-norm of RHS = 691.7629284380641, which took 0.118 ms

iter_count = 234, r_2norm = 6.452e-04, tol*||rhs|| = 6.918e-04

Anderson update took 125.375 ms, out of which F'*F took 59.238 ms; b-Ax took 398.455 ms, out of which Lap took 357.068 ms
Solving Poisson took 842.910 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.191500 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.201998 
Total time for convolution: 	 convolve: 5.215470 
Total time for convolution: 	 convolve: 5.192502 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.235 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.427 ms
---Transfer Veff_loc: D2D took 3.512 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 46.632 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 50.184 ms

This SCF took 28986.198 ms, scf error = 1.707e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.140566, lowerbound = -0.990814, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1522.557 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.448 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.589 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.057 ms
rank =  0, finding HY took 23.941 ms
rank =  0, distributing HY into block cyclic form took 17.024 ms
rank =  0, finding Y'*HY took 3.587 ms
Rank 0, Project_Hamiltonian used 64.642 ms
Total time for projection: 64.655 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.203 ms
    first calculated eigval = -0.988668640780928
    last  calculated eigval = 0.038223042618848
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.67032867825032
lambda[   4] =  -0.53764477469034
lambda[   5] =  -0.47307606002370
lambda[   6] =  -0.43641600988467
lambda[   7] =  -0.43078787232067
lambda[   8] =  -0.38417737310049
lambda[   9] =  -0.35094857061471
lambda[  10] =  -0.31538066287203
lambda[  11] =  -0.23950657027935
lambda[  12] =  -0.23448778926790
lambda[  13] =  -0.08022787756632
lambda[  14] =  -0.02903218441242
lambda[  15] =  -0.00124826137108
lambda[  16] =   0.01312307184132
lambda[  17] =   0.02102035061383
lambda[  18] =   0.03626393434753
lambda[  19] =   0.03822304261885
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 7.234 ms
rank =  0, Distributing orbital back into band + domain format took 16.760 ms
rank = 0, Subspace_Rotation used 24.009 ms

Total time for subspace rotation: 24.014 ms
rank = 0, Efermi =  -0.109282883920 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.371 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.267 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.563 ms
rank = 0, Calculating density took 1627.762 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.819 ms
rank = 0, D2D took 1.916 ms
rank = 0, Transfering density took 1.918 ms
Etot    =   -47.482874688499
Eband   =   -12.008682732765
E1      =    25.874266143219
E2      =   -11.458350463246
E3      =   -15.792310860120
Exc     =   -14.052063225047
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 6.558e-06, dEband = 6.426e-03
rank = 0, Calculating/Estimating energy took 1.807 ms, Etot = -47.482874688, dEtot = 6.558e-06, dEband = 6.426e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1680343377100, which took 0.069 ms

iter_count = 108, r_2norm = 6.642e-06, tol*||rhs|| = 6.721e-06

Anderson update took 58.141 ms, out of which F'*F took 27.102 ms; b-Ax took 182.679 ms, out of which Lap took 164.434 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.098 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263159, int_b + int_rho = 1.528e-13, checking this took 0.104 ms
2-norm of RHS = 691.7494985432591, which took 0.128 ms

iter_count = 216, r_2norm = 6.832e-04, tol*||rhs|| = 6.917e-04

Anderson update took 115.650 ms, out of which F'*F took 54.339 ms; b-Ax took 367.574 ms, out of which Lap took 328.846 ms
Solving Poisson took 775.176 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.236264 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.257680 
Total time for convolution: 	 convolve: 5.205542 
Total time for convolution: 	 convolve: 5.206818 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.167 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.873 ms
---Transfer Veff_loc: D2D took 3.506 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.976 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.517 ms

This SCF took 27731.993 ms, scf error = 9.093e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.138223, lowerbound = -0.988669, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1421.291 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.706 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.540 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.266 ms
rank =  0, finding HY took 23.842 ms
rank =  0, distributing HY into block cyclic form took 17.166 ms
rank =  0, finding Y'*HY took 3.592 ms
Rank 0, Project_Hamiltonian used 64.900 ms
Total time for projection: 64.912 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -0.987299236866629
    last  calculated eigval = 0.037868848349545
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66896628112830
lambda[   4] =  -0.53628107377233
lambda[   5] =  -0.47171166651499
lambda[   6] =  -0.43503842035672
lambda[   7] =  -0.42947785742631
lambda[   8] =  -0.38282055989479
lambda[   9] =  -0.34969745745334
lambda[  10] =  -0.31375433613198
lambda[  11] =  -0.23794618128225
lambda[  12] =  -0.23322723644184
lambda[  13] =  -0.07901666005416
lambda[  14] =  -0.02749402055953
lambda[  15] =   0.00036727876528
lambda[  16] =   0.01506782662937
lambda[  17] =   0.02233096977289
lambda[  18] =   0.03321195353673
lambda[  19] =   0.03786884834954
==subpsace eigenproblem: bcast eigvals took 0.063 ms
Total time for solving subspace eigenvalue problem: 0.291 ms
rank =  0, subspace rotation using ScaLAPACK took 7.228 ms
rank =  0, Distributing orbital back into band + domain format took 17.010 ms
rank = 0, Subspace_Rotation used 24.256 ms

Total time for subspace rotation: 24.260 ms
rank = 0, Efermi =  -0.108071666423 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.349 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.316 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.605 ms
rank = 0, Calculating density took 1527.143 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.733 ms
rank = 0, D2D took 2.835 ms
rank = 0, Transfering density took 2.839 ms
Etot    =   -47.482965155586
Eband   =   -11.975233362636
E1      =    25.857013473466
E2      =   -11.441304101239
E3      =   -15.795569969872
Exc     =   -14.054563140255
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 1.131e-05, dEband = 4.181e-03
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -47.482965156, dEtot = 1.131e-05, dEband = 4.181e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1143636851395, which took 0.059 ms

iter_count = 108, r_2norm = 4.522e-06, tol*||rhs|| = 4.575e-06

Anderson update took 58.263 ms, out of which F'*F took 27.379 ms; b-Ax took 184.041 ms, out of which Lap took 165.766 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.072 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263159, int_b + int_rho = 1.564e-13, checking this took 0.115 ms
2-norm of RHS = 691.7434628827966, which took 0.093 ms

iter_count = 198, r_2norm = 5.760e-04, tol*||rhs|| = 6.917e-04

Anderson update took 106.274 ms, out of which F'*F took 49.717 ms; b-Ax took 333.996 ms, out of which Lap took 299.494 ms
Solving Poisson took 710.292 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.205676 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.189342 
Total time for convolution: 	 convolve: 5.206343 
Total time for convolution: 	 convolve: 5.179203 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.776 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.568 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.861 ms
---Transfer Veff_loc: D2D took 3.482 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.214 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.733 ms

This SCF took 27441.971 ms, scf error = 5.327e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.137869, lowerbound = -0.987299, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1421.973 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.708 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.553 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.282 ms
rank =  0, finding HY took 23.606 ms
rank =  0, distributing HY into block cyclic form took 17.064 ms
rank =  0, finding Y'*HY took 3.605 ms
Rank 0, Project_Hamiltonian used 64.586 ms
Total time for projection: 64.598 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -0.986779851405423
    last  calculated eigval = 0.037415770455685
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66850978570117
lambda[   4] =  -0.53581817160873
lambda[   5] =  -0.47123951903370
lambda[   6] =  -0.43454386109023
lambda[   7] =  -0.42900139525030
lambda[   8] =  -0.38234244438150
lambda[   9] =  -0.34918967143264
lambda[  10] =  -0.31320817020924
lambda[  11] =  -0.23740529319754
lambda[  12] =  -0.23273869601692
lambda[  13] =  -0.07854092852817
lambda[  14] =  -0.02628325229448
lambda[  15] =   0.00159892084933
lambda[  16] =   0.01668106055680
lambda[  17] =   0.02318202275811
lambda[  18] =   0.03097002457174
lambda[  19] =   0.03741577045568
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.244 ms
rank =  0, subspace rotation using ScaLAPACK took 7.201 ms
rank =  0, Distributing orbital back into band + domain format took 16.780 ms
rank = 0, Subspace_Rotation used 23.998 ms

Total time for subspace rotation: 24.003 ms
rank = 0, Efermi =  -0.107595934976 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.350 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.883 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.553 ms
rank = 0, Calculating density took 1527.210 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.810 ms
rank = 0, D2D took 1.907 ms
rank = 0, Transfering density took 1.909 ms
Etot    =   -47.483013616054
Eband   =   -11.963192476993
E1      =    25.851436366576
E2      =   -11.434787603672
E3      =   -15.795676973004
Exc     =   -14.054665885041
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 6.058e-06, dEband = 1.505e-03
rank = 0, Calculating/Estimating energy took 0.931 ms, Etot = -47.483013616, dEtot = 6.058e-06, dEband = 1.505e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0576975332856, which took 0.057 ms

iter_count = 114, r_2norm = 1.522e-06, tol*||rhs|| = 2.308e-06

Anderson update took 61.173 ms, out of which F'*F took 28.864 ms; b-Ax took 194.548 ms, out of which Lap took 175.518 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.757 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263157, int_b + int_rho = 1.382e-13, checking this took 0.104 ms
2-norm of RHS = 691.7529038218095, which took 0.118 ms

iter_count = 198, r_2norm = 6.275e-04, tol*||rhs|| = 6.918e-04

Anderson update took 105.829 ms, out of which F'*F took 49.628 ms; b-Ax took 337.258 ms, out of which Lap took 303.377 ms
Solving Poisson took 712.209 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 5.344542 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.186044 
Total time for convolution: 	 convolve: 5.192932 
Total time for convolution: 	 convolve: 5.161076 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.697 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.595 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.482 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.219 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.739 ms

This SCF took 27618.782 ms, scf error = 3.877e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.137416, lowerbound = -0.986780, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1424.856 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.821 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.564 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.402 ms
rank =  0, finding HY took 23.643 ms
rank =  0, distributing HY into block cyclic form took 17.090 ms
rank =  0, finding Y'*HY took 3.565 ms
Rank 0, Project_Hamiltonian used 64.732 ms
Total time for projection: 64.744 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -0.985989882273383
    last  calculated eigval = 0.037550208160055
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66763636124304
lambda[   4] =  -0.53497724969222
lambda[   5] =  -0.47040627449240
lambda[   6] =  -0.43371112403045
lambda[   7] =  -0.42812582917810
lambda[   8] =  -0.38154444371406
lambda[   9] =  -0.34841131217161
lambda[  10] =  -0.31233143191965
lambda[  11] =  -0.23650367234616
lambda[  12] =  -0.23196520818415
lambda[  13] =  -0.07776292895779
lambda[  14] =  -0.02342923846537
lambda[  15] =   0.00448043418517
lambda[  16] =   0.02025153192153
lambda[  17] =   0.02497232409733
lambda[  18] =   0.03229571330533
lambda[  19] =   0.03755020816006
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 7.240 ms
rank =  0, Distributing orbital back into band + domain format took 17.630 ms
rank = 0, Subspace_Rotation used 24.893 ms

Total time for subspace rotation: 24.901 ms
rank = 0, Efermi =  -0.106817935417 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.532 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.074 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.604 ms
rank = 0, Calculating density took 1531.151 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.849 ms
rank = 0, D2D took 1.957 ms
rank = 0, Transfering density took 1.963 ms
Etot    =   -47.483063208276
Eband   =   -11.942996793040
E1      =    25.841457746831
E2      =   -11.424237895237
E3      =   -15.797121641064
Exc     =   -14.055827501095
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 6.199e-06, dEband = 2.524e-03
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -47.483063208, dEtot = 6.199e-06, dEband = 2.524e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0477162017802, which took 0.061 ms

iter_count = 114, r_2norm = 1.362e-06, tol*||rhs|| = 1.909e-06

Anderson update took 61.517 ms, out of which F'*F took 28.760 ms; b-Ax took 193.222 ms, out of which Lap took 173.967 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.251 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263161, int_b + int_rho = 1.819e-13, checking this took 0.111 ms
2-norm of RHS = 691.7532098452891, which took 0.120 ms

iter_count = 138, r_2norm = 6.732e-04, tol*||rhs|| = 6.918e-04

Anderson update took 74.029 ms, out of which F'*F took 34.450 ms; b-Ax took 233.781 ms, out of which Lap took 210.012 ms
Solving Poisson took 496.712 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.245939 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.205583 
Total time for convolution: 	 convolve: 5.254199 
Total time for convolution: 	 convolve: 5.190354 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.515 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 3.533 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.226 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.795 ms

This SCF took 27565.512 ms, scf error = 2.358e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.137550, lowerbound = -0.985990, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1424.186 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.118 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.548 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.683 ms
rank =  0, finding HY took 23.685 ms
rank =  0, distributing HY into block cyclic form took 17.050 ms
rank =  0, finding Y'*HY took 3.591 ms
Rank 0, Project_Hamiltonian used 65.043 ms
Total time for projection: 65.058 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -0.985795067355369
    last  calculated eigval = 0.037076253941928
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66745020727092
lambda[   4] =  -0.53479347090310
lambda[   5] =  -0.47021992058630
lambda[   6] =  -0.43352734987629
lambda[   7] =  -0.42794508956758
lambda[   8] =  -0.38136257062368
lambda[   9] =  -0.34822706260132
lambda[  10] =  -0.31213560604495
lambda[  11] =  -0.23631094863457
lambda[  12] =  -0.23178480824481
lambda[  13] =  -0.07758428244000
lambda[  14] =  -0.02286120760671
lambda[  15] =   0.00483078977359
lambda[  16] =   0.02093119687653
lambda[  17] =   0.02490380782829
lambda[  18] =   0.03196544876508
lambda[  19] =   0.03707625394193
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 7.165 ms
rank =  0, Distributing orbital back into band + domain format took 17.519 ms
rank = 0, Subspace_Rotation used 24.697 ms

Total time for subspace rotation: 24.702 ms
rank = 0, Efermi =  -0.106639288951 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.392 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.311 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.599 ms
rank = 0, Calculating density took 1530.622 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.849 ms
rank = 0, D2D took 1.941 ms
rank = 0, Transfering density took 1.943 ms
Etot    =   -47.483083117964
Eband   =   -11.938486106538
E1      =    25.839068868944
E2      =   -11.422019504942
E3      =   -15.797506861022
Exc     =   -14.056136049062
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 2.489e-06, dEband = 5.638e-04
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -47.483083118, dEtot = 2.489e-06, dEband = 5.638e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0344985769973, which took 0.049 ms

iter_count = 108, r_2norm = 1.254e-06, tol*||rhs|| = 1.380e-06

Anderson update took 58.028 ms, out of which F'*F took 27.069 ms; b-Ax took 182.050 ms, out of which Lap took 163.920 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.838 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263159, int_b + int_rho = 1.528e-13, checking this took 0.102 ms
2-norm of RHS = 691.7632898236875, which took 0.144 ms

iter_count = 168, r_2norm = 6.051e-04, tol*||rhs|| = 6.918e-04

Anderson update took 90.513 ms, out of which F'*F took 42.209 ms; b-Ax took 285.130 ms, out of which Lap took 255.820 ms
Solving Poisson took 605.088 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.244984 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.202626 
Total time for convolution: 	 convolve: 5.243282 
Total time for convolution: 	 convolve: 5.219373 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.377 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.493 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.970 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.498 ms

This SCF took 27477.695 ms, scf error = 1.972e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.137076, lowerbound = -0.985795, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1421.324 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.864 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.548 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.431 ms
rank =  0, finding HY took 23.692 ms
rank =  0, distributing HY into block cyclic form took 17.034 ms
rank =  0, finding Y'*HY took 3.567 ms
Rank 0, Project_Hamiltonian used 64.757 ms
Total time for projection: 64.769 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.621 ms
rank = 0, Solve_Generalized_EigenProblem used 1.155 ms
    first calculated eigval = -0.985325081638525
    last  calculated eigval = 0.036924605436578
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66699877302802
lambda[   4] =  -0.53434474091781
lambda[   5] =  -0.46976592404363
lambda[   6] =  -0.43308901070708
lambda[   7] =  -0.42750664321788
lambda[   8] =  -0.38092210862010
lambda[   9] =  -0.34777258306268
lambda[  10] =  -0.31169947113908
lambda[  11] =  -0.23588689546693
lambda[  12] =  -0.23134146087797
lambda[  13] =  -0.07712529103635
lambda[  14] =  -0.02099377290695
lambda[  15] =   0.00553363516115
lambda[  16] =   0.02300629439138
lambda[  17] =   0.02603970744332
lambda[  18] =   0.03416793336715
lambda[  19] =   0.03692460543658
==subpsace eigenproblem: bcast eigvals took 0.040 ms
Total time for solving subspace eigenvalue problem: 1.205 ms
rank =  0, subspace rotation using ScaLAPACK took 7.210 ms
rank =  0, Distributing orbital back into band + domain format took 16.935 ms
rank = 0, Subspace_Rotation used 24.161 ms

Total time for subspace rotation: 24.189 ms
rank = 0, Efermi =  -0.106180297428 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.405 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.386 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.552 ms
rank = 0, Calculating density took 1527.951 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.799 ms
rank = 0, D2D took 1.893 ms
rank = 0, Transfering density took 1.895 ms
Etot    =   -47.483133850798
Eband   =   -11.927796005999
E1      =    25.833775652955
E2      =   -11.416419633753
E3      =   -15.798247127848
Exc     =   -14.056724062083
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 6.342e-06, dEband = 1.336e-03
rank = 0, Calculating/Estimating energy took 0.927 ms, Etot = -47.483133851, dEtot = 6.342e-06, dEband = 1.336e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0291762305336, which took 0.061 ms

iter_count = 108, r_2norm = 1.043e-06, tol*||rhs|| = 1.167e-06

Anderson update took 57.844 ms, out of which F'*F took 27.090 ms; b-Ax took 182.586 ms, out of which Lap took 164.026 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.184 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263165, int_b + int_rho = 2.183e-13, checking this took 0.140 ms
2-norm of RHS = 691.7664721697265, which took 0.145 ms

iter_count = 144, r_2norm = 5.913e-04, tol*||rhs|| = 6.918e-04

Anderson update took 76.989 ms, out of which F'*F took 36.076 ms; b-Ax took 243.366 ms, out of which Lap took 218.984 ms
Solving Poisson took 516.515 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Total time for convolution: 	 convolve: 5.212286 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.371 ms
Total time for convolution: 	 convolve: 5.214315 
Total time for convolution: 	 convolve: 5.181500 
Total time for convolution: 	 convolve: 5.173320 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 3.510 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.277 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.825 ms

This SCF took 27256.083 ms, scf error = 1.197e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136925, lowerbound = -0.985325, upperbound = 267.579322

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1425.587 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.693 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.566 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.277 ms
rank =  0, finding HY took 23.827 ms
rank =  0, distributing HY into block cyclic form took 17.055 ms
rank =  0, finding Y'*HY took 3.572 ms
Rank 0, Project_Hamiltonian used 65.230 ms
Total time for projection: 65.242 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -0.985192636378122
    last  calculated eigval = 0.036881779381795
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66686912528777
lambda[   4] =  -0.53421260405315
lambda[   5] =  -0.46963312439934
lambda[   6] =  -0.43296249623472
lambda[   7] =  -0.42737931156397
lambda[   8] =  -0.38079479479388
lambda[   9] =  -0.34763917273424
lambda[  10] =  -0.31157252813422
lambda[  11] =  -0.23576265853131
lambda[  12] =  -0.23121295722821
lambda[  13] =  -0.07698909245377
lambda[  14] =  -0.01995642959242
lambda[  15] =   0.00595352499470
lambda[  16] =   0.02397225008284
lambda[  17] =   0.02667076798939
lambda[  18] =   0.03549634980161
lambda[  19] =   0.03688177938180
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.232 ms
rank =  0, subspace rotation using ScaLAPACK took 7.208 ms
rank =  0, Distributing orbital back into band + domain format took 16.672 ms
rank = 0, Subspace_Rotation used 23.895 ms

Total time for subspace rotation: 23.901 ms
rank = 0, Efermi =  -0.106044098853 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.401 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.246 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.600 ms
rank = 0, Calculating density took 1531.378 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.843 ms
rank = 0, D2D took 1.940 ms
rank = 0, Transfering density took 1.943 ms
Etot    =   -47.483155485222
Eband   =   -11.924701956558
E1      =    25.832345626855
E2      =   -11.414721071954
E3      =   -15.798326283713
Exc     =   -14.056790313914
Esc     =   -74.547056196594
Entropy =    -0.000000000677
dE = 2.704e-06, dEband = 3.868e-04
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -47.483155485, dEtot = 2.704e-06, dEband = 3.868e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0235378436370, which took 0.058 ms

iter_count = 108, r_2norm = 9.009e-07, tol*||rhs|| = 9.415e-07

Anderson update took 58.138 ms, out of which F'*F took 27.559 ms; b-Ax took 183.197 ms, out of which Lap took 165.036 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.644 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002263143, int_rho =  24.00000002263158, int_b + int_rho = 1.455e-13, checking this took 0.130 ms
2-norm of RHS = 691.7672436209062, which took 0.091 ms

iter_count = 126, r_2norm = 6.853e-04, tol*||rhs|| = 6.918e-04

Anderson update took 67.868 ms, out of which F'*F took 31.410 ms; b-Ax took 213.815 ms, out of which Lap took 191.055 ms
Solving Poisson took 453.662 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.132 ms
Total time for convolution: 	 convolve: 5.223171 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.194598 
Total time for convolution: 	 convolve: 5.237350 
Total time for convolution: 	 convolve: 5.209590 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.824 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.480 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.994 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.510 ms

This SCF took 27343.154 ms, scf error = 9.730e-05
The last 17 occupations of kpoints #1 are (Nelectron = 24):
lambda[   3] =  -0.66686912528777, occ[   3] =   2.00000000000000
lambda[   4] =  -0.53421260405315, occ[   4] =   2.00000000000000
lambda[   5] =  -0.46963312439934, occ[   5] =   2.00000000000000
lambda[   6] =  -0.43296249623472, occ[   6] =   2.00000000000000
lambda[   7] =  -0.42737931156397, occ[   7] =   2.00000000000000
lambda[   8] =  -0.38079479479388, occ[   8] =   2.00000000000000
lambda[   9] =  -0.34763917273424, occ[   9] =   2.00000000000000
lambda[  10] =  -0.31157252813422, occ[  10] =   2.00000000000000
lambda[  11] =  -0.23576265853131, occ[  11] =   2.00000000000000
lambda[  12] =  -0.23121295722821, occ[  12] =   2.00000000000000
lambda[  13] =  -0.07698909245377, occ[  13] =   0.00000002263161
lambda[  14] =  -0.01995642959242, occ[  14] =   0.00000000000000
lambda[  15] =   0.00595352499470, occ[  15] =   0.00000000000000
lambda[  16] =   0.02397225008284, occ[  16] =   0.00000000000000
lambda[  17] =   0.02667076798939, occ[  17] =   0.00000000000000
lambda[  18] =   0.03549634980161, occ[  18] =   0.00000000000000
lambda[  19] =   0.03688177938180, occ[  19] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 17 (90%) = 0.000000000000000.
Occupation of state 19 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.591 ms, time for Allreduce/Reduce: 10.083 ms 
Time for calculating local force components: 20.528 ms
Start Calculating nonlocal forces
force_nloc = 
  0.89431469400233  -0.61776421485558  -0.00000063311752
  0.36638822641024   1.13726196959562  -0.00000037568903
  0.00164165125430   0.07314971096972   0.00000000197550
 -0.01051949904054  -0.02754497645898  -0.03879255573616
 -0.01051946179597  -0.02754493997328   0.03879254921056
 -0.04814145131365  -0.00879869792902  -0.00000003079723
 -0.12789638582978  -0.05194042741154  -0.00000059557052
 -0.05110059396862  -0.12938965356991   0.00000018645883
force_loc = 
 -0.87185357062629   0.60350226200628  -0.00000045364517
 -0.36158246375006  -1.12169785101932   0.00000014577269
 -0.00233869151935  -0.07653421662148   0.00000010146443
  0.01042708671885   0.02868579066143   0.04018984832022
  0.01042546188655   0.02868563123459  -0.04018750009604
  0.05086882234128   0.00917000151503  -0.00000026785409
  0.12581871255417   0.04912317430440  -0.00000341823502
  0.05564222089453   0.14434983788105   0.00000024915503
Time for calculating nonlocal force components: 38.181 ms
[32mforces_xc: 
[0m[32m -0.02831651006661   0.01746911212242   0.00000000747311
[0m[32m -0.00816562276999  -0.02681547084136   0.00000000092540
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00675404224991   0.00204569518106  -0.00000017385138
[0m[32m -0.00198480457732  -0.00505872375644   0.00000002782103
[0mTime for calculating XC forces components: 27.723 ms
 Cartesian force = 
 -0.00583811957232   0.00316290764378  -0.00000071853767
 -0.00334259299155  -0.01129560389440   0.00000013176098
 -0.00067977314680  -0.00342875728110   0.00000046419186
 -0.00007514520344   0.00109656257312   0.00139765333598
 -0.00007673279117   0.00109643963198  -0.00139459013356
  0.00274463814589   0.00032705195668   0.00000006210059
  0.00469363609255  -0.00081580955541  -0.00000382690500
  0.00257408946684   0.00985720892536   0.00000082418681
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Time for printing density: 389.754 ms
The program took 420.617 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:35:31
Job ID:        2266918
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:26:48,vmem=8420K,walltime=00:07:14,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-15-1
---------------------------------------
