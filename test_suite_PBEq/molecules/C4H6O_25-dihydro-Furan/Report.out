---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:20
Job ID:    2266819
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:26
Job ID:    2266819
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.078 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 17.297 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 11.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 18.191 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 85.821 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.948 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.082 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   12.922353	
   11.673685	   13.372528	   11.810591	
    8.326315	   13.372528	   11.810591	
    8.326315	    6.627472	   11.810591	
   11.673685	    6.627472	   11.810591	
   10.000000	   12.491479	    7.077647	
   10.000000	    7.508521	    7.077647	
   10.000000	   12.209054	   11.381767	
   10.000000	   11.254429	    8.706765	
   10.000000	    8.745571	    8.706765	
   10.000000	    7.790946	   11.381767	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.162 ms
Set up communicators.

--set up spincomm took 3.732 ms

--set up kptcomm took 0.358 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 21, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 21 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 21, mbQ = nbQ = 64
rank = 0, nr_Hp = 21, nc_Hp = 21
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.072 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.373 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.761 ms

Calculate_SplineDerivRadFun took 0.209 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.788 ms.
time spent on vectorized spline interp: 3.310 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.715 ms.
time spent on vectorized spline interp: 1.544 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.338 ms.
time spent on vectorized spline interp: 1.869 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.327 ms.

Calculating rb for all atom types took 16.900 ms
----------------------
Estimated memory usage
Total: 1.26 GB
orbitals             : 961.30 MB
global sized vectors : 213.62 MB
subspace matrices : 10.34 kB
others : 117.49 MB
----------------------------------------------
Estimated memory usage per processor: 107.70 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.046 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -28.0000000284120, sum_int_rho = 27.3904305234672
PosCharge = 28.000000028412, NegCharge = -27.390430523467, scal_fac = 1.022254834747
After scaling, int_rho = 28.0000000284121, PosCharge + NegCharge - NetCharge = -9.592e-14
--Calculate Vref took 0.515 ms
--Calculate rho_guess took 2.836 ms

 integral of b = -28.0000000284120,
 int{b} + Nelectron + NetCharge = -2.841e-08,
 Esc = -74.1403706047575,
 MPI_Reduce took 5.789 ms

Calculating b & b_ref took 15.909 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.100 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.110 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.097 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.654 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.006 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.007 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.006 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.557 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841202, int_b + int_rho = -2.728e-13, checking this took 0.578 ms
2-norm of RHS = 788.0675239041053, which took 0.526 ms

iter_count = 420, r_2norm = 6.798e-04, tol*||rhs|| = 7.881e-04

Anderson update took 258.351 ms, out of which F'*F took 117.548 ms; b-Ax took 796.435 ms, out of which Lap took 708.210 ms
Solving Poisson took 1765.620 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.446 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
Total time for convolution: 	 convolve: 5.135042 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
Total time for convolution: 	 convolve: 5.128535 
Total time for convolution: 	 convolve: 5.172941 
Total time for convolution: 	 convolve: 5.134794 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.698 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.583 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.170 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.422 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, XC calculation took 24441.759 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 4.815 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.244 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.178 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.191 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.940 ms
    Lanczos iter 54, eigmin  = -0.993318605, eigmax = 264.937320799, err_eigmin = 1.298e-03, err_eigmax = 9.787e-03
rank =   0, Lanczos took 140.375 ms, eigmin = -0.993318604954, eigmax = 267.586694006809

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.246688, lowerbound = -1.093319, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1718.489 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.914 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.869 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.812 ms
rank =  0, finding HY took 28.395 ms
rank =  0, distributing HY into block cyclic form took 22.233 ms
rank =  0, finding Y'*HY took 4.914 ms
Rank 0, Project_Hamiltonian used 81.818 ms
Total time for projection: 81.829 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.777 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.867 ms
    first calculated eigval = 2.706559302542811
    last  calculated eigval = 3.229940282993665
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =   2.83197024766074
lambda[   6] =   2.87258387462348
lambda[   7] =   2.90941060390735
lambda[   8] =   2.92035979390119
lambda[   9] =   2.96563020622996
lambda[  10] =   2.97189442008591
lambda[  11] =   2.99467821547091
lambda[  12] =   3.00931942053339
lambda[  13] =   3.02301489493342
lambda[  14] =   3.03448988306606
lambda[  15] =   3.09924964407841
lambda[  16] =   3.11338963588034
lambda[  17] =   3.13054357376114
lambda[  18] =   3.15647324506069
lambda[  19] =   3.18720387549533
lambda[  20] =   3.20841724373598
lambda[  21] =   3.22994028299367
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.885 ms
rank =  0, subspace rotation using ScaLAPACK took 9.039 ms
rank =  0, Distributing orbital back into band + domain format took 21.543 ms
rank = 0, Subspace_Rotation used 30.593 ms

Total time for subspace rotation: 30.596 ms
rank = 0, Efermi =   3.070400740734 calculate fermi energy took 0.044 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.329940, lowerbound = -1.093319, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1691.891 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 21.159 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.739 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.916 ms
rank =  0, finding HY took 27.685 ms
rank =  0, distributing HY into block cyclic form took 21.054 ms
rank =  0, finding Y'*HY took 4.512 ms
Rank 0, Project_Hamiltonian used 77.192 ms
Total time for projection: 77.196 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.143 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.106 ms
rank = 0, Solve_Generalized_EigenProblem used 0.252 ms
    first calculated eigval = -0.844365651806827
    last  calculated eigval = 0.471602221776483
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.24441530378939
lambda[   6] =  -0.23379299498718
lambda[   7] =  -0.13366207477652
lambda[   8] =  -0.00048017986622
lambda[   9] =   0.02646180609947
lambda[  10] =   0.04044773719874
lambda[  11] =   0.13397804444295
lambda[  12] =   0.16446233845836
lambda[  13] =   0.26618285990321
lambda[  14] =   0.27741093301090
lambda[  15] =   0.29984487130850
lambda[  16] =   0.34276303407408
lambda[  17] =   0.35214234985795
lambda[  18] =   0.36121165556447
lambda[  19] =   0.39962367757244
lambda[  20] =   0.41240667661547
lambda[  21] =   0.47160222177648
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.261 ms
rank =  0, subspace rotation using ScaLAPACK took 8.942 ms
rank =  0, Distributing orbital back into band + domain format took 21.522 ms
rank = 0, Subspace_Rotation used 30.481 ms

Total time for subspace rotation: 30.485 ms
rank = 0, Efermi =   0.288628427705 calculate fermi energy took 0.021 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.571602, lowerbound = -1.093319, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1710.127 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 21.067 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.738 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.821 ms
rank =  0, finding HY took 27.823 ms
rank =  0, distributing HY into block cyclic form took 21.058 ms
rank =  0, finding Y'*HY took 4.506 ms
Rank 0, Project_Hamiltonian used 77.234 ms
Total time for projection: 77.239 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.221 ms
    first calculated eigval = -1.008738988367251
    last  calculated eigval = 0.154904072875186
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.59601960874488
lambda[   6] =  -0.55332912100973
lambda[   7] =  -0.50192286594060
lambda[   8] =  -0.46318215380140
lambda[   9] =  -0.45024329949112
lambda[  10] =  -0.43717018201924
lambda[  11] =  -0.39929027999660
lambda[  12] =  -0.34686128260871
lambda[  13] =  -0.29144554007576
lambda[  14] =  -0.15045094530532
lambda[  15] =  -0.05595841348136
lambda[  16] =   0.07143220459687
lambda[  17] =   0.08229651557443
lambda[  18] =   0.09766824035875
lambda[  19] =   0.11646053114146
lambda[  20] =   0.14279139735461
lambda[  21] =   0.15490407287519
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 8.937 ms
rank =  0, Distributing orbital back into band + domain format took 21.513 ms
rank = 0, Subspace_Rotation used 30.462 ms

Total time for subspace rotation: 30.466 ms
rank = 0, Efermi =  -0.084807472135 calculate fermi energy took 0.022 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.254904, lowerbound = -1.093319, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1684.631 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 21.096 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.822 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.936 ms
rank =  0, finding HY took 27.671 ms
rank =  0, distributing HY into block cyclic form took 21.065 ms
rank =  0, finding Y'*HY took 4.506 ms
Rank 0, Project_Hamiltonian used 77.201 ms
Total time for projection: 77.205 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -1.008927427664952
    last  calculated eigval = 0.084123486664177
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.60219745770714
lambda[   6] =  -0.56053137295745
lambda[   7] =  -0.50681335721527
lambda[   8] =  -0.47302338680762
lambda[   9] =  -0.46924643291342
lambda[  10] =  -0.45353943141510
lambda[  11] =  -0.41909502419773
lambda[  12] =  -0.36321917775408
lambda[  13] =  -0.33137018195091
lambda[  14] =  -0.26698744491331
lambda[  15] =  -0.10620853037021
lambda[  16] =   0.01348644468194
lambda[  17] =   0.02609912881279
lambda[  18] =   0.04423208434238
lambda[  19] =   0.06787358056473
lambda[  20] =   0.07152971216999
lambda[  21] =   0.08412348666418
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.225 ms
rank =  0, subspace rotation using ScaLAPACK took 8.989 ms
rank =  0, Distributing orbital back into band + domain format took 21.496 ms
rank = 0, Subspace_Rotation used 31.377 ms

Total time for subspace rotation: 31.382 ms
rank = 0, Efermi =  -0.135057588993 calculate fermi energy took 0.023 ms
rank = 0, --- Calculate rho: sum over local bands took 6.501 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.480 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.565 ms
rank = 0, Calculating density took 7407.407 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.901 ms
rank = 0, D2D took 2.003 ms
rank = 0, Transfering density took 2.008 ms
Etot    =   -44.271020849149
Eband   =   -15.408485147863
E1      =    31.441244967940
E2      =   -12.126910320496
E3      =   -15.994540243753
Exc     =   -14.284860627873
Esc     =   -74.140370604758
Entropy =    -0.000000000845
dE = 4.025e+00, dEband = 1.401e+00
rank = 0, Calculating/Estimating energy took 0.999 ms, Etot = -44.271020849, dEtot = 4.025e+00, dEband = 1.401e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 63.9081125559874, which took 1.336 ms

iter_count = 96, r_2norm = 1.759e-03, tol*||rhs|| = 2.556e-03

Anderson update took 56.690 ms, out of which F'*F took 27.859 ms; b-Ax took 186.573 ms, out of which Lap took 164.160 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 411.312 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841211, int_b + int_rho = -1.819e-13, checking this took 0.116 ms
2-norm of RHS = 783.8411848446856, which took 0.145 ms

iter_count = 288, r_2norm = 6.285e-04, tol*||rhs|| = 7.838e-04

Anderson update took 170.751 ms, out of which F'*F took 78.658 ms; b-Ax took 538.523 ms, out of which Lap took 476.360 ms
Solving Poisson took 1209.757 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.434 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.339140 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.331906 
Total time for convolution: 	 convolve: 5.192581 
Total time for convolution: 	 convolve: 5.176849 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.021 ms
======D2D: initiated sending and receiving took 1.194 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.168 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 3.555 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.072 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.660 ms

This SCF took 34108.106 ms, scf error = 1.768e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.184123, lowerbound = -1.008927, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1702.310 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 21.025 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.781 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.828 ms
rank =  0, finding HY took 26.826 ms
rank =  0, distributing HY into block cyclic form took 21.418 ms
rank =  0, finding Y'*HY took 4.440 ms
Rank 0, Project_Hamiltonian used 76.539 ms
Total time for projection: 76.551 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.232 ms
    first calculated eigval = -0.995676047871300
    last  calculated eigval = 0.053374562380349
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.57728224320209
lambda[   6] =  -0.53245162653113
lambda[   7] =  -0.48666007225875
lambda[   8] =  -0.44954976133797
lambda[   9] =  -0.43979633658417
lambda[  10] =  -0.43179892632922
lambda[  11] =  -0.39192242118577
lambda[  12] =  -0.34247508988891
lambda[  13] =  -0.30519631886654
lambda[  14] =  -0.25352722533130
lambda[  15] =  -0.08501007190871
lambda[  16] =  -0.01516488428574
lambda[  17] =   0.01085127209130
lambda[  18] =   0.02371485444257
lambda[  19] =   0.03534535903932
lambda[  20] =   0.04247941239704
lambda[  21] =   0.05337456238035
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.244 ms
rank =  0, subspace rotation using ScaLAPACK took 10.170 ms
rank =  0, Distributing orbital back into band + domain format took 20.834 ms
rank = 0, Subspace_Rotation used 31.021 ms

Total time for subspace rotation: 31.028 ms
rank = 0, Efermi =  -0.113859130517 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 6.895 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.533 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1830.134 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.942 ms
rank = 0, D2D took 2.040 ms
rank = 0, Transfering density took 2.046 ms
Etot    =   -44.222397055931
Eband   =   -14.730592025798
E1      =    30.819076552997
E2      =   -12.085885729952
E3      =   -16.181565758167
Exc     =   -14.437962465645
Esc     =   -74.140370604758
Entropy =    -0.000000000845
dE = 4.420e-03, dEband = 6.163e-02
rank = 0, Calculating/Estimating energy took 1.024 ms, Etot = -44.222397056, dEtot = 4.420e-03, dEband = 6.163e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 17.0806520542180, which took 0.102 ms

iter_count = 102, r_2norm = 5.523e-04, tol*||rhs|| = 6.832e-04

Anderson update took 61.391 ms, out of which F'*F took 28.464 ms; b-Ax took 195.458 ms, out of which Lap took 172.196 ms
rank = 0, Mixing (+ precond) took 440.989 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841208, int_b + int_rho = -2.110e-13, checking this took 0.130 ms
2-norm of RHS = 776.7930218987724, which took 0.185 ms

iter_count = 306, r_2norm = 6.753e-04, tol*||rhs|| = 7.768e-04

Anderson update took 183.160 ms, out of which F'*F took 83.550 ms; b-Ax took 577.862 ms, out of which Lap took 510.674 ms
Solving Poisson took 1285.594 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.166127 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 30.279 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.169144 
Total time for convolution: 	 convolve: 5.160367 
Total time for convolution: 	 convolve: 5.176221 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.218 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.383 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.544 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.094 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.671 ms

This SCF took 28238.232 ms, scf error = 1.233e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.153375, lowerbound = -0.995676, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1708.852 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 21.269 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.985 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.268 ms
rank =  0, finding HY took 27.641 ms
rank =  0, distributing HY into block cyclic form took 21.595 ms
rank =  0, finding Y'*HY took 4.613 ms
Rank 0, Project_Hamiltonian used 78.145 ms
Total time for projection: 78.160 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -0.966457278467096
    last  calculated eigval = 0.044482459036533
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.52524637260017
lambda[   6] =  -0.47491000603517
lambda[   7] =  -0.44166866357983
lambda[   8] =  -0.40429309374414
lambda[   9] =  -0.38150309721644
lambda[  10] =  -0.37067207315706
lambda[  11] =  -0.33395148912547
lambda[  12] =  -0.29634882837336
lambda[  13] =  -0.25491623239910
lambda[  14] =  -0.21135442580489
lambda[  15] =  -0.03549799031089
lambda[  16] =  -0.02652577283524
lambda[  17] =   0.01250278657310
lambda[  18] =   0.01828254100305
lambda[  19] =   0.02192394325909
lambda[  20] =   0.03373905738522
lambda[  21] =   0.04448245903653
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 10.116 ms
rank =  0, Distributing orbital back into band + domain format took 20.637 ms
rank = 0, Subspace_Rotation used 30.769 ms

Total time for subspace rotation: 30.776 ms
rank = 0, Efermi =  -0.064347059851 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 6.485 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.813 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.586 ms
rank = 0, Calculating density took 1837.722 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.930 ms
rank = 0, D2D took 2.853 ms
rank = 0, Transfering density took 2.862 ms
Etot    =   -44.165444181739
Eband   =   -13.268503169738
E1      =    29.563794082345
E2      =   -11.849823387562
E3      =   -16.642553101143
Exc     =   -14.812740977449
Esc     =   -74.140370604758
Entropy =    -0.000000000845
dE = 5.178e-03, dEband = 1.329e-01
rank = 0, Calculating/Estimating energy took 1.274 ms, Etot = -44.165444182, dEtot = 5.178e-03, dEband = 1.329e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 8.6723923583440, which took 0.060 ms

iter_count = 102, r_2norm = 2.168e-04, tol*||rhs|| = 3.469e-04

Anderson update took 61.037 ms, out of which F'*F took 28.978 ms; b-Ax took 196.570 ms, out of which Lap took 174.655 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 443.454 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841218, int_b + int_rho = -1.128e-13, checking this took 0.109 ms
2-norm of RHS = 777.2459858507398, which took 0.140 ms

iter_count = 258, r_2norm = 7.301e-04, tol*||rhs|| = 7.772e-04

Anderson update took 149.754 ms, out of which F'*F took 70.812 ms; b-Ax took 485.730 ms, out of which Lap took 431.715 ms
Solving Poisson took 1074.331 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.203920 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.243 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.174477 
Total time for convolution: 	 convolve: 5.167657 
Total time for convolution: 	 convolve: 5.165967 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.314 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.151 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 3.531 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.105 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.664 ms

This SCF took 28082.449 ms, scf error = 2.885e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.144482, lowerbound = -0.966457, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1683.010 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.127 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.830 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.974 ms
rank =  0, finding HY took 26.466 ms
rank =  0, distributing HY into block cyclic form took 21.499 ms
rank =  0, finding Y'*HY took 4.429 ms
Rank 0, Project_Hamiltonian used 76.395 ms
Total time for projection: 77.085 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.659 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.275 ms
rank = 0, Solve_Generalized_EigenProblem used 0.938 ms
    first calculated eigval = -0.960185637236085
    last  calculated eigval = 0.034386592321946
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.51918229695223
lambda[   6] =  -0.46857113187702
lambda[   7] =  -0.43473251590008
lambda[   8] =  -0.39731573996587
lambda[   9] =  -0.37359399936228
lambda[  10] =  -0.36515742960317
lambda[  11] =  -0.32738616453019
lambda[  12] =  -0.29103154047751
lambda[  13] =  -0.25096686130314
lambda[  14] =  -0.20501004912265
lambda[  15] =  -0.03186212034109
lambda[  16] =  -0.02997859579745
lambda[  17] =   0.01202091451972
lambda[  18] =   0.01451149849133
lambda[  19] =   0.01719607222134
lambda[  20] =   0.02695264131592
lambda[  21] =   0.03438659232195
==subpsace eigenproblem: bcast eigvals took 0.038 ms
Total time for solving subspace eigenvalue problem: 0.981 ms
rank =  0, subspace rotation using ScaLAPACK took 9.591 ms
rank =  0, Distributing orbital back into band + domain format took 20.677 ms
rank = 0, Subspace_Rotation used 30.280 ms

Total time for subspace rotation: 30.284 ms
rank = 0, Efermi =  -0.060811668236 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 6.549 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.323 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.162 ms
rank = 0, Calculating density took 1811.573 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.012 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.130 ms
rank = 0, D2D took 2.242 ms
rank = 0, Transfering density took 2.250 ms
Etot    =   -44.162985262452
Eband   =   -13.095435229815
E1      =    29.475045109706
E2      =   -11.753634719342
E3      =   -16.696982452700
Exc     =   -14.852841708773
Esc     =   -74.140370604758
Entropy =    -0.000000000853
dE = 2.235e-04, dEband = 1.573e-02
rank = 0, Calculating/Estimating energy took 0.996 ms, Etot = -44.162985262, dEtot = 2.235e-04, dEband = 1.573e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.3488373635849, which took 0.072 ms

iter_count = 114, r_2norm = 3.978e-05, tol*||rhs|| = 5.395e-05

Anderson update took 67.444 ms, out of which F'*F took 31.382 ms; b-Ax took 218.010 ms, out of which Lap took 190.470 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 490.867 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841222, int_b + int_rho = -7.276e-14, checking this took 0.147 ms
2-norm of RHS = 777.9145260382866, which took 0.159 ms

iter_count = 258, r_2norm = 7.309e-04, tol*||rhs|| = 7.779e-04

Anderson update took 155.242 ms, out of which F'*F took 71.997 ms; b-Ax took 490.427 ms, out of which Lap took 437.538 ms
Solving Poisson took 1098.166 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.164032 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.735 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.856 ms
Total time for convolution: 	 convolve: 5.165593 
Total time for convolution: 	 convolve: 5.169530 
Total time for convolution: 	 convolve: 5.170735 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.482 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.787 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.304 ms

This SCF took 28091.002 ms, scf error = 1.423e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.134387, lowerbound = -0.960186, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1686.260 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.183 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.524 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.140 ms
rank =  0, finding HY took 26.186 ms
rank =  0, distributing HY into block cyclic form took 21.002 ms
rank =  0, finding Y'*HY took 4.585 ms
Rank 0, Project_Hamiltonian used 76.945 ms
Total time for projection: 76.956 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -0.953606627896644
    last  calculated eigval = 0.029287971512375
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.51314642656514
lambda[   6] =  -0.46242655525399
lambda[   7] =  -0.42807077703840
lambda[   8] =  -0.39061687071078
lambda[   9] =  -0.36629944875244
lambda[  10] =  -0.35978471469360
lambda[  11] =  -0.32106845945987
lambda[  12] =  -0.28557374851601
lambda[  13] =  -0.24665534049186
lambda[  14] =  -0.19880085918073
lambda[  15] =  -0.03068814271672
lambda[  16] =  -0.02787400960481
lambda[  17] =   0.01222176722657
lambda[  18] =   0.01328033396765
lambda[  19] =   0.01531547145328
lambda[  20] =   0.02142996233715
lambda[  21] =   0.02928797151238
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.279 ms
rank =  0, subspace rotation using ScaLAPACK took 9.593 ms
rank =  0, Distributing orbital back into band + domain format took 20.655 ms
rank = 0, Subspace_Rotation used 30.258 ms

Total time for subspace rotation: 30.262 ms
rank = 0, Efermi =  -0.059571941112 calculate fermi energy took 0.543 ms
rank = 0, --- Calculate rho: sum over local bands took 6.493 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.900 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 1813.357 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.930 ms
rank = 0, D2D took 2.033 ms
rank = 0, Transfering density took 2.039 ms
Etot    =   -44.161578659457
Eband   =   -12.925634811964
E1      =    29.398105939856
E2      =   -11.648868068481
E3      =   -16.742980343586
Exc     =   -14.885527593809
Esc     =   -74.140370604758
Entropy =    -0.000000000849
dE = 1.279e-04, dEband = 1.544e-02
rank = 0, Calculating/Estimating energy took 1.004 ms, Etot = -44.161578659, dEtot = 1.279e-04, dEband = 1.544e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5060279500655, which took 0.053 ms

iter_count = 114, r_2norm = 1.437e-05, tol*||rhs|| = 2.024e-05

Anderson update took 66.729 ms, out of which F'*F took 32.239 ms; b-Ax took 220.620 ms, out of which Lap took 195.836 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 493.209 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841212, int_b + int_rho = -1.746e-13, checking this took 0.120 ms
2-norm of RHS = 778.3273730608812, which took 0.169 ms

iter_count = 252, r_2norm = 6.658e-04, tol*||rhs|| = 7.783e-04

Anderson update took 149.739 ms, out of which F'*F took 72.299 ms; b-Ax took 495.340 ms, out of which Lap took 441.291 ms
Solving Poisson took 1057.781 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.098 ms
Total time for convolution: 	 convolve: 5.182068 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 37.272 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.176595 
Total time for convolution: 	 convolve: 5.169940 
Total time for convolution: 	 convolve: 5.167597 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.201 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.514 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.380 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.928 ms

This SCF took 28108.744 ms, scf error = 4.575e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.129288, lowerbound = -0.953607, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1690.223 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.129 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.805 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.953 ms
rank =  0, finding HY took 26.473 ms
rank =  0, distributing HY into block cyclic form took 21.466 ms
rank =  0, finding Y'*HY took 4.753 ms
Rank 0, Project_Hamiltonian used 76.674 ms
Total time for projection: 76.687 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -0.947391542264827
    last  calculated eigval = 0.028199432684124
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50695425476909
lambda[   6] =  -0.45632465386202
lambda[   7] =  -0.42243045172226
lambda[   8] =  -0.38490610728213
lambda[   9] =  -0.36093213234685
lambda[  10] =  -0.35332433991992
lambda[  11] =  -0.31495506435283
lambda[  12] =  -0.27932381534939
lambda[  13] =  -0.24046838291096
lambda[  14] =  -0.19326497820342
lambda[  15] =  -0.03013137566004
lambda[  16] =  -0.02227076447036
lambda[  17] =   0.01271214926317
lambda[  18] =   0.01389781998735
lambda[  19] =   0.01508515905165
lambda[  20] =   0.01784038558378
lambda[  21] =   0.02819943268412
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.244 ms
rank =  0, subspace rotation using ScaLAPACK took 9.595 ms
rank =  0, Distributing orbital back into band + domain format took 20.629 ms
rank = 0, Subspace_Rotation used 30.245 ms

Total time for subspace rotation: 30.249 ms
rank = 0, Efermi =  -0.058980486210 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 6.491 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.832 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.595 ms
rank = 0, Calculating density took 1816.489 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.913 ms
rank = 0, D2D took 2.025 ms
rank = 0, Transfering density took 2.030 ms
Etot    =   -44.161031219999
Eband   =   -12.755788945185
E1      =    29.311771390918
E2      =   -11.558331227112
E3      =   -16.768851429722
Exc     =   -14.903825716963
Esc     =   -74.140370604758
Entropy =    -0.000000000845
dE = 4.977e-05, dEband = 1.544e-02
rank = 0, Calculating/Estimating energy took 1.014 ms, Etot = -44.161031220, dEtot = 4.977e-05, dEband = 1.544e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4012067050274, which took 0.067 ms

iter_count = 114, r_2norm = 1.051e-05, tol*||rhs|| = 1.605e-05

Anderson update took 67.266 ms, out of which F'*F took 31.751 ms; b-Ax took 216.326 ms, out of which Lap took 192.492 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.635 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841212, int_b + int_rho = -1.710e-13, checking this took 0.112 ms
2-norm of RHS = 778.4479038651027, which took 0.173 ms

iter_count = 222, r_2norm = 6.463e-04, tol*||rhs|| = 7.784e-04

Anderson update took 130.667 ms, out of which F'*F took 63.323 ms; b-Ax took 423.265 ms, out of which Lap took 377.875 ms
Solving Poisson took 933.828 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.168839 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.401 ms
Total time for convolution: 	 convolve: 5.162799 
Total time for convolution: 	 convolve: 5.173328 
Total time for convolution: 	 convolve: 5.165793 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.013 ms
---Transfer Veff_loc: D2D took 4.291 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.373 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.697 ms

This SCF took 27904.825 ms, scf error = 2.161e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.128199, lowerbound = -0.947392, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1690.333 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 21.265 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.855 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.136 ms
rank =  0, finding HY took 26.510 ms
rank =  0, distributing HY into block cyclic form took 21.327 ms
rank =  0, finding Y'*HY took 4.495 ms
Rank 0, Project_Hamiltonian used 76.496 ms
Total time for projection: 76.511 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.230 ms
    first calculated eigval = -0.945600755378053
    last  calculated eigval = 0.028015550303634
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50550663902972
lambda[   6] =  -0.45493357266546
lambda[   7] =  -0.42092223113269
lambda[   8] =  -0.38336544180429
lambda[   9] =  -0.35950386490630
lambda[  10] =  -0.35204420915302
lambda[  11] =  -0.31359058861968
lambda[  12] =  -0.27766616325598
lambda[  13] =  -0.23905087177930
lambda[  14] =  -0.19172920874220
lambda[  15] =  -0.02948519575453
lambda[  16] =  -0.02105348366501
lambda[  17] =   0.01299628301844
lambda[  18] =   0.01447978166682
lambda[  19] =   0.01523301485576
lambda[  20] =   0.01597163288659
lambda[  21] =   0.02801555030363
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.261 ms
rank =  0, subspace rotation using ScaLAPACK took 9.624 ms
rank =  0, Distributing orbital back into band + domain format took 20.782 ms
rank = 0, Subspace_Rotation used 30.419 ms

Total time for subspace rotation: 30.423 ms
rank = 0, Efermi =  -0.058334277779 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 6.546 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.879 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.592 ms
rank = 0, Calculating density took 1816.658 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.917 ms
rank = 0, D2D took 2.012 ms
rank = 0, Transfering density took 2.014 ms
Etot    =   -44.160979223122
Eband   =   -12.714578802840
E1      =    29.295773106134
E2      =   -11.532009833277
E3      =   -16.771491962544
Exc     =   -14.905304716634
Esc     =   -74.140370604758
Entropy =    -0.000000000845
dE = 4.727e-06, dEband = 3.746e-03
rank = 0, Calculating/Estimating energy took 1.033 ms, Etot = -44.160979223, dEtot = 4.727e-06, dEband = 3.746e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2285610930075, which took 0.091 ms

iter_count = 114, r_2norm = 6.201e-06, tol*||rhs|| = 9.142e-06

Anderson update took 68.041 ms, out of which F'*F took 31.774 ms; b-Ax took 215.271 ms, out of which Lap took 192.849 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.669 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841214, int_b + int_rho = -1.528e-13, checking this took 0.142 ms
2-norm of RHS = 778.4353626018502, which took 0.182 ms

iter_count = 222, r_2norm = 7.577e-04, tol*||rhs|| = 7.784e-04

Anderson update took 130.551 ms, out of which F'*F took 63.895 ms; b-Ax took 420.151 ms, out of which Lap took 374.304 ms
Solving Poisson took 927.061 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.179885 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.168334 
Total time for convolution: 	 convolve: 5.166088 
Total time for convolution: 	 convolve: 5.166346 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.118 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.410 ms
---Transfer Veff_loc: D2D took 3.595 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.364 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.994 ms

This SCF took 27920.782 ms, scf error = 1.536e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.128016, lowerbound = -0.945601, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1677.668 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.189 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.864 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.071 ms
rank =  0, finding HY took 26.430 ms
rank =  0, distributing HY into block cyclic form took 21.268 ms
rank =  0, finding Y'*HY took 4.469 ms
Rank 0, Project_Hamiltonian used 76.271 ms
Total time for projection: 76.281 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.228 ms
    first calculated eigval = -0.943072977824516
    last  calculated eigval = 0.029511641688575
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50302611540154
lambda[   6] =  -0.45244670684253
lambda[   7] =  -0.41845099526441
lambda[   8] =  -0.38085504566188
lambda[   9] =  -0.35706931228846
lambda[  10] =  -0.34948582366995
lambda[  11] =  -0.31113307497847
lambda[  12] =  -0.27494703123630
lambda[  13] =  -0.23654626020158
lambda[  14] =  -0.18922728454509
lambda[  15] =  -0.02747689027857
lambda[  16] =  -0.01870410428681
lambda[  17] =   0.01470025633972
lambda[  18] =   0.01658005517754
lambda[  19] =   0.01703078073392
lambda[  20] =   0.01725709190635
lambda[  21] =   0.02951164168857
==subpsace eigenproblem: bcast eigvals took 0.070 ms
Total time for solving subspace eigenvalue problem: 0.304 ms
rank =  0, subspace rotation using ScaLAPACK took 9.604 ms
rank =  0, Distributing orbital back into band + domain format took 20.772 ms
rank = 0, Subspace_Rotation used 30.387 ms

Total time for subspace rotation: 30.392 ms
rank = 0, Efermi =  -0.056325963408 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 6.413 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.911 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 1803.680 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.894 ms
rank = 0, D2D took 1.999 ms
rank = 0, Transfering density took 2.001 ms
Etot    =   -44.160911196414
Eband   =   -12.643666471263
E1      =    29.258527193871
E2      =   -11.496602531978
E3      =   -16.778809301609
Exc     =   -14.910813147007
Esc     =   -74.140370604758
Entropy =    -0.000000000845
dE = 6.184e-06, dEband = 6.447e-03
rank = 0, Calculating/Estimating energy took 1.890 ms, Etot = -44.160911196, dEtot = 6.184e-06, dEband = 6.447e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1210384316711, which took 0.058 ms

iter_count = 114, r_2norm = 3.474e-06, tol*||rhs|| = 4.842e-06

Anderson update took 68.264 ms, out of which F'*F took 32.934 ms; b-Ax took 220.258 ms, out of which Lap took 197.536 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 490.158 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841215, int_b + int_rho = -1.455e-13, checking this took 0.119 ms
2-norm of RHS = 778.4346574052213, which took 0.149 ms

iter_count = 210, r_2norm = 7.181e-04, tol*||rhs|| = 7.784e-04

Anderson update took 126.135 ms, out of which F'*F took 60.009 ms; b-Ax took 396.938 ms, out of which Lap took 354.405 ms
Solving Poisson took 874.586 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.168034 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.265948 
Total time for convolution: 	 convolve: 5.319538 
Total time for convolution: 	 convolve: 5.322039 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.203 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.369 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.536 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.355 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.924 ms

This SCF took 28234.519 ms, scf error = 9.302e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.129512, lowerbound = -0.943073, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1678.412 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.030 ms
rank =  0, Distribute orbital to block cyclic format took 21.248 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.872 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.137 ms
rank =  0, finding HY took 26.402 ms
rank =  0, distributing HY into block cyclic form took 21.602 ms
rank =  0, finding Y'*HY took 4.454 ms
Rank 0, Project_Hamiltonian used 76.651 ms
Total time for projection: 76.661 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.228 ms
    first calculated eigval = -0.941556490541628
    last  calculated eigval = 0.030757102794548
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50162460013880
lambda[   6] =  -0.45105367498574
lambda[   7] =  -0.41697071664298
lambda[   8] =  -0.37939573638012
lambda[   9] =  -0.35559791021002
lambda[  10] =  -0.34813261712621
lambda[  11] =  -0.30974631745678
lambda[  12] =  -0.27346499641638
lambda[  13] =  -0.23515017924070
lambda[  14] =  -0.18774768211364
lambda[  15] =  -0.02463152301820
lambda[  16] =  -0.01725963693275
lambda[  17] =   0.01727760399615
lambda[  18] =   0.01961992263491
lambda[  19] =   0.01998995640516
lambda[  20] =   0.02055216051319
lambda[  21] =   0.03075710279455
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.262 ms
rank =  0, subspace rotation using ScaLAPACK took 9.614 ms
rank =  0, Distributing orbital back into band + domain format took 20.788 ms
rank = 0, Subspace_Rotation used 30.413 ms

Total time for subspace rotation: 30.418 ms
rank = 0, Efermi =  -0.053480683420 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 6.492 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.860 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.574 ms
rank = 0, Calculating density took 1804.800 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.714 ms
rank = 0, D2D took 2.817 ms
rank = 0, Transfering density took 2.820 ms
Etot    =   -44.160886295154
Eband   =   -12.603520736273
E1      =    29.239793552049
E2      =   -11.474713701019
E3      =   -16.780935017872
Exc     =   -14.912437224217
Esc     =   -74.140370604758
Entropy =    -0.000000000845
dE = 2.264e-06, dEband = 3.650e-03
rank = 0, Calculating/Estimating energy took 0.996 ms, Etot = -44.160886295, dEtot = 2.264e-06, dEband = 3.650e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0826042831963, which took 0.053 ms

iter_count = 114, r_2norm = 2.046e-06, tol*||rhs|| = 3.304e-06

Anderson update took 69.212 ms, out of which F'*F took 32.638 ms; b-Ax took 218.300 ms, out of which Lap took 195.684 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.582 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841208, int_b + int_rho = -2.110e-13, checking this took 0.121 ms
2-norm of RHS = 778.4346931980217, which took 0.148 ms

iter_count = 198, r_2norm = 7.320e-04, tol*||rhs|| = 7.784e-04

Anderson update took 117.886 ms, out of which F'*F took 57.019 ms; b-Ax took 380.542 ms, out of which Lap took 341.457 ms
Solving Poisson took 832.042 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.144 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.172578 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.575 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.165477 
Total time for convolution: 	 convolve: 5.161996 
Total time for convolution: 	 convolve: 5.169484 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.762 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.529 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.351 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.913 ms

This SCF took 27796.248 ms, scf error = 5.662e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.130757, lowerbound = -0.941556, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1676.035 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 21.165 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.896 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.081 ms
rank =  0, finding HY took 26.555 ms
rank =  0, distributing HY into block cyclic form took 21.278 ms
rank =  0, finding Y'*HY took 4.497 ms
Rank 0, Project_Hamiltonian used 76.438 ms
Total time for projection: 76.448 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -0.940183625254260
    last  calculated eigval = 0.032054403325541
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50031894938365
lambda[   6] =  -0.44975887309238
lambda[   7] =  -0.41565758483316
lambda[   8] =  -0.37811851942358
lambda[   9] =  -0.35431138961732
lambda[  10] =  -0.34681864303211
lambda[  11] =  -0.30844781885353
lambda[  12] =  -0.27217263211259
lambda[  13] =  -0.23383215769994
lambda[  14] =  -0.18645338570920
lambda[  15] =  -0.02128365122570
lambda[  16] =  -0.01593336409995
lambda[  17] =   0.02089508489400
lambda[  18] =   0.02306068682491
lambda[  19] =   0.02366679798517
lambda[  20] =   0.02442341137333
lambda[  21] =   0.03205440332554
==subpsace eigenproblem: bcast eigvals took 0.060 ms
Total time for solving subspace eigenvalue problem: 0.291 ms
rank =  0, subspace rotation using ScaLAPACK took 9.612 ms
rank =  0, Distributing orbital back into band + domain format took 20.941 ms
rank = 0, Subspace_Rotation used 30.566 ms

Total time for subspace rotation: 30.571 ms
rank = 0, Efermi =  -0.050134208077 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 6.454 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.101 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.600 ms
rank = 0, Calculating density took 1802.604 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.888 ms
rank = 0, D2D took 1.984 ms
rank = 0, Transfering density took 1.987 ms
Etot    =   -44.160954240359
Eband   =   -12.566845398962
E1      =    29.220935646349
E2      =   -11.456265863121
E3      =   -16.783893793937
Exc     =   -14.914833539202
Esc     =   -74.140370604758
Entropy =    -0.000000000845
dE = 6.177e-06, dEband = 3.334e-03
rank = 0, Calculating/Estimating energy took 1.019 ms, Etot = -44.160954240, dEtot = 6.177e-06, dEband = 3.334e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0541569888166, which took 0.109 ms

iter_count = 114, r_2norm = 1.655e-06, tol*||rhs|| = 2.166e-06

Anderson update took 68.027 ms, out of which F'*F took 32.310 ms; b-Ax took 216.645 ms, out of which Lap took 193.941 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.834 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841207, int_b + int_rho = -2.256e-13, checking this took 0.132 ms
2-norm of RHS = 778.4393961805096, which took 0.168 ms

iter_count = 162, r_2norm = 6.418e-04, tol*||rhs|| = 7.784e-04

Anderson update took 97.914 ms, out of which F'*F took 48.864 ms; b-Ax took 313.561 ms, out of which Lap took 280.290 ms
Solving Poisson took 682.524 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.189473 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.174312 
Total time for convolution: 	 convolve: 5.173531 
Total time for convolution: 	 convolve: 5.181115 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.509 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.370 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.912 ms

This SCF took 27681.510 ms, scf error = 3.343e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.132054, lowerbound = -0.940184, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1676.822 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.285 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.858 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.162 ms
rank =  0, finding HY took 26.461 ms
rank =  0, distributing HY into block cyclic form took 21.469 ms
rank =  0, finding Y'*HY took 4.427 ms
Rank 0, Project_Hamiltonian used 76.551 ms
Total time for projection: 76.563 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.142 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.237 ms
    first calculated eigval = -0.939828495154622
    last  calculated eigval = 0.032862608942525
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50000818823883
lambda[   6] =  -0.44945730288097
lambda[   7] =  -0.41533882634294
lambda[   8] =  -0.37780561406508
lambda[   9] =  -0.35400773066679
lambda[  10] =  -0.34651960873353
lambda[  11] =  -0.30814570994207
lambda[  12] =  -0.27184010082736
lambda[  13] =  -0.23350818433684
lambda[  14] =  -0.18613570866878
lambda[  15] =  -0.02008027972335
lambda[  16] =  -0.01562619763323
lambda[  17] =   0.02227057839074
lambda[  18] =   0.02402901781310
lambda[  19] =   0.02488376990778
lambda[  20] =   0.02554845978078
lambda[  21] =   0.03286260894253
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.263 ms
rank =  0, subspace rotation using ScaLAPACK took 9.557 ms
rank =  0, Distributing orbital back into band + domain format took 21.011 ms
rank = 0, Subspace_Rotation used 30.581 ms

Total time for subspace rotation: 30.586 ms
rank = 0, Efermi =  -0.048934037186 calculate fermi energy took 0.120 ms
rank = 0, --- Calculate rho: sum over local bands took 6.532 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.720 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.592 ms
rank = 0, Calculating density took 1803.285 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.923 ms
rank = 0, D2D took 2.023 ms
rank = 0, Transfering density took 2.025 ms
Etot    =   -44.160987138709
Eband   =   -12.558011006272
E1      =    29.216688195226
E2      =   -11.451596164372
E3      =   -16.784206201087
Exc     =   -14.915096087519
Esc     =   -74.140370604758
Entropy =    -0.000000000846
dE = 2.991e-06, dEband = 8.031e-04
rank = 0, Calculating/Estimating energy took 1.006 ms, Etot = -44.160987139, dEtot = 2.991e-06, dEband = 8.031e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0954434594363, which took 0.061 ms

iter_count = 102, r_2norm = 2.699e-06, tol*||rhs|| = 3.818e-06

Anderson update took 61.389 ms, out of which F'*F took 29.668 ms; b-Ax took 198.547 ms, out of which Lap took 178.169 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 441.779 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841218, int_b + int_rho = -1.128e-13, checking this took 0.121 ms
2-norm of RHS = 778.4544147031319, which took 0.161 ms

iter_count = 174, r_2norm = 7.569e-04, tol*||rhs|| = 7.785e-04

Anderson update took 103.971 ms, out of which F'*F took 50.637 ms; b-Ax took 337.961 ms, out of which Lap took 303.205 ms
Solving Poisson took 734.705 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.160534 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.841 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.172632 
Total time for convolution: 	 convolve: 5.169630 
Total time for convolution: 	 convolve: 5.166083 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.543 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.331 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.521 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.350 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.905 ms

This SCF took 27671.656 ms, scf error = 2.638e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132863, lowerbound = -0.939828, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1683.748 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 21.408 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.884 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.310 ms
rank =  0, finding HY took 26.407 ms
rank =  0, distributing HY into block cyclic form took 21.399 ms
rank =  0, finding Y'*HY took 4.479 ms
Rank 0, Project_Hamiltonian used 76.622 ms
Total time for projection: 76.637 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.223 ms
    first calculated eigval = -0.939366342667471
    last  calculated eigval = 0.035599710604509
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49951707555559
lambda[   6] =  -0.44897018173977
lambda[   7] =  -0.41482849397596
lambda[   8] =  -0.37731352421860
lambda[   9] =  -0.35348836813799
lambda[  10] =  -0.34604143844797
lambda[  11] =  -0.30765572408156
lambda[  12] =  -0.27135784747899
lambda[  13] =  -0.23302806424124
lambda[  14] =  -0.18565084149668
lambda[  15] =  -0.01707809707121
lambda[  16] =  -0.01514020511699
lambda[  17] =   0.02457054851913
lambda[  18] =   0.02635454993486
lambda[  19] =   0.02817192683884
lambda[  20] =   0.02833630036622
lambda[  21] =   0.03559971060451
==subpsace eigenproblem: bcast eigvals took 0.056 ms
Total time for solving subspace eigenvalue problem: 0.286 ms
rank =  0, subspace rotation using ScaLAPACK took 9.593 ms
rank =  0, Distributing orbital back into band + domain format took 20.826 ms
rank = 0, Subspace_Rotation used 30.431 ms

Total time for subspace rotation: 30.437 ms
rank = 0, Efermi =  -0.046021793198 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 6.607 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.805 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 1811.053 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.887 ms
rank = 0, D2D took 1.984 ms
rank = 0, Transfering density took 1.987 ms
Etot    =   -44.161084561010
Eband   =   -12.544248069108
E1      =    29.210269651882
E2      =   -11.444059653642
E3      =   -16.784815036585
Exc     =   -14.915610228401
Esc     =   -74.140370604758
Entropy =    -0.000000000853
dE = 8.857e-06, dEband = 1.251e-03
rank = 0, Calculating/Estimating energy took 1.016 ms, Etot = -44.161084561, dEtot = 8.857e-06, dEband = 1.251e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0388702018562, which took 0.062 ms

iter_count = 108, r_2norm = 1.469e-06, tol*||rhs|| = 1.555e-06

Anderson update took 64.454 ms, out of which F'*F took 30.687 ms; b-Ax took 207.198 ms, out of which Lap took 185.355 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.997 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841221, int_b + int_rho = -8.731e-14, checking this took 0.122 ms
2-norm of RHS = 778.4511583881225, which took 0.165 ms

iter_count = 114, r_2norm = 6.827e-04, tol*||rhs|| = 7.785e-04

Anderson update took 68.108 ms, out of which F'*F took 33.354 ms; b-Ax took 223.166 ms, out of which Lap took 199.654 ms
Solving Poisson took 482.757 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.183202 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.164736 
Total time for convolution: 	 convolve: 5.174328 
Total time for convolution: 	 convolve: 5.162248 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.593 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.527 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.363 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.924 ms

This SCF took 27427.049 ms, scf error = 1.847e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.135600, lowerbound = -0.939366, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1698.794 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.252 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.985 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.259 ms
rank =  0, finding HY took 26.330 ms
rank =  0, distributing HY into block cyclic form took 21.448 ms
rank =  0, finding Y'*HY took 4.463 ms
Rank 0, Project_Hamiltonian used 76.528 ms
Total time for projection: 76.542 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.139 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.650 ms
rank = 0, Solve_Generalized_EigenProblem used 1.197 ms
    first calculated eigval = -0.939288936760797
    last  calculated eigval = 0.035936138545293
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49945232382224
lambda[   6] =  -0.44890683396350
lambda[   7] =  -0.41477017961401
lambda[   8] =  -0.37725075985344
lambda[   9] =  -0.35343866679167
lambda[  10] =  -0.34597134029891
lambda[  11] =  -0.30759670858973
lambda[  12] =  -0.27128091479879
lambda[  13] =  -0.23295440852073
lambda[  14] =  -0.18558480734085
lambda[  15] =  -0.01687050220486
lambda[  16] =  -0.01509278292803
lambda[  17] =   0.02455095606039
lambda[  18] =   0.02638162607073
lambda[  19] =   0.02821624377722
lambda[  20] =   0.02851919133634
lambda[  21] =   0.03593613854529
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 1.216 ms
rank =  0, subspace rotation using ScaLAPACK took 9.644 ms
rank =  0, Distributing orbital back into band + domain format took 20.695 ms
rank = 0, Subspace_Rotation used 30.350 ms

Total time for subspace rotation: 30.355 ms
rank = 0, Efermi =  -0.045832397556 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 6.476 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.799 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.572 ms
rank = 0, Calculating density took 1825.918 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.888 ms
rank = 0, D2D took 1.992 ms
rank = 0, Transfering density took 1.999 ms
Etot    =   -44.161094707725
Eband   =   -12.542402536936
E1      =    29.209121111214
E2      =   -11.443332805443
E3      =   -16.784969601690
Exc     =   -14.915745083525
Esc     =   -74.140370604758
Entropy =    -0.000000000854
dE = 9.224e-07, dEband = 1.678e-04
rank = 0, Calculating/Estimating energy took 1.005 ms, Etot = -44.161094708, dEtot = 9.224e-07, dEband = 1.678e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0487224852563, which took 0.058 ms

iter_count = 102, r_2norm = 1.721e-06, tol*||rhs|| = 1.949e-06

Anderson update took 61.621 ms, out of which F'*F took 29.687 ms; b-Ax took 197.710 ms, out of which Lap took 177.657 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 441.008 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841220, int_b + int_rho = -9.459e-14, checking this took 0.122 ms
2-norm of RHS = 778.4537153442483, which took 0.155 ms

iter_count = 138, r_2norm = 7.263e-04, tol*||rhs|| = 7.785e-04

Anderson update took 83.058 ms, out of which F'*F took 40.151 ms; b-Ax took 266.847 ms, out of which Lap took 237.855 ms
Solving Poisson took 583.716 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.169862 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.824 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.144 ms
Total time for convolution: 	 convolve: 5.176043 
Total time for convolution: 	 convolve: 5.170985 
Total time for convolution: 	 convolve: 5.183659 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.772 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.247 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.513 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.342 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.891 ms

This SCF took 27580.167 ms, scf error = 1.391e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135936, lowerbound = -0.939289, upperbound = 267.586694

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1693.445 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.198 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.828 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.564 ms
rank =  0, finding HY took 26.411 ms
rank =  0, distributing HY into block cyclic form took 21.036 ms
rank =  0, finding Y'*HY took 4.464 ms
Rank 0, Project_Hamiltonian used 76.510 ms
Total time for projection: 76.523 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -0.939087837124190
    last  calculated eigval = 0.036956448482874
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49927697954302
lambda[   6] =  -0.44873319576491
lambda[   7] =  -0.41459114071890
lambda[   8] =  -0.37706925495421
lambda[   9] =  -0.35326760971418
lambda[  10] =  -0.34579943264916
lambda[  11] =  -0.30743119031794
lambda[  12] =  -0.27109033492193
lambda[  13] =  -0.23277767306050
lambda[  14] =  -0.18539942149853
lambda[  15] =  -0.01668402060133
lambda[  16] =  -0.01498277550455
lambda[  17] =   0.02363888410558
lambda[  18] =   0.02622705321314
lambda[  19] =   0.02807033097875
lambda[  20] =   0.02876101711848
lambda[  21] =   0.03695644848287
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.256 ms
rank =  0, subspace rotation using ScaLAPACK took 9.622 ms
rank =  0, Distributing orbital back into band + domain format took 20.775 ms
rank = 0, Subspace_Rotation used 30.407 ms

Total time for subspace rotation: 30.413 ms
rank = 0, Efermi =  -0.045655683269 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 6.505 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.945 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 1819.803 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.914 ms
rank = 0, D2D took 2.015 ms
rank = 0, Transfering density took 2.017 ms
Etot    =   -44.161139996829
Eband   =   -12.537403111112
E1      =    29.206728559168
E2      =   -11.440618104399
E3      =   -16.785215351925
Exc     =   -14.915928295598
Esc     =   -74.140370604758
Entropy =    -0.000000000854
dE = 4.117e-06, dEband = 4.545e-04
rank = 0, Calculating/Estimating energy took 1.010 ms, Etot = -44.161139997, dEtot = 4.117e-06, dEband = 4.545e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0219419389719, which took 0.158 ms

iter_count = 108, r_2norm = 8.184e-07, tol*||rhs|| = 8.777e-07

Anderson update took 65.526 ms, out of which F'*F took 30.991 ms; b-Ax took 206.915 ms, out of which Lap took 185.612 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 464.837 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002841229, int_rho =  28.00000002841216, int_b + int_rho = -1.310e-13, checking this took 0.134 ms
2-norm of RHS = 778.4539144046779, which took 0.180 ms

iter_count = 108, r_2norm = 7.007e-04, tol*||rhs|| = 7.785e-04

Anderson update took 65.026 ms, out of which F'*F took 31.675 ms; b-Ax took 208.084 ms, out of which Lap took 186.212 ms
Solving Poisson took 455.920 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.129 ms
Total time for convolution: 	 convolve: 5.165905 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.939 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.171739 
Total time for convolution: 	 convolve: 5.168759 
Total time for convolution: 	 convolve: 5.164396 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.350 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.517 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.360 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.922 ms

This SCF took 28296.213 ms, scf error = 9.606e-05
The last 17 occupations of kpoints #1 are (Nelectron = 28):
lambda[   5] =  -0.49927697954302, occ[   5] =   2.00000000000000
lambda[   6] =  -0.44873319576491, occ[   6] =   2.00000000000000
lambda[   7] =  -0.41459114071890, occ[   7] =   2.00000000000000
lambda[   8] =  -0.37706925495421, occ[   8] =   2.00000000000000
lambda[   9] =  -0.35326760971418, occ[   9] =   2.00000000000000
lambda[  10] =  -0.34579943264916, occ[  10] =   2.00000000000000
lambda[  11] =  -0.30743119031794, occ[  11] =   2.00000000000000
lambda[  12] =  -0.27109033492193, occ[  12] =   2.00000000000000
lambda[  13] =  -0.23277767306050, occ[  13] =   2.00000000000000
lambda[  14] =  -0.18539942149853, occ[  14] =   2.00000000000000
lambda[  15] =  -0.01668402060133, occ[  15] =   0.00000002481838
lambda[  16] =  -0.01498277550455, occ[  16] =   0.00000000359375
lambda[  17] =   0.02363888410558, occ[  17] =   0.00000000000000
lambda[  18] =   0.02622705321314, occ[  18] =   0.00000000000000
lambda[  19] =   0.02807033097875, occ[  19] =   0.00000000000000
lambda[  20] =   0.02876101711848, occ[  20] =   0.00000000000000
lambda[  21] =   0.03695644848287, occ[  21] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 19 (90%) = 0.000000000000000.
Occupation of state 21 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.669 ms, time for Allreduce/Reduce: 12.421 ms 
Time for calculating local force components: 23.644 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000018711842  -0.00000107969220  -1.00395470911157
 -0.03948124419430  -0.02729500284243  -0.01037214086978
  0.03948126820928  -0.02729497987235  -0.01037218272740
  0.03948132458393   0.02729511190969  -0.01037215784885
 -0.03948128978311   0.02729507956505  -0.01037220114521
 -0.00000000489364  -0.03102309204690   0.04150379425466
  0.00000003588347   0.03102318805806   0.04150400612116
  0.00000091080051  -0.13208897208154   0.07063109843481
  0.00000025412763   0.01655200860772   0.02436798112384
  0.00000028098962  -0.01655650899300   0.02436838976083
 -0.00000013540547   0.13209052712961   0.07062648443968
force_loc = 
 -0.00000110309922   0.00000162702030   0.98054146564792
  0.04112664271365   0.02801871961809   0.01080737047662
 -0.04112697930518   0.02801869426355   0.01080923210596
 -0.04112716686423  -0.02802034659935   0.01080675008899
  0.04112922235029  -0.02802062992352   0.01080881240286
  0.00000023268477   0.03198691300009  -0.04358123594057
  0.00000065081582  -0.03198600108826  -0.04358000344890
  0.00000093468332   0.12994665794633  -0.07197140505492
 -0.00000032353075  -0.00327978784764  -0.02208534916211
  0.00000072371636   0.00327818241502  -0.02208521950603
 -0.00000089420436  -0.12994684548876  -0.07197180093612
Time for calculating nonlocal force components: 47.783 ms
[32mforces_xc: 
[0m[32m -0.00000006325971  -0.00000003721534   0.03277044942858
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000650887   0.00640852352274  -0.00363227217777
[0m[32m  0.00000000898048  -0.00681121631614  -0.00043611778042
[0m[32m  0.00000017491097   0.00681110082915  -0.00043605017138
[0m[32m -0.00000000414901  -0.00640854820767  -0.00363215590731
[0mTime for calculating XC forces components: 32.730 ms
 Cartesian force = 
 -0.00000165130931   0.00000112050637   0.00929440301061
  0.00164510068738   0.00072432716927   0.00037242665252
 -0.00164600892786   0.00072432478481   0.00037424642423
 -0.00164614011226  -0.00072462429605   0.00037178928581
  0.00164763473522  -0.00072493996486   0.00037380830332
 -0.00000007004083   0.00096443134680  -0.00214024464024
  0.00000038886733  -0.00096220263658  -0.00213880028206
  0.00000155416075   0.00426681978113  -0.00503538175221
 -0.00000035825461   0.00646161483754   0.00178371122699
  0.00000088178499  -0.00646661535522   0.00178431712909
 -0.00000133159080  -0.00426425617321  -0.00504027535808
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.354 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.370 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.168 ms
Time for printing density: 383.556 ms
The program took 425.265 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:34:34
Job ID:        2266819
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:27:24,vmem=8424K,walltime=00:07:17,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-9-1
---------------------------------------
