---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:48
Job ID:    2266502
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:53
Job ID:    2266502
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.053 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 13.965 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 4.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 12.797 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 103.432 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.992 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.135 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   11.769583	    8.281361	
   10.000000	    8.230417	    8.281361	
   10.000000	   10.000000	    9.354881	
   10.000000	   10.000000	   11.718639	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.203 ms
Set up communicators.

--set up spincomm took 2.253 ms

--set up kptcomm took 0.360 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 11, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 11, ScaLAPACK topology Dims = (11, 1)
nproc = 12, size_blacscomm = 11 = dims[0] * dims[1] = (11, 1)
Nd_blacscomm 1000000, Nstates 11 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 1), actual size (1000000, 1)
rank = 0, mb = nb = 11, mbQ = nbQ = 64
rank = 0, nr_Hp = 11, nc_Hp = 11
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.115 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 11
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 11
# of bands per bandcomm          : 1
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.121 ms

Calculate_SplineDerivRadFun took 0.197 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.790 ms.
time spent on vectorized spline interp: 2.743 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.757 ms.
time spent on vectorized spline interp: 1.725 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.517 ms.
time spent on vectorized spline interp: 1.653 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.528 ms.

Calculating rb for all atom types took 15.722 ms
----------------------
Estimated memory usage
Total: 788.88 MB
orbitals             : 503.54 MB
global sized vectors : 213.62 MB
subspace matrices : 2.84 kB
others : 71.72 MB
----------------------------------------------
Estimated memory usage per processor: 65.74 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.070 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.011 ms
Calculating pseudocharge density ... 
the global sum of int_b = -11.0000000063075, sum_int_rho = 10.7968690196228
PosCharge = 11.000000006307, NegCharge = -10.796869019623, scal_fac = 1.018813878942
After scaling, int_rho = 11.0000000063075, PosCharge + NegCharge - NetCharge = -2.665e-14
--Calculate Vref took 0.242 ms
--Calculate rho_guess took 1.296 ms

 integral of b = -11.0000000063075,
 int{b} + Nelectron + NetCharge = -6.307e-09,
 Esc = -29.8274364789682,
 MPI_Reduce took 1.204 ms

Calculating b & b_ref took 7.130 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.036 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.044 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.031 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.260 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 22.050 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630754, int_b + int_rho = -1.273e-13, checking this took 0.091 ms
2-norm of RHS = 484.7204317744784, which took 0.077 ms

iter_count = 420, r_2norm = 4.600e-04, tol*||rhs|| = 4.847e-04

Anderson update took 233.879 ms, out of which F'*F took 104.869 ms; b-Ax took 710.974 ms, out of which Lap took 636.057 ms
Solving Poisson took 1519.445 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.394 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
Total time for convolution: 	 convolve: 5.111414 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
Total time for convolution: 	 convolve: 5.112652 
Total time for convolution: 	 convolve: 5.107560 
Total time for convolution: 	 convolve: 5.100549 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.729 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.626 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.401 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
rank = 0, XC calculation took 24322.807 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 4.904 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.269 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 15.299 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.150 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.642 ms
    Lanczos iter 53, eigmin  = -0.921827622, eigmax = 264.917221173, err_eigmin = 7.730e-04, err_eigmax = 9.839e-03
rank =   0, Lanczos took 119.448 ms, eigmin = -0.921827622152, eigmax = 267.566393385104

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.272283, lowerbound = -1.021828, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 773.429 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.558 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.760 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.342 ms
rank =  0, finding HY took 14.971 ms
rank =  0, distributing HY into block cyclic form took 7.542 ms
rank =  0, finding Y'*HY took 2.409 ms
Rank 0, Project_Hamiltonian used 35.307 ms
Total time for projection: 35.323 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.365 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.119 ms
rank = 0, Solve_Generalized_EigenProblem used 1.011 ms
    first calculated eigval = 2.835312549707637
    last  calculated eigval = 3.188521960183062
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =   2.83531254970764
lambda[   2] =   2.87881421196121
lambda[   3] =   2.88324491627838
lambda[   4] =   2.95260539105477
lambda[   5] =   2.97060949648695
lambda[   6] =   2.98227985949934
lambda[   7] =   3.04345452035729
lambda[   8] =   3.06961821215806
lambda[   9] =   3.12174767337098
lambda[  10] =   3.12833454561667
lambda[  11] =   3.18852196018306
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.030 ms
rank =  0, subspace rotation using ScaLAPACK took 2.909 ms
rank =  0, Distributing orbital back into band + domain format took 7.523 ms
rank = 0, Subspace_Rotation used 10.449 ms

Total time for subspace rotation: 10.456 ms
rank = 0, Efermi =   2.982429354732 calculate fermi energy took 0.084 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.288522, lowerbound = -1.021828, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 777.275 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 7.977 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.682 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.685 ms
rank =  0, finding HY took 13.157 ms
rank =  0, distributing HY into block cyclic form took 7.600 ms
rank =  0, finding Y'*HY took 2.357 ms
Rank 0, Project_Hamiltonian used 32.834 ms
Total time for projection: 32.840 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.639948799921054
    last  calculated eigval = 0.442707185401667
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.63994879992105
lambda[   2] =  -0.26053991581856
lambda[   3] =  -0.09076719749870
lambda[   4] =   0.03605315255527
lambda[   5] =   0.21594553047449
lambda[   6] =   0.33807418218531
lambda[   7] =   0.34792493095912
lambda[   8] =   0.34940086802698
lambda[   9] =   0.37202274338241
lambda[  10] =   0.41556330940057
lambda[  11] =   0.44270718540167
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 2.564 ms
rank =  0, Distributing orbital back into band + domain format took 7.541 ms
rank = 0, Subspace_Rotation used 10.121 ms

Total time for subspace rotation: 10.128 ms
rank = 0, Efermi =   0.337613810232 calculate fermi energy took 0.033 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.542707, lowerbound = -1.021828, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 777.087 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 7.717 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.747 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.492 ms
rank =  0, finding HY took 13.166 ms
rank =  0, distributing HY into block cyclic form took 7.494 ms
rank =  0, finding Y'*HY took 2.373 ms
Rank 0, Project_Hamiltonian used 32.560 ms
Total time for projection: 32.566 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 1.127 ms
    first calculated eigval = -0.928214080096909
    last  calculated eigval = 0.144827996902122
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.92821408009691
lambda[   2] =  -0.62943143579791
lambda[   3] =  -0.51807375944474
lambda[   4] =  -0.40735545466680
lambda[   5] =  -0.34294606947436
lambda[   6] =  -0.15984168126289
lambda[   7] =   0.01544138070347
lambda[   8] =   0.06024848694327
lambda[   9] =   0.11009336339389
lambda[  10] =   0.12547636691125
lambda[  11] =   0.14482799690212
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.140 ms
rank =  0, subspace rotation using ScaLAPACK took 2.578 ms
rank =  0, Distributing orbital back into band + domain format took 7.537 ms
rank = 0, Subspace_Rotation used 10.136 ms

Total time for subspace rotation: 10.145 ms
rank = 0, Efermi =  -0.159841681222 calculate fermi energy took 0.032 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.244828, lowerbound = -1.021828, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 775.218 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 7.920 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.742 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.690 ms
rank =  0, finding HY took 13.085 ms
rank =  0, distributing HY into block cyclic form took 7.563 ms
rank =  0, finding Y'*HY took 2.346 ms
Rank 0, Project_Hamiltonian used 32.722 ms
Total time for projection: 32.729 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.195 ms
    first calculated eigval = -0.928557832697334
    last  calculated eigval = 0.086137975429165
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.92855783269733
lambda[   2] =  -0.63332523497004
lambda[   3] =  -0.52439866627878
lambda[   4] =  -0.41662329051045
lambda[   5] =  -0.38663271653122
lambda[   6] =  -0.25021771071931
lambda[   7] =  -0.07707772591573
lambda[   8] =   0.00563304983719
lambda[   9] =   0.06569358547200
lambda[  10] =   0.07892495146946
lambda[  11] =   0.08613797542916
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 2.594 ms
rank =  0, Distributing orbital back into band + domain format took 7.519 ms
rank = 0, Subspace_Rotation used 10.132 ms

Total time for subspace rotation: 10.139 ms
rank = 0, Efermi =  -0.250217710678 calculate fermi energy took 0.031 ms
rank = 0, --- Calculate rho: sum over local bands took 2.489 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.800 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.559 ms
rank = 0, Calculating density took 3416.775 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.768 ms
rank = 0, D2D took 1.865 ms
rank = 0, Transfering density took 1.867 ms
Etot    =   -17.525298412109
Eband   =    -6.029293194275
E1      =    12.807937012302
E2      =    -4.916497114872
E3      =    -6.150407212707
Exc     =    -5.539263361792
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 4.381e+00, dEband = 1.507e+00
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -17.525298412, dEtot = 4.381e+00, dEband = 1.507e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 33.3002062504373, which took 0.066 ms

iter_count = 96, r_2norm = 9.300e-04, tol*||rhs|| = 1.332e-03

Anderson update took 51.370 ms, out of which F'*F took 24.208 ms; b-Ax took 162.853 ms, out of which Lap took 145.757 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 350.536 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630749, int_b + int_rho = -1.764e-13, checking this took 0.221 ms
2-norm of RHS = 482.3732917131441, which took 0.075 ms

iter_count = 282, r_2norm = 4.100e-04, tol*||rhs|| = 4.824e-04

Anderson update took 150.686 ms, out of which F'*F took 70.088 ms; b-Ax took 472.065 ms, out of which Lap took 423.654 ms
Solving Poisson took 1012.487 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.393 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.092326 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.086013 
Total time for convolution: 	 convolve: 5.140274 
Total time for convolution: 	 convolve: 5.075997 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 395.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 3.502 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.997 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.535 ms

This SCF took 29573.876 ms, scf error = 1.730e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.186138, lowerbound = -0.928558, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 775.148 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 9.913 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.762 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.712 ms
rank =  0, finding HY took 13.327 ms
rank =  0, distributing HY into block cyclic form took 7.520 ms
rank =  0, finding Y'*HY took 2.393 ms
Rank 0, Project_Hamiltonian used 34.994 ms
Total time for projection: 35.019 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.898940129934468
    last  calculated eigval = 0.059033211805925
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.89894012993447
lambda[   2] =  -0.60841847019178
lambda[   3] =  -0.49989884147860
lambda[   4] =  -0.39292335858552
lambda[   5] =  -0.36625070066159
lambda[   6] =  -0.23916556014877
lambda[   7] =  -0.09816852631525
lambda[   8] =  -0.01779789220816
lambda[   9] =   0.04160516815463
lambda[  10] =   0.05209599015854
lambda[  11] =   0.05903321180592
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 2.611 ms
rank =  0, Distributing orbital back into band + domain format took 7.576 ms
rank = 0, Subspace_Rotation used 10.203 ms

Total time for subspace rotation: 10.209 ms
rank = 0, Efermi =  -0.239165560108 calculate fermi energy took 0.068 ms
rank = 0, --- Calculate rho: sum over local bands took 2.509 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.558 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.572 ms
rank = 0, Calculating density took 834.383 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.832 ms
rank = 0, D2D took 1.934 ms
rank = 0, Transfering density took 1.936 ms
Etot    =   -17.509734680591
Eband   =    -5.772028563361
E1      =    12.571150403419
E2      =    -4.898200655334
E3      =    -6.220823617453
Exc     =    -5.596297597513
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 3.891e-03, dEband = 6.432e-02
rank = 0, Calculating/Estimating energy took 1.407 ms, Etot = -17.509734681, dEtot = 3.891e-03, dEband = 6.432e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 14.3964610207169, which took 0.057 ms

iter_count = 102, r_2norm = 3.959e-04, tol*||rhs|| = 5.759e-04

Anderson update took 54.727 ms, out of which F'*F took 25.300 ms; b-Ax took 172.121 ms, out of which Lap took 153.453 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.462 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630754, int_b + int_rho = -1.291e-13, checking this took 0.101 ms
2-norm of RHS = 478.8244553000120, which took 0.136 ms

iter_count = 300, r_2norm = 3.891e-04, tol*||rhs|| = 4.788e-04

Anderson update took 165.053 ms, out of which F'*F took 74.228 ms; b-Ax took 502.298 ms, out of which Lap took 449.074 ms
Solving Poisson took 1082.829 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.072451 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.786 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.075883 
Total time for convolution: 	 convolve: 5.083518 
Total time for convolution: 	 convolve: 5.112683 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.040 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.515 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.866 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.416 ms

This SCF took 26925.601 ms, scf error = 1.189e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.159033, lowerbound = -0.898940, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 773.939 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.821 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.317 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.159 ms
rank =  0, finding HY took 13.351 ms
rank =  0, distributing HY into block cyclic form took 7.497 ms
rank =  0, finding Y'*HY took 2.367 ms
Rank 0, Project_Hamiltonian used 33.419 ms
Total time for projection: 33.434 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -0.843280610572155
    last  calculated eigval = 0.045959200618545
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.84328061057216
lambda[   2] =  -0.56450341409344
lambda[   3] =  -0.45643080648014
lambda[   4] =  -0.34320821156459
lambda[   5] =  -0.32746551245855
lambda[   6] =  -0.20439635021567
lambda[   7] =  -0.07251218009574
lambda[   8] =  -0.02658212187697
lambda[   9] =   0.02920946496432
lambda[  10] =   0.03154290723211
lambda[  11] =   0.04595920061854
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 2.671 ms
rank =  0, Distributing orbital back into band + domain format took 7.586 ms
rank = 0, Subspace_Rotation used 10.274 ms

Total time for subspace rotation: 10.280 ms
rank = 0, Efermi =  -0.204396350175 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 2.478 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.814 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.549 ms
rank = 0, Calculating density took 832.839 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.888 ms
rank = 0, D2D took 3.017 ms
rank = 0, Transfering density took 3.021 ms
Etot    =   -17.491222848070
Eband   =    -5.274173461843
E1      =    12.141970037155
E2      =    -4.818012167864
E3      =    -6.373149289087
Exc     =    -5.718597684411
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 4.628e-03, dEband = 1.245e-01
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -17.491222848, dEtot = 4.628e-03, dEband = 1.245e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.1029510774862, which took 0.054 ms

iter_count = 102, r_2norm = 1.787e-04, tol*||rhs|| = 2.041e-04

Anderson update took 54.558 ms, out of which F'*F took 25.403 ms; b-Ax took 170.979 ms, out of which Lap took 153.490 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.152 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630753, int_b + int_rho = -1.364e-13, checking this took 0.100 ms
2-norm of RHS = 478.8374145121579, which took 0.104 ms

iter_count = 264, r_2norm = 4.273e-04, tol*||rhs|| = 4.788e-04

Anderson update took 142.256 ms, out of which F'*F took 65.388 ms; b-Ax took 444.774 ms, out of which Lap took 397.810 ms
Solving Poisson took 951.900 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.091061 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.302105 
Total time for convolution: 	 convolve: 5.078699 
Total time for convolution: 	 convolve: 5.086970 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.198 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.422 ms
---Transfer Veff_loc: D2D took 3.548 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.991 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.574 ms

This SCF took 26795.578 ms, scf error = 3.383e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.145959, lowerbound = -0.843281, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 773.941 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.442 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.741 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.210 ms
rank =  0, finding HY took 13.360 ms
rank =  0, distributing HY into block cyclic form took 7.416 ms
rank =  0, finding Y'*HY took 2.376 ms
Rank 0, Project_Hamiltonian used 32.399 ms
Total time for projection: 32.414 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.198 ms
    first calculated eigval = -0.835200610854149
    last  calculated eigval = 0.039080405473339
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.83520061085415
lambda[   2] =  -0.55724528239278
lambda[   3] =  -0.44895222487432
lambda[   4] =  -0.33471494286493
lambda[   5] =  -0.32181646980208
lambda[   6] =  -0.19812918265264
lambda[   7] =  -0.06996526332389
lambda[   8] =  -0.02934888017302
lambda[   9] =   0.02038378036311
lambda[  10] =   0.02556778953421
lambda[  11] =   0.03908040547334
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 2.632 ms
rank =  0, Distributing orbital back into band + domain format took 7.600 ms
rank = 0, Subspace_Rotation used 10.255 ms

Total time for subspace rotation: 10.263 ms
rank = 0, Efermi =  -0.198129182612 calculate fermi energy took 0.077 ms
rank = 0, --- Calculate rho: sum over local bands took 2.553 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.830 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.518 ms
rank = 0, Calculating density took 832.900 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.495 ms
rank = 0, D2D took 2.594 ms
rank = 0, Transfering density took 2.596 ms
Etot    =   -17.489948535511
Eband   =    -5.193988245479
E1      =    12.087674522026
E2      =    -4.786940800707
E3      =    -6.400885310526
Exc     =    -5.739877727368
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 3.186e-04, dEband = 2.005e-02
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -17.489948536, dEtot = 3.186e-04, dEband = 2.005e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.3135619470746, which took 0.056 ms

iter_count = 108, r_2norm = 4.830e-05, tol*||rhs|| = 5.254e-05

Anderson update took 57.675 ms, out of which F'*F took 27.137 ms; b-Ax took 185.076 ms, out of which Lap took 165.794 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.868 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630750, int_b + int_rho = -1.637e-13, checking this took 0.103 ms
2-norm of RHS = 479.6837135162201, which took 0.128 ms

iter_count = 264, r_2norm = 4.682e-04, tol*||rhs|| = 4.797e-04

Anderson update took 141.620 ms, out of which F'*F took 66.541 ms; b-Ax took 446.882 ms, out of which Lap took 400.327 ms
Solving Poisson took 948.216 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.084707 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.255 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.088272 
Total time for convolution: 	 convolve: 5.124716 
Total time for convolution: 	 convolve: 5.097026 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.361 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.138 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 3.577 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.517 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.130 ms

This SCF took 26596.045 ms, scf error = 1.953e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.139080, lowerbound = -0.835201, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 774.886 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.430 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.754 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.211 ms
rank =  0, finding HY took 13.378 ms
rank =  0, distributing HY into block cyclic form took 7.499 ms
rank =  0, finding Y'*HY took 2.512 ms
Rank 0, Project_Hamiltonian used 32.650 ms
Total time for projection: 32.665 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.121 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -0.833823132779787
    last  calculated eigval = 0.034320384538592
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.83382313277979
lambda[   2] =  -0.55457423873410
lambda[   3] =  -0.44581590366901
lambda[   4] =  -0.33150210556708
lambda[   5] =  -0.32060474884061
lambda[   6] =  -0.19549779727606
lambda[   7] =  -0.06961223380223
lambda[   8] =  -0.03092814084663
lambda[   9] =   0.01613751432725
lambda[  10] =   0.02215850935206
lambda[  11] =   0.03432038453859
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 2.595 ms
rank =  0, Distributing orbital back into band + domain format took 7.606 ms
rank = 0, Subspace_Rotation used 10.221 ms

Total time for subspace rotation: 10.228 ms
rank = 0, Efermi =  -0.195497797235 calculate fermi energy took 0.902 ms
rank = 0, --- Calculate rho: sum over local bands took 2.591 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.883 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.565 ms
rank = 0, Calculating density took 833.578 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.820 ms
rank = 0, D2D took 1.925 ms
rank = 0, Transfering density took 1.931 ms
Etot    =   -17.489070446517
Eband   =    -5.168138057690
E1      =    12.092592257209
E2      =    -4.753177793364
E3      =    -6.410933261660
Exc     =    -5.746052505136
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 2.195e-04, dEband = 6.463e-03
rank = 0, Calculating/Estimating energy took 0.939 ms, Etot = -17.489070447, dEtot = 2.195e-04, dEband = 6.463e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4988953204870, which took 0.125 ms

iter_count = 114, r_2norm = 1.361e-05, tol*||rhs|| = 1.996e-05

Anderson update took 61.498 ms, out of which F'*F took 28.503 ms; b-Ax took 193.803 ms, out of which Lap took 173.927 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.350 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630750, int_b + int_rho = -1.655e-13, checking this took 0.090 ms
2-norm of RHS = 479.7783901003803, which took 0.158 ms

iter_count = 240, r_2norm = 3.970e-04, tol*||rhs|| = 4.798e-04

Anderson update took 128.974 ms, out of which F'*F took 60.026 ms; b-Ax took 407.208 ms, out of which Lap took 364.074 ms
Solving Poisson took 862.318 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.404 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.096326 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.869 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.087488 
Total time for convolution: 	 convolve: 5.084236 
Total time for convolution: 	 convolve: 5.081489 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.375 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.587 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 3.584 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.064 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.685 ms

This SCF took 26491.733 ms, scf error = 5.536e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.134320, lowerbound = -0.833823, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 774.231 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.392 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.732 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.140 ms
rank =  0, finding HY took 13.450 ms
rank =  0, distributing HY into block cyclic form took 7.507 ms
rank =  0, finding Y'*HY took 2.297 ms
Rank 0, Project_Hamiltonian used 32.425 ms
Total time for projection: 32.437 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -0.831367918413440
    last  calculated eigval = 0.031404621881138
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.83136791841344
lambda[   2] =  -0.55274899741319
lambda[   3] =  -0.44401018562620
lambda[   4] =  -0.32893568737799
lambda[   5] =  -0.31849459982155
lambda[   6] =  -0.19355974729585
lambda[   7] =  -0.06815204694147
lambda[   8] =  -0.03169923053521
lambda[   9] =   0.01427361841078
lambda[  10] =   0.01902542988272
lambda[  11] =   0.03140462188114
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 2.598 ms
rank =  0, Distributing orbital back into band + domain format took 7.558 ms
rank = 0, Subspace_Rotation used 10.914 ms

Total time for subspace rotation: 10.923 ms
rank = 0, Efermi =  -0.193559747255 calculate fermi energy took 0.657 ms
rank = 0, --- Calculate rho: sum over local bands took 2.520 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.616 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.585 ms
rank = 0, Calculating density took 833.250 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.811 ms
rank = 0, D2D took 1.913 ms
rank = 0, Transfering density took 1.918 ms
Etot    =   -17.488984394566
Eband   =    -5.144674525821
E1      =    12.080009246969
E2      =    -4.740933126865
E3      =    -6.416098339037
Exc     =    -5.749767385692
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 2.151e-05, dEband = 5.866e-03
rank = 0, Calculating/Estimating energy took 0.928 ms, Etot = -17.488984395, dEtot = 2.151e-05, dEband = 5.866e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2744552110868, which took 0.986 ms

iter_count = 114, r_2norm = 7.365e-06, tol*||rhs|| = 1.098e-05

Anderson update took 60.677 ms, out of which F'*F took 28.977 ms; b-Ax took 194.191 ms, out of which Lap took 174.483 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.278 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630750, int_b + int_rho = -1.655e-13, checking this took 0.117 ms
2-norm of RHS = 480.0020804952979, which took 0.097 ms

iter_count = 252, r_2norm = 4.095e-04, tol*||rhs|| = 4.800e-04

Anderson update took 133.857 ms, out of which F'*F took 61.944 ms; b-Ax took 424.628 ms, out of which Lap took 378.559 ms
Solving Poisson took 903.645 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.485 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.084709 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.081567 
Total time for convolution: 	 convolve: 5.084253 
Total time for convolution: 	 convolve: 5.075440 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.452 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.432 ms
---Transfer Veff_loc: D2D took 3.546 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.038 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.618 ms

This SCF took 26503.554 ms, scf error = 3.836e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.131405, lowerbound = -0.831368, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 774.528 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.523 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.767 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.305 ms
rank =  0, finding HY took 13.442 ms
rank =  0, distributing HY into block cyclic form took 7.488 ms
rank =  0, finding Y'*HY took 2.314 ms
Rank 0, Project_Hamiltonian used 32.579 ms
Total time for projection: 32.591 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.828685265834320
    last  calculated eigval = 0.030474814338226
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82868526583432
lambda[   2] =  -0.55082715745113
lambda[   3] =  -0.44206878345606
lambda[   4] =  -0.32573246377089
lambda[   5] =  -0.31590652029678
lambda[   6] =  -0.19100967669983
lambda[   7] =  -0.06613606991673
lambda[   8] =  -0.03147869740284
lambda[   9] =   0.01449757890458
lambda[  10] =   0.01755013421837
lambda[  11] =   0.03047481433823
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 2.878 ms
rank =  0, Distributing orbital back into band + domain format took 7.504 ms
rank = 0, Subspace_Rotation used 10.394 ms

Total time for subspace rotation: 10.402 ms
rank = 0, Efermi =  -0.191009676659 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.552 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.673 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.586 ms
rank = 0, Calculating density took 833.065 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.817 ms
rank = 0, D2D took 1.919 ms
rank = 0, Transfering density took 1.925 ms
Etot    =   -17.488900165425
Eband   =    -5.117450059523
E1      =    12.070082190593
E2      =    -4.722157533263
E3      =    -6.420480723916
Exc     =    -5.752587357752
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 2.106e-05, dEband = 6.806e-03
rank = 0, Calculating/Estimating energy took 0.914 ms, Etot = -17.488900165, dEtot = 2.106e-05, dEband = 6.806e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1863969919604, which took 0.053 ms

iter_count = 108, r_2norm = 6.893e-06, tol*||rhs|| = 7.456e-06

Anderson update took 62.668 ms, out of which F'*F took 26.852 ms; b-Ax took 200.131 ms, out of which Lap took 178.729 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 414.878 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630753, int_b + int_rho = -1.328e-13, checking this took 0.091 ms
2-norm of RHS = 479.9241610162185, which took 0.171 ms

iter_count = 240, r_2norm = 3.900e-04, tol*||rhs|| = 4.799e-04

Anderson update took 129.795 ms, out of which F'*F took 60.194 ms; b-Ax took 404.569 ms, out of which Lap took 363.874 ms
Solving Poisson took 862.460 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.081233 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.377 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.083544 
Total time for convolution: 	 convolve: 5.087258 
Total time for convolution: 	 convolve: 5.086328 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.725 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.543 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.594 ms
---Transfer Veff_loc: D2D took 3.530 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.058 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.625 ms

This SCF took 26501.393 ms, scf error = 2.037e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.130475, lowerbound = -0.828685, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 774.501 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.462 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.707 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.184 ms
rank =  0, finding HY took 13.421 ms
rank =  0, distributing HY into block cyclic form took 7.435 ms
rank =  0, finding Y'*HY took 2.362 ms
Rank 0, Project_Hamiltonian used 32.438 ms
Total time for projection: 32.451 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.826123079851695
    last  calculated eigval = 0.030523795076915
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82612307985170
lambda[   2] =  -0.54892431351263
lambda[   3] =  -0.44012996985570
lambda[   4] =  -0.32294775627205
lambda[   5] =  -0.31356690774376
lambda[   6] =  -0.18872067945861
lambda[   7] =  -0.06402354261195
lambda[   8] =  -0.02972961124419
lambda[   9] =   0.01575733547380
lambda[  10] =   0.01767724998846
lambda[  11] =   0.03052379507692
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 2.889 ms
rank =  0, Distributing orbital back into band + domain format took 7.507 ms
rank = 0, Subspace_Rotation used 10.408 ms

Total time for subspace rotation: 10.416 ms
rank = 0, Efermi =  -0.188720679417 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.526 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.752 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.562 ms
rank = 0, Calculating density took 832.932 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.800 ms
rank = 0, D2D took 1.902 ms
rank = 0, Transfering density took 1.907 ms
Etot    =   -17.488966892267
Eband   =    -5.092104735122
E1      =    12.055206847822
E2      =    -4.710679382889
E3      =    -6.424692878863
Exc     =    -5.755858070796
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 1.668e-05, dEband = 6.336e-03
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -17.488966892, dEtot = 1.668e-05, dEband = 6.336e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1236249805264, which took 0.051 ms

iter_count = 108, r_2norm = 4.612e-06, tol*||rhs|| = 4.945e-06

Anderson update took 57.844 ms, out of which F'*F took 27.316 ms; b-Ax took 183.365 ms, out of which Lap took 164.449 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.340 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630752, int_b + int_rho = -1.473e-13, checking this took 0.135 ms
2-norm of RHS = 479.9309692006899, which took 0.136 ms

iter_count = 210, r_2norm = 4.092e-04, tol*||rhs|| = 4.799e-04

Anderson update took 112.068 ms, out of which F'*F took 52.475 ms; b-Ax took 352.977 ms, out of which Lap took 316.412 ms
Solving Poisson took 755.927 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
Total time for convolution: 	 convolve: 5.091264 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.081275 
Total time for convolution: 	 convolve: 5.083160 
Total time for convolution: 	 convolve: 5.077537 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.704 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.027 ms
---Transfer Veff_loc: D2D took 3.537 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.013 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.583 ms

This SCF took 26604.099 ms, scf error = 1.165e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.130524, lowerbound = -0.826123, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 774.011 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.514 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.759 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.289 ms
rank =  0, finding HY took 13.326 ms
rank =  0, distributing HY into block cyclic form took 7.405 ms
rank =  0, finding Y'*HY took 2.364 ms
Rank 0, Project_Hamiltonian used 32.408 ms
Total time for projection: 32.420 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.825963567157861
    last  calculated eigval = 0.030205984930134
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82596356715786
lambda[   2] =  -0.54859331911146
lambda[   3] =  -0.43976534693561
lambda[   4] =  -0.32280207039549
lambda[   5] =  -0.31327602551447
lambda[   6] =  -0.18848855453699
lambda[   7] =  -0.06358993828610
lambda[   8] =  -0.02820037461748
lambda[   9] =   0.01634366131803
lambda[  10] =   0.01870037070229
lambda[  11] =   0.03020598493013
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 2.479 ms
rank =  0, Distributing orbital back into band + domain format took 7.969 ms
rank = 0, Subspace_Rotation used 10.461 ms

Total time for subspace rotation: 10.468 ms
rank = 0, Efermi =  -0.188488554496 calculate fermi energy took 0.069 ms
rank = 0, --- Calculate rho: sum over local bands took 2.604 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.615 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.556 ms
rank = 0, Calculating density took 832.026 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.807 ms
rank = 0, D2D took 1.904 ms
rank = 0, Transfering density took 1.906 ms
Etot    =   -17.489036713795
Eband   =    -5.089289213956
E1      =    12.054989891276
E2      =    -4.708162915541
E3      =    -6.424135782370
Exc     =    -5.755452893103
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 1.746e-05, dEband = 7.039e-04
rank = 0, Calculating/Estimating energy took 0.928 ms, Etot = -17.489036714, dEtot = 1.746e-05, dEband = 7.039e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0926655944425, which took 0.057 ms

iter_count = 108, r_2norm = 3.133e-06, tol*||rhs|| = 3.707e-06

Anderson update took 57.489 ms, out of which F'*F took 27.001 ms; b-Ax took 183.869 ms, out of which Lap took 163.913 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.235 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630753, int_b + int_rho = -1.419e-13, checking this took 0.117 ms
2-norm of RHS = 479.9492901516745, which took 0.104 ms

iter_count = 204, r_2norm = 4.481e-04, tol*||rhs|| = 4.799e-04

Anderson update took 109.164 ms, out of which F'*F took 51.964 ms; b-Ax took 345.847 ms, out of which Lap took 310.879 ms
Solving Poisson took 735.408 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.096964 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.328 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.080676 
Total time for convolution: 	 convolve: 5.082856 
Total time for convolution: 	 convolve: 5.086216 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.523 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.869 ms
---Transfer Veff_loc: D2D took 3.533 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.059 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.627 ms

This SCF took 26322.959 ms, scf error = 7.921e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.130206, lowerbound = -0.825964, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 775.015 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.486 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.777 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.278 ms
rank =  0, finding HY took 13.395 ms
rank =  0, distributing HY into block cyclic form took 7.458 ms
rank =  0, finding Y'*HY took 2.333 ms
Rank 0, Project_Hamiltonian used 32.496 ms
Total time for projection: 32.510 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.644 ms
rank = 0, Solve_Generalized_EigenProblem used 1.150 ms
    first calculated eigval = -0.825224637228157
    last  calculated eigval = 0.031140518590748
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82522463722816
lambda[   2] =  -0.54785636061219
lambda[   3] =  -0.43900887837023
lambda[   4] =  -0.32215282976365
lambda[   5] =  -0.31254097069521
lambda[   6] =  -0.18777494986923
lambda[   7] =  -0.06273977674962
lambda[   8] =  -0.02543844272134
lambda[   9] =   0.01813028518511
lambda[  10] =   0.02125660513518
lambda[  11] =   0.03114051859075
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.170 ms
rank =  0, subspace rotation using ScaLAPACK took 2.527 ms
rank =  0, Distributing orbital back into band + domain format took 7.719 ms
rank = 0, Subspace_Rotation used 10.259 ms

Total time for subspace rotation: 10.267 ms
rank = 0, Efermi =  -0.187774949828 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 2.548 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.614 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.590 ms
rank = 0, Calculating density took 833.843 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.833 ms
rank = 0, D2D took 1.939 ms
rank = 0, Transfering density took 1.945 ms
Etot    =   -17.489091517318
Eband   =    -5.081342304393
E1      =    12.051351638799
E2      =    -4.703660453615
E3      =    -6.424890391051
Exc     =    -5.756068500467
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 1.370e-05, dEband = 1.987e-03
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -17.489091517, dEtot = 1.370e-05, dEband = 1.987e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0669319542988, which took 0.084 ms

iter_count = 108, r_2norm = 1.914e-06, tol*||rhs|| = 2.677e-06

Anderson update took 57.425 ms, out of which F'*F took 27.092 ms; b-Ax took 187.200 ms, out of which Lap took 167.885 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.902 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630749, int_b + int_rho = -1.783e-13, checking this took 0.113 ms
2-norm of RHS = 479.9558501245378, which took 0.147 ms

iter_count = 192, r_2norm = 4.477e-04, tol*||rhs|| = 4.800e-04

Anderson update took 102.061 ms, out of which F'*F took 47.856 ms; b-Ax took 323.071 ms, out of which Lap took 289.589 ms
Solving Poisson took 688.833 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.099474 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.101190 
Total time for convolution: 	 convolve: 5.110959 
Total time for convolution: 	 convolve: 5.082511 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.870 ms
---Transfer Veff_loc: D2D took 3.536 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.032 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.603 ms

This SCF took 26340.139 ms, scf error = 6.034e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.131141, lowerbound = -0.825225, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 774.004 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.453 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.734 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.202 ms
rank =  0, finding HY took 13.435 ms
rank =  0, distributing HY into block cyclic form took 7.552 ms
rank =  0, finding Y'*HY took 2.305 ms
Rank 0, Project_Hamiltonian used 32.934 ms
Total time for projection: 32.946 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.624 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.730 ms
    first calculated eigval = -0.824437465985690
    last  calculated eigval = 0.032694571485760
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82443746598569
lambda[   2] =  -0.54717075292798
lambda[   3] =  -0.43831916369552
lambda[   4] =  -0.32140394981263
lambda[   5] =  -0.31180908902401
lambda[   6] =  -0.18705489191561
lambda[   7] =  -0.06189710322850
lambda[   8] =  -0.02217168867857
lambda[   9] =   0.01995025790340
lambda[  10] =   0.02433245805165
lambda[  11] =   0.03269457148576
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.750 ms
rank =  0, subspace rotation using ScaLAPACK took 2.589 ms
rank =  0, Distributing orbital back into band + domain format took 7.580 ms
rank = 0, Subspace_Rotation used 10.182 ms

Total time for subspace rotation: 10.189 ms
rank = 0, Efermi =  -0.187054891875 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 2.539 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.659 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.555 ms
rank = 0, Calculating density took 832.774 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.808 ms
rank = 0, D2D took 1.911 ms
rank = 0, Transfering density took 1.917 ms
Etot    =   -17.489111674912
Eband   =    -5.073335735983
E1      =    12.047075325722
E2      =    -4.699679884474
E3      =    -6.426039432659
Exc     =    -5.756987385860
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 5.039e-06, dEband = 2.002e-03
rank = 0, Calculating/Estimating energy took 0.916 ms, Etot = -17.489111675, dEtot = 5.039e-06, dEband = 2.002e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0462460307202, which took 0.058 ms

iter_count = 108, r_2norm = 1.740e-06, tol*||rhs|| = 1.850e-06

Anderson update took 57.373 ms, out of which F'*F took 27.862 ms; b-Ax took 184.152 ms, out of which Lap took 164.560 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.084 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630750, int_b + int_rho = -1.637e-13, checking this took 0.093 ms
2-norm of RHS = 479.9558952977820, which took 0.158 ms

iter_count = 168, r_2norm = 4.157e-04, tol*||rhs|| = 4.800e-04

Anderson update took 89.889 ms, out of which F'*F took 41.878 ms; b-Ax took 283.573 ms, out of which Lap took 254.240 ms
Solving Poisson took 604.552 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.084587 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.640 ms
Total time for convolution: 	 convolve: 5.081334 
Total time for convolution: 	 convolve: 5.085429 
Total time for convolution: 	 convolve: 5.079268 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.509 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.060 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.603 ms

This SCF took 26188.179 ms, scf error = 3.778e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132695, lowerbound = -0.824437, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 773.043 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.408 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.735 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.070 ms
rank =  0, finding HY took 13.328 ms
rank =  0, distributing HY into block cyclic form took 7.364 ms
rank =  0, finding Y'*HY took 2.399 ms
Rank 0, Project_Hamiltonian used 33.195 ms
Total time for projection: 33.223 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.824133153624715
    last  calculated eigval = 0.032858706513553
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82413315362471
lambda[   2] =  -0.54690201339126
lambda[   3] =  -0.43805397056171
lambda[   4] =  -0.32107945392140
lambda[   5] =  -0.31152104378295
lambda[   6] =  -0.18676089094496
lambda[   7] =  -0.06163429618505
lambda[   8] =  -0.02096841461030
lambda[   9] =   0.02034351982329
lambda[  10] =   0.02504568323256
lambda[  11] =   0.03285870651355
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 2.583 ms
rank =  0, Distributing orbital back into band + domain format took 7.560 ms
rank = 0, Subspace_Rotation used 10.157 ms

Total time for subspace rotation: 10.163 ms
rank = 0, Efermi =  -0.186760890904 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.497 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.712 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.555 ms
rank = 0, Calculating density took 831.529 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.809 ms
rank = 0, D2D took 1.911 ms
rank = 0, Transfering density took 1.917 ms
Etot    =   -17.489150671489
Eband   =    -5.070140162682
E1      =    12.045407330856
E2      =    -4.698048949763
E3      =    -6.426379430571
Exc     =    -5.757263024074
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 9.749e-06, dEband = 7.989e-04
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -17.489150671, dEtot = 9.749e-06, dEband = 7.989e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0371449265109, which took 0.063 ms

iter_count = 108, r_2norm = 1.331e-06, tol*||rhs|| = 1.486e-06

Anderson update took 58.006 ms, out of which F'*F took 27.188 ms; b-Ax took 184.207 ms, out of which Lap took 164.856 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.600 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630750, int_b + int_rho = -1.692e-13, checking this took 0.100 ms
2-norm of RHS = 479.9623805434097, which took 0.154 ms

iter_count = 168, r_2norm = 4.529e-04, tol*||rhs|| = 4.800e-04

Anderson update took 88.655 ms, out of which F'*F took 41.839 ms; b-Ax took 286.221 ms, out of which Lap took 257.105 ms
Solving Poisson took 605.154 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.096243 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.093464 
Total time for convolution: 	 convolve: 5.095383 
Total time for convolution: 	 convolve: 5.084543 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
---Transfer Veff_loc: D2D took 3.535 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.190 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.760 ms

This SCF took 26336.160 ms, scf error = 2.783e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132859, lowerbound = -0.824133, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 774.906 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.167 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.668 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.854 ms
rank =  0, finding HY took 13.430 ms
rank =  0, distributing HY into block cyclic form took 7.287 ms
rank =  0, finding Y'*HY took 2.362 ms
Rank 0, Project_Hamiltonian used 33.415 ms
Total time for projection: 33.427 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.824140896975155
    last  calculated eigval = 0.033586790026941
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82414089697516
lambda[   2] =  -0.54682845381982
lambda[   3] =  -0.43797863390211
lambda[   4] =  -0.32107343079596
lambda[   5] =  -0.31149655924054
lambda[   6] =  -0.18673924741963
lambda[   7] =  -0.06171150670394
lambda[   8] =  -0.02001542672834
lambda[   9] =   0.01958092633967
lambda[  10] =   0.02551807557611
lambda[  11] =   0.03358679002694
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 2.603 ms
rank =  0, Distributing orbital back into band + domain format took 7.562 ms
rank = 0, Subspace_Rotation used 10.178 ms

Total time for subspace rotation: 10.184 ms
rank = 0, Efermi =  -0.186739247379 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 2.585 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.542 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 833.585 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.829 ms
rank = 0, D2D took 1.925 ms
rank = 0, Transfering density took 1.928 ms
Etot    =   -17.489191419882
Eband   =    -5.069775198064
E1      =    12.045626004586
E2      =    -4.697489964512
E3      =    -6.426100622268
Exc     =    -5.757049617262
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 1.019e-05, dEband = 9.124e-05
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -17.489191420, dEtot = 1.019e-05, dEband = 9.124e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0368439836317, which took 0.054 ms

iter_count = 108, r_2norm = 1.349e-06, tol*||rhs|| = 1.474e-06

Anderson update took 57.444 ms, out of which F'*F took 27.483 ms; b-Ax took 184.508 ms, out of which Lap took 164.748 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.341 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630752, int_b + int_rho = -1.455e-13, checking this took 0.113 ms
2-norm of RHS = 479.9591381834913, which took 0.134 ms

iter_count = 102, r_2norm = 4.407e-04, tol*||rhs|| = 4.800e-04

Anderson update took 54.063 ms, out of which F'*F took 25.443 ms; b-Ax took 171.510 ms, out of which Lap took 153.778 ms
Solving Poisson took 370.400 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.187 ms
Total time for convolution: 	 convolve: 5.085793 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.106467 
Total time for convolution: 	 convolve: 5.089150 
Total time for convolution: 	 convolve: 5.092368 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.479 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.994 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.504 ms

This SCF took 25992.532 ms, scf error = 3.293e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133587, lowerbound = -0.824141, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 773.814 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.431 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.736 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.181 ms
rank =  0, finding HY took 13.449 ms
rank =  0, distributing HY into block cyclic form took 7.561 ms
rank =  0, finding Y'*HY took 2.342 ms
Rank 0, Project_Hamiltonian used 32.564 ms
Total time for projection: 32.577 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.824019833143819
    last  calculated eigval = 0.033429680193751
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82401983314382
lambda[   2] =  -0.54675614269081
lambda[   3] =  -0.43790638145840
lambda[   4] =  -0.32096013837577
lambda[   5] =  -0.31139726901623
lambda[   6] =  -0.18663881995120
lambda[   7] =  -0.06160557448887
lambda[   8] =  -0.01982799390542
lambda[   9] =   0.01954361776577
lambda[  10] =   0.02551772638456
lambda[  11] =   0.03342968019375
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 2.602 ms
rank =  0, Distributing orbital back into band + domain format took 7.554 ms
rank = 0, Subspace_Rotation used 10.168 ms

Total time for subspace rotation: 10.175 ms
rank = 0, Efermi =  -0.186638819910 calculate fermi energy took 0.068 ms
rank = 0, --- Calculate rho: sum over local bands took 2.532 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.629 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.555 ms
rank = 0, Calculating density took 831.618 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.922 ms
rank = 0, D2D took 2.024 ms
rank = 0, Transfering density took 2.028 ms
Etot    =   -17.489187550807
Eband   =    -5.068718350497
E1      =    12.044896414421
E2      =    -4.697111912899
E3      =    -6.426349768670
Exc     =    -5.757244100377
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 9.673e-07, dEband = 2.642e-04
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -17.489187551, dEtot = 9.673e-07, dEband = 2.642e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0292285118793, which took 0.060 ms

iter_count = 108, r_2norm = 8.020e-07, tol*||rhs|| = 1.169e-06

Anderson update took 57.269 ms, out of which F'*F took 27.121 ms; b-Ax took 183.524 ms, out of which Lap took 164.367 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.668 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630751, int_b + int_rho = -1.546e-13, checking this took 0.105 ms
2-norm of RHS = 479.9649284008573, which took 0.133 ms

iter_count = 168, r_2norm = 4.362e-04, tol*||rhs|| = 4.800e-04

Anderson update took 90.338 ms, out of which F'*F took 41.594 ms; b-Ax took 281.308 ms, out of which Lap took 252.061 ms
Solving Poisson took 604.772 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.094738 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.114388 
Total time for convolution: 	 convolve: 5.098246 
Total time for convolution: 	 convolve: 5.080394 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 3.563 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.232 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.253 ms

This SCF took 26241.412 ms, scf error = 2.443e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.133430, lowerbound = -0.824020, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 772.944 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.515 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.739 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.268 ms
rank =  0, finding HY took 13.312 ms
rank =  0, distributing HY into block cyclic form took 7.497 ms
rank =  0, finding Y'*HY took 2.341 ms
Rank 0, Project_Hamiltonian used 32.442 ms
Total time for projection: 32.454 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.824098489296255
    last  calculated eigval = 0.035224463410364
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82409848929625
lambda[   2] =  -0.54676646074975
lambda[   3] =  -0.43790997220591
lambda[   4] =  -0.32103961108726
lambda[   5] =  -0.31143714444437
lambda[   6] =  -0.18668339582517
lambda[   7] =  -0.06167396227374
lambda[   8] =  -0.01873050829829
lambda[   9] =   0.01897004694518
lambda[  10] =   0.02580773699140
lambda[  11] =   0.03522446341036
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.212 ms
rank =  0, subspace rotation using ScaLAPACK took 2.574 ms
rank =  0, Distributing orbital back into band + domain format took 7.649 ms
rank = 0, Subspace_Rotation used 10.238 ms

Total time for subspace rotation: 10.245 ms
rank = 0, Efermi =  -0.186683395784 calculate fermi energy took 0.072 ms
rank = 0, --- Calculate rho: sum over local bands took 2.615 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.522 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.596 ms
rank = 0, Calculating density took 830.721 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.801 ms
rank = 0, D2D took 1.894 ms
rank = 0, Transfering density took 1.897 ms
Etot    =   -17.489209770629
Eband   =    -5.069186752570
E1      =    12.045602575004
E2      =    -4.696952356726
E3      =    -6.425900499661
Exc     =    -5.756895253528
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 5.555e-06, dEband = 1.171e-04
rank = 0, Calculating/Estimating energy took 0.914 ms, Etot = -17.489209771, dEtot = 5.555e-06, dEband = 1.171e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0280213266263, which took 0.054 ms

iter_count = 108, r_2norm = 8.142e-07, tol*||rhs|| = 1.121e-06

Anderson update took 58.091 ms, out of which F'*F took 27.048 ms; b-Ax took 183.516 ms, out of which Lap took 163.912 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.065 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630749, int_b + int_rho = -1.783e-13, checking this took 0.105 ms
2-norm of RHS = 479.9639671219946, which took 0.115 ms

iter_count = 90, r_2norm = 4.452e-04, tol*||rhs|| = 4.800e-04

Anderson update took 47.754 ms, out of which F'*F took 22.627 ms; b-Ax took 151.628 ms, out of which Lap took 136.182 ms
Solving Poisson took 325.836 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.084225 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.087005 
Total time for convolution: 	 convolve: 5.087450 
Total time for convolution: 	 convolve: 5.089355 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 4.292 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.177 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.506 ms

This SCF took 26019.451 ms, scf error = 3.808e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.135224, lowerbound = -0.824098, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 775.226 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.570 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.754 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.340 ms
rank =  0, finding HY took 13.337 ms
rank =  0, distributing HY into block cyclic form took 7.466 ms
rank =  0, finding Y'*HY took 2.360 ms
Rank 0, Project_Hamiltonian used 32.531 ms
Total time for projection: 32.543 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.824049610834773
    last  calculated eigval = 0.035051116012022
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82404961083477
lambda[   2] =  -0.54673181858653
lambda[   3] =  -0.43787420500559
lambda[   4] =  -0.32098958103335
lambda[   5] =  -0.31139500647304
lambda[   6] =  -0.18664162540417
lambda[   7] =  -0.06163085654004
lambda[   8] =  -0.01865617596305
lambda[   9] =   0.01877652413896
lambda[  10] =   0.02569792017232
lambda[  11] =   0.03505111601202
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 2.583 ms
rank =  0, Distributing orbital back into band + domain format took 7.587 ms
rank = 0, Subspace_Rotation used 10.183 ms

Total time for subspace rotation: 10.189 ms
rank = 0, Efermi =  -0.186641625363 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 2.553 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.209 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.459 ms
rank = 0, Calculating density took 833.529 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.965 ms
rank = 0, D2D took 2.059 ms
rank = 0, Transfering density took 2.063 ms
Etot    =   -17.489207408729
Eband   =    -5.068722070448
E1      =    12.045320888565
E2      =    -4.696748954199
E3      =    -6.426000111933
Exc     =    -5.756972097056
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 5.905e-07, dEband = 1.162e-04
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -17.489207409, dEtot = 5.905e-07, dEband = 1.162e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0278136278307, which took 0.056 ms

iter_count = 108, r_2norm = 8.308e-07, tol*||rhs|| = 1.113e-06

Anderson update took 58.135 ms, out of which F'*F took 27.134 ms; b-Ax took 183.471 ms, out of which Lap took 164.356 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.961 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630749, int_b + int_rho = -1.764e-13, checking this took 0.102 ms
2-norm of RHS = 479.9643582149549, which took 0.073 ms

iter_count = 84, r_2norm = 4.252e-04, tol*||rhs|| = 4.800e-04

Anderson update took 44.481 ms, out of which F'*F took 20.945 ms; b-Ax took 140.967 ms, out of which Lap took 126.195 ms
Solving Poisson took 303.877 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.093026 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.087029 
Total time for convolution: 	 convolve: 5.374545 
Total time for convolution: 	 convolve: 5.100508 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.825 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.012 ms
======D2D: initiated sending and receiving took 1.383 ms
---Transfer Veff_loc: D2D took 4.663 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.180 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.875 ms

This SCF took 26353.216 ms, scf error = 3.542e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.135051, lowerbound = -0.824050, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 776.187 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.390 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.825 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.230 ms
rank =  0, finding HY took 13.345 ms
rank =  0, distributing HY into block cyclic form took 7.481 ms
rank =  0, finding Y'*HY took 2.310 ms
Rank 0, Project_Hamiltonian used 32.397 ms
Total time for projection: 32.409 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.824067331292418
    last  calculated eigval = 0.034597067459291
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82406733129242
lambda[   2] =  -0.54674863582924
lambda[   3] =  -0.43789152802024
lambda[   4] =  -0.32101063005355
lambda[   5] =  -0.31141334038256
lambda[   6] =  -0.18665856328340
lambda[   7] =  -0.06165640898194
lambda[   8] =  -0.01885937462073
lambda[   9] =   0.01847677200904
lambda[  10] =   0.02532628537262
lambda[  11] =   0.03459706745929
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 2.577 ms
rank =  0, Distributing orbital back into band + domain format took 7.585 ms
rank = 0, Subspace_Rotation used 10.175 ms

Total time for subspace rotation: 10.182 ms
rank = 0, Efermi =  -0.186658563242 calculate fermi energy took 0.071 ms
rank = 0, --- Calculate rho: sum over local bands took 2.599 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.452 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.613 ms
rank = 0, Calculating density took 833.780 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.818 ms
rank = 0, D2D took 1.911 ms
rank = 0, Transfering density took 1.914 ms
Etot    =   -17.489208166531
Eband   =    -5.068921495617
E1      =    12.045411697667
E2      =    -4.696863446778
E3      =    -6.425967589605
Exc     =    -5.756946209041
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 1.895e-07, dEband = 4.986e-05
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -17.489208167, dEtot = 1.895e-07, dEband = 4.986e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0289392786777, which took 0.054 ms

iter_count = 108, r_2norm = 8.233e-07, tol*||rhs|| = 1.158e-06

Anderson update took 57.237 ms, out of which F'*F took 27.210 ms; b-Ax took 196.618 ms, out of which Lap took 177.298 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 409.804 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630750, int_b + int_rho = -1.655e-13, checking this took 0.104 ms
2-norm of RHS = 479.9644671490244, which took 0.125 ms

iter_count = 42, r_2norm = 4.112e-04, tol*||rhs|| = 4.800e-04

Anderson update took 22.326 ms, out of which F'*F took 10.545 ms; b-Ax took 70.917 ms, out of which Lap took 63.519 ms
Solving Poisson took 153.400 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.092954 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.089079 
Total time for convolution: 	 convolve: 5.089031 
Total time for convolution: 	 convolve: 5.085797 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.833 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.160 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.230 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.459 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.003 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.496 ms

This SCF took 25759.240 ms, scf error = 3.447e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.134597, lowerbound = -0.824067, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 774.620 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.400 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.796 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.211 ms
rank =  0, finding HY took 13.563 ms
rank =  0, distributing HY into block cyclic form took 7.418 ms
rank =  0, finding Y'*HY took 2.370 ms
Rank 0, Project_Hamiltonian used 32.595 ms
Total time for projection: 32.609 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.824082426681621
    last  calculated eigval = 0.034468708252452
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82408242668162
lambda[   2] =  -0.54675769696102
lambda[   3] =  -0.43790102225296
lambda[   4] =  -0.32102210726219
lambda[   5] =  -0.31142410450384
lambda[   6] =  -0.18666889473587
lambda[   7] =  -0.06166234154737
lambda[   8] =  -0.01878382217171
lambda[   9] =   0.01837750962669
lambda[  10] =   0.02522136133643
lambda[  11] =   0.03446870825245
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.218 ms
rank =  0, subspace rotation using ScaLAPACK took 2.600 ms
rank =  0, Distributing orbital back into band + domain format took 7.526 ms
rank = 0, Subspace_Rotation used 10.138 ms

Total time for subspace rotation: 10.144 ms
rank = 0, Efermi =  -0.186668894695 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 2.548 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.657 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.547 ms
rank = 0, Calculating density took 832.479 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.803 ms
rank = 0, D2D took 1.906 ms
rank = 0, Transfering density took 1.908 ms
Etot    =   -17.489210097651
Eband   =    -5.069043611236
E1      =    12.045507346234
E2      =    -4.696897282618
E3      =    -6.425930074604
Exc     =    -5.756917993949
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 4.828e-07, dEband = 3.053e-05
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -17.489210098, dEtot = 4.828e-07, dEband = 3.053e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0378800237843, which took 0.053 ms

iter_count = 102, r_2norm = 1.204e-06, tol*||rhs|| = 1.515e-06

Anderson update took 55.429 ms, out of which F'*F took 25.626 ms; b-Ax took 173.254 ms, out of which Lap took 155.416 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.990 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630751, int_b + int_rho = -1.546e-13, checking this took 0.117 ms
2-norm of RHS = 479.9618282758830, which took 0.141 ms

iter_count = 126, r_2norm = 4.601e-04, tol*||rhs|| = 4.800e-04

Anderson update took 66.205 ms, out of which F'*F took 31.287 ms; b-Ax took 213.328 ms, out of which Lap took 191.403 ms
Solving Poisson took 456.397 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.091118 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.091012 
Total time for convolution: 	 convolve: 5.086399 
Total time for convolution: 	 convolve: 5.085442 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.826 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.757 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.483 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.986 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.503 ms

This SCF took 26020.524 ms, scf error = 3.603e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.134469, lowerbound = -0.824082, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 769.929 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.356 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.757 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.130 ms
rank =  0, finding HY took 13.373 ms
rank =  0, distributing HY into block cyclic form took 7.568 ms
rank =  0, finding Y'*HY took 2.267 ms
Rank 0, Project_Hamiltonian used 32.380 ms
Total time for projection: 32.392 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.823945166179035
    last  calculated eigval = 0.034364530914062
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82394516617904
lambda[   2] =  -0.54663095610551
lambda[   3] =  -0.43777434655893
lambda[   4] =  -0.32093317385293
lambda[   5] =  -0.31131023919259
lambda[   6] =  -0.18657398814802
lambda[   7] =  -0.06156466792513
lambda[   8] =  -0.01849317407767
lambda[   9] =   0.01831638038208
lambda[  10] =   0.02543737381587
lambda[  11] =   0.03436453091406
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 2.583 ms
rank =  0, Distributing orbital back into band + domain format took 7.514 ms
rank = 0, Subspace_Rotation used 10.110 ms

Total time for subspace rotation: 10.116 ms
rank = 0, Efermi =  -0.186573988107 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 2.557 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.743 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.549 ms
rank = 0, Calculating density took 827.629 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.833 ms
rank = 0, D2D took 1.935 ms
rank = 0, Transfering density took 1.937 ms
Etot    =   -17.489209143935
Eband   =    -5.067761753103
E1      =    12.044643572706
E2      =    -4.696409635149
E3      =    -6.426232033140
Exc     =    -5.757149435905
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 2.384e-07, dEband = 3.205e-04
rank = 0, Calculating/Estimating energy took 1.791 ms, Etot = -17.489209144, dEtot = 2.384e-07, dEband = 3.205e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0330216608814, which took 0.053 ms

iter_count = 102, r_2norm = 1.006e-06, tol*||rhs|| = 1.321e-06

Anderson update took 54.031 ms, out of which F'*F took 25.597 ms; b-Ax took 174.661 ms, out of which Lap took 155.925 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.402 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630752, int_b + int_rho = -1.510e-13, checking this took 0.114 ms
2-norm of RHS = 479.9600838646097, which took 0.132 ms

iter_count = 132, r_2norm = 4.295e-04, tol*||rhs|| = 4.800e-04

Anderson update took 70.034 ms, out of which F'*F took 33.071 ms; b-Ax took 222.868 ms, out of which Lap took 199.845 ms
Solving Poisson took 475.108 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.102828 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.091732 
Total time for convolution: 	 convolve: 5.090139 
Total time for convolution: 	 convolve: 5.083562 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.102 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 3.502 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.010 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.547 ms

This SCF took 26047.684 ms, scf error = 2.955e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.134365, lowerbound = -0.823945, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 775.612 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.489 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.754 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.259 ms
rank =  0, finding HY took 13.342 ms
rank =  0, distributing HY into block cyclic form took 7.478 ms
rank =  0, finding Y'*HY took 2.320 ms
Rank 0, Project_Hamiltonian used 32.427 ms
Total time for projection: 32.440 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -0.823811106476431
    last  calculated eigval = 0.034597863759548
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82381110647643
lambda[   2] =  -0.54651888630253
lambda[   3] =  -0.43766334012040
lambda[   4] =  -0.32083078813642
lambda[   5] =  -0.31119598575114
lambda[   6] =  -0.18646725978351
lambda[   7] =  -0.06147017867568
lambda[   8] =  -0.01810715835215
lambda[   9] =   0.01834418449553
lambda[  10] =   0.02560911492609
lambda[  11] =   0.03459786375955
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.211 ms
rank =  0, subspace rotation using ScaLAPACK took 2.569 ms
rank =  0, Distributing orbital back into band + domain format took 7.593 ms
rank = 0, Subspace_Rotation used 10.176 ms

Total time for subspace rotation: 10.182 ms
rank = 0, Efermi =  -0.186467259742 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 2.528 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.652 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.597 ms
rank = 0, Calculating density took 833.348 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.822 ms
rank = 0, D2D took 1.925 ms
rank = 0, Transfering density took 1.927 ms
Etot    =   -17.489211625657
Eband   =    -5.066507474533
E1      =    12.043857506629
E2      =    -4.695884969319
E3      =    -6.426464786149
Exc     =    -5.757328217297
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 6.204e-07, dEband = 3.136e-04
rank = 0, Calculating/Estimating energy took 1.521 ms, Etot = -17.489211626, dEtot = 6.204e-07, dEband = 3.136e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0229644539837, which took 0.055 ms

iter_count = 102, r_2norm = 7.266e-07, tol*||rhs|| = 9.186e-07

Anderson update took 54.395 ms, out of which F'*F took 25.542 ms; b-Ax took 173.749 ms, out of which Lap took 155.608 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.448 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630754, int_b + int_rho = -1.219e-13, checking this took 0.104 ms
2-norm of RHS = 479.9578978260407, which took 0.097 ms

iter_count = 156, r_2norm = 3.865e-04, tol*||rhs|| = 4.800e-04

Anderson update took 83.120 ms, out of which F'*F took 38.581 ms; b-Ax took 261.440 ms, out of which Lap took 234.486 ms
Solving Poisson took 561.000 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.096579 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.111899 
Total time for convolution: 	 convolve: 5.088958 
Total time for convolution: 	 convolve: 5.082392 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.731 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.503 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.183 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.719 ms

This SCF took 26170.411 ms, scf error = 2.182e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.134598, lowerbound = -0.823811, upperbound = 267.566393

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 774.087 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.386 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.757 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.168 ms
rank =  0, finding HY took 13.334 ms
rank =  0, distributing HY into block cyclic form took 7.464 ms
rank =  0, finding Y'*HY took 2.347 ms
Rank 0, Project_Hamiltonian used 32.340 ms
Total time for projection: 32.352 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.823555716741670
    last  calculated eigval = 0.033732886833789
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.82355571674167
lambda[   2] =  -0.54631738258695
lambda[   3] =  -0.43746548847239
lambda[   4] =  -0.32061655902307
lambda[   5] =  -0.31097952254422
lambda[   6] =  -0.18625798347181
lambda[   7] =  -0.06134773440665
lambda[   8] =  -0.01970868094531
lambda[   9] =   0.01791790451920
lambda[  10] =   0.02389446436183
lambda[  11] =   0.03373288683379
==subpsace eigenproblem: bcast eigvals took 0.060 ms
Total time for solving subspace eigenvalue problem: 0.257 ms
rank =  0, subspace rotation using ScaLAPACK took 2.586 ms
rank =  0, Distributing orbital back into band + domain format took 7.567 ms
rank = 0, Subspace_Rotation used 10.166 ms

Total time for subspace rotation: 10.173 ms
rank = 0, Efermi =  -0.186257983431 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 2.548 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.650 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.601 ms
rank = 0, Calculating density took 831.807 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 2.765 ms
rank = 0, D2D took 2.863 ms
rank = 0, Transfering density took 2.866 ms
Etot    =   -17.489221824085
Eband   =    -5.064127323381
E1      =    12.042367502044
E2      =    -4.694881637917
E3      =    -6.426903502914
Exc     =    -5.757663947656
Esc     =   -29.827436478968
Entropy =    -0.004146716955
dE = 2.550e-06, dEband = 5.950e-04
rank = 0, Calculating/Estimating energy took 0.928 ms, Etot = -17.489221824, dEtot = 2.550e-06, dEband = 5.950e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0212999853409, which took 0.065 ms

iter_count = 102, r_2norm = 5.957e-07, tol*||rhs|| = 8.520e-07

Anderson update took 54.313 ms, out of which F'*F took 25.446 ms; b-Ax took 173.597 ms, out of which Lap took 154.870 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.362 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000000630767, int_rho =  11.00000000630751, int_b + int_rho = -1.601e-13, checking this took 0.112 ms
2-norm of RHS = 479.9595529322965, which took 0.128 ms

iter_count = 126, r_2norm = 4.539e-04, tol*||rhs|| = 4.800e-04

Anderson update took 66.620 ms, out of which F'*F took 31.601 ms; b-Ax took 212.568 ms, out of which Lap took 190.980 ms
Solving Poisson took 453.116 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.105556 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.109012 
Total time for convolution: 	 convolve: 5.090653 
Total time for convolution: 	 convolve: 5.088618 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.495 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.989 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.518 ms

This SCF took 26244.401 ms, scf error = 7.318e-05
The last 11 occupations of kpoints #1 are (Nelectron = 11):
lambda[   1] =  -0.82355571674167, occ[   1] =   2.00000000000000
lambda[   2] =  -0.54631738258695, occ[   2] =   2.00000000000000
lambda[   3] =  -0.43746548847239, occ[   3] =   2.00000000000000
lambda[   4] =  -0.32061655902307, occ[   4] =   2.00000000000000
lambda[   5] =  -0.31097952254422, occ[   5] =   2.00000000000000
lambda[   6] =  -0.18625798347181, occ[   6] =   1.00000000629771
lambda[   7] =  -0.06134773440665, occ[   7] =   0.00000000000000
lambda[   8] =  -0.01970868094531, occ[   8] =   0.00000000000000
lambda[   9] =   0.01791790451920, occ[   9] =   0.00000000000000
lambda[  10] =   0.02389446436183, occ[  10] =   0.00000000000000
lambda[  11] =   0.03373288683379, occ[  11] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 10 (90%) = 0.000000000000000.
Occupation of state 11 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.291 ms, time for Allreduce/Reduce: 4.525 ms 
Time for calculating local force components: 11.055 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000002888053  -0.04259278901557   0.02472502896567
  0.00000002433740   0.04259257373860   0.02472513746510
  0.00000115656552  -0.00000093295260   0.04096654061790
  0.00000523458188   0.00000442482835  -0.83697331098483
force_loc = 
 -0.00000064019986   0.04836712679563  -0.03114804124799
  0.00000079375109  -0.04837027631954  -0.03114734263081
 -0.00000039389126  -0.00000002476831  -0.02181809354760
  0.00000061526721  -0.00000008739933   0.80504188614242
Time for calculating nonlocal force components: 20.348 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000003830783  -0.00000005571948   0.00874713082897
[0m[32m  0.00000005578673  -0.00000022442575   0.01683655372590
[0mTime for calculating XC forces components: 13.806 ms
 Cartesian force = 
 -0.00000236383298   0.00577440408956  -0.00641188461600
 -0.00000087666410  -0.00577763627144  -0.00641107749939
 -0.00000097038616  -0.00000094713088   0.02790670556559
  0.00000421088323   0.00000417931277  -0.01508374345019
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.309 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.200 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Time for printing density: 400.796 ms
The program took 583.702 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:39
Job ID:        2266502
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:59:12,vmem=8452K,walltime=00:09:56,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-4-1
---------------------------------------
