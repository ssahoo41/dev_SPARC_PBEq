---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:25
Job ID:    2266821
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:30
Job ID:    2266821
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.078 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 6.787 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 9.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 54.136 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 81.168 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.950 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.101 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    7.603999	   13.870005	   10.000000	
   12.360625	   14.624527	   10.000000	
   12.808144	   11.713251	   11.662623	
   12.808144	   11.713251	    8.337377	
    7.191856	    5.375473	   10.000000	
   11.971871	   12.605695	   10.000000	
    9.152656	   12.174384	   10.000000	
    8.360846	    9.516535	   10.000000	
    7.763772	    7.303092	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.181 ms
Set up communicators.

--set up spincomm took 2.247 ms

--set up kptcomm took 0.347 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.007 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.041 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.470 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.451 ms

Calculate_SplineDerivRadFun took 0.212 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.266 ms.
time spent on vectorized spline interp: 3.128 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.007 ms.
time spent on vectorized spline interp: 1.302 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.298 ms.
time spent on vectorized spline interp: 1.630 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.294 ms.

Calculating rb for all atom types took 15.947 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.011 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.015 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000248817, sum_int_rho = 25.5834138506534
PosCharge = 26.000000024882, NegCharge = -25.583413850653, scal_fac = 1.016283447419
After scaling, int_rho = 26.0000000248817, PosCharge + NegCharge - NetCharge = 4.263e-14
--Calculate Vref took 0.578 ms
--Calculate rho_guess took 3.005 ms

 integral of b = -26.0000000248817,
 int{b} + Nelectron + NetCharge = -2.488e-08,
 Esc = -71.2319866916991,
 MPI_Reduce took 12.379 ms

Calculating b & b_ref took 23.123 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.012 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.025 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.021 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.729 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488159, int_b + int_rho = -5.821e-14, checking this took 0.090 ms
2-norm of RHS = 715.7547675052325, which took 0.482 ms

iter_count = 420, r_2norm = 6.684e-04, tol*||rhs|| = 7.158e-04

Anderson update took 251.617 ms, out of which F'*F took 110.599 ms; b-Ax took 742.416 ms, out of which Lap took 669.822 ms
Solving Poisson took 1559.179 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.396 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
Total time for convolution: 	 convolve: 5.125985 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 122.484 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
Total time for convolution: 	 convolve: 5.130259 
Total time for convolution: 	 convolve: 5.134899 
Total time for convolution: 	 convolve: 5.119136 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.675 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.512 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
rank = 0, XC calculation took 24496.508 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 2.182 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.121 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.377 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.131 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.656 ms
    Lanczos iter 53, eigmin  = -1.005199581, eigmax = 264.934235708, err_eigmin = 3.303e-03, err_eigmax = 9.602e-03
rank =   0, Lanczos took 120.125 ms, eigmin = -1.005199580694, eigmax = 267.583578065281

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.239189, lowerbound = -1.105200, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1767.367 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 18.930 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.014 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 22.972 ms
rank =  0, finding HY took 30.262 ms
rank =  0, distributing HY into block cyclic form took 18.973 ms
rank =  0, finding Y'*HY took 6.105 ms
Rank 0, Project_Hamiltonian used 78.350 ms
Total time for projection: 78.754 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.920 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 1.035 ms
    first calculated eigval = 2.694585163524631
    last  calculated eigval = 3.220273308973082
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.81076224586147
lambda[   5] =   2.85767565996097
lambda[   6] =   2.89412896222930
lambda[   7] =   2.90395548436487
lambda[   8] =   2.94148764699326
lambda[   9] =   2.96060278547295
lambda[  10] =   2.98190809435393
lambda[  11] =   2.99597829002205
lambda[  12] =   3.02769357231801
lambda[  13] =   3.05113352030464
lambda[  14] =   3.07731662580283
lambda[  15] =   3.10052335337997
lambda[  16] =   3.12846835196964
lambda[  17] =   3.14011688347055
lambda[  18] =   3.15285583036185
lambda[  19] =   3.17565323307831
lambda[  20] =   3.22027330897308
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.052 ms
rank =  0, subspace rotation using ScaLAPACK took 5.419 ms
rank =  0, Distributing orbital back into band + domain format took 17.564 ms
rank = 0, Subspace_Rotation used 22.998 ms

Total time for subspace rotation: 23.003 ms
rank = 0, Efermi =   3.064225074988 calculate fermi energy took 0.064 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.320273, lowerbound = -1.105200, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1739.268 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.759 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.147 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 21.935 ms
rank =  0, finding HY took 29.841 ms
rank =  0, distributing HY into block cyclic form took 17.705 ms
rank =  0, finding Y'*HY took 5.703 ms
Rank 0, Project_Hamiltonian used 75.212 ms
Total time for projection: 75.225 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.887181291565737
    last  calculated eigval = 0.439836203413888
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.39116197153802
lambda[   5] =  -0.21450077411131
lambda[   6] =  -0.16655511263358
lambda[   7] =  -0.13840637450261
lambda[   8] =  -0.04033560099378
lambda[   9] =   0.01288304964218
lambda[  10] =   0.11621003596540
lambda[  11] =   0.15896974761333
lambda[  12] =   0.20708035194143
lambda[  13] =   0.24809330902534
lambda[  14] =   0.29750136740683
lambda[  15] =   0.32165221133777
lambda[  16] =   0.32819940430058
lambda[  17] =   0.34303438590791
lambda[  18] =   0.38488102716502
lambda[  19] =   0.41827347616086
lambda[  20] =   0.43983620341389
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 5.424 ms
rank =  0, Distributing orbital back into band + domain format took 17.470 ms
rank = 0, Subspace_Rotation used 22.907 ms

Total time for subspace rotation: 22.912 ms
rank = 0, Efermi =   0.272803870305 calculate fermi energy took 0.030 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.539836, lowerbound = -1.105200, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1744.908 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.247 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.092 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.018 ms
rank =  0, Distribute data + matrix mult took 22.337 ms
rank =  0, finding HY took 29.805 ms
rank =  0, distributing HY into block cyclic form took 17.795 ms
rank =  0, finding Y'*HY took 5.702 ms
Rank 0, Project_Hamiltonian used 75.668 ms
Total time for projection: 75.672 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -1.041949592894204
    last  calculated eigval = 0.145298390283471
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.65747005326071
lambda[   5] =  -0.57519038646532
lambda[   6] =  -0.53576096157543
lambda[   7] =  -0.50886736686173
lambda[   8] =  -0.49639322663938
lambda[   9] =  -0.45695263942699
lambda[  10] =  -0.40051980919123
lambda[  11] =  -0.34525514522450
lambda[  12] =  -0.33491184689204
lambda[  13] =  -0.27350943722061
lambda[  14] =  -0.07184622138755
lambda[  15] =   0.00564248543848
lambda[  16] =   0.06139934909726
lambda[  17] =   0.08793288558939
lambda[  18] =   0.09246792222303
lambda[  19] =   0.11619657976606
lambda[  20] =   0.14529839028347
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.194 ms
rank =  0, subspace rotation using ScaLAPACK took 5.477 ms
rank =  0, Distributing orbital back into band + domain format took 17.389 ms
rank = 0, Subspace_Rotation used 22.881 ms

Total time for subspace rotation: 22.886 ms
rank = 0, Efermi =  -0.100815579236 calculate fermi energy took 0.029 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.245298, lowerbound = -1.105200, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1745.917 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.000 ms
rank =  0, Distribute orbital to block cyclic format took 18.115 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.005 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.145 ms
rank =  0, finding HY took 29.801 ms
rank =  0, distributing HY into block cyclic form took 17.709 ms
rank =  0, finding Y'*HY took 5.733 ms
Rank 0, Project_Hamiltonian used 75.412 ms
Total time for projection: 75.417 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -1.042103419999300
    last  calculated eigval = 0.076448245187494
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.65874771704840
lambda[   5] =  -0.58064469342437
lambda[   6] =  -0.53870381848117
lambda[   7] =  -0.51320008511838
lambda[   8] =  -0.50153605449285
lambda[   9] =  -0.46912541763690
lambda[  10] =  -0.41034213528932
lambda[  11] =  -0.36435856105483
lambda[  12] =  -0.35856674061407
lambda[  13] =  -0.31086071410898
lambda[  14] =  -0.14397332372053
lambda[  15] =  -0.06701897156431
lambda[  16] =  -0.00596693479382
lambda[  17] =   0.01740421949336
lambda[  18] =   0.04080275893726
lambda[  19] =   0.05655989199588
lambda[  20] =   0.07644824518749
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 5.398 ms
rank =  0, Distributing orbital back into band + domain format took 17.591 ms
rank = 0, Subspace_Rotation used 23.004 ms

Total time for subspace rotation: 24.026 ms
rank = 0, Efermi =  -0.172942681494 calculate fermi energy took 0.027 ms
rank = 0, --- Calculate rho: sum over local bands took 4.200 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.347 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.263 ms
rank = 0, Calculating density took 7526.377 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.669 ms
rank = 0, D2D took 1.904 ms
rank = 0, Transfering density took 1.917 ms
Etot    =   -43.087136674524
Eband   =   -14.810988986388
E1      =    29.748417918198
E2      =   -11.753682992432
E3      =   -14.927220202501
Exc     =   -13.473482108824
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 4.787e+00, dEband = 1.646e+00
rank = 0, Calculating/Estimating energy took 1.359 ms, Etot = -43.087136675, dEtot = 4.787e+00, dEband = 1.646e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 56.4309904106038, which took 0.126 ms

iter_count = 96, r_2norm = 1.667e-03, tol*||rhs|| = 2.257e-03

Anderson update took 51.534 ms, out of which F'*F took 24.197 ms; b-Ax took 162.443 ms, out of which Lap took 146.194 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.424 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488163, int_b + int_rho = -2.547e-14, checking this took 0.111 ms
2-norm of RHS = 711.4577696726285, which took 0.162 ms

iter_count = 288, r_2norm = 5.640e-04, tol*||rhs|| = 7.115e-04

Anderson update took 154.353 ms, out of which F'*F took 71.915 ms; b-Ax took 486.953 ms, out of which Lap took 437.018 ms
Solving Poisson took 1031.928 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.770 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.113703 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.117140 
Total time for convolution: 	 convolve: 5.095653 
Total time for convolution: 	 convolve: 5.084724 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.140 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 1.229 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.323 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.572 ms

This SCF took 33307.055 ms, scf error = 1.818e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.176448, lowerbound = -1.042103, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1738.072 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.692 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.153 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.872 ms
rank =  0, finding HY took 30.173 ms
rank =  0, distributing HY into block cyclic form took 17.522 ms
rank =  0, finding Y'*HY took 6.044 ms
Rank 0, Project_Hamiltonian used 75.639 ms
Total time for projection: 75.652 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -1.021992970876083
    last  calculated eigval = 0.053503725892694
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.64002324651065
lambda[   5] =  -0.55048867581317
lambda[   6] =  -0.51013227214963
lambda[   7] =  -0.48097976300930
lambda[   8] =  -0.47020745289887
lambda[   9] =  -0.43996651640277
lambda[  10] =  -0.39223083496668
lambda[  11] =  -0.33244603712746
lambda[  12] =  -0.32953624562492
lambda[  13] =  -0.28402448051592
lambda[  14] =  -0.13992585049941
lambda[  15] =  -0.06087651967963
lambda[  16] =  -0.02265758171107
lambda[  17] =  -0.00085172424722
lambda[  18] =   0.01562372083639
lambda[  19] =   0.03869449387204
lambda[  20] =   0.05350372589269
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 5.976 ms
rank =  0, Distributing orbital back into band + domain format took 18.449 ms
rank = 0, Subspace_Rotation used 24.441 ms

Total time for subspace rotation: 24.446 ms
rank = 0, Efermi =  -0.168895208319 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 4.081 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.881 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.149 ms
rank = 0, Calculating density took 1849.030 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.613 ms
rank = 0, D2D took 0.770 ms
rank = 0, Transfering density took 0.775 ms
Etot    =   -42.998230387736
Eband   =   -14.047816062478
E1      =    29.086234599798
E2      =   -11.703858762175
E3      =   -15.127778656865
Exc     =   -13.636299651654
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 9.878e-03, dEband = 8.480e-02
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -42.998230388, dEtot = 9.878e-03, dEband = 8.480e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 24.7827364939617, which took 0.065 ms

iter_count = 102, r_2norm = 6.852e-04, tol*||rhs|| = 9.913e-04

Anderson update took 54.387 ms, out of which F'*F took 25.793 ms; b-Ax took 172.925 ms, out of which Lap took 155.205 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.693 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488174, int_b + int_rho = 9.095e-14, checking this took 0.128 ms
2-norm of RHS = 706.4786884655896, which took 0.155 ms

iter_count = 300, r_2norm = 6.072e-04, tol*||rhs|| = 7.065e-04

Anderson update took 159.874 ms, out of which F'*F took 74.354 ms; b-Ax took 506.919 ms, out of which Lap took 452.628 ms
Solving Poisson took 1073.094 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.092365 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.262 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.085033 
Total time for convolution: 	 convolve: 5.085951 
Total time for convolution: 	 convolve: 5.087334 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.254 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.418 ms
---Transfer Veff_loc: D2D took 1.293 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.317 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.632 ms

This SCF took 27671.799 ms, scf error = 1.216e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.153504, lowerbound = -1.021993, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1744.437 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.090 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.360 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 22.470 ms
rank =  0, finding HY took 30.469 ms
rank =  0, distributing HY into block cyclic form took 18.772 ms
rank =  0, finding Y'*HY took 5.887 ms
Rank 0, Project_Hamiltonian used 77.629 ms
Total time for projection: 77.645 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.992581724197360
    last  calculated eigval = 0.046249227816136
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.59974045092298
lambda[   5] =  -0.50306358391811
lambda[   6] =  -0.46405180035394
lambda[   7] =  -0.43578404671370
lambda[   8] =  -0.42529986066386
lambda[   9] =  -0.39199161598729
lambda[  10] =  -0.36120940107156
lambda[  11] =  -0.28614865040626
lambda[  12] =  -0.28369206119505
lambda[  13] =  -0.24633252553297
lambda[  14] =  -0.11707200464676
lambda[  15] =  -0.03107426992428
lambda[  16] =  -0.02757131455341
lambda[  17] =   0.00900914938640
lambda[  18] =   0.01712819382378
lambda[  19] =   0.03524060199134
lambda[  20] =   0.04624922781614
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 6.972 ms
rank =  0, Distributing orbital back into band + domain format took 17.888 ms
rank = 0, Subspace_Rotation used 24.874 ms

Total time for subspace rotation: 24.881 ms
rank = 0, Efermi =  -0.146041362503 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.560 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.319 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.180 ms
rank = 0, Calculating density took 1856.194 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.632 ms
rank = 0, D2D took 0.775 ms
rank = 0, Transfering density took 0.782 ms
Etot    =   -42.936706477221
Eband   =   -12.871271102432
E1      =    28.094657738336
E2      =   -11.514636410939
E3      =   -15.471234941812
Exc     =   -13.913977773434
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 6.836e-03, dEband = 1.307e-01
rank = 0, Calculating/Estimating energy took 0.911 ms, Etot = -42.936706477, dEtot = 6.836e-03, dEband = 1.307e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.4882211652174, which took 0.121 ms

iter_count = 102, r_2norm = 2.572e-04, tol*||rhs|| = 2.995e-04

Anderson update took 54.610 ms, out of which F'*F took 25.775 ms; b-Ax took 172.567 ms, out of which Lap took 154.899 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.658 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488166, int_b + int_rho = 3.638e-15, checking this took 0.109 ms
2-norm of RHS = 706.4459379398361, which took 0.121 ms

iter_count = 276, r_2norm = 6.653e-04, tol*||rhs|| = 7.064e-04

Anderson update took 150.947 ms, out of which F'*F took 68.767 ms; b-Ax took 467.040 ms, out of which Lap took 417.239 ms
Solving Poisson took 992.827 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.087155 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.083378 
Total time for convolution: 	 convolve: 5.092235 
Total time for convolution: 	 convolve: 5.090111 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
---Transfer Veff_loc: D2D took 1.290 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.296 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.607 ms

This SCF took 27612.429 ms, scf error = 4.286e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.146249, lowerbound = -0.992582, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1711.969 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.663 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.173 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.861 ms
rank =  0, finding HY took 28.834 ms
rank =  0, distributing HY into block cyclic form took 17.601 ms
rank =  0, finding Y'*HY took 5.583 ms
Rank 0, Project_Hamiltonian used 73.907 ms
Total time for projection: 73.921 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.632 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.698 ms
    first calculated eigval = -0.981181123629229
    last  calculated eigval = 0.039161218020097
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58386431395839
lambda[   5] =  -0.49052946373096
lambda[   6] =  -0.44870261925212
lambda[   7] =  -0.42201489799124
lambda[   8] =  -0.41208671652296
lambda[   9] =  -0.37655937350851
lambda[  10] =  -0.35000061509176
lambda[  11] =  -0.27676708091425
lambda[  12] =  -0.27266646914569
lambda[  13] =  -0.23681857416503
lambda[  14] =  -0.10738384097546
lambda[  15] =  -0.03107498246451
lambda[  16] =  -0.02123729038039
lambda[  17] =   0.00708157360297
lambda[  18] =   0.02288507486492
lambda[  19] =   0.03149576058886
lambda[  20] =   0.03916121802010
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.085 ms
rank =  0, subspace rotation using ScaLAPACK took 6.470 ms
rank =  0, Distributing orbital back into band + domain format took 18.090 ms
rank = 0, Subspace_Rotation used 24.573 ms

Total time for subspace rotation: 24.578 ms
rank = 0, Efermi =  -0.136353198804 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.313 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.844 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.416 ms
rank = 0, Calculating density took 1820.244 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.882 ms
rank = 0, D2D took 1.025 ms
rank = 0, Transfering density took 1.032 ms
Etot    =   -42.930692956809
Eband   =   -12.529666404684
E1      =    27.860359048275
E2      =   -11.390474608378
E3      =   -15.574323947897
Exc     =   -13.994197464234
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 6.682e-04, dEband = 3.796e-02
rank = 0, Calculating/Estimating energy took 0.983 ms, Etot = -42.930692957, dEtot = 6.682e-04, dEband = 3.796e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.6401910095465, which took 0.056 ms

iter_count = 102, r_2norm = 1.344e-04, tol*||rhs|| = 1.456e-04

Anderson update took 54.338 ms, out of which F'*F took 25.393 ms; b-Ax took 173.215 ms, out of which Lap took 154.017 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.955 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488161, int_b + int_rho = -4.366e-14, checking this took 0.134 ms
2-norm of RHS = 706.8814062348772, which took 0.148 ms

iter_count = 264, r_2norm = 5.985e-04, tol*||rhs|| = 7.069e-04

Anderson update took 141.769 ms, out of which F'*F took 65.620 ms; b-Ax took 446.606 ms, out of which Lap took 399.428 ms
Solving Poisson took 946.020 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.008 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.102704 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.863 ms
Total time for convolution: 	 convolve: 5.136565 
Total time for convolution: 	 convolve: 5.078906 
Total time for convolution: 	 convolve: 5.077656 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.166 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
---Transfer Veff_loc: D2D took 1.303 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.101 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.434 ms

This SCF took 27541.125 ms, scf error = 1.632e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.139161, lowerbound = -0.981181, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1701.362 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.637 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.101 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 21.768 ms
rank =  0, finding HY took 28.811 ms
rank =  0, distributing HY into block cyclic form took 17.716 ms
rank =  0, finding Y'*HY took 5.497 ms
Rank 0, Project_Hamiltonian used 73.828 ms
Total time for projection: 73.841 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -0.971877969247780
    last  calculated eigval = 0.034164523212926
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57750492971331
lambda[   5] =  -0.48467611245487
lambda[   6] =  -0.44074057456139
lambda[   7] =  -0.41502558883496
lambda[   8] =  -0.40344059095770
lambda[   9] =  -0.36810639975072
lambda[  10] =  -0.34255352499757
lambda[  11] =  -0.27294854317674
lambda[  12] =  -0.26887860018357
lambda[  13] =  -0.22835727917131
lambda[  14] =  -0.10146951473763
lambda[  15] =  -0.03108560505169
lambda[  16] =  -0.01816615270484
lambda[  17] =   0.00649521801487
lambda[  18] =   0.02451311078049
lambda[  19] =   0.02840447805103
lambda[  20] =   0.03416452321293
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 6.443 ms
rank =  0, Distributing orbital back into band + domain format took 18.028 ms
rank = 0, Subspace_Rotation used 24.484 ms

Total time for subspace rotation: 24.488 ms
rank = 0, Efermi =  -0.130438872531 calculate fermi energy took 2.388 ms
rank = 0, --- Calculate rho: sum over local bands took 4.545 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.217 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.383 ms
rank = 0, Calculating density took 1809.484 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.870 ms
rank = 0, D2D took 0.971 ms
rank = 0, Transfering density took 0.977 ms
Etot    =   -42.929141236707
Eband   =   -12.352039767842
E1      =    27.763271923791
E2      =   -11.298151679096
E3      =   -15.625054847303
Exc     =   -14.031593226613
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 1.724e-04, dEband = 1.974e-02
rank = 0, Calculating/Estimating energy took 0.914 ms, Etot = -42.929141237, dEtot = 1.724e-04, dEband = 1.974e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.4132945466030, which took 0.062 ms

iter_count = 108, r_2norm = 4.954e-05, tol*||rhs|| = 5.653e-05

Anderson update took 58.232 ms, out of which F'*F took 27.123 ms; b-Ax took 182.863 ms, out of which Lap took 164.217 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.714 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488164, int_b + int_rho = -1.091e-14, checking this took 0.107 ms
2-norm of RHS = 707.2349174373928, which took 0.100 ms

iter_count = 228, r_2norm = 6.489e-04, tol*||rhs|| = 7.072e-04

Anderson update took 122.056 ms, out of which F'*F took 57.047 ms; b-Ax took 386.597 ms, out of which Lap took 345.894 ms
Solving Poisson took 818.430 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.101 ms
Total time for convolution: 	 convolve: 5.086178 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.871 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.115482 
Total time for convolution: 	 convolve: 5.084691 
Total time for convolution: 	 convolve: 5.081113 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.591 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.157 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 1.464 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.700 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.197 ms

This SCF took 27401.922 ms, scf error = 6.583e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.134165, lowerbound = -0.971878, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1720.943 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.855 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.986 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.866 ms
rank =  0, finding HY took 28.788 ms
rank =  0, distributing HY into block cyclic form took 17.767 ms
rank =  0, finding Y'*HY took 5.427 ms
Rank 0, Project_Hamiltonian used 73.880 ms
Total time for projection: 73.895 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.970424261134822
    last  calculated eigval = 0.031272106151996
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57631161021600
lambda[   5] =  -0.48390347489645
lambda[   6] =  -0.43914441995319
lambda[   7] =  -0.41338925838261
lambda[   8] =  -0.40176633480999
lambda[   9] =  -0.36624638712620
lambda[  10] =  -0.34097441658589
lambda[  11] =  -0.27233057420878
lambda[  12] =  -0.26822694788872
lambda[  13] =  -0.22688390224477
lambda[  14] =  -0.10027571293579
lambda[  15] =  -0.03091964190093
lambda[  16] =  -0.01753500633242
lambda[  17] =   0.00609109362331
lambda[  18] =   0.02354386398559
lambda[  19] =   0.02664758435616
lambda[  20] =   0.03127210615200
==subpsace eigenproblem: bcast eigvals took 0.036 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 6.508 ms
rank =  0, Distributing orbital back into band + domain format took 18.033 ms
rank = 0, Subspace_Rotation used 24.555 ms

Total time for subspace rotation: 24.561 ms
rank = 0, Efermi =  -0.129245070700 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.415 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.357 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.313 ms
rank = 0, Calculating density took 1827.823 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.866 ms
rank = 0, D2D took 1.009 ms
rank = 0, Transfering density took 1.015 ms
Etot    =   -42.928898508121
Eband   =   -12.318962119317
E1      =    27.757540585609
E2      =   -11.268948938649
E3      =   -15.629397031808
Exc     =   -14.033836252428
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 2.697e-05, dEband = 3.675e-03
rank = 0, Calculating/Estimating energy took 0.935 ms, Etot = -42.928898508, dEtot = 2.697e-05, dEband = 3.675e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5907020975151, which took 0.056 ms

iter_count = 108, r_2norm = 2.237e-05, tol*||rhs|| = 2.363e-05

Anderson update took 56.952 ms, out of which F'*F took 27.615 ms; b-Ax took 201.960 ms, out of which Lap took 183.059 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 411.310 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488173, int_b + int_rho = 7.276e-14, checking this took 0.104 ms
2-norm of RHS = 707.6700293828048, which took 0.132 ms

iter_count = 246, r_2norm = 6.288e-04, tol*||rhs|| = 7.077e-04

Anderson update took 130.114 ms, out of which F'*F took 60.901 ms; b-Ax took 415.725 ms, out of which Lap took 370.341 ms
Solving Poisson took 883.501 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.080679 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.087200 
Total time for convolution: 	 convolve: 5.079233 
Total time for convolution: 	 convolve: 5.082996 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.777 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.588 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.179 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.012 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.261 ms
---Transfer Veff_loc: D2D took 2.465 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.707 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.200 ms

This SCF took 27448.579 ms, scf error = 4.385e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.131272, lowerbound = -0.970424, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1763.398 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.651 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.063 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.735 ms
rank =  0, finding HY took 28.982 ms
rank =  0, distributing HY into block cyclic form took 17.637 ms
rank =  0, finding Y'*HY took 5.524 ms
Rank 0, Project_Hamiltonian used 73.907 ms
Total time for projection: 73.920 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -0.967376484415225
    last  calculated eigval = 0.029953390355999
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57302347529359
lambda[   5] =  -0.48138274337327
lambda[   6] =  -0.43518323250915
lambda[   7] =  -0.40950946073955
lambda[   8] =  -0.39787507805959
lambda[   9] =  -0.36168036595726
lambda[  10] =  -0.33730911720169
lambda[  11] =  -0.26971550505690
lambda[  12] =  -0.26537577661188
lambda[  13] =  -0.22341293150423
lambda[  14] =  -0.09754741820495
lambda[  15] =  -0.02972129053961
lambda[  16] =  -0.01520061131387
lambda[  17] =   0.00650926445828
lambda[  18] =   0.02335457015627
lambda[  19] =   0.02732184235627
lambda[  20] =   0.02995339035600
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 6.423 ms
rank =  0, Distributing orbital back into band + domain format took 18.053 ms
rank = 0, Subspace_Rotation used 24.488 ms

Total time for subspace rotation: 24.493 ms
rank = 0, Efermi =  -0.126516776053 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.396 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.380 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.319 ms
rank = 0, Calculating density took 1870.230 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.860 ms
rank = 0, D2D took 1.004 ms
rank = 0, Transfering density took 1.010 ms
Etot    =   -42.928589319107
Eband   =   -12.228663302123
E1      =    27.719699392521
E2      =   -11.212076367690
E3      =   -15.643883740471
Exc     =   -14.043598825225
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 3.435e-05, dEband = 1.003e-02
rank = 0, Calculating/Estimating energy took 0.951 ms, Etot = -42.928589319, dEtot = 3.435e-05, dEband = 1.003e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3238141864588, which took 0.126 ms

iter_count = 114, r_2norm = 8.705e-06, tol*||rhs|| = 1.295e-05

Anderson update took 60.991 ms, out of which F'*F took 28.586 ms; b-Ax took 194.726 ms, out of which Lap took 173.798 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.627 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488170, int_b + int_rho = 4.366e-14, checking this took 0.072 ms
2-norm of RHS = 707.7452297043900, which took 0.114 ms

iter_count = 228, r_2norm = 6.412e-04, tol*||rhs|| = 7.077e-04

Anderson update took 119.878 ms, out of which F'*F took 56.381 ms; b-Ax took 385.304 ms, out of which Lap took 343.365 ms
Solving Poisson took 816.681 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.091625 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.714 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.091296 
Total time for convolution: 	 convolve: 5.098110 
Total time for convolution: 	 convolve: 5.086284 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.518 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.202 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 1.468 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.684 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.182 ms

This SCF took 27487.621 ms, scf error = 2.093e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.129953, lowerbound = -0.967376, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1764.172 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 17.615 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.976 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.615 ms
rank =  0, finding HY took 29.053 ms
rank =  0, distributing HY into block cyclic form took 27.709 ms
rank =  0, finding Y'*HY took 4.859 ms
Rank 0, Project_Hamiltonian used 83.266 ms
Total time for projection: 83.279 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.964826148903566
    last  calculated eigval = 0.030144780482869
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57079526279995
lambda[   5] =  -0.47983732189501
lambda[   6] =  -0.43266622212821
lambda[   7] =  -0.40718053875908
lambda[   8] =  -0.39529706693918
lambda[   9] =  -0.35914999727323
lambda[  10] =  -0.33497178352684
lambda[  11] =  -0.26775555318883
lambda[  12] =  -0.26335302947902
lambda[  13] =  -0.22089705942040
lambda[  14] =  -0.09546944382078
lambda[  15] =  -0.02828554399424
lambda[  16] =  -0.01345943550877
lambda[  17] =   0.00738905255751
lambda[  18] =   0.02350984473677
lambda[  19] =   0.02847050523209
lambda[  20] =   0.03014478048287
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 6.299 ms
rank =  0, Distributing orbital back into band + domain format took 18.128 ms
rank = 0, Subspace_Rotation used 24.440 ms

Total time for subspace rotation: 24.445 ms
rank = 0, Efermi =  -0.124438801724 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 4.277 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.467 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.346 ms
rank = 0, Calculating density took 1880.319 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.864 ms
rank = 0, D2D took 1.014 ms
rank = 0, Transfering density took 1.021 ms
Etot    =   -42.928546972748
Eband   =   -12.168947955488
E1      =    27.689807404769
E2      =   -11.180241275009
E3      =   -15.651116080881
Exc     =   -14.048777085476
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 4.705e-06, dEband = 6.635e-03
rank = 0, Calculating/Estimating energy took 1.345 ms, Etot = -42.928546973, dEtot = 4.705e-06, dEband = 6.635e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1597342561638, which took 0.123 ms

iter_count = 114, r_2norm = 4.917e-06, tol*||rhs|| = 6.389e-06

Anderson update took 61.113 ms, out of which F'*F took 28.462 ms; b-Ax took 194.222 ms, out of which Lap took 173.496 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.511 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488174, int_b + int_rho = 8.367e-14, checking this took 0.111 ms
2-norm of RHS = 707.7541848351690, which took 0.110 ms

iter_count = 216, r_2norm = 6.910e-04, tol*||rhs|| = 7.078e-04

Anderson update took 114.290 ms, out of which F'*F took 53.347 ms; b-Ax took 364.399 ms, out of which Lap took 324.719 ms
Solving Poisson took 774.121 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
Total time for convolution: 	 convolve: 5.086556 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.077504 
Total time for convolution: 	 convolve: 5.086152 
Total time for convolution: 	 convolve: 5.083622 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.524 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 1.454 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.689 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.171 ms

This SCF took 27406.536 ms, scf error = 1.270e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.130145, lowerbound = -0.964826, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1763.978 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.624 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.020 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.668 ms
rank =  0, finding HY took 28.997 ms
rank =  0, distributing HY into block cyclic form took 17.562 ms
rank =  0, finding Y'*HY took 5.472 ms
Rank 0, Project_Hamiltonian used 73.730 ms
Total time for projection: 73.744 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.962773471188307
    last  calculated eigval = 0.031279376573152
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56907769925354
lambda[   5] =  -0.47853357286905
lambda[   6] =  -0.43074168472255
lambda[   7] =  -0.40538190038930
lambda[   8] =  -0.39332352557952
lambda[   9] =  -0.35725801997277
lambda[  10] =  -0.33316246662898
lambda[  11] =  -0.26626120439774
lambda[  12] =  -0.26182546476294
lambda[  13] =  -0.21896041679988
lambda[  14] =  -0.09376637965902
lambda[  15] =  -0.02626530150053
lambda[  16] =  -0.01193820707331
lambda[  17] =   0.00918492971601
lambda[  18] =   0.02499167612089
lambda[  19] =   0.02998859107494
lambda[  20] =   0.03127937657315
==subpsace eigenproblem: bcast eigvals took 0.042 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 6.452 ms
rank =  0, Distributing orbital back into band + domain format took 18.092 ms
rank = 0, Subspace_Rotation used 24.557 ms

Total time for subspace rotation: 24.564 ms
rank = 0, Efermi =  -0.122735737572 calculate fermi energy took 0.095 ms
rank = 0, --- Calculate rho: sum over local bands took 4.364 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.440 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.255 ms
rank = 0, Calculating density took 1870.719 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.790 ms
rank = 0, D2D took 1.885 ms
rank = 0, Transfering density took 1.888 ms
Etot    =   -42.928543994322
Eband   =   -12.123061059485
E1      =    27.666336317054
E2      =   -11.156591525568
E3      =   -15.655942575312
Exc     =   -14.052366660329
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 3.309e-07, dEband = 5.099e-03
rank = 0, Calculating/Estimating energy took 0.892 ms, Etot = -42.928543994, dEtot = 3.309e-07, dEband = 5.099e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1402288894897, which took 0.057 ms

iter_count = 108, r_2norm = 4.634e-06, tol*||rhs|| = 5.609e-06

Anderson update took 57.486 ms, out of which F'*F took 27.164 ms; b-Ax took 184.646 ms, out of which Lap took 164.685 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.223 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488176, int_b + int_rho = 1.055e-13, checking this took 0.107 ms
2-norm of RHS = 707.7421199939146, which took 0.110 ms

iter_count = 210, r_2norm = 6.162e-04, tol*||rhs|| = 7.077e-04

Anderson update took 110.181 ms, out of which F'*F took 51.762 ms; b-Ax took 355.004 ms, out of which Lap took 316.283 ms
Solving Poisson took 752.647 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.091238 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.080236 
Total time for convolution: 	 convolve: 5.085920 
Total time for convolution: 	 convolve: 5.086074 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.558 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 1.442 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.664 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.135 ms

This SCF took 27350.889 ms, scf error = 7.960e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.131279, lowerbound = -0.962773, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1765.055 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.933 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.690 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.648 ms
rank =  0, finding HY took 28.967 ms
rank =  0, distributing HY into block cyclic form took 17.581 ms
rank =  0, finding Y'*HY took 5.533 ms
Rank 0, Project_Hamiltonian used 74.759 ms
Total time for projection: 74.773 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.961582753852936
    last  calculated eigval = 0.032874170005610
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56791337038464
lambda[   5] =  -0.47758911370566
lambda[   6] =  -0.42944776748636
lambda[   7] =  -0.40404967629339
lambda[   8] =  -0.39204674262803
lambda[   9] =  -0.35585924627383
lambda[  10] =  -0.33187268462543
lambda[  11] =  -0.26523784039596
lambda[  12] =  -0.26076964506011
lambda[  13] =  -0.21773300067563
lambda[  14] =  -0.09262188067034
lambda[  15] =  -0.02332674266418
lambda[  16] =  -0.01060384355211
lambda[  17] =   0.01290190368715
lambda[  18] =   0.02805194688816
lambda[  19] =   0.03178610796911
lambda[  20] =   0.03287417000561
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 6.439 ms
rank =  0, Distributing orbital back into band + domain format took 18.011 ms
rank = 0, Subspace_Rotation used 24.464 ms

Total time for subspace rotation: 24.470 ms
rank = 0, Efermi =  -0.121591238507 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 4.345 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.037 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.284 ms
rank = 0, Calculating density took 1872.751 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.843 ms
rank = 0, D2D took 1.000 ms
rank = 0, Transfering density took 1.008 ms
Etot    =   -42.928592187358
Eband   =   -12.091808519392
E1      =    27.651101222977
E2      =   -11.140219767340
E3      =   -15.657594970808
Exc     =   -14.053712936649
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 5.355e-06, dEband = 3.473e-03
rank = 0, Calculating/Estimating energy took 0.989 ms, Etot = -42.928592187, dEtot = 5.355e-06, dEband = 3.473e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0638810882681, which took 0.110 ms

iter_count = 114, r_2norm = 2.023e-06, tol*||rhs|| = 2.555e-06

Anderson update took 64.195 ms, out of which F'*F took 28.467 ms; b-Ax took 194.081 ms, out of which Lap took 173.057 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.562 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488169, int_b + int_rho = 3.638e-14, checking this took 0.103 ms
2-norm of RHS = 707.7398494519409, which took 0.119 ms

iter_count = 186, r_2norm = 5.969e-04, tol*||rhs|| = 7.077e-04

Anderson update took 98.232 ms, out of which F'*F took 46.040 ms; b-Ax took 314.301 ms, out of which Lap took 280.246 ms
Solving Poisson took 667.559 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 6.401012 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.098871 
Total time for convolution: 	 convolve: 5.085121 
Total time for convolution: 	 convolve: 5.082922 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.520 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
---Transfer Veff_loc: D2D took 1.477 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.710 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.218 ms

This SCF took 28675.838 ms, scf error = 4.733e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.132874, lowerbound = -0.961583, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1763.500 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.687 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.983 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.694 ms
rank =  0, finding HY took 28.945 ms
rank =  0, distributing HY into block cyclic form took 17.680 ms
rank =  0, finding Y'*HY took 5.472 ms
Rank 0, Project_Hamiltonian used 73.830 ms
Total time for projection: 73.844 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -0.960954441347854
    last  calculated eigval = 0.033834155390452
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56736718446447
lambda[   5] =  -0.47715371086728
lambda[   6] =  -0.42885049110954
lambda[   7] =  -0.40345181587187
lambda[   8] =  -0.39143846861916
lambda[   9] =  -0.35524000984380
lambda[  10] =  -0.33127268969215
lambda[  11] =  -0.26478085509848
lambda[  12] =  -0.26031509150650
lambda[  13] =  -0.21712601182254
lambda[  14] =  -0.09207737761495
lambda[  15] =  -0.02150046759084
lambda[  16] =  -0.00998526710227
lambda[  17] =   0.01527052873336
lambda[  18] =   0.02965290972894
lambda[  19] =   0.03232860928755
lambda[  20] =   0.03383415539045
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 6.430 ms
rank =  0, Distributing orbital back into band + domain format took 19.064 ms
rank = 0, Subspace_Rotation used 25.509 ms

Total time for subspace rotation: 25.515 ms
rank = 0, Efermi =  -0.121046735495 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.523 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.451 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.328 ms
rank = 0, Calculating density took 1871.492 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.749 ms
rank = 0, D2D took 0.840 ms
rank = 0, Transfering density took 0.843 ms
Etot    =   -42.928624327065
Eband   =   -12.077401193362
E1      =    27.643891838985
E2      =   -11.132742208669
E3      =   -15.658841968739
Exc     =   -14.054712457654
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 3.571e-06, dEband = 1.601e-03
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -42.928624327, dEtot = 3.571e-06, dEband = 1.601e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0549877305591, which took 0.054 ms

iter_count = 114, r_2norm = 1.429e-06, tol*||rhs|| = 2.200e-06

Anderson update took 60.971 ms, out of which F'*F took 28.676 ms; b-Ax took 194.526 ms, out of which Lap took 173.636 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.986 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488159, int_b + int_rho = -6.548e-14, checking this took 0.105 ms
2-norm of RHS = 707.7454321168346, which took 0.090 ms

iter_count = 174, r_2norm = 5.902e-04, tol*||rhs|| = 7.077e-04

Anderson update took 91.293 ms, out of which F'*F took 43.170 ms; b-Ax took 294.154 ms, out of which Lap took 262.225 ms
Solving Poisson took 624.197 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.087967 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.085352 
Total time for convolution: 	 convolve: 5.082101 
Total time for convolution: 	 convolve: 5.085700 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.769 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 1.476 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.697 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.206 ms

This SCF took 27254.303 ms, scf error = 3.335e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.133834, lowerbound = -0.960954, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1764.524 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.694 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.990 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.707 ms
rank =  0, finding HY took 28.880 ms
rank =  0, distributing HY into block cyclic form took 17.624 ms
rank =  0, finding Y'*HY took 5.469 ms
Rank 0, Project_Hamiltonian used 73.711 ms
Total time for projection: 73.725 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -0.960504476052290
    last  calculated eigval = 0.034945426406233
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56690116333804
lambda[   5] =  -0.47673788444859
lambda[   6] =  -0.42838242648680
lambda[   7] =  -0.40298300595083
lambda[   8] =  -0.39098652087688
lambda[   9] =  -0.35477403944880
lambda[  10] =  -0.33081460052577
lambda[  11] =  -0.26432793773901
lambda[  12] =  -0.25985368659782
lambda[  13] =  -0.21668312286171
lambda[  14] =  -0.09163107075609
lambda[  15] =  -0.02022336646135
lambda[  16] =  -0.00943439228643
lambda[  17] =   0.01764238830688
lambda[  18] =   0.03043341771043
lambda[  19] =   0.03236163653750
lambda[  20] =   0.03494542640623
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 6.952 ms
rank =  0, Distributing orbital back into band + domain format took 17.631 ms
rank = 0, Subspace_Rotation used 24.596 ms

Total time for subspace rotation: 24.603 ms
rank = 0, Efermi =  -0.120600428580 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 4.398 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.506 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.209 ms
rank = 0, Calculating density took 1871.650 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.858 ms
rank = 0, D2D took 0.968 ms
rank = 0, Transfering density took 0.974 ms
Etot    =   -42.928693945493
Eband   =   -12.065451421867
E1      =    27.637734670610
E2      =   -11.126711394860
E3      =   -15.659779457647
Exc     =   -14.055481354302
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 7.735e-06, dEband = 1.328e-03
rank = 0, Calculating/Estimating energy took 0.902 ms, Etot = -42.928693945, dEtot = 7.735e-06, dEband = 1.328e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0362414660542, which took 0.083 ms

iter_count = 114, r_2norm = 1.016e-06, tol*||rhs|| = 1.450e-06

Anderson update took 60.407 ms, out of which F'*F took 28.618 ms; b-Ax took 194.223 ms, out of which Lap took 173.354 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.995 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488175, int_b + int_rho = 9.459e-14, checking this took 0.103 ms
2-norm of RHS = 707.7549533818401, which took 0.105 ms

iter_count = 168, r_2norm = 5.826e-04, tol*||rhs|| = 7.078e-04

Anderson update took 88.991 ms, out of which F'*F took 41.509 ms; b-Ax took 283.772 ms, out of which Lap took 253.009 ms
Solving Poisson took 603.223 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.081849 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.080403 
Total time for convolution: 	 convolve: 5.082753 
Total time for convolution: 	 convolve: 5.079240 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.767 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.393 ms
---Transfer Veff_loc: D2D took 1.463 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.695 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.192 ms

This SCF took 27207.965 ms, scf error = 2.255e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134945, lowerbound = -0.960504, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1763.196 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.675 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.963 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 21.668 ms
rank =  0, finding HY took 28.911 ms
rank =  0, distributing HY into block cyclic form took 17.730 ms
rank =  0, finding Y'*HY took 5.356 ms
Rank 0, Project_Hamiltonian used 73.695 ms
Total time for projection: 73.709 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.968 ms
    first calculated eigval = -0.960230299987819
    last  calculated eigval = 0.036282421944615
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56661994121753
lambda[   5] =  -0.47647553089427
lambda[   6] =  -0.42810084383844
lambda[   7] =  -0.40269217518142
lambda[   8] =  -0.39071005776970
lambda[   9] =  -0.35449141005004
lambda[  10] =  -0.33052778021467
lambda[  11] =  -0.26404681011144
lambda[  12] =  -0.25957065183808
lambda[  13] =  -0.21641011242644
lambda[  14] =  -0.09134399471820
lambda[  15] =  -0.01857441904605
lambda[  16] =  -0.00904060957960
lambda[  17] =   0.01993315751615
lambda[  18] =   0.03163064020730
lambda[  19] =   0.03272594901904
lambda[  20] =   0.03628242194462
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.986 ms
rank =  0, subspace rotation using ScaLAPACK took 6.466 ms
rank =  0, Distributing orbital back into band + domain format took 18.041 ms
rank = 0, Subspace_Rotation used 24.523 ms

Total time for subspace rotation: 24.531 ms
rank = 0, Efermi =  -0.120313352606 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.345 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.227 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.292 ms
rank = 0, Calculating density took 1870.430 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.840 ms
rank = 0, D2D took 0.977 ms
rank = 0, Transfering density took 0.986 ms
Etot    =   -42.928739704710
Eband   =   -12.058169028683
E1      =    27.634424783643
E2      =   -11.122658501698
E3      =   -15.660030779502
Exc     =   -14.055698048428
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 5.084e-06, dEband = 8.092e-04
rank = 0, Calculating/Estimating energy took 1.345 ms, Etot = -42.928739705, dEtot = 5.084e-06, dEband = 8.092e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0310818068044, which took 0.056 ms

iter_count = 114, r_2norm = 9.068e-07, tol*||rhs|| = 1.243e-06

Anderson update took 61.015 ms, out of which F'*F took 28.853 ms; b-Ax took 195.023 ms, out of which Lap took 174.124 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.244 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488174, int_b + int_rho = 8.367e-14, checking this took 0.103 ms
2-norm of RHS = 707.7561197086063, which took 0.115 ms

iter_count = 132, r_2norm = 5.863e-04, tol*||rhs|| = 7.078e-04

Anderson update took 69.434 ms, out of which F'*F took 32.696 ms; b-Ax took 223.135 ms, out of which Lap took 198.666 ms
Solving Poisson took 474.323 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.088050 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.679 ms
Total time for convolution: 	 convolve: 5.081113 
Total time for convolution: 	 convolve: 5.090219 
Total time for convolution: 	 convolve: 5.080790 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.574 ms
---Transfer Veff_loc: D2D took 1.481 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.692 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.206 ms

This SCF took 27104.059 ms, scf error = 1.702e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136282, lowerbound = -0.960230, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1763.007 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.572 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.036 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.633 ms
rank =  0, finding HY took 28.962 ms
rank =  0, distributing HY into block cyclic form took 20.001 ms
rank =  0, finding Y'*HY took 5.495 ms
Rank 0, Project_Hamiltonian used 76.519 ms
Total time for projection: 76.535 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.960093025574295
    last  calculated eigval = 0.036630396502141
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56650106660833
lambda[   5] =  -0.47637222698735
lambda[   6] =  -0.42797865004207
lambda[   7] =  -0.40257357487311
lambda[   8] =  -0.39058449002242
lambda[   9] =  -0.35437649510870
lambda[  10] =  -0.33040651595459
lambda[  11] =  -0.26393160042593
lambda[  12] =  -0.25945732184535
lambda[  13] =  -0.21628148292436
lambda[  14] =  -0.09122586209921
lambda[  15] =  -0.01822539942362
lambda[  16] =  -0.00890400897163
lambda[  17] =   0.02030691467203
lambda[  18] =   0.03164299458824
lambda[  19] =   0.03281047087917
lambda[  20] =   0.03663039650214
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 6.439 ms
rank =  0, Distributing orbital back into band + domain format took 18.218 ms
rank = 0, Subspace_Rotation used 24.670 ms

Total time for subspace rotation: 24.674 ms
rank = 0, Efermi =  -0.120195219970 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.372 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.424 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.273 ms
rank = 0, Calculating density took 1872.605 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.839 ms
rank = 0, D2D took 0.989 ms
rank = 0, Transfering density took 0.996 ms
Etot    =   -42.928759670305
Eband   =   -12.055053009247
E1      =    27.632840038951
E2      =   -11.121061729264
E3      =   -15.660247748596
Exc     =   -14.055869485427
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 2.218e-06, dEband = 3.462e-04
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -42.928759670, dEtot = 2.218e-06, dEband = 3.462e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0260411318913, which took 0.125 ms

iter_count = 114, r_2norm = 6.236e-07, tol*||rhs|| = 1.042e-06

Anderson update took 60.978 ms, out of which F'*F took 28.517 ms; b-Ax took 194.099 ms, out of which Lap took 173.402 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.389 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488186, int_b + int_rho = 2.037e-13, checking this took 0.085 ms
2-norm of RHS = 707.7558393659942, which took 0.088 ms

iter_count = 138, r_2norm = 6.889e-04, tol*||rhs|| = 7.078e-04

Anderson update took 72.910 ms, out of which F'*F took 34.297 ms; b-Ax took 233.153 ms, out of which Lap took 208.063 ms
Solving Poisson took 495.940 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.153 ms
Total time for convolution: 	 convolve: 5.080539 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.084623 
Total time for convolution: 	 convolve: 5.081023 
Total time for convolution: 	 convolve: 5.101286 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 1.255 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 225.168 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 226.449 ms

This SCF took 27357.684 ms, scf error = 1.380e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136630, lowerbound = -0.960093, upperbound = 267.583578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1481.317 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 17.776 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.127 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.928 ms
rank =  0, finding HY took 28.835 ms
rank =  0, distributing HY into block cyclic form took 17.640 ms
rank =  0, finding Y'*HY took 5.499 ms
Rank 0, Project_Hamiltonian used 73.933 ms
Total time for projection: 73.946 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.959909641205527
    last  calculated eigval = 0.037154673222293
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56633516869284
lambda[   5] =  -0.47621777397321
lambda[   6] =  -0.42781428217034
lambda[   7] =  -0.40241177170891
lambda[   8] =  -0.39041860516947
lambda[   9] =  -0.35422419084554
lambda[  10] =  -0.33024377429022
lambda[  11] =  -0.26377279382095
lambda[  12] =  -0.25930009231315
lambda[  13] =  -0.21611442466263
lambda[  14] =  -0.09106506630002
lambda[  15] =  -0.01777703896161
lambda[  16] =  -0.00870675848198
lambda[  17] =   0.02055572783672
lambda[  18] =   0.03162141582340
lambda[  19] =   0.03311649579069
lambda[  20] =   0.03715467322229
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 6.430 ms
rank =  0, Distributing orbital back into band + domain format took 18.052 ms
rank = 0, Subspace_Rotation used 24.495 ms

Total time for subspace rotation: 24.500 ms
rank = 0, Efermi =  -0.120034424231 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.325 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.480 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.298 ms
rank = 0, Calculating density took 1588.567 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.870 ms
rank = 0, D2D took 1.011 ms
rank = 0, Transfering density took 1.018 ms
Etot    =   -42.928790085987
Eband   =   -12.050809302105
E1      =    27.630668602642
E2      =   -11.118912644854
E3      =   -15.660486845638
Exc     =   -14.056062184574
Esc     =   -71.231986691699
Entropy =    -0.000000000743
dE = 3.380e-06, dEband = 4.715e-04
rank = 0, Calculating/Estimating energy took 0.942 ms, Etot = -42.928790086, dEtot = 3.380e-06, dEband = 4.715e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0157103191304, which took 0.059 ms

iter_count = 114, r_2norm = 4.302e-07, tol*||rhs|| = 6.284e-07

Anderson update took 60.521 ms, out of which F'*F took 28.615 ms; b-Ax took 198.351 ms, out of which Lap took 177.373 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.252 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002488165, int_rho =  26.00000002488161, int_b + int_rho = -4.366e-14, checking this took 0.098 ms
2-norm of RHS = 707.7559094766327, which took 0.113 ms

iter_count = 132, r_2norm = 5.922e-04, tol*||rhs|| = 7.078e-04

Anderson update took 69.141 ms, out of which F'*F took 32.481 ms; b-Ax took 222.911 ms, out of which Lap took 198.514 ms
Solving Poisson took 473.622 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.688 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.084830 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.090266 
Total time for convolution: 	 convolve: 5.085740 
Total time for convolution: 	 convolve: 5.084516 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.826 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
---Transfer Veff_loc: D2D took 1.448 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.854 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.646 ms

This SCF took 26817.106 ms, scf error = 9.662e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.56633516869284, occ[   4] =   2.00000000000000
lambda[   5] =  -0.47621777397321, occ[   5] =   2.00000000000000
lambda[   6] =  -0.42781428217034, occ[   6] =   2.00000000000000
lambda[   7] =  -0.40241177170891, occ[   7] =   2.00000000000000
lambda[   8] =  -0.39041860516947, occ[   8] =   2.00000000000000
lambda[   9] =  -0.35422419084554, occ[   9] =   2.00000000000000
lambda[  10] =  -0.33024377429022, occ[  10] =   2.00000000000000
lambda[  11] =  -0.26377279382095, occ[  11] =   2.00000000000000
lambda[  12] =  -0.25930009231315, occ[  12] =   2.00000000000000
lambda[  13] =  -0.21611442466263, occ[  13] =   2.00000000000000
lambda[  14] =  -0.09106506630002, occ[  14] =   0.00000002488168
lambda[  15] =  -0.01777703896161, occ[  15] =   0.00000000000000
lambda[  16] =  -0.00870675848198, occ[  16] =   0.00000000000000
lambda[  17] =   0.02055572783672, occ[  17] =   0.00000000000000
lambda[  18] =   0.03162141582340, occ[  18] =   0.00000000000000
lambda[  19] =   0.03311649579069, occ[  19] =   0.00000000000000
lambda[  20] =   0.03715467322229, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.630 ms, time for Allreduce/Reduce: 13.152 ms 
Time for calculating local force components: 24.631 ms
Start Calculating nonlocal forces
force_nloc = 
  0.80415911681007  -0.87808453274019  -0.00000031935609
 -0.00940524925416  -0.04992608394945   0.00000002555503
 -0.02057459663986   0.02116518688501  -0.03988208533844
 -0.02057451931573   0.02116513537839   0.03988209786801
  0.01580993742157   0.05327935908744   0.00000000326739
 -0.02063407153005  -0.02824285732428   0.00000051998918
 -0.10904329611630  -0.02117875099562   0.00000028925092
  0.01130175538998  -0.00218710060721  -0.00000006639622
 -0.00453797086632   0.01118138013725   0.00000093591319
force_loc = 
 -0.79046397749610   0.86258672778235   0.00000063876155
  0.01058465294555   0.05279894170993  -0.00000002984603
  0.02271481389440  -0.02253421086561   0.04189582373466
  0.02271585199324  -0.02253455017997  -0.04189655309396
 -0.01677878022991  -0.05657579297586   0.00000014286912
  0.01779137278485   0.02760658370494  -0.00000069112250
  0.11272373303815   0.00355452638837  -0.00000136405683
 -0.00676697038069   0.01554658158790   0.00000017383534
  0.00211751819149  -0.01761424330789  -0.00000022335374
Time for calculating nonlocal force components: 41.204 ms
[32mforces_xc: 
[0m[32m -0.01919891506492   0.02115210336562  -0.00000001720740
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00090442975590   0.00093571953529   0.00000000054701
[0m[32m -0.00290214715616   0.00805664737511  -0.00000003193816
[0m[32m -0.00313532063206  -0.01140317528396   0.00000004088148
[0m[32m  0.00321871658381   0.01124157377114  -0.00000001404292
[0mTime for calculating XC forces components: 34.255 ms
 Cartesian force = 
 -0.00550667398726   0.00565550191014   0.00000038034022
  0.00117650545509   0.00287406126285   0.00000007385115
  0.00213731901823  -0.00136782047823   0.00201381653837
  0.00213843444120  -0.00136821129921  -0.00201437708379
 -0.00097174104464  -0.00329523038605   0.00000022427867
 -0.00194116722560   0.00030064941832  -0.00000009244416
  0.00077539152938  -0.00956637372977  -0.00000102860191
  0.00139656614092   0.00195750919909   0.00000022646275
  0.00079536567268   0.00480991410286   0.00000077665869
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Time for printing density: 393.303 ms
The program took 446.391 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:34:57
Job ID:        2266821
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:31:12,vmem=8444K,walltime=00:07:36,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-14-2
---------------------------------------
