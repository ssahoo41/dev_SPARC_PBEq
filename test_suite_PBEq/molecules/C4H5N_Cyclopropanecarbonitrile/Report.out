---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:08
Job ID:    2266759
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:13
Job ID:    2266759
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.067 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 21.389 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 8.342 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 104.176 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.965 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.105 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    6.394904	   11.287790	   12.402760	
    6.394904	   11.287790	    7.597240	
    7.387521	    7.982706	    7.618030	
    7.387521	    7.982706	   12.381970	
   10.269003	   12.514626	   10.000000	
    9.764592	   10.528498	   10.000000	
   11.893378	    8.846099	   10.000000	
    7.375665	    9.786336	   11.414443	
    7.375665	    9.786336	    8.585557	
   13.605096	    7.485374	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.184 ms
Set up communicators.

--set up spincomm took 2.305 ms

--set up kptcomm took 0.335 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.007 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.124 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.844 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.004 ms

Calculate_SplineDerivRadFun took 0.205 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.278 ms.
time spent on vectorized spline interp: 2.679 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.007 ms.
time spent on vectorized spline interp: 1.639 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.502 ms.
time spent on vectorized spline interp: 1.620 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.524 ms.

Calculating rb for all atom types took 15.259 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.047 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.011 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000324778, sum_int_rho = 25.4846762966351
PosCharge = 26.000000032478, NegCharge = -25.484676296635, scal_fac = 1.020220925306
After scaling, int_rho = 26.0000000324776, PosCharge + NegCharge - NetCharge = 1.243e-13
--Calculate Vref took 0.682 ms
--Calculate rho_guess took 3.759 ms

 integral of b = -26.0000000324778,
 int{b} + Nelectron + NetCharge = -3.248e-08,
 Esc = -65.2404976752493,
 MPI_Reduce took 11.014 ms

Calculating b & b_ref took 23.803 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.013 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.023 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.003 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.048 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.005 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.005 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.003 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.811 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247774, int_b + int_rho = -1.492e-13, checking this took 0.091 ms
2-norm of RHS = 746.6984555035466, which took 0.777 ms

iter_count = 420, r_2norm = 7.146e-04, tol*||rhs|| = 7.467e-04

Anderson update took 232.265 ms, out of which F'*F took 107.032 ms; b-Ax took 717.250 ms, out of which Lap took 646.422 ms
Solving Poisson took 1509.206 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.425 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
Total time for convolution: 	 convolve: 5.343331 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.831 ms
Total time for convolution: 	 convolve: 5.244758 
Total time for convolution: 	 convolve: 5.366823 
Total time for convolution: 	 convolve: 5.184708 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.777 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.013 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.388 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
rank = 0, XC calculation took 25038.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 2.201 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.227 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.534 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.146 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.612 ms
    Lanczos iter 53, eigmin  = -0.944268266, eigmax = 264.929601954, err_eigmin = 5.747e-04, err_eigmax = 9.615e-03
rank =   0, Lanczos took 118.153 ms, eigmin = -0.944268265527, eigmax = 267.578897973113

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.267315, lowerbound = -1.044268, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1694.817 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.752 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.096 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.556 ms
rank =  0, Distribute data + matrix mult took 24.420 ms
rank =  0, finding HY took 29.661 ms
rank =  0, distributing HY into block cyclic form took 18.888 ms
rank =  0, finding Y'*HY took 6.034 ms
Rank 0, Project_Hamiltonian used 79.032 ms
Total time for projection: 79.042 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.393 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.495 ms
    first calculated eigval = 2.714439479449819
    last  calculated eigval = 3.230692556249153
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.81338031142755
lambda[   5] =   2.84909871275896
lambda[   6] =   2.86827005945262
lambda[   7] =   2.92586820026530
lambda[   8] =   2.93969490102057
lambda[   9] =   2.95363502041115
lambda[  10] =   2.98605770418708
lambda[  11] =   2.98774896087915
lambda[  12] =   3.02927611321602
lambda[  13] =   3.05995561316166
lambda[  14] =   3.07385833705292
lambda[  15] =   3.09471890204505
lambda[  16] =   3.12313950139943
lambda[  17] =   3.13571552872269
lambda[  18] =   3.15959390719022
lambda[  19] =   3.17233249231397
lambda[  20] =   3.23069255624915
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.524 ms
rank =  0, subspace rotation using ScaLAPACK took 5.456 ms
rank =  0, Distributing orbital back into band + domain format took 16.327 ms
rank = 0, Subspace_Rotation used 21.800 ms

Total time for subspace rotation: 21.805 ms
rank = 0, Efermi =   3.066906974671 calculate fermi energy took 0.066 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.330693, lowerbound = -1.044268, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1697.730 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.902 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.217 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 26.147 ms
rank =  0, finding HY took 29.376 ms
rank =  0, distributing HY into block cyclic form took 17.656 ms
rank =  0, finding Y'*HY took 5.573 ms
Rank 0, Project_Hamiltonian used 78.781 ms
Total time for projection: 78.794 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -0.723634374876872
    last  calculated eigval = 0.408680543200004
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.32050061089415
lambda[   5] =  -0.25929915898400
lambda[   6] =  -0.21153132782479
lambda[   7] =  -0.11231214098735
lambda[   8] =  -0.04831443339448
lambda[   9] =   0.04308482709606
lambda[  10] =   0.10630283101096
lambda[  11] =   0.20810861338519
lambda[  12] =   0.23673405471939
lambda[  13] =   0.28100684897965
lambda[  14] =   0.28515425102883
lambda[  15] =   0.31304872379489
lambda[  16] =   0.34251907252004
lambda[  17] =   0.35823250997439
lambda[  18] =   0.36726126623984
lambda[  19] =   0.39815818409922
lambda[  20] =   0.40868054320000
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 5.464 ms
rank =  0, Distributing orbital back into band + domain format took 16.970 ms
rank = 0, Subspace_Rotation used 22.449 ms

Total time for subspace rotation: 22.454 ms
rank = 0, Efermi =   0.283080550090 calculate fermi energy took 0.027 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.508681, lowerbound = -1.044268, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1715.186 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.568 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.072 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 21.700 ms
rank =  0, finding HY took 26.673 ms
rank =  0, distributing HY into block cyclic form took 31.029 ms
rank =  0, finding Y'*HY took 5.424 ms
Rank 0, Project_Hamiltonian used 84.857 ms
Total time for projection: 84.863 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.196 ms
    first calculated eigval = -0.947749101554286
    last  calculated eigval = 0.124909190324906
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.68439970766057
lambda[   5] =  -0.59663829939529
lambda[   6] =  -0.57527124745269
lambda[   7] =  -0.47243334947907
lambda[   8] =  -0.45434065139529
lambda[   9] =  -0.42068811857257
lambda[  10] =  -0.40158549833175
lambda[  11] =  -0.36494119745995
lambda[  12] =  -0.33779480335217
lambda[  13] =  -0.31537787355276
lambda[  14] =  -0.01511659534794
lambda[  15] =  -0.00246664769663
lambda[  16] =   0.04938131665935
lambda[  17] =   0.09038845669843
lambda[  18] =   0.09759215748260
lambda[  19] =   0.11454107502546
lambda[  20] =   0.12490919032491
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 5.525 ms
rank =  0, Distributing orbital back into band + domain format took 16.724 ms
rank = 0, Subspace_Rotation used 22.263 ms

Total time for subspace rotation: 22.268 ms
rank = 0, Efermi =  -0.043843921414 calculate fermi energy took 0.029 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.224909, lowerbound = -1.044268, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1717.712 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.683 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.210 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 21.923 ms
rank =  0, finding HY took 29.519 ms
rank =  0, distributing HY into block cyclic form took 17.549 ms
rank =  0, finding Y'*HY took 5.510 ms
Rank 0, Project_Hamiltonian used 74.531 ms
Total time for projection: 74.535 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.948431844671602
    last  calculated eigval = 0.080030144300350
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.68590140882999
lambda[   5] =  -0.59890817786896
lambda[   6] =  -0.57702017259643
lambda[   7] =  -0.48200521741717
lambda[   8] =  -0.45935436970774
lambda[   9] =  -0.42594012018511
lambda[  10] =  -0.42449969844193
lambda[  11] =  -0.40225994623637
lambda[  12] =  -0.36731509846735
lambda[  13] =  -0.35428946876532
lambda[  14] =  -0.07393395622475
lambda[  15] =  -0.06068752624921
lambda[  16] =  -0.00196678348941
lambda[  17] =   0.01603952721550
lambda[  18] =   0.03915364170932
lambda[  19] =   0.05239485039593
lambda[  20] =   0.08003014430035
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 5.520 ms
rank =  0, Distributing orbital back into band + domain format took 16.635 ms
rank = 0, Subspace_Rotation used 22.169 ms

Total time for subspace rotation: 22.173 ms
rank = 0, Efermi =  -0.102661282236 calculate fermi energy took 0.028 ms
rank = 0, --- Calculate rho: sum over local bands took 7.279 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.109 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.234 ms
rank = 0, Calculating density took 7363.814 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.788 ms
rank = 0, D2D took 0.969 ms
rank = 0, Transfering density took 0.978 ms
Etot    =   -37.537866971304
Eband   =   -14.735155237562
E1      =    29.871477699518
E2      =   -11.142665847319
E3      =   -14.148182790038
Exc     =   -12.724540394407
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 3.754e+00, dEband = 1.474e+00
rank = 0, Calculating/Estimating energy took 0.939 ms, Etot = -37.537866971, dEtot = 3.754e+00, dEband = 1.474e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 49.0972344605572, which took 0.109 ms

iter_count = 96, r_2norm = 1.742e-03, tol*||rhs|| = 1.964e-03

Anderson update took 51.770 ms, out of which F'*F took 24.141 ms; b-Ax took 161.958 ms, out of which Lap took 146.386 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 346.938 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247763, int_b + int_rho = -2.547e-13, checking this took 0.154 ms
2-norm of RHS = 742.0893677290341, which took 0.147 ms

iter_count = 288, r_2norm = 6.342e-04, tol*||rhs|| = 7.421e-04

Anderson update took 184.538 ms, out of which F'*F took 73.880 ms; b-Ax took 520.406 ms, out of which Lap took 471.593 ms
Solving Poisson took 1092.025 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.920 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.243880 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.093918 
Total time for convolution: 	 convolve: 5.355848 
Total time for convolution: 	 convolve: 5.087327 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.424 ms
---Transfer Veff_loc: D2D took 1.311 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 32.033 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 33.369 ms

This SCF took 35184.505 ms, scf error = 1.960e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.180030, lowerbound = -0.948432, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1931.047 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.536 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.138 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.700 ms
rank =  0, finding HY took 29.422 ms
rank =  0, distributing HY into block cyclic form took 17.596 ms
rank =  0, finding Y'*HY took 5.989 ms
Rank 0, Project_Hamiltonian used 74.734 ms
Total time for projection: 74.745 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.912716818064601
    last  calculated eigval = 0.060505175352099
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.65139999920234
lambda[   5] =  -0.57157697177405
lambda[   6] =  -0.54446134041775
lambda[   7] =  -0.45706282212301
lambda[   8] =  -0.42852966099315
lambda[   9] =  -0.40089076984408
lambda[  10] =  -0.39291773290040
lambda[  11] =  -0.36644829515493
lambda[  12] =  -0.34100272969207
lambda[  13] =  -0.32577850538332
lambda[  14] =  -0.06048012373748
lambda[  15] =  -0.05668949680640
lambda[  16] =  -0.01174013577495
lambda[  17] =  -0.00223890038419
lambda[  18] =   0.01365964923889
lambda[  19] =   0.02556383387957
lambda[  20] =   0.06050517535210
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 5.346 ms
rank =  0, Distributing orbital back into band + domain format took 19.076 ms
rank = 0, Subspace_Rotation used 24.440 ms

Total time for subspace rotation: 24.444 ms
rank = 0, Efermi =  -0.089218393917 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 4.248 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.631 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.214 ms
rank = 0, Calculating density took 2038.703 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.841 ms
rank = 0, D2D took 0.975 ms
rank = 0, Transfering density took 0.982 ms
Etot    =   -37.463175454284
Eband   =   -13.944662767798
E1      =    29.172826187526
E2      =   -11.088196655660
E3      =   -14.351057499334
Exc     =   -12.890095352794
Esc     =   -65.240497675249
Entropy =    -0.000000000964
dE = 7.469e-03, dEband = 7.905e-02
rank = 0, Calculating/Estimating energy took 0.897 ms, Etot = -37.463175454, dEtot = 7.469e-03, dEband = 7.905e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 22.6893197501550, which took 0.121 ms

iter_count = 102, r_2norm = 7.201e-04, tol*||rhs|| = 9.076e-04

Anderson update took 228.695 ms, out of which F'*F took 103.254 ms; b-Ax took 293.817 ms, out of which Lap took 277.580 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 833.157 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247777, int_b + int_rho = -1.128e-13, checking this took 0.122 ms
2-norm of RHS = 736.4639505250952, which took 50.790 ms

iter_count = 300, r_2norm = 6.615e-04, tol*||rhs|| = 7.365e-04

Anderson update took 486.622 ms, out of which F'*F took 212.593 ms; b-Ax took 1146.169 ms, out of which Lap took 1075.720 ms
Solving Poisson took 2238.225 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.175 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.084338 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.798 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.095156 
Total time for convolution: 	 convolve: 5.093921 
Total time for convolution: 	 convolve: 5.088629 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.249 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 1.275 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.345 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.640 ms

This SCF took 29547.186 ms, scf error = 1.346e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.160505, lowerbound = -0.912717, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1701.560 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.332 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.537 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 21.890 ms
rank =  0, finding HY took 30.128 ms
rank =  0, distributing HY into block cyclic form took 18.758 ms
rank =  0, finding Y'*HY took 5.743 ms
Rank 0, Project_Hamiltonian used 76.550 ms
Total time for projection: 76.562 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.859596510685638
    last  calculated eigval = 0.059417148207697
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.59636681852367
lambda[   5] =  -0.52508551514845
lambda[   6] =  -0.49089401596422
lambda[   7] =  -0.41193767453697
lambda[   8] =  -0.37885037442414
lambda[   9] =  -0.36130079245243
lambda[  10] =  -0.34477485086606
lambda[  11] =  -0.32651360675995
lambda[  12] =  -0.30230867800414
lambda[  13] =  -0.28523188287331
lambda[  14] =  -0.04006160078099
lambda[  15] =  -0.02849385994673
lambda[  16] =  -0.01159517858750
lambda[  17] =  -0.00042350545668
lambda[  18] =   0.01250737356974
lambda[  19] =   0.02086574161475
lambda[  20] =   0.05941714820770
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.194 ms
rank =  0, subspace rotation using ScaLAPACK took 6.405 ms
rank =  0, Distributing orbital back into band + domain format took 17.598 ms
rank = 0, Subspace_Rotation used 24.017 ms

Total time for subspace rotation: 24.022 ms
rank = 0, Efermi =  -0.068788926921 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 4.049 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.716 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.228 ms
rank = 0, Calculating density took 1810.467 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.754 ms
rank = 0, D2D took 0.901 ms
rank = 0, Transfering density took 0.904 ms
Etot    =   -37.403882686233
Eband   =   -12.723845170998
E1      =    28.134750745055
E2      =   -10.899843578645
E3      =   -14.699208373992
Exc     =   -13.173342536717
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 5.929e-03, dEband = 1.221e-01
rank = 0, Calculating/Estimating energy took 1.474 ms, Etot = -37.403882686, dEtot = 5.929e-03, dEband = 1.221e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.8715594259683, which took 0.054 ms

iter_count = 108, r_2norm = 1.793e-04, tol*||rhs|| = 2.749e-04

Anderson update took 57.407 ms, out of which F'*F took 27.225 ms; b-Ax took 181.508 ms, out of which Lap took 163.921 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 391.834 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247763, int_b + int_rho = -2.547e-13, checking this took 0.140 ms
2-norm of RHS = 735.5168559957763, which took 0.129 ms

iter_count = 276, r_2norm = 7.090e-04, tol*||rhs|| = 7.355e-04

Anderson update took 146.824 ms, out of which F'*F took 68.860 ms; b-Ax took 463.543 ms, out of which Lap took 416.306 ms
Solving Poisson took 976.290 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.086584 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.165147 
Total time for convolution: 	 convolve: 5.110497 
Total time for convolution: 	 convolve: 5.098030 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.252 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.425 ms
---Transfer Veff_loc: D2D took 1.306 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.329 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.659 ms

This SCF took 27634.591 ms, scf error = 4.801e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.159417, lowerbound = -0.859597, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1667.152 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.426 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.230 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.681 ms
rank =  0, finding HY took 28.452 ms
rank =  0, distributing HY into block cyclic form took 17.392 ms
rank =  0, finding Y'*HY took 5.569 ms
Rank 0, Project_Hamiltonian used 73.122 ms
Total time for projection: 73.134 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.842378248068050
    last  calculated eigval = 0.056935037041936
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57735373977908
lambda[   5] =  -0.50746958465746
lambda[   6] =  -0.47210333649309
lambda[   7] =  -0.39422944077633
lambda[   8] =  -0.36093379544811
lambda[   9] =  -0.34649315670193
lambda[  10] =  -0.33034625856896
lambda[  11] =  -0.31383043391718
lambda[  12] =  -0.28878917371335
lambda[  13] =  -0.27158942363884
lambda[  14] =  -0.03611434364738
lambda[  15] =  -0.01821040736776
lambda[  16] =  -0.01134256159754
lambda[  17] =  -0.00019243327575
lambda[  18] =   0.01157266906612
lambda[  19] =   0.01919084184271
lambda[  20] =   0.05693503704194
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 6.303 ms
rank =  0, Distributing orbital back into band + domain format took 17.514 ms
rank = 0, Subspace_Rotation used 23.830 ms

Total time for subspace rotation: 23.834 ms
rank = 0, Efermi =  -0.064841669530 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 4.019 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.226 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.358 ms
rank = 0, Calculating density took 1773.098 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.866 ms
rank = 0, D2D took 1.032 ms
rank = 0, Transfering density took 1.034 ms
Etot    =   -37.396531137889
Eband   =   -12.298668806967
E1      =    27.814819813367
E2      =   -10.773852549436
E3      =   -14.834151716844
Exc     =   -13.280188734357
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 7.352e-04, dEband = 4.252e-02
rank = 0, Calculating/Estimating energy took 1.295 ms, Etot = -37.396531138, dEtot = 7.352e-04, dEband = 4.252e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.8206742782608, which took 0.073 ms

iter_count = 114, r_2norm = 4.859e-05, tol*||rhs|| = 7.283e-05

Anderson update took 60.198 ms, out of which F'*F took 28.647 ms; b-Ax took 192.233 ms, out of which Lap took 173.022 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 413.202 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247760, int_b + int_rho = -2.838e-13, checking this took 0.100 ms
2-norm of RHS = 736.3045019019148, which took 0.109 ms

iter_count = 270, r_2norm = 6.171e-04, tol*||rhs|| = 7.363e-04

Anderson update took 143.042 ms, out of which F'*F took 66.925 ms; b-Ax took 453.382 ms, out of which Lap took 406.250 ms
Solving Poisson took 955.354 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
Total time for convolution: 	 convolve: 5.088845 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.654 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.111417 
Total time for convolution: 	 convolve: 5.080430 
Total time for convolution: 	 convolve: 5.078941 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 4.469 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.191 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 1.273 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.029 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.330 ms

This SCF took 27534.144 ms, scf error = 2.201e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.156935, lowerbound = -0.842378, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1654.791 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.351 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.246 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.684 ms
rank =  0, Distribute data + matrix mult took 22.316 ms
rank =  0, finding HY took 27.993 ms
rank =  0, distributing HY into block cyclic form took 17.311 ms
rank =  0, finding Y'*HY took 5.604 ms
Rank 0, Project_Hamiltonian used 73.255 ms
Total time for projection: 73.272 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -0.837237299266341
    last  calculated eigval = 0.053155351842090
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57054196707477
lambda[   5] =  -0.50045155648527
lambda[   6] =  -0.46562103913451
lambda[   7] =  -0.38668595475225
lambda[   8] =  -0.35352259808390
lambda[   9] =  -0.34040452835144
lambda[  10] =  -0.32554413547117
lambda[  11] =  -0.30736264577707
lambda[  12] =  -0.28396398648435
lambda[  13] =  -0.26635180879770
lambda[  14] =  -0.03497309769261
lambda[  15] =  -0.01415289890297
lambda[  16] =  -0.01015220040793
lambda[  17] =  -0.00023128249573
lambda[  18] =   0.01133113644398
lambda[  19] =   0.01806472603124
lambda[  20] =   0.05315535184209
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 6.324 ms
rank =  0, Distributing orbital back into band + domain format took 17.936 ms
rank = 0, Subspace_Rotation used 24.272 ms

Total time for subspace rotation: 24.277 ms
rank = 0, Efermi =  -0.063700423620 calculate fermi energy took 2.555 ms
rank = 0, --- Calculate rho: sum over local bands took 4.464 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.102 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.220 ms
rank = 0, Calculating density took 1761.929 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.830 ms
rank = 0, D2D took 0.962 ms
rank = 0, Transfering density took 0.969 ms
Etot    =   -37.394396652137
Eband   =   -12.139392267229
E1      =    27.748943806703
E2      =   -10.667654816604
E3      =   -14.885608094350
Exc     =   -13.316713426354
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 2.134e-04, dEband = 1.593e-02
rank = 0, Calculating/Estimating energy took 0.893 ms, Etot = -37.394396652, dEtot = 2.134e-04, dEband = 1.593e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0495870907492, which took 0.147 ms

iter_count = 108, r_2norm = 3.706e-05, tol*||rhs|| = 4.198e-05

Anderson update took 56.923 ms, out of which F'*F took 27.022 ms; b-Ax took 182.045 ms, out of which Lap took 163.287 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 391.511 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247759, int_b + int_rho = -2.910e-13, checking this took 0.126 ms
2-norm of RHS = 736.6597709731431, which took 0.137 ms

iter_count = 246, r_2norm = 6.921e-04, tol*||rhs|| = 7.367e-04

Anderson update took 130.098 ms, out of which F'*F took 61.074 ms; b-Ax took 419.162 ms, out of which Lap took 376.849 ms
Solving Poisson took 874.844 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.193094 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.144338 
Total time for convolution: 	 convolve: 5.117827 
Total time for convolution: 	 convolve: 5.083765 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 21.900 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.603 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 1.421 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.592 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.043 ms

This SCF took 27614.969 ms, scf error = 6.730e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.153155, lowerbound = -0.837237, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1685.977 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.431 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.233 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.688 ms
rank =  0, finding HY took 28.455 ms
rank =  0, distributing HY into block cyclic form took 17.445 ms
rank =  0, finding Y'*HY took 5.548 ms
Rank 0, Project_Hamiltonian used 73.165 ms
Total time for projection: 73.177 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.833636971846753
    last  calculated eigval = 0.049061464333743
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56608410449948
lambda[   5] =  -0.49693427057942
lambda[   6] =  -0.46159925376293
lambda[   7] =  -0.38309039454649
lambda[   8] =  -0.34951980356523
lambda[   9] =  -0.33695433790587
lambda[  10] =  -0.32165752379781
lambda[  11] =  -0.30317257077896
lambda[  12] =  -0.28017628088193
lambda[  13] =  -0.26274724097146
lambda[  14] =  -0.03461288947110
lambda[  15] =  -0.01163168329403
lambda[  16] =  -0.00905702778622
lambda[  17] =  -0.00038550053044
lambda[  18] =   0.01150380913727
lambda[  19] =   0.01733367973864
lambda[  20] =   0.04906146433374
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 6.322 ms
rank =  0, Distributing orbital back into band + domain format took 17.762 ms
rank = 0, Subspace_Rotation used 24.096 ms

Total time for subspace rotation: 24.101 ms
rank = 0, Efermi =  -0.063340215399 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 4.229 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.718 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.236 ms
rank = 0, Calculating density took 1791.800 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.824 ms
rank = 0, D2D took 0.985 ms
rank = 0, Transfering density took 0.987 ms
Etot    =   -37.393855442474
Eband   =   -12.041105155157
E1      =    27.702812387055
E2      =   -10.609819587739
E3      =   -14.906143009110
Exc     =   -13.331027595010
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 5.412e-05, dEband = 9.829e-03
rank = 0, Calculating/Estimating energy took 0.899 ms, Etot = -37.393855442, dEtot = 5.412e-05, dEband = 9.829e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5051857584351, which took 0.054 ms

iter_count = 114, r_2norm = 1.328e-05, tol*||rhs|| = 2.021e-05

Anderson update took 59.972 ms, out of which F'*F took 28.131 ms; b-Ax took 191.193 ms, out of which Lap took 171.524 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 412.514 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247751, int_b + int_rho = -3.747e-13, checking this took 0.129 ms
2-norm of RHS = 736.9091853428117, which took 0.127 ms

iter_count = 240, r_2norm = 6.669e-04, tol*||rhs|| = 7.369e-04

Anderson update took 125.465 ms, out of which F'*F took 58.736 ms; b-Ax took 411.158 ms, out of which Lap took 370.582 ms
Solving Poisson took 860.455 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.086399 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 44.173 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.106516 
Total time for convolution: 	 convolve: 5.093683 
Total time for convolution: 	 convolve: 5.149698 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.752 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.596 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.189 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.393 ms
---Transfer Veff_loc: D2D took 1.384 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.611 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.024 ms

This SCF took 27576.417 ms, scf error = 3.988e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.149061, lowerbound = -0.833637, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1693.093 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.554 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.241 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.818 ms
rank =  0, finding HY took 28.532 ms
rank =  0, distributing HY into block cyclic form took 17.402 ms
rank =  0, finding Y'*HY took 5.542 ms
Rank 0, Project_Hamiltonian used 73.323 ms
Total time for projection: 73.335 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.830761352370266
    last  calculated eigval = 0.045478825604653
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56303276446210
lambda[   5] =  -0.49416075547494
lambda[   6] =  -0.45864821592259
lambda[   7] =  -0.38041086348059
lambda[   8] =  -0.34670262303949
lambda[   9] =  -0.33418288191262
lambda[  10] =  -0.31874195642966
lambda[  11] =  -0.30064211085119
lambda[  12] =  -0.27739096855200
lambda[  13] =  -0.26003136790793
lambda[  14] =  -0.03399620105351
lambda[  15] =  -0.00967623143736
lambda[  16] =  -0.00776056362094
lambda[  17] =   0.00005074690384
lambda[  18] =   0.01241475488716
lambda[  19] =   0.01730573395570
lambda[  20] =   0.04547882560465
==subpsace eigenproblem: bcast eigvals took 0.052 ms
Total time for solving subspace eigenvalue problem: 0.252 ms
rank =  0, subspace rotation using ScaLAPACK took 6.319 ms
rank =  0, Distributing orbital back into band + domain format took 17.807 ms
rank = 0, Subspace_Rotation used 24.138 ms

Total time for subspace rotation: 24.143 ms
rank = 0, Efermi =  -0.062723526969 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.240 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.677 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.216 ms
rank = 0, Calculating density took 1799.074 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.826 ms
rank = 0, D2D took 0.952 ms
rank = 0, Transfering density took 0.955 ms
Etot    =   -37.393633125159
Eband   =   -11.967693518101
E1      =    27.670227293619
E2      =   -10.565865012003
E3      =   -14.916200843612
Exc     =   -13.337735080082
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 2.223e-05, dEband = 7.341e-03
rank = 0, Calculating/Estimating energy took 0.900 ms, Etot = -37.393633125, dEtot = 2.223e-05, dEband = 7.341e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2737710198114, which took 0.050 ms

iter_count = 114, r_2norm = 7.301e-06, tol*||rhs|| = 1.095e-05

Anderson update took 60.348 ms, out of which F'*F took 28.352 ms; b-Ax took 191.843 ms, out of which Lap took 171.969 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 413.409 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247768, int_b + int_rho = -2.037e-13, checking this took 0.510 ms
2-norm of RHS = 736.9499483382569, which took 0.089 ms

iter_count = 240, r_2norm = 5.849e-04, tol*||rhs|| = 7.369e-04

Anderson update took 126.290 ms, out of which F'*F took 59.212 ms; b-Ax took 406.126 ms, out of which Lap took 362.077 ms
Solving Poisson took 854.431 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.131 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.142096 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.193 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.092105 
Total time for convolution: 	 convolve: 5.105474 
Total time for convolution: 	 convolve: 5.092143 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
---Transfer Veff_loc: D2D took 1.442 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.608 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.079 ms

This SCF took 27521.888 ms, scf error = 2.320e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.145479, lowerbound = -0.830761, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1685.988 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.328 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.284 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.635 ms
rank =  0, finding HY took 28.687 ms
rank =  0, distributing HY into block cyclic form took 17.413 ms
rank =  0, finding Y'*HY took 6.327 ms
Rank 0, Project_Hamiltonian used 74.092 ms
Total time for projection: 74.104 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.827157096118411
    last  calculated eigval = 0.042899666656243
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55995555192231
lambda[   5] =  -0.49101610249117
lambda[   6] =  -0.45550718073866
lambda[   7] =  -0.37736385445389
lambda[   8] =  -0.34366668059326
lambda[   9] =  -0.33096106327173
lambda[  10] =  -0.31549882683854
lambda[  11] =  -0.29698464604462
lambda[  12] =  -0.27414356133140
lambda[  13] =  -0.25664466577592
lambda[  14] =  -0.03227588465447
lambda[  15] =  -0.00711025870921
lambda[  16] =  -0.00548991931242
lambda[  17] =   0.00214911329334
lambda[  18] =   0.01458430031293
lambda[  19] =   0.01859141649616
lambda[  20] =   0.04289966665624
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 6.341 ms
rank =  0, Distributing orbital back into band + domain format took 17.973 ms
rank = 0, Subspace_Rotation used 24.327 ms

Total time for subspace rotation: 24.332 ms
rank = 0, Efermi =  -0.061003210610 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.252 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.653 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.223 ms
rank = 0, Calculating density took 1792.874 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.846 ms
rank = 0, D2D took 0.962 ms
rank = 0, Transfering density took 0.964 ms
Etot    =   -37.393513227815
Eband   =   -11.881923257694
E1      =    27.624066245077
E2      =   -10.522931173984
E3      =   -14.929241422235
Exc     =   -13.347331135206
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 1.199e-05, dEband = 8.577e-03
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -37.393513228, dEtot = 1.199e-05, dEband = 8.577e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2018267262528, which took 0.108 ms

iter_count = 114, r_2norm = 5.723e-06, tol*||rhs|| = 8.073e-06

Anderson update took 59.576 ms, out of which F'*F took 28.428 ms; b-Ax took 192.448 ms, out of which Lap took 172.878 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 413.311 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247769, int_b + int_rho = -1.892e-13, checking this took 0.099 ms
2-norm of RHS = 736.9541138250537, which took 0.102 ms

iter_count = 210, r_2norm = 6.184e-04, tol*||rhs|| = 7.370e-04

Anderson update took 110.161 ms, out of which F'*F took 51.610 ms; b-Ax took 351.748 ms, out of which Lap took 315.717 ms
Solving Poisson took 746.972 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.111947 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 82.439 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.096420 
Total time for convolution: 	 convolve: 5.113673 
Total time for convolution: 	 convolve: 5.134341 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 1.411 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.628 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.066 ms

This SCF took 27529.768 ms, scf error = 1.394e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.142900, lowerbound = -0.827157, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1689.293 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.455 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.297 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.777 ms
rank =  0, finding HY took 28.514 ms
rank =  0, distributing HY into block cyclic form took 17.595 ms
rank =  0, finding Y'*HY took 5.446 ms
Rank 0, Project_Hamiltonian used 73.361 ms
Total time for projection: 73.374 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.826583627667836
    last  calculated eigval = 0.040420491337084
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55952358569707
lambda[   5] =  -0.49059849473882
lambda[   6] =  -0.45509704049456
lambda[   7] =  -0.37693209127071
lambda[   8] =  -0.34318555103664
lambda[   9] =  -0.33041078693380
lambda[  10] =  -0.31487313224052
lambda[  11] =  -0.29622910882410
lambda[  12] =  -0.27351107830707
lambda[  13] =  -0.25601695699658
lambda[  14] =  -0.03097535279349
lambda[  15] =  -0.00626410524033
lambda[  16] =  -0.00507658753279
lambda[  17] =   0.00371350089084
lambda[  18] =   0.01584996374491
lambda[  19] =   0.01919642229216
lambda[  20] =   0.04042049133708
==subpsace eigenproblem: bcast eigvals took 0.048 ms
Total time for solving subspace eigenvalue problem: 0.236 ms
rank =  0, subspace rotation using ScaLAPACK took 6.356 ms
rank =  0, Distributing orbital back into band + domain format took 17.807 ms
rank = 0, Subspace_Rotation used 24.177 ms

Total time for subspace rotation: 24.182 ms
rank = 0, Efermi =  -0.059702678680 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 4.183 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.698 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.231 ms
rank = 0, Calculating density took 1795.358 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.863 ms
rank = 0, D2D took 0.973 ms
rank = 0, Transfering density took 0.976 ms
Etot    =   -37.393574003140
Eband   =   -11.867985005153
E1      =    27.619459719407
E2      =   -10.513881027292
E3      =   -14.927663212316
Exc     =   -13.346095280791
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 6.078e-06, dEband = 1.394e-03
rank = 0, Calculating/Estimating energy took 1.874 ms, Etot = -37.393574003, dEtot = 6.078e-06, dEband = 1.394e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1079060060566, which took 0.077 ms

iter_count = 114, r_2norm = 3.165e-06, tol*||rhs|| = 4.316e-06

Anderson update took 60.076 ms, out of which F'*F took 28.404 ms; b-Ax took 192.431 ms, out of which Lap took 172.710 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 413.198 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247761, int_b + int_rho = -2.765e-13, checking this took 0.106 ms
2-norm of RHS = 736.9286100764857, which took 0.094 ms

iter_count = 216, r_2norm = 6.595e-04, tol*||rhs|| = 7.369e-04

Anderson update took 113.412 ms, out of which F'*F took 53.519 ms; b-Ax took 364.099 ms, out of which Lap took 326.396 ms
Solving Poisson took 767.807 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.092134 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 68.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.120026 
Total time for convolution: 	 convolve: 5.114966 
Total time for convolution: 	 convolve: 5.114214 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.399 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.421 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.609 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.059 ms

This SCF took 27488.454 ms, scf error = 1.052e-03
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.140420, lowerbound = -0.826584, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1684.863 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.338 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.277 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.640 ms
rank =  0, finding HY took 28.673 ms
rank =  0, distributing HY into block cyclic form took 41.914 ms
rank =  0, finding Y'*HY took 5.513 ms
Rank 0, Project_Hamiltonian used 97.773 ms
Total time for projection: 97.785 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.824981509070948
    last  calculated eigval = 0.039458095975410
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55797505970582
lambda[   5] =  -0.48909715863605
lambda[   6] =  -0.45358690345722
lambda[   7] =  -0.37540513302017
lambda[   8] =  -0.34162685844481
lambda[   9] =  -0.32885813772931
lambda[  10] =  -0.31331895569612
lambda[  11] =  -0.29461481322030
lambda[  12] =  -0.27196198211083
lambda[  13] =  -0.25447343885849
lambda[  14] =  -0.02744568907925
lambda[  15] =  -0.00418940306411
lambda[  16] =  -0.00338093127137
lambda[  17] =   0.00804454497227
lambda[  18] =   0.01927253685380
lambda[  19] =   0.02231314047676
lambda[  20] =   0.03945809597541
==subpsace eigenproblem: bcast eigvals took 0.058 ms
Total time for solving subspace eigenvalue problem: 0.252 ms
rank =  0, subspace rotation using ScaLAPACK took 6.356 ms
rank =  0, Distributing orbital back into band + domain format took 17.625 ms
rank = 0, Subspace_Rotation used 23.994 ms

Total time for subspace rotation: 23.999 ms
rank = 0, Efermi =  -0.056173015083 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.152 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.969 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.220 ms
rank = 0, Calculating density took 1815.397 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.848 ms
rank = 0, D2D took 0.977 ms
rank = 0, Transfering density took 0.979 ms
Etot    =   -37.393618045322
Eband   =   -11.827552135982
E1      =    27.598577180945
E2      =   -10.493449580386
E3      =   -14.931728079952
Exc     =   -13.349323074414
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 4.404e-06, dEband = 4.043e-03
rank = 0, Calculating/Estimating energy took 0.900 ms, Etot = -37.393618045, dEtot = 4.404e-06, dEband = 4.043e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0660853575913, which took 0.053 ms

iter_count = 114, r_2norm = 2.074e-06, tol*||rhs|| = 2.643e-06

Anderson update took 59.633 ms, out of which F'*F took 28.286 ms; b-Ax took 192.384 ms, out of which Lap took 172.937 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 412.846 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247762, int_b + int_rho = -2.619e-13, checking this took 0.137 ms
2-norm of RHS = 736.9324809788257, which took 0.096 ms

iter_count = 186, r_2norm = 7.275e-04, tol*||rhs|| = 7.369e-04

Anderson update took 97.761 ms, out of which F'*F took 45.666 ms; b-Ax took 312.028 ms, out of which Lap took 280.193 ms
Solving Poisson took 662.176 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.088065 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 52.017 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.095700 
Total time for convolution: 	 convolve: 5.100613 
Total time for convolution: 	 convolve: 5.128252 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.412 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 1.412 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.620 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.061 ms

This SCF took 27366.555 ms, scf error = 5.746e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.139458, lowerbound = -0.824982, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1693.652 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.424 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.267 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.715 ms
rank =  0, finding HY took 28.529 ms
rank =  0, distributing HY into block cyclic form took 17.364 ms
rank =  0, finding Y'*HY took 5.517 ms
Rank 0, Project_Hamiltonian used 73.152 ms
Total time for projection: 73.163 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.824183000113558
    last  calculated eigval = 0.038319124296209
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55720006077241
lambda[   5] =  -0.48831141847726
lambda[   6] =  -0.45280760425097
lambda[   7] =  -0.37464498533935
lambda[   8] =  -0.34087067695073
lambda[   9] =  -0.32808421648048
lambda[  10] =  -0.31254403332724
lambda[  11] =  -0.29385376556432
lambda[  12] =  -0.27118791510279
lambda[  13] =  -0.25368851082476
lambda[  14] =  -0.02569445599127
lambda[  15] =  -0.00304481049270
lambda[  16] =  -0.00265832403394
lambda[  17] =   0.00967106405578
lambda[  18] =   0.02067374083688
lambda[  19] =   0.02371053554823
lambda[  20] =   0.03831912429621
==subpsace eigenproblem: bcast eigvals took 0.093 ms
Total time for solving subspace eigenvalue problem: 0.285 ms
rank =  0, subspace rotation using ScaLAPACK took 6.282 ms
rank =  0, Distributing orbital back into band + domain format took 17.505 ms
rank = 0, Subspace_Rotation used 23.800 ms

Total time for subspace rotation: 23.805 ms
rank = 0, Efermi =  -0.054421781941 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.054 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.812 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.243 ms
rank = 0, Calculating density took 1799.141 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.785 ms
rank = 0, D2D took 0.934 ms
rank = 0, Transfering density took 0.937 ms
Etot    =   -37.393700078152
Eband   =   -11.807315473289
E1      =    27.588171069527
E2      =   -10.483184039146
E3      =   -14.933522782490
Exc     =   -13.350764819815
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 8.203e-06, dEband = 2.024e-03
rank = 0, Calculating/Estimating energy took 1.375 ms, Etot = -37.393700078, dEtot = 8.203e-06, dEband = 2.024e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0530645863095, which took 0.051 ms

iter_count = 114, r_2norm = 1.542e-06, tol*||rhs|| = 2.123e-06

Anderson update took 59.933 ms, out of which F'*F took 28.294 ms; b-Ax took 192.148 ms, out of which Lap took 172.359 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 413.010 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247760, int_b + int_rho = -2.838e-13, checking this took 0.115 ms
2-norm of RHS = 736.9440006121006, which took 0.110 ms

iter_count = 174, r_2norm = 6.287e-04, tol*||rhs|| = 7.369e-04

Anderson update took 91.599 ms, out of which F'*F took 43.109 ms; b-Ax took 292.938 ms, out of which Lap took 262.668 ms
Solving Poisson took 619.363 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.183666 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.091922 
Total time for convolution: 	 convolve: 5.115573 
Total time for convolution: 	 convolve: 5.093124 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.581 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 1.409 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.604 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.041 ms

This SCF took 27346.720 ms, scf error = 3.930e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.138319, lowerbound = -0.824183, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1697.910 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.376 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.326 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.723 ms
rank =  0, finding HY took 28.547 ms
rank =  0, distributing HY into block cyclic form took 17.427 ms
rank =  0, finding Y'*HY took 5.564 ms
Rank 0, Project_Hamiltonian used 73.291 ms
Total time for projection: 73.307 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.823760518647902
    last  calculated eigval = 0.038569067717939
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55677993918597
lambda[   5] =  -0.48787585771193
lambda[   6] =  -0.45239064948902
lambda[   7] =  -0.37422162560719
lambda[   8] =  -0.34045102008719
lambda[   9] =  -0.32765262832443
lambda[  10] =  -0.31211985169520
lambda[  11] =  -0.29347216011582
lambda[  12] =  -0.27076833577553
lambda[  13] =  -0.25326993384627
lambda[  14] =  -0.02403661497561
lambda[  15] =  -0.00229146183223
lambda[  16] =  -0.00203698424325
lambda[  17] =   0.01117809899203
lambda[  18] =   0.02189938138974
lambda[  19] =   0.02477954860859
lambda[  20] =   0.03856906771794
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 6.259 ms
rank =  0, Distributing orbital back into band + domain format took 17.592 ms
rank = 0, Subspace_Rotation used 23.864 ms

Total time for subspace rotation: 23.870 ms
rank = 0, Efermi =  -0.052763940968 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.125 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.752 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.239 ms
rank = 0, Calculating density took 1803.577 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.755 ms
rank = 0, D2D took 0.899 ms
rank = 0, Transfering density took 0.906 ms
Etot    =   -37.393768093384
Eband   =   -11.796380159628
E1      =    27.583115680125
E2      =   -10.477144682942
E3      =   -14.934061048277
Exc     =   -13.351211668888
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 6.802e-06, dEband = 1.094e-03
rank = 0, Calculating/Estimating energy took 1.520 ms, Etot = -37.393768093, dEtot = 6.802e-06, dEband = 1.094e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0456725365252, which took 0.054 ms

iter_count = 114, r_2norm = 1.259e-06, tol*||rhs|| = 1.827e-06

Anderson update took 59.717 ms, out of which F'*F took 28.309 ms; b-Ax took 192.350 ms, out of which Lap took 172.803 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 413.280 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247764, int_b + int_rho = -2.474e-13, checking this took 0.091 ms
2-norm of RHS = 736.9497537903400, which took 0.103 ms

iter_count = 156, r_2norm = 7.075e-04, tol*||rhs|| = 7.369e-04

Anderson update took 81.507 ms, out of which F'*F took 38.206 ms; b-Ax took 260.887 ms, out of which Lap took 233.956 ms
Solving Poisson took 554.649 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.250493 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.113654 
Total time for convolution: 	 convolve: 5.138895 
Total time for convolution: 	 convolve: 6.348876 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.768 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.748 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.394 ms
---Transfer Veff_loc: D2D took 1.411 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.609 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.050 ms

This SCF took 28650.067 ms, scf error = 2.877e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.138569, lowerbound = -0.823761, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1690.042 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.411 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.302 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.737 ms
rank =  0, finding HY took 28.605 ms
rank =  0, distributing HY into block cyclic form took 17.423 ms
rank =  0, finding Y'*HY took 5.518 ms
Rank 0, Project_Hamiltonian used 73.311 ms
Total time for projection: 73.323 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -0.823472777552612
    last  calculated eigval = 0.038654810396078
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55653672973270
lambda[   5] =  -0.48761354137391
lambda[   6] =  -0.45215006351642
lambda[   7] =  -0.37396468513095
lambda[   8] =  -0.34019861243553
lambda[   9] =  -0.32737841831499
lambda[  10] =  -0.31184848393044
lambda[  11] =  -0.29318901672948
lambda[  12] =  -0.27049514372574
lambda[  13] =  -0.25299385996679
lambda[  14] =  -0.02316699290859
lambda[  15] =  -0.00206994372730
lambda[  16] =  -0.00157780013435
lambda[  17] =   0.01170882000023
lambda[  18] =   0.02229170353619
lambda[  19] =   0.02485190113426
lambda[  20] =   0.03865481039608
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 6.371 ms
rank =  0, Distributing orbital back into band + domain format took 17.491 ms
rank = 0, Subspace_Rotation used 23.880 ms

Total time for subspace rotation: 23.885 ms
rank = 0, Efermi =  -0.051894318850 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 4.140 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.708 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.238 ms
rank = 0, Calculating density took 1795.694 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.769 ms
rank = 0, D2D took 0.921 ms
rank = 0, Transfering density took 0.928 ms
Etot    =   -37.393833548112
Eband   =   -11.789414610093
E1      =    27.579778720851
E2      =   -10.473369370852
E3      =   -14.934464440642
Exc     =   -13.351533794151
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 6.545e-06, dEband = 6.966e-04
rank = 0, Calculating/Estimating energy took 1.346 ms, Etot = -37.393833548, dEtot = 6.545e-06, dEband = 6.966e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0325504230238, which took 0.056 ms

iter_count = 114, r_2norm = 8.219e-07, tol*||rhs|| = 1.302e-06

Anderson update took 60.072 ms, out of which F'*F took 28.431 ms; b-Ax took 192.393 ms, out of which Lap took 172.531 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 413.016 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247762, int_b + int_rho = -2.656e-13, checking this took 0.092 ms
2-norm of RHS = 736.9554901414048, which took 0.075 ms

iter_count = 156, r_2norm = 6.794e-04, tol*||rhs|| = 7.370e-04

Anderson update took 81.550 ms, out of which F'*F took 38.490 ms; b-Ax took 262.741 ms, out of which Lap took 235.192 ms
Solving Poisson took 555.473 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.086228 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.147771 
Total time for convolution: 	 convolve: 5.142569 
Total time for convolution: 	 convolve: 5.100380 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
---Transfer Veff_loc: D2D took 1.403 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.640 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.072 ms

This SCF took 27258.920 ms, scf error = 2.184e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.138655, lowerbound = -0.823473, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1706.448 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.409 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.093 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.526 ms
rank =  0, finding HY took 28.598 ms
rank =  0, distributing HY into block cyclic form took 17.472 ms
rank =  0, finding Y'*HY took 5.491 ms
Rank 0, Project_Hamiltonian used 73.138 ms
Total time for projection: 73.156 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.823228669792989
    last  calculated eigval = 0.040098048566624
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55630433256566
lambda[   5] =  -0.48738430219135
lambda[   6] =  -0.45192961144898
lambda[   7] =  -0.37373609859910
lambda[   8] =  -0.33996830714614
lambda[   9] =  -0.32714182688752
lambda[  10] =  -0.31160953325414
lambda[  11] =  -0.29295456774981
lambda[  12] =  -0.27025567386038
lambda[  13] =  -0.25276008126094
lambda[  14] =  -0.02212018177179
lambda[  15] =  -0.00190021738845
lambda[  16] =  -0.00077617725918
lambda[  17] =   0.01213319111035
lambda[  18] =   0.02312906057224
lambda[  19] =   0.02505157001409
lambda[  20] =   0.04009804856662
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 6.354 ms
rank =  0, Distributing orbital back into band + domain format took 17.821 ms
rank = 0, Subspace_Rotation used 24.186 ms

Total time for subspace rotation: 24.192 ms
rank = 0, Efermi =  -0.050847507740 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.252 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.640 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.250 ms
rank = 0, Calculating density took 1812.273 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.843 ms
rank = 0, D2D took 0.967 ms
rank = 0, Transfering density took 0.972 ms
Etot    =   -37.393882366247
Eband   =   -11.783325555633
E1      =    27.576881797567
E2      =   -10.470057577021
E3      =   -14.934794560697
Exc     =   -13.351793069687
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 4.882e-06, dEband = 6.089e-04
rank = 0, Calculating/Estimating energy took 0.890 ms, Etot = -37.393882366, dEtot = 4.882e-06, dEband = 6.089e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0285387211778, which took 0.121 ms

iter_count = 108, r_2norm = 1.106e-06, tol*||rhs|| = 1.142e-06

Anderson update took 57.131 ms, out of which F'*F took 26.870 ms; b-Ax took 182.893 ms, out of which Lap took 164.573 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 392.642 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247764, int_b + int_rho = -2.437e-13, checking this took 0.137 ms
2-norm of RHS = 736.9565972460208, which took 0.114 ms

iter_count = 132, r_2norm = 6.283e-04, tol*||rhs|| = 7.370e-04

Anderson update took 69.070 ms, out of which F'*F took 32.353 ms; b-Ax took 221.375 ms, out of which Lap took 198.541 ms
Solving Poisson took 469.961 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.229410 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.144188 
Total time for convolution: 	 convolve: 5.104269 
Total time for convolution: 	 convolve: 5.166197 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 1.467 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.629 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.125 ms

This SCF took 27318.528 ms, scf error = 1.658e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.140098, lowerbound = -0.823229, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1692.123 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.468 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.275 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.767 ms
rank =  0, finding HY took 28.512 ms
rank =  0, distributing HY into block cyclic form took 17.319 ms
rank =  0, finding Y'*HY took 5.569 ms
Rank 0, Project_Hamiltonian used 73.195 ms
Total time for projection: 73.207 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -0.823146752859673
    last  calculated eigval = 0.041086632380009
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55621742114583
lambda[   5] =  -0.48730127798756
lambda[   6] =  -0.45184723767408
lambda[   7] =  -0.37365408168320
lambda[   8] =  -0.33988619854728
lambda[   9] =  -0.32705927001430
lambda[  10] =  -0.31152714119351
lambda[  11] =  -0.29287102403846
lambda[  12] =  -0.27017216790858
lambda[  13] =  -0.25267735875417
lambda[  14] =  -0.02184226066062
lambda[  15] =  -0.00187353400116
lambda[  16] =  -0.00047944020617
lambda[  17] =   0.01198533901372
lambda[  18] =   0.02343671897855
lambda[  19] =   0.02477916227080
lambda[  20] =   0.04108663238001
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 6.312 ms
rank =  0, Distributing orbital back into band + domain format took 17.727 ms
rank = 0, Subspace_Rotation used 24.051 ms

Total time for subspace rotation: 24.056 ms
rank = 0, Efermi =  -0.050569586627 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.144 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.873 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.226 ms
rank = 0, Calculating density took 1797.971 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.035 ms
======D2D: initiated sending and receiving took 0.856 ms
rank = 0, D2D took 0.978 ms
rank = 0, Transfering density took 0.980 ms
Etot    =   -37.393899302980
Eband   =   -11.781174745215
E1      =    27.575877897750
E2      =   -10.468892685700
E3      =   -14.934819705717
Exc     =   -13.351817170720
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 1.694e-06, dEband = 2.151e-04
rank = 0, Calculating/Estimating energy took 0.889 ms, Etot = -37.393899303, dEtot = 1.694e-06, dEband = 2.151e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0265399201697, which took 0.088 ms

iter_count = 108, r_2norm = 1.061e-06, tol*||rhs|| = 1.062e-06

Anderson update took 56.873 ms, out of which F'*F took 27.161 ms; b-Ax took 182.059 ms, out of which Lap took 163.482 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 391.820 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247762, int_b + int_rho = -2.692e-13, checking this took 0.116 ms
2-norm of RHS = 736.9555083317413, which took 0.111 ms

iter_count = 102, r_2norm = 7.313e-04, tol*||rhs|| = 7.370e-04

Anderson update took 53.490 ms, out of which F'*F took 25.228 ms; b-Ax took 171.654 ms, out of which Lap took 153.947 ms
Solving Poisson took 363.994 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.983 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.114286 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.086633 
Total time for convolution: 	 convolve: 5.124995 
Total time for convolution: 	 convolve: 5.081642 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 1.416 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.775 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.241 ms

This SCF took 27016.296 ms, scf error = 1.415e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.141087, lowerbound = -0.823147, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1689.246 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.501 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.263 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.790 ms
rank =  0, finding HY took 28.471 ms
rank =  0, distributing HY into block cyclic form took 17.476 ms
rank =  0, finding Y'*HY took 5.554 ms
Rank 0, Project_Hamiltonian used 73.318 ms
Total time for projection: 73.331 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -0.823094540894025
    last  calculated eigval = 0.041832296007095
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55617122026160
lambda[   5] =  -0.48725115143926
lambda[   6] =  -0.45179974749113
lambda[   7] =  -0.37360656688675
lambda[   8] =  -0.33984095182889
lambda[   9] =  -0.32700977271351
lambda[  10] =  -0.31147931522126
lambda[  11] =  -0.29282240534639
lambda[  12] =  -0.27012382249701
lambda[  13] =  -0.25262741542232
lambda[  14] =  -0.02158442078706
lambda[  15] =  -0.00184578580118
lambda[  16] =  -0.00021281864314
lambda[  17] =   0.01201648250142
lambda[  18] =   0.02364515055577
lambda[  19] =   0.02456158725599
lambda[  20] =   0.04183229600709
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 6.315 ms
rank =  0, Distributing orbital back into band + domain format took 17.872 ms
rank = 0, Subspace_Rotation used 24.199 ms

Total time for subspace rotation: 24.204 ms
rank = 0, Efermi =  -0.050311746793 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.271 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.734 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.325 ms
rank = 0, Calculating density took 1795.467 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.901 ms
rank = 0, D2D took 1.014 ms
rank = 0, Transfering density took 1.017 ms
Etot    =   -37.393907185553
Eband   =   -11.779901427297
E1      =    27.575205577990
E2      =   -10.468279898886
E3      =   -14.934862414759
Exc     =   -13.351855973679
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 7.883e-07, dEband = 1.273e-04
rank = 0, Calculating/Estimating energy took 0.899 ms, Etot = -37.393907186, dEtot = 7.883e-07, dEband = 1.273e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0245173505262, which took 0.052 ms

iter_count = 108, r_2norm = 7.843e-07, tol*||rhs|| = 9.807e-07

Anderson update took 56.682 ms, out of which F'*F took 26.892 ms; b-Ax took 182.779 ms, out of which Lap took 164.200 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 391.899 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247761, int_b + int_rho = -2.728e-13, checking this took 0.962 ms
2-norm of RHS = 736.9532582758017, which took 0.101 ms

iter_count = 120, r_2norm = 7.191e-04, tol*||rhs|| = 7.370e-04

Anderson update took 62.887 ms, out of which F'*F took 29.321 ms; b-Ax took 200.752 ms, out of which Lap took 180.180 ms
Solving Poisson took 427.771 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.138180 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 32.647 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.089136 
Total time for convolution: 	 convolve: 5.160296 
Total time for convolution: 	 convolve: 5.101643 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.410 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.604 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.048 ms

This SCF took 27148.294 ms, scf error = 1.243e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.141832, lowerbound = -0.823095, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1712.358 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 17.429 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.311 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.761 ms
rank =  0, finding HY took 28.533 ms
rank =  0, distributing HY into block cyclic form took 16.855 ms
rank =  0, finding Y'*HY took 7.297 ms
Rank 0, Project_Hamiltonian used 74.479 ms
Total time for projection: 74.493 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.142 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -0.823063259769577
    last  calculated eigval = 0.041928173717642
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55614763231135
lambda[   5] =  -0.48721905798828
lambda[   6] =  -0.45177250704280
lambda[   7] =  -0.37357782387654
lambda[   8] =  -0.33981606982804
lambda[   9] =  -0.32698059831648
lambda[  10] =  -0.31145277837434
lambda[  11] =  -0.29280851019291
lambda[  12] =  -0.27009816969520
lambda[  13] =  -0.25260171443067
lambda[  14] =  -0.02195748498565
lambda[  15] =  -0.00189362031286
lambda[  16] =  -0.00027417178435
lambda[  17] =   0.01149817560237
lambda[  18] =   0.02321560349404
lambda[  19] =   0.02388750807898
lambda[  20] =   0.04192817371764
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.239 ms
rank =  0, subspace rotation using ScaLAPACK took 6.415 ms
rank =  0, Distributing orbital back into band + domain format took 18.114 ms
rank = 0, Subspace_Rotation used 24.542 ms

Total time for subspace rotation: 24.547 ms
rank = 0, Efermi =  -0.050684810964 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.307 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.618 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.229 ms
rank = 0, Calculating density took 1819.902 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.803 ms
rank = 0, D2D took 0.933 ms
rank = 0, Transfering density took 0.935 ms
Etot    =   -37.393915906790
Eband   =   -11.779194579834
E1      =    27.574786742077
E2      =   -10.467997233062
E3      =   -14.934830139848
Exc     =   -13.351837765732
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 8.721e-07, dEband = 7.068e-05
rank = 0, Calculating/Estimating energy took 0.890 ms, Etot = -37.393915907, dEtot = 8.721e-07, dEband = 7.068e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0329123984624, which took 0.988 ms

iter_count = 102, r_2norm = 1.141e-06, tol*||rhs|| = 1.316e-06

Anderson update took 53.829 ms, out of which F'*F took 25.558 ms; b-Ax took 172.147 ms, out of which Lap took 153.898 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 372.022 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247752, int_b + int_rho = -3.602e-13, checking this took 0.128 ms
2-norm of RHS = 736.9513591470735, which took 0.130 ms

iter_count = 120, r_2norm = 6.710e-04, tol*||rhs|| = 7.370e-04

Anderson update took 62.817 ms, out of which F'*F took 33.421 ms; b-Ax took 207.248 ms, out of which Lap took 186.628 ms
Solving Poisson took 431.619 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.094991 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 42.810 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.116531 
Total time for convolution: 	 convolve: 5.140988 
Total time for convolution: 	 convolve: 5.117188 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.829 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
---Transfer Veff_loc: D2D took 1.398 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.669 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.096 ms

This SCF took 27138.688 ms, scf error = 1.033e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.141928, lowerbound = -0.823063, upperbound = 267.578898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1726.398 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.461 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.266 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.752 ms
rank =  0, finding HY took 28.436 ms
rank =  0, distributing HY into block cyclic form took 17.433 ms
rank =  0, finding Y'*HY took 5.512 ms
Rank 0, Project_Hamiltonian used 73.163 ms
Total time for projection: 73.175 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.823023715406768
    last  calculated eigval = 0.043673928298418
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55610687382910
lambda[   5] =  -0.48717623880750
lambda[   6] =  -0.45173220765035
lambda[   7] =  -0.37353490184805
lambda[   8] =  -0.33977411871343
lambda[   9] =  -0.32693937060791
lambda[  10] =  -0.31141345339871
lambda[  11] =  -0.29277561218665
lambda[  12] =  -0.27005833783937
lambda[  13] =  -0.25256246111855
lambda[  14] =  -0.02166739055120
lambda[  15] =  -0.00186095907745
lambda[  16] =   0.00022345588084
lambda[  17] =   0.01155960374710
lambda[  18] =   0.02328234014471
lambda[  19] =   0.02416062267870
lambda[  20] =   0.04367392829842
==subpsace eigenproblem: bcast eigvals took 0.037 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 6.430 ms
rank =  0, Distributing orbital back into band + domain format took 17.867 ms
rank = 0, Subspace_Rotation used 24.310 ms

Total time for subspace rotation: 24.315 ms
rank = 0, Efermi =  -0.050394716478 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.241 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.625 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.232 ms
rank = 0, Calculating density took 1832.329 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.834 ms
rank = 0, D2D took 0.997 ms
rank = 0, Transfering density took 0.999 ms
Etot    =   -37.393920987294
Eband   =   -11.778153467635
E1      =    27.574271274561
E2      =   -10.467478960701
E3      =   -14.934802069639
Exc     =   -13.351822148348
Esc     =   -65.240497675249
Entropy =    -0.000000000962
dE = 5.081e-07, dEband = 1.041e-04
rank = 0, Calculating/Estimating energy took 1.534 ms, Etot = -37.393920987, dEtot = 5.081e-07, dEband = 1.041e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0255923629616, which took 0.127 ms

iter_count = 108, r_2norm = 7.316e-07, tol*||rhs|| = 1.024e-06

Anderson update took 56.629 ms, out of which F'*F took 27.037 ms; b-Ax took 182.528 ms, out of which Lap took 164.217 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 392.005 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003247789, int_rho =  26.00000003247770, int_b + int_rho = -1.855e-13, checking this took 0.108 ms
2-norm of RHS = 736.9501003685172, which took 0.122 ms

iter_count = 72, r_2norm = 6.683e-04, tol*||rhs|| = 7.370e-04

Anderson update took 37.591 ms, out of which F'*F took 17.693 ms; b-Ax took 120.728 ms, out of which Lap took 108.058 ms
Solving Poisson took 258.177 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.139121 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.168947 
Total time for convolution: 	 convolve: 5.127569 
Total time for convolution: 	 convolve: 5.168893 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.750 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.364 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.429 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.817 ms

This SCF took 27104.745 ms, scf error = 9.547e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.55610687382910, occ[   4] =   2.00000000000000
lambda[   5] =  -0.48717623880750, occ[   5] =   2.00000000000000
lambda[   6] =  -0.45173220765035, occ[   6] =   2.00000000000000
lambda[   7] =  -0.37353490184805, occ[   7] =   2.00000000000000
lambda[   8] =  -0.33977411871343, occ[   8] =   2.00000000000000
lambda[   9] =  -0.32693937060791, occ[   9] =   2.00000000000000
lambda[  10] =  -0.31141345339871, occ[  10] =   2.00000000000000
lambda[  11] =  -0.29277561218665, occ[  11] =   2.00000000000000
lambda[  12] =  -0.27005833783937, occ[  12] =   2.00000000000000
lambda[  13] =  -0.25256246111855, occ[  13] =   2.00000000000000
lambda[  14] =  -0.02166739055120, occ[  14] =   0.00000003247763
lambda[  15] =  -0.00186095907745, occ[  15] =   0.00000000000000
lambda[  16] =   0.00022345588084, occ[  16] =   0.00000000000000
lambda[  17] =   0.01155960374710, occ[  17] =   0.00000000000000
lambda[  18] =   0.02328234014471, occ[  18] =   0.00000000000000
lambda[  19] =   0.02416062267870, occ[  19] =   0.00000000000000
lambda[  20] =   0.04367392829842, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.839 ms, time for Allreduce/Reduce: 11.091 ms 
Time for calculating local force components: 24.416 ms
Start Calculating nonlocal forces
force_nloc = 
  0.02504370295426  -0.03744219349995  -0.02543253423255
  0.02504369605995  -0.03744220878374   0.02543252346045
  0.00015652906056   0.04555244555891   0.02486624636032
  0.00015653544877   0.04555244324525  -0.02486626311210
 -0.01301010418286  -0.05035041832359   0.00000000546873
 -0.03749254955822  -0.13062312922621  -0.00000050471092
 -0.02125732057355   0.01855924223673  -0.00000003346266
  0.10531634982273   0.03620386281085  -0.13494061475874
  0.10531697010633   0.03620411353537   0.13494025690037
 -0.72602376846666   0.57553742895043   0.00000010268941
force_loc = 
 -0.02577443114923   0.03879570062004   0.02607593660543
 -0.02577450279949   0.03879597258295  -0.02607604692223
 -0.00006061574902  -0.04713000087057  -0.02555851680887
 -0.00006074452370  -0.04712984731246   0.02555840152006
  0.01360314352427   0.05245561621367  -0.00000000580957
  0.03917419513413   0.12457407775643  -0.00000057728762
 -0.00580186182321   0.00360446085066  -0.00000037623676
 -0.10318701489294  -0.03516460497776   0.13174458727172
 -0.10318601284228  -0.03516400728451  -0.13174449049722
  0.72892442672225  -0.57780455450279  -0.00000117770766
Time for calculating nonlocal force components: 40.566 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00066904707724   0.00457816993989  -0.00000003432745
[0m[32m  0.01431368477612  -0.01162483588571  -0.00000001030937
[0m[32m -0.00321743237867  -0.00120495766715   0.00375047371750
[0m[32m -0.00321739305609  -0.00120491653446  -0.00375048096287
[0m[32m  0.01028601971356  -0.00812814323600  -0.00000003681244
[0mTime for calculating XC forces components: 35.938 ms
 Cartesian force = 
 -0.00072478303540   0.00135353550046   0.00064371936938
 -0.00072486157997   0.00135379217958  -0.00064320646527
  0.00010185847112  -0.00157752693129  -0.00069195345205
  0.00010173608464  -0.00157737568684   0.00069245540447
  0.00059898450099   0.00210522627045   0.00000031665566
  0.00235663781273  -0.00147085314951  -0.00000079932949
 -0.01273955246107   0.01053889558205  -0.00000010301228
 -0.00108215228930  -0.00016567145369   0.00055476322699
 -0.00108049063247  -0.00016478190323  -0.00055439756322
  0.01319262312873  -0.01039524040799  -0.00000079483419
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Time for printing density: 378.765 ms
The program took 532.451 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:07
Job ID:        2266759
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:48:24,vmem=8448K,walltime=00:09:02,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-004-2-2
---------------------------------------
