---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:33
Job ID:    2266660
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:37
Job ID:    2266660
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.105 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.036 ms

Set default values took 0.005 ms
Reading input file sprc-calc.inpt

Reading input file took 8.486 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 14.238 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 94.290 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.960 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.084 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   12.558383	    7.770023	   10.000000	
    7.441617	   12.229977	   10.000000	
   12.588870	    5.954387	   10.000000	
    7.411130	   14.045613	   10.000000	
    8.972099	    7.889119	   11.678028	
    8.972099	    7.889119	    8.321972	
   11.027901	   12.110881	   11.678028	
   11.027901	   12.110881	    8.321972	
   10.000000	   11.437263	   10.000000	
   10.000000	    8.562737	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.163 ms
Set up communicators.

--set up spincomm took 2.239 ms

--set up kptcomm took 0.337 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.018 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.008 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.065 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.456 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.374 ms

Calculate_SplineDerivRadFun took 0.210 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.271 ms.
time spent on vectorized spline interp: 3.244 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.002 ms.
time spent on vectorized spline interp: 1.393 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.334 ms.
time spent on vectorized spline interp: 1.761 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.307 ms.

Calculating rb for all atom types took 16.322 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.816 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000257519, sum_int_rho = 25.4033317237493
PosCharge = 26.000000025752, NegCharge = -25.403331723749, scal_fac = 1.023487797132
After scaling, int_rho = 26.0000000257518, PosCharge + NegCharge - NetCharge = 1.172e-13
--Calculate Vref took 0.474 ms
--Calculate rho_guess took 2.782 ms

 integral of b = -26.0000000257519,
 int{b} + Nelectron + NetCharge = -2.575e-08,
 Esc = -77.4562132672912,
 MPI_Reduce took 10.623 ms

Calculating b & b_ref took 20.212 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.037 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.048 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.790 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575180, int_b + int_rho = -4.002e-14, checking this took 0.087 ms
2-norm of RHS = 770.0494514441292, which took 0.467 ms

iter_count = 414, r_2norm = 7.517e-04, tol*||rhs|| = 7.700e-04

Anderson update took 251.245 ms, out of which F'*F took 115.336 ms; b-Ax took 787.533 ms, out of which Lap took 701.236 ms
Solving Poisson took 1741.325 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.343 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.825 ms
Total time for convolution: 	 convolve: 5.130424 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 54.413 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
Total time for convolution: 	 convolve: 5.130332 
Total time for convolution: 	 convolve: 5.134675 
Total time for convolution: 	 convolve: 5.121861 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.928 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.521 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
rank = 0, XC calculation took 24464.140 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 2.162 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.070 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.345 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.145 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.915 ms
    Lanczos iter 53, eigmin  = -1.013979039, eigmax = 264.926267935, err_eigmin = 6.040e-04, err_eigmax = 9.677e-03
rank =   0, Lanczos took 140.320 ms, eigmin = -1.013979039078, eigmax = 267.575530614660

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.230776, lowerbound = -1.113979, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2027.972 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 23.263 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.093 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.414 ms
rank =  0, Distribute data + matrix mult took 27.791 ms
rank =  0, finding HY took 34.167 ms
rank =  0, distributing HY into block cyclic form took 21.801 ms
rank =  0, finding Y'*HY took 6.128 ms
Rank 0, Project_Hamiltonian used 90.771 ms
Total time for projection: 90.782 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.848 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.949 ms
    first calculated eigval = 2.726876690953097
    last  calculated eigval = 3.242999806923269
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.80782415439404
lambda[   5] =   2.86062331711171
lambda[   6] =   2.89797685542604
lambda[   7] =   2.92892353182209
lambda[   8] =   2.93787243010489
lambda[   9] =   2.94060554010212
lambda[  10] =   2.98326839054617
lambda[  11] =   3.00047861269665
lambda[  12] =   3.02716084854345
lambda[  13] =   3.06483369104575
lambda[  14] =   3.08647463723834
lambda[  15] =   3.10020837865612
lambda[  16] =   3.13360234137930
lambda[  17] =   3.14901190812256
lambda[  18] =   3.16419086416154
lambda[  19] =   3.17939820218039
lambda[  20] =   3.24299980692327
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.962 ms
rank =  0, subspace rotation using ScaLAPACK took 4.876 ms
rank =  0, Distributing orbital back into band + domain format took 21.264 ms
rank = 0, Subspace_Rotation used 26.156 ms

Total time for subspace rotation: 26.161 ms
rank = 0, Efermi =   3.075654099272 calculate fermi energy took 0.112 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.343000, lowerbound = -1.113979, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2045.702 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.012 ms
rank =  0, Distribute orbital to block cyclic format took 20.664 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.208 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.018 ms
rank =  0, Distribute data + matrix mult took 24.907 ms
rank =  0, finding HY took 33.890 ms
rank =  0, distributing HY into block cyclic form took 20.749 ms
rank =  0, finding Y'*HY took 5.707 ms
Rank 0, Project_Hamiltonian used 85.294 ms
Total time for projection: 85.299 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.907155843207935
    last  calculated eigval = 0.445021656542407
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.32626810458597
lambda[   5] =  -0.19743905875302
lambda[   6] =  -0.18638719602876
lambda[   7] =  -0.15747789590026
lambda[   8] =  -0.05131008083695
lambda[   9] =   0.08418529833429
lambda[  10] =   0.10113919057704
lambda[  11] =   0.16333295780079
lambda[  12] =   0.25278580555477
lambda[  13] =   0.29464501542998
lambda[  14] =   0.31194607640016
lambda[  15] =   0.33319876617264
lambda[  16] =   0.35122722220638
lambda[  17] =   0.35340953249274
lambda[  18] =   0.38039749738632
lambda[  19] =   0.42934660411397
lambda[  20] =   0.44502165654241
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 4.517 ms
rank =  0, Distributing orbital back into band + domain format took 21.584 ms
rank = 0, Subspace_Rotation used 26.116 ms

Total time for subspace rotation: 26.122 ms
rank = 0, Efermi =   0.303295546137 calculate fermi energy took 0.048 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.545022, lowerbound = -1.113979, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1998.948 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 20.471 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.900 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 24.405 ms
rank =  0, finding HY took 33.753 ms
rank =  0, distributing HY into block cyclic form took 20.705 ms
rank =  0, finding Y'*HY took 5.760 ms
Rank 0, Project_Hamiltonian used 85.624 ms
Total time for projection: 85.629 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -1.019531834649980
    last  calculated eigval = 0.156907317871687
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.64669381070606
lambda[   5] =  -0.56219632185378
lambda[   6] =  -0.51843036416408
lambda[   7] =  -0.51429449940358
lambda[   8] =  -0.45693635327673
lambda[   9] =  -0.43379396727664
lambda[  10] =  -0.39581085419010
lambda[  11] =  -0.33913731037154
lambda[  12] =  -0.28214085539051
lambda[  13] =  -0.25674650115880
lambda[  14] =   0.07017940522723
lambda[  15] =   0.08888157252560
lambda[  16] =   0.09321105412489
lambda[  17] =   0.10994870185296
lambda[  18] =   0.11605721171399
lambda[  19] =   0.13661990862563
lambda[  20] =   0.15690731787169
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 4.514 ms
rank =  0, Distributing orbital back into band + domain format took 21.767 ms
rank = 0, Subspace_Rotation used 26.297 ms

Total time for subspace rotation: 26.302 ms
rank = 0, Efermi =   0.041241165036 calculate fermi energy took 0.037 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.256907, lowerbound = -1.113979, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2024.909 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 25.344 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.230 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 29.608 ms
rank =  0, finding HY took 33.658 ms
rank =  0, distributing HY into block cyclic form took 20.724 ms
rank =  0, finding Y'*HY took 5.718 ms
Rank 0, Project_Hamiltonian used 89.744 ms
Total time for projection: 89.759 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -1.019778624801282
    last  calculated eigval = 0.091011533006460
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.64872509389366
lambda[   5] =  -0.56595667623899
lambda[   6] =  -0.52578713126140
lambda[   7] =  -0.51722269626375
lambda[   8] =  -0.46143307936314
lambda[   9] =  -0.44196778699265
lambda[  10] =  -0.40156205414644
lambda[  11] =  -0.37471763402340
lambda[  12] =  -0.31598526525765
lambda[  13] =  -0.31307223645905
lambda[  14] =   0.00590797207337
lambda[  15] =   0.02917508445046
lambda[  16] =   0.04164601234792
lambda[  17] =   0.04596759455445
lambda[  18] =   0.05881310240583
lambda[  19] =   0.07933584026980
lambda[  20] =   0.09101153300646
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 4.641 ms
rank =  0, Distributing orbital back into band + domain format took 21.615 ms
rank = 0, Subspace_Rotation used 27.100 ms

Total time for subspace rotation: 27.108 ms
rank = 0, Efermi =  -0.023030268113 calculate fermi energy took 0.715 ms
rank = 0, --- Calculate rho: sum over local bands took 4.864 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.485 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.329 ms
rank = 0, Calculating density took 8707.475 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.754 ms
rank = 0, D2D took 2.927 ms
rank = 0, Transfering density took 2.936 ms
Etot    =   -48.767658732878
Eband   =   -14.732237030138
E1      =    29.245707638434
E2      =   -12.345740215256
E3      =   -16.149983127675
Exc     =   -14.320639416045
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 4.877e+00, dEband = 1.473e+00
rank = 0, Calculating/Estimating energy took 1.832 ms, Etot = -48.767658733, dEtot = 4.877e+00, dEband = 1.473e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 70.6311261862644, which took 0.059 ms

iter_count = 90, r_2norm = 2.656e-03, tol*||rhs|| = 2.825e-03

Anderson update took 56.590 ms, out of which F'*F took 26.747 ms; b-Ax took 178.202 ms, out of which Lap took 160.358 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 388.920 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575180, int_b + int_rho = -3.638e-14, checking this took 0.110 ms
2-norm of RHS = 765.8923148380346, which took 0.165 ms

iter_count = 282, r_2norm = 6.940e-04, tol*||rhs|| = 7.659e-04

Anderson update took 175.285 ms, out of which F'*F took 79.886 ms; b-Ax took 529.379 ms, out of which Lap took 476.428 ms
Solving Poisson took 1173.041 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.832 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.159611 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.382 ms
Total time for convolution: 	 convolve: 5.097135 
Total time for convolution: 	 convolve: 5.091627 
Total time for convolution: 	 convolve: 5.108475 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.333 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.263 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.472 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.756 ms

This SCF took 34690.659 ms, scf error = 1.470e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.191012, lowerbound = -1.019779, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2076.259 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.805 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.188 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.024 ms
rank =  0, finding HY took 33.801 ms
rank =  0, distributing HY into block cyclic form took 20.785 ms
rank =  0, finding Y'*HY took 6.445 ms
Rank 0, Project_Hamiltonian used 86.091 ms
Total time for projection: 86.108 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.994149835623812
    last  calculated eigval = 0.059783974923210
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62031183435830
lambda[   5] =  -0.54263475669218
lambda[   6] =  -0.50092874122331
lambda[   7] =  -0.49216293999667
lambda[   8] =  -0.43359326147567
lambda[   9] =  -0.41664287427688
lambda[  10] =  -0.37157200591716
lambda[  11] =  -0.34708512053807
lambda[  12] =  -0.28918637848397
lambda[  13] =  -0.28465082862022
lambda[  14] =  -0.02358909190116
lambda[  15] =  -0.01354883485116
lambda[  16] =   0.01912049021891
lambda[  17] =   0.02522067032181
lambda[  18] =   0.03028505225595
lambda[  19] =   0.05160326400608
lambda[  20] =   0.05978397492321
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 4.987 ms
rank =  0, Distributing orbital back into band + domain format took 23.983 ms
rank = 0, Subspace_Rotation used 28.991 ms

Total time for subspace rotation: 28.998 ms
rank = 0, Efermi =  -0.052527334316 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.267 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.766 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.401 ms
rank = 0, Calculating density took 2201.913 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.885 ms
rank = 0, D2D took 1.002 ms
rank = 0, Transfering density took 1.007 ms
Etot    =   -48.727071632862
Eband   =   -14.037018860647
E1      =    28.654628425223
E2      =   -12.244198118334
E3      =   -16.339260739317
Exc     =   -14.471926787030
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 4.059e-03, dEband = 6.952e-02
rank = 0, Calculating/Estimating energy took 0.984 ms, Etot = -48.727071633, dEtot = 4.059e-03, dEband = 6.952e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 22.0561695004046, which took 0.069 ms

iter_count = 102, r_2norm = 5.977e-04, tol*||rhs|| = 8.822e-04

Anderson update took 68.603 ms, out of which F'*F took 31.076 ms; b-Ax took 196.369 ms, out of which Lap took 180.211 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 441.866 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575179, int_b + int_rho = -5.093e-14, checking this took 0.153 ms
2-norm of RHS = 760.9214964090645, which took 0.161 ms

iter_count = 300, r_2norm = 6.263e-04, tol*||rhs|| = 7.609e-04

Anderson update took 180.363 ms, out of which F'*F took 84.208 ms; b-Ax took 565.363 ms, out of which Lap took 502.549 ms
Solving Poisson took 1241.436 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.087844 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.087406 
Total time for convolution: 	 convolve: 5.086694 
Total time for convolution: 	 convolve: 5.089600 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 15.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.267 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.453 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.741 ms

This SCF took 28248.713 ms, scf error = 1.012e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.159784, lowerbound = -0.994150, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2010.237 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 31.537 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.640 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 36.199 ms
rank =  0, finding HY took 34.218 ms
rank =  0, distributing HY into block cyclic form took 21.579 ms
rank =  0, finding Y'*HY took 6.550 ms
Rank 0, Project_Hamiltonian used 98.580 ms
Total time for projection: 98.595 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.956093381520041
    last  calculated eigval = 0.050191295802294
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56846894669899
lambda[   5] =  -0.50506204821431
lambda[   6] =  -0.45335983889445
lambda[   7] =  -0.45072435329909
lambda[   8] =  -0.38792512303585
lambda[   9] =  -0.36967590554814
lambda[  10] =  -0.32631062826412
lambda[  11] =  -0.30023147166555
lambda[  12] =  -0.24590050424305
lambda[  13] =  -0.24097501321009
lambda[  14] =  -0.03218525238760
lambda[  15] =  -0.02105196117147
lambda[  16] =   0.01275244031130
lambda[  17] =   0.01650798058275
lambda[  18] =   0.02153846505067
lambda[  19] =   0.03495052972829
lambda[  20] =   0.05019129580229
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 8.750 ms
rank =  0, Distributing orbital back into band + domain format took 20.464 ms
rank = 0, Subspace_Rotation used 29.239 ms

Total time for subspace rotation: 29.247 ms
rank = 0, Efermi =  -0.061123492976 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.229 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.973 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.451 ms
rank = 0, Calculating density took 2148.816 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 0.803 ms
rank = 0, D2D took 0.951 ms
rank = 0, Transfering density took 0.958 ms
Etot    =   -48.689815811147
Eband   =   -12.884256216332
E1      =    27.724430304933
E2      =   -11.988444925046
E3      =   -16.690125630410
Exc     =   -14.752347187145
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 3.726e-03, dEband = 1.153e-01
rank = 0, Calculating/Estimating energy took 1.001 ms, Etot = -48.689815811, dEtot = 3.726e-03, dEband = 1.153e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.6249866994917, which took 0.081 ms

iter_count = 102, r_2norm = 2.267e-04, tol*||rhs|| = 3.050e-04

Anderson update took 68.005 ms, out of which F'*F took 30.438 ms; b-Ax took 194.269 ms, out of which Lap took 176.587 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.124 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575170, int_b + int_rho = -1.382e-13, checking this took 0.150 ms
2-norm of RHS = 762.0021820969780, which took 0.197 ms

iter_count = 276, r_2norm = 6.278e-04, tol*||rhs|| = 7.620e-04

Anderson update took 174.383 ms, out of which F'*F took 78.423 ms; b-Ax took 513.710 ms, out of which Lap took 463.304 ms
Solving Poisson took 1148.968 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.960560 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.093560 
Total time for convolution: 	 convolve: 5.084568 
Total time for convolution: 	 convolve: 5.088403 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 1.304 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.349 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.677 ms

This SCF took 29260.582 ms, scf error = 3.406e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.150191, lowerbound = -0.956093, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1994.229 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.744 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.338 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.112 ms
rank =  0, finding HY took 32.517 ms
rank =  0, distributing HY into block cyclic form took 20.791 ms
rank =  0, finding Y'*HY took 5.894 ms
Rank 0, Project_Hamiltonian used 84.344 ms
Total time for projection: 84.357 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.624 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.723 ms
    first calculated eigval = -0.954551221234474
    last  calculated eigval = 0.048025186629948
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55671034158207
lambda[   5] =  -0.49960568239961
lambda[   6] =  -0.44447507881150
lambda[   7] =  -0.44013207132222
lambda[   8] =  -0.38207940208473
lambda[   9] =  -0.35825208520985
lambda[  10] =  -0.32367271163243
lambda[  11] =  -0.29270655352767
lambda[  12] =  -0.24055084505775
lambda[  13] =  -0.23830811176484
lambda[  14] =  -0.03518167746883
lambda[  15] =  -0.02077990644537
lambda[  16] =   0.01100604969321
lambda[  17] =   0.01307868952001
lambda[  18] =   0.01554813196632
lambda[  19] =   0.02830085184298
lambda[  20] =   0.04802518662995
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.737 ms
rank =  0, subspace rotation using ScaLAPACK took 8.148 ms
rank =  0, Distributing orbital back into band + domain format took 20.743 ms
rank = 0, Subspace_Rotation used 28.904 ms

Total time for subspace rotation: 28.910 ms
rank = 0, Efermi =  -0.064119917633 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.656 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.946 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.605 ms
rank = 0, Calculating density took 2119.332 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.159 ms
rank = 0, D2D took 1.328 ms
rank = 0, Transfering density took 1.337 ms
Etot    =   -48.685783669713
Eband   =   -12.713685720188
E1      =    27.644497454451
E2      =   -11.887154260011
E3      =   -16.749932932828
Exc     =   -14.797469328757
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 4.032e-04, dEband = 1.706e-02
rank = 0, Calculating/Estimating energy took 1.031 ms, Etot = -48.685783670, dEtot = 4.032e-04, dEband = 1.706e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.0253662994815, which took 0.062 ms

iter_count = 108, r_2norm = 8.472e-05, tol*||rhs|| = 1.210e-04

Anderson update took 65.608 ms, out of which F'*F took 30.882 ms; b-Ax took 206.822 ms, out of which Lap took 184.618 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.870 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575182, int_b + int_rho = -1.455e-14, checking this took 0.119 ms
2-norm of RHS = 762.1378358831345, which took 0.203 ms

iter_count = 252, r_2norm = 6.346e-04, tol*||rhs|| = 7.621e-04

Anderson update took 150.333 ms, out of which F'*F took 71.718 ms; b-Ax took 478.267 ms, out of which Lap took 426.003 ms
Solving Poisson took 1053.775 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.089970 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
Total time for convolution: 	 convolve: 5.093995 
Total time for convolution: 	 convolve: 5.085946 
Total time for convolution: 	 convolve: 5.087477 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.526 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 1.309 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 2.552 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.890 ms

This SCF took 27999.856 ms, scf error = 1.055e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.148025, lowerbound = -0.954551, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2023.727 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.859 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.487 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 25.274 ms
rank =  0, finding HY took 32.602 ms
rank =  0, distributing HY into block cyclic form took 20.811 ms
rank =  0, finding Y'*HY took 5.935 ms
Rank 0, Project_Hamiltonian used 84.654 ms
Total time for projection: 84.675 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.950270040532468
    last  calculated eigval = 0.047148096391521
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55218160457382
lambda[   5] =  -0.49544963247193
lambda[   6] =  -0.44022329777253
lambda[   7] =  -0.43539128622247
lambda[   8] =  -0.37799353058379
lambda[   9] =  -0.35353695806908
lambda[  10] =  -0.31929774754754
lambda[  11] =  -0.28843385799941
lambda[  12] =  -0.23590413319711
lambda[  13] =  -0.23378360613246
lambda[  14] =  -0.03588610228174
lambda[  15] =  -0.02038991926143
lambda[  16] =   0.00987701628916
lambda[  17] =   0.01148433205884
lambda[  18] =   0.01298756529518
lambda[  19] =   0.02558012941129
lambda[  20] =   0.04714809639152
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 8.149 ms
rank =  0, Distributing orbital back into band + domain format took 20.751 ms
rank = 0, Subspace_Rotation used 28.915 ms

Total time for subspace rotation: 28.920 ms
rank = 0, Efermi =  -0.064824342426 calculate fermi energy took 2.153 ms
rank = 0, --- Calculate rho: sum over local bands took 5.713 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.449 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.340 ms
rank = 0, Calculating density took 2148.237 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.094 ms
rank = 0, D2D took 1.247 ms
rank = 0, Transfering density took 1.255 ms
Etot    =   -48.684919094430
Eband   =   -12.599175356541
E1      =    27.579925860110
E2      =   -11.830350518314
E3      =   -16.780592564723
Exc     =   -14.820399412977
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 8.646e-05, dEband = 1.145e-02
rank = 0, Calculating/Estimating energy took 1.035 ms, Etot = -48.684919094, dEtot = 8.646e-05, dEband = 1.145e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8482097229104, which took 0.091 ms

iter_count = 114, r_2norm = 2.383e-05, tol*||rhs|| = 3.393e-05

Anderson update took 72.445 ms, out of which F'*F took 32.776 ms; b-Ax took 214.284 ms, out of which Lap took 193.346 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.102 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575168, int_b + int_rho = -1.601e-13, checking this took 0.155 ms
2-norm of RHS = 762.4654441145157, which took 0.145 ms

iter_count = 246, r_2norm = 7.327e-04, tol*||rhs|| = 7.625e-04

Anderson update took 145.290 ms, out of which F'*F took 69.876 ms; b-Ax took 472.384 ms, out of which Lap took 421.574 ms
Solving Poisson took 1024.088 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.236 ms
Total time for convolution: 	 convolve: 5.081615 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.373 ms
Total time for convolution: 	 convolve: 5.084195 
Total time for convolution: 	 convolve: 5.092820 
Total time for convolution: 	 convolve: 5.081900 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.587 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.526 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.698 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.913 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.645 ms

This SCF took 27983.815 ms, scf error = 6.105e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.147148, lowerbound = -0.950270, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2010.926 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.797 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.339 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.164 ms
rank =  0, finding HY took 32.641 ms
rank =  0, distributing HY into block cyclic form took 20.778 ms
rank =  0, finding Y'*HY took 5.922 ms
Rank 0, Project_Hamiltonian used 84.538 ms
Total time for projection: 84.551 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.213 ms
    first calculated eigval = -0.946682300099314
    last  calculated eigval = 0.046752354731688
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54917750769199
lambda[   5] =  -0.49225901546303
lambda[   6] =  -0.43706300555369
lambda[   7] =  -0.43212983020833
lambda[   8] =  -0.37492210455314
lambda[   9] =  -0.35024537756151
lambda[  10] =  -0.31599188159662
lambda[  11] =  -0.28543568162877
lambda[  12] =  -0.23244893182714
lambda[  13] =  -0.23033083589994
lambda[  14] =  -0.03600461546501
lambda[  15] =  -0.02005748869089
lambda[  16] =   0.00949475023837
lambda[  17] =   0.01131679498400
lambda[  18] =   0.01298828668555
lambda[  19] =   0.02388106912351
lambda[  20] =   0.04675235473169
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 1.531 ms
rank =  0, subspace rotation using ScaLAPACK took 8.251 ms
rank =  0, Distributing orbital back into band + domain format took 20.667 ms
rank = 0, Subspace_Rotation used 28.933 ms

Total time for subspace rotation: 28.939 ms
rank = 0, Efermi =  -0.064942855663 calculate fermi energy took 0.093 ms
rank = 0, --- Calculate rho: sum over local bands took 5.397 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.736 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.384 ms
rank = 0, Calculating density took 2135.616 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.069 ms
rank = 0, D2D took 1.236 ms
rank = 0, Transfering density took 1.240 ms
Etot    =   -48.684433677112
Eband   =   -12.514460433927
E1      =    27.545032637954
E2      =   -11.776470019399
E3      =   -16.794472033888
Exc     =   -14.829734666366
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 4.854e-05, dEband = 8.471e-03
rank = 0, Calculating/Estimating energy took 1.168 ms, Etot = -48.684433677, dEtot = 4.854e-05, dEband = 8.471e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3815174327372, which took 0.067 ms

iter_count = 114, r_2norm = 1.030e-05, tol*||rhs|| = 1.526e-05

Anderson update took 66.874 ms, out of which F'*F took 31.898 ms; b-Ax took 217.179 ms, out of which Lap took 191.727 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.108 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575170, int_b + int_rho = -1.346e-13, checking this took 0.117 ms
2-norm of RHS = 762.6544255898591, which took 0.118 ms

iter_count = 246, r_2norm = 7.558e-04, tol*||rhs|| = 7.627e-04

Anderson update took 144.815 ms, out of which F'*F took 69.449 ms; b-Ax took 459.197 ms, out of which Lap took 406.632 ms
Solving Poisson took 1032.913 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.094470 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.083067 
Total time for convolution: 	 convolve: 5.091456 
Total time for convolution: 	 convolve: 5.089388 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.204 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.029 ms
---Transfer Veff_loc: D2D took 2.536 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.946 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.521 ms

This SCF took 28180.011 ms, scf error = 2.988e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.146752, lowerbound = -0.946682, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2053.120 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.859 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.314 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.203 ms
rank =  0, finding HY took 32.570 ms
rank =  0, distributing HY into block cyclic form took 20.822 ms
rank =  0, finding Y'*HY took 5.954 ms
Rank 0, Project_Hamiltonian used 84.578 ms
Total time for projection: 84.591 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.942429342048151
    last  calculated eigval = 0.046892477436148
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54445574066596
lambda[   5] =  -0.48792576035639
lambda[   6] =  -0.43287730986655
lambda[   7] =  -0.42720310727393
lambda[   8] =  -0.37006062460470
lambda[   9] =  -0.34562988321247
lambda[  10] =  -0.31163454037271
lambda[  11] =  -0.28076111501619
lambda[  12] =  -0.22820973287675
lambda[  13] =  -0.22619491422517
lambda[  14] =  -0.03562072970690
lambda[  15] =  -0.01926927500159
lambda[  16] =   0.01050835646203
lambda[  17] =   0.01307686316798
lambda[  18] =   0.01548914054889
lambda[  19] =   0.02353258383991
lambda[  20] =   0.04689247743615
==subpsace eigenproblem: bcast eigvals took 0.076 ms
Total time for solving subspace eigenvalue problem: 0.268 ms
rank =  0, subspace rotation using ScaLAPACK took 8.124 ms
rank =  0, Distributing orbital back into band + domain format took 20.663 ms
rank = 0, Subspace_Rotation used 28.802 ms

Total time for subspace rotation: 28.808 ms
rank = 0, Efermi =  -0.064558969855 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.386 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.748 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.439 ms
rank = 0, Calculating density took 2176.476 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.081 ms
rank = 0, D2D took 1.251 ms
rank = 0, Transfering density took 1.254 ms
Etot    =   -48.684080093237
Eband   =   -12.397458098086
E1      =    27.486702619924
E2      =   -11.713958416927
E3      =   -16.808947005530
Exc     =   -14.840016769473
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 3.536e-05, dEband = 1.170e-02
rank = 0, Calculating/Estimating energy took 1.137 ms, Etot = -48.684080093, dEtot = 3.536e-05, dEband = 1.170e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2815002512086, which took 0.060 ms

iter_count = 114, r_2norm = 7.087e-06, tol*||rhs|| = 1.126e-05

Anderson update took 68.743 ms, out of which F'*F took 31.484 ms; b-Ax took 243.340 ms, out of which Lap took 219.732 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 509.414 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575174, int_b + int_rho = -1.019e-13, checking this took 0.138 ms
2-norm of RHS = 762.6572568366058, which took 0.135 ms

iter_count = 222, r_2norm = 7.048e-04, tol*||rhs|| = 7.627e-04

Anderson update took 130.634 ms, out of which F'*F took 60.534 ms; b-Ax took 415.096 ms, out of which Lap took 366.639 ms
Solving Poisson took 925.921 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.104476 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.104847 
Total time for convolution: 	 convolve: 5.103182 
Total time for convolution: 	 convolve: 5.083827 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.019 ms
======D2D: initiated sending and receiving took 1.165 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.696 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.907 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.639 ms

This SCF took 28167.348 ms, scf error = 1.433e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.146892, lowerbound = -0.942429, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2075.537 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.854 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.293 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.178 ms
rank =  0, finding HY took 32.521 ms
rank =  0, distributing HY into block cyclic form took 20.799 ms
rank =  0, finding Y'*HY took 6.086 ms
Rank 0, Project_Hamiltonian used 84.614 ms
Total time for projection: 84.629 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.940986909132212
    last  calculated eigval = 0.046612765912062
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54317023450351
lambda[   5] =  -0.48656594217352
lambda[   6] =  -0.43152135024399
lambda[   7] =  -0.42589162799247
lambda[   8] =  -0.36872335247057
lambda[   9] =  -0.34429413549531
lambda[  10] =  -0.31009473878065
lambda[  11] =  -0.27940396807316
lambda[  12] =  -0.22672401482288
lambda[  13] =  -0.22468556840818
lambda[  14] =  -0.03451620023571
lambda[  15] =  -0.01791181238714
lambda[  16] =   0.01218443276263
lambda[  17] =   0.01510094627005
lambda[  18] =   0.01709722981822
lambda[  19] =   0.02457071177406
lambda[  20] =   0.04661276591206
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 8.161 ms
rank =  0, Distributing orbital back into band + domain format took 20.549 ms
rank = 0, Subspace_Rotation used 28.727 ms

Total time for subspace rotation: 28.733 ms
rank = 0, Efermi =  -0.063454440436 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.351 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.731 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.406 ms
rank = 0, Calculating density took 2198.726 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.312 ms
rank = 0, D2D took 1.442 ms
rank = 0, Transfering density took 1.445 ms
Etot    =   -48.684097396355
Eband   =   -12.361376135073
E1      =    27.471079233078
E2      =   -11.693205588171
E3      =   -16.809457171106
Exc     =   -14.840249985577
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 1.730e-06, dEband = 3.608e-03
rank = 0, Calculating/Estimating energy took 1.881 ms, Etot = -48.684097396, dEtot = 1.730e-06, dEband = 3.608e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1513615449023, which took 0.069 ms

iter_count = 114, r_2norm = 4.388e-06, tol*||rhs|| = 6.054e-06

Anderson update took 66.745 ms, out of which F'*F took 31.626 ms; b-Ax took 215.616 ms, out of which Lap took 191.217 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.801 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575185, int_b + int_rho = 7.276e-15, checking this took 0.125 ms
2-norm of RHS = 762.6437220186612, which took 0.155 ms

iter_count = 216, r_2norm = 6.411e-04, tol*||rhs|| = 7.626e-04

Anderson update took 126.704 ms, out of which F'*F took 58.764 ms; b-Ax took 401.571 ms, out of which Lap took 355.892 ms
Solving Poisson took 896.465 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.103462 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.391 ms
Total time for convolution: 	 convolve: 5.088399 
Total time for convolution: 	 convolve: 5.087597 
Total time for convolution: 	 convolve: 5.093867 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.777 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.524 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.720 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.953 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.711 ms

This SCF took 27997.492 ms, scf error = 1.039e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.146613, lowerbound = -0.940987, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2032.745 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.797 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.278 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.105 ms
rank =  0, finding HY took 32.535 ms
rank =  0, distributing HY into block cyclic form took 20.698 ms
rank =  0, finding Y'*HY took 5.950 ms
Rank 0, Project_Hamiltonian used 84.314 ms
Total time for projection: 84.334 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -0.939886737712522
    last  calculated eigval = 0.046489861458047
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54174674955202
lambda[   5] =  -0.48531845620799
lambda[   6] =  -0.43027638392880
lambda[   7] =  -0.42440009616510
lambda[   8] =  -0.36744304067407
lambda[   9] =  -0.34288539908448
lambda[  10] =  -0.30885243763612
lambda[  11] =  -0.27804582500250
lambda[  12] =  -0.22543990084283
lambda[  13] =  -0.22348698010632
lambda[  14] =  -0.03226386280539
lambda[  15] =  -0.01544553750437
lambda[  16] =   0.01516660259891
lambda[  17] =   0.01783585594111
lambda[  18] =   0.01911904330111
lambda[  19] =   0.02632356449093
lambda[  20] =   0.04648986145805
==subpsace eigenproblem: bcast eigvals took 0.083 ms
Total time for solving subspace eigenvalue problem: 0.277 ms
rank =  0, subspace rotation using ScaLAPACK took 8.173 ms
rank =  0, Distributing orbital back into band + domain format took 20.505 ms
rank = 0, Subspace_Rotation used 28.693 ms

Total time for subspace rotation: 28.700 ms
rank = 0, Efermi =  -0.061202103007 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 5.390 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.921 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.460 ms
rank = 0, Calculating density took 2155.948 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 2.474 ms
rank = 0, D2D took 2.575 ms
rank = 0, Transfering density took 2.580 ms
Etot    =   -48.684096315627
Eband   =   -12.327797806082
E1      =    27.454085418579
E2      =   -11.676103213392
E3      =   -16.812014535424
Exc     =   -14.842288408882
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 1.081e-07, dEband = 3.358e-03
rank = 0, Calculating/Estimating energy took 1.207 ms, Etot = -48.684096316, dEtot = 1.081e-07, dEband = 3.358e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1087771843544, which took 0.059 ms

iter_count = 108, r_2norm = 4.252e-06, tol*||rhs|| = 4.351e-06

Anderson update took 63.499 ms, out of which F'*F took 30.092 ms; b-Ax took 203.545 ms, out of which Lap took 180.156 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.534 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575169, int_b + int_rho = -1.455e-13, checking this took 0.124 ms
2-norm of RHS = 762.6348556431202, which took 0.150 ms

iter_count = 210, r_2norm = 6.265e-04, tol*||rhs|| = 7.626e-04

Anderson update took 123.444 ms, out of which F'*F took 57.182 ms; b-Ax took 392.003 ms, out of which Lap took 345.986 ms
Solving Poisson took 875.099 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.137 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.085564 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.092237 
Total time for convolution: 	 convolve: 5.098938 
Total time for convolution: 	 convolve: 5.091965 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.709 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.916 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.660 ms

This SCF took 27842.657 ms, scf error = 6.458e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.146490, lowerbound = -0.939887, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2028.717 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.793 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.256 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.080 ms
rank =  0, finding HY took 32.711 ms
rank =  0, distributing HY into block cyclic form took 20.765 ms
rank =  0, finding Y'*HY took 5.927 ms
Rank 0, Project_Hamiltonian used 84.513 ms
Total time for projection: 84.525 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.938387978033230
    last  calculated eigval = 0.045969113483029
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54026658699096
lambda[   5] =  -0.48385931813152
lambda[   6] =  -0.42883460612882
lambda[   7] =  -0.42284851456907
lambda[   8] =  -0.36594395844960
lambda[   9] =  -0.34137845496035
lambda[  10] =  -0.30743472312852
lambda[  11] =  -0.27659225659478
lambda[  12] =  -0.22399750039244
lambda[  13] =  -0.22204349793666
lambda[  14] =  -0.02856270438468
lambda[  15] =  -0.01200109720306
lambda[  16] =   0.01879201498649
lambda[  17] =   0.01998149997109
lambda[  18] =   0.02035202843785
lambda[  19] =   0.02742125375112
lambda[  20] =   0.04596911348303
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 8.124 ms
rank =  0, Distributing orbital back into band + domain format took 20.643 ms
rank = 0, Subspace_Rotation used 28.781 ms

Total time for subspace rotation: 28.787 ms
rank = 0, Efermi =  -0.057500944559 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.689 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.452 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.404 ms
rank = 0, Calculating density took 2151.934 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.087 ms
rank = 0, D2D took 1.273 ms
rank = 0, Transfering density took 1.282 ms
Etot    =   -48.684230250280
Eband   =   -12.289372160382
E1      =    27.433916371223
E2      =   -11.657163810625
E3      =   -16.814984954128
Exc     =   -14.844709957815
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 1.339e-05, dEband = 3.843e-03
rank = 0, Calculating/Estimating energy took 1.111 ms, Etot = -48.684230250, dEtot = 1.339e-05, dEband = 3.843e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0934707656944, which took 0.061 ms

iter_count = 108, r_2norm = 3.077e-06, tol*||rhs|| = 3.739e-06

Anderson update took 63.893 ms, out of which F'*F took 30.122 ms; b-Ax took 204.085 ms, out of which Lap took 180.947 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.714 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575185, int_b + int_rho = 7.276e-15, checking this took 0.141 ms
2-norm of RHS = 762.6597122551892, which took 0.118 ms

iter_count = 186, r_2norm = 6.180e-04, tol*||rhs|| = 7.627e-04

Anderson update took 109.423 ms, out of which F'*F took 50.768 ms; b-Ax took 346.267 ms, out of which Lap took 307.140 ms
Solving Poisson took 772.537 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.085423 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.097120 
Total time for convolution: 	 convolve: 5.090884 
Total time for convolution: 	 convolve: 5.088580 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.557 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.748 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.930 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.714 ms

This SCF took 27731.827 ms, scf error = 3.657e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.145969, lowerbound = -0.938388, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2001.705 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.835 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.237 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.103 ms
rank =  0, finding HY took 32.564 ms
rank =  0, distributing HY into block cyclic form took 20.794 ms
rank =  0, finding Y'*HY took 5.872 ms
Rank 0, Project_Hamiltonian used 84.361 ms
Total time for projection: 84.374 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.164 ms
    first calculated eigval = -0.938147013576617
    last  calculated eigval = 0.044574495156172
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53999288500150
lambda[   5] =  -0.48358899611131
lambda[   6] =  -0.42857440288548
lambda[   7] =  -0.42254206261551
lambda[   8] =  -0.36570009578390
lambda[   9] =  -0.34109366333784
lambda[  10] =  -0.30721784088570
lambda[  11] =  -0.27634637433219
lambda[  12] =  -0.22375695472693
lambda[  13] =  -0.22182166482066
lambda[  14] =  -0.02714986443567
lambda[  15] =  -0.01137807755282
lambda[  16] =   0.01940563834101
lambda[  17] =   0.01979222895865
lambda[  18] =   0.01989517622439
lambda[  19] =   0.02698420739171
lambda[  20] =   0.04457449515617
==subpsace eigenproblem: bcast eigvals took 0.060 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 9.021 ms
rank =  0, Distributing orbital back into band + domain format took 19.969 ms
rank = 0, Subspace_Rotation used 29.028 ms

Total time for subspace rotation: 29.037 ms
rank = 0, Efermi =  -0.056088104587 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.502 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.815 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.271 ms
rank = 0, Calculating density took 2125.858 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.901 ms
rank = 0, D2D took 1.006 ms
rank = 0, Transfering density took 1.012 ms
Etot    =   -48.684349921883
Eband   =   -12.282726691069
E1      =    27.431770789725
E2      =   -11.652677610398
E3      =   -16.814483469407
Exc     =   -14.844341832285
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 1.197e-05, dEband = 6.645e-04
rank = 0, Calculating/Estimating energy took 1.004 ms, Etot = -48.684349922, dEtot = 1.197e-05, dEband = 6.645e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0699871901022, which took 0.064 ms

iter_count = 108, r_2norm = 1.988e-06, tol*||rhs|| = 2.799e-06

Anderson update took 63.289 ms, out of which F'*F took 30.224 ms; b-Ax took 203.660 ms, out of which Lap took 180.476 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.001 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575184, int_b + int_rho = 3.638e-15, checking this took 0.137 ms
2-norm of RHS = 762.6656384829728, which took 0.141 ms

iter_count = 174, r_2norm = 6.352e-04, tol*||rhs|| = 7.627e-04

Anderson update took 101.978 ms, out of which F'*F took 47.528 ms; b-Ax took 325.479 ms, out of which Lap took 287.284 ms
Solving Poisson took 725.598 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.085170 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
Total time for convolution: 	 convolve: 5.089342 
Total time for convolution: 	 convolve: 5.093759 
Total time for convolution: 	 convolve: 5.086187 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.738 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.943 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.721 ms

This SCF took 27762.242 ms, scf error = 3.165e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.144574, lowerbound = -0.938147, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2017.560 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.812 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.281 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.125 ms
rank =  0, finding HY took 32.588 ms
rank =  0, distributing HY into block cyclic form took 20.652 ms
rank =  0, finding Y'*HY took 6.040 ms
Rank 0, Project_Hamiltonian used 84.434 ms
Total time for projection: 84.449 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.937789215298943
    last  calculated eigval = 0.044904231023467
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53962786664552
lambda[   5] =  -0.48322819894630
lambda[   6] =  -0.42821905174928
lambda[   7] =  -0.42217225774440
lambda[   8] =  -0.36532814128699
lambda[   9] =  -0.34073274205654
lambda[  10] =  -0.30683669605711
lambda[  11] =  -0.27597883358687
lambda[  12] =  -0.22339569006254
lambda[  13] =  -0.22145633056884
lambda[  14] =  -0.02340243400326
lambda[  15] =  -0.00992445038924
lambda[  16] =   0.02117643096346
lambda[  17] =   0.02187369701715
lambda[  18] =   0.02295356836656
lambda[  19] =   0.02784660795739
lambda[  20] =   0.04490423102347
==subpsace eigenproblem: bcast eigvals took 0.079 ms
Total time for solving subspace eigenvalue problem: 0.272 ms
rank =  0, subspace rotation using ScaLAPACK took 8.687 ms
rank =  0, Distributing orbital back into band + domain format took 20.499 ms
rank = 0, Subspace_Rotation used 29.205 ms

Total time for subspace rotation: 29.213 ms
rank = 0, Efermi =  -0.052340674157 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 5.422 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.917 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.409 ms
rank = 0, Calculating density took 2141.762 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.925 ms
rank = 0, D2D took 1.024 ms
rank = 0, Transfering density took 1.026 ms
Etot    =   -48.684394242008
Eband   =   -12.273224987073
E1      =    27.427016097509
E2      =   -11.647762015263
E3      =   -16.815156655489
Exc     =   -14.844890755136
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 4.432e-06, dEband = 9.502e-04
rank = 0, Calculating/Estimating energy took 0.999 ms, Etot = -48.684394242, dEtot = 4.432e-06, dEband = 9.502e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0596451953193, which took 0.062 ms

iter_count = 108, r_2norm = 1.828e-06, tol*||rhs|| = 2.386e-06

Anderson update took 63.201 ms, out of which F'*F took 30.109 ms; b-Ax took 204.351 ms, out of which Lap took 181.039 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.407 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575176, int_b + int_rho = -8.004e-14, checking this took 0.128 ms
2-norm of RHS = 762.6619873799367, which took 0.108 ms

iter_count = 138, r_2norm = 7.041e-04, tol*||rhs|| = 7.627e-04

Anderson update took 80.336 ms, out of which F'*F took 37.344 ms; b-Ax took 257.016 ms, out of which Lap took 227.185 ms
Solving Poisson took 573.725 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.089771 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.092501 
Total time for convolution: 	 convolve: 5.103239 
Total time for convolution: 	 convolve: 5.098373 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.345 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.172 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.698 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.923 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.659 ms

This SCF took 27537.268 ms, scf error = 2.318e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.144904, lowerbound = -0.937789, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1991.692 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.813 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.277 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 25.123 ms
rank =  0, finding HY took 32.583 ms
rank =  0, distributing HY into block cyclic form took 20.719 ms
rank =  0, finding Y'*HY took 6.043 ms
Rank 0, Project_Hamiltonian used 84.496 ms
Total time for projection: 84.511 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.634 ms
rank = 0, Solve_Generalized_EigenProblem used 1.530 ms
    first calculated eigval = -0.937603229427775
    last  calculated eigval = 0.043995711302278
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53944872346012
lambda[   5] =  -0.48305215314022
lambda[   6] =  -0.42804375936929
lambda[   7] =  -0.42199508966012
lambda[   8] =  -0.36514087404602
lambda[   9] =  -0.34055623306248
lambda[  10] =  -0.30664949048583
lambda[  11] =  -0.27579940505347
lambda[  12] =  -0.22321712739374
lambda[  13] =  -0.22127100006523
lambda[  14] =  -0.02276958206140
lambda[  15] =  -0.00976270660068
lambda[  16] =   0.02145875268852
lambda[  17] =   0.02213822590551
lambda[  18] =   0.02298689625571
lambda[  19] =   0.02804039009640
lambda[  20] =   0.04399571130228
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.549 ms
rank =  0, subspace rotation using ScaLAPACK took 8.176 ms
rank =  0, Distributing orbital back into band + domain format took 20.749 ms
rank = 0, Subspace_Rotation used 28.946 ms

Total time for subspace rotation: 28.953 ms
rank = 0, Efermi =  -0.051707822219 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 5.397 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.757 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.448 ms
rank = 0, Calculating density took 2116.444 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.062 ms
rank = 0, D2D took 1.233 ms
rank = 0, Transfering density took 1.239 ms
Etot    =   -48.684416289670
Eband   =   -12.268510684803
E1      =    27.424311361380
E2      =   -11.645617776479
E3      =   -16.815710028173
Exc     =   -14.845331502840
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 2.205e-06, dEband = 4.714e-04
rank = 0, Calculating/Estimating energy took 1.215 ms, Etot = -48.684416290, dEtot = 2.205e-06, dEband = 4.714e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0435941001860, which took 0.059 ms

iter_count = 108, r_2norm = 1.424e-06, tol*||rhs|| = 1.744e-06

Anderson update took 63.788 ms, out of which F'*F took 29.907 ms; b-Ax took 203.100 ms, out of which Lap took 179.766 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.061 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575177, int_b + int_rho = -6.548e-14, checking this took 0.126 ms
2-norm of RHS = 762.6668756686581, which took 0.141 ms

iter_count = 150, r_2norm = 7.553e-04, tol*||rhs|| = 7.627e-04

Anderson update took 88.604 ms, out of which F'*F took 40.874 ms; b-Ax took 280.620 ms, out of which Lap took 247.690 ms
Solving Poisson took 626.639 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.086254 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.411 ms
Total time for convolution: 	 convolve: 5.087978 
Total time for convolution: 	 convolve: 5.098102 
Total time for convolution: 	 convolve: 5.086536 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.412 ms
---Transfer Veff_loc: D2D took 1.733 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.919 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.688 ms

This SCF took 27544.055 ms, scf error = 1.631e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.143996, lowerbound = -0.937603, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2012.447 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.777 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.300 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.117 ms
rank =  0, finding HY took 33.139 ms
rank =  0, distributing HY into block cyclic form took 20.854 ms
rank =  0, finding Y'*HY took 5.859 ms
Rank 0, Project_Hamiltonian used 85.030 ms
Total time for projection: 85.051 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.937542992371693
    last  calculated eigval = 0.044009361613446
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53937071557645
lambda[   5] =  -0.48298158812032
lambda[   6] =  -0.42797262902567
lambda[   7] =  -0.42191640020822
lambda[   8] =  -0.36508357993408
lambda[   9] =  -0.34047783322324
lambda[  10] =  -0.30658641491280
lambda[  11] =  -0.27573437066809
lambda[  12] =  -0.22314479505100
lambda[  13] =  -0.22120507675392
lambda[  14] =  -0.02364754522155
lambda[  15] =  -0.01112908448993
lambda[  16] =   0.02085497586058
lambda[  17] =   0.02184273391677
lambda[  18] =   0.02199885329644
lambda[  19] =   0.02938843000536
lambda[  20] =   0.04400936161345
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 8.177 ms
rank =  0, Distributing orbital back into band + domain format took 20.584 ms
rank = 0, Subspace_Rotation used 28.775 ms

Total time for subspace rotation: 28.780 ms
rank = 0, Efermi =  -0.052585785490 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.287 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.838 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.415 ms
rank = 0, Calculating density took 2136.147 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.116 ms
rank = 0, D2D took 1.289 ms
rank = 0, Transfering density took 1.298 ms
Etot    =   -48.684462072750
Eband   =   -12.266738483621
E1      =    27.423813900728
E2      =   -11.644357580341
E3      =   -16.815451203486
Exc     =   -14.845133005624
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 4.578e-06, dEband = 1.772e-04
rank = 0, Calculating/Estimating energy took 1.059 ms, Etot = -48.684462073, dEtot = 4.578e-06, dEband = 1.772e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0447345043798, which took 0.157 ms

iter_count = 108, r_2norm = 1.448e-06, tol*||rhs|| = 1.789e-06

Anderson update took 63.281 ms, out of which F'*F took 30.114 ms; b-Ax took 204.482 ms, out of which Lap took 181.206 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.031 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575174, int_b + int_rho = -1.019e-13, checking this took 0.129 ms
2-norm of RHS = 762.6695943578574, which took 0.114 ms

iter_count = 78, r_2norm = 7.027e-04, tol*||rhs|| = 7.627e-04

Anderson update took 45.587 ms, out of which F'*F took 21.219 ms; b-Ax took 145.511 ms, out of which Lap took 128.489 ms
Solving Poisson took 326.633 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.169 ms
Total time for convolution: 	 convolve: 5.090580 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.089013 
Total time for convolution: 	 convolve: 5.099462 
Total time for convolution: 	 convolve: 5.099333 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.716 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.919 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.671 ms

This SCF took 27277.019 ms, scf error = 1.800e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.144009, lowerbound = -0.937543, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2045.075 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.780 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.291 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.099 ms
rank =  0, finding HY took 32.556 ms
rank =  0, distributing HY into block cyclic form took 20.684 ms
rank =  0, finding Y'*HY took 6.018 ms
Rank 0, Project_Hamiltonian used 84.389 ms
Total time for projection: 84.410 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.937538040230183
    last  calculated eigval = 0.042681914854429
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53936189821008
lambda[   5] =  -0.48297417917330
lambda[   6] =  -0.42796615073561
lambda[   7] =  -0.42190480693579
lambda[   8] =  -0.36507504393444
lambda[   9] =  -0.34046853480894
lambda[  10] =  -0.30658102715464
lambda[  11] =  -0.27572557235063
lambda[  12] =  -0.22313860155391
lambda[  13] =  -0.22120087316030
lambda[  14] =  -0.02377436674141
lambda[  15] =  -0.01104323180916
lambda[  16] =   0.02077406789915
lambda[  17] =   0.02165096031102
lambda[  18] =   0.02181521746587
lambda[  19] =   0.02895499198904
lambda[  20] =   0.04268191485443
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 8.126 ms
rank =  0, Distributing orbital back into band + domain format took 20.488 ms
rank = 0, Subspace_Rotation used 28.628 ms

Total time for subspace rotation: 28.634 ms
rank = 0, Efermi =  -0.052712606983 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.381 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.839 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.405 ms
rank = 0, Calculating density took 2168.506 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.058 ms
rank = 0, D2D took 1.231 ms
rank = 0, Transfering density took 1.239 ms
Etot    =   -48.684463453077
Eband   =   -12.266545000080
E1      =    27.423802000947
E2      =   -11.644165621688
E3      =   -16.815448758038
Exc     =   -14.845121565611
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 1.380e-07, dEband = 1.935e-05
rank = 0, Calculating/Estimating energy took 1.079 ms, Etot = -48.684463453, dEtot = 1.380e-07, dEband = 1.935e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0419814609712, which took 0.057 ms

iter_count = 108, r_2norm = 1.430e-06, tol*||rhs|| = 1.679e-06

Anderson update took 63.329 ms, out of which F'*F took 30.098 ms; b-Ax took 203.707 ms, out of which Lap took 180.853 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.514 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575176, int_b + int_rho = -8.004e-14, checking this took 0.130 ms
2-norm of RHS = 762.6631605939181, which took 0.144 ms

iter_count = 78, r_2norm = 7.019e-04, tol*||rhs|| = 7.627e-04

Anderson update took 45.849 ms, out of which F'*F took 21.199 ms; b-Ax took 145.732 ms, out of which Lap took 128.640 ms
Solving Poisson took 327.313 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.082239 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.087981 
Total time for convolution: 	 convolve: 5.093744 
Total time for convolution: 	 convolve: 5.082365 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 1.727 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.337 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.575 ms

This SCF took 27301.854 ms, scf error = 1.909e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.142682, lowerbound = -0.937538, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2049.617 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.777 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.296 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.103 ms
rank =  0, finding HY took 32.681 ms
rank =  0, distributing HY into block cyclic form took 20.748 ms
rank =  0, finding Y'*HY took 5.928 ms
Rank 0, Project_Hamiltonian used 84.497 ms
Total time for projection: 84.516 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.937493953225083
    last  calculated eigval = 0.042085322620340
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53933709209154
lambda[   5] =  -0.48294294196931
lambda[   6] =  -0.42793565605073
lambda[   7] =  -0.42188448847348
lambda[   8] =  -0.36503682823027
lambda[   9] =  -0.34044608937010
lambda[  10] =  -0.30654718667421
lambda[  11] =  -0.27569678070762
lambda[  12] =  -0.22311142479386
lambda[  13] =  -0.22116527207091
lambda[  14] =  -0.02381973092723
lambda[  15] =  -0.01127481045671
lambda[  16] =   0.02076033004032
lambda[  17] =   0.02153269165600
lambda[  18] =   0.02164073151092
lambda[  19] =   0.02907745315203
lambda[  20] =   0.04208532262034
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 8.121 ms
rank =  0, Distributing orbital back into band + domain format took 20.661 ms
rank = 0, Subspace_Rotation used 28.798 ms

Total time for subspace rotation: 28.804 ms
rank = 0, Efermi =  -0.052757971166 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.309 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.834 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.440 ms
rank = 0, Calculating density took 2172.848 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.153 ms
rank = 0, D2D took 1.343 ms
rank = 0, Transfering density took 1.350 ms
Etot    =   -48.684464050316
Eband   =   -12.265718318850
E1      =    27.422966898068
E2      =   -11.644123296601
E3      =   -16.815737967259
Exc     =   -14.845360625336
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 5.972e-08, dEband = 8.267e-05
rank = 0, Calculating/Estimating energy took 1.125 ms, Etot = -48.684464050, dEtot = 5.972e-08, dEband = 8.267e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0349508251111, which took 0.061 ms

iter_count = 108, r_2norm = 1.122e-06, tol*||rhs|| = 1.398e-06

Anderson update took 63.539 ms, out of which F'*F took 30.043 ms; b-Ax took 204.084 ms, out of which Lap took 181.050 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.305 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575170, int_b + int_rho = -1.382e-13, checking this took 0.077 ms
2-norm of RHS = 762.6678928051285, which took 0.151 ms

iter_count = 126, r_2norm = 7.571e-04, tol*||rhs|| = 7.627e-04

Anderson update took 73.838 ms, out of which F'*F took 34.530 ms; b-Ax took 234.739 ms, out of which Lap took 208.154 ms
Solving Poisson took 524.289 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.142794 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.104537 
Total time for convolution: 	 convolve: 5.100080 
Total time for convolution: 	 convolve: 5.092441 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 1.838 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.952 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.829 ms

This SCF took 27580.231 ms, scf error = 1.317e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.142085, lowerbound = -0.937494, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2037.298 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.843 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.243 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.115 ms
rank =  0, finding HY took 32.653 ms
rank =  0, distributing HY into block cyclic form took 22.854 ms
rank =  0, finding Y'*HY took 4.495 ms
Rank 0, Project_Hamiltonian used 85.147 ms
Total time for projection: 85.165 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -0.937441941051494
    last  calculated eigval = 0.042425193976894
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53927438133594
lambda[   5] =  -0.48288350201702
lambda[   6] =  -0.42787877549524
lambda[   7] =  -0.42182029988997
lambda[   8] =  -0.36497901044755
lambda[   9] =  -0.34038615407308
lambda[  10] =  -0.30650139472538
lambda[  11] =  -0.27564077275737
lambda[  12] =  -0.22306303021047
lambda[  13] =  -0.22112064158465
lambda[  14] =  -0.02325637926288
lambda[  15] =  -0.01114901066728
lambda[  16] =   0.02146879002964
lambda[  17] =   0.02156820289999
lambda[  18] =   0.02165239647394
lambda[  19] =   0.03009373180947
lambda[  20] =   0.04242519397689
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 8.229 ms
rank =  0, Distributing orbital back into band + domain format took 20.563 ms
rank = 0, Subspace_Rotation used 28.809 ms

Total time for subspace rotation: 28.815 ms
rank = 0, Efermi =  -0.052194619551 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.328 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.869 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.415 ms
rank = 0, Calculating density took 2161.213 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.038 ms
rank = 0, D2D took 1.228 ms
rank = 0, Transfering density took 1.235 ms
Etot    =   -48.684465761834
Eband   =   -12.264268094215
E1      =    27.422456347894
E2      =   -11.643174075254
E3      =   -16.815712507194
Exc     =   -14.845327329902
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 1.712e-07, dEband = 1.450e-04
rank = 0, Calculating/Estimating energy took 1.127 ms, Etot = -48.684465762, dEtot = 1.712e-07, dEband = 1.450e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0307314564981, which took 0.950 ms

iter_count = 108, r_2norm = 1.055e-06, tol*||rhs|| = 1.229e-06

Anderson update took 64.090 ms, out of which F'*F took 30.375 ms; b-Ax took 204.251 ms, out of which Lap took 181.219 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.899 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575191, int_b + int_rho = 6.912e-14, checking this took 0.124 ms
2-norm of RHS = 762.6653398016457, which took 0.067 ms

iter_count = 120, r_2norm = 7.452e-04, tol*||rhs|| = 7.627e-04

Anderson update took 69.737 ms, out of which F'*F took 33.185 ms; b-Ax took 226.352 ms, out of which Lap took 199.808 ms
Solving Poisson took 503.398 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.148483 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.140902 
Total time for convolution: 	 convolve: 5.137704 
Total time for convolution: 	 convolve: 5.137533 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.547 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 1.760 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.955 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.753 ms

This SCF took 27683.474 ms, scf error = 1.471e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.142425, lowerbound = -0.937442, upperbound = 267.575531

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2054.110 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.987 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.285 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 25.304 ms
rank =  0, finding HY took 32.531 ms
rank =  0, distributing HY into block cyclic form took 20.861 ms
rank =  0, finding Y'*HY took 5.806 ms
Rank 0, Project_Hamiltonian used 84.535 ms
Total time for projection: 84.552 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.937279468345833
    last  calculated eigval = 0.043873054471878
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53912464798646
lambda[   5] =  -0.48273131269221
lambda[   6] =  -0.42772872470676
lambda[   7] =  -0.42167298359895
lambda[   8] =  -0.36481907005937
lambda[   9] =  -0.34023977981219
lambda[  10] =  -0.30635151112080
lambda[  11] =  -0.27549115905278
lambda[  12] =  -0.22291869491036
lambda[  13] =  -0.22097026825358
lambda[  14] =  -0.02290360768157
lambda[  15] =  -0.01127048140796
lambda[  16] =   0.02163678745935
lambda[  17] =   0.02179537423151
lambda[  18] =   0.02191097904728
lambda[  19] =   0.03186600187409
lambda[  20] =   0.04387305447188
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 8.345 ms
rank =  0, Distributing orbital back into band + domain format took 20.467 ms
rank = 0, Subspace_Rotation used 28.826 ms

Total time for subspace rotation: 28.832 ms
rank = 0, Efermi =  -0.051841848033 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.367 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.724 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.410 ms
rank = 0, Calculating density took 2177.336 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.042 ms
rank = 0, D2D took 2.545 ms
rank = 0, Transfering density took 2.552 ms
Etot    =   -48.684476300259
Eband   =   -12.260301433813
E1      =    27.420198062183
E2      =   -11.641349336851
E3      =   -16.816167364963
Exc     =   -14.845676362384
Esc     =   -77.456213267291
Entropy =    -0.000000000768
dE = 1.054e-06, dEband = 3.967e-04
rank = 0, Calculating/Estimating energy took 1.031 ms, Etot = -48.684476300, dEtot = 1.054e-06, dEband = 3.967e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0236108786409, which took 0.063 ms

iter_count = 102, r_2norm = 9.355e-07, tol*||rhs|| = 9.444e-07

Anderson update took 59.492 ms, out of which F'*F took 28.572 ms; b-Ax took 194.587 ms, out of which Lap took 173.680 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.012 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002575184, int_rho =  26.00000002575186, int_b + int_rho = 2.183e-14, checking this took 0.140 ms
2-norm of RHS = 762.6706123729032, which took 0.167 ms

iter_count = 132, r_2norm = 7.482e-04, tol*||rhs|| = 7.627e-04

Anderson update took 76.726 ms, out of which F'*F took 36.516 ms; b-Ax took 249.631 ms, out of which Lap took 220.251 ms
Solving Poisson took 549.361 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.145 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.183827 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.144160 
Total time for convolution: 	 convolve: 5.162902 
Total time for convolution: 	 convolve: 5.153043 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.705 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 1.542 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.444 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.008 ms

This SCF took 27772.994 ms, scf error = 9.337e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.53912464798646, occ[   4] =   2.00000000000000
lambda[   5] =  -0.48273131269221, occ[   5] =   2.00000000000000
lambda[   6] =  -0.42772872470676, occ[   6] =   2.00000000000000
lambda[   7] =  -0.42167298359895, occ[   7] =   2.00000000000000
lambda[   8] =  -0.36481907005937, occ[   8] =   2.00000000000000
lambda[   9] =  -0.34023977981219, occ[   9] =   2.00000000000000
lambda[  10] =  -0.30635151112080, occ[  10] =   2.00000000000000
lambda[  11] =  -0.27549115905278, occ[  11] =   2.00000000000000
lambda[  12] =  -0.22291869491036, occ[  12] =   2.00000000000000
lambda[  13] =  -0.22097026825358, occ[  13] =   2.00000000000000
lambda[  14] =  -0.02290360768157, occ[  14] =   0.00000002575176
lambda[  15] =  -0.01127048140796, occ[  15] =   0.00000000000001
lambda[  16] =   0.02163678745935, occ[  16] =   0.00000000000000
lambda[  17] =   0.02179537423151, occ[  17] =   0.00000000000000
lambda[  18] =   0.02191097904728, occ[  18] =   0.00000000000000
lambda[  19] =   0.03186600187409, occ[  19] =   0.00000000000000
lambda[  20] =   0.04387305447188, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.530 ms, time for Allreduce/Reduce: 11.678 ms 
Time for calculating local force components: 21.820 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.82078926060201  -0.66767832270503  -0.00000042910259
  0.82079030226460   0.66767863481143  -0.00000045503755
 -0.00392354329205   0.07452340189322  -0.00000000183904
  0.00392355623587  -0.07452338492136  -0.00000001003439
  0.02512429981991   0.01564830278353  -0.03983762055501
  0.02512426689550   0.01564833695512   0.03983756669389
 -0.02512425201652  -0.01564830860934  -0.03983760903538
 -0.02512428070830  -0.01564835095767   0.03983763205232
 -0.17132357505781   0.04337445531367   0.00000028583117
  0.17132443682770  -0.04337349811913  -0.00000078757304
force_loc = 
  0.80101609716224   0.64636707384104  -0.00000020075500
 -0.80101554391837  -0.64636701372459   0.00000119598360
  0.00478935882603  -0.07670437818648   0.00000012222940
 -0.00478936306363   0.07670557496516   0.00000011032816
 -0.02505168768098  -0.01640748715588   0.04133707475590
 -0.02505103466332  -0.01640783516282  -0.04133664716103
  0.02505115168376   0.01640735300878   0.04133649467920
  0.02505127202467   0.01640791622098  -0.04133688106188
  0.16932211963148  -0.04390888220226   0.00000056080043
 -0.16932138735520   0.04390947809476  -0.00000050146281
Time for calculating nonlocal force components: 49.749 ms
[32mforces_xc: 
[0m[32m  0.02661536392623   0.01942326279571   0.00000001691952
[0m[32m -0.02661537215411  -0.01942330289396   0.00000005938811
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00883403534568  -0.00184153793224   0.00000001751029
[0m[32m -0.00883409118871   0.00184155920887  -0.00000002149205
[0mTime for calculating XC forces components: 29.799 ms
 Cartesian force = 
  0.00684191359219  -0.00188829080043  -0.00000061014429
 -0.00684090070215   0.00188801346073   0.00000080312794
  0.00086552863971  -0.00218128102541   0.00000012318414
 -0.00086609372202   0.00218188531165   0.00000010308755
  0.00007232524466  -0.00075948910450   0.00149945699467
  0.00007294533791  -0.00075980293985  -0.00149907767336
 -0.00007338722702   0.00075873966729   0.00149888843760
 -0.00007329557790   0.00075926053116  -0.00149924621579
  0.00683229302508  -0.00237626955299   0.00000086693567
 -0.00683132861047   0.00237723445235  -0.00000130773412
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.392 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Time for printing density: 375.879 ms
The program took 536.602 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:35
Job ID:        2266660
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:52:24,vmem=8308K,walltime=00:09:22,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-15-1
---------------------------------------
