---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:53
Job ID:    2266890
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:58
Job ID:    2266890
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 29.317 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 9.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 8.180 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 170.942 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.957 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.098 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    7.401726	    9.668707	   10.000000	
    9.212100	   13.622326	   10.000000	
   12.598274	    9.346883	   11.685592	
   12.598274	    9.346883	    8.314408	
    8.897357	    6.377674	    8.304343	
    8.897357	    6.377674	   11.695657	
    9.352422	   11.383749	   10.000000	
   11.411203	    9.348677	   10.000000	
    9.151402	    7.524392	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.173 ms
Set up communicators.

--set up spincomm took 2.234 ms

--set up kptcomm took 0.342 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 21, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 21 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 21, mbQ = nbQ = 64
rank = 0, nr_Hp = 21, nc_Hp = 21
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.967 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.373 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.269 ms

Calculate_SplineDerivRadFun took 0.210 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.799 ms.
time spent on vectorized spline interp: 3.971 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.785 ms.
time spent on vectorized spline interp: 1.465 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.329 ms.
time spent on vectorized spline interp: 1.760 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.584 ms.

Calculating rb for all atom types took 16.704 ms
----------------------
Estimated memory usage
Total: 1.26 GB
orbitals             : 961.30 MB
global sized vectors : 213.62 MB
subspace matrices : 10.34 kB
others : 117.49 MB
----------------------------------------------
Estimated memory usage per processor: 107.70 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.062 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -28.0000000282402, sum_int_rho = 27.5898913670571
PosCharge = 28.000000028240, NegCharge = -27.589891367057, scal_fac = 1.014864453641
After scaling, int_rho = 28.0000000282401, PosCharge + NegCharge - NetCharge = 7.461e-14
--Calculate Vref took 0.628 ms
--Calculate rho_guess took 3.439 ms

 integral of b = -28.0000000282402,
 int{b} + Nelectron + NetCharge = -2.824e-08,
 Esc = -84.8972334104056,
 MPI_Reduce took 9.067 ms

Calculating b & b_ref took 20.855 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.070 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.114 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.109 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.674 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.005 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.554 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002824007, int_b + int_rho = -5.821e-14, checking this took 0.089 ms
2-norm of RHS = 736.6347105178580, which took 0.466 ms

iter_count = 420, r_2norm = 6.742e-04, tol*||rhs|| = 7.366e-04

Anderson update took 259.112 ms, out of which F'*F took 119.037 ms; b-Ax took 805.609 ms, out of which Lap took 716.820 ms
Solving Poisson took 1778.780 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.818 ms
Total time for convolution: 	 convolve: 5.156605 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
Total time for convolution: 	 convolve: 5.166692 
Total time for convolution: 	 convolve: 5.187187 
Total time for convolution: 	 convolve: 5.110843 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.037 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.170 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.345 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
rank = 0, XC calculation took 25574.265 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 4.841 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.912 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 15.879 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.140 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.911 ms
    Lanczos iter 53, eigmin  = -1.069356492, eigmax = 264.933326824, err_eigmin = 1.003e-03, err_eigmax = 9.676e-03
rank =   0, Lanczos took 138.507 ms, eigmin = -1.069356492481, eigmax = 267.582660092712

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.206652, lowerbound = -1.169356, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1699.241 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 23.067 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.859 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.945 ms
rank =  0, finding HY took 28.327 ms
rank =  0, distributing HY into block cyclic form took 22.689 ms
rank =  0, finding Y'*HY took 4.638 ms
Rank 0, Project_Hamiltonian used 82.016 ms
Total time for projection: 82.027 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.268 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 1.370 ms
    first calculated eigval = 2.725492699748645
    last  calculated eigval = 3.265283706827708
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =   2.83060262686212
lambda[   6] =   2.85570303480470
lambda[   7] =   2.90493087071516
lambda[   8] =   2.91971325247800
lambda[   9] =   2.97086667712062
lambda[  10] =   2.98776820524260
lambda[  11] =   2.99300613179415
lambda[  12] =   3.00568506535666
lambda[  13] =   3.02842690086734
lambda[  14] =   3.04152436322162
lambda[  15] =   3.07938810519726
lambda[  16] =   3.13491308864057
lambda[  17] =   3.13764751133333
lambda[  18] =   3.15204467130040
lambda[  19] =   3.17325331253253
lambda[  20] =   3.22097158398311
lambda[  21] =   3.26528370682771
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.384 ms
rank =  0, subspace rotation using ScaLAPACK took 9.089 ms
rank =  0, Distributing orbital back into band + domain format took 21.412 ms
rank = 0, Subspace_Rotation used 30.514 ms

Total time for subspace rotation: 30.517 ms
rank = 0, Efermi =   3.060456305984 calculate fermi energy took 0.048 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.365284, lowerbound = -1.169356, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1670.920 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.000 ms
rank =  0, Distribute orbital to block cyclic format took 34.257 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.720 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 36.997 ms
rank =  0, finding HY took 27.532 ms
rank =  0, distributing HY into block cyclic form took 21.156 ms
rank =  0, finding Y'*HY took 4.462 ms
Rank 0, Project_Hamiltonian used 90.174 ms
Total time for projection: 90.179 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.230 ms
    first calculated eigval = -0.899240174019799
    last  calculated eigval = 0.459905033281378
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.31115503071527
lambda[   6] =  -0.22907776104726
lambda[   7] =  -0.16231067838197
lambda[   8] =  -0.09585028271140
lambda[   9] =  -0.07455066136851
lambda[  10] =   0.05084246084600
lambda[  11] =   0.06963460606242
lambda[  12] =   0.15646035530360
lambda[  13] =   0.22428889184014
lambda[  14] =   0.28252091588033
lambda[  15] =   0.31434309156363
lambda[  16] =   0.32426815918574
lambda[  17] =   0.33875077758931
lambda[  18] =   0.35660107555476
lambda[  19] =   0.40892987098700
lambda[  20] =   0.41815469408773
lambda[  21] =   0.45990503328138
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.238 ms
rank =  0, subspace rotation using ScaLAPACK took 8.998 ms
rank =  0, Distributing orbital back into band + domain format took 21.192 ms
rank = 0, Subspace_Rotation used 30.202 ms

Total time for subspace rotation: 30.206 ms
rank = 0, Efermi =   0.298431778732 calculate fermi energy took 0.021 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.559905, lowerbound = -1.169356, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1683.765 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 30.282 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.738 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 33.040 ms
rank =  0, finding HY took 27.499 ms
rank =  0, distributing HY into block cyclic form took 21.150 ms
rank =  0, finding Y'*HY took 4.503 ms
Rank 0, Project_Hamiltonian used 86.691 ms
Total time for projection: 86.695 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -1.078361572527667
    last  calculated eigval = 0.160324910727641
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.57441534212600
lambda[   6] =  -0.54933369641915
lambda[   7] =  -0.52615284392419
lambda[   8] =  -0.50519757353597
lambda[   9] =  -0.45081600189043
lambda[  10] =  -0.43399540226974
lambda[  11] =  -0.40254171708746
lambda[  12] =  -0.37569486859955
lambda[  13] =  -0.30120379520599
lambda[  14] =  -0.29974551411506
lambda[  15] =  -0.00705538521183
lambda[  16] =   0.02686494437884
lambda[  17] =   0.07270567132618
lambda[  18] =   0.11102891366589
lambda[  19] =   0.12318126750495
lambda[  20] =   0.14925143205344
lambda[  21] =   0.16032491072764
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.225 ms
rank =  0, subspace rotation using ScaLAPACK took 9.060 ms
rank =  0, Distributing orbital back into band + domain format took 21.446 ms
rank = 0, Subspace_Rotation used 30.522 ms

Total time for subspace rotation: 30.525 ms
rank = 0, Efermi =  -0.035909961418 calculate fermi energy took 0.024 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.260325, lowerbound = -1.169356, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1684.503 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 23.865 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.739 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.624 ms
rank =  0, finding HY took 27.496 ms
rank =  0, distributing HY into block cyclic form took 21.101 ms
rank =  0, finding Y'*HY took 4.452 ms
Rank 0, Project_Hamiltonian used 79.700 ms
Total time for projection: 79.705 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -1.078665532885333
    last  calculated eigval = 0.090733254429447
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.58084459894758
lambda[   6] =  -0.55513503278594
lambda[   7] =  -0.53270078751508
lambda[   8] =  -0.50919622054117
lambda[   9] =  -0.46222322494157
lambda[  10] =  -0.44396260862844
lambda[  11] =  -0.42030736895717
lambda[  12] =  -0.39552958061432
lambda[  13] =  -0.32719853235981
lambda[  14] =  -0.32246219486625
lambda[  15] =  -0.06478815873413
lambda[  16] =  -0.01853241565269
lambda[  17] =   0.01758126515427
lambda[  18] =   0.04203219233939
lambda[  19] =   0.05808310758428
lambda[  20] =   0.07473469298832
lambda[  21] =   0.09073325442945
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 8.980 ms
rank =  0, Distributing orbital back into band + domain format took 21.287 ms
rank = 0, Subspace_Rotation used 30.279 ms

Total time for subspace rotation: 31.134 ms
rank = 0, Efermi =  -0.093642734918 calculate fermi energy took 0.024 ms
rank = 0, --- Calculate rho: sum over local bands took 6.741 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.412 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 7363.206 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.921 ms
rank = 0, D2D took 2.016 ms
rank = 0, Transfering density took 2.018 ms
Etot    =   -53.614772131833
Eband   =   -16.336534800823
E1      =    32.026743676507
E2      =   -13.796308215583
E3      =   -17.456415071704
Exc     =   -15.660470883559
Esc     =   -84.897233410406
Entropy =    -0.000000000840
dE = 5.957e+00, dEband = 1.815e+00
rank = 0, Calculating/Estimating energy took 0.997 ms, Etot = -53.614772132, dEtot = 5.957e+00, dEband = 1.815e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 61.4178711772449, which took 7.128 ms

iter_count = 96, r_2norm = 1.515e-03, tol*||rhs|| = 2.457e-03

Anderson update took 57.181 ms, out of which F'*F took 28.251 ms; b-Ax took 191.010 ms, out of which Lap took 169.145 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 433.015 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002824008, int_b + int_rho = -5.457e-14, checking this took 0.105 ms
2-norm of RHS = 732.4717340322994, which took 0.200 ms

iter_count = 282, r_2norm = 6.338e-04, tol*||rhs|| = 7.325e-04

Anderson update took 172.624 ms, out of which F'*F took 79.384 ms; b-Ax took 539.630 ms, out of which Lap took 480.039 ms
Solving Poisson took 1208.181 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.376 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.187581 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.759 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.172428 
Total time for convolution: 	 convolve: 5.220053 
Total time for convolution: 	 convolve: 5.158777 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.129 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.513 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.048 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.595 ms

This SCF took 33823.201 ms, scf error = 1.469e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.190733, lowerbound = -1.078666, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1687.029 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.193 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.661 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.870 ms
rank =  0, finding HY took 27.102 ms
rank =  0, distributing HY into block cyclic form took 21.607 ms
rank =  0, finding Y'*HY took 4.458 ms
Rank 0, Project_Hamiltonian used 77.072 ms
Total time for projection: 77.087 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -1.063863185342333
    last  calculated eigval = 0.057157996000632
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55521197532051
lambda[   6] =  -0.53043792420083
lambda[   7] =  -0.51510947044007
lambda[   8] =  -0.47897400900052
lambda[   9] =  -0.43412965940809
lambda[  10] =  -0.41373719628207
lambda[  11] =  -0.40268233390234
lambda[  12] =  -0.37302558898711
lambda[  13] =  -0.30834146984315
lambda[  14] =  -0.29099019589950
lambda[  15] =  -0.06702872776254
lambda[  16] =  -0.03152669586849
lambda[  17] =  -0.00039517019029
lambda[  18] =   0.01569311443834
lambda[  19] =   0.02370340198001
lambda[  20] =   0.05381411490656
lambda[  21] =   0.05715799600063
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 9.951 ms
rank =  0, Distributing orbital back into band + domain format took 20.850 ms
rank = 0, Subspace_Rotation used 30.817 ms

Total time for subspace rotation: 30.835 ms
rank = 0, Efermi =  -0.095883303954 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 6.490 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.911 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.575 ms
rank = 0, Calculating density took 1814.847 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.918 ms
rank = 0, D2D took 2.018 ms
rank = 0, Transfering density took 2.024 ms
Etot    =   -53.553635427541
Eband   =   -15.656663605854
E1      =    31.438354799639
E2      =   -13.726909535735
E3      =   -17.651359285237
Exc     =   -15.816362031052
Esc     =   -84.897233410406
Entropy =    -0.000000000840
dE = 6.793e-03, dEband = 7.554e-02
rank = 0, Calculating/Estimating energy took 1.002 ms, Etot = -53.553635428, dEtot = 6.793e-03, dEband = 7.554e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 27.4986113652594, which took 0.091 ms

iter_count = 96, r_2norm = 1.048e-03, tol*||rhs|| = 1.100e-03

Anderson update took 56.344 ms, out of which F'*F took 26.129 ms; b-Ax took 179.267 ms, out of which Lap took 158.484 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.693 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002824004, int_b + int_rho = -8.367e-14, checking this took 0.143 ms
2-norm of RHS = 728.5917219821137, which took 0.147 ms

iter_count = 294, r_2norm = 6.145e-04, tol*||rhs|| = 7.286e-04

Anderson update took 174.123 ms, out of which F'*F took 80.116 ms; b-Ax took 550.700 ms, out of which Lap took 487.094 ms
Solving Poisson took 1236.377 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.173208 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.385 ms
Total time for convolution: 	 convolve: 5.184555 
Total time for convolution: 	 convolve: 5.168420 
Total time for convolution: 	 convolve: 5.220400 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.383 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 3.467 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.049 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.551 ms

This SCF took 28228.084 ms, scf error = 9.654e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.157158, lowerbound = -1.063863, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1666.826 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 51.769 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.032 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 54.818 ms
rank =  0, finding HY took 27.086 ms
rank =  0, distributing HY into block cyclic form took 22.302 ms
rank =  0, finding Y'*HY took 4.584 ms
Rank 0, Project_Hamiltonian used 108.820 ms
Total time for projection: 108.832 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -1.043942947994475
    last  calculated eigval = 0.052412993606040
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.51675334908145
lambda[   6] =  -0.49488622813114
lambda[   7] =  -0.48806446544899
lambda[   8] =  -0.44413541598648
lambda[   9] =  -0.39377461562015
lambda[  10] =  -0.37950456047176
lambda[  11] =  -0.37565534971159
lambda[  12] =  -0.33927851979850
lambda[  13] =  -0.28439595320881
lambda[  14] =  -0.25891131801627
lambda[  15] =  -0.05357655050750
lambda[  16] =  -0.03271578749764
lambda[  17] =   0.00155609535698
lambda[  18] =   0.01029054065057
lambda[  19] =   0.01926054236194
lambda[  20] =   0.03998436693392
lambda[  21] =   0.05241299360604
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 9.532 ms
rank =  0, Distributing orbital back into band + domain format took 21.415 ms
rank = 0, Subspace_Rotation used 30.965 ms

Total time for subspace rotation: 30.969 ms
rank = 0, Efermi =  -0.082431126687 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 6.136 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.919 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.576 ms
rank = 0, Calculating density took 1825.899 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.899 ms
rank = 0, D2D took 2.000 ms
rank = 0, Transfering density took 2.006 ms
Etot    =   -53.514284785516
Eband   =   -14.745579736696
E1      =    30.678175984866
E2      =   -13.559331804202
E3      =   -17.931497883302
Exc     =   -16.040477309945
Esc     =   -84.897233410406
Entropy =    -0.000000000840
dE = 4.372e-03, dEband = 1.012e-01
rank = 0, Calculating/Estimating energy took 0.988 ms, Etot = -53.514284786, dEtot = 4.372e-03, dEband = 1.012e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.4311808321005, which took 0.062 ms

iter_count = 102, r_2norm = 2.319e-04, tol*||rhs|| = 2.572e-04

Anderson update took 60.026 ms, out of which F'*F took 28.059 ms; b-Ax took 191.799 ms, out of which Lap took 169.607 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 443.837 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002823994, int_b + int_rho = -1.892e-13, checking this took 0.160 ms
2-norm of RHS = 728.4135095905204, which took 0.159 ms

iter_count = 282, r_2norm = 5.896e-04, tol*||rhs|| = 7.284e-04

Anderson update took 167.367 ms, out of which F'*F took 77.259 ms; b-Ax took 527.272 ms, out of which Lap took 468.094 ms
Solving Poisson took 1184.886 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.324830 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.157335 
Total time for convolution: 	 convolve: 5.184935 
Total time for convolution: 	 convolve: 5.163162 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.405 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.160 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.502 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.087 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.618 ms

This SCF took 28291.859 ms, scf error = 4.055e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.152413, lowerbound = -1.043943, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1686.714 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.175 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.786 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.983 ms
rank =  0, finding HY took 26.405 ms
rank =  0, distributing HY into block cyclic form took 21.604 ms
rank =  0, finding Y'*HY took 4.440 ms
Rank 0, Project_Hamiltonian used 76.466 ms
Total time for projection: 76.476 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.693 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.299 ms
rank = 0, Solve_Generalized_EigenProblem used 0.999 ms
    first calculated eigval = -1.031600541024802
    last  calculated eigval = 0.051390483816165
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49731926803672
lambda[   6] =  -0.47641314457239
lambda[   7] =  -0.47177362687984
lambda[   8] =  -0.43202828098416
lambda[   9] =  -0.37582710203000
lambda[  10] =  -0.36482408317212
lambda[  11] =  -0.35934010655920
lambda[  12] =  -0.32245611190195
lambda[  13] =  -0.27436602372070
lambda[  14] =  -0.24992815232970
lambda[  15] =  -0.04324781882455
lambda[  16] =  -0.03231835707648
lambda[  17] =   0.00297155131138
lambda[  18] =   0.00859488132717
lambda[  19] =   0.01612835791264
lambda[  20] =   0.03169486679677
lambda[  21] =   0.05139048381616
==subpsace eigenproblem: bcast eigvals took 0.037 ms
Total time for solving subspace eigenvalue problem: 1.042 ms
rank =  0, subspace rotation using ScaLAPACK took 9.528 ms
rank =  0, Distributing orbital back into band + domain format took 21.136 ms
rank = 0, Subspace_Rotation used 30.681 ms

Total time for subspace rotation: 30.686 ms
rank = 0, Efermi =  -0.072102395623 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 6.277 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.786 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.105 ms
rank = 0, Calculating density took 1816.122 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.080 ms
rank = 0, D2D took 2.197 ms
rank = 0, Transfering density took 2.205 ms
Etot    =   -53.506792862381
Eband   =   -14.316140538917
E1      =    30.366188884938
E2      =   -13.419826773462
E3      =   -18.069109331930
Exc     =   -16.148543902548
Esc     =   -84.897233410406
Entropy =    -0.000000000840
dE = 8.324e-04, dEband = 4.772e-02
rank = 0, Calculating/Estimating energy took 0.977 ms, Etot = -53.506792862, dEtot = 8.324e-04, dEband = 4.772e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.5145937268300, which took 0.055 ms

iter_count = 102, r_2norm = 1.276e-04, tol*||rhs|| = 1.406e-04

Anderson update took 60.721 ms, out of which F'*F took 27.874 ms; b-Ax took 192.267 ms, out of which Lap took 169.386 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 437.191 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002823997, int_b + int_rho = -1.637e-13, checking this took 0.147 ms
2-norm of RHS = 728.9761898789496, which took 0.205 ms

iter_count = 252, r_2norm = 6.577e-04, tol*||rhs|| = 7.290e-04

Anderson update took 149.327 ms, out of which F'*F took 68.727 ms; b-Ax took 469.145 ms, out of which Lap took 416.580 ms
Solving Poisson took 1052.828 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.191285 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.706 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.207566 
Total time for convolution: 	 convolve: 5.160100 
Total time for convolution: 	 convolve: 5.149568 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
---Transfer Veff_loc: D2D took 3.525 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.726 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.288 ms

This SCF took 28140.952 ms, scf error = 1.290e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.151390, lowerbound = -1.031601, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1682.690 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 21.183 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 7.944 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 29.806 ms
rank =  0, finding HY took 24.776 ms
rank =  0, distributing HY into block cyclic form took 21.060 ms
rank =  0, finding Y'*HY took 4.548 ms
Rank 0, Project_Hamiltonian used 80.223 ms
Total time for projection: 80.237 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.147 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 2.253 ms
rank = 0, Solve_Generalized_EigenProblem used 2.402 ms
    first calculated eigval = -1.027151102490231
    last  calculated eigval = 0.049309245731035
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49313051694035
lambda[   6] =  -0.47198215727766
lambda[   7] =  -0.46724495694989
lambda[   8] =  -0.42507478487168
lambda[   9] =  -0.37002799759136
lambda[  10] =  -0.36018719384098
lambda[  11] =  -0.35376633526567
lambda[  12] =  -0.31871262612544
lambda[  13] =  -0.26977616763667
lambda[  14] =  -0.24365704805403
lambda[  15] =  -0.03843664088839
lambda[  16] =  -0.03240217170446
lambda[  17] =   0.00265045930185
lambda[  18] =   0.00793191992642
lambda[  19] =   0.01206214755033
lambda[  20] =   0.02688350634038
lambda[  21] =   0.04930924573104
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 2.413 ms
rank =  0, subspace rotation using ScaLAPACK took 9.679 ms
rank =  0, Distributing orbital back into band + domain format took 20.899 ms
rank = 0, Subspace_Rotation used 30.601 ms

Total time for subspace rotation: 30.605 ms
rank = 0, Efermi =  -0.067291829500 calculate fermi energy took 0.612 ms
rank = 0, --- Calculate rho: sum over local bands took 6.267 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.915 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.578 ms
rank = 0, Calculating density took 1815.395 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.905 ms
rank = 0, D2D took 2.008 ms
rank = 0, Transfering density took 2.014 ms
Etot    =   -53.505640063627
Eband   =   -14.175011774879
E1      =    30.294511904770
E2      =   -13.340753008415
E3      =   -18.108478780934
Exc     =   -16.177138571620
Esc     =   -84.897233410406
Entropy =    -0.000000000840
dE = 1.281e-04, dEband = 1.568e-02
rank = 0, Calculating/Estimating energy took 1.072 ms, Etot = -53.505640064, dEtot = 1.281e-04, dEband = 1.568e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.1449349396421, which took 0.054 ms

iter_count = 108, r_2norm = 4.407e-05, tol*||rhs|| = 4.580e-05

Anderson update took 63.339 ms, out of which F'*F took 30.786 ms; b-Ax took 202.634 ms, out of which Lap took 180.318 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.656 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002823996, int_b + int_rho = -1.746e-13, checking this took 0.112 ms
2-norm of RHS = 729.3092448476659, which took 0.111 ms

iter_count = 222, r_2norm = 7.172e-04, tol*||rhs|| = 7.293e-04

Anderson update took 131.572 ms, out of which F'*F took 62.361 ms; b-Ax took 426.184 ms, out of which Lap took 379.253 ms
Solving Poisson took 925.572 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.073 ms
Total time for convolution: 	 convolve: 5.194077 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.198166 
Total time for convolution: 	 convolve: 5.207855 
Total time for convolution: 	 convolve: 5.168116 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.241 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.186 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.477 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.251 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.761 ms

This SCF took 27970.607 ms, scf error = 5.185e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.149309, lowerbound = -1.027151, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1669.835 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.724 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.855 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.600 ms
rank =  0, finding HY took 26.277 ms
rank =  0, distributing HY into block cyclic form took 21.286 ms
rank =  0, finding Y'*HY took 4.450 ms
Rank 0, Project_Hamiltonian used 76.641 ms
Total time for projection: 76.652 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -1.025147402718415
    last  calculated eigval = 0.047375840162838
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49142907943337
lambda[   6] =  -0.47036980075831
lambda[   7] =  -0.46545052932264
lambda[   8] =  -0.42365647578946
lambda[   9] =  -0.36857696786073
lambda[  10] =  -0.35862230624792
lambda[  11] =  -0.35228368007792
lambda[  12] =  -0.31704061681306
lambda[  13] =  -0.26814676766016
lambda[  14] =  -0.24234712072485
lambda[  15] =  -0.03693140542055
lambda[  16] =  -0.03238180369933
lambda[  17] =   0.00250959136738
lambda[  18] =   0.00765066024307
lambda[  19] =   0.00961848450040
lambda[  20] =   0.02397028292081
lambda[  21] =   0.04737584016284
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.247 ms
rank =  0, subspace rotation using ScaLAPACK took 9.508 ms
rank =  0, Distributing orbital back into band + domain format took 20.865 ms
rank = 0, Subspace_Rotation used 30.386 ms

Total time for subspace rotation: 30.391 ms
rank = 0, Efermi =  -0.065790143327 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 6.293 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.006 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.581 ms
rank = 0, Calculating density took 1796.132 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.903 ms
rank = 0, D2D took 2.007 ms
rank = 0, Transfering density took 2.013 ms
Etot    =   -53.505403896425
Eband   =   -14.130216252559
E1      =    30.279041156467
E2      =   -13.309061764949
E3      =   -18.115715592473
Exc     =   -16.181772746509
Esc     =   -84.897233410406
Entropy =    -0.000000000840
dE = 2.624e-05, dEband = 4.977e-03
rank = 0, Calculating/Estimating energy took 1.015 ms, Etot = -53.505403896, dEtot = 2.624e-05, dEband = 4.977e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5617049685308, which took 0.157 ms

iter_count = 114, r_2norm = 1.458e-05, tol*||rhs|| = 2.247e-05

Anderson update took 67.677 ms, out of which F'*F took 32.258 ms; b-Ax took 220.203 ms, out of which Lap took 197.374 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.447 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002824001, int_b + int_rho = -1.237e-13, checking this took 0.140 ms
2-norm of RHS = 729.6159428622246, which took 0.186 ms

iter_count = 234, r_2norm = 6.990e-04, tol*||rhs|| = 7.296e-04

Anderson update took 138.435 ms, out of which F'*F took 66.562 ms; b-Ax took 453.517 ms, out of which Lap took 402.535 ms
Solving Poisson took 985.113 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.179878 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.176270 
Total time for convolution: 	 convolve: 5.176950 
Total time for convolution: 	 convolve: 5.165011 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.408 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.167 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.784 ms
---Transfer Veff_loc: D2D took 4.512 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.205 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.750 ms

This SCF took 27982.942 ms, scf error = 3.195e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.147376, lowerbound = -1.025147, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1505.860 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.236 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.816 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.072 ms
rank =  0, finding HY took 26.400 ms
rank =  0, distributing HY into block cyclic form took 21.271 ms
rank =  0, finding Y'*HY took 4.404 ms
Rank 0, Project_Hamiltonian used 76.177 ms
Total time for projection: 76.190 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -1.022280915622088
    last  calculated eigval = 0.045927025471406
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48853354725172
lambda[   6] =  -0.46772420278678
lambda[   7] =  -0.46261382820460
lambda[   8] =  -0.42068935072158
lambda[   9] =  -0.36605705619231
lambda[  10] =  -0.35589824639516
lambda[  11] =  -0.34938907468102
lambda[  12] =  -0.31407313768645
lambda[  13] =  -0.26541448724774
lambda[  14] =  -0.23945176937590
lambda[  15] =  -0.03468168530173
lambda[  16] =  -0.03194196925791
lambda[  17] =   0.00335886256926
lambda[  18] =   0.00800513665846
lambda[  19] =   0.00901132139469
lambda[  20] =   0.02229895010402
lambda[  21] =   0.04592702547141
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 9.616 ms
rank =  0, Distributing orbital back into band + domain format took 20.873 ms
rank = 0, Subspace_Rotation used 30.501 ms

Total time for subspace rotation: 30.506 ms
rank = 0, Efermi =  -0.063574145040 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 6.138 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.166 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 1631.816 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.909 ms
rank = 0, D2D took 2.012 ms
rank = 0, Transfering density took 2.014 ms
Etot    =   -53.505188021496
Eband   =   -14.051091874552
E1      =    30.242797438165
E2      =   -13.262526358019
E3      =   -18.128197269376
Exc     =   -16.190383801254
Esc     =   -84.897233410406
Entropy =    -0.000000000844
dE = 2.399e-05, dEband = 8.792e-03
rank = 0, Calculating/Estimating energy took 0.983 ms, Etot = -53.505188021, dEtot = 2.399e-05, dEband = 8.792e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3259691399207, which took 0.139 ms

iter_count = 108, r_2norm = 1.299e-05, tol*||rhs|| = 1.304e-05

Anderson update took 64.667 ms, out of which F'*F took 29.631 ms; b-Ax took 205.279 ms, out of which Lap took 183.669 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.109 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002824001, int_b + int_rho = -1.237e-13, checking this took 0.226 ms
2-norm of RHS = 729.7480388356950, which took 0.190 ms

iter_count = 228, r_2norm = 5.985e-04, tol*||rhs|| = 7.297e-04

Anderson update took 134.957 ms, out of which F'*F took 62.753 ms; b-Ax took 434.749 ms, out of which Lap took 385.541 ms
Solving Poisson took 955.139 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.137 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.181506 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 30.739 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.185901 
Total time for convolution: 	 convolve: 5.212292 
Total time for convolution: 	 convolve: 5.159477 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.108 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.395 ms
---Transfer Veff_loc: D2D took 3.481 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.255 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.768 ms

This SCF took 27838.821 ms, scf error = 1.714e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.145927, lowerbound = -1.022281, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1677.494 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.455 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.812 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.288 ms
rank =  0, finding HY took 26.402 ms
rank =  0, distributing HY into block cyclic form took 21.377 ms
rank =  0, finding Y'*HY took 4.719 ms
Rank 0, Project_Hamiltonian used 77.816 ms
Total time for projection: 77.834 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.226 ms
    first calculated eigval = -1.020160343155933
    last  calculated eigval = 0.044642386542754
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48640116352888
lambda[   6] =  -0.46569721506641
lambda[   7] =  -0.46043118249068
lambda[   8] =  -0.41830129997755
lambda[   9] =  -0.36399008841236
lambda[  10] =  -0.35389026290935
lambda[  11] =  -0.34707105526761
lambda[  12] =  -0.31186533082662
lambda[  13] =  -0.26344993331909
lambda[  14] =  -0.23718997278868
lambda[  15] =  -0.03273216934182
lambda[  16] =  -0.03106683321157
lambda[  17] =   0.00487194290231
lambda[  18] =   0.00893991623493
lambda[  19] =   0.00958506459667
lambda[  20] =   0.02153607311989
lambda[  21] =   0.04464238654275
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.256 ms
rank =  0, subspace rotation using ScaLAPACK took 9.530 ms
rank =  0, Distributing orbital back into band + domain format took 21.025 ms
rank = 0, Subspace_Rotation used 30.569 ms

Total time for subspace rotation: 30.582 ms
rank = 0, Efermi =  -0.061714132878 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 6.316 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.880 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.571 ms
rank = 0, Calculating density took 1805.098 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.905 ms
rank = 0, D2D took 2.001 ms
rank = 0, Transfering density took 2.003 ms
Etot    =   -53.505170828017
Eband   =   -13.990150274554
E1      =    30.213174545640
E2      =   -13.229133704602
E3      =   -18.135343509623
Exc     =   -16.195438902074
Esc     =   -84.897233410406
Entropy =    -0.000000000849
dE = 1.910e-06, dEband = 6.771e-03
rank = 0, Calculating/Estimating energy took 1.867 ms, Etot = -53.505170828, dEtot = 1.910e-06, dEband = 6.771e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2498763842667, which took 0.068 ms

iter_count = 108, r_2norm = 8.145e-06, tol*||rhs|| = 9.995e-06

Anderson update took 64.255 ms, out of which F'*F took 29.714 ms; b-Ax took 202.431 ms, out of which Lap took 179.546 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.734 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002823999, int_b + int_rho = -1.419e-13, checking this took 0.127 ms
2-norm of RHS = 729.7487024052957, which took 0.187 ms

iter_count = 216, r_2norm = 6.821e-04, tol*||rhs|| = 7.297e-04

Anderson update took 140.271 ms, out of which F'*F took 60.868 ms; b-Ax took 409.603 ms, out of which Lap took 365.642 ms
Solving Poisson took 914.972 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.152085 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.610 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.235790 
Total time for convolution: 	 convolve: 5.221651 
Total time for convolution: 	 convolve: 5.171768 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.574 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.245 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.853 ms

This SCF took 29742.988 ms, scf error = 1.024e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.144642, lowerbound = -1.020160, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1677.995 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.741 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.834 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.594 ms
rank =  0, finding HY took 26.298 ms
rank =  0, distributing HY into block cyclic form took 21.380 ms
rank =  0, finding Y'*HY took 4.410 ms
Rank 0, Project_Hamiltonian used 76.712 ms
Total time for projection: 76.724 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -1.018149051900270
    last  calculated eigval = 0.043559120967894
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48467143903059
lambda[   6] =  -0.46407758471868
lambda[   7] =  -0.45856712415256
lambda[   8] =  -0.41629434781873
lambda[   9] =  -0.36225846256208
lambda[  10] =  -0.35225345824512
lambda[  11] =  -0.34521896571771
lambda[  12] =  -0.31004271289012
lambda[  13] =  -0.26158214974281
lambda[  14] =  -0.23523062030278
lambda[  15] =  -0.03082390617964
lambda[  16] =  -0.02918133265387
lambda[  17] =   0.00760077204850
lambda[  18] =   0.01137560203536
lambda[  19] =   0.01173031195582
lambda[  20] =   0.02212524693018
lambda[  21] =   0.04355912096789
==subpsace eigenproblem: bcast eigvals took 0.036 ms
Total time for solving subspace eigenvalue problem: 0.260 ms
rank =  0, subspace rotation using ScaLAPACK took 9.533 ms
rank =  0, Distributing orbital back into band + domain format took 20.961 ms
rank = 0, Subspace_Rotation used 30.507 ms

Total time for subspace rotation: 30.511 ms
rank = 0, Efermi =  -0.059809028886 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 6.214 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.113 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.583 ms
rank = 0, Calculating density took 1804.523 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.794 ms
rank = 0, D2D took 2.895 ms
rank = 0, Transfering density took 2.898 ms
Etot    =   -53.505217395096
Eband   =   -13.938869421215
E1      =    30.186850733324
E2      =   -13.202889893968
E3      =   -18.140285695874
Exc     =   -16.199140885792
Esc     =   -84.897233410406
Entropy =    -0.000000000849
dE = 5.174e-06, dEband = 5.698e-03
rank = 0, Calculating/Estimating energy took 0.996 ms, Etot = -53.505217395, dEtot = 5.174e-06, dEband = 5.698e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2498441563446, which took 0.108 ms

iter_count = 102, r_2norm = 8.373e-06, tol*||rhs|| = 9.994e-06

Anderson update took 59.821 ms, out of which F'*F took 28.154 ms; b-Ax took 191.722 ms, out of which Lap took 169.930 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 433.604 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002824018, int_b + int_rho = 5.457e-14, checking this took 0.098 ms
2-norm of RHS = 729.7353111005611, which took 0.187 ms

iter_count = 198, r_2norm = 6.968e-04, tol*||rhs|| = 7.297e-04

Anderson update took 117.138 ms, out of which F'*F took 54.345 ms; b-Ax took 386.488 ms, out of which Lap took 343.607 ms
Solving Poisson took 836.562 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.234114 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.942 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.161796 
Total time for convolution: 	 convolve: 5.154582 
Total time for convolution: 	 convolve: 5.198159 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.574 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.428 ms
---Transfer Veff_loc: D2D took 3.856 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.256 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.565 ms

This SCF took 27878.068 ms, scf error = 6.065e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.143559, lowerbound = -1.018149, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1680.084 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.533 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.825 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.379 ms
rank =  0, finding HY took 26.448 ms
rank =  0, distributing HY into block cyclic form took 21.102 ms
rank =  0, finding Y'*HY took 4.437 ms
Rank 0, Project_Hamiltonian used 76.402 ms
Total time for projection: 76.415 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -1.017244336438338
    last  calculated eigval = 0.042125568053139
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48384627663573
lambda[   6] =  -0.46329353958724
lambda[   7] =  -0.45771767081865
lambda[   8] =  -0.41535146835745
lambda[   9] =  -0.36144831394120
lambda[  10] =  -0.35143489411352
lambda[  11] =  -0.34434080001074
lambda[  12] =  -0.30917971108517
lambda[  13] =  -0.26069845265462
lambda[  14] =  -0.23426797741851
lambda[  15] =  -0.02989733034826
lambda[  16] =  -0.02707577160209
lambda[  17] =   0.01011650335660
lambda[  18] =   0.01387236852682
lambda[  19] =   0.01419389551810
lambda[  20] =   0.02300590181220
lambda[  21] =   0.04212556805314
==subpsace eigenproblem: bcast eigvals took 0.061 ms
Total time for solving subspace eigenvalue problem: 0.284 ms
rank =  0, subspace rotation using ScaLAPACK took 9.520 ms
rank =  0, Distributing orbital back into band + domain format took 20.942 ms
rank = 0, Subspace_Rotation used 30.474 ms

Total time for subspace rotation: 30.479 ms
rank = 0, Efermi =  -0.058786319069 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 6.994 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.823 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.586 ms
rank = 0, Calculating density took 1806.315 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.907 ms
rank = 0, D2D took 2.011 ms
rank = 0, Transfering density took 2.013 ms
Etot    =   -53.505267691415
Eband   =   -13.914619088536
E1      =    30.174783187347
E2      =   -13.190456541034
E3      =   -18.141392219423
Exc     =   -16.200047139433
Esc     =   -84.897233410406
Entropy =    -0.000000000844
dE = 5.588e-06, dEband = 2.694e-03
rank = 0, Calculating/Estimating energy took 1.059 ms, Etot = -53.505267691, dEtot = 5.588e-06, dEband = 2.694e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0664293725901, which took 0.113 ms

iter_count = 114, r_2norm = 1.900e-06, tol*||rhs|| = 2.657e-06

Anderson update took 68.328 ms, out of which F'*F took 31.072 ms; b-Ax took 214.737 ms, out of which Lap took 190.670 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.191 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002824011, int_b + int_rho = -2.183e-14, checking this took 0.131 ms
2-norm of RHS = 729.7423442379057, which took 0.168 ms

iter_count = 192, r_2norm = 7.215e-04, tol*||rhs|| = 7.297e-04

Anderson update took 113.209 ms, out of which F'*F took 53.127 ms; b-Ax took 361.377 ms, out of which Lap took 320.049 ms
Solving Poisson took 800.286 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.157440 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.695 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.255467 
Total time for convolution: 	 convolve: 5.211199 
Total time for convolution: 	 convolve: 5.172740 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.722 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 3.524 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.397 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.955 ms

This SCF took 27921.012 ms, scf error = 4.334e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.142126, lowerbound = -1.017244, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1683.223 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 21.389 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.841 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.251 ms
rank =  0, finding HY took 26.230 ms
rank =  0, distributing HY into block cyclic form took 21.266 ms
rank =  0, finding Y'*HY took 4.415 ms
Rank 0, Project_Hamiltonian used 76.193 ms
Total time for projection: 76.206 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -1.016396002190007
    last  calculated eigval = 0.041627214433883
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48305327361082
lambda[   6] =  -0.46250516141311
lambda[   7] =  -0.45690788041076
lambda[   8] =  -0.41451991999635
lambda[   9] =  -0.36064618485966
lambda[  10] =  -0.35063245966531
lambda[  11] =  -0.34353776537769
lambda[  12] =  -0.30839296494088
lambda[  13] =  -0.25988280077441
lambda[  14] =  -0.23343669592423
lambda[  15] =  -0.02898926383404
lambda[  16] =  -0.02387791281946
lambda[  17] =   0.01330288787381
lambda[  18] =   0.01711421648490
lambda[  19] =   0.01814607022867
lambda[  20] =   0.02461442078070
lambda[  21] =   0.04162721443388
==subpsace eigenproblem: bcast eigvals took 0.039 ms
Total time for solving subspace eigenvalue problem: 0.268 ms
rank =  0, subspace rotation using ScaLAPACK took 10.518 ms
rank =  0, Distributing orbital back into band + domain format took 20.985 ms
rank = 0, Subspace_Rotation used 31.519 ms

Total time for subspace rotation: 31.526 ms
rank = 0, Efermi =  -0.057845875874 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 6.212 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.132 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1810.624 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.894 ms
rank = 0, D2D took 1.992 ms
rank = 0, Transfering density took 1.994 ms
Etot    =   -53.505310009439
Eband   =   -13.891940532627
E1      =    30.163867395924
E2      =   -13.178363617606
E3      =   -18.142856340581
Exc     =   -16.201223419678
Esc     =   -84.897233410406
Entropy =    -0.000000000840
dE = 4.702e-06, dEband = 2.520e-03
rank = 0, Calculating/Estimating energy took 1.015 ms, Etot = -53.505310009, dEtot = 4.702e-06, dEband = 2.520e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0588281990984, which took 0.054 ms

iter_count = 114, r_2norm = 1.624e-06, tol*||rhs|| = 2.353e-06

Anderson update took 68.080 ms, out of which F'*F took 31.069 ms; b-Ax took 219.845 ms, out of which Lap took 195.876 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 503.298 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002824005, int_b + int_rho = -7.640e-14, checking this took 0.090 ms
2-norm of RHS = 729.7420656804677, which took 0.151 ms

iter_count = 144, r_2norm = 7.012e-04, tol*||rhs|| = 7.297e-04

Anderson update took 92.521 ms, out of which F'*F took 54.775 ms; b-Ax took 294.388 ms, out of which Lap took 263.525 ms
Solving Poisson took 635.700 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.182163 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.999 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.174979 
Total time for convolution: 	 convolve: 5.187583 
Total time for convolution: 	 convolve: 5.174331 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.543 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.518 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 3.506 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.446 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.986 ms

This SCF took 27672.585 ms, scf error = 2.639e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.141627, lowerbound = -1.016396, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1684.212 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.387 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.830 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.236 ms
rank =  0, finding HY took 26.353 ms
rank =  0, distributing HY into block cyclic form took 21.380 ms
rank =  0, finding Y'*HY took 4.412 ms
Rank 0, Project_Hamiltonian used 76.411 ms
Total time for projection: 76.425 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.223 ms
    first calculated eigval = -1.016156841687440
    last  calculated eigval = 0.040139196255398
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48283359500981
lambda[   6] =  -0.46228341581448
lambda[   7] =  -0.45667802033332
lambda[   8] =  -0.41429448242883
lambda[   9] =  -0.36042661748266
lambda[  10] =  -0.35041744754418
lambda[  11] =  -0.34331259346567
lambda[  12] =  -0.30816211860243
lambda[  13] =  -0.25965470509491
lambda[  14] =  -0.23321403677966
lambda[  15] =  -0.02876738389101
lambda[  16] =  -0.02316208464706
lambda[  17] =   0.01380696482292
lambda[  18] =   0.01759236577177
lambda[  19] =   0.01894941325048
lambda[  20] =   0.02477495814597
lambda[  21] =   0.04013919625540
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 9.977 ms
rank =  0, Distributing orbital back into band + domain format took 20.946 ms
rank = 0, Subspace_Rotation used 30.936 ms

Total time for subspace rotation: 30.943 ms
rank = 0, Efermi =  -0.057623034825 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 6.250 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.021 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.575 ms
rank = 0, Calculating density took 1811.183 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.923 ms
rank = 0, D2D took 2.024 ms
rank = 0, Transfering density took 2.031 ms
Etot    =   -53.505339537509
Eband   =   -13.885600258178
E1      =    30.160519027671
E2      =   -13.175244559067
E3      =   -18.143366681948
Exc     =   -16.201636136772
Esc     =   -84.897233410406
Entropy =    -0.000000000840
dE = 3.281e-06, dEband = 7.045e-04
rank = 0, Calculating/Estimating energy took 1.033 ms, Etot = -53.505339538, dEtot = 3.281e-06, dEband = 7.045e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0434541082630, which took 0.056 ms

iter_count = 108, r_2norm = 1.550e-06, tol*||rhs|| = 1.738e-06

Anderson update took 64.310 ms, out of which F'*F took 29.819 ms; b-Ax took 204.003 ms, out of which Lap took 181.433 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.061 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002824013, int_b + int_rho = -3.638e-15, checking this took 0.130 ms
2-norm of RHS = 729.7532748303273, which took 0.124 ms

iter_count = 168, r_2norm = 6.680e-04, tol*||rhs|| = 7.298e-04

Anderson update took 99.158 ms, out of which F'*F took 46.538 ms; b-Ax took 316.334 ms, out of which Lap took 280.611 ms
Solving Poisson took 700.695 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.169800 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.178926 
Total time for convolution: 	 convolve: 5.208329 
Total time for convolution: 	 convolve: 5.177081 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 0.834 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 3.534 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.436 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.005 ms

This SCF took 27732.970 ms, scf error = 2.235e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.140139, lowerbound = -1.016157, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1679.976 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 21.763 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.853 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.633 ms
rank =  0, finding HY took 26.274 ms
rank =  0, distributing HY into block cyclic form took 21.394 ms
rank =  0, finding Y'*HY took 4.395 ms
Rank 0, Project_Hamiltonian used 76.724 ms
Total time for projection: 76.738 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.592 ms
rank = 0, Solve_Generalized_EigenProblem used 1.109 ms
    first calculated eigval = -1.015695880712345
    last  calculated eigval = 0.040745113043326
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48239838583392
lambda[   6] =  -0.46183282045156
lambda[   7] =  -0.45622416565474
lambda[   8] =  -0.41386429485151
lambda[   9] =  -0.35998540971443
lambda[  10] =  -0.34998456757838
lambda[  11] =  -0.34287631431951
lambda[  12] =  -0.30771201372617
lambda[  13] =  -0.25920973298475
lambda[  14] =  -0.23279191050487
lambda[  15] =  -0.02831510301325
lambda[  16] =  -0.02095036100092
lambda[  17] =   0.01495032972635
lambda[  18] =   0.01898202310431
lambda[  19] =   0.02100900580839
lambda[  20] =   0.02567889687703
lambda[  21] =   0.04074511304333
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 1.167 ms
rank =  0, subspace rotation using ScaLAPACK took 9.534 ms
rank =  0, Distributing orbital back into band + domain format took 20.890 ms
rank = 0, Subspace_Rotation used 30.437 ms

Total time for subspace rotation: 30.443 ms
rank = 0, Efermi =  -0.057169781779 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 6.235 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.062 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1807.322 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.900 ms
rank = 0, D2D took 1.994 ms
rank = 0, Transfering density took 1.996 ms
Etot    =   -53.505408346076
Eband   =   -13.873190636210
E1      =    30.154621279113
E2      =   -13.168589117857
E3      =   -18.143835088159
Exc     =   -16.202029783749
Esc     =   -84.897233410406
Entropy =    -0.000000000840
dE = 7.645e-06, dEband = 1.379e-03
rank = 0, Calculating/Estimating energy took 1.031 ms, Etot = -53.505408346, dEtot = 7.645e-06, dEband = 1.379e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0322338402047, which took 0.060 ms

iter_count = 114, r_2norm = 8.125e-07, tol*||rhs|| = 1.289e-06

Anderson update took 67.772 ms, out of which F'*F took 31.686 ms; b-Ax took 216.323 ms, out of which Lap took 192.312 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.700 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002824006, int_b + int_rho = -6.912e-14, checking this took 0.140 ms
2-norm of RHS = 729.7546817678060, which took 0.143 ms

iter_count = 144, r_2norm = 7.043e-04, tol*||rhs|| = 7.298e-04

Anderson update took 85.109 ms, out of which F'*F took 39.968 ms; b-Ax took 271.938 ms, out of which Lap took 240.931 ms
Solving Poisson took 603.595 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.137 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.171475 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.581 ms
Total time for convolution: 	 convolve: 5.187238 
Total time for convolution: 	 convolve: 5.166568 
Total time for convolution: 	 convolve: 5.195472 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.592 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.466 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.093 ms

This SCF took 27627.820 ms, scf error = 1.455e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.140745, lowerbound = -1.015696, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1683.247 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 21.141 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.791 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.513 ms
rank =  0, finding HY took 26.646 ms
rank =  0, distributing HY into block cyclic form took 21.164 ms
rank =  0, finding Y'*HY took 4.410 ms
Rank 0, Project_Hamiltonian used 76.765 ms
Total time for projection: 76.774 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -1.015532807861009
    last  calculated eigval = 0.040662686155605
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48224913502216
lambda[   6] =  -0.46168476743506
lambda[   7] =  -0.45606803989774
lambda[   8] =  -0.41370148602925
lambda[   9] =  -0.35983264060192
lambda[  10] =  -0.34983548690083
lambda[  11] =  -0.34272357564015
lambda[  12] =  -0.30755672387036
lambda[  13] =  -0.25904571002877
lambda[  14] =  -0.23263121308062
lambda[  15] =  -0.02814282452338
lambda[  16] =  -0.01990341538924
lambda[  17] =   0.01516885982705
lambda[  18] =   0.01941509491402
lambda[  19] =   0.02185705125891
lambda[  20] =   0.02596957732438
lambda[  21] =   0.04066268615561
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.249 ms
rank =  0, subspace rotation using ScaLAPACK took 9.560 ms
rank =  0, Distributing orbital back into band + domain format took 20.970 ms
rank = 0, Subspace_Rotation used 30.542 ms

Total time for subspace rotation: 30.547 ms
rank = 0, Efermi =  -0.056997431339 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 6.265 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.017 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.565 ms
rank = 0, Calculating density took 1809.798 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.896 ms
rank = 0, D2D took 1.992 ms
rank = 0, Transfering density took 1.995 ms
Etot    =   -53.505439182378
Eband   =   -13.868833332303
E1      =    30.152539219742
E2      =   -13.166268523667
E3      =   -18.143946354157
Exc     =   -16.202126536395
Esc     =   -84.897233410406
Entropy =    -0.000000000840
dE = 3.426e-06, dEband = 4.841e-04
rank = 0, Calculating/Estimating energy took 0.993 ms, Etot = -53.505439182, dEtot = 3.426e-06, dEband = 4.841e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0250302956415, which took 0.062 ms

iter_count = 114, r_2norm = 5.964e-07, tol*||rhs|| = 1.001e-06

Anderson update took 68.258 ms, out of which F'*F took 31.745 ms; b-Ax took 216.081 ms, out of which Lap took 192.425 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 487.982 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002824003, int_b + int_rho = -9.823e-14, checking this took 0.108 ms
2-norm of RHS = 729.7569302634519, which took 0.172 ms

iter_count = 138, r_2norm = 6.009e-04, tol*||rhs|| = 7.298e-04

Anderson update took 81.601 ms, out of which F'*F took 37.901 ms; b-Ax took 260.406 ms, out of which Lap took 230.305 ms
Solving Poisson took 577.492 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.125 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.131 ms
Total time for convolution: 	 convolve: 5.190698 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.382 ms
Total time for convolution: 	 convolve: 5.164735 
Total time for convolution: 	 convolve: 5.181099 
Total time for convolution: 	 convolve: 5.160449 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.512 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.482 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.207 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.721 ms

This SCF took 27640.633 ms, scf error = 1.088e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.140663, lowerbound = -1.015533, upperbound = 267.582660

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1676.636 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.200 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.815 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.034 ms
rank =  0, finding HY took 26.528 ms
rank =  0, distributing HY into block cyclic form took 21.324 ms
rank =  0, finding Y'*HY took 4.366 ms
Rank 0, Project_Hamiltonian used 76.285 ms
Total time for projection: 76.297 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -1.015398194826109
    last  calculated eigval = 0.040603679672581
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48211539255910
lambda[   6] =  -0.46155564859284
lambda[   7] =  -0.45593530990849
lambda[   8] =  -0.41355969774022
lambda[   9] =  -0.35970005717076
lambda[  10] =  -0.34970226443380
lambda[  11] =  -0.34259003313113
lambda[  12] =  -0.30742492222406
lambda[  13] =  -0.25891061633505
lambda[  14] =  -0.23249416148844
lambda[  15] =  -0.02800999243151
lambda[  16] =  -0.01918984220780
lambda[  17] =   0.01497632424542
lambda[  18] =   0.01942666991542
lambda[  19] =   0.02221211400467
lambda[  20] =   0.02617596790093
lambda[  21] =   0.04060367967258
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 9.490 ms
rank =  0, Distributing orbital back into band + domain format took 20.995 ms
rank = 0, Subspace_Rotation used 30.497 ms

Total time for subspace rotation: 30.503 ms
rank = 0, Efermi =  -0.056864582119 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 6.208 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.143 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.570 ms
rank = 0, Calculating density took 1803.173 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.907 ms
rank = 0, D2D took 2.010 ms
rank = 0, Transfering density took 2.016 ms
Etot    =   -53.505463839195
Eband   =   -13.865077445419
E1      =    30.150733985143
E2      =   -13.164257356240
E3      =   -18.144116290811
Exc     =   -16.202260614725
Esc     =   -84.897233410406
Entropy =    -0.000000000840
dE = 2.740e-06, dEband = 4.173e-04
rank = 0, Calculating/Estimating energy took 0.989 ms, Etot = -53.505463839, dEtot = 2.740e-06, dEband = 4.173e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0215517010931, which took 0.123 ms

iter_count = 108, r_2norm = 8.110e-07, tol*||rhs|| = 8.621e-07

Anderson update took 64.091 ms, out of which F'*F took 29.597 ms; b-Ax took 203.662 ms, out of which Lap took 180.801 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.181 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002824013, int_rho =  28.00000002824017, int_b + int_rho = 4.002e-14, checking this took 0.098 ms
2-norm of RHS = 729.7576406359567, which took 0.124 ms

iter_count = 120, r_2norm = 6.472e-04, tol*||rhs|| = 7.298e-04

Anderson update took 70.986 ms, out of which F'*F took 33.361 ms; b-Ax took 226.615 ms, out of which Lap took 200.454 ms
Solving Poisson took 504.170 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.184978 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.375 ms
Total time for convolution: 	 convolve: 5.167757 
Total time for convolution: 	 convolve: 5.198318 
Total time for convolution: 	 convolve: 5.197267 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.698 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
---Transfer Veff_loc: D2D took 3.525 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.670 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.637 ms

This SCF took 27525.046 ms, scf error = 8.503e-05
The last 17 occupations of kpoints #1 are (Nelectron = 28):
lambda[   5] =  -0.48211539255910, occ[   5] =   2.00000000000000
lambda[   6] =  -0.46155564859284, occ[   6] =   2.00000000000000
lambda[   7] =  -0.45593530990849, occ[   7] =   2.00000000000000
lambda[   8] =  -0.41355969774022, occ[   8] =   2.00000000000000
lambda[   9] =  -0.35970005717076, occ[   9] =   2.00000000000000
lambda[  10] =  -0.34970226443380, occ[  10] =   2.00000000000000
lambda[  11] =  -0.34259003313113, occ[  11] =   2.00000000000000
lambda[  12] =  -0.30742492222406, occ[  12] =   2.00000000000000
lambda[  13] =  -0.25891061633505, occ[  13] =   2.00000000000000
lambda[  14] =  -0.23249416148844, occ[  14] =   2.00000000000000
lambda[  15] =  -0.02800999243151, occ[  15] =   0.00000002823966
lambda[  16] =  -0.01918984220780, occ[  16] =   0.00000000000042
lambda[  17] =   0.01497632424542, occ[  17] =   0.00000000000000
lambda[  18] =   0.01942666991542, occ[  18] =   0.00000000000000
lambda[  19] =   0.02221211400467, occ[  19] =   0.00000000000000
lambda[  20] =   0.02617596790093, occ[  20] =   0.00000000000000
lambda[  21] =   0.04060367967258, occ[  21] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 19 (90%) = 0.000000000000000.
Occupation of state 21 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.813 ms, time for Allreduce/Reduce: 10.606 ms 
Time for calculating local force components: 23.683 ms
Start Calculating nonlocal forces
force_nloc = 
  1.01030622348090  -0.04487663537069   0.00000018920216
  0.06279156603145  -1.25451046283435  -0.00000028448137
 -0.02937094292912  -0.00001014179728  -0.04095857293947
 -0.02937092710486  -0.00001012703002   0.04095855416892
  0.00642169641177   0.02919860029190   0.04228977079841
  0.00642170152365   0.02919861882377  -0.04228977589044
 -0.13769388278426  -0.00820581535234   0.00000015574045
 -0.04389662575986   0.00279267190863  -0.00000029331129
 -0.09686344283870   0.16803763964739   0.00000001885354
force_loc = 
 -0.99525554185308   0.04147055239495   0.00000010853489
 -0.06305966740090   1.24053462863929  -0.00000079276455
  0.03015983727095   0.00016840545883   0.04219390017731
  0.03015866611837   0.00016805443542  -0.04219330705221
 -0.00686876473367  -0.02964846158030  -0.04370481354688
 -0.00686886115869  -0.02964825561744   0.04370398894119
  0.14096072649374  -0.01213283913356   0.00000032666097
  0.04229300119739  -0.00462817671664   0.00000031622522
  0.09887034561832  -0.16454659313912  -0.00000020285556
Time for calculating nonlocal force components: 46.179 ms
[32mforces_xc: 
[0m[32m -0.02824519845790   0.00367253250492   0.00000000569487
[0m[32m -0.00101922512871   0.02826929038854  -0.00000004812856
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00473253808570   0.01239596546232   0.00000006670932
[0m[32m  0.00076388319260   0.00055801434779   0.00000001043114
[0m[32m  0.00433669797530  -0.00778777489761  -0.00000005430687
[0mTime for calculating XC forces components: 34.360 ms
 Cartesian force = 
 -0.01316160608013   0.00021537276980   0.00000038489180
 -0.00125441574821   0.01424237943410  -0.00000104391462
  0.00082180509179   0.00010718690217   0.00123540869771
  0.00082064976346   0.00010685064602  -0.00123467142342
 -0.00041415757194  -0.00050093804778  -0.00141496128860
 -0.00041424888508  -0.00050071355305   0.00141429451061
  0.00803229254513  -0.00799376578296   0.00000063057061
 -0.00080683061991  -0.00132856721960   0.00000011480494
  0.00637651150488  -0.00434780514871  -0.00000015684902
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.371 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.364 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Time for printing density: 387.762 ms
The program took 455.757 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:35:35
Job ID:        2266890
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:33:12,vmem=8344K,walltime=00:07:46,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-11-1
---------------------------------------
