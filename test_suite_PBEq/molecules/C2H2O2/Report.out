---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:25
Job ID:    2266692
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:32
Job ID:    2266692
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.064 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 15.562 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 6.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 10.177 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 87.924 ms

Freeing SPARC_INPUT_MPI datatype took 0.007 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.949 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.088 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.068411	   12.638434	   10.000000	
   11.931589	    7.361566	   10.000000	
   11.914612	   12.298965	   10.000000	
    8.085388	    7.701035	   10.000000	
   10.000000	   11.442288	   10.000000	
   10.000000	    8.557712	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.163 ms
Set up communicators.

--set up spincomm took 2.234 ms

--set up kptcomm took 0.368 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 2}
gridsizes = [100, 100, 100], Nstates = 18, dmcomm dims = [1, 1, 2]

--set up dmcomm took 0.005 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 6, ScaLAPACK topology Dims = (6, 1)
nproc = 12, size_blacscomm = 6 = dims[0] * dims[1] = (6, 1)
Nd_blacscomm 500000, Nstates 18 
rank =  0, my blacs rank = 0, BLCYC size (500000, 3), actual size (500000, 3)
rank = 0, mb = nb = 18, mbQ = nbQ = 64
rank = 0, nr_Hp = 18, nc_Hp = 18
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.059 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 6
# of bands per bandcomm          : 3
npdomain: 2
Embeded Cartesian topology dims: (1,1,2)
# of FD-grid points per processor: 500000 = (100,100,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.009 ms

Calculate_SplineDerivRadFun took 0.210 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.794 ms.
time spent on vectorized spline interp: 3.587 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.771 ms.
time spent on vectorized spline interp: 1.606 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.294 ms.
time spent on vectorized spline interp: 1.863 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.280 ms.

Calculating rb for all atom types took 17.207 ms
----------------------
Estimated memory usage
Total: 1.11 GB
orbitals             : 823.97 MB
global sized vectors : 213.62 MB
subspace matrices : 15.19 kB
others : 103.76 MB
----------------------------------------------
Estimated memory usage per processor: 95.11 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.098 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -22.0000000132656, sum_int_rho = 21.7905151605260
PosCharge = 22.000000013266, NegCharge = -21.790515160526, scal_fac = 1.009613579633
After scaling, int_rho = 22.0000000132655, PosCharge + NegCharge - NetCharge = 1.243e-13
--Calculate Vref took 0.421 ms
--Calculate rho_guess took 2.291 ms

 integral of b = -22.0000000132656,
 int{b} + Nelectron + NetCharge = -1.327e-08,
 Esc = -71.6380973470379,
 MPI_Reduce took 4.680 ms

Calculating b & b_ref took 13.326 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.041 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.051 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.043 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.348 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 34.205 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326563, int_b + int_rho = 8.367e-14, checking this took 0.195 ms
2-norm of RHS = 616.6746015941451, which took 0.131 ms

iter_count = 420, r_2norm = 5.786e-04, tol*||rhs|| = 6.167e-04

Anderson update took 260.145 ms, out of which F'*F took 116.923 ms; b-Ax took 789.362 ms, out of which Lap took 702.564 ms
Solving Poisson took 1757.324 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.424 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
Total time for convolution: 	 convolve: 5.118244 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.143 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.769 ms
Total time for convolution: 	 convolve: 5.107354 
Total time for convolution: 	 convolve: 5.112164 
Total time for convolution: 	 convolve: 5.108211 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.643 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.375 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
rank = 0, XC calculation took 24313.170 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 2.704 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 5.268 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 9.084 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.140 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.846 ms
    Lanczos iter 53, eigmin  = -1.097383992, eigmax = 264.926057735, err_eigmin = 3.487e-04, err_eigmax = 9.640e-03
rank =   0, Lanczos took 135.148 ms, eigmin = -1.097383992206, eigmax = 267.575318312808

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.188967, lowerbound = -1.197384, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1730.471 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.444 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.793 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.297 ms
rank =  0, Distribute data + matrix mult took 23.558 ms
rank =  0, finding HY took 30.033 ms
rank =  0, distributing HY into block cyclic form took 18.786 ms
rank =  0, finding Y'*HY took 5.672 ms
Rank 0, Project_Hamiltonian used 78.091 ms
Total time for projection: 78.106 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.582 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.631 ms
rank = 0, Solve_Generalized_EigenProblem used 1.653 ms
    first calculated eigval = 2.737819259076245
    last  calculated eigval = 3.223263870807801
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =   2.78428962207641
lambda[   3] =   2.81446342184737
lambda[   4] =   2.83103797715373
lambda[   5] =   2.86309283008106
lambda[   6] =   2.88638760775097
lambda[   7] =   2.90786825942816
lambda[   8] =   2.95101996513532
lambda[   9] =   2.96236969972677
lambda[  10] =   2.98530807416135
lambda[  11] =   3.00859309135427
lambda[  12] =   3.06301897472030
lambda[  13] =   3.08543075731519
lambda[  14] =   3.11669296821497
lambda[  15] =   3.11882496727291
lambda[  16] =   3.15631998517516
lambda[  17] =   3.21882230838915
lambda[  18] =   3.22326387080780
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 1.667 ms
rank =  0, subspace rotation using ScaLAPACK took 8.229 ms
rank =  0, Distributing orbital back into band + domain format took 18.100 ms
rank = 0, Subspace_Rotation used 26.345 ms

Total time for subspace rotation: 26.348 ms
rank = 0, Efermi =   3.035844845376 calculate fermi energy took 0.061 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.323264, lowerbound = -1.197384, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1712.299 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 19.201 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.786 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 23.019 ms
rank =  0, finding HY took 28.534 ms
rank =  0, distributing HY into block cyclic form took 18.111 ms
rank =  0, finding Y'*HY took 5.253 ms
Rank 0, Project_Hamiltonian used 74.952 ms
Total time for projection: 74.956 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.080 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -0.970251374730044
    last  calculated eigval = 0.441121162711259
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81758326489161
lambda[   3] =  -0.43682645620274
lambda[   4] =  -0.35142557767094
lambda[   5] =  -0.21569809470257
lambda[   6] =  -0.16049100772266
lambda[   7] =   0.00786595897576
lambda[   8] =   0.04752928950507
lambda[   9] =   0.12414653148571
lambda[  10] =   0.15810125283390
lambda[  11] =   0.23289999669361
lambda[  12] =   0.30076737957114
lambda[  13] =   0.33919863246161
lambda[  14] =   0.34537254221499
lambda[  15] =   0.37840764530508
lambda[  16] =   0.38647390278955
lambda[  17] =   0.41923961724941
lambda[  18] =   0.44112116271126
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 5.203 ms
rank =  0, Distributing orbital back into band + domain format took 20.862 ms
rank = 0, Subspace_Rotation used 26.086 ms

Total time for subspace rotation: 26.091 ms
rank = 0, Efermi =   0.271234079314 calculate fermi energy took 0.028 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.541121, lowerbound = -1.197384, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1727.397 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.048 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.849 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 22.527 ms
rank =  0, finding HY took 28.979 ms
rank =  0, distributing HY into block cyclic form took 18.155 ms
rank =  0, finding Y'*HY took 5.272 ms
Rank 0, Project_Hamiltonian used 74.974 ms
Total time for projection: 74.978 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.157 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.242 ms
    first calculated eigval = -1.099688385732357
    last  calculated eigval = 0.137719863805517
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -1.08995617987581
lambda[   3] =  -0.71203144362224
lambda[   4] =  -0.61679429616714
lambda[   5] =  -0.52997789440009
lambda[   6] =  -0.52410259373566
lambda[   7] =  -0.49119946220577
lambda[   8] =  -0.46263075633881
lambda[   9] =  -0.41035751825957
lambda[  10] =  -0.35227951181056
lambda[  11] =  -0.25002717419718
lambda[  12] =  -0.17125451702962
lambda[  13] =   0.02733152449083
lambda[  14] =   0.09070782537602
lambda[  15] =   0.10448294816192
lambda[  16] =   0.11745643034310
lambda[  17] =   0.13010044676876
lambda[  18] =   0.13771986380552
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 7.907 ms
rank =  0, Distributing orbital back into band + domain format took 18.183 ms
rank = 0, Subspace_Rotation used 26.108 ms

Total time for subspace rotation: 26.113 ms
rank = 0, Efermi =  -0.200787828213 calculate fermi energy took 0.026 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.237720, lowerbound = -1.197384, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1722.087 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.095 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.877 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 22.002 ms
rank =  0, finding HY took 28.588 ms
rank =  0, distributing HY into block cyclic form took 18.159 ms
rank =  0, finding Y'*HY took 5.341 ms
Rank 0, Project_Hamiltonian used 74.129 ms
Total time for projection: 74.134 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.074 ms
rank = 0, Solve_Generalized_EigenProblem used 0.199 ms
    first calculated eigval = -1.099851675419864
    last  calculated eigval = 0.081917587330937
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -1.09014667198128
lambda[   3] =  -0.71439472749039
lambda[   4] =  -0.61778693204395
lambda[   5] =  -0.53386086509653
lambda[   6] =  -0.53115221099113
lambda[   7] =  -0.50162756339275
lambda[   8] =  -0.47138866079897
lambda[   9] =  -0.43389952760187
lambda[  10] =  -0.37385730997818
lambda[  11] =  -0.30927414831230
lambda[  12] =  -0.20734073784874
lambda[  13] =  -0.06481657085451
lambda[  14] =   0.03530106055018
lambda[  15] =   0.05195231289324
lambda[  16] =   0.06076472372651
lambda[  17] =   0.07228766457799
lambda[  18] =   0.08191758733094
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 6.067 ms
rank =  0, Distributing orbital back into band + domain format took 20.055 ms
rank = 0, Subspace_Rotation used 26.137 ms

Total time for subspace rotation: 26.142 ms
rank = 0, Efermi =  -0.236874049025 calculate fermi energy took 0.025 ms
rank = 0, --- Calculate rho: sum over local bands took 5.144 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.135 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.361 ms
rank = 0, Calculating density took 7450.780 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.268 ms
rank = 0, D2D took 1.412 ms
rank = 0, Transfering density took 1.422 ms
Etot    =   -46.332388818518
Eband   =   -13.354480588965
E1      =    25.625099090508
E2      =   -11.646030748855
E3      =   -14.232463374293
Exc     =   -12.843404095767
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 7.722e+00, dEband = 2.226e+00
rank = 0, Calculating/Estimating energy took 0.980 ms, Etot = -46.332388819, dEtot = 7.722e+00, dEband = 2.226e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 67.6947199981377, which took 0.044 ms

iter_count = 90, r_2norm = 2.104e-03, tol*||rhs|| = 2.708e-03

Anderson update took 53.733 ms, out of which F'*F took 25.423 ms; b-Ax took 169.619 ms, out of which Lap took 150.919 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 381.015 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326551, int_b + int_rho = -3.638e-14, checking this took 0.147 ms
2-norm of RHS = 612.3969045428255, which took 0.166 ms

iter_count = 282, r_2norm = 5.072e-04, tol*||rhs|| = 6.124e-04

Anderson update took 166.597 ms, out of which F'*F took 78.825 ms; b-Ax took 532.146 ms, out of which Lap took 472.260 ms
Solving Poisson took 1174.138 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.861 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.619 ms
Total time for convolution: 	 convolve: 5.150306 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.001 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
Total time for convolution: 	 convolve: 5.130431 
Total time for convolution: 	 convolve: 5.127104 
Total time for convolution: 	 convolve: 5.126278 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.584 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.540 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.836 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.750 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.611 ms

This SCF took 33523.237 ms, scf error = 1.413e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.181918, lowerbound = -1.099852, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1731.505 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.592 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.833 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 22.450 ms
rank =  0, finding HY took 28.453 ms
rank =  0, distributing HY into block cyclic form took 18.699 ms
rank =  0, finding Y'*HY took 6.094 ms
Rank 0, Project_Hamiltonian used 75.741 ms
Total time for projection: 75.757 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -1.064721947137384
    last  calculated eigval = 0.056714236473988
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -1.05320575348905
lambda[   3] =  -0.69771283086918
lambda[   4] =  -0.59891166015799
lambda[   5] =  -0.50620091424661
lambda[   6] =  -0.49717119333726
lambda[   7] =  -0.46797130303493
lambda[   8] =  -0.45017261116248
lambda[   9] =  -0.40599987091437
lambda[  10] =  -0.33808741628882
lambda[  11] =  -0.27916491762642
lambda[  12] =  -0.18953029873097
lambda[  13] =  -0.06940299874822
lambda[  14] =   0.01086436990131
lambda[  15] =   0.02480651672356
lambda[  16] =   0.03836253099298
lambda[  17] =   0.04347243993866
lambda[  18] =   0.05671423647399
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 8.547 ms
rank =  0, Distributing orbital back into band + domain format took 17.664 ms
rank = 0, Subspace_Rotation used 26.235 ms

Total time for subspace rotation: 26.241 ms
rank = 0, Efermi =  -0.219063609930 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.438 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.608 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.368 ms
rank = 0, Calculating density took 1846.228 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.200 ms
rank = 0, D2D took 1.322 ms
rank = 0, Transfering density took 1.329 ms
Etot    =   -46.293589620094
Eband   =   -12.718640839043
E1      =    25.095381701347
E2      =   -11.542135335132
E3      =   -14.406457039380
Exc     =   -12.980825509468
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 6.467e-03, dEband = 1.060e-01
rank = 0, Calculating/Estimating energy took 0.975 ms, Etot = -46.293589620, dEtot = 6.467e-03, dEband = 1.060e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 34.8859287261559, which took 0.072 ms

iter_count = 96, r_2norm = 9.141e-04, tol*||rhs|| = 1.395e-03

Anderson update took 56.816 ms, out of which F'*F took 27.042 ms; b-Ax took 180.654 ms, out of which Lap took 160.892 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 408.560 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326551, int_b + int_rho = -3.638e-14, checking this took 0.143 ms
2-norm of RHS = 609.7554182043151, which took 0.146 ms

iter_count = 288, r_2norm = 5.209e-04, tol*||rhs|| = 6.098e-04

Anderson update took 169.592 ms, out of which F'*F took 80.125 ms; b-Ax took 543.129 ms, out of which Lap took 481.545 ms
Solving Poisson took 1195.256 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.136466 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.413 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.125495 
Total time for convolution: 	 convolve: 5.134027 
Total time for convolution: 	 convolve: 5.143560 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.737 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.529 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 1.862 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.755 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.647 ms

This SCF took 28026.544 ms, scf error = 9.478e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.156714, lowerbound = -1.064722, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1698.008 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 34.229 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.028 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.004 ms
rank =  0, Distribute data + matrix mult took 38.279 ms
rank =  0, finding HY took 29.137 ms
rank =  0, distributing HY into block cyclic form took 18.678 ms
rank =  0, finding Y'*HY took 5.410 ms
Rank 0, Project_Hamiltonian used 91.546 ms
Total time for projection: 91.562 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.149 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.230 ms
    first calculated eigval = -1.028014297961879
    last  calculated eigval = 0.044848275085653
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -1.01553501340195
lambda[   3] =  -0.66846623461248
lambda[   4] =  -0.56814443709249
lambda[   5] =  -0.47332629015942
lambda[   6] =  -0.46022434982716
lambda[   7] =  -0.43106687522965
lambda[   8] =  -0.42763084777851
lambda[   9] =  -0.38056771074600
lambda[  10] =  -0.30257693220391
lambda[  11] =  -0.24604557174131
lambda[  12] =  -0.16691920643317
lambda[  13] =  -0.05179353723757
lambda[  14] =   0.00103660317704
lambda[  15] =   0.00869546518268
lambda[  16] =   0.02876616216310
lambda[  17] =   0.03262186377806
lambda[  18] =   0.04484827508565
==subpsace eigenproblem: bcast eigvals took 0.043 ms
Total time for solving subspace eigenvalue problem: 0.278 ms
rank =  0, subspace rotation using ScaLAPACK took 8.507 ms
rank =  0, Distributing orbital back into band + domain format took 17.555 ms
rank = 0, Subspace_Rotation used 26.084 ms

Total time for subspace rotation: 26.091 ms
rank = 0, Efermi =  -0.196452517652 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 4.607 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.430 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.398 ms
rank = 0, Calculating density took 1828.014 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.192 ms
rank = 0, D2D took 1.309 ms
rank = 0, Transfering density took 1.315 ms
Etot    =   -46.268349779159
Eband   =   -12.003197123724
E1      =    24.523324530523
E2      =   -11.381876249410
E3      =   -14.609509982274
Exc     =   -13.141766070200
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 4.207e-03, dEband = 1.192e-01
rank = 0, Calculating/Estimating energy took 1.008 ms, Etot = -46.268349779, dEtot = 4.207e-03, dEband = 1.192e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.0564072634422, which took 0.057 ms

iter_count = 102, r_2norm = 2.010e-04, tol*||rhs|| = 2.023e-04

Anderson update took 60.073 ms, out of which F'*F took 28.694 ms; b-Ax took 192.392 ms, out of which Lap took 171.495 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 433.457 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326546, int_b + int_rho = -8.731e-14, checking this took 0.145 ms
2-norm of RHS = 610.4881329053215, which took 0.135 ms

iter_count = 282, r_2norm = 4.958e-04, tol*||rhs|| = 6.105e-04

Anderson update took 166.271 ms, out of which F'*F took 78.871 ms; b-Ax took 533.940 ms, out of which Lap took 472.844 ms
Solving Poisson took 1171.083 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.151901 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.666 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.136688 
Total time for convolution: 	 convolve: 5.173929 
Total time for convolution: 	 convolve: 5.131496 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.860 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.737 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.620 ms

This SCF took 28160.572 ms, scf error = 4.186e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.144848, lowerbound = -1.028014, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1747.499 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.512 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.604 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 22.145 ms
rank =  0, finding HY took 28.137 ms
rank =  0, distributing HY into block cyclic form took 18.350 ms
rank =  0, finding Y'*HY took 5.432 ms
Rank 0, Project_Hamiltonian used 74.096 ms
Total time for projection: 74.112 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.622 ms
rank = 0, Solve_Generalized_EigenProblem used 1.430 ms
    first calculated eigval = -1.012262258770632
    last  calculated eigval = 0.039587934346714
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -1.00004449279756
lambda[   3] =  -0.64910110446813
lambda[   4] =  -0.54733467026016
lambda[   5] =  -0.45369194893880
lambda[   6] =  -0.44465260722805
lambda[   7] =  -0.41737242859447
lambda[   8] =  -0.41431979230281
lambda[   9] =  -0.37162029680323
lambda[  10] =  -0.28808064272143
lambda[  11] =  -0.23103892848625
lambda[  12] =  -0.15655520125401
lambda[  13] =  -0.04042116340719
lambda[  14] =  -0.00891101764277
lambda[  15] =   0.00433562429727
lambda[  16] =   0.02451491626216
lambda[  17] =   0.02875318612553
lambda[  18] =   0.03958793434671
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.450 ms
rank =  0, subspace rotation using ScaLAPACK took 5.007 ms
rank =  0, Distributing orbital back into band + domain format took 20.461 ms
rank = 0, Subspace_Rotation used 25.482 ms

Total time for subspace rotation: 25.487 ms
rank = 0, Efermi =  -0.186088512405 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 4.408 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.768 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.906 ms
rank = 0, Calculating density took 1860.767 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.302 ms
rank = 0, D2D took 1.525 ms
rank = 0, Transfering density took 1.534 ms
Etot    =   -46.262353066184
Eband   =   -11.659038344820
E1      =    24.282751077786
E2      =   -11.261963447452
E3      =   -14.712910771417
Exc     =   -13.222842670579
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 9.995e-04, dEband = 5.736e-02
rank = 0, Calculating/Estimating energy took 0.969 ms, Etot = -46.262353066, dEtot = 9.995e-04, dEband = 5.736e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.6042202547906, which took 0.126 ms

iter_count = 108, r_2norm = 5.215e-05, tol*||rhs|| = 6.417e-05

Anderson update took 63.862 ms, out of which F'*F took 30.422 ms; b-Ax took 203.502 ms, out of which Lap took 181.223 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.369 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326547, int_b + int_rho = -8.004e-14, checking this took 0.129 ms
2-norm of RHS = 611.6586851947250, which took 0.200 ms

iter_count = 264, r_2norm = 5.332e-04, tol*||rhs|| = 6.117e-04

Anderson update took 155.765 ms, out of which F'*F took 77.360 ms; b-Ax took 502.769 ms, out of which Lap took 445.943 ms
Solving Poisson took 1098.392 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.121958 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.015 ms
======D2D: initiated sending and receiving took 1.665 ms
Total time for convolution: 	 convolve: 5.127567 
Total time for convolution: 	 convolve: 5.140690 
Total time for convolution: 	 convolve: 5.136487 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.860 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.710 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.601 ms

This SCF took 28412.421 ms, scf error = 1.084e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.139588, lowerbound = -1.012262, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1704.901 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 18.058 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.752 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.842 ms
rank =  0, finding HY took 28.199 ms
rank =  0, distributing HY into block cyclic form took 18.352 ms
rank =  0, finding Y'*HY took 5.448 ms
Rank 0, Project_Hamiltonian used 74.480 ms
Total time for projection: 74.498 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -1.009583507374065
    last  calculated eigval = 0.036553561716659
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.99729158323739
lambda[   3] =  -0.64665784534278
lambda[   4] =  -0.54367776356243
lambda[   5] =  -0.45032625560635
lambda[   6] =  -0.44076833837023
lambda[   7] =  -0.41579281726334
lambda[   8] =  -0.41040568380079
lambda[   9] =  -0.36950869377154
lambda[  10] =  -0.28450653689160
lambda[  11] =  -0.22753279739942
lambda[  12] =  -0.15497304463818
lambda[  13] =  -0.03948766800914
lambda[  14] =  -0.01582709183973
lambda[  15] =   0.00258867709502
lambda[  16] =   0.02254509400974
lambda[  17] =   0.02675418578948
lambda[  18] =   0.03655356171666
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 7.929 ms
rank =  0, Distributing orbital back into band + domain format took 18.090 ms
rank = 0, Subspace_Rotation used 26.034 ms

Total time for subspace rotation: 26.039 ms
rank = 0, Efermi =  -0.184506355809 calculate fermi energy took 1.571 ms
rank = 0, --- Calculate rho: sum over local bands took 5.007 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.193 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.352 ms
rank = 0, Calculating density took 1817.844 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.202 ms
rank = 0, D2D took 1.377 ms
rank = 0, Transfering density took 1.384 ms
Etot    =   -46.261455560520
Eband   =   -11.592103647296
E1      =    24.265841540836
E2      =   -11.206832547182
E3      =   -14.732235002414
Exc     =   -13.236163656215
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 1.496e-04, dEband = 1.116e-02
rank = 0, Calculating/Estimating energy took 1.015 ms, Etot = -46.261455561, dEtot = 1.496e-04, dEband = 1.116e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8829112705765, which took 0.061 ms

iter_count = 108, r_2norm = 2.746e-05, tol*||rhs|| = 3.532e-05

Anderson update took 63.835 ms, out of which F'*F took 30.484 ms; b-Ax took 203.691 ms, out of which Lap took 181.506 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.604 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326547, int_b + int_rho = -7.640e-14, checking this took 0.150 ms
2-norm of RHS = 612.0625835630643, which took 0.131 ms

iter_count = 240, r_2norm = 5.880e-04, tol*||rhs|| = 6.121e-04

Anderson update took 142.794 ms, out of which F'*F took 67.522 ms; b-Ax took 454.219 ms, out of which Lap took 402.786 ms
Solving Poisson took 998.518 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.192 ms
Total time for convolution: 	 convolve: 5.134491 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.127728 
Total time for convolution: 	 convolve: 5.132033 
Total time for convolution: 	 convolve: 5.138495 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.585 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 2.107 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.435 ms

This SCF took 27834.446 ms, scf error = 4.131e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.136554, lowerbound = -1.009584, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1706.411 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.085 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.786 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.903 ms
rank =  0, finding HY took 28.282 ms
rank =  0, distributing HY into block cyclic form took 17.995 ms
rank =  0, finding Y'*HY took 6.688 ms
Rank 0, Project_Hamiltonian used 74.911 ms
Total time for projection: 74.926 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.152 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.238 ms
    first calculated eigval = -1.009272515184112
    last  calculated eigval = 0.034614693707618
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.99695652506534
lambda[   3] =  -0.64652260038129
lambda[   4] =  -0.54351655969046
lambda[   5] =  -0.45004887382301
lambda[   6] =  -0.44002406595322
lambda[   7] =  -0.41543290848426
lambda[   8] =  -0.40980137375268
lambda[   9] =  -0.36893440985398
lambda[  10] =  -0.28391592375675
lambda[  11] =  -0.22699941895005
lambda[  12] =  -0.15465174662718
lambda[  13] =  -0.03955570188495
lambda[  14] =  -0.01949245108947
lambda[  15] =   0.00137671246922
lambda[  16] =   0.02148244373304
lambda[  17] =   0.02577257142297
lambda[  18] =   0.03461469370762
==subpsace eigenproblem: bcast eigvals took 0.042 ms
Total time for solving subspace eigenvalue problem: 0.291 ms
rank =  0, subspace rotation using ScaLAPACK took 6.168 ms
rank =  0, Distributing orbital back into band + domain format took 18.812 ms
rank = 0, Subspace_Rotation used 24.998 ms

Total time for subspace rotation: 25.004 ms
rank = 0, Efermi =  -0.184185057780 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 4.739 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.476 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.469 ms
rank = 0, Calculating density took 1818.841 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.233 ms
rank = 0, D2D took 1.752 ms
rank = 0, Transfering density took 1.759 ms
Etot    =   -46.261381455855
Eband   =   -11.582850351842
E1      =    24.273462640387
E2      =   -11.189434682149
E3      =   -14.731263311826
Exc     =   -13.234594390934
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 1.235e-05, dEband = 1.542e-03
rank = 0, Calculating/Estimating energy took 0.987 ms, Etot = -46.261381456, dEtot = 1.235e-05, dEband = 1.542e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3395181995873, which took 0.133 ms

iter_count = 108, r_2norm = 1.256e-05, tol*||rhs|| = 1.358e-05

Anderson update took 63.956 ms, out of which F'*F took 30.276 ms; b-Ax took 203.411 ms, out of which Lap took 181.268 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.447 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326548, int_b + int_rho = -6.548e-14, checking this took 0.122 ms
2-norm of RHS = 612.1646267576148, which took 0.149 ms

iter_count = 252, r_2norm = 5.021e-04, tol*||rhs|| = 6.122e-04

Anderson update took 149.100 ms, out of which F'*F took 70.172 ms; b-Ax took 474.462 ms, out of which Lap took 421.408 ms
Solving Poisson took 1046.034 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.129799 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 74.884 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.387 ms
Total time for convolution: 	 convolve: 5.129446 
Total time for convolution: 	 convolve: 5.124397 
Total time for convolution: 	 convolve: 5.128414 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.593 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 2.039 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.862 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.271 ms

This SCF took 27912.966 ms, scf error = 2.637e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.134615, lowerbound = -1.009273, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1723.159 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.108 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.765 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 21.901 ms
rank =  0, finding HY took 28.391 ms
rank =  0, distributing HY into block cyclic form took 18.192 ms
rank =  0, finding Y'*HY took 5.400 ms
Rank 0, Project_Hamiltonian used 73.925 ms
Total time for projection: 73.941 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.159 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.251 ms
    first calculated eigval = -1.005916888449311
    last  calculated eigval = 0.033248446678367
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.99357005871374
lambda[   3] =  -0.64340692517987
lambda[   4] =  -0.54093086912095
lambda[   5] =  -0.44702151784855
lambda[   6] =  -0.43645093521086
lambda[   7] =  -0.41275379656857
lambda[   8] =  -0.40644083620563
lambda[   9] =  -0.36609771240962
lambda[  10] =  -0.28075122936194
lambda[  11] =  -0.22402311282985
lambda[  12] =  -0.15206547046837
lambda[  13] =  -0.03743850884577
lambda[  14] =  -0.02096374844575
lambda[  15] =   0.00167208937841
lambda[  16] =   0.02116112882967
lambda[  17] =   0.02596484249792
lambda[  18] =   0.03324844667837
==subpsace eigenproblem: bcast eigvals took 0.048 ms
Total time for solving subspace eigenvalue problem: 0.306 ms
rank =  0, subspace rotation using ScaLAPACK took 7.843 ms
rank =  0, Distributing orbital back into band + domain format took 17.770 ms
rank = 0, Subspace_Rotation used 25.635 ms

Total time for subspace rotation: 25.640 ms
rank = 0, Efermi =  -0.181598781590 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.001 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.512 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.397 ms
rank = 0, Calculating density took 1835.098 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.255 ms
rank = 0, D2D took 1.439 ms
rank = 0, Transfering density took 1.446 ms
Etot    =   -46.261316008794
Eband   =   -11.514727765815
E1      =    24.235897434853
E2      =   -11.155847775734
E3      =   -14.743165554614
Exc     =   -13.243401660739
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 1.091e-05, dEband = 1.135e-02
rank = 0, Calculating/Estimating energy took 1.018 ms, Etot = -46.261316009, dEtot = 1.091e-05, dEband = 1.135e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1940779466650, which took 0.074 ms

iter_count = 108, r_2norm = 6.513e-06, tol*||rhs|| = 7.763e-06

Anderson update took 65.053 ms, out of which F'*F took 30.077 ms; b-Ax took 203.972 ms, out of which Lap took 181.257 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.652 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326546, int_b + int_rho = -9.095e-14, checking this took 0.085 ms
2-norm of RHS = 612.1180396026126, which took 0.330 ms

iter_count = 228, r_2norm = 5.327e-04, tol*||rhs|| = 6.121e-04

Anderson update took 135.377 ms, out of which F'*F took 63.646 ms; b-Ax took 427.691 ms, out of which Lap took 382.023 ms
Solving Poisson took 946.887 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.199182 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.328 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.117108 
Total time for convolution: 	 convolve: 5.129297 
Total time for convolution: 	 convolve: 5.122375 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 2.024 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.261 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.321 ms

This SCF took 27835.316 ms, scf error = 1.102e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.133248, lowerbound = -1.005917, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1731.742 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.041 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.800 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 21.869 ms
rank =  0, finding HY took 28.308 ms
rank =  0, distributing HY into block cyclic form took 18.210 ms
rank =  0, finding Y'*HY took 5.322 ms
Rank 0, Project_Hamiltonian used 73.751 ms
Total time for projection: 73.766 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.152 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.245 ms
    first calculated eigval = -1.004692355096989
    last  calculated eigval = 0.032860994101663
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.99232849586766
lambda[   3] =  -0.64237832559521
lambda[   4] =  -0.53996673989738
lambda[   5] =  -0.44594855262423
lambda[   6] =  -0.43515495510014
lambda[   7] =  -0.41167527931617
lambda[   8] =  -0.40520468772279
lambda[   9] =  -0.36493614205464
lambda[  10] =  -0.27952585900845
lambda[  11] =  -0.22285946896709
lambda[  12] =  -0.15101073011349
lambda[  13] =  -0.03642932328304
lambda[  14] =  -0.02101307882726
lambda[  15] =   0.00326865805150
lambda[  16] =   0.02199891363785
lambda[  17] =   0.02623926444462
lambda[  18] =   0.03286099410166
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.279 ms
rank =  0, subspace rotation using ScaLAPACK took 7.876 ms
rank =  0, Distributing orbital back into band + domain format took 17.827 ms
rank = 0, Subspace_Rotation used 25.720 ms

Total time for subspace rotation: 25.724 ms
rank = 0, Efermi =  -0.180544041329 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.793 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.434 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.363 ms
rank = 0, Calculating density took 1843.251 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.218 ms
rank = 0, D2D took 1.412 ms
rank = 0, Transfering density took 1.420 ms
Etot    =   -46.261491292616
Eband   =   -11.489341724505
E1      =    24.222802529088
E2      =   -11.142905650219
E3      =   -14.745103583872
Exc     =   -13.244863983849
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 2.921e-05, dEband = 4.231e-03
rank = 0, Calculating/Estimating energy took 1.040 ms, Etot = -46.261491293, dEtot = 2.921e-05, dEband = 4.231e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1659847775314, which took 0.083 ms

iter_count = 108, r_2norm = 4.895e-06, tol*||rhs|| = 6.639e-06

Anderson update took 64.759 ms, out of which F'*F took 30.285 ms; b-Ax took 202.098 ms, out of which Lap took 180.687 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.811 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326551, int_b + int_rho = -3.274e-14, checking this took 0.170 ms
2-norm of RHS = 612.1380369169566, which took 0.152 ms

iter_count = 204, r_2norm = 4.933e-04, tol*||rhs|| = 6.121e-04

Anderson update took 120.856 ms, out of which F'*F took 57.528 ms; b-Ax took 386.189 ms, out of which Lap took 346.142 ms
Solving Poisson took 850.296 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.130324 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 76.008 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.377 ms
Total time for convolution: 	 convolve: 5.209743 
Total time for convolution: 	 convolve: 5.130828 
Total time for convolution: 	 convolve: 5.120616 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.621 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 2.019 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.257 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.311 ms

This SCF took 27817.749 ms, scf error = 6.097e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.132861, lowerbound = -1.004692, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1714.890 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.060 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.758 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 21.849 ms
rank =  0, finding HY took 28.251 ms
rank =  0, distributing HY into block cyclic form took 18.022 ms
rank =  0, finding Y'*HY took 5.425 ms
Rank 0, Project_Hamiltonian used 73.585 ms
Total time for projection: 73.598 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -1.004137495586296
    last  calculated eigval = 0.033106730697208
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.99178350425621
lambda[   3] =  -0.64174432202180
lambda[   4] =  -0.53935574731532
lambda[   5] =  -0.44534654993011
lambda[   6] =  -0.43461174004467
lambda[   7] =  -0.41112892305210
lambda[   8] =  -0.40465378821126
lambda[   9] =  -0.36442049094128
lambda[  10] =  -0.27899616845275
lambda[  11] =  -0.22231346355511
lambda[  12] =  -0.15045570993468
lambda[  13] =  -0.03574677104049
lambda[  14] =  -0.02038297069447
lambda[  15] =   0.00460910316379
lambda[  16] =   0.02347929840529
lambda[  17] =   0.02690872801071
lambda[  18] =   0.03310673069721
==subpsace eigenproblem: bcast eigvals took 0.044 ms
Total time for solving subspace eigenvalue problem: 0.266 ms
rank =  0, subspace rotation using ScaLAPACK took 7.867 ms
rank =  0, Distributing orbital back into band + domain format took 17.889 ms
rank = 0, Subspace_Rotation used 25.775 ms

Total time for subspace rotation: 25.780 ms
rank = 0, Efermi =  -0.179989021097 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.839 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.305 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.371 ms
rank = 0, Calculating density took 1826.242 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.217 ms
rank = 0, D2D took 2.412 ms
rank = 0, Transfering density took 2.422 ms
Etot    =   -46.261536931181
Eband   =   -11.476984388730
E1      =    24.217168294660
E2      =   -11.135942008021
E3      =   -14.745912863065
Exc     =   -13.245478360755
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 7.606e-06, dEband = 2.060e-03
rank = 0, Calculating/Estimating energy took 0.950 ms, Etot = -46.261536931, dEtot = 7.606e-06, dEband = 2.060e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0757691079479, which took 0.056 ms

iter_count = 108, r_2norm = 2.416e-06, tol*||rhs|| = 3.031e-06

Anderson update took 64.549 ms, out of which F'*F took 30.385 ms; b-Ax took 202.559 ms, out of which Lap took 181.098 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.259 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326553, int_b + int_rho = -1.455e-14, checking this took 0.109 ms
2-norm of RHS = 612.1551439189982, which took 0.204 ms

iter_count = 204, r_2norm = 6.046e-04, tol*||rhs|| = 6.122e-04

Anderson update took 120.344 ms, out of which F'*F took 57.175 ms; b-Ax took 389.822 ms, out of which Lap took 349.252 ms
Solving Poisson took 852.226 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.158 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.131733 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 54.894 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.125099 
Total time for convolution: 	 convolve: 5.117111 
Total time for convolution: 	 convolve: 5.196867 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.614 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.428 ms
---Transfer Veff_loc: D2D took 2.046 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.318 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.401 ms

This SCF took 27754.250 ms, scf error = 4.492e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.133107, lowerbound = -1.004137, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1694.304 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 29.528 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.787 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 33.351 ms
rank =  0, finding HY took 28.327 ms
rank =  0, distributing HY into block cyclic form took 18.213 ms
rank =  0, finding Y'*HY took 5.263 ms
Rank 0, Project_Hamiltonian used 85.193 ms
Total time for projection: 85.210 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -1.002848025807133
    last  calculated eigval = 0.034356745544564
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.99049725439367
lambda[   3] =  -0.64043560092137
lambda[   4] =  -0.53812242161619
lambda[   5] =  -0.44409996855709
lambda[   6] =  -0.43341786861890
lambda[   7] =  -0.40990035978760
lambda[   8] =  -0.40345910270159
lambda[   9] =  -0.36319877815486
lambda[  10] =  -0.27777812271476
lambda[  11] =  -0.22110974956712
lambda[  12] =  -0.14920070352043
lambda[  13] =  -0.03429752043727
lambda[  14] =  -0.01726012676471
lambda[  15] =   0.00835471017278
lambda[  16] =   0.02824995116300
lambda[  17] =   0.03000139136171
lambda[  18] =   0.03435674554456
==subpsace eigenproblem: bcast eigvals took 0.039 ms
Total time for solving subspace eigenvalue problem: 0.261 ms
rank =  0, subspace rotation using ScaLAPACK took 7.837 ms
rank =  0, Distributing orbital back into band + domain format took 17.716 ms
rank = 0, Subspace_Rotation used 25.570 ms

Total time for subspace rotation: 25.576 ms
rank = 0, Efermi =  -0.178734014642 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.804 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.444 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.035 ms
rank = 0, Calculating density took 1818.256 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.062 ms
rank = 0, D2D took 1.226 ms
rank = 0, Transfering density took 1.231 ms
Etot    =   -46.261602468419
Eband   =   -11.449734507660
E1      =    24.202986279509
E2      =   -11.122229953026
E3      =   -14.748606724493
Exc     =   -13.247593570346
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 1.092e-05, dEband = 4.542e-03
rank = 0, Calculating/Estimating energy took 0.988 ms, Etot = -46.261602468, dEtot = 1.092e-05, dEband = 4.542e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0682307937133, which took 0.067 ms

iter_count = 108, r_2norm = 1.911e-06, tol*||rhs|| = 2.729e-06

Anderson update took 63.927 ms, out of which F'*F took 30.408 ms; b-Ax took 204.545 ms, out of which Lap took 181.862 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.716 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326549, int_b + int_rho = -5.457e-14, checking this took 0.130 ms
2-norm of RHS = 612.1710960276906, which took 0.179 ms

iter_count = 168, r_2norm = 5.598e-04, tol*||rhs|| = 6.122e-04

Anderson update took 101.040 ms, out of which F'*F took 48.168 ms; b-Ax took 321.981 ms, out of which Lap took 287.879 ms
Solving Poisson took 711.036 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.126457 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 71.304 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.115728 
Total time for convolution: 	 convolve: 5.135291 
Total time for convolution: 	 convolve: 5.115261 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.578 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.464 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.417 ms
---Transfer Veff_loc: D2D took 2.053 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.281 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.368 ms

This SCF took 27547.117 ms, scf error = 2.385e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.134357, lowerbound = -1.002848, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1711.013 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.131 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.806 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.054 ms
rank =  0, Distribute data + matrix mult took 22.013 ms
rank =  0, finding HY took 28.238 ms
rank =  0, distributing HY into block cyclic form took 18.345 ms
rank =  0, finding Y'*HY took 5.132 ms
Rank 0, Project_Hamiltonian used 73.771 ms
Total time for projection: 73.784 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.198 ms
    first calculated eigval = -1.002616698532522
    last  calculated eigval = 0.034729152027341
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.99027081360811
lambda[   3] =  -0.64016039487101
lambda[   4] =  -0.53784418685092
lambda[   5] =  -0.44384172883318
lambda[   6] =  -0.43320080486373
lambda[   7] =  -0.40963701776653
lambda[   8] =  -0.40323628731462
lambda[   9] =  -0.36295048318276
lambda[  10] =  -0.27754747931585
lambda[  11] =  -0.22087265225803
lambda[  12] =  -0.14893399043536
lambda[  13] =  -0.03397066253967
lambda[  14] =  -0.01607336282800
lambda[  15] =   0.00939707534718
lambda[  16] =   0.03003387554737
lambda[  17] =   0.03120334787640
lambda[  18] =   0.03472915202734
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.227 ms
rank =  0, subspace rotation using ScaLAPACK took 8.495 ms
rank =  0, Distributing orbital back into band + domain format took 17.407 ms
rank = 0, Subspace_Rotation used 25.926 ms

Total time for subspace rotation: 25.932 ms
rank = 0, Efermi =  -0.178467301623 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.739 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.252 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.367 ms
rank = 0, Calculating density took 1822.846 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.215 ms
rank = 0, D2D took 1.343 ms
rank = 0, Transfering density took 1.348 ms
Etot    =   -46.261630509929
Eband   =   -11.444357096770
E1      =    24.200845827625
E2      =   -11.118948232440
E3      =   -14.748657246910
Exc     =   -13.247627372692
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 4.674e-06, dEband = 8.962e-04
rank = 0, Calculating/Estimating energy took 0.993 ms, Etot = -46.261630510, dEtot = 4.674e-06, dEband = 8.962e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0427864299340, which took 0.071 ms

iter_count = 108, r_2norm = 1.353e-06, tol*||rhs|| = 1.711e-06

Anderson update took 64.550 ms, out of which F'*F took 29.947 ms; b-Ax took 204.003 ms, out of which Lap took 181.559 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.361 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326549, int_b + int_rho = -5.821e-14, checking this took 0.113 ms
2-norm of RHS = 612.1735471081003, which took 0.159 ms

iter_count = 168, r_2norm = 5.534e-04, tol*||rhs|| = 6.122e-04

Anderson update took 99.425 ms, out of which F'*F took 47.426 ms; b-Ax took 319.267 ms, out of which Lap took 284.446 ms
Solving Poisson took 705.959 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.120538 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 80.515 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.114309 
Total time for convolution: 	 convolve: 5.139957 
Total time for convolution: 	 convolve: 5.115756 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.409 ms
---Transfer Veff_loc: D2D took 2.124 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.281 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.439 ms

This SCF took 27553.741 ms, scf error = 2.010e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.134729, lowerbound = -1.002617, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1702.377 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.942 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.793 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 21.759 ms
rank =  0, finding HY took 28.676 ms
rank =  0, distributing HY into block cyclic form took 18.126 ms
rank =  0, finding Y'*HY took 5.349 ms
Rank 0, Project_Hamiltonian used 73.950 ms
Total time for projection: 73.968 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.153 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.243 ms
    first calculated eigval = -1.002322680077564
    last  calculated eigval = 0.035567440774491
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.98997764859551
lambda[   3] =  -0.63985298402474
lambda[   4] =  -0.53752310431313
lambda[   5] =  -0.44353173705023
lambda[   6] =  -0.43289617001688
lambda[   7] =  -0.40933599627051
lambda[   8] =  -0.40293301684076
lambda[   9] =  -0.36264988491363
lambda[  10] =  -0.27724077323840
lambda[  11] =  -0.22056986849508
lambda[  12] =  -0.14864487481449
lambda[  13] =  -0.03364553569803
lambda[  14] =  -0.01402132904220
lambda[  15] =   0.01146174028780
lambda[  16] =   0.03189308808400
lambda[  17] =   0.03374751515438
lambda[  18] =   0.03556744077449
==subpsace eigenproblem: bcast eigvals took 0.041 ms
Total time for solving subspace eigenvalue problem: 0.288 ms
rank =  0, subspace rotation using ScaLAPACK took 5.713 ms
rank =  0, Distributing orbital back into band + domain format took 19.144 ms
rank = 0, Subspace_Rotation used 24.876 ms

Total time for subspace rotation: 24.880 ms
rank = 0, Efermi =  -0.178178185931 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 4.571 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.559 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.391 ms
rank = 0, Calculating density took 1813.202 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.184 ms
rank = 0, D2D took 2.170 ms
rank = 0, Transfering density took 2.177 ms
Etot    =   -46.261672263430
Eband   =   -11.437667729645
E1      =    24.197673069871
E2      =   -11.115342587436
E3      =   -14.748923702148
Exc     =   -13.247846545799
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 6.959e-06, dEband = 1.115e-03
rank = 0, Calculating/Estimating energy took 0.996 ms, Etot = -46.261672263, dEtot = 6.959e-06, dEband = 1.115e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0379238638284, which took 0.068 ms

iter_count = 108, r_2norm = 1.175e-06, tol*||rhs|| = 1.517e-06

Anderson update took 64.318 ms, out of which F'*F took 30.126 ms; b-Ax took 204.021 ms, out of which Lap took 180.866 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.311 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326553, int_b + int_rho = -1.819e-14, checking this took 0.126 ms
2-norm of RHS = 612.1730747398166, which took 0.194 ms

iter_count = 144, r_2norm = 5.829e-04, tol*||rhs|| = 6.122e-04

Anderson update took 85.915 ms, out of which F'*F took 40.589 ms; b-Ax took 272.586 ms, out of which Lap took 242.476 ms
Solving Poisson took 601.296 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.123002 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 76.447 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.128112 
Total time for convolution: 	 convolve: 5.134589 
Total time for convolution: 	 convolve: 5.115508 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.076 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.663 ms
---Transfer Veff_loc: D2D took 2.068 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.320 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.427 ms

This SCF took 27442.970 ms, scf error = 1.403e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.135567, lowerbound = -1.002323, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1706.319 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.115 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.730 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 21.870 ms
rank =  0, finding HY took 28.474 ms
rank =  0, distributing HY into block cyclic form took 18.192 ms
rank =  0, finding Y'*HY took 5.277 ms
Rank 0, Project_Hamiltonian used 73.847 ms
Total time for projection: 73.858 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.100 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -1.002209798850040
    last  calculated eigval = 0.036742580311536
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.98986442972495
lambda[   3] =  -0.63973873006995
lambda[   4] =  -0.53740044254672
lambda[   5] =  -0.44341285843403
lambda[   6] =  -0.43277547791963
lambda[   7] =  -0.40922434511211
lambda[   8] =  -0.40281290930404
lambda[   9] =  -0.36253667342363
lambda[  10] =  -0.27711993020890
lambda[  11] =  -0.22045185051331
lambda[  12] =  -0.14853402168562
lambda[  13] =  -0.03353172742925
lambda[  14] =  -0.01299288600467
lambda[  15] =   0.01213818266827
lambda[  16] =   0.03257271747407
lambda[  17] =   0.03458545179803
lambda[  18] =   0.03674258031154
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.589 ms
rank =  0, subspace rotation using ScaLAPACK took 8.476 ms
rank =  0, Distributing orbital back into band + domain format took 17.834 ms
rank = 0, Subspace_Rotation used 26.338 ms

Total time for subspace rotation: 26.351 ms
rank = 0, Efermi =  -0.178067332872 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 4.912 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.116 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.357 ms
rank = 0, Calculating density took 1818.695 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.200 ms
rank = 0, D2D took 1.379 ms
rank = 0, Transfering density took 1.385 ms
Etot    =   -46.261688432837
Eband   =   -11.435094894185
E1      =    24.196433449887
E2      =   -11.113983708047
E3      =   -14.749019306196
Exc     =   -13.247932655341
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 2.695e-06, dEband = 4.288e-04
rank = 0, Calculating/Estimating energy took 1.005 ms, Etot = -46.261688433, dEtot = 2.695e-06, dEband = 4.288e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0356224554646, which took 0.078 ms

iter_count = 108, r_2norm = 1.132e-06, tol*||rhs|| = 1.425e-06

Anderson update took 64.995 ms, out of which F'*F took 30.174 ms; b-Ax took 202.901 ms, out of which Lap took 180.456 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.425 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326555, int_b + int_rho = 3.638e-15, checking this took 0.159 ms
2-norm of RHS = 612.1704708975496, which took 0.132 ms

iter_count = 96, r_2norm = 6.036e-04, tol*||rhs|| = 6.122e-04

Anderson update took 57.253 ms, out of which F'*F took 27.143 ms; b-Ax took 182.116 ms, out of which Lap took 162.709 ms
Solving Poisson took 402.855 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.113635 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 81.496 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.126076 
Total time for convolution: 	 convolve: 5.149981 
Total time for convolution: 	 convolve: 5.114474 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.524 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 2.059 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.262 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.355 ms

This SCF took 27261.715 ms, scf error = 1.238e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136743, lowerbound = -1.002210, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1690.631 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.010 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.760 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 21.794 ms
rank =  0, finding HY took 28.403 ms
rank =  0, distributing HY into block cyclic form took 18.181 ms
rank =  0, finding Y'*HY took 4.730 ms
Rank 0, Project_Hamiltonian used 73.665 ms
Total time for projection: 73.683 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -1.002144028094673
    last  calculated eigval = 0.037129293185554
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.98979767586222
lambda[   3] =  -0.63968381786388
lambda[   4] =  -0.53735039937919
lambda[   5] =  -0.44335771589504
lambda[   6] =  -0.43271442933384
lambda[   7] =  -0.40916777652191
lambda[   8] =  -0.40275355086475
lambda[   9] =  -0.36247675562823
lambda[  10] =  -0.27705871374424
lambda[  11] =  -0.22039455094616
lambda[  12] =  -0.14847860758552
lambda[  13] =  -0.03348848899555
lambda[  14] =  -0.01279202037679
lambda[  15] =   0.01217865324537
lambda[  16] =   0.03258824078194
lambda[  17] =   0.03459934951264
lambda[  18] =   0.03712929318555
==subpsace eigenproblem: bcast eigvals took 0.046 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 7.889 ms
rank =  0, Distributing orbital back into band + domain format took 17.684 ms
rank = 0, Subspace_Rotation used 25.586 ms

Total time for subspace rotation: 25.591 ms
rank = 0, Efermi =  -0.178011918776 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.261 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.917 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.407 ms
rank = 0, Calculating density took 1801.847 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.240 ms
rank = 0, D2D took 1.470 ms
rank = 0, Transfering density took 1.476 ms
Etot    =   -46.261690195317
Eband   =   -11.433798830238
E1      =    24.195664323856
E2      =   -11.113425958594
E3      =   -14.749171879692
Exc     =   -13.248056179780
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 2.937e-07, dEband = 2.160e-04
rank = 0, Calculating/Estimating energy took 0.976 ms, Etot = -46.261690195, dEtot = 2.937e-07, dEband = 2.160e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0261720447611, which took 0.151 ms

iter_count = 108, r_2norm = 7.247e-07, tol*||rhs|| = 1.047e-06

Anderson update took 64.383 ms, out of which F'*F took 30.474 ms; b-Ax took 203.388 ms, out of which Lap took 180.699 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.544 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326550, int_b + int_rho = -5.093e-14, checking this took 0.136 ms
2-norm of RHS = 612.1714090914362, which took 0.188 ms

iter_count = 144, r_2norm = 5.644e-04, tol*||rhs|| = 6.122e-04

Anderson update took 86.901 ms, out of which F'*F took 40.914 ms; b-Ax took 274.105 ms, out of which Lap took 244.726 ms
Solving Poisson took 603.461 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 6.177903 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.150786 
Total time for convolution: 	 convolve: 5.119438 
Total time for convolution: 	 convolve: 5.117061 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.197 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 2.054 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.268 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.356 ms

This SCF took 28445.563 ms, scf error = 1.011e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.137129, lowerbound = -1.002144, upperbound = 267.575318

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1705.035 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.500 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.229 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 21.761 ms
rank =  0, finding HY took 28.345 ms
rank =  0, distributing HY into block cyclic form took 18.096 ms
rank =  0, finding Y'*HY took 5.420 ms
Rank 0, Project_Hamiltonian used 73.669 ms
Total time for projection: 73.678 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.080 ms
rank = 0, Solve_Generalized_EigenProblem used 0.200 ms
    first calculated eigval = -1.002009631296082
    last  calculated eigval = 0.038592215818323
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.98966494646001
lambda[   3] =  -0.63954357023844
lambda[   4] =  -0.53721750551305
lambda[   5] =  -0.44322477696046
lambda[   6] =  -0.43259828020559
lambda[   7] =  -0.40903562328492
lambda[   8] =  -0.40263561580267
lambda[   9] =  -0.36234979709617
lambda[  10] =  -0.27693823598149
lambda[  11] =  -0.22027544020869
lambda[  12] =  -0.14836591810977
lambda[  13] =  -0.03347041031981
lambda[  14] =  -0.01233252912131
lambda[  15] =   0.01172260588522
lambda[  16] =   0.03201239414295
lambda[  17] =   0.03457287422454
lambda[  18] =   0.03859221581832
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.232 ms
rank =  0, subspace rotation using ScaLAPACK took 4.393 ms
rank =  0, Distributing orbital back into band + domain format took 21.249 ms
rank = 0, Subspace_Rotation used 25.661 ms

Total time for subspace rotation: 25.666 ms
rank = 0, Efermi =  -0.177899229290 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 4.766 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.305 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.447 ms
rank = 0, Calculating density took 1817.215 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.235 ms
rank = 0, D2D took 1.495 ms
rank = 0, Transfering density took 1.503 ms
Etot    =   -46.261720969633
Eband   =   -11.430986848063
E1      =    24.194313161985
E2      =   -11.111933559944
E3      =   -14.749197836615
Exc     =   -13.248081332671
Esc     =   -71.638097347038
Entropy =    -0.000000000403
dE = 5.129e-06, dEband = 4.687e-04
rank = 0, Calculating/Estimating energy took 0.990 ms, Etot = -46.261720970, dEtot = 5.129e-06, dEband = 4.687e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0229737093896, which took 0.068 ms

iter_count = 108, r_2norm = 5.728e-07, tol*||rhs|| = 9.189e-07

Anderson update took 64.138 ms, out of which F'*F took 30.255 ms; b-Ax took 207.523 ms, out of which Lap took 184.627 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.416 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000001326555, int_rho =  22.00000001326543, int_b + int_rho = -1.128e-13, checking this took 0.118 ms
2-norm of RHS = 612.1710790808380, which took 0.125 ms

iter_count = 102, r_2norm = 5.763e-04, tol*||rhs|| = 6.122e-04

Anderson update took 60.862 ms, out of which F'*F took 28.738 ms; b-Ax took 193.157 ms, out of which Lap took 172.366 ms
Solving Poisson took 427.685 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.119392 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 83.956 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.124373 
Total time for convolution: 	 convolve: 5.117999 
Total time for convolution: 	 convolve: 5.116537 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.218 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 2.011 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.834 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.222 ms

This SCF took 27260.199 ms, scf error = 9.118e-05
The last 17 occupations of kpoints #1 are (Nelectron = 22):
lambda[   2] =  -0.98966494646001, occ[   2] =   2.00000000000000
lambda[   3] =  -0.63954357023844, occ[   3] =   2.00000000000000
lambda[   4] =  -0.53721750551305, occ[   4] =   2.00000000000000
lambda[   5] =  -0.44322477696046, occ[   5] =   2.00000000000000
lambda[   6] =  -0.43259828020559, occ[   6] =   2.00000000000000
lambda[   7] =  -0.40903562328492, occ[   7] =   2.00000000000000
lambda[   8] =  -0.40263561580267, occ[   8] =   2.00000000000000
lambda[   9] =  -0.36234979709617, occ[   9] =   2.00000000000000
lambda[  10] =  -0.27693823598149, occ[  10] =   2.00000000000000
lambda[  11] =  -0.22027544020869, occ[  11] =   2.00000000000000
lambda[  12] =  -0.14836591810977, occ[  12] =   0.00000001326550
lambda[  13] =  -0.03347041031981, occ[  13] =   0.00000000000000
lambda[  14] =  -0.01233252912131, occ[  14] =   0.00000000000000
lambda[  15] =   0.01172260588522, occ[  15] =   0.00000000000000
lambda[  16] =   0.03201239414295, occ[  16] =   0.00000000000000
lambda[  17] =   0.03457287422454, occ[  17] =   0.00000000000000
lambda[  18] =   0.03859221581832, occ[  18] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 16 (90%) = 0.000000000000000.
Occupation of state 18 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.471 ms, time for Allreduce/Reduce: 8.298 ms 
Time for calculating local force components: 17.828 ms
Start Calculating nonlocal forces
force_nloc = 
  1.02747240083433  -0.65502894071896   0.00000214624698
 -1.02746414868436   0.65504507832400  -0.00000154442451
 -0.04499054943527  -0.02026211922207   0.00000002867943
  0.04499056950861   0.02026180792065   0.00000001060914
 -0.14223776875871   0.06189144407745  -0.00000041222115
  0.14223982482807  -0.06189334404013  -0.00000008608918
force_loc = 
 -1.01282566500120   0.64634485227500  -0.00000089129119
  1.01282056298574  -0.64636245296926   0.00000254544493
  0.04760188630424   0.02289708553790  -0.00000009823865
 -0.04760261168251  -0.02289728255444   0.00000006996423
  0.15376755925345  -0.06879273039930   0.00000074374202
 -0.15376662921922   0.06879011754042   0.00000048977277
Time for calculating nonlocal force components: 43.571 ms
[32mforces_xc: 
[0m[32m -0.02402236959621   0.01542036115758  -0.00000007303286
[0m[32m  0.02402179374681  -0.01542114898151   0.00000011261419
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00405842869044   0.00344037291631   0.00000003339806
[0m[32m  0.00405870482386  -0.00344070309776   0.00000002280474
[0mTime for calculating XC forces components: 23.697 ms
 Cartesian force = 
 -0.00937648896594   0.00673753975263   0.00000066559311
  0.00937735284533  -0.00673725658775   0.00000059730478
  0.00261048166611   0.00263623335485  -0.00000058588905
 -0.00261289737677  -0.00263420759477  -0.00000043575646
  0.00747050660143  -0.00345964636651  -0.00000015141089
 -0.00746895477016   0.00345733744155  -0.00000008984149
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.102 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.355 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Time for printing density: 381.786 ms
The program took 450.713 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:06
Job ID:        2266692
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:33:36,vmem=8348K,walltime=00:07:48,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-20-1
---------------------------------------
