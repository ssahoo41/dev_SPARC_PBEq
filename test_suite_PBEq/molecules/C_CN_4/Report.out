---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:04
Job ID:    2266571
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:09
Job ID:    2266571
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.053 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.018 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 9.560 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 9.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = C.psp8
pseudo_dir # 2 = N.psp8

Reading ion file took 8.275 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 61.409 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.928 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.089 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   10.000000	
   11.620986	   11.620986	   11.620986	
    8.379014	    8.379014	   11.620986	
    8.379014	   11.620986	    8.379014	
   11.620986	    8.379014	    8.379014	
   12.888068	   12.888068	   12.888068	
    7.111932	    7.111932	   12.888068	
    7.111932	   12.888068	    7.111932	
   12.888068	    7.111932	    7.111932	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.163 ms
Set up communicators.

--set up spincomm took 3.754 ms

--set up kptcomm took 0.350 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 1, 2}
gridsizes = [100, 100, 100], Nstates = 29, dmcomm dims = [1, 1, 2]

--set up dmcomm took 0.006 ms

--set up blacscomm took 0.011 ms
rank = 0, size_blacscomm = 6, ScaLAPACK topology Dims = (6, 1)
nproc = 12, size_blacscomm = 6 = dims[0] * dims[1] = (6, 1)
Nd_blacscomm 500000, Nstates 29 
rank =  0, my blacs rank = 0, BLCYC size (500000, 5), actual size (500000, 5)
rank = 0, mb = nb = 29, mbQ = nbQ = 64
rank = 0, nr_Hp = 29, nc_Hp = 29
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.087 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 6
# of bands per bandcomm          : 5
npdomain: 2
Embeded Cartesian topology dims: (1,1,2)
# of FD-grid points per processor: 500000 = (100,100,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.660 ms

Calculate_SplineDerivRadFun took 0.166 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.786 ms.
time spent on vectorized spline interp: 3.650 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.799 ms.
time spent on vectorized spline interp: 1.718 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.629 ms.

Calculating rb for all atom types took 12.594 ms
----------------------
Estimated memory usage
Total: 1.66 GB
orbitals             : 1.30 GB
global sized vectors : 213.62 MB
subspace matrices : 39.42 kB
others : 154.12 MB
----------------------------------------------
Estimated memory usage per processor: 141.27 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.195 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.016 ms
Calculating pseudocharge density ... 
the global sum of int_b = -40.0000000427967, sum_int_rho = 39.9541665370463
PosCharge = 40.000000042797, NegCharge = -39.954166537046, scal_fac = 1.001147152093
After scaling, int_rho = 40.0000000427967, PosCharge + NegCharge - NetCharge = -2.842e-14
--Calculate Vref took 0.859 ms
--Calculate rho_guess took 5.110 ms

 integral of b = -40.0000000427967,
 int{b} + Nelectron + NetCharge = -4.280e-08,
 Esc = -118.0254917723469,
 MPI_Reduce took 11.934 ms

Calculating b & b_ref took 28.144 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.057 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.152 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.049 ms
[0m
Calculating nonlocal projectors in psi-domain took 1.210 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.006 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 57.936 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279649, int_b + int_rho = -1.310e-13, checking this took 0.087 ms
2-norm of RHS = 753.1994296957560, which took 0.772 ms

iter_count = 426, r_2norm = 6.911e-04, tol*||rhs|| = 7.532e-04

Anderson update took 270.716 ms, out of which F'*F took 122.333 ms; b-Ax took 827.401 ms, out of which Lap took 736.037 ms
Solving Poisson took 1876.863 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.379 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
Total time for convolution: 	 convolve: 5.139215 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.569 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
Total time for convolution: 	 convolve: 5.127931 
Total time for convolution: 	 convolve: 5.124790 
Total time for convolution: 	 convolve: 5.134252 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.712 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.475 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.144 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
rank = 0, XC calculation took 24458.719 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 2.705 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 5.286 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 9.102 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.134 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.940 ms
    Lanczos iter 53, eigmin  = -1.004354749, eigmax = 264.913447796, err_eigmin = 3.327e-04, err_eigmax = 9.970e-03
rank =   0, Lanczos took 136.617 ms, eigmin = -1.004354748992, eigmax = 267.562582274052

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.229114, lowerbound = -1.104355, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2807.185 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 32.927 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.603 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.174 ms
rank =  0, Distribute data + matrix mult took 39.724 ms
rank =  0, finding HY took 47.441 ms
rank =  0, distributing HY into block cyclic form took 32.350 ms
rank =  0, finding Y'*HY took 9.242 ms
Rank 0, Project_Hamiltonian used 128.791 ms
Total time for projection: 128.806 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.563 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.655 ms
    first calculated eigval = 2.652466621484197
    last  calculated eigval = 3.312129646549261
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =   2.87727074272117
lambda[  12] =   2.90873137154631
lambda[  13] =   2.92084022649942
lambda[  14] =   2.94916523498197
lambda[  15] =   2.96891993019050
lambda[  16] =   2.98824155537858
lambda[  17] =   3.00154930509282
lambda[  18] =   3.02417010182636
lambda[  19] =   3.05684035008941
lambda[  20] =   3.07809934041678
lambda[  21] =   3.08183621813102
lambda[  22] =   3.09316344380000
lambda[  23] =   3.11975374931188
lambda[  24] =   3.13378238257931
lambda[  25] =   3.15584276812634
lambda[  26] =   3.17560096949511
lambda[  27] =   3.21703498789396
lambda[  28] =   3.25149877100667
lambda[  29] =   3.31212964654926
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.673 ms
rank =  0, subspace rotation using ScaLAPACK took 12.158 ms
rank =  0, Distributing orbital back into band + domain format took 30.950 ms
rank = 0, Subspace_Rotation used 43.131 ms

Total time for subspace rotation: 43.137 ms
rank = 0, Efermi =   3.079929984995 calculate fermi energy took 0.691 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.412130, lowerbound = -1.104355, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2850.193 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 30.994 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.059 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 37.084 ms
rank =  0, finding HY took 46.763 ms
rank =  0, distributing HY into block cyclic form took 30.643 ms
rank =  0, finding Y'*HY took 7.979 ms
Rank 0, Project_Hamiltonian used 122.514 ms
Total time for projection: 122.528 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.224 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.303 ms
    first calculated eigval = -0.866736196848249
    last  calculated eigval = 0.437398945124033
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.13812639354556
lambda[  12] =  -0.09909794999464
lambda[  13] =  -0.04594103994455
lambda[  14] =  -0.01735494737913
lambda[  15] =  -0.00974330362901
lambda[  16] =   0.08864319737252
lambda[  17] =   0.10265269465891
lambda[  18] =   0.13581303440459
lambda[  19] =   0.21439495120997
lambda[  20] =   0.27674141282709
lambda[  21] =   0.28145877645833
lambda[  22] =   0.31138523440011
lambda[  23] =   0.35091234722730
lambda[  24] =   0.35362236238264
lambda[  25] =   0.37390748487566
lambda[  26] =   0.39138202225238
lambda[  27] =   0.41263847226873
lambda[  28] =   0.41966077496773
lambda[  29] =   0.43739894512403
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.311 ms
rank =  0, subspace rotation using ScaLAPACK took 12.169 ms
rank =  0, Distributing orbital back into band + domain format took 30.585 ms
rank = 0, Subspace_Rotation used 42.774 ms

Total time for subspace rotation: 42.779 ms
rank = 0, Efermi =   0.279100094795 calculate fermi energy took 0.080 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.537399, lowerbound = -1.104355, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2848.790 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 35.648 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 5.791 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.088 ms
rank =  0, Distribute data + matrix mult took 41.547 ms
rank =  0, finding HY took 47.000 ms
rank =  0, distributing HY into block cyclic form took 30.734 ms
rank =  0, finding Y'*HY took 7.833 ms
Rank 0, Project_Hamiltonian used 127.145 ms
Total time for projection: 127.151 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.210 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.287 ms
    first calculated eigval = -1.010347741448972
    last  calculated eigval = 0.124529289386419
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.45184335141244
lambda[  12] =  -0.44521734101957
lambda[  13] =  -0.43151880702761
lambda[  14] =  -0.42285166081410
lambda[  15] =  -0.41882464219303
lambda[  16] =  -0.41501732092600
lambda[  17] =  -0.40547327185296
lambda[  18] =  -0.39831030461897
lambda[  19] =  -0.36934262984230
lambda[  20] =  -0.34823358457139
lambda[  21] =  -0.11249278485402
lambda[  22] =  -0.07057583462953
lambda[  23] =  -0.01741404725590
lambda[  24] =  -0.01005815666109
lambda[  25] =   0.01775749968176
lambda[  26] =   0.02834683887169
lambda[  27] =   0.05150796027870
lambda[  28] =   0.07260956440580
lambda[  29] =   0.12452928938642
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.294 ms
rank =  0, subspace rotation using ScaLAPACK took 12.156 ms
rank =  0, Distributing orbital back into band + domain format took 26.376 ms
rank = 0, Subspace_Rotation used 38.553 ms

Total time for subspace rotation: 38.561 ms
rank = 0, Efermi =  -0.140967413922 calculate fermi energy took 0.039 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.224529, lowerbound = -1.104355, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2858.573 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 30.891 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.023 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.197 ms
rank =  0, Distribute data + matrix mult took 37.127 ms
rank =  0, finding HY took 46.749 ms
rank =  0, distributing HY into block cyclic form took 30.857 ms
rank =  0, finding Y'*HY took 7.820 ms
Rank 0, Project_Hamiltonian used 122.586 ms
Total time for projection: 122.590 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.205 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.277 ms
    first calculated eigval = -1.010574177372749
    last  calculated eigval = 0.043695535768803
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.46217340816918
lambda[  12] =  -0.46188801042933
lambda[  13] =  -0.44163539804244
lambda[  14] =  -0.44114053142000
lambda[  15] =  -0.42431384775267
lambda[  16] =  -0.42406739835856
lambda[  17] =  -0.42374521842138
lambda[  18] =  -0.42075101083143
lambda[  19] =  -0.42063600066036
lambda[  20] =  -0.42005534008538
lambda[  21] =  -0.13922654887237
lambda[  22] =  -0.13409304154107
lambda[  23] =  -0.12055358505128
lambda[  24] =  -0.10311751662897
lambda[  25] =  -0.09262769641733
lambda[  26] =  -0.04844037264209
lambda[  27] =  -0.03346793201843
lambda[  28] =  -0.00334269071443
lambda[  29] =   0.04369553576880
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.284 ms
rank =  0, subspace rotation using ScaLAPACK took 12.125 ms
rank =  0, Distributing orbital back into band + domain format took 30.578 ms
rank = 0, Subspace_Rotation used 42.722 ms

Total time for subspace rotation: 42.728 ms
rank = 0, Efermi =  -0.167703327518 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 7.923 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.883 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.397 ms
rank = 0, Calculating density took 12190.564 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.261 ms
rank = 0, D2D took 1.526 ms
rank = 0, Transfering density took 1.534 ms
Etot    =   -71.657675309238
Eband   =   -24.068012084734
E1      =    48.408252582839
E2      =   -20.137208827679
E3      =   -23.510310374152
Exc     =   -21.619943235570
Esc     =  -118.025491772347
Entropy =    -0.000000001257
dE = 7.962e+00, dEband = 2.674e+00
rank = 0, Calculating/Estimating energy took 1.046 ms, Etot = -71.657675309, dEtot = 7.962e+00, dEband = 2.674e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 65.5508063862254, which took 0.115 ms

iter_count = 96, r_2norm = 2.072e-03, tol*||rhs|| = 2.622e-03

Anderson update took 57.910 ms, out of which F'*F took 26.727 ms; b-Ax took 183.335 ms, out of which Lap took 161.086 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.186 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279674, int_b + int_rho = 1.164e-13, checking this took 0.110 ms
2-norm of RHS = 747.1197561621282, which took 0.223 ms

iter_count = 288, r_2norm = 7.221e-04, tol*||rhs|| = 7.471e-04

Anderson update took 173.362 ms, out of which F'*F took 83.674 ms; b-Ax took 573.640 ms, out of which Lap took 503.152 ms
Solving Poisson took 1267.111 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.398 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.781 ms
Total time for convolution: 	 convolve: 5.100379 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.503 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
Total time for convolution: 	 convolve: 5.104992 
Total time for convolution: 	 convolve: 5.121548 
Total time for convolution: 	 convolve: 5.105303 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.636 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.854 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.828 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.708 ms

This SCF took 38294.607 ms, scf error = 1.863e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.143696, lowerbound = -1.010574, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2798.967 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 30.883 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.023 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 36.938 ms
rank =  0, finding HY took 46.277 ms
rank =  0, distributing HY into block cyclic form took 34.139 ms
rank =  0, finding Y'*HY took 6.242 ms
Rank 0, Project_Hamiltonian used 123.630 ms
Total time for projection: 123.642 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.198 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.274 ms
    first calculated eigval = -0.969109969363322
    last  calculated eigval = -0.002565667886907
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.41847805177695
lambda[  12] =  -0.41765549182012
lambda[  13] =  -0.41522497176004
lambda[  14] =  -0.41518721976414
lambda[  15] =  -0.39381650398524
lambda[  16] =  -0.39377401854873
lambda[  17] =  -0.39360807624015
lambda[  18] =  -0.38791601815997
lambda[  19] =  -0.38778087532524
lambda[  20] =  -0.38775130649278
lambda[  21] =  -0.12558759842750
lambda[  22] =  -0.12334585931528
lambda[  23] =  -0.12243813196088
lambda[  24] =  -0.11448766333600
lambda[  25] =  -0.10595140574275
lambda[  26] =  -0.05670176300144
lambda[  27] =  -0.03155057320873
lambda[  28] =  -0.01979249159476
lambda[  29] =  -0.00256566788691
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.286 ms
rank =  0, subspace rotation using ScaLAPACK took 11.390 ms
rank =  0, Distributing orbital back into band + domain format took 31.460 ms
rank = 0, Subspace_Rotation used 42.878 ms

Total time for subspace rotation: 42.885 ms
rank = 0, Efermi =  -0.154154890126 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 7.821 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.866 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.427 ms
rank = 0, Calculating density took 2981.043 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.216 ms
rank = 0, D2D took 1.618 ms
rank = 0, Transfering density took 2.449 ms
Etot    =   -71.502047465200
Eband   =   -22.894820364175
E1      =    47.364524660477
E2      =   -20.091962537840
E3      =   -23.859712086478
Exc     =   -21.897934612202
Esc     =  -118.025491772347
Entropy =    -0.000000001271
dE = 1.729e-02, dEband = 1.304e-01
rank = 0, Calculating/Estimating energy took 0.979 ms, Etot = -71.502047465, dEtot = 1.729e-02, dEband = 1.304e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 40.4971370528105, which took 0.089 ms

iter_count = 96, r_2norm = 1.237e-03, tol*||rhs|| = 1.620e-03

Anderson update took 58.043 ms, out of which F'*F took 27.102 ms; b-Ax took 184.079 ms, out of which Lap took 162.318 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 425.732 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279659, int_b + int_rho = -2.910e-14, checking this took 0.121 ms
2-norm of RHS = 744.3889334139596, which took 0.207 ms

iter_count = 252, r_2norm = 6.415e-04, tol*||rhs|| = 7.444e-04

Anderson update took 150.940 ms, out of which F'*F took 73.294 ms; b-Ax took 505.881 ms, out of which Lap took 443.139 ms
Solving Poisson took 1112.890 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.102521 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.101000 
Total time for convolution: 	 convolve: 5.105445 
Total time for convolution: 	 convolve: 5.105053 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.506 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.737 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.852 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.857 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.732 ms

This SCF took 29106.175 ms, scf error = 1.184e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.097434, lowerbound = -0.969110, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2800.496 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 30.564 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.408 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.179 ms
rank =  0, Distribute data + matrix mult took 37.167 ms
rank =  0, finding HY took 48.517 ms
rank =  0, distributing HY into block cyclic form took 30.883 ms
rank =  0, finding Y'*HY took 7.856 ms
Rank 0, Project_Hamiltonian used 124.460 ms
Total time for projection: 124.473 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.217 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.301 ms
    first calculated eigval = -0.938637475741579
    last  calculated eigval = -0.005200701048948
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.39154564850615
lambda[  12] =  -0.39142348460062
lambda[  13] =  -0.39125511580277
lambda[  14] =  -0.38864683118072
lambda[  15] =  -0.36805173886228
lambda[  16] =  -0.36801880033829
lambda[  17] =  -0.36792974820486
lambda[  18] =  -0.36226025678712
lambda[  19] =  -0.36210954221978
lambda[  20] =  -0.36208114399580
lambda[  21] =  -0.10903250356664
lambda[  22] =  -0.10864231848884
lambda[  23] =  -0.10841583942732
lambda[  24] =  -0.09983412009462
lambda[  25] =  -0.09823408539635
lambda[  26] =  -0.05416476145243
lambda[  27] =  -0.01433694986766
lambda[  28] =  -0.01040401001360
lambda[  29] =  -0.00520070104895
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.314 ms
rank =  0, subspace rotation using ScaLAPACK took 11.497 ms
rank =  0, Distributing orbital back into band + domain format took 31.386 ms
rank = 0, Subspace_Rotation used 42.905 ms

Total time for subspace rotation: 42.911 ms
rank = 0, Efermi =  -0.138201577281 calculate fermi energy took 0.071 ms
rank = 0, --- Calculate rho: sum over local bands took 7.741 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.862 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.992 ms
rank = 0, Calculating density took 2984.702 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.072 ms
rank = 0, D2D took 1.191 ms
rank = 0, Transfering density took 1.198 ms
Etot    =   -71.431436666156
Eband   =   -21.856980429900
E1      =    46.475584656443
E2      =   -19.954593947790
E3      =   -24.156412292373
Exc     =   -22.135555359217
Esc     =  -118.025491772347
Entropy =    -0.000000001297
dE = 7.846e-03, dEband = 1.153e-01
rank = 0, Calculating/Estimating energy took 1.191 ms, Etot = -71.431436666, dEtot = 7.846e-03, dEband = 1.153e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.0221608873714, which took 0.066 ms

iter_count = 108, r_2norm = 1.645e-04, tol*||rhs|| = 2.809e-04

Anderson update took 65.461 ms, out of which F'*F took 30.415 ms; b-Ax took 206.284 ms, out of which Lap took 181.889 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 476.338 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279670, int_b + int_rho = 7.276e-14, checking this took 0.115 ms
2-norm of RHS = 744.4362334254167, which took 0.148 ms

iter_count = 258, r_2norm = 6.754e-04, tol*||rhs|| = 7.444e-04

Anderson update took 154.761 ms, out of which F'*F took 76.839 ms; b-Ax took 528.659 ms, out of which Lap took 460.603 ms
Solving Poisson took 1153.976 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.099767 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.411 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.101814 
Total time for convolution: 	 convolve: 5.109908 
Total time for convolution: 	 convolve: 5.143570 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.695 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.846 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.801 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.672 ms

This SCF took 29075.818 ms, scf error = 6.389e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.094799, lowerbound = -0.938637, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 3485.818 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 40.396 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 23.293 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.019 ms
rank =  0, Distribute data + matrix mult took 63.722 ms
rank =  0, finding HY took 71.596 ms
rank =  0, distributing HY into block cyclic form took 27.339 ms
rank =  0, finding Y'*HY took 22.470 ms
Rank 0, Project_Hamiltonian used 185.155 ms
Total time for projection: 185.174 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.216 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.288 ms
    first calculated eigval = -0.913824243260371
    last  calculated eigval = 0.006800003949867
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.37015274563156
lambda[  12] =  -0.37010315437054
lambda[  13] =  -0.37006179975059
lambda[  14] =  -0.36620098072872
lambda[  15] =  -0.34617053266954
lambda[  16] =  -0.34616311591994
lambda[  17] =  -0.34613784745949
lambda[  18] =  -0.34133836048835
lambda[  19] =  -0.34133115868500
lambda[  20] =  -0.34131029956017
lambda[  21] =  -0.09327737411092
lambda[  22] =  -0.09323995687834
lambda[  23] =  -0.09314997372372
lambda[  24] =  -0.08506778746373
lambda[  25] =  -0.08477765188230
lambda[  26] =  -0.04886883052024
lambda[  27] =   0.00357441975785
lambda[  28] =   0.00505602230144
lambda[  29] =   0.00680000394987
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.303 ms
rank =  0, subspace rotation using ScaLAPACK took 10.573 ms
rank =  0, Distributing orbital back into band + domain format took 150.659 ms
rank = 0, Subspace_Rotation used 161.247 ms

Total time for subspace rotation: 161.251 ms
rank = 0, Efermi =  -0.122692659187 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.943 ms
rank = 0, --- Calculate rho: reduce over all band groups took 172.959 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.470 ms
rank = 0, Calculating density took 4011.086 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.157 ms
rank = 0, D2D took 1.280 ms
rank = 0, Transfering density took 1.287 ms
Etot    =   -71.406499828577
Eband   =   -20.933909245962
E1      =    45.739780291985
E2      =   -19.736776122614
E3      =   -24.430022889862
Exc     =   -22.353678113431
Esc     =  -118.025491772347
Entropy =    -0.000000001298
dE = 2.771e-03, dEband = 1.026e-01
rank = 0, Calculating/Estimating energy took 24.739 ms, Etot = -71.406499829, dEtot = 2.771e-03, dEband = 1.026e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 3.2120121415328, which took 23.937 ms

iter_count = 108, r_2norm = 8.021e-05, tol*||rhs|| = 1.285e-04

Anderson update took 183.697 ms, out of which F'*F took 79.835 ms; b-Ax took 479.070 ms, out of which Lap took 458.519 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 1000.721 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279681, int_b + int_rho = 1.892e-13, checking this took 0.148 ms
2-norm of RHS = 746.2514790429606, which took 0.208 ms

iter_count = 264, r_2norm = 6.156e-04, tol*||rhs|| = 7.463e-04

Anderson update took 157.687 ms, out of which F'*F took 78.313 ms; b-Ax took 542.451 ms, out of which Lap took 476.585 ms
Solving Poisson took 1183.389 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.101514 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.695 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.103348 
Total time for convolution: 	 convolve: 5.132860 
Total time for convolution: 	 convolve: 5.101866 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.547 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 1.884 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.708 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.625 ms

This SCF took 30755.867 ms, scf error = 1.489e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.106800, lowerbound = -0.913824, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2829.787 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 30.509 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.113 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.281 ms
rank =  0, Distribute data + matrix mult took 36.923 ms
rank =  0, finding HY took 46.041 ms
rank =  0, distributing HY into block cyclic form took 30.642 ms
rank =  0, finding Y'*HY took 7.974 ms
Rank 0, Project_Hamiltonian used 121.626 ms
Total time for projection: 121.637 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.202 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.272 ms
    first calculated eigval = -0.912174608863659
    last  calculated eigval = 0.006084858400283
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.36777970453241
lambda[  12] =  -0.36774385271560
lambda[  13] =  -0.36768657204280
lambda[  14] =  -0.36242510636171
lambda[  15] =  -0.34398615303740
lambda[  16] =  -0.34396800229233
lambda[  17] =  -0.34392969894135
lambda[  18] =  -0.34044919124517
lambda[  19] =  -0.34042306897980
lambda[  20] =  -0.34039420188704
lambda[  21] =  -0.09232762142515
lambda[  22] =  -0.09232239392179
lambda[  23] =  -0.09229331475177
lambda[  24] =  -0.08413885472999
lambda[  25] =  -0.08407667937722
lambda[  26] =  -0.04814428384884
lambda[  27] =   0.00398896750661
lambda[  28] =   0.00503694607332
lambda[  29] =   0.00608485840028
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.283 ms
rank =  0, subspace rotation using ScaLAPACK took 12.040 ms
rank =  0, Distributing orbital back into band + domain format took 30.862 ms
rank = 0, Subspace_Rotation used 42.930 ms

Total time for subspace rotation: 42.937 ms
rank = 0, Efermi =  -0.121783247931 calculate fermi energy took 1.797 ms
rank = 0, --- Calculate rho: sum over local bands took 8.294 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.422 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.378 ms
rank = 0, Calculating density took 3010.988 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.272 ms
rank = 0, D2D took 1.433 ms
rank = 0, Transfering density took 1.437 ms
Etot    =   -71.405303112398
Eband   =   -20.863902922172
E1      =    45.735269555583
E2      =   -19.662621607703
E3      =   -24.462825610591
Exc     =   -22.376625190458
Esc     =  -118.025491772347
Entropy =    -0.000000001298
dE = 1.330e-04, dEband = 7.778e-03
rank = 0, Calculating/Estimating energy took 1.065 ms, Etot = -71.405303112, dEtot = 1.330e-04, dEband = 7.778e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 1.3284138868171, which took 0.080 ms

iter_count = 108, r_2norm = 3.955e-05, tol*||rhs|| = 5.314e-05

Anderson update took 64.568 ms, out of which F'*F took 30.238 ms; b-Ax took 206.794 ms, out of which Lap took 182.767 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 474.115 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279665, int_b + int_rho = 2.183e-14, checking this took 0.125 ms
2-norm of RHS = 747.0948432324619, which took 0.192 ms

iter_count = 228, r_2norm = 7.134e-04, tol*||rhs|| = 7.471e-04

Anderson update took 135.361 ms, out of which F'*F took 67.375 ms; b-Ax took 466.593 ms, out of which Lap took 407.881 ms
Solving Poisson took 1013.789 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.103915 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 14.827 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.104613 
Total time for convolution: 	 convolve: 5.116333 
Total time for convolution: 	 convolve: 5.103064 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.618 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 2.132 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.252 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.419 ms

This SCF took 28936.474 ms, scf error = 7.368e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.106085, lowerbound = -0.912175, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2821.907 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 30.703 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 5.639 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.337 ms
rank =  0, Distribute data + matrix mult took 36.695 ms
rank =  0, finding HY took 46.438 ms
rank =  0, distributing HY into block cyclic form took 30.700 ms
rank =  0, finding Y'*HY took 7.813 ms
Rank 0, Project_Hamiltonian used 121.679 ms
Total time for projection: 121.689 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.197 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.696 ms
rank = 0, Solve_Generalized_EigenProblem used 1.636 ms
    first calculated eigval = -0.912033902025438
    last  calculated eigval = 0.005443804170245
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.36753592303167
lambda[  12] =  -0.36752843319837
lambda[  13] =  -0.36751380621649
lambda[  14] =  -0.36194337356267
lambda[  15] =  -0.34380526801597
lambda[  16] =  -0.34380093644047
lambda[  17] =  -0.34379150228396
lambda[  18] =  -0.34064324335108
lambda[  19] =  -0.34063437708649
lambda[  20] =  -0.34062086056920
lambda[  21] =  -0.09216215246939
lambda[  22] =  -0.09216054415554
lambda[  23] =  -0.09215267874853
lambda[  24] =  -0.08407507359618
lambda[  25] =  -0.08406036804807
lambda[  26] =  -0.04798619243089
lambda[  27] =   0.00401280153049
lambda[  28] =   0.00476073921852
lambda[  29] =   0.00544380417024
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.653 ms
rank =  0, subspace rotation using ScaLAPACK took 11.658 ms
rank =  0, Distributing orbital back into band + domain format took 31.093 ms
rank = 0, Subspace_Rotation used 42.773 ms

Total time for subspace rotation: 42.778 ms
rank = 0, Efermi =  -0.121627151643 calculate fermi energy took 0.069 ms
rank = 0, --- Calculate rho: sum over local bands took 8.366 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.722 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.398 ms
rank = 0, Calculating density took 3003.705 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.274 ms
rank = 0, D2D took 1.492 ms
rank = 0, Transfering density took 1.500 ms
Etot    =   -71.405206345366
Eband   =   -20.861376067823
E1      =    45.758265689616
E2      =   -19.634507123818
E3      =   -24.468869854726
Exc     =   -22.379981172058
Esc     =  -118.025491772347
Entropy =    -0.000000001298
dE = 1.075e-05, dEband = 2.808e-04
rank = 0, Calculating/Estimating energy took 1.095 ms, Etot = -71.405206345, dEtot = 1.075e-05, dEband = 2.808e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6031455848522, which took 0.067 ms

iter_count = 108, r_2norm = 1.856e-05, tol*||rhs|| = 2.413e-05

Anderson update took 65.119 ms, out of which F'*F took 30.059 ms; b-Ax took 204.872 ms, out of which Lap took 180.404 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 474.384 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279662, int_b + int_rho = 0.000e+00, checking this took 0.121 ms
2-norm of RHS = 747.5238973462946, which took 0.129 ms

iter_count = 234, r_2norm = 7.143e-04, tol*||rhs|| = 7.475e-04

Anderson update took 139.206 ms, out of which F'*F took 69.614 ms; b-Ax took 478.228 ms, out of which Lap took 418.708 ms
Solving Poisson took 1036.597 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.100770 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.101623 
Total time for convolution: 	 convolve: 5.108566 
Total time for convolution: 	 convolve: 5.106346 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 213.845 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 2.138 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.265 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.440 ms

This SCF took 29182.872 ms, scf error = 4.040e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.105444, lowerbound = -0.912034, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2792.025 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 30.383 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.210 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.283 ms
rank =  0, Distribute data + matrix mult took 36.899 ms
rank =  0, finding HY took 45.915 ms
rank =  0, distributing HY into block cyclic form took 30.612 ms
rank =  0, finding Y'*HY took 7.781 ms
Rank 0, Project_Hamiltonian used 121.242 ms
Total time for projection: 121.258 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.209 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.282 ms
    first calculated eigval = -0.911857899872063
    last  calculated eigval = 0.005713460106733
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.36627433091056
lambda[  12] =  -0.36624390186903
lambda[  13] =  -0.36624130689142
lambda[  14] =  -0.36018347731679
lambda[  15] =  -0.34260935372685
lambda[  16] =  -0.34258587806913
lambda[  17] =  -0.34258419626311
lambda[  18] =  -0.33978525680835
lambda[  19] =  -0.33977857471274
lambda[  20] =  -0.33976564130582
lambda[  21] =  -0.09150527903615
lambda[  22] =  -0.09150368611268
lambda[  23] =  -0.09148736514166
lambda[  24] =  -0.08331666965503
lambda[  25] =  -0.08331237305891
lambda[  26] =  -0.04841862341320
lambda[  27] =   0.00474608476268
lambda[  28] =   0.00526370634109
lambda[  29] =   0.00571346010673
==subpsace eigenproblem: bcast eigvals took 0.063 ms
Total time for solving subspace eigenvalue problem: 0.351 ms
rank =  0, subspace rotation using ScaLAPACK took 11.741 ms
rank =  0, Distributing orbital back into band + domain format took 31.007 ms
rank = 0, Subspace_Rotation used 42.773 ms

Total time for subspace rotation: 42.778 ms
rank = 0, Efermi =  -0.120967493702 calculate fermi energy took 0.084 ms
rank = 0, --- Calculate rho: sum over local bands took 8.475 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.654 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.389 ms
rank = 0, Calculating density took 2972.140 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.372 ms
rank = 0, D2D took 1.542 ms
rank = 0, Transfering density took 1.544 ms
Etot    =   -71.405220401632
Eband   =   -20.829469828789
E1      =    45.748740109154
E2      =   -19.607051391513
E3      =   -24.486645025893
Exc     =   -22.392695325759
Esc     =  -118.025491772347
Entropy =    -0.000000001298
dE = 1.562e-06, dEband = 3.545e-03
rank = 0, Calculating/Estimating energy took 1.047 ms, Etot = -71.405220402, dEtot = 1.562e-06, dEband = 3.545e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4123850117347, which took 0.075 ms

iter_count = 108, r_2norm = 1.123e-05, tol*||rhs|| = 1.650e-05

Anderson update took 65.009 ms, out of which F'*F took 30.277 ms; b-Ax took 205.872 ms, out of which Lap took 181.487 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 476.015 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279663, int_b + int_rho = 7.276e-15, checking this took 0.145 ms
2-norm of RHS = 747.4799398275298, which took 0.254 ms

iter_count = 198, r_2norm = 6.741e-04, tol*||rhs|| = 7.475e-04

Anderson update took 117.817 ms, out of which F'*F took 58.130 ms; b-Ax took 400.416 ms, out of which Lap took 349.530 ms
Solving Poisson took 872.693 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.096 ms
Total time for convolution: 	 convolve: 5.101507 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.875 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.107218 
Total time for convolution: 	 convolve: 5.106751 
Total time for convolution: 	 convolve: 5.107518 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.526 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 2.167 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.261 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.464 ms

This SCF took 28786.349 ms, scf error = 1.906e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.105713, lowerbound = -0.911858, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2797.423 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 30.407 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 5.996 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.485 ms
rank =  0, Distribute data + matrix mult took 36.905 ms
rank =  0, finding HY took 45.682 ms
rank =  0, distributing HY into block cyclic form took 30.647 ms
rank =  0, finding Y'*HY took 7.994 ms
Rank 0, Project_Hamiltonian used 121.262 ms
Total time for projection: 121.273 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.201 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.284 ms
    first calculated eigval = -0.911503216534043
    last  calculated eigval = 0.005648793763489
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.36588461671751
lambda[  12] =  -0.36587500405659
lambda[  13] =  -0.36584186399413
lambda[  14] =  -0.35967763542711
lambda[  15] =  -0.34221203109230
lambda[  16] =  -0.34220441605376
lambda[  17] =  -0.34217879865133
lambda[  18] =  -0.33949882546129
lambda[  19] =  -0.33948354335987
lambda[  20] =  -0.33947576214028
lambda[  21] =  -0.09119674974571
lambda[  22] =  -0.09117984722793
lambda[  23] =  -0.09117409153879
lambda[  24] =  -0.08299483201468
lambda[  25] =  -0.08299351235395
lambda[  26] =  -0.04874924466798
lambda[  27] =   0.00496488131566
lambda[  28] =   0.00533252441399
lambda[  29] =   0.00564879376349
==subpsace eigenproblem: bcast eigvals took 0.069 ms
Total time for solving subspace eigenvalue problem: 0.360 ms
rank =  0, subspace rotation using ScaLAPACK took 11.632 ms
rank =  0, Distributing orbital back into band + domain format took 30.947 ms
rank = 0, Subspace_Rotation used 42.600 ms

Total time for subspace rotation: 42.604 ms
rank = 0, Efermi =  -0.120652294455 calculate fermi energy took 0.074 ms
rank = 0, --- Calculate rho: sum over local bands took 8.372 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.799 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.416 ms
rank = 0, Calculating density took 2977.437 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.238 ms
rank = 0, D2D took 1.627 ms
rank = 0, Transfering density took 1.629 ms
Etot    =   -71.405382615569
Eband   =   -20.815293721567
E1      =    45.740454960699
E2      =   -19.599573189636
E3      =   -24.491738524570
Exc     =   -22.396363795261
Esc     =  -118.025491772347
Entropy =    -0.000000001298
dE = 1.802e-05, dEband = 1.575e-03
rank = 0, Calculating/Estimating energy took 1.045 ms, Etot = -71.405382616, dEtot = 1.802e-05, dEband = 1.575e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2222096163870, which took 0.155 ms

iter_count = 108, r_2norm = 6.172e-06, tol*||rhs|| = 8.888e-06

Anderson update took 64.513 ms, out of which F'*F took 29.984 ms; b-Ax took 204.668 ms, out of which Lap took 180.389 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 476.601 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279676, int_b + int_rho = 1.310e-13, checking this took 0.116 ms
2-norm of RHS = 747.4364112502902, which took 0.069 ms

iter_count = 192, r_2norm = 6.440e-04, tol*||rhs|| = 7.474e-04

Anderson update took 114.513 ms, out of which F'*F took 57.004 ms; b-Ax took 393.166 ms, out of which Lap took 343.549 ms
Solving Poisson took 852.260 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.104151 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.736 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.108979 
Total time for convolution: 	 convolve: 5.104942 
Total time for convolution: 	 convolve: 5.099752 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.983 ms
---Transfer Veff_loc: D2D took 2.869 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.260 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.167 ms

This SCF took 28808.430 ms, scf error = 1.097e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.105649, lowerbound = -0.911503, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2825.399 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 30.720 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.078 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.142 ms
rank =  0, Distribute data + matrix mult took 36.961 ms
rank =  0, finding HY took 45.929 ms
rank =  0, distributing HY into block cyclic form took 30.494 ms
rank =  0, finding Y'*HY took 8.122 ms
Rank 0, Project_Hamiltonian used 121.541 ms
Total time for projection: 121.552 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.198 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.074 ms
rank = 0, Solve_Generalized_EigenProblem used 0.276 ms
    first calculated eigval = -0.910791360543738
    last  calculated eigval = 0.005916282052499
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.36530785432910
lambda[  12] =  -0.36530318299543
lambda[  13] =  -0.36530222420612
lambda[  14] =  -0.35907109413413
lambda[  15] =  -0.34161516354555
lambda[  16] =  -0.34161173161796
lambda[  17] =  -0.34161106998434
lambda[  18] =  -0.33895741000754
lambda[  19] =  -0.33895680705487
lambda[  20] =  -0.33895458164268
lambda[  21] =  -0.09067516381336
lambda[  22] =  -0.09067494398642
lambda[  23] =  -0.09067223185584
lambda[  24] =  -0.08251073559411
lambda[  25] =  -0.08251041525934
lambda[  26] =  -0.04884373220691
lambda[  27] =   0.00542968872452
lambda[  28] =   0.00569263668133
lambda[  29] =   0.00591628205250
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.304 ms
rank =  0, subspace rotation using ScaLAPACK took 11.606 ms
rank =  0, Distributing orbital back into band + domain format took 31.003 ms
rank = 0, Subspace_Rotation used 42.627 ms

Total time for subspace rotation: 42.632 ms
rank = 0, Efermi =  -0.120142795911 calculate fermi energy took 0.074 ms
rank = 0, --- Calculate rho: sum over local bands took 8.308 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.803 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.373 ms
rank = 0, Calculating density took 3005.559 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.231 ms
rank = 0, D2D took 1.562 ms
rank = 0, Transfering density took 1.565 ms
Etot    =   -71.405510520527
Eband   =   -20.790389020067
E1      =    45.723540764310
E2      =   -19.589884799499
E3      =   -24.498337252085
Exc     =   -22.401392542709
Esc     =  -118.025491772347
Entropy =    -0.000000001298
dE = 1.421e-05, dEband = 2.767e-03
rank = 0, Calculating/Estimating energy took 1.037 ms, Etot = -71.405510521, dEtot = 1.421e-05, dEband = 2.767e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1368139018619, which took 0.165 ms

iter_count = 108, r_2norm = 4.879e-06, tol*||rhs|| = 5.473e-06

Anderson update took 64.932 ms, out of which F'*F took 30.765 ms; b-Ax took 207.460 ms, out of which Lap took 183.238 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 477.588 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279672, int_b + int_rho = 9.459e-14, checking this took 0.120 ms
2-norm of RHS = 747.4406610307972, which took 0.155 ms

iter_count = 126, r_2norm = 6.847e-04, tol*||rhs|| = 7.474e-04

Anderson update took 75.130 ms, out of which F'*F took 38.213 ms; b-Ax took 262.269 ms, out of which Lap took 230.146 ms
Solving Poisson took 565.895 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.101530 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.416 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.115332 
Total time for convolution: 	 convolve: 5.101057 
Total time for convolution: 	 convolve: 5.104357 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.713 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.391 ms
---Transfer Veff_loc: D2D took 2.137 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.285 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.459 ms

This SCF took 28497.429 ms, scf error = 6.073e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.105916, lowerbound = -0.910791, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2810.592 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 30.377 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 5.738 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.476 ms
rank =  0, Distribute data + matrix mult took 36.609 ms
rank =  0, finding HY took 46.487 ms
rank =  0, distributing HY into block cyclic form took 30.620 ms
rank =  0, finding Y'*HY took 7.836 ms
Rank 0, Project_Hamiltonian used 121.583 ms
Total time for projection: 121.601 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.199 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.278 ms
    first calculated eigval = -0.910664215605489
    last  calculated eigval = 0.005838881336877
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.36518882207673
lambda[  12] =  -0.36518820740211
lambda[  13] =  -0.36518672617466
lambda[  14] =  -0.35893900941276
lambda[  15] =  -0.34149568157628
lambda[  16] =  -0.34149513899660
lambda[  17] =  -0.34149389085118
lambda[  18] =  -0.33885350359289
lambda[  19] =  -0.33885160565475
lambda[  20] =  -0.33885147826220
lambda[  21] =  -0.09056568857282
lambda[  22] =  -0.09056444191875
lambda[  23] =  -0.09056405493973
lambda[  24] =  -0.08240414359333
lambda[  25] =  -0.08240398842126
lambda[  26] =  -0.04872522166746
lambda[  27] =   0.00547667929986
lambda[  28] =   0.00567106880471
lambda[  29] =   0.00583888133688
==subpsace eigenproblem: bcast eigvals took 0.093 ms
Total time for solving subspace eigenvalue problem: 0.377 ms
rank =  0, subspace rotation using ScaLAPACK took 11.734 ms
rank =  0, Distributing orbital back into band + domain format took 31.163 ms
rank = 0, Subspace_Rotation used 42.919 ms

Total time for subspace rotation: 42.924 ms
rank = 0, Efermi =  -0.120033410744 calculate fermi energy took 0.102 ms
rank = 0, --- Calculate rho: sum over local bands took 8.444 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.427 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.400 ms
rank = 0, Calculating density took 2990.938 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.305 ms
rank = 0, D2D took 1.499 ms
rank = 0, Transfering density took 2.358 ms
Etot    =   -71.405566590587
Eband   =   -20.785778561834
E1      =    45.721831163913
E2      =   -19.586810293444
E3      =   -24.498576921188
Exc     =   -22.401514633653
Esc     =  -118.025491772347
Entropy =    -0.000000001298
dE = 6.230e-06, dEband = 5.123e-04
rank = 0, Calculating/Estimating energy took 0.985 ms, Etot = -71.405566591, dEtot = 6.230e-06, dEband = 5.123e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0705192912021, which took 0.093 ms

iter_count = 108, r_2norm = 2.149e-06, tol*||rhs|| = 2.821e-06

Anderson update took 64.689 ms, out of which F'*F took 30.569 ms; b-Ax took 205.811 ms, out of which Lap took 181.823 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 475.284 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279664, int_b + int_rho = 1.455e-14, checking this took 0.114 ms
2-norm of RHS = 747.4836651136226, which took 0.133 ms

iter_count = 162, r_2norm = 7.040e-04, tol*||rhs|| = 7.475e-04

Anderson update took 96.136 ms, out of which F'*F took 47.883 ms; b-Ax took 332.520 ms, out of which Lap took 291.169 ms
Solving Poisson took 722.780 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.102093 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.163 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.103562 
Total time for convolution: 	 convolve: 5.103317 
Total time for convolution: 	 convolve: 5.098538 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.726 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.405 ms
---Transfer Veff_loc: D2D took 2.166 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.290 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.490 ms

This SCF took 28632.739 ms, scf error = 4.480e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.105839, lowerbound = -0.910664, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2820.910 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 29.974 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 5.249 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 35.249 ms
rank =  0, finding HY took 46.283 ms
rank =  0, distributing HY into block cyclic form took 30.663 ms
rank =  0, finding Y'*HY took 7.739 ms
Rank 0, Project_Hamiltonian used 119.969 ms
Total time for projection: 119.987 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.199 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.273 ms
    first calculated eigval = -0.910138193800448
    last  calculated eigval = 0.006113274859708
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.36474101974137
lambda[  12] =  -0.36474073365575
lambda[  13] =  -0.36474017666886
lambda[  14] =  -0.35850799850549
lambda[  15] =  -0.34104992086849
lambda[  16] =  -0.34104967022606
lambda[  17] =  -0.34104915445890
lambda[  18] =  -0.33840666969341
lambda[  19] =  -0.33840608876831
lambda[  20] =  -0.33840572722415
lambda[  21] =  -0.09010590812641
lambda[  22] =  -0.09010552807133
lambda[  23] =  -0.09010535429691
lambda[  24] =  -0.08197912214713
lambda[  25] =  -0.08197898737958
lambda[  26] =  -0.04753106735673
lambda[  27] =   0.00584287649662
lambda[  28] =   0.00598906694243
lambda[  29] =   0.00611327485971
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.305 ms
rank =  0, subspace rotation using ScaLAPACK took 11.665 ms
rank =  0, Distributing orbital back into band + domain format took 31.078 ms
rank = 0, Subspace_Rotation used 42.763 ms

Total time for subspace rotation: 42.769 ms
rank = 0, Efermi =  -0.119574279560 calculate fermi energy took 0.081 ms
rank = 0, --- Calculate rho: sum over local bands took 8.361 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.450 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.970 ms
rank = 0, Calculating density took 3000.738 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.073 ms
rank = 0, D2D took 1.195 ms
rank = 0, Transfering density took 1.203 ms
Etot    =   -71.405710132559
Eband   =   -20.766866032911
E1      =    45.713570745597
E2      =   -19.575614346552
E3      =   -24.499946461723
Exc     =   -22.402483879873
Esc     =  -118.025491772347
Entropy =    -0.000000001298
dE = 1.595e-05, dEband = 2.101e-03
rank = 0, Calculating/Estimating energy took 1.203 ms, Etot = -71.405710133, dEtot = 1.595e-05, dEband = 2.101e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0548865026635, which took 0.108 ms

iter_count = 108, r_2norm = 2.109e-06, tol*||rhs|| = 2.195e-06

Anderson update took 64.365 ms, out of which F'*F took 30.075 ms; b-Ax took 206.233 ms, out of which Lap took 181.534 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 474.731 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279677, int_b + int_rho = 1.455e-13, checking this took 0.154 ms
2-norm of RHS = 747.4834919017811, which took 0.206 ms

iter_count = 108, r_2norm = 7.441e-04, tol*||rhs|| = 7.475e-04

Anderson update took 64.339 ms, out of which F'*F took 31.294 ms; b-Ax took 217.972 ms, out of which Lap took 190.319 ms
Solving Poisson took 481.312 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.104922 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.761 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.099401 
Total time for convolution: 	 convolve: 5.099607 
Total time for convolution: 	 convolve: 5.098435 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.704 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.406 ms
---Transfer Veff_loc: D2D took 2.158 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.292 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.487 ms

This SCF took 28388.884 ms, scf error = 1.750e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.106113, lowerbound = -0.910138, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2785.667 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 30.437 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 5.865 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.207 ms
rank =  0, Distribute data + matrix mult took 36.529 ms
rank =  0, finding HY took 46.242 ms
rank =  0, distributing HY into block cyclic form took 30.559 ms
rank =  0, finding Y'*HY took 7.941 ms
Rank 0, Project_Hamiltonian used 121.306 ms
Total time for projection: 121.319 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.196 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.276 ms
    first calculated eigval = -0.910054934138929
    last  calculated eigval = 0.006097154185333
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.36466044042462
lambda[  12] =  -0.36465993961604
lambda[  13] =  -0.36465956976110
lambda[  14] =  -0.35842731367499
lambda[  15] =  -0.34096863616809
lambda[  16] =  -0.34096829610345
lambda[  17] =  -0.34096795559442
lambda[  18] =  -0.33832429265080
lambda[  19] =  -0.33832395996259
lambda[  20] =  -0.33832354255955
lambda[  21] =  -0.09002945981833
lambda[  22] =  -0.09002925374306
lambda[  23] =  -0.09002895728814
lambda[  24] =  -0.08190432545523
lambda[  25] =  -0.08190424673689
lambda[  26] =  -0.04736825571926
lambda[  27] =   0.00589484935134
lambda[  28] =   0.00600204840354
lambda[  29] =   0.00609715418533
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.312 ms
rank =  0, subspace rotation using ScaLAPACK took 11.564 ms
rank =  0, Distributing orbital back into band + domain format took 31.061 ms
rank = 0, Subspace_Rotation used 42.648 ms

Total time for subspace rotation: 42.655 ms
rank = 0, Efermi =  -0.119497906407 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 8.353 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.004 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.356 ms
rank = 0, Calculating density took 2965.633 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.282 ms
rank = 0, D2D took 1.398 ms
rank = 0, Transfering density took 1.400 ms
Etot    =   -71.405730806058
Eband   =   -20.763563547327
E1      =    45.711749364950
E2      =   -19.574024351158
E3      =   -24.500345310794
Exc     =   -22.402794511988
Esc     =  -118.025491772347
Entropy =    -0.000000001298
dE = 2.297e-06, dEband = 3.669e-04
rank = 0, Calculating/Estimating energy took 1.043 ms, Etot = -71.405730806, dEtot = 2.297e-06, dEband = 3.669e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0293141571154, which took 0.067 ms

iter_count = 114, r_2norm = 8.086e-07, tol*||rhs|| = 1.173e-06

Anderson update took 68.477 ms, out of which F'*F took 32.111 ms; b-Ax took 218.199 ms, out of which Lap took 192.556 ms
rank = 0, Mixing (+ precond) took 502.980 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279668, int_b + int_rho = 5.093e-14, checking this took 0.142 ms
2-norm of RHS = 747.4877222741765, which took 0.217 ms

iter_count = 150, r_2norm = 7.076e-04, tol*||rhs|| = 7.475e-04

Anderson update took 89.179 ms, out of which F'*F took 44.681 ms; b-Ax took 307.018 ms, out of which Lap took 269.069 ms
Solving Poisson took 669.511 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.117019 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.424 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.101091 
Total time for convolution: 	 convolve: 5.100309 
Total time for convolution: 	 convolve: 5.099440 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.990 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.641 ms
---Transfer Veff_loc: D2D took 2.156 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.483 ms

This SCF took 28570.451 ms, scf error = 1.473e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.106097, lowerbound = -0.910055, upperbound = 267.562582

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2807.106 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 30.607 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 5.980 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 36.617 ms
rank =  0, finding HY took 46.379 ms
rank =  0, distributing HY into block cyclic form took 30.574 ms
rank =  0, finding Y'*HY took 7.958 ms
Rank 0, Project_Hamiltonian used 121.564 ms
Total time for projection: 121.575 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.198 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.281 ms
    first calculated eigval = -0.909810522847093
    last  calculated eigval = 0.006240538916823
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.36444312560081
lambda[  12] =  -0.36444289487149
lambda[  13] =  -0.36444186253533
lambda[  14] =  -0.35822128455093
lambda[  15] =  -0.34075066577831
lambda[  16] =  -0.34075047212669
lambda[  17] =  -0.34074964464050
lambda[  18] =  -0.33809750221233
lambda[  19] =  -0.33809703095236
lambda[  20] =  -0.33809686325384
lambda[  21] =  -0.08980721135250
lambda[  22] =  -0.08980666943212
lambda[  23] =  -0.08980654327236
lambda[  24] =  -0.08168776943488
lambda[  25] =  -0.08168775385092
lambda[  26] =  -0.04678539730463
lambda[  27] =   0.00608663897720
lambda[  28] =   0.00616595968685
lambda[  29] =   0.00624053891682
==subpsace eigenproblem: bcast eigvals took 0.035 ms
Total time for solving subspace eigenvalue problem: 0.322 ms
rank =  0, subspace rotation using ScaLAPACK took 12.387 ms
rank =  0, Distributing orbital back into band + domain format took 30.330 ms
rank = 0, Subspace_Rotation used 42.749 ms

Total time for subspace rotation: 42.758 ms
rank = 0, Efermi =  -0.119275491298 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 8.465 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.987 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.357 ms
rank = 0, Calculating density took 2987.401 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.276 ms
rank = 0, D2D took 1.407 ms
rank = 0, Transfering density took 1.414 ms
Etot    =   -71.405776769284
Eband   =   -20.754356418594
E1      =    45.706956610679
E2      =   -19.569350388514
E3      =   -24.501293505004
Exc     =   -22.403529081242
Esc     =  -118.025491772347
Entropy =    -0.000000001298
dE = 5.107e-06, dEband = 1.023e-03
rank = 0, Calculating/Estimating energy took 1.036 ms, Etot = -71.405776769, dEtot = 5.107e-06, dEband = 1.023e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0182656019894, which took 0.073 ms

iter_count = 114, r_2norm = 4.821e-07, tol*||rhs|| = 7.306e-07

Anderson update took 68.115 ms, out of which F'*F took 32.094 ms; b-Ax took 218.245 ms, out of which Lap took 192.651 ms
rank = 0, Mixing (+ precond) took 503.406 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000004279662, int_rho =  40.00000004279669, int_b + int_rho = 5.821e-14, checking this took 0.119 ms
2-norm of RHS = 747.4895789407053, which took 0.178 ms

iter_count = 132, r_2norm = 7.012e-04, tol*||rhs|| = 7.475e-04

Anderson update took 78.534 ms, out of which F'*F took 38.763 ms; b-Ax took 268.014 ms, out of which Lap took 234.469 ms
Solving Poisson took 585.897 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.116441 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.271 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.102344 
Total time for convolution: 	 convolve: 5.100977 
Total time for convolution: 	 convolve: 5.098330 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.066 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.329 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 2.113 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.787 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.932 ms

This SCF took 28508.018 ms, scf error = 8.439e-05
The last 19 occupations of kpoints #1 are (Nelectron = 40):
lambda[  11] =  -0.36444312560081, occ[  11] =   2.00000000000000
lambda[  12] =  -0.36444289487149, occ[  12] =   2.00000000000000
lambda[  13] =  -0.36444186253533, occ[  13] =   2.00000000000000
lambda[  14] =  -0.35822128455093, occ[  14] =   2.00000000000000
lambda[  15] =  -0.34075066577831, occ[  15] =   2.00000000000000
lambda[  16] =  -0.34075047212669, occ[  16] =   2.00000000000000
lambda[  17] =  -0.34074964464050, occ[  17] =   2.00000000000000
lambda[  18] =  -0.33809750221233, occ[  18] =   2.00000000000000
lambda[  19] =  -0.33809703095236, occ[  19] =   2.00000000000000
lambda[  20] =  -0.33809686325384, occ[  20] =   2.00000000000000
lambda[  21] =  -0.08980721135250, occ[  21] =   0.00000001427170
lambda[  22] =  -0.08980666943212, occ[  22] =   0.00000001426302
lambda[  23] =  -0.08980654327236, occ[  23] =   0.00000001426100
lambda[  24] =  -0.08168776943488, occ[  24] =   0.00000000000047
lambda[  25] =  -0.08168775385092, occ[  25] =   0.00000000000047
lambda[  26] =  -0.04678539730463, occ[  26] =   0.00000000000000
lambda[  27] =   0.00608663897720, occ[  27] =   0.00000000000000
lambda[  28] =   0.00616595968685, occ[  28] =   0.00000000000000
lambda[  29] =   0.00624053891682, occ[  29] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 26 (90%) = 0.000000000000000.
Occupation of state 29 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.201 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 1.108 ms, time for Allreduce/Reduce: 14.796 ms 
Time for calculating local force components: 31.320 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000107135297  -0.00000081866750   0.00000097667395
 -0.05685385222357  -0.05685357230111  -0.05685400722195
  0.05685625931542   0.05685631927972  -0.05685627476369
  0.05685382546201  -0.05685407108106   0.05685436816345
 -0.05685413446137   0.05685464159309   0.05685406922859
 -0.56888689483631  -0.56888738463619  -0.56888715713954
  0.56888462723826   0.56888524152721  -0.56888521602684
  0.56888638504255  -0.56888681662568   0.56888738929864
 -0.56888741823228   0.56888697019161   0.56888793289439
force_loc = 
 -0.00000177219397  -0.00000016066523  -0.00000054155469
  0.04663075857679   0.04662817811818   0.04663015864428
 -0.04663462278022  -0.04662732746741   0.04662687264321
 -0.04662799579576   0.04662966311998  -0.04662954621392
  0.04662736575505  -0.04663295475321  -0.04663065894845
  0.55840511113829   0.55839883486878   0.55840442307513
 -0.55840573388874  -0.55840375367509   0.55840510835143
 -0.55840056476139   0.55840485621784  -0.55840259857341
  0.55840362027096  -0.55841067768300  -0.55839696962705
Time for calculating nonlocal force components: 72.690 ms
[32mforces_xc: 
[0m[32m -0.00000007782191  -0.00000003792398   0.00000003781551
[0m[32m  0.01259840182288   0.01259821432226   0.01259832011799
[0m[32m -0.01259860676943  -0.01259810423992   0.01259803753845
[0m[32m -0.01259815431674   0.01259830056478  -0.01259829601827
[0m[32m  0.01259808518524  -0.01259849342515  -0.01259840826688
[0m[32m  0.00907915082296   0.00907894416116   0.00907914340082
[0m[32m -0.00907901501973  -0.00907913698831   0.00907918129158
[0m[32m -0.00907899205848   0.00907920480463  -0.00907907002409
[0m[32m  0.00907912731329  -0.00907939626694  -0.00907886092205
[0mTime for calculating XC forces components: 42.969 ms
 Cartesian force = 
 -0.00000223375006   0.00000046470224  -0.00000046193596
  0.00237599579489   0.00237430209829   0.00237353666959
 -0.00237628261544  -0.00236763046866   0.00236770054724
 -0.00237163703169   0.00237537456265  -0.00237440893947
  0.00237200409772  -0.00237532462632  -0.00237593285747
 -0.00140194525626  -0.00140812364730  -0.00140452553433
  0.00140056594859   0.00140383282276  -0.00140186125456
  0.00140751584147  -0.00140127364426   0.00140478583041
 -0.00140398302923   0.00139837820061   0.00141116747455
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.376 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Time for printing density: 393.480 ms
The program took 413.782 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:03
Job ID:        2266571
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:25:24,vmem=8264K,walltime=00:07:07,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-16-1
---------------------------------------
