---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:31
Job ID:    2266727
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:36
Job ID:    2266727
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.053 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 5.395 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 6.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 18.936 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 112.537 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.948 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.445 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.029421	   13.829381	   10.000000	
    9.622059	    6.170619	   11.564160	
    9.622059	    6.170619	    8.435840	
   10.095095	   11.824326	   10.000000	
   10.155606	    9.536855	   10.000000	
   10.377941	    6.962938	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.528 ms
Set up communicators.

--set up spincomm took 1.880 ms

--set up kptcomm took 0.332 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.005 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.923 ms

Calculate_SplineDerivRadFun took 0.234 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.297 ms.
time spent on vectorized spline interp: 2.459 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.007 ms.
time spent on vectorized spline interp: 1.970 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.531 ms.
time spent on vectorized spline interp: 1.940 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.552 ms.

Calculating rb for all atom types took 16.501 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.909 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.032 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000171144, sum_int_rho = 15.6922299708167
PosCharge = 16.000000017114, NegCharge = -15.692229970817, scal_fac = 1.019612894208
After scaling, int_rho = 16.0000000171143, PosCharge + NegCharge - NetCharge = 1.421e-14
--Calculate Vref took 0.350 ms
--Calculate rho_guess took 2.022 ms

 integral of b = -16.0000000171144,
 int{b} + Nelectron + NetCharge = -1.711e-08,
 Esc = -41.6320719267256,
 MPI_Reduce took 4.922 ms

Calculating b & b_ref took 12.818 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.015 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.082 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 27.511 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711435, int_b + int_rho = -3.092e-14, checking this took 0.101 ms
2-norm of RHS = 583.9876885489277, which took 0.482 ms

iter_count = 420, r_2norm = 5.382e-04, tol*||rhs|| = 5.840e-04

Anderson update took 257.410 ms, out of which F'*F took 118.125 ms; b-Ax took 801.615 ms, out of which Lap took 714.783 ms
Solving Poisson took 1766.337 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.384 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.837 ms
Total time for convolution: 	 convolve: 5.120013 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
Total time for convolution: 	 convolve: 5.108807 
Total time for convolution: 	 convolve: 5.108719 
Total time for convolution: 	 convolve: 5.104021 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.709 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.145 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.331 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
rank = 0, XC calculation took 24252.842 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 1.088 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.788 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 2.951 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.147 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.853 ms
    Lanczos iter 53, eigmin  = -0.935400735, eigmax = 264.925383713, err_eigmin = 9.390e-04, err_eigmax = 9.632e-03
rank =   0, Lanczos took 133.032 ms, eigmin = -0.935400735193, eigmax = 267.574637550301

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.269618, lowerbound = -1.035401, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1374.987 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 16.551 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.648 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.066 ms
rank =  0, Distribute data + matrix mult took 19.288 ms
rank =  0, finding HY took 21.378 ms
rank =  0, distributing HY into block cyclic form took 15.918 ms
rank =  0, finding Y'*HY took 2.193 ms
Rank 0, Project_Hamiltonian used 58.809 ms
Total time for projection: 58.822 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.380 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.866 ms
    first calculated eigval = 2.785938149166354
    last  calculated eigval = 3.193180533339282
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.78593814916635
lambda[   2] =   2.84049214855771
lambda[   3] =   2.86433185543126
lambda[   4] =   2.91001451709513
lambda[   5] =   2.94922415125517
lambda[   6] =   2.98854522074923
lambda[   7] =   3.01825471661052
lambda[   8] =   3.02740641737360
lambda[   9] =   3.06313632513428
lambda[  10] =   3.07377673469088
lambda[  11] =   3.10032173532991
lambda[  12] =   3.13355102051862
lambda[  13] =   3.16099246992565
lambda[  14] =   3.19318053333928
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.880 ms
rank =  0, subspace rotation using ScaLAPACK took 4.449 ms
rank =  0, Distributing orbital back into band + domain format took 13.651 ms
rank = 0, Subspace_Rotation used 18.118 ms

Total time for subspace rotation: 18.121 ms
rank = 0, Efermi =   3.045271583044 calculate fermi energy took 0.055 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.293181, lowerbound = -1.035401, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1357.556 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 14.773 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.564 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 16.376 ms
rank =  0, finding HY took 20.541 ms
rank =  0, distributing HY into block cyclic form took 14.743 ms
rank =  0, finding Y'*HY took 2.377 ms
Rank 0, Project_Hamiltonian used 54.069 ms
Total time for projection: 54.074 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.725035508953978
    last  calculated eigval = 0.454520298953915
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.72503550895398
lambda[   2] =  -0.66036982233948
lambda[   3] =  -0.23368808984802
lambda[   4] =  -0.10910907913961
lambda[   5] =  -0.05879340845167
lambda[   6] =   0.08193329914651
lambda[   7] =   0.17311712634258
lambda[   8] =   0.27093243826760
lambda[   9] =   0.32107021194754
lambda[  10] =   0.35266767154388
lambda[  11] =   0.35953789595537
lambda[  12] =   0.39790931371095
lambda[  13] =   0.40853376800983
lambda[  14] =   0.45452029895391
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.139 ms
rank =  0, subspace rotation using ScaLAPACK took 3.909 ms
rank =  0, Distributing orbital back into band + domain format took 14.247 ms
rank = 0, Subspace_Rotation used 18.171 ms

Total time for subspace rotation: 18.174 ms
rank = 0, Efermi =   0.296007613348 calculate fermi energy took 0.021 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.554520, lowerbound = -1.035401, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1298.120 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 24.843 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.588 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 26.467 ms
rank =  0, finding HY took 20.381 ms
rank =  0, distributing HY into block cyclic form took 14.744 ms
rank =  0, finding Y'*HY took 2.358 ms
Rank 0, Project_Hamiltonian used 63.991 ms
Total time for projection: 63.994 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.068 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.118 ms
    first calculated eigval = -0.949977633312054
    last  calculated eigval = 0.146923350325358
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.94997763331205
lambda[   2] =  -0.83531804604029
lambda[   3] =  -0.60698734818547
lambda[   4] =  -0.57356335286369
lambda[   5] =  -0.55887817433939
lambda[   6] =  -0.40954276151575
lambda[   7] =  -0.34262790252840
lambda[   8] =  -0.21227528902177
lambda[   9] =  -0.02021421501134
lambda[  10] =   0.04496953943175
lambda[  11] =   0.08194062892912
lambda[  12] =   0.09203669080265
lambda[  13] =   0.11957758816582
lambda[  14] =   0.14692335032536
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.127 ms
rank =  0, subspace rotation using ScaLAPACK took 3.716 ms
rank =  0, Distributing orbital back into band + domain format took 14.251 ms
rank = 0, Subspace_Rotation used 17.983 ms

Total time for subspace rotation: 17.986 ms
rank = 0, Efermi =  -0.049520343563 calculate fermi energy took 0.023 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.246923, lowerbound = -1.035401, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1359.489 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.748 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.570 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 16.361 ms
rank =  0, finding HY took 20.547 ms
rank =  0, distributing HY into block cyclic form took 14.889 ms
rank =  0, finding Y'*HY took 2.297 ms
Rank 0, Project_Hamiltonian used 54.123 ms
Total time for projection: 54.128 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.950403045937858
    last  calculated eigval = 0.094097111531934
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95040304593786
lambda[   2] =  -0.83594264069640
lambda[   3] =  -0.61076834870487
lambda[   4] =  -0.57599592194727
lambda[   5] =  -0.56542304235926
lambda[   6] =  -0.42218188010835
lambda[   7] =  -0.36054399588551
lambda[   8] =  -0.31593113325497
lambda[   9] =  -0.06381741262672
lambda[  10] =  -0.02281722522613
lambda[  11] =  -0.01301932867798
lambda[  12] =   0.04378288357284
lambda[  13] =   0.07321790036879
lambda[  14] =   0.09409711153193
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 3.953 ms
rank =  0, Distributing orbital back into band + domain format took 14.120 ms
rank = 0, Subspace_Rotation used 18.091 ms

Total time for subspace rotation: 18.094 ms
rank = 0, Efermi =  -0.093123541170 calculate fermi energy took 0.020 ms
rank = 0, --- Calculate rho: sum over local bands took 2.618 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.640 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.093 ms
rank = 0, Calculating density took 5833.724 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
rank = 0, D2D took 1.517 ms
rank = 0, Transfering density took 1.519 ms
Etot    =   -24.238384964189
Eband   =    -9.274380018881
E1      =    18.647653143329
E2      =    -7.130623214734
E3      =    -8.851284352429
Exc     =    -7.961493728556
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 4.040e+00, dEband = 1.546e+00
rank = 0, Calculating/Estimating energy took 0.957 ms, Etot = -24.238384964, dEtot = 4.040e+00, dEband = 1.546e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 43.0450061153469, which took 0.094 ms

iter_count = 96, r_2norm = 1.532e-03, tol*||rhs|| = 1.722e-03

Anderson update took 56.907 ms, out of which F'*F took 26.716 ms; b-Ax took 180.271 ms, out of which Lap took 160.097 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 407.410 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711438, int_b + int_rho = 3.638e-15, checking this took 0.110 ms
2-norm of RHS = 580.2202188216544, which took 0.129 ms

iter_count = 288, r_2norm = 5.609e-04, tol*||rhs|| = 5.802e-04

Anderson update took 171.871 ms, out of which F'*F took 80.171 ms; b-Ax took 536.335 ms, out of which Lap took 479.107 ms
Solving Poisson took 1194.339 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.236 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.115481 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.088537 
Total time for convolution: 	 convolve: 5.099509 
Total time for convolution: 	 convolve: 5.088871 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.300 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.134 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 0.680 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.294 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.992 ms

This SCF took 31826.390 ms, scf error = 1.994e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.194097, lowerbound = -0.950403, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1316.813 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.893 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.571 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 16.509 ms
rank =  0, finding HY took 20.725 ms
rank =  0, distributing HY into block cyclic form took 14.800 ms
rank =  0, finding Y'*HY took 2.342 ms
Rank 0, Project_Hamiltonian used 54.411 ms
Total time for projection: 54.429 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.919211202658302
    last  calculated eigval = 0.064835002745550
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.91921120265830
lambda[   2] =  -0.77938222639824
lambda[   3] =  -0.58094750306485
lambda[   4] =  -0.53839865422621
lambda[   5] =  -0.53792034978866
lambda[   6] =  -0.39077946062891
lambda[   7] =  -0.32554492316280
lambda[   8] =  -0.27966401291165
lambda[   9] =  -0.05133032709865
lambda[  10] =  -0.03336427349062
lambda[  11] =  -0.02210385064996
lambda[  12] =   0.02239405761606
lambda[  13] =   0.03974546909255
lambda[  14] =   0.06483500274555
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 4.038 ms
rank =  0, Distributing orbital back into band + domain format took 14.135 ms
rank = 0, Subspace_Rotation used 18.189 ms

Total time for subspace rotation: 18.192 ms
rank = 0, Efermi =  -0.080636455640 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.547 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.739 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.233 ms
rank = 0, Calculating density took 1394.103 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.409 ms
rank = 0, D2D took 0.519 ms
rank = 0, Transfering density took 0.526 ms
Etot    =   -24.177018947291
Eband   =    -8.703696666558
E1      =    18.161807310252
E2      =    -7.081005215676
E3      =    -8.989758144340
Exc     =    -8.073821023759
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 1.023e-02, dEband = 9.511e-02
rank = 0, Calculating/Estimating energy took 0.981 ms, Etot = -24.177018947, dEtot = 1.023e-02, dEband = 9.511e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 15.4674535693545, which took 0.078 ms

iter_count = 102, r_2norm = 5.876e-04, tol*||rhs|| = 6.187e-04

Anderson update took 60.045 ms, out of which F'*F took 30.415 ms; b-Ax took 193.622 ms, out of which Lap took 171.418 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.936 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711435, int_b + int_rho = -2.910e-14, checking this took 0.115 ms
2-norm of RHS = 575.8019531644786, which took 0.144 ms

iter_count = 306, r_2norm = 4.698e-04, tol*||rhs|| = 5.758e-04

Anderson update took 178.460 ms, out of which F'*F took 83.493 ms; b-Ax took 572.042 ms, out of which Lap took 507.518 ms
Solving Poisson took 1262.856 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.450 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.102876 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.083927 
Total time for convolution: 	 convolve: 5.077212 
Total time for convolution: 	 convolve: 5.080696 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 0.942 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.146 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.462 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.663 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.976 ms

This SCF took 27448.576 ms, scf error = 1.312e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.164835, lowerbound = -0.919211, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1373.727 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.749 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.678 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.079 ms
rank =  0, Distribute data + matrix mult took 16.517 ms
rank =  0, finding HY took 22.076 ms
rank =  0, distributing HY into block cyclic form took 14.760 ms
rank =  0, finding Y'*HY took 2.361 ms
Rank 0, Project_Hamiltonian used 55.749 ms
Total time for projection: 55.765 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -0.872698496518929
    last  calculated eigval = 0.048858423098437
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.87269849651893
lambda[   2] =  -0.69347649920297
lambda[   3] =  -0.53488541014144
lambda[   4] =  -0.49746698130833
lambda[   5] =  -0.47895790683617
lambda[   6] =  -0.34213237338074
lambda[   7] =  -0.27096032688584
lambda[   8] =  -0.22390944940953
lambda[   9] =  -0.04003121300353
lambda[  10] =  -0.01761122543180
lambda[  11] =   0.00420216761496
lambda[  12] =   0.01605934392016
lambda[  13] =   0.02339213317797
lambda[  14] =   0.04885842309844
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 3.949 ms
rank =  0, Distributing orbital back into band + domain format took 14.201 ms
rank = 0, Subspace_Rotation used 18.859 ms

Total time for subspace rotation: 18.865 ms
rank = 0, Efermi =  -0.069337341491 calculate fermi energy took 0.604 ms
rank = 0, --- Calculate rho: sum over local bands took 2.392 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.854 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.102 ms
rank = 0, Calculating density took 1452.541 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.735 ms
rank = 0, D2D took 0.937 ms
rank = 0, Transfering density took 0.945 ms
Etot    =   -24.132204663460
Eband   =    -7.828974888053
E1      =    17.444943102233
E2      =    -6.922369029450
E3      =    -9.224177589736
Exc     =    -8.262647569583
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 7.469e-03, dEband = 1.458e-01
rank = 0, Calculating/Estimating energy took 1.096 ms, Etot = -24.132204663, dEtot = 7.469e-03, dEband = 1.458e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.4221631052812, which took 0.120 ms

iter_count = 108, r_2norm = 1.417e-04, tol*||rhs|| = 2.169e-04

Anderson update took 64.632 ms, out of which F'*F took 30.187 ms; b-Ax took 203.082 ms, out of which Lap took 180.735 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.595 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711423, int_b + int_rho = -1.528e-13, checking this took 0.136 ms
2-norm of RHS = 576.1731950985179, which took 0.156 ms

iter_count = 276, r_2norm = 5.624e-04, tol*||rhs|| = 5.762e-04

Anderson update took 164.782 ms, out of which F'*F took 76.362 ms; b-Ax took 518.481 ms, out of which Lap took 459.184 ms
Solving Poisson took 1168.327 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.233 ms
Total time for convolution: 	 convolve: 5.090448 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 6.206517 
Total time for convolution: 	 convolve: 5.089532 
Total time for convolution: 	 convolve: 5.079140 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.318 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.681 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.992 ms

This SCF took 28547.584 ms, scf error = 4.751e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.148858, lowerbound = -0.872698, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1394.550 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.767 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.579 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 16.395 ms
rank =  0, finding HY took 20.803 ms
rank =  0, distributing HY into block cyclic form took 14.849 ms
rank =  0, finding Y'*HY took 2.440 ms
Rank 0, Project_Hamiltonian used 54.520 ms
Total time for projection: 54.543 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.864249451501205
    last  calculated eigval = 0.041708790301660
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.86424945150121
lambda[   2] =  -0.67364581791869
lambda[   3] =  -0.52420505149135
lambda[   4] =  -0.48977212757424
lambda[   5] =  -0.46355788749794
lambda[   6] =  -0.33148745247745
lambda[   7] =  -0.25633161703260
lambda[   8] =  -0.21348025213800
lambda[   9] =  -0.04201383727250
lambda[  10] =  -0.01014477653242
lambda[  11] =   0.00514845119984
lambda[  12] =   0.01475204183676
lambda[  13] =   0.01877742654018
lambda[  14] =   0.04170879030166
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 4.628 ms
rank =  0, Distributing orbital back into band + domain format took 12.708 ms
rank = 0, Subspace_Rotation used 17.355 ms

Total time for subspace rotation: 17.366 ms
rank = 0, Efermi =  -0.071319965775 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.534 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.996 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.094 ms
rank = 0, Calculating density took 1471.365 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.779 ms
rank = 0, D2D took 1.071 ms
rank = 0, Transfering density took 1.082 ms
Etot    =   -24.128467366367
Eband   =    -7.633459315982
E1      =    17.330473397894
E2      =    -6.831960070562
E3      =    -9.277779740777
Exc     =    -8.303149332377
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 6.229e-04, dEband = 3.259e-02
rank = 0, Calculating/Estimating energy took 1.067 ms, Etot = -24.128467366, dEtot = 6.229e-04, dEband = 3.259e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.6067891316789, which took 0.053 ms

iter_count = 108, r_2norm = 8.783e-05, tol*||rhs|| = 1.043e-04

Anderson update took 63.991 ms, out of which F'*F took 29.700 ms; b-Ax took 204.562 ms, out of which Lap took 179.139 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.688 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711435, int_b + int_rho = -3.638e-14, checking this took 0.102 ms
2-norm of RHS = 576.4624102124404, which took 0.096 ms

iter_count = 264, r_2norm = 5.692e-04, tol*||rhs|| = 5.765e-04

Anderson update took 157.019 ms, out of which F'*F took 72.714 ms; b-Ax took 501.500 ms, out of which Lap took 441.514 ms
Solving Poisson took 1119.684 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.090204 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.090230 
Total time for convolution: 	 convolve: 5.096837 
Total time for convolution: 	 convolve: 5.076859 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.156 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.668 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.998 ms

This SCF took 27958.446 ms, scf error = 1.899e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.141709, lowerbound = -0.864249, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1334.755 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.594 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.555 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.183 ms
rank =  0, finding HY took 21.244 ms
rank =  0, distributing HY into block cyclic form took 15.069 ms
rank =  0, finding Y'*HY took 2.300 ms
Rank 0, Project_Hamiltonian used 54.828 ms
Total time for projection: 54.847 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -0.858417898086096
    last  calculated eigval = 0.038572044728016
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85841789808610
lambda[   2] =  -0.66409589046448
lambda[   3] =  -0.51736567511515
lambda[   4] =  -0.48400239699812
lambda[   5] =  -0.45389982373452
lambda[   6] =  -0.32539404701273
lambda[   7] =  -0.24892595575611
lambda[   8] =  -0.20611368924188
lambda[   9] =  -0.04246825127829
lambda[  10] =  -0.00706175846443
lambda[  11] =   0.00476309676679
lambda[  12] =   0.01376532183778
lambda[  13] =   0.01752719057417
lambda[  14] =   0.03857204472802
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 4.636 ms
rank =  0, Distributing orbital back into band + domain format took 13.143 ms
rank = 0, Subspace_Rotation used 17.799 ms

Total time for subspace rotation: 17.807 ms
rank = 0, Efermi =  -0.071774379785 calculate fermi energy took 0.155 ms
rank = 0, --- Calculate rho: sum over local bands took 2.468 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.778 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1411.643 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.685 ms
rank = 0, D2D took 0.924 ms
rank = 0, Transfering density took 0.927 ms
Etot    =   -24.127285137872
Eband   =    -7.516430753545
E1      =    17.267055646540
E2      =    -6.771072433634
E3      =    -9.309551441696
Exc     =    -8.326461978955
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 1.970e-04, dEband = 1.950e-02
rank = 0, Calculating/Estimating energy took 1.121 ms, Etot = -24.127285138, dEtot = 1.970e-04, dEband = 1.950e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9940658613933, which took 0.056 ms

iter_count = 114, r_2norm = 2.405e-05, tol*||rhs|| = 3.976e-05

Anderson update took 68.586 ms, out of which F'*F took 32.173 ms; b-Ax took 218.325 ms, out of which Lap took 194.488 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 496.705 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711430, int_b + int_rho = -7.640e-14, checking this took 0.116 ms
2-norm of RHS = 576.8738329396281, which took 0.168 ms

iter_count = 252, r_2norm = 4.814e-04, tol*||rhs|| = 5.769e-04

Anderson update took 147.275 ms, out of which F'*F took 71.377 ms; b-Ax took 484.291 ms, out of which Lap took 430.646 ms
Solving Poisson took 1043.911 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.097344 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.092787 
Total time for convolution: 	 convolve: 5.091112 
Total time for convolution: 	 convolve: 5.098147 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
---Transfer Veff_loc: D2D took 0.696 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.017 ms

This SCF took 27303.121 ms, scf error = 9.391e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.138572, lowerbound = -0.858418, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1377.098 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.575 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.565 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 16.186 ms
rank =  0, finding HY took 21.514 ms
rank =  0, distributing HY into block cyclic form took 14.851 ms
rank =  0, finding Y'*HY took 2.332 ms
Rank 0, Project_Hamiltonian used 54.916 ms
Total time for projection: 54.931 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.854 ms
    first calculated eigval = -0.856191080623239
    last  calculated eigval = 0.036145653790387
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85619108062324
lambda[   2] =  -0.66279066249493
lambda[   3] =  -0.51500035076181
lambda[   4] =  -0.48184312051103
lambda[   5] =  -0.45131075358902
lambda[   6] =  -0.32324744267168
lambda[   7] =  -0.24697553395251
lambda[   8] =  -0.20389374296347
lambda[   9] =  -0.04247970429862
lambda[  10] =  -0.00628229345581
lambda[  11] =   0.00472111598374
lambda[  12] =   0.01321384925662
lambda[  13] =   0.01689147264297
lambda[  14] =   0.03614565379039
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.869 ms
rank =  0, subspace rotation using ScaLAPACK took 4.544 ms
rank =  0, Distributing orbital back into band + domain format took 13.795 ms
rank = 0, Subspace_Rotation used 18.356 ms

Total time for subspace rotation: 18.376 ms
rank = 0, Efermi =  -0.071785832756 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.572 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.735 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1454.822 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.701 ms
rank = 0, D2D took 0.929 ms
rank = 0, Transfering density took 0.938 ms
Etot    =   -24.126845539478
Eband   =    -7.482505375862
E1      =    17.264319817753
E2      =    -6.737714796529
E3      =    -9.314665087429
Exc     =    -8.328967938085
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 7.327e-05, dEband = 5.654e-03
rank = 0, Calculating/Estimating energy took 1.114 ms, Etot = -24.126845539, dEtot = 7.327e-05, dEband = 5.654e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4241983144779, which took 0.056 ms

iter_count = 114, r_2norm = 1.269e-05, tol*||rhs|| = 1.697e-05

Anderson update took 67.706 ms, out of which F'*F took 33.667 ms; b-Ax took 225.379 ms, out of which Lap took 201.488 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 492.305 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711438, int_b + int_rho = -3.638e-15, checking this took 0.132 ms
2-norm of RHS = 576.9692365460213, which took 0.104 ms

iter_count = 246, r_2norm = 4.978e-04, tol*||rhs|| = 5.770e-04

Anderson update took 144.708 ms, out of which F'*F took 68.407 ms; b-Ax took 464.546 ms, out of which Lap took 412.476 ms
Solving Poisson took 1016.323 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.084596 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.090211 
Total time for convolution: 	 convolve: 5.090751 
Total time for convolution: 	 convolve: 5.080851 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 0.700 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.288 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.002 ms

This SCF took 27287.995 ms, scf error = 4.651e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.136146, lowerbound = -0.856191, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1390.635 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.598 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.584 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 16.222 ms
rank =  0, finding HY took 21.441 ms
rank =  0, distributing HY into block cyclic form took 14.738 ms
rank =  0, finding Y'*HY took 1.936 ms
Rank 0, Project_Hamiltonian used 55.367 ms
Total time for projection: 55.390 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.852951275551539
    last  calculated eigval = 0.035196653774924
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85295127555154
lambda[   2] =  -0.65892613996620
lambda[   3] =  -0.51180934868690
lambda[   4] =  -0.47918947999868
lambda[   5] =  -0.44789024916028
lambda[   6] =  -0.31977845611540
lambda[   7] =  -0.24344662992564
lambda[   8] =  -0.20038374579334
lambda[   9] =  -0.04206035885491
lambda[  10] =  -0.00465123605901
lambda[  11] =   0.00571766648927
lambda[  12] =   0.01340397175705
lambda[  13] =   0.01788034284426
lambda[  14] =   0.03519665377492
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.997 ms
rank =  0, Distributing orbital back into band + domain format took 14.135 ms
rank = 0, Subspace_Rotation used 18.147 ms

Total time for subspace rotation: 18.150 ms
rank = 0, Efermi =  -0.071366487315 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.569 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.751 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1467.885 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 0.688 ms
rank = 0, D2D took 0.984 ms
rank = 0, Transfering density took 0.993 ms
Etot    =   -24.126518775343
Eband   =    -7.428750651116
E1      =    17.237948914818
E2      =    -6.707907066070
E3      =    -9.323876179361
Exc     =    -8.335428357233
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 5.446e-05, dEband = 8.959e-03
rank = 0, Calculating/Estimating energy took 1.059 ms, Etot = -24.126518775, dEtot = 5.446e-05, dEband = 8.959e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2150775737770, which took 0.054 ms

iter_count = 114, r_2norm = 6.716e-06, tol*||rhs|| = 8.603e-06

Anderson update took 68.134 ms, out of which F'*F took 33.310 ms; b-Ax took 220.554 ms, out of which Lap took 197.611 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.506 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711440, int_b + int_rho = 1.819e-14, checking this took 0.123 ms
2-norm of RHS = 577.0430515734263, which took 0.161 ms

iter_count = 246, r_2norm = 5.493e-04, tol*||rhs|| = 5.770e-04

Anderson update took 144.528 ms, out of which F'*F took 69.703 ms; b-Ax took 468.731 ms, out of which Lap took 416.771 ms
Solving Poisson took 1018.421 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.082346 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.092667 
Total time for convolution: 	 convolve: 5.091827 
Total time for convolution: 	 convolve: 5.081422 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.155 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.685 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.296 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.994 ms

This SCF took 27371.946 ms, scf error = 2.940e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.135197, lowerbound = -0.852951, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1384.878 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.224 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.327 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 15.595 ms
rank =  0, finding HY took 22.586 ms
rank =  0, distributing HY into block cyclic form took 14.977 ms
rank =  0, finding Y'*HY took 2.310 ms
Rank 0, Project_Hamiltonian used 56.529 ms
Total time for projection: 56.551 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.850762624712836
    last  calculated eigval = 0.035456494784295
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85076262471284
lambda[   2] =  -0.65495255488296
lambda[   3] =  -0.50925523230070
lambda[   4] =  -0.47749596627245
lambda[   5] =  -0.44452997884685
lambda[   6] =  -0.31684279428284
lambda[   7] =  -0.23964846975807
lambda[   8] =  -0.19695703763944
lambda[   9] =  -0.04064060922351
lambda[  10] =  -0.00196003044380
lambda[  11] =   0.00814332104595
lambda[  12] =   0.01513324132699
lambda[  13] =   0.02045802565524
lambda[  14] =   0.03545649478430
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 3.969 ms
rank =  0, Distributing orbital back into band + domain format took 14.166 ms
rank = 0, Subspace_Rotation used 18.149 ms

Total time for subspace rotation: 18.152 ms
rank = 0, Efermi =  -0.069946737698 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.529 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.762 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1463.259 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.699 ms
rank = 0, D2D took 0.950 ms
rank = 0, Transfering density took 0.959 ms
Etot    =   -24.126320326016
Eband   =    -7.380889318088
E1      =    17.216775312566
E2      =    -6.679785718827
E3      =    -9.328888022615
Exc     =    -8.338808134694
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 3.307e-05, dEband = 7.977e-03
rank = 0, Calculating/Estimating energy took 1.067 ms, Etot = -24.126320326, dEtot = 3.307e-05, dEband = 7.977e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2075426190153, which took 0.053 ms

iter_count = 114, r_2norm = 5.600e-06, tol*||rhs|| = 8.302e-06

Anderson update took 68.584 ms, out of which F'*F took 32.426 ms; b-Ax took 226.290 ms, out of which Lap took 202.905 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 502.707 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711436, int_b + int_rho = -1.637e-14, checking this took 0.108 ms
2-norm of RHS = 577.0129720742954, which took 0.080 ms

iter_count = 210, r_2norm = 5.036e-04, tol*||rhs|| = 5.770e-04

Anderson update took 123.563 ms, out of which F'*F took 59.184 ms; b-Ax took 408.956 ms, out of which Lap took 365.747 ms
Solving Poisson took 879.241 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.185 ms
Total time for convolution: 	 convolve: 5.086295 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.079641 
Total time for convolution: 	 convolve: 5.093158 
Total time for convolution: 	 convolve: 5.095990 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.211 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.692 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.027 ms

This SCF took 27190.855 ms, scf error = 1.597e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.135456, lowerbound = -0.850763, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1347.308 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.700 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.567 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 16.312 ms
rank =  0, finding HY took 21.334 ms
rank =  0, distributing HY into block cyclic form took 14.977 ms
rank =  0, finding Y'*HY took 2.273 ms
Rank 0, Project_Hamiltonian used 54.928 ms
Total time for projection: 54.948 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.850062882804171
    last  calculated eigval = 0.034427425337822
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85006288280417
lambda[   2] =  -0.65364688498752
lambda[   3] =  -0.50845716408158
lambda[   4] =  -0.47689069927206
lambda[   5] =  -0.44345869302179
lambda[   6] =  -0.31598059272930
lambda[   7] =  -0.23853745778793
lambda[   8] =  -0.19603613786329
lambda[   9] =  -0.03994054693652
lambda[  10] =  -0.00136074603385
lambda[  11] =   0.00816631559878
lambda[  12] =   0.01565319902379
lambda[  13] =   0.02052410979040
lambda[  14] =   0.03442742533782
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.995 ms
rank =  0, Distributing orbital back into band + domain format took 13.987 ms
rank = 0, Subspace_Rotation used 17.996 ms

Total time for subspace rotation: 17.999 ms
rank = 0, Efermi =  -0.069246675438 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.582 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.765 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.090 ms
rank = 0, Calculating density took 1423.944 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.680 ms
rank = 0, D2D took 0.912 ms
rank = 0, Transfering density took 0.915 ms
Etot    =   -24.126402267931
Eband   =    -7.366141025779
E1      =    17.208176820698
E2      =    -6.673149957121
E3      =    -9.330930140374
Exc     =    -8.340446233103
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 1.366e-05, dEband = 2.458e-03
rank = 0, Calculating/Estimating energy took 1.126 ms, Etot = -24.126402268, dEtot = 1.366e-05, dEband = 2.458e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1077044839978, which took 0.055 ms

iter_count = 114, r_2norm = 2.801e-06, tol*||rhs|| = 4.308e-06

Anderson update took 68.654 ms, out of which F'*F took 33.464 ms; b-Ax took 221.186 ms, out of which Lap took 197.942 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.819 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711435, int_b + int_rho = -3.456e-14, checking this took 0.145 ms
2-norm of RHS = 576.9827185559860, which took 0.144 ms

iter_count = 222, r_2norm = 5.159e-04, tol*||rhs|| = 5.770e-04

Anderson update took 130.357 ms, out of which F'*F took 63.126 ms; b-Ax took 423.321 ms, out of which Lap took 376.291 ms
Solving Poisson took 920.763 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.088869 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.083193 
Total time for convolution: 	 convolve: 5.097207 
Total time for convolution: 	 convolve: 5.090525 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.685 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.624 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.700 ms

This SCF took 27173.372 ms, scf error = 1.226e-03
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.134427, lowerbound = -0.850063, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1340.146 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.687 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.596 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 16.320 ms
rank =  0, finding HY took 21.281 ms
rank =  0, distributing HY into block cyclic form took 14.969 ms
rank =  0, finding Y'*HY took 2.253 ms
Rank 0, Project_Hamiltonian used 54.851 ms
Total time for projection: 54.871 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.849227872448141
    last  calculated eigval = 0.035839578382487
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84922787244814
lambda[   2] =  -0.65263802192662
lambda[   3] =  -0.50754845183646
lambda[   4] =  -0.47609367002858
lambda[   5] =  -0.44229661576480
lambda[   6] =  -0.31501872918263
lambda[   7] =  -0.23744007011724
lambda[   8] =  -0.19498073287308
lambda[   9] =  -0.03627107439319
lambda[  10] =   0.00113931806835
lambda[  11] =   0.01043902377159
lambda[  12] =   0.01956675916724
lambda[  13] =   0.02251998831357
lambda[  14] =   0.03583957838249
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.972 ms
rank =  0, Distributing orbital back into band + domain format took 14.126 ms
rank = 0, Subspace_Rotation used 18.112 ms

Total time for subspace rotation: 18.121 ms
rank = 0, Efermi =  -0.065577202906 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.537 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.764 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1416.827 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.729 ms
rank = 0, D2D took 0.955 ms
rank = 0, Transfering density took 0.958 ms
Etot    =   -24.126496457025
Eband   =    -7.350488328976
E1      =    17.201050569757
E2      =    -6.664559794956
E3      =    -9.331338216903
Exc     =    -8.340884782423
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 1.570e-05, dEband = 2.609e-03
rank = 0, Calculating/Estimating energy took 1.079 ms, Etot = -24.126496457, dEtot = 1.570e-05, dEband = 2.609e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0685227830284, which took 0.078 ms

iter_count = 114, r_2norm = 2.308e-06, tol*||rhs|| = 2.741e-06

Anderson update took 68.192 ms, out of which F'*F took 32.379 ms; b-Ax took 222.955 ms, out of which Lap took 200.079 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.727 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711438, int_b + int_rho = 3.638e-15, checking this took 0.100 ms
2-norm of RHS = 576.9880188666074, which took 0.068 ms

iter_count = 192, r_2norm = 4.844e-04, tol*||rhs|| = 5.770e-04

Anderson update took 113.155 ms, out of which F'*F took 53.922 ms; b-Ax took 367.340 ms, out of which Lap took 326.411 ms
Solving Poisson took 795.630 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.083676 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.815 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.377 ms
Total time for convolution: 	 convolve: 5.091783 
Total time for convolution: 	 convolve: 5.083018 
Total time for convolution: 	 convolve: 5.087332 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.472 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.690 ms
---Transfer Veff_loc: D2D took 1.144 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.310 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.096 ms

This SCF took 27037.595 ms, scf error = 6.983e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.135840, lowerbound = -0.849228, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1384.974 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.634 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.604 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.272 ms
rank =  0, finding HY took 21.489 ms
rank =  0, distributing HY into block cyclic form took 14.921 ms
rank =  0, finding Y'*HY took 2.324 ms
Rank 0, Project_Hamiltonian used 55.038 ms
Total time for projection: 55.055 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.848585310133213
    last  calculated eigval = 0.036081387597109
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84858531013321
lambda[   2] =  -0.65190334833254
lambda[   3] =  -0.50691062738889
lambda[   4] =  -0.47552148599400
lambda[   5] =  -0.44160893917399
lambda[   6] =  -0.31438037077233
lambda[   7] =  -0.23675702896133
lambda[   8] =  -0.19433061484122
lambda[   9] =  -0.03486123130340
lambda[  10] =   0.00188469361042
lambda[  11] =   0.01010034880413
lambda[  12] =   0.02111976621147
lambda[  13] =   0.02272654607319
lambda[  14] =   0.03608138759711
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.972 ms
rank =  0, Distributing orbital back into band + domain format took 14.061 ms
rank = 0, Subspace_Rotation used 18.046 ms

Total time for subspace rotation: 18.049 ms
rank = 0, Efermi =  -0.064167359769 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.545 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.762 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1461.795 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.703 ms
rank = 0, D2D took 0.922 ms
rank = 0, Transfering density took 0.926 ms
Etot    =   -24.126584905815
Eband   =    -7.339995451792
E1      =    17.195341870354
E2      =    -6.659390329808
E3      =    -9.332752544015
Exc     =    -8.342002270957
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 1.474e-05, dEband = 1.749e-03
rank = 0, Calculating/Estimating energy took 1.093 ms, Etot = -24.126584906, dEtot = 1.474e-05, dEband = 1.749e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0603485495599, which took 0.060 ms

iter_count = 108, r_2norm = 2.253e-06, tol*||rhs|| = 2.414e-06

Anderson update took 64.721 ms, out of which F'*F took 31.373 ms; b-Ax took 208.896 ms, out of which Lap took 187.163 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 464.392 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711431, int_b + int_rho = -6.548e-14, checking this took 0.120 ms
2-norm of RHS = 577.0053593004459, which took 0.122 ms

iter_count = 192, r_2norm = 4.957e-04, tol*||rhs|| = 5.770e-04

Anderson update took 113.165 ms, out of which F'*F took 54.105 ms; b-Ax took 365.223 ms, out of which Lap took 324.241 ms
Solving Poisson took 795.048 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.083622 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.225 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.078541 
Total time for convolution: 	 convolve: 5.082026 
Total time for convolution: 	 convolve: 5.077881 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.321 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.184 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.668 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.980 ms

This SCF took 27031.304 ms, scf error = 4.950e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.136081, lowerbound = -0.848585, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1375.767 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.013 ms
rank =  0, Distribute orbital to block cyclic format took 14.611 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.524 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.066 ms
rank =  0, Distribute data + matrix mult took 16.216 ms
rank =  0, finding HY took 21.234 ms
rank =  0, distributing HY into block cyclic form took 14.901 ms
rank =  0, finding Y'*HY took 2.291 ms
Rank 0, Project_Hamiltonian used 54.681 ms
Total time for projection: 54.705 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.848212901978856
    last  calculated eigval = 0.038116630129701
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84821290197886
lambda[   2] =  -0.65158988411681
lambda[   3] =  -0.50653536306747
lambda[   4] =  -0.47515536235758
lambda[   5] =  -0.44121887395721
lambda[   6] =  -0.31401382316188
lambda[   7] =  -0.23636972997321
lambda[   8] =  -0.19396263533724
lambda[   9] =  -0.03132881168309
lambda[  10] =   0.00339779964132
lambda[  11] =   0.01074416259139
lambda[  12] =   0.02456533880558
lambda[  13] =   0.02631304254231
lambda[  14] =   0.03811663012970
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 3.962 ms
rank =  0, Distributing orbital back into band + domain format took 14.085 ms
rank = 0, Subspace_Rotation used 18.060 ms

Total time for subspace rotation: 18.064 ms
rank = 0, Efermi =  -0.060634940211 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.544 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.768 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1452.187 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.663 ms
rank = 0, D2D took 1.018 ms
rank = 0, Transfering density took 1.021 ms
Etot    =   -24.126652586920
Eband   =    -7.334117148437
E1      =    17.193080985023
E2      =    -6.655740016645
E3      =    -9.332811821542
Exc     =    -8.342096334450
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 1.128e-05, dEband = 9.797e-04
rank = 0, Calculating/Estimating energy took 1.921 ms, Etot = -24.126652587, dEtot = 1.128e-05, dEband = 9.797e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0568143021380, which took 0.085 ms

iter_count = 108, r_2norm = 2.235e-06, tol*||rhs|| = 2.273e-06

Anderson update took 64.631 ms, out of which F'*F took 30.880 ms; b-Ax took 209.374 ms, out of which Lap took 187.481 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.725 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711434, int_b + int_rho = -4.366e-14, checking this took 0.116 ms
2-norm of RHS = 577.0044789269341, which took 0.116 ms

iter_count = 144, r_2norm = 5.475e-04, tol*||rhs|| = 5.770e-04

Anderson update took 84.607 ms, out of which F'*F took 40.682 ms; b-Ax took 275.630 ms, out of which Lap took 245.070 ms
Solving Poisson took 597.849 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.096809 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.079907 
Total time for convolution: 	 convolve: 5.090727 
Total time for convolution: 	 convolve: 5.076509 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.688 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.693 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.014 ms

This SCF took 26820.628 ms, scf error = 3.849e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.138117, lowerbound = -0.848213, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1342.033 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.611 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.584 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 16.231 ms
rank =  0, finding HY took 21.306 ms
rank =  0, distributing HY into block cyclic form took 14.776 ms
rank =  0, finding Y'*HY took 2.332 ms
Rank 0, Project_Hamiltonian used 54.675 ms
Total time for projection: 54.693 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.848007256053275
    last  calculated eigval = 0.038178472716997
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84800725605328
lambda[   2] =  -0.65137619801866
lambda[   3] =  -0.50634415295561
lambda[   4] =  -0.47497135954453
lambda[   5] =  -0.44103748811731
lambda[   6] =  -0.31381610761486
lambda[   7] =  -0.23618180480176
lambda[   8] =  -0.19377399357606
lambda[   9] =  -0.03064600603834
lambda[  10] =   0.00371184437927
lambda[  11] =   0.01055738556551
lambda[  12] =   0.02476319370867
lambda[  13] =   0.02690659423274
lambda[  14] =   0.03817847271700
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 3.951 ms
rank =  0, Distributing orbital back into band + domain format took 14.148 ms
rank = 0, Subspace_Rotation used 18.111 ms

Total time for subspace rotation: 18.115 ms
rank = 0, Efermi =  -0.059952134511 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.447 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.882 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1418.506 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.678 ms
rank = 0, D2D took 1.312 ms
rank = 0, Transfering density took 1.315 ms
Etot    =   -24.126676194136
Eband   =    -7.331016721889
E1      =    17.191290298264
E2      =    -6.654318337541
E3      =    -9.333234205102
Exc     =    -8.342430385911
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 3.935e-06, dEband = 5.167e-04
rank = 0, Calculating/Estimating energy took 1.509 ms, Etot = -24.126676194, dEtot = 3.935e-06, dEband = 5.167e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0439832431689, which took 0.052 ms

iter_count = 114, r_2norm = 1.082e-06, tol*||rhs|| = 1.759e-06

Anderson update took 68.076 ms, out of which F'*F took 33.322 ms; b-Ax took 221.024 ms, out of which Lap took 197.722 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.063 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711436, int_b + int_rho = -2.183e-14, checking this took 0.103 ms
2-norm of RHS = 577.0068801100157, which took 0.122 ms

iter_count = 162, r_2norm = 5.385e-04, tol*||rhs|| = 5.770e-04

Anderson update took 95.117 ms, out of which F'*F took 45.435 ms; b-Ax took 309.000 ms, out of which Lap took 274.316 ms
Solving Poisson took 670.994 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.094956 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.081500 
Total time for convolution: 	 convolve: 5.081315 
Total time for convolution: 	 convolve: 5.079179 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.396 ms
---Transfer Veff_loc: D2D took 0.670 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.984 ms

This SCF took 26889.761 ms, scf error = 3.077e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.138178, lowerbound = -0.848007, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1376.613 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.624 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.574 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 16.240 ms
rank =  0, finding HY took 21.198 ms
rank =  0, distributing HY into block cyclic form took 14.946 ms
rank =  0, finding Y'*HY took 2.319 ms
Rank 0, Project_Hamiltonian used 54.737 ms
Total time for projection: 54.755 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.847810229995999
    last  calculated eigval = 0.037986696277369
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84781022999600
lambda[   2] =  -0.65121156705885
lambda[   3] =  -0.50616318570042
lambda[   4] =  -0.47477574425085
lambda[   5] =  -0.44088072642869
lambda[   6] =  -0.31363141366567
lambda[   7] =  -0.23602203368532
lambda[   8] =  -0.19360701564112
lambda[   9] =  -0.03053559266888
lambda[  10] =   0.00363437919509
lambda[  11] =   0.00988592839130
lambda[  12] =   0.02463313125648
lambda[  13] =   0.02623928926469
lambda[  14] =   0.03798669627737
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 3.959 ms
rank =  0, Distributing orbital back into band + domain format took 14.075 ms
rank = 0, Subspace_Rotation used 18.050 ms

Total time for subspace rotation: 18.054 ms
rank = 0, Efermi =  -0.059841721215 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.547 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.756 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1453.113 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.033 ms
rank = 0, D2D took 1.147 ms
rank = 0, Transfering density took 1.154 ms
Etot    =   -24.126732651609
Eband   =    -7.328203833376
E1      =    17.189972272446
E2      =    -6.652748429319
E3      =    -9.333329243789
Exc     =    -8.342506836544
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 9.410e-06, dEband = 4.688e-04
rank = 0, Calculating/Estimating energy took 1.125 ms, Etot = -24.126732652, dEtot = 9.410e-06, dEband = 4.688e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0333504810981, which took 0.053 ms

iter_count = 108, r_2norm = 1.325e-06, tol*||rhs|| = 1.334e-06

Anderson update took 64.501 ms, out of which F'*F took 31.286 ms; b-Ax took 209.867 ms, out of which Lap took 188.077 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 464.791 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711437, int_b + int_rho = -7.276e-15, checking this took 0.119 ms
2-norm of RHS = 577.0124095229590, which took 0.171 ms

iter_count = 156, r_2norm = 4.978e-04, tol*||rhs|| = 5.770e-04

Anderson update took 91.856 ms, out of which F'*F took 43.519 ms; b-Ax took 297.665 ms, out of which Lap took 264.509 ms
Solving Poisson took 646.854 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.112223 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 6.670155 
Total time for convolution: 	 convolve: 5.088347 
Total time for convolution: 	 convolve: 5.077327 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.781 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.116 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.685 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.290 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.988 ms

This SCF took 28492.393 ms, scf error = 2.399e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.137987, lowerbound = -0.847810, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1374.774 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.630 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.596 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 16.265 ms
rank =  0, finding HY took 21.338 ms
rank =  0, distributing HY into block cyclic form took 14.806 ms
rank =  0, finding Y'*HY took 2.342 ms
Rank 0, Project_Hamiltonian used 54.782 ms
Total time for projection: 54.802 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.847656292835261
    last  calculated eigval = 0.038216040076365
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84765629283526
lambda[   2] =  -0.65106509203053
lambda[   3] =  -0.50600835325918
lambda[   4] =  -0.47461241631978
lambda[   5] =  -0.44071895646782
lambda[   6] =  -0.31348683137130
lambda[   7] =  -0.23587867097232
lambda[   8] =  -0.19345881121627
lambda[   9] =  -0.03019820227075
lambda[  10] =   0.00357311523348
lambda[  11] =   0.00996749068007
lambda[  12] =   0.02532985794355
lambda[  13] =   0.02688042255908
lambda[  14] =   0.03821604007637
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.950 ms
rank =  0, Distributing orbital back into band + domain format took 14.187 ms
rank = 0, Subspace_Rotation used 18.152 ms

Total time for subspace rotation: 18.898 ms
rank = 0, Efermi =  -0.059504330806 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.257 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.278 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.145 ms
rank = 0, Calculating density took 1452.415 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.754 ms
rank = 0, D2D took 0.884 ms
rank = 0, Transfering density took 0.890 ms
Etot    =   -24.126756065462
Eband   =    -7.325770849462
E1      =    17.188942818183
E2      =    -6.651272960673
E3      =    -9.333483951915
Exc     =    -8.342613019530
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 3.902e-06, dEband = 4.055e-04
rank = 0, Calculating/Estimating energy took 0.978 ms, Etot = -24.126756065, dEtot = 3.902e-06, dEband = 4.055e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0301009260669, which took 0.097 ms

iter_count = 108, r_2norm = 1.187e-06, tol*||rhs|| = 1.204e-06

Anderson update took 64.701 ms, out of which F'*F took 31.520 ms; b-Ax took 209.157 ms, out of which Lap took 187.391 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 464.381 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711435, int_b + int_rho = -3.638e-14, checking this took 0.109 ms
2-norm of RHS = 577.0127570019773, which took 0.104 ms

iter_count = 120, r_2norm = 5.330e-04, tol*||rhs|| = 5.770e-04

Anderson update took 70.528 ms, out of which F'*F took 33.742 ms; b-Ax took 228.298 ms, out of which Lap took 202.546 ms
Solving Poisson took 498.019 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.089419 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.091606 
Total time for convolution: 	 convolve: 5.090109 
Total time for convolution: 	 convolve: 5.076935 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.675 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.286 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.975 ms

This SCF took 26733.314 ms, scf error = 2.099e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.138216, lowerbound = -0.847656, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1378.349 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.655 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.559 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.247 ms
rank =  0, finding HY took 21.278 ms
rank =  0, distributing HY into block cyclic form took 14.947 ms
rank =  0, finding Y'*HY took 2.290 ms
Rank 0, Project_Hamiltonian used 54.790 ms
Total time for projection: 54.813 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.847591492763662
    last  calculated eigval = 0.038344282570016
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84759149276366
lambda[   2] =  -0.65098922849288
lambda[   3] =  -0.50594191445870
lambda[   4] =  -0.47454610459699
lambda[   5] =  -0.44064816419880
lambda[   6] =  -0.31341926666063
lambda[   7] =  -0.23580795247796
lambda[   8] =  -0.19339255853464
lambda[   9] =  -0.02984247370513
lambda[  10] =   0.00369172917926
lambda[  11] =   0.01025770925894
lambda[  12] =   0.02569696293130
lambda[  13] =   0.02702970632631
lambda[  14] =   0.03834428257002
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 4.465 ms
rank =  0, Distributing orbital back into band + domain format took 12.653 ms
rank = 0, Subspace_Rotation used 17.136 ms

Total time for subspace rotation: 17.147 ms
rank = 0, Efermi =  -0.059148602208 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.444 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.928 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.091 ms
rank = 0, Calculating density took 1455.311 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.738 ms
rank = 0, D2D took 0.965 ms
rank = 0, Transfering density took 0.973 ms
Etot    =   -24.126762344712
Eband   =    -7.324673364879
E1      =    17.188433931468
E2      =    -6.650662418723
E3      =    -9.333550739389
Exc     =    -8.342664142170
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 1.047e-06, dEband = 1.829e-04
rank = 0, Calculating/Estimating energy took 1.007 ms, Etot = -24.126762345, dEtot = 1.047e-06, dEband = 1.829e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0289702284826, which took 0.046 ms

iter_count = 114, r_2norm = 7.201e-07, tol*||rhs|| = 1.159e-06

Anderson update took 76.072 ms, out of which F'*F took 32.202 ms; b-Ax took 219.686 ms, out of which Lap took 196.960 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 495.067 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711440, int_b + int_rho = 1.455e-14, checking this took 0.127 ms
2-norm of RHS = 577.0116897748252, which took 0.116 ms

iter_count = 96, r_2norm = 5.098e-04, tol*||rhs|| = 5.770e-04

Anderson update took 56.850 ms, out of which F'*F took 26.807 ms; b-Ax took 182.927 ms, out of which Lap took 162.432 ms
Solving Poisson took 399.800 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.081717 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.659 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.093761 
Total time for convolution: 	 convolve: 5.091293 
Total time for convolution: 	 convolve: 5.088575 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.247 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.695 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.288 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.996 ms

This SCF took 28187.211 ms, scf error = 2.030e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.138344, lowerbound = -0.847591, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1334.931 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.633 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.594 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 16.271 ms
rank =  0, finding HY took 21.182 ms
rank =  0, distributing HY into block cyclic form took 15.000 ms
rank =  0, finding Y'*HY took 2.264 ms
Rank 0, Project_Hamiltonian used 54.784 ms
Total time for projection: 54.801 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.847523094335932
    last  calculated eigval = 0.038437174654274
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84752309433593
lambda[   2] =  -0.65092089094937
lambda[   3] =  -0.50587737391917
lambda[   4] =  -0.47448315047755
lambda[   5] =  -0.44058688442230
lambda[   6] =  -0.31335428657919
lambda[   7] =  -0.23574519264546
lambda[   8] =  -0.19333167595540
lambda[   9] =  -0.02943502506162
lambda[  10] =   0.00387674615981
lambda[  11] =   0.01047528212570
lambda[  12] =   0.02589331664964
lambda[  13] =   0.02735587934965
lambda[  14] =   0.03843717465427
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 4.648 ms
rank =  0, Distributing orbital back into band + domain format took 13.065 ms
rank = 0, Subspace_Rotation used 17.733 ms

Total time for subspace rotation: 17.742 ms
rank = 0, Efermi =  -0.058741153560 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.509 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.808 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1411.764 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.725 ms
rank = 0, D2D took 0.972 ms
rank = 0, Transfering density took 0.974 ms
Etot    =   -24.126764543510
Eband   =    -7.323645099073
E1      =    17.187850368836
E2      =    -6.650190280825
E3      =    -9.333674009782
Exc     =    -8.342762176639
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 3.665e-07, dEband = 1.714e-04
rank = 0, Calculating/Estimating energy took 1.087 ms, Etot = -24.126764544, dEtot = 3.665e-07, dEband = 1.714e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0388227532792, which took 0.054 ms

iter_count = 102, r_2norm = 1.528e-06, tol*||rhs|| = 1.553e-06

Anderson update took 60.843 ms, out of which F'*F took 29.756 ms; b-Ax took 198.035 ms, out of which Lap took 176.908 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.939 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711433, int_b + int_rho = -4.547e-14, checking this took 0.108 ms
2-norm of RHS = 577.0138465524986, which took 0.117 ms

iter_count = 156, r_2norm = 5.143e-04, tol*||rhs|| = 5.770e-04

Anderson update took 91.557 ms, out of which F'*F took 44.330 ms; b-Ax took 297.020 ms, out of which Lap took 263.292 ms
Solving Poisson took 646.739 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.087341 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.089808 
Total time for convolution: 	 convolve: 5.094461 
Total time for convolution: 	 convolve: 5.084996 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.410 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.675 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.288 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.977 ms

This SCF took 26836.159 ms, scf error = 1.828e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.138437, lowerbound = -0.847523, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1388.042 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.651 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.573 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.257 ms
rank =  0, finding HY took 21.397 ms
rank =  0, distributing HY into block cyclic form took 14.957 ms
rank =  0, finding Y'*HY took 2.317 ms
Rank 0, Project_Hamiltonian used 54.964 ms
Total time for projection: 54.981 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.826 ms
    first calculated eigval = -0.847486732773667
    last  calculated eigval = 0.037797990132358
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84748673277367
lambda[   2] =  -0.65091699741473
lambda[   3] =  -0.50583509047993
lambda[   4] =  -0.47442736339179
lambda[   5] =  -0.44054670997564
lambda[   6] =  -0.31333116390597
lambda[   7] =  -0.23571877058479
lambda[   8] =  -0.19330879651558
lambda[   9] =  -0.03002324341567
lambda[  10] =   0.00353747355860
lambda[  11] =   0.01141871682096
lambda[  12] =   0.02581089601299
lambda[  13] =   0.02720598510602
lambda[  14] =   0.03779799013236
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.853 ms
rank =  0, subspace rotation using ScaLAPACK took 4.481 ms
rank =  0, Distributing orbital back into band + domain format took 13.753 ms
rank = 0, Subspace_Rotation used 18.254 ms

Total time for subspace rotation: 18.259 ms
rank = 0, Efermi =  -0.059329371938 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.554 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.762 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1465.709 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.717 ms
rank = 0, D2D took 0.958 ms
rank = 0, Transfering density took 0.966 ms
Etot    =   -24.126774979720
Eband   =    -7.323143250598
E1      =    17.187827452063
E2      =    -6.649742253088
E3      =    -9.333492642508
Exc     =    -8.342622149539
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 1.739e-06, dEband = 8.364e-05
rank = 0, Calculating/Estimating energy took 1.075 ms, Etot = -24.126774980, dEtot = 1.739e-06, dEband = 8.364e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0451750406066, which took 0.052 ms

iter_count = 102, r_2norm = 1.404e-06, tol*||rhs|| = 1.807e-06

Anderson update took 61.693 ms, out of which F'*F took 29.087 ms; b-Ax took 197.184 ms, out of which Lap took 176.786 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 439.038 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711435, int_b + int_rho = -2.728e-14, checking this took 0.109 ms
2-norm of RHS = 577.0145097741815, which took 0.110 ms

iter_count = 120, r_2norm = 5.657e-04, tol*||rhs|| = 5.770e-04

Anderson update took 79.289 ms, out of which F'*F took 33.302 ms; b-Ax took 227.972 ms, out of which Lap took 202.864 ms
Solving Poisson took 505.892 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.083034 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.091865 
Total time for convolution: 	 convolve: 5.085220 
Total time for convolution: 	 convolve: 5.092976 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.815 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.189 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.697 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.024 ms

This SCF took 26740.851 ms, scf error = 2.230e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.137798, lowerbound = -0.847487, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1353.638 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.714 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.548 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 16.301 ms
rank =  0, finding HY took 21.287 ms
rank =  0, distributing HY into block cyclic form took 14.963 ms
rank =  0, finding Y'*HY took 2.383 ms
Rank 0, Project_Hamiltonian used 55.808 ms
Total time for projection: 55.829 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.847531362085281
    last  calculated eigval = 0.037314215090177
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84753136208528
lambda[   2] =  -0.65097308838899
lambda[   3] =  -0.50587698852618
lambda[   4] =  -0.47445923069636
lambda[   5] =  -0.44059254700171
lambda[   6] =  -0.31337577646703
lambda[   7] =  -0.23576676031379
lambda[   8] =  -0.19335457450973
lambda[   9] =  -0.03042722144875
lambda[  10] =   0.00332526764063
lambda[  11] =   0.01199516807259
lambda[  12] =   0.02572148767778
lambda[  13] =   0.02652294018634
lambda[  14] =   0.03731421509018
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.163 ms
rank =  0, subspace rotation using ScaLAPACK took 3.937 ms
rank =  0, Distributing orbital back into band + domain format took 14.169 ms
rank = 0, Subspace_Rotation used 18.118 ms

Total time for subspace rotation: 18.122 ms
rank = 0, Efermi =  -0.059733349994 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.548 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.763 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1431.312 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.685 ms
rank = 0, D2D took 0.959 ms
rank = 0, Transfering density took 0.970 ms
Etot    =   -24.126778506837
Eband   =    -7.323860656499
E1      =    17.188288623346
E2      =    -6.650043732378
E3      =    -9.333295849161
Exc     =    -8.342474127981
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 5.879e-07, dEband = 1.196e-04
rank = 0, Calculating/Estimating energy took 1.079 ms, Etot = -24.126778507, dEtot = 5.879e-07, dEband = 1.196e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0384255180091, which took 0.071 ms

iter_count = 102, r_2norm = 1.394e-06, tol*||rhs|| = 1.537e-06

Anderson update took 61.245 ms, out of which F'*F took 29.822 ms; b-Ax took 197.102 ms, out of which Lap took 176.540 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.755 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711432, int_b + int_rho = -5.821e-14, checking this took 0.105 ms
2-norm of RHS = 577.0176281519783, which took 0.124 ms

iter_count = 126, r_2norm = 5.678e-04, tol*||rhs|| = 5.770e-04

Anderson update took 74.103 ms, out of which F'*F took 35.253 ms; b-Ax took 240.068 ms, out of which Lap took 213.216 ms
Solving Poisson took 523.031 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.096063 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.919 ms
Total time for convolution: 	 convolve: 5.080869 
Total time for convolution: 	 convolve: 5.089215 
Total time for convolution: 	 convolve: 5.090290 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.671 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.291 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.976 ms

This SCF took 26718.395 ms, scf error = 2.484e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.137314, lowerbound = -0.847531, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1335.387 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.637 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.878 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 17.398 ms
rank =  0, finding HY took 21.883 ms
rank =  0, distributing HY into block cyclic form took 14.956 ms
rank =  0, finding Y'*HY took 2.273 ms
Rank 0, Project_Hamiltonian used 56.544 ms
Total time for projection: 56.569 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.847598329275985
    last  calculated eigval = 0.038023295121024
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84759832927598
lambda[   2] =  -0.65102369437111
lambda[   3] =  -0.50592880829932
lambda[   4] =  -0.47451548298716
lambda[   5] =  -0.44062109546263
lambda[   6] =  -0.31342601194958
lambda[   7] =  -0.23579897131466
lambda[   8] =  -0.19339275085175
lambda[   9] =  -0.02931353310301
lambda[  10] =   0.00376941774888
lambda[  11] =   0.01186358044284
lambda[  12] =   0.02604187548300
lambda[  13] =   0.02812164758966
lambda[  14] =   0.03802329512102
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.955 ms
rank =  0, Distributing orbital back into band + domain format took 14.087 ms
rank = 0, Subspace_Rotation used 18.054 ms

Total time for subspace rotation: 18.058 ms
rank = 0, Efermi =  -0.058619661593 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.568 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.766 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1413.730 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.739 ms
rank = 0, D2D took 0.973 ms
rank = 0, Transfering density took 0.984 ms
Etot    =   -24.126777523428
Eband   =    -7.324610289526
E1      =    17.188920637925
E2      =    -6.650212683972
E3      =    -9.333081651168
Exc     =    -8.342310279725
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 1.639e-07, dEband = 1.249e-04
rank = 0, Calculating/Estimating energy took 1.101 ms, Etot = -24.126777523, dEtot = 1.639e-07, dEband = 1.249e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0412478155602, which took 0.087 ms

iter_count = 102, r_2norm = 1.199e-06, tol*||rhs|| = 1.650e-06

Anderson update took 61.072 ms, out of which F'*F took 29.136 ms; b-Ax took 198.341 ms, out of which Lap took 176.393 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.909 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711432, int_b + int_rho = -5.457e-14, checking this took 0.110 ms
2-norm of RHS = 577.0118258432608, which took 0.129 ms

iter_count = 144, r_2norm = 5.766e-04, tol*||rhs|| = 5.770e-04

Anderson update took 84.896 ms, out of which F'*F took 40.386 ms; b-Ax took 274.751 ms, out of which Lap took 243.859 ms
Solving Poisson took 598.485 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.140 ms
Total time for convolution: 	 convolve: 5.088706 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.095004 
Total time for convolution: 	 convolve: 5.085583 
Total time for convolution: 	 convolve: 5.087949 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.591 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.684 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.288 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.985 ms

This SCF took 26801.215 ms, scf error = 3.401e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.138023, lowerbound = -0.847598, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1321.937 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.584 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.542 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 16.166 ms
rank =  0, finding HY took 21.486 ms
rank =  0, distributing HY into block cyclic form took 14.875 ms
rank =  0, finding Y'*HY took 2.305 ms
Rank 0, Project_Hamiltonian used 54.874 ms
Total time for projection: 54.892 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -0.847392630347402
    last  calculated eigval = 0.036399278389040
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84739263034740
lambda[   2] =  -0.65084955140046
lambda[   3] =  -0.50575693699980
lambda[   4] =  -0.47434240762928
lambda[   5] =  -0.44049671934404
lambda[   6] =  -0.31325753867573
lambda[   7] =  -0.23566167447248
lambda[   8] =  -0.19324892443604
lambda[   9] =  -0.03079982758445
lambda[  10] =   0.00325007830408
lambda[  11] =   0.01128085105117
lambda[  12] =   0.02502747448971
lambda[  13] =   0.02601391882473
lambda[  14] =   0.03639927838904
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 3.962 ms
rank =  0, Distributing orbital back into band + domain format took 14.101 ms
rank = 0, Subspace_Rotation used 18.078 ms

Total time for subspace rotation: 18.081 ms
rank = 0, Efermi =  -0.060105956052 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.628 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.699 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.089 ms
rank = 0, Calculating density took 1398.996 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.724 ms
rank = 0, D2D took 0.968 ms
rank = 0, Transfering density took 0.972 ms
Etot    =   -24.126779645548
Eband   =    -7.322012767138
E1      =    17.187070226213
E2      =    -6.649312880903
E3      =    -9.333693395006
Exc     =    -8.342771453290
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 3.537e-07, dEband = 4.329e-04
rank = 0, Calculating/Estimating energy took 1.083 ms, Etot = -24.126779646, dEtot = 3.537e-07, dEband = 4.329e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0357117724140, which took 0.050 ms

iter_count = 102, r_2norm = 9.922e-07, tol*||rhs|| = 1.428e-06

Anderson update took 60.960 ms, out of which F'*F took 29.656 ms; b-Ax took 198.428 ms, out of which Lap took 177.538 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 439.454 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711438, int_b + int_rho = -3.638e-15, checking this took 0.112 ms
2-norm of RHS = 577.0128325572114, which took 0.130 ms

iter_count = 90, r_2norm = 5.270e-04, tol*||rhs|| = 5.770e-04

Anderson update took 52.769 ms, out of which F'*F took 25.313 ms; b-Ax took 170.933 ms, out of which Lap took 151.347 ms
Solving Poisson took 374.912 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.086886 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.127100 
Total time for convolution: 	 convolve: 5.090481 
Total time for convolution: 	 convolve: 5.087530 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.516 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.497 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.550 ms

This SCF took 26576.975 ms, scf error = 1.581e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.136399, lowerbound = -0.847393, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1332.374 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.725 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.610 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 16.386 ms
rank =  0, finding HY took 21.059 ms
rank =  0, distributing HY into block cyclic form took 14.910 ms
rank =  0, finding Y'*HY took 2.289 ms
Rank 0, Project_Hamiltonian used 54.674 ms
Total time for projection: 54.698 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.063 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.118 ms
    first calculated eigval = -0.847349384667785
    last  calculated eigval = 0.036569795489129
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84734938466779
lambda[   2] =  -0.65081851803475
lambda[   3] =  -0.50571797478917
lambda[   4] =  -0.47429890268518
lambda[   5] =  -0.44046839358720
lambda[   6] =  -0.31322051901952
lambda[   7] =  -0.23562873962571
lambda[   8] =  -0.19321726892683
lambda[   9] =  -0.03044540766646
lambda[  10] =   0.00340888852615
lambda[  11] =   0.01143802088555
lambda[  12] =   0.02529151095146
lambda[  13] =   0.02651779401741
lambda[  14] =   0.03656979548913
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 3.969 ms
rank =  0, Distributing orbital back into band + domain format took 14.114 ms
rank = 0, Subspace_Rotation used 18.097 ms

Total time for subspace rotation: 18.100 ms
rank = 0, Efermi =  -0.059751536170 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.553 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.746 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1408.800 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.644 ms
rank = 0, D2D took 1.015 ms
rank = 0, Transfering density took 1.019 ms
Etot    =   -24.126779797431
Eband   =    -7.321439403193
E1      =    17.186795573817
E2      =    -6.648996795063
E3      =    -9.333764638215
Exc     =    -8.342825474091
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 2.531e-08, dEband = 9.556e-05
rank = 0, Calculating/Estimating energy took 1.101 ms, Etot = -24.126779797, dEtot = 2.531e-08, dEband = 9.556e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0258691452034, which took 0.050 ms

iter_count = 102, r_2norm = 7.394e-07, tol*||rhs|| = 1.035e-06

Anderson update took 60.939 ms, out of which F'*F took 28.625 ms; b-Ax took 196.434 ms, out of which Lap took 175.456 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.964 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711435, int_b + int_rho = -2.910e-14, checking this took 0.109 ms
2-norm of RHS = 577.0115498376258, which took 0.069 ms

iter_count = 138, r_2norm = 5.659e-04, tol*||rhs|| = 5.770e-04

Anderson update took 80.812 ms, out of which F'*F took 38.466 ms; b-Ax took 262.377 ms, out of which Lap took 233.123 ms
Solving Poisson took 584.406 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.089710 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.389 ms
Total time for convolution: 	 convolve: 5.082242 
Total time for convolution: 	 convolve: 5.088435 
Total time for convolution: 	 convolve: 5.082394 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.205 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.583 ms
---Transfer Veff_loc: D2D took 1.464 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.789 ms

This SCF took 26755.907 ms, scf error = 1.551e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.136570, lowerbound = -0.847349, upperbound = 267.574638

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1349.456 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.700 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.580 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 16.318 ms
rank =  0, finding HY took 21.279 ms
rank =  0, distributing HY into block cyclic form took 15.016 ms
rank =  0, finding Y'*HY took 2.224 ms
Rank 0, Project_Hamiltonian used 54.871 ms
Total time for projection: 54.891 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.847117246737201
    last  calculated eigval = 0.035666039671393
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84711724673720
lambda[   2] =  -0.65060869773602
lambda[   3] =  -0.50551068212412
lambda[   4] =  -0.47408784291248
lambda[   5] =  -0.44029735002080
lambda[   6] =  -0.31301915772395
lambda[   7] =  -0.23544520725109
lambda[   8] =  -0.19303215960376
lambda[   9] =  -0.03129085745235
lambda[  10] =   0.00318437345686
lambda[  11] =   0.01130425609026
lambda[  12] =   0.02447909797985
lambda[  13] =   0.02573989794307
lambda[  14] =   0.03566603967139
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.985 ms
rank =  0, Distributing orbital back into band + domain format took 14.114 ms
rank = 0, Subspace_Rotation used 18.113 ms

Total time for subspace rotation: 18.116 ms
rank = 0, Efermi =  -0.060596985954 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.565 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.730 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.074 ms
rank = 0, Calculating density took 1426.137 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.692 ms
rank = 0, D2D took 0.969 ms
rank = 0, Transfering density took 0.973 ms
Etot    =   -24.126782955792
Eband   =    -7.318236688754
E1      =    17.184830628200
E2      =    -6.647620361157
E3      =    -9.334343248461
Exc     =    -8.343268577614
Esc     =   -41.632071926726
Entropy =    -0.000000000516
dE = 5.264e-07, dEband = 5.338e-04
rank = 0, Calculating/Estimating energy took 1.110 ms, Etot = -24.126782956, dEtot = 5.264e-07, dEband = 5.338e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0227740083388, which took 0.092 ms

iter_count = 96, r_2norm = 7.434e-07, tol*||rhs|| = 9.110e-07

Anderson update took 56.908 ms, out of which F'*F took 27.344 ms; b-Ax took 185.542 ms, out of which Lap took 165.309 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 412.296 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001711438, int_rho =  16.00000001711434, int_b + int_rho = -4.366e-14, checking this took 0.111 ms
2-norm of RHS = 577.0131807064963, which took 0.146 ms

iter_count = 114, r_2norm = 5.367e-04, tol*||rhs|| = 5.770e-04

Anderson update took 67.417 ms, out of which F'*F took 31.893 ms; b-Ax took 216.642 ms, out of which Lap took 191.979 ms
Solving Poisson took 473.328 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.098143 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.084715 
Total time for convolution: 	 convolve: 5.089559 
Total time for convolution: 	 convolve: 5.108619 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.855 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.703 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.308 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.028 ms

This SCF took 26703.201 ms, scf error = 4.863e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -0.84711724673720, occ[   1] =   2.00000000000000
lambda[   2] =  -0.65060869773602, occ[   2] =   2.00000000000000
lambda[   3] =  -0.50551068212412, occ[   3] =   2.00000000000000
lambda[   4] =  -0.47408784291248, occ[   4] =   2.00000000000000
lambda[   5] =  -0.44029735002080, occ[   5] =   2.00000000000000
lambda[   6] =  -0.31301915772395, occ[   6] =   2.00000000000000
lambda[   7] =  -0.23544520725109, occ[   7] =   2.00000000000000
lambda[   8] =  -0.19303215960376, occ[   8] =   2.00000000000000
lambda[   9] =  -0.03129085745235, occ[   9] =   0.00000001711434
lambda[  10] =   0.00318437345686, occ[  10] =   0.00000000000000
lambda[  11] =   0.01130425609026, occ[  11] =   0.00000000000000
lambda[  12] =   0.02447909797985, occ[  12] =   0.00000000000000
lambda[  13] =   0.02573989794307, occ[  13] =   0.00000000000000
lambda[  14] =   0.03566603967139, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.455 ms, time for Allreduce/Reduce: 7.255 ms 
Time for calculating local force components: 16.932 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00167695580001  -0.05471169162528   0.00000000485149
  0.02457159491082   0.02781290726780  -0.05413900373078
  0.02457161416587   0.02781287699067   0.05413895105271
 -0.00721019167305  -0.04044261615057  -0.00000094231952
  0.02782040418870  -0.17745146478737   0.00000000378975
 -0.57326703230680   0.25475015021023   0.00000171177272
force_loc = 
 -0.00180229557853   0.05746488640540   0.00000008504088
 -0.02482041876563  -0.03120215881431   0.05833848397610
 -0.02482052745408  -0.03120230446337  -0.05833870564442
  0.00701600277063   0.04954395421816   0.00000142445560
 -0.02445884979056   0.15221000088943  -0.00000008104417
  0.55687878509738  -0.23371834118549  -0.00000104275642
Time for calculating nonlocal force components: 30.039 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00057333424863  -0.01049732942131   0.00000009388815
[0m[32m -0.00132943652883   0.01752991364231   0.00000000304742
[0m[32m  0.01455518098459  -0.00794654086271  -0.00000006854603
[0mTime for calculating XC forces components: 20.216 ms
 Cartesian force = 
 -0.00011785979004   0.00276115439452  -0.00000006307988
 -0.00024134386633  -0.00338129193212   0.00419932727307
 -0.00024143329974  -0.00338146785830  -0.00419990756395
  0.00038662533469  -0.00138803173931   0.00000042305198
  0.00203959785778  -0.00770359064122  -0.00000022717924
 -0.00182558623636   0.01309322777643   0.00000044749802
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.402 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Time for printing density: 386.328 ms
The program took 658.290 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:31:36
Job ID:        2266727
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:14:48,vmem=8480K,walltime=00:11:14,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-25-1
---------------------------------------
