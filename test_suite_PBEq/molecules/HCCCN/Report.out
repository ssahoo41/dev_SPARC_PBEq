---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:59
Job ID:    2266551
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:06
Job ID:    2266551
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.066 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 17.621 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 12.165 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 67.477 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.946 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.121 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	    5.469501	
   10.000000	   10.000000	   12.337236	
   10.000000	   10.000000	    9.753347	
   10.000000	   10.000000	    7.478589	
   10.000000	   10.000000	   14.530499	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.187 ms
Set up communicators.

--set up spincomm took 2.292 ms

--set up kptcomm took 0.342 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.011 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.011 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.075 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.084 ms

Calculate_SplineDerivRadFun took 0.210 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.793 ms.
time spent on vectorized spline interp: 3.347 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.534 ms.
time spent on vectorized spline interp: 1.711 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.511 ms.
time spent on vectorized spline interp: 1.823 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.522 ms.

Calculating rb for all atom types took 16.251 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.009 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000051737, sum_int_rho = 17.8792743566665
PosCharge = 18.000000005174, NegCharge = -17.879274356666, scal_fac = 1.006752267799
After scaling, int_rho = 18.0000000051736, PosCharge + NegCharge - NetCharge = 1.030e-13
--Calculate Vref took 0.412 ms
--Calculate rho_guess took 2.492 ms

 integral of b = -18.0000000051737,
 int{b} + Nelectron + NetCharge = -5.174e-09,
 Esc = -49.0731211149325,
 MPI_Reduce took 2.951 ms

Calculating b & b_ref took 12.015 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.022 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.093 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.010 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.099 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.007 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.008 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.002 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.012 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 28.449 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517367, int_b + int_rho = -1.004e-12, checking this took 0.088 ms
2-norm of RHS = 537.1289263439385, which took 0.082 ms

iter_count = 426, r_2norm = 4.583e-04, tol*||rhs|| = 5.371e-04

Anderson update took 237.942 ms, out of which F'*F took 106.597 ms; b-Ax took 724.715 ms, out of which Lap took 649.338 ms
Solving Poisson took 1543.708 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.894 ms
Total time for convolution: 	 convolve: 5.171828 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.823 ms
Total time for convolution: 	 convolve: 5.244274 
Total time for convolution: 	 convolve: 5.241425 
Total time for convolution: 	 convolve: 5.192331 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 1.786 ms
======D2D: initiated sending and receiving took 2.837 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.176 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.396 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
rank = 0, XC calculation took 24711.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.563 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.223 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.905 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.132 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.696 ms
    Lanczos iter 54, eigmin  = -0.965005686, eigmax = 264.924890470, err_eigmin = 1.142e-03, err_eigmax = 9.976e-03
rank =   0, Lanczos took 123.791 ms, eigmin = -0.965005686056, eigmax = 267.574139374734

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.254567, lowerbound = -1.065006, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1174.942 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 34.297 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.064 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.272 ms
rank =  0, Distribute data + matrix mult took 39.652 ms
rank =  0, finding HY took 20.432 ms
rank =  0, distributing HY into block cyclic form took 11.906 ms
rank =  0, finding Y'*HY took 5.481 ms
Rank 0, Project_Hamiltonian used 77.507 ms
Total time for projection: 77.524 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.349 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.439 ms
    first calculated eigval = 2.808481789433567
    last  calculated eigval = 3.210091629339967
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.80848178943357
lambda[   2] =   2.85087624179260
lambda[   3] =   2.85858034841775
lambda[   4] =   2.93092550788147
lambda[   5] =   2.94156946184518
lambda[   6] =   2.95011032418392
lambda[   7] =   2.98295704343669
lambda[   8] =   3.01614400014551
lambda[   9] =   3.04354659069292
lambda[  10] =   3.07208503802595
lambda[  11] =   3.09351223093793
lambda[  12] =   3.10724846791389
lambda[  13] =   3.14157081129773
lambda[  14] =   3.15724912470007
lambda[  15] =   3.21009162933997
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.453 ms
rank =  0, subspace rotation using ScaLAPACK took 3.464 ms
rank =  0, Distributing orbital back into band + domain format took 13.238 ms
rank = 0, Subspace_Rotation used 16.716 ms

Total time for subspace rotation: 16.720 ms
rank = 0, Efermi =   3.057815815089 calculate fermi energy took 0.044 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.310092, lowerbound = -1.065006, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1182.484 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.975 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.311 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.307 ms
rank =  0, finding HY took 19.312 ms
rank =  0, distributing HY into block cyclic form took 11.987 ms
rank =  0, finding Y'*HY took 4.293 ms
Rank 0, Project_Hamiltonian used 50.931 ms
Total time for projection: 50.947 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -0.675440048269835
    last  calculated eigval = 0.433748933123440
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.67544004826984
lambda[   2] =  -0.53806869206964
lambda[   3] =  -0.42311107329497
lambda[   4] =  -0.13852903274654
lambda[   5] =  -0.04144984253309
lambda[   6] =   0.03841927742785
lambda[   7] =   0.07975828847229
lambda[   8] =   0.21142900453982
lambda[   9] =   0.27937429826424
lambda[  10] =   0.32122527769178
lambda[  11] =   0.34896332205673
lambda[  12] =   0.36788418350706
lambda[  13] =   0.38465532102545
lambda[  14] =   0.41129777952885
lambda[  15] =   0.43374893312344
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 3.480 ms
rank =  0, Distributing orbital back into band + domain format took 11.953 ms
rank = 0, Subspace_Rotation used 15.446 ms

Total time for subspace rotation: 15.450 ms
rank = 0, Efermi =   0.300299843807 calculate fermi energy took 0.038 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.533749, lowerbound = -1.065006, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1170.623 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.108 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.339 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 15.486 ms
rank =  0, finding HY took 19.370 ms
rank =  0, distributing HY into block cyclic form took 11.906 ms
rank =  0, finding Y'*HY took 4.710 ms
Rank 0, Project_Hamiltonian used 51.522 ms
Total time for projection: 51.526 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.996007971367877
    last  calculated eigval = 0.146809874906777
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99600797136788
lambda[   2] =  -0.89445144207017
lambda[   3] =  -0.72876439924912
lambda[   4] =  -0.60714903554461
lambda[   5] =  -0.45193475257382
lambda[   6] =  -0.43640121927907
lambda[   7] =  -0.41524280824319
lambda[   8] =  -0.37455406557023
lambda[   9] =  -0.34050684233944
lambda[  10] =  -0.08600502106598
lambda[  11] =  -0.04455716831735
lambda[  12] =   0.07546680351465
lambda[  13] =   0.08905114686326
lambda[  14] =   0.10721604030405
lambda[  15] =   0.14680987490678
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 3.523 ms
rank =  0, Distributing orbital back into band + domain format took 11.965 ms
rank = 0, Subspace_Rotation used 15.500 ms

Total time for subspace rotation: 15.504 ms
rank = 0, Efermi =  -0.116364059642 calculate fermi energy took 0.022 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.246810, lowerbound = -1.065006, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1178.702 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.090 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.387 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.096 ms
rank =  0, Distribute data + matrix mult took 15.588 ms
rank =  0, finding HY took 19.318 ms
rank =  0, distributing HY into block cyclic form took 11.998 ms
rank =  0, finding Y'*HY took 4.325 ms
Rank 0, Project_Hamiltonian used 51.260 ms
Total time for projection: 51.274 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -0.996659177299144
    last  calculated eigval = 0.079134762953913
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99665917729914
lambda[   2] =  -0.89547670855767
lambda[   3] =  -0.72964388343201
lambda[   4] =  -0.61280098346832
lambda[   5] =  -0.45923022749420
lambda[   6] =  -0.45880575427009
lambda[   7] =  -0.45626093661901
lambda[   8] =  -0.39014494574693
lambda[   9] =  -0.38981509003046
lambda[  10] =  -0.17042231828625
lambda[  11] =  -0.16298293481674
lambda[  12] =   0.01335151957078
lambda[  13] =   0.02758539777381
lambda[  14] =   0.04884919702908
lambda[  15] =   0.07913476295391
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 3.509 ms
rank =  0, Distributing orbital back into band + domain format took 12.223 ms
rank = 0, Subspace_Rotation used 15.746 ms

Total time for subspace rotation: 15.750 ms
rank = 0, Efermi =  -0.200781415841 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.421 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.687 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.153 ms
rank = 0, Calculating density took 5134.914 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.709 ms
rank = 0, D2D took 0.820 ms
rank = 0, Transfering density took 0.826 ms
Etot    =   -29.059068201530
Eband   =   -10.777675414717
E1      =    21.483015600948
E2      =    -8.490610316393
E3      =   -10.035634083478
Exc     =    -9.217531672538
Esc     =   -49.073121114933
Entropy =    -0.000000000161
dE = 5.812e+00, dEband = 2.156e+00
rank = 0, Calculating/Estimating energy took 1.746 ms, Etot = -29.059068202, dEtot = 5.812e+00, dEband = 2.156e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 42.4736709018327, which took 0.049 ms

iter_count = 96, r_2norm = 1.389e-03, tol*||rhs|| = 1.699e-03

Anderson update took 50.983 ms, out of which F'*F took 23.648 ms; b-Ax took 161.002 ms, out of which Lap took 143.882 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 348.006 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517366, int_b + int_rho = -1.008e-12, checking this took 0.117 ms
2-norm of RHS = 533.0286863617274, which took 0.170 ms

iter_count = 288, r_2norm = 4.717e-04, tol*||rhs|| = 5.330e-04

Anderson update took 154.493 ms, out of which F'*F took 72.940 ms; b-Ax took 488.385 ms, out of which Lap took 436.811 ms
Solving Poisson took 1033.915 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.816 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.129002 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.474 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.168041 
Total time for convolution: 	 convolve: 5.235435 
Total time for convolution: 	 convolve: 5.157006 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 0.971 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.849 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.838 ms

This SCF took 31267.787 ms, scf error = 2.054e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.179135, lowerbound = -0.996659, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1168.612 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.973 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.393 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.388 ms
rank =  0, finding HY took 19.544 ms
rank =  0, distributing HY into block cyclic form took 12.043 ms
rank =  0, finding Y'*HY took 4.235 ms
Rank 0, Project_Hamiltonian used 51.247 ms
Total time for projection: 51.259 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -0.950276476642387
    last  calculated eigval = 0.050007252395257
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.95027647664239
lambda[   2] =  -0.84452476589020
lambda[   3] =  -0.70678047120961
lambda[   4] =  -0.58283991087434
lambda[   5] =  -0.43330627888683
lambda[   6] =  -0.43325714446587
lambda[   7] =  -0.41357553259992
lambda[   8] =  -0.35533376572171
lambda[   9] =  -0.35526611856283
lambda[  10] =  -0.15034049217879
lambda[  11] =  -0.14937581931899
lambda[  12] =  -0.01257279635504
lambda[  13] =   0.01753682927287
lambda[  14] =   0.03214728942920
lambda[  15] =   0.05000725239526
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 3.490 ms
rank =  0, Distributing orbital back into band + domain format took 12.043 ms
rank = 0, Subspace_Rotation used 15.546 ms

Total time for subspace rotation: 15.551 ms
rank = 0, Efermi =  -0.180938936318 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 2.345 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.322 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.242 ms
rank = 0, Calculating density took 1242.622 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.510 ms
rank = 0, D2D took 0.613 ms
rank = 0, Transfering density took 0.615 ms
Etot    =   -28.986780666192
Eband   =   -10.150320930484
E1      =    20.938295956412
E2      =    -8.451136724823
E3      =   -10.190212433647
Exc     =    -9.342983735494
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 1.446e-02, dEband = 1.255e-01
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -28.986780666, dEtot = 1.446e-02, dEband = 1.255e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 21.6320700471200, which took 0.153 ms

iter_count = 102, r_2norm = 6.080e-04, tol*||rhs|| = 8.653e-04

Anderson update took 54.038 ms, out of which F'*F took 25.568 ms; b-Ax took 172.515 ms, out of which Lap took 154.320 ms
rank = 0, Mixing (+ precond) took 374.436 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517354, int_b + int_rho = -1.135e-12, checking this took 0.096 ms
2-norm of RHS = 529.3335847778243, which took 0.082 ms

iter_count = 300, r_2norm = 4.670e-04, tol*||rhs|| = 5.293e-04

Anderson update took 161.400 ms, out of which F'*F took 80.702 ms; b-Ax took 518.749 ms, out of which Lap took 466.329 ms
Solving Poisson took 1082.972 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.852 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.182970 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.187391 
Total time for convolution: 	 convolve: 5.263507 
Total time for convolution: 	 convolve: 5.289582 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.351 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.195 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.939 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.859 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.817 ms

This SCF took 27642.833 ms, scf error = 1.365e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.150007, lowerbound = -0.950276, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1137.829 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.067 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.602 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.124 ms
rank =  0, Distribute data + matrix mult took 15.810 ms
rank =  0, finding HY took 20.050 ms
rank =  0, distributing HY into block cyclic form took 12.136 ms
rank =  0, finding Y'*HY took 4.683 ms
Rank 0, Project_Hamiltonian used 52.711 ms
Total time for projection: 52.725 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.892301268312347
    last  calculated eigval = 0.036580489777892
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89230126831235
lambda[   2] =  -0.77569465266593
lambda[   3] =  -0.65796708518322
lambda[   4] =  -0.53567157206730
lambda[   5] =  -0.39499758392667
lambda[   6] =  -0.39495023599200
lambda[   7] =  -0.37070821349273
lambda[   8] =  -0.31035473128588
lambda[   9] =  -0.31033171105857
lambda[  10] =  -0.11622618479876
lambda[  11] =  -0.11605565987818
lambda[  12] =  -0.02293975265051
lambda[  13] =   0.01726493638980
lambda[  14] =   0.03345539794368
lambda[  15] =   0.03658048977789
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.166 ms
rank =  0, subspace rotation using ScaLAPACK took 3.287 ms
rank =  0, Distributing orbital back into band + domain format took 12.804 ms
rank = 0, Subspace_Rotation used 16.109 ms

Total time for subspace rotation: 16.113 ms
rank = 0, Efermi =  -0.147098608242 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.581 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.540 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.177 ms
rank = 0, Calculating density took 1213.268 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.499 ms
rank = 0, D2D took 0.606 ms
rank = 0, Transfering density took 0.611 ms
Etot    =   -28.934564285117
Eband   =    -9.285954108570
E1      =    20.217179788154
E2      =    -8.317169437696
E3      =   -10.414567540840
Exc     =    -9.524405828140
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 1.044e-02, dEband = 1.729e-01
rank = 0, Calculating/Estimating energy took 0.916 ms, Etot = -28.934564285, dEtot = 1.044e-02, dEband = 1.729e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.2169021535511, which took 0.106 ms

iter_count = 108, r_2norm = 1.510e-04, tol*||rhs|| = 2.087e-04

Anderson update took 57.534 ms, out of which F'*F took 27.143 ms; b-Ax took 184.697 ms, out of which Lap took 164.561 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.335 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517355, int_b + int_rho = -1.120e-12, checking this took 0.113 ms
2-norm of RHS = 529.0715394607674, which took 0.107 ms

iter_count = 282, r_2norm = 4.669e-04, tol*||rhs|| = 5.291e-04

Anderson update took 150.433 ms, out of which F'*F took 70.763 ms; b-Ax took 480.376 ms, out of which Lap took 431.279 ms
Solving Poisson took 1008.753 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.137889 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.207 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.128298 
Total time for convolution: 	 convolve: 5.146864 
Total time for convolution: 	 convolve: 5.090012 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.186 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.955 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.850 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.823 ms

This SCF took 27196.244 ms, scf error = 4.666e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.136580, lowerbound = -0.892301, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1141.680 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 11.961 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.325 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.117 ms
rank =  0, Distribute data + matrix mult took 15.419 ms
rank =  0, finding HY took 19.410 ms
rank =  0, distributing HY into block cyclic form took 11.737 ms
rank =  0, finding Y'*HY took 5.625 ms
Rank 0, Project_Hamiltonian used 52.224 ms
Total time for projection: 52.236 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.867942210377382
    last  calculated eigval = 0.030742380516112
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.86794221037738
lambda[   2] =  -0.75056177022018
lambda[   3] =  -0.63585266335754
lambda[   4] =  -0.51576311921938
lambda[   5] =  -0.37793793098088
lambda[   6] =  -0.37790882568029
lambda[   7] =  -0.35228763680649
lambda[   8] =  -0.29311025441080
lambda[   9] =  -0.29310403031738
lambda[  10] =  -0.10218457056022
lambda[  11] =  -0.10211928240672
lambda[  12] =  -0.02724419325386
lambda[  13] =   0.01090389244713
lambda[  14] =   0.02809288659307
lambda[  15] =   0.03074238051611
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 3.412 ms
rank =  0, Distributing orbital back into band + domain format took 12.739 ms
rank = 0, Subspace_Rotation used 16.168 ms

Total time for subspace rotation: 16.173 ms
rank = 0, Efermi =  -0.133106063747 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 2.524 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.935 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.250 ms
rank = 0, Calculating density took 1217.095 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
rank = 0, D2D took 0.648 ms
rank = 0, Transfering density took 0.653 ms
Etot    =   -28.928290694359
Eband   =    -8.928936883269
E1      =    19.951174204063
E2      =    -8.212148244411
E3      =   -10.510260780150
Exc     =    -9.599815924617
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 1.255e-03, dEband = 7.140e-02
rank = 0, Calculating/Estimating energy took 0.895 ms, Etot = -28.928290694, dEtot = 1.255e-03, dEband = 7.140e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.1751188425730, which took 0.054 ms

iter_count = 108, r_2norm = 7.165e-05, tol*||rhs|| = 8.700e-05

Anderson update took 57.474 ms, out of which F'*F took 27.047 ms; b-Ax took 184.465 ms, out of which Lap took 165.357 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.737 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517359, int_b + int_rho = -1.080e-12, checking this took 0.102 ms
2-norm of RHS = 530.4218946128321, which took 0.103 ms

iter_count = 270, r_2norm = 4.351e-04, tol*||rhs|| = 5.304e-04

Anderson update took 142.606 ms, out of which F'*F took 67.402 ms; b-Ax took 463.579 ms, out of which Lap took 414.576 ms
Solving Poisson took 969.075 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Total time for convolution: 	 convolve: 5.114470 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.155702 
Total time for convolution: 	 convolve: 6.232728 
Total time for convolution: 	 convolve: 5.154855 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.374 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.004 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.795 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.821 ms

This SCF took 28261.552 ms, scf error = 1.932e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.130742, lowerbound = -0.867942, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1192.685 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.074 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.363 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.039 ms
rank =  0, Distribute data + matrix mult took 15.498 ms
rank =  0, finding HY took 19.563 ms
rank =  0, distributing HY into block cyclic form took 12.001 ms
rank =  0, finding Y'*HY took 4.247 ms
Rank 0, Project_Hamiltonian used 51.344 ms
Total time for projection: 51.358 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.860843053311541
    last  calculated eigval = 0.028455372242315
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.86084305331154
lambda[   2] =  -0.74723700027881
lambda[   3] =  -0.63052185311392
lambda[   4] =  -0.51097062194561
lambda[   5] =  -0.37264152682186
lambda[   6] =  -0.37262864901333
lambda[   7] =  -0.34447849925579
lambda[   8] =  -0.28936207970373
lambda[   9] =  -0.28935520906628
lambda[  10] =  -0.09788040518076
lambda[  11] =  -0.09785412708901
lambda[  12] =  -0.02840683846394
lambda[  13] =   0.00715338674017
lambda[  14] =   0.02366061157961
lambda[  15] =   0.02845537224232
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 3.532 ms
rank =  0, Distributing orbital back into band + domain format took 41.384 ms
rank = 0, Subspace_Rotation used 44.939 ms

Total time for subspace rotation: 44.943 ms
rank = 0, Efermi =  -0.128820891804 calculate fermi energy took 1.988 ms
rank = 0, --- Calculate rho: sum over local bands took 3.157 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.069 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.151 ms
rank = 0, Calculating density took 1296.619 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.607 ms
rank = 0, D2D took 0.807 ms
rank = 0, Transfering density took 0.814 ms
Etot    =   -28.927032017268
Eband   =    -8.836076985528
E1      =    19.927604616363
E2      =    -8.136666079500
E3      =   -10.530704574521
Exc     =    -9.612809187026
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 2.517e-04, dEband = 1.857e-02
rank = 0, Calculating/Estimating energy took 1.065 ms, Etot = -28.927032017, dEtot = 2.517e-04, dEband = 1.857e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6886265455847, which took 0.048 ms

iter_count = 114, r_2norm = 1.927e-05, tol*||rhs|| = 2.755e-05

Anderson update took 61.120 ms, out of which F'*F took 27.924 ms; b-Ax took 191.702 ms, out of which Lap took 171.658 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.978 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517357, int_b + int_rho = -1.102e-12, checking this took 0.112 ms
2-norm of RHS = 531.0002637335336, which took 0.115 ms

iter_count = 252, r_2norm = 4.774e-04, tol*||rhs|| = 5.310e-04

Anderson update took 133.715 ms, out of which F'*F took 61.874 ms; b-Ax took 431.572 ms, out of which Lap took 384.840 ms
Solving Poisson took 907.898 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Total time for convolution: 	 convolve: 5.117154 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.150012 
Total time for convolution: 	 convolve: 5.118423 
Total time for convolution: 	 convolve: 5.164845 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.578 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.595 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.277 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.924 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.278 ms

This SCF took 27274.466 ms, scf error = 7.613e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.128455, lowerbound = -0.860843, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1178.401 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.115 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.259 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 15.410 ms
rank =  0, finding HY took 19.637 ms
rank =  0, distributing HY into block cyclic form took 12.069 ms
rank =  0, finding Y'*HY took 4.081 ms
Rank 0, Project_Hamiltonian used 51.229 ms
Total time for projection: 51.242 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.271 ms
rank = 0, Solve_Generalized_EigenProblem used 0.341 ms
    first calculated eigval = -0.856911324766276
    last  calculated eigval = 0.027571671461910
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85691132476628
lambda[   2] =  -0.74414909024370
lambda[   3] =  -0.62733361028803
lambda[   4] =  -0.50725022811913
lambda[   5] =  -0.36954431473920
lambda[   6] =  -0.36953943856747
lambda[   7] =  -0.33955371667866
lambda[   8] =  -0.28609917241272
lambda[   9] =  -0.28609308456089
lambda[  10] =  -0.09476624054918
lambda[  11] =  -0.09475492508546
lambda[  12] =  -0.02869675884456
lambda[  13] =   0.00552705192639
lambda[  14] =   0.02154172221946
lambda[  15] =   0.02757167146191
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.356 ms
rank =  0, subspace rotation using ScaLAPACK took 3.219 ms
rank =  0, Distributing orbital back into band + domain format took 12.452 ms
rank = 0, Subspace_Rotation used 15.694 ms

Total time for subspace rotation: 15.698 ms
rank = 0, Efermi =  -0.125714127960 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.142 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.250 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.152 ms
rank = 0, Calculating density took 1252.376 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.621 ms
rank = 0, D2D took 0.838 ms
rank = 0, Transfering density took 0.844 ms
Etot    =   -28.926572119645
Eband   =    -8.772947961242
E1      =    19.904070156666
E2      =    -8.093034742607
E3      =   -10.544112978641
Exc     =    -9.621720921220
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 9.198e-05, dEband = 1.263e-02
rank = 0, Calculating/Estimating energy took 0.954 ms, Etot = -28.926572120, dEtot = 9.198e-05, dEband = 1.263e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3801980407001, which took 0.075 ms

iter_count = 114, r_2norm = 1.005e-05, tol*||rhs|| = 1.521e-05

Anderson update took 60.173 ms, out of which F'*F took 28.184 ms; b-Ax took 193.446 ms, out of which Lap took 173.575 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.484 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517352, int_b + int_rho = -1.150e-12, checking this took 0.124 ms
2-norm of RHS = 531.2479548536541, which took 0.108 ms

iter_count = 246, r_2norm = 5.031e-04, tol*||rhs|| = 5.312e-04

Anderson update took 131.089 ms, out of which F'*F took 62.237 ms; b-Ax took 423.228 ms, out of which Lap took 379.854 ms
Solving Poisson took 882.148 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.153354 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.125174 
Total time for convolution: 	 convolve: 5.168404 
Total time for convolution: 	 convolve: 5.115173 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.829 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.934 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.336 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.292 ms

This SCF took 27191.863 ms, scf error = 4.064e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.127572, lowerbound = -0.856911, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1191.053 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.059 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.290 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.018 ms
rank =  0, Distribute data + matrix mult took 15.403 ms
rank =  0, finding HY took 19.274 ms
rank =  0, distributing HY into block cyclic form took 12.136 ms
rank =  0, finding Y'*HY took 4.255 ms
Rank 0, Project_Hamiltonian used 51.104 ms
Total time for projection: 51.121 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.854488846584996
    last  calculated eigval = 0.027809683418506
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85448884658500
lambda[   2] =  -0.74121825235145
lambda[   3] =  -0.62463926029242
lambda[   4] =  -0.50517464105590
lambda[   5] =  -0.36687421188154
lambda[   6] =  -0.36687316072880
lambda[   7] =  -0.33629468622654
lambda[   8] =  -0.28334121578757
lambda[   9] =  -0.28334016945498
lambda[  10] =  -0.09222912285922
lambda[  11] =  -0.09222623271711
lambda[  12] =  -0.02818593558005
lambda[  13] =   0.00548794196189
lambda[  14] =   0.02115027409797
lambda[  15] =   0.02780968341851
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 3.553 ms
rank =  0, Distributing orbital back into band + domain format took 11.977 ms
rank = 0, Subspace_Rotation used 15.547 ms

Total time for subspace rotation: 15.552 ms
rank = 0, Efermi =  -0.123181205880 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.060 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.362 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.168 ms
rank = 0, Calculating density took 1264.598 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.628 ms
rank = 0, D2D took 0.805 ms
rank = 0, Transfering density took 0.808 ms
Etot    =   -28.926484327370
Eband   =    -8.724488889206
E1      =    19.885785977154
E2      =    -8.060636288208
E3      =   -10.550311020094
Exc     =    -9.625607608523
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 1.756e-05, dEband = 9.692e-03
rank = 0, Calculating/Estimating energy took 0.961 ms, Etot = -28.926484327, dEtot = 1.756e-05, dEband = 9.692e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2729945473701, which took 0.052 ms

iter_count = 114, r_2norm = 6.948e-06, tol*||rhs|| = 1.092e-05

Anderson update took 60.079 ms, out of which F'*F took 28.213 ms; b-Ax took 191.193 ms, out of which Lap took 171.386 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.116 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517364, int_b + int_rho = -1.037e-12, checking this took 0.127 ms
2-norm of RHS = 531.2307270759929, which took 0.073 ms

iter_count = 234, r_2norm = 4.346e-04, tol*||rhs|| = 5.312e-04

Anderson update took 124.922 ms, out of which F'*F took 58.996 ms; b-Ax took 399.246 ms, out of which Lap took 358.638 ms
Solving Poisson took 840.302 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.154562 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.122225 
Total time for convolution: 	 convolve: 5.159832 
Total time for convolution: 	 convolve: 5.130303 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.821 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 1.015 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.337 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.375 ms

This SCF took 27161.631 ms, scf error = 2.198e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.127810, lowerbound = -0.854489, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1173.782 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.984 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.410 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 15.439 ms
rank =  0, finding HY took 19.504 ms
rank =  0, distributing HY into block cyclic form took 12.150 ms
rank =  0, finding Y'*HY took 4.026 ms
Rank 0, Project_Hamiltonian used 51.153 ms
Total time for projection: 51.164 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -0.851712364520689
    last  calculated eigval = 0.028090103098897
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85171236452069
lambda[   2] =  -0.73870785802112
lambda[   3] =  -0.62228294455497
lambda[   4] =  -0.50343550088374
lambda[   5] =  -0.36455136324981
lambda[   6] =  -0.36455003668803
lambda[   7] =  -0.33361840971989
lambda[   8] =  -0.28112510021134
lambda[   9] =  -0.28112484262751
lambda[  10] =  -0.09022413020817
lambda[  11] =  -0.09022342915900
lambda[  12] =  -0.02733776430610
lambda[  13] =   0.00637072943068
lambda[  14] =   0.02175117253566
lambda[  15] =   0.02809010309890
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 3.630 ms
rank =  0, Distributing orbital back into band + domain format took 11.988 ms
rank = 0, Subspace_Rotation used 15.635 ms

Total time for subspace rotation: 15.640 ms
rank = 0, Efermi =  -0.121177306548 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 3.106 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.239 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.151 ms
rank = 0, Calculating density took 1247.399 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.732 ms
rank = 0, D2D took 0.883 ms
rank = 0, Transfering density took 0.885 ms
Etot    =   -28.926570194151
Eband   =    -8.682216841421
E1      =    19.861323664271
E2      =    -8.041058989820
E3      =   -10.557200106173
Exc     =    -9.630814997896
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 1.717e-05, dEband = 8.454e-03
rank = 0, Calculating/Estimating energy took 0.937 ms, Etot = -28.926570194, dEtot = 1.717e-05, dEband = 8.454e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1469529580413, which took 0.054 ms

iter_count = 114, r_2norm = 4.154e-06, tol*||rhs|| = 5.878e-06

Anderson update took 60.331 ms, out of which F'*F took 27.877 ms; b-Ax took 191.321 ms, out of which Lap took 171.285 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.201 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517358, int_b + int_rho = -1.091e-12, checking this took 0.121 ms
2-norm of RHS = 531.2287262695020, which took 0.111 ms

iter_count = 222, r_2norm = 5.077e-04, tol*||rhs|| = 5.312e-04

Anderson update took 118.476 ms, out of which F'*F took 56.102 ms; b-Ax took 379.609 ms, out of which Lap took 341.273 ms
Solving Poisson took 798.071 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.911 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.145883 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.152372 
Total time for convolution: 	 convolve: 5.145333 
Total time for convolution: 	 convolve: 5.128932 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.928 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 1.158 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.119 ms

This SCF took 27053.277 ms, scf error = 1.468e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.128090, lowerbound = -0.851712, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1183.428 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.017 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.325 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.363 ms
rank =  0, finding HY took 19.569 ms
rank =  0, distributing HY into block cyclic form took 11.980 ms
rank =  0, finding Y'*HY took 4.140 ms
Rank 0, Project_Hamiltonian used 51.089 ms
Total time for projection: 51.102 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -0.850099797574893
    last  calculated eigval = 0.028822020920470
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85009979757489
lambda[   2] =  -0.73779066917521
lambda[   3] =  -0.62115273035075
lambda[   4] =  -0.50264556855376
lambda[   5] =  -0.36318178651949
lambda[   6] =  -0.36318108129685
lambda[   7] =  -0.33200934879374
lambda[   8] =  -0.27996406125134
lambda[   9] =  -0.27996344514708
lambda[  10] =  -0.08897149218662
lambda[  11] =  -0.08897126148407
lambda[  12] =  -0.02527206016054
lambda[  13] =   0.00942743411887
lambda[  14] =   0.02395285005902
lambda[  15] =   0.02882202092047
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 3.516 ms
rank =  0, Distributing orbital back into band + domain format took 11.991 ms
rank = 0, Subspace_Rotation used 15.523 ms

Total time for subspace rotation: 15.528 ms
rank = 0, Efermi =  -0.119924903628 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 3.141 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.336 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.155 ms
rank = 0, Calculating density took 1256.987 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.669 ms
rank = 0, D2D took 0.852 ms
rank = 0, Transfering density took 0.859 ms
Etot    =   -28.926624327413
Eband   =    -8.659976977787
E1      =    19.851445919294
E2      =    -8.028223817864
E3      =   -10.558779139213
Exc     =    -9.631975110901
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 1.083e-05, dEband = 4.448e-03
rank = 0, Calculating/Estimating energy took 0.941 ms, Etot = -28.926624327, dEtot = 1.083e-05, dEband = 4.448e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0974038008225, which took 0.054 ms

iter_count = 114, r_2norm = 2.878e-06, tol*||rhs|| = 3.896e-06

Anderson update took 60.102 ms, out of which F'*F took 27.870 ms; b-Ax took 190.884 ms, out of which Lap took 170.855 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.285 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517351, int_b + int_rho = -1.157e-12, checking this took 0.082 ms
2-norm of RHS = 531.2168682489166, which took 1.018 ms

iter_count = 198, r_2norm = 5.159e-04, tol*||rhs|| = 5.312e-04

Anderson update took 107.107 ms, out of which F'*F took 50.220 ms; b-Ax took 338.526 ms, out of which Lap took 304.444 ms
Solving Poisson took 714.268 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.140064 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.116997 
Total time for convolution: 	 convolve: 5.126661 
Total time for convolution: 	 convolve: 5.131270 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 0.951 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.338 ms

This SCF took 26924.092 ms, scf error = 8.167e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.128822, lowerbound = -0.850100, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1179.530 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.072 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.320 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.414 ms
rank =  0, finding HY took 19.429 ms
rank =  0, distributing HY into block cyclic form took 12.294 ms
rank =  0, finding Y'*HY took 3.982 ms
Rank 0, Project_Hamiltonian used 51.153 ms
Total time for projection: 51.169 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -0.849156463967391
    last  calculated eigval = 0.029571396056070
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84915646396739
lambda[   2] =  -0.73690256015644
lambda[   3] =  -0.62026476563054
lambda[   4] =  -0.50184959393086
lambda[   5] =  -0.36232455955879
lambda[   6] =  -0.36232418932970
lambda[   7] =  -0.33114700432924
lambda[   8] =  -0.27914645471143
lambda[   9] =  -0.27914601739186
lambda[  10] =  -0.08815705012264
lambda[  11] =  -0.08815694603901
lambda[  12] =  -0.02356721971604
lambda[  13] =   0.01223605851392
lambda[  14] =   0.02569886025049
lambda[  15] =   0.02957139605607
==subpsace eigenproblem: bcast eigvals took 0.057 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 3.530 ms
rank =  0, Distributing orbital back into band + domain format took 12.018 ms
rank = 0, Subspace_Rotation used 15.563 ms

Total time for subspace rotation: 15.568 ms
rank = 0, Efermi =  -0.119110524969 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 3.076 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.333 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.155 ms
rank = 0, Calculating density took 1253.156 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.650 ms
rank = 0, D2D took 0.815 ms
rank = 0, Transfering density took 0.818 ms
Etot    =   -28.926677541168
Eband   =    -8.644523218469
E1      =    19.842854719396
E2      =    -8.020955066927
E3      =   -10.560658084031
Exc     =    -9.633501077956
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 1.064e-05, dEband = 3.091e-03
rank = 0, Calculating/Estimating energy took 0.958 ms, Etot = -28.926677541, dEtot = 1.064e-05, dEband = 3.091e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0612047719672, which took 0.052 ms

iter_count = 114, r_2norm = 1.567e-06, tol*||rhs|| = 2.448e-06

Anderson update took 60.499 ms, out of which F'*F took 27.759 ms; b-Ax took 191.336 ms, out of which Lap took 171.357 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.241 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517360, int_b + int_rho = -1.077e-12, checking this took 0.103 ms
2-norm of RHS = 531.2282262492736, which took 0.099 ms

iter_count = 204, r_2norm = 4.372e-04, tol*||rhs|| = 5.312e-04

Anderson update took 108.752 ms, out of which F'*F took 51.425 ms; b-Ax took 349.323 ms, out of which Lap took 313.961 ms
Solving Poisson took 733.505 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.148004 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.118996 
Total time for convolution: 	 convolve: 5.130290 
Total time for convolution: 	 convolve: 5.182768 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.841 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.417 ms
---Transfer Veff_loc: D2D took 1.017 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.337 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.376 ms

This SCF took 27002.008 ms, scf error = 5.998e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129571, lowerbound = -0.849156, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1187.259 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.287 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.153 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.469 ms
rank =  0, finding HY took 19.482 ms
rank =  0, distributing HY into block cyclic form took 12.051 ms
rank =  0, finding Y'*HY took 4.125 ms
Rank 0, Project_Hamiltonian used 51.166 ms
Total time for projection: 51.179 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.848651525622251
    last  calculated eigval = 0.031887919598392
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84865152562225
lambda[   2] =  -0.73630123152346
lambda[   3] =  -0.61965146110793
lambda[   4] =  -0.50121699176314
lambda[   5] =  -0.36171148335025
lambda[   6] =  -0.36171135408723
lambda[   7] =  -0.33059151781862
lambda[   8] =  -0.27853665165072
lambda[   9] =  -0.27853643574383
lambda[  10] =  -0.08748510176043
lambda[  11] =  -0.08748501419425
lambda[  12] =  -0.01986166048955
lambda[  13] =   0.01761734895277
lambda[  14] =   0.02985607534448
lambda[  15] =   0.03188791959839
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 3.534 ms
rank =  0, Distributing orbital back into band + domain format took 12.003 ms
rank = 0, Subspace_Rotation used 15.552 ms

Total time for subspace rotation: 15.558 ms
rank = 0, Efermi =  -0.118438584672 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.029 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.311 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.154 ms
rank = 0, Calculating density took 1260.774 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.609 ms
rank = 0, D2D took 0.798 ms
rank = 0, Transfering density took 0.802 ms
Etot    =   -28.926713016924
Eband   =    -8.633817305787
E1      =    19.838383296006
E2      =    -8.014668145579
E3      =   -10.561023518913
Exc     =    -9.633849556538
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 7.095e-06, dEband = 2.141e-03
rank = 0, Calculating/Estimating energy took 1.072 ms, Etot = -28.926713017, dEtot = 7.095e-06, dEband = 2.141e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0388522044126, which took 0.090 ms

iter_count = 114, r_2norm = 1.335e-06, tol*||rhs|| = 1.554e-06

Anderson update took 60.262 ms, out of which F'*F took 27.984 ms; b-Ax took 191.333 ms, out of which Lap took 171.385 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.385 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517360, int_b + int_rho = -1.070e-12, checking this took 0.107 ms
2-norm of RHS = 531.2303248126130, which took 0.075 ms

iter_count = 162, r_2norm = 4.603e-04, tol*||rhs|| = 5.312e-04

Anderson update took 86.435 ms, out of which F'*F took 40.930 ms; b-Ax took 276.644 ms, out of which Lap took 248.825 ms
Solving Poisson took 583.207 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.125 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.157236 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.176021 
Total time for convolution: 	 convolve: 5.122199 
Total time for convolution: 	 convolve: 5.125937 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.824 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.966 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.331 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.319 ms

This SCF took 26860.785 ms, scf error = 3.755e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.131888, lowerbound = -0.848652, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1185.166 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 11.917 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.336 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.113 ms
rank =  0, Distribute data + matrix mult took 15.381 ms
rank =  0, finding HY took 19.393 ms
rank =  0, distributing HY into block cyclic form took 11.908 ms
rank =  0, finding Y'*HY took 4.352 ms
Rank 0, Project_Hamiltonian used 51.065 ms
Total time for projection: 51.081 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.848323176248568
    last  calculated eigval = 0.032153047249882
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84832317624857
lambda[   2] =  -0.73603226768703
lambda[   3] =  -0.61938141913112
lambda[   4] =  -0.50098401115368
lambda[   5] =  -0.36143056551606
lambda[   6] =  -0.36143051298234
lambda[   7] =  -0.33027951752024
lambda[   8] =  -0.27826944690197
lambda[   9] =  -0.27826920938011
lambda[  10] =  -0.08722987903691
lambda[  11] =  -0.08722966427873
lambda[  12] =  -0.01962776843513
lambda[  13] =   0.01730539124673
lambda[  14] =   0.03030648557190
lambda[  15] =   0.03215304724988
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.172 ms
rank =  0, subspace rotation using ScaLAPACK took 3.505 ms
rank =  0, Distributing orbital back into band + domain format took 12.002 ms
rank = 0, Subspace_Rotation used 15.523 ms

Total time for subspace rotation: 15.528 ms
rank = 0, Efermi =  -0.118183298596 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.106 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.320 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 1258.637 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.641 ms
rank = 0, D2D took 0.822 ms
rank = 0, Transfering density took 0.825 ms
Etot    =   -28.926762403339
Eband   =    -8.628800253494
E1      =    19.835743246739
E2      =    -8.012132714681
E3      =   -10.561550302029
Exc     =    -9.634267298198
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 9.877e-06, dEband = 1.003e-03
rank = 0, Calculating/Estimating energy took 2.252 ms, Etot = -28.926762403, dEtot = 9.877e-06, dEband = 1.003e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0426004922453, which took 0.054 ms

iter_count = 108, r_2norm = 1.271e-06, tol*||rhs|| = 1.704e-06

Anderson update took 57.136 ms, out of which F'*F took 26.414 ms; b-Ax took 182.125 ms, out of which Lap took 163.347 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.212 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517354, int_b + int_rho = -1.128e-12, checking this took 0.130 ms
2-norm of RHS = 531.2479441304746, which took 0.123 ms

iter_count = 186, r_2norm = 4.550e-04, tol*||rhs|| = 5.312e-04

Anderson update took 99.245 ms, out of which F'*F took 47.032 ms; b-Ax took 318.610 ms, out of which Lap took 285.866 ms
Solving Poisson took 669.794 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.127037 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.141567 
Total time for convolution: 	 convolve: 5.124586 
Total time for convolution: 	 convolve: 5.125037 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.819 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.136 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
---Transfer Veff_loc: D2D took 0.957 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.338 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.318 ms

This SCF took 27045.602 ms, scf error = 2.989e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132153, lowerbound = -0.848323, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1185.181 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.004 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.303 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.122 ms
rank =  0, Distribute data + matrix mult took 15.444 ms
rank =  0, finding HY took 19.518 ms
rank =  0, distributing HY into block cyclic form took 11.964 ms
rank =  0, finding Y'*HY took 4.235 ms
Rank 0, Project_Hamiltonian used 51.196 ms
Total time for projection: 51.207 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.847990035410745
    last  calculated eigval = 0.035385620945225
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84799003541075
lambda[   2] =  -0.73560641440627
lambda[   3] =  -0.61897157323322
lambda[   4] =  -0.50056134638571
lambda[   5] =  -0.36103559313384
lambda[   6] =  -0.36103553179974
lambda[   7] =  -0.32994597883857
lambda[   8] =  -0.27786516671194
lambda[   9] =  -0.27786513762664
lambda[  10] =  -0.08683092698967
lambda[  11] =  -0.08683075731891
lambda[  12] =  -0.01674470497140
lambda[  13] =   0.01840563695013
lambda[  14] =   0.03336348410374
lambda[  15] =   0.03538562094523
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 3.525 ms
rank =  0, Distributing orbital back into band + domain format took 11.977 ms
rank = 0, Subspace_Rotation used 15.517 ms

Total time for subspace rotation: 15.522 ms
rank = 0, Efermi =  -0.117784368967 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 3.134 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.231 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.165 ms
rank = 0, Calculating density took 1258.742 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.618 ms
rank = 0, D2D took 0.973 ms
rank = 0, Transfering density took 0.976 ms
Etot    =   -28.926832999012
Eband   =    -8.621753555543
E1      =    19.832766566525
E2      =    -8.007966969000
E3      =   -10.561750175059
Exc     =    -9.634442038956
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 1.412e-05, dEband = 1.409e-03
rank = 0, Calculating/Estimating energy took 0.980 ms, Etot = -28.926832999, dEtot = 1.412e-05, dEband = 1.409e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0429461814777, which took 0.053 ms

iter_count = 108, r_2norm = 1.311e-06, tol*||rhs|| = 1.718e-06

Anderson update took 57.017 ms, out of which F'*F took 26.426 ms; b-Ax took 181.354 ms, out of which Lap took 162.170 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.772 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517356, int_b + int_rho = -1.110e-12, checking this took 0.102 ms
2-norm of RHS = 531.2464569682680, which took 0.070 ms

iter_count = 126, r_2norm = 4.786e-04, tol*||rhs|| = 5.312e-04

Anderson update took 67.802 ms, out of which F'*F took 31.829 ms; b-Ax took 219.987 ms, out of which Lap took 198.129 ms
Solving Poisson took 457.798 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.135980 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 75.938 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.133861 
Total time for convolution: 	 convolve: 5.147775 
Total time for convolution: 	 convolve: 5.142638 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.468 ms
---Transfer Veff_loc: D2D took 0.915 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.326 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.262 ms

This SCF took 26769.052 ms, scf error = 2.399e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135386, lowerbound = -0.847990, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1206.599 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.202 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.188 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.092 ms
rank =  0, Distribute data + matrix mult took 15.496 ms
rank =  0, finding HY took 19.466 ms
rank =  0, distributing HY into block cyclic form took 12.084 ms
rank =  0, finding Y'*HY took 4.065 ms
Rank 0, Project_Hamiltonian used 51.144 ms
Total time for projection: 51.156 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.847883373450490
    last  calculated eigval = 0.035911396813103
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84788337345049
lambda[   2] =  -0.73555380134799
lambda[   3] =  -0.61891478213861
lambda[   4] =  -0.50051873299250
lambda[   5] =  -0.36096308528479
lambda[   6] =  -0.36096302570884
lambda[   7] =  -0.32984356698936
lambda[   8] =  -0.27780241277382
lambda[   9] =  -0.27780236748676
lambda[  10] =  -0.08676940825582
lambda[  11] =  -0.08676915203836
lambda[  12] =  -0.01629605563557
lambda[  13] =   0.01833364483489
lambda[  14] =   0.03373523652558
lambda[  15] =   0.03591139681310
==subpsace eigenproblem: bcast eigvals took 0.058 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 3.540 ms
rank =  0, Distributing orbital back into band + domain format took 11.996 ms
rank = 0, Subspace_Rotation used 15.573 ms

Total time for subspace rotation: 15.580 ms
rank = 0, Efermi =  -0.117722806909 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.977 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.526 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.159 ms
rank = 0, Calculating density took 1280.340 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.661 ms
rank = 0, D2D took 0.820 ms
rank = 0, Transfering density took 0.828 ms
Etot    =   -28.926841253458
Eband   =    -8.620490296795
E1      =    19.832082004464
E2      =    -8.007356202308
E3      =   -10.561867009283
Exc     =    -9.634535057621
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 1.651e-06, dEband = 2.527e-04
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -28.926841253, dEtot = 1.651e-06, dEband = 2.527e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0408761821129, which took 0.101 ms

iter_count = 108, r_2norm = 1.332e-06, tol*||rhs|| = 1.635e-06

Anderson update took 57.075 ms, out of which F'*F took 26.439 ms; b-Ax took 181.260 ms, out of which Lap took 162.240 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.802 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517363, int_b + int_rho = -1.048e-12, checking this took 0.098 ms
2-norm of RHS = 531.2459986644034, which took 0.119 ms

iter_count = 84, r_2norm = 4.694e-04, tol*||rhs|| = 5.312e-04

Anderson update took 44.770 ms, out of which F'*F took 21.143 ms; b-Ax took 143.192 ms, out of which Lap took 128.541 ms
Solving Poisson took 303.738 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.136160 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.119989 
Total time for convolution: 	 convolve: 5.178224 
Total time for convolution: 	 convolve: 5.149825 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.819 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.930 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.337 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.287 ms

This SCF took 26639.520 ms, scf error = 2.006e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.135911, lowerbound = -0.847883, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1191.461 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.168 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.234 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.095 ms
rank =  0, Distribute data + matrix mult took 15.512 ms
rank =  0, finding HY took 19.428 ms
rank =  0, distributing HY into block cyclic form took 12.014 ms
rank =  0, finding Y'*HY took 4.286 ms
Rank 0, Project_Hamiltonian used 51.273 ms
Total time for projection: 51.286 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.847838564989290
    last  calculated eigval = 0.035952644309248
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84783856498929
lambda[   2] =  -0.73551534390515
lambda[   3] =  -0.61887642050640
lambda[   4] =  -0.50048628034763
lambda[   5] =  -0.36092529480047
lambda[   6] =  -0.36092522722180
lambda[   7] =  -0.32980214799063
lambda[   8] =  -0.27776644198925
lambda[   9] =  -0.27776640406261
lambda[  10] =  -0.08673671710682
lambda[  11] =  -0.08673642777505
lambda[  12] =  -0.01615669634352
lambda[  13] =   0.01829257011020
lambda[  14] =   0.03378116637799
lambda[  15] =   0.03595264430925
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.172 ms
rank =  0, subspace rotation using ScaLAPACK took 3.442 ms
rank =  0, Distributing orbital back into band + domain format took 12.714 ms
rank = 0, Subspace_Rotation used 16.174 ms

Total time for subspace rotation: 16.179 ms
rank = 0, Efermi =  -0.117690099412 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.018 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.191 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.250 ms
rank = 0, Calculating density took 1265.687 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.524 ms
rank = 0, D2D took 0.627 ms
rank = 0, Transfering density took 0.631 ms
Etot    =   -28.926839653862
Eband   =    -8.619804252075
E1      =    19.831696400874
E2      =    -8.007036808066
E3      =   -10.561957858597
Exc     =    -9.634605354228
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 3.199e-07, dEband = 1.372e-04
rank = 0, Calculating/Estimating energy took 0.908 ms, Etot = -28.926839654, dEtot = 3.199e-07, dEband = 1.372e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0366968625243, which took 0.055 ms

iter_count = 108, r_2norm = 9.056e-07, tol*||rhs|| = 1.468e-06

Anderson update took 57.123 ms, out of which F'*F took 26.295 ms; b-Ax took 181.067 ms, out of which Lap took 162.215 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.677 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517360, int_b + int_rho = -1.073e-12, checking this took 0.099 ms
2-norm of RHS = 531.2471600560665, which took 0.100 ms

iter_count = 150, r_2norm = 4.864e-04, tol*||rhs|| = 5.312e-04

Anderson update took 80.108 ms, out of which F'*F took 37.869 ms; b-Ax took 256.632 ms, out of which Lap took 230.490 ms
Solving Poisson took 540.074 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.125361 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.904 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.128166 
Total time for convolution: 	 convolve: 6.444673 
Total time for convolution: 	 convolve: 5.143625 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.829 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.927 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.401 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.350 ms

This SCF took 28087.366 ms, scf error = 1.867e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.135953, lowerbound = -0.847839, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1216.101 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.030 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.319 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.135 ms
rank =  0, Distribute data + matrix mult took 15.501 ms
rank =  0, finding HY took 19.558 ms
rank =  0, distributing HY into block cyclic form took 11.984 ms
rank =  0, finding Y'*HY took 4.239 ms
Rank 0, Project_Hamiltonian used 51.316 ms
Total time for projection: 51.330 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.847524502618691
    last  calculated eigval = 0.037208417216318
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84752450261869
lambda[   2] =  -0.73521576948260
lambda[   3] =  -0.61857001093701
lambda[   4] =  -0.50023687558561
lambda[   5] =  -0.36062941354248
lambda[   6] =  -0.36062928360515
lambda[   7] =  -0.32951204018061
lambda[   8] =  -0.27748539026730
lambda[   9] =  -0.27748530956409
lambda[  10] =  -0.08647929650254
lambda[  11] =  -0.08647905936263
lambda[  12] =  -0.01505292762535
lambda[  13] =   0.01818231957170
lambda[  14] =   0.03436313534367
lambda[  15] =   0.03720841721632
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 3.484 ms
rank =  0, Distributing orbital back into band + domain format took 11.720 ms
rank = 0, Subspace_Rotation used 15.225 ms

Total time for subspace rotation: 15.231 ms
rank = 0, Efermi =  -0.117432704878 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.280 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.146 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.197 ms
rank = 0, Calculating density took 1289.603 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.581 ms
rank = 0, D2D took 1.106 ms
rank = 0, Transfering density took 1.113 ms
Etot    =   -28.926870751304
Eband   =    -8.614577192014
E1      =    19.828988169000
E2      =    -8.004353948988
E3      =   -10.562476885130
Exc     =    -9.634991447311
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 6.219e-06, dEband = 1.045e-03
rank = 0, Calculating/Estimating energy took 0.931 ms, Etot = -28.926870751, dEtot = 6.219e-06, dEband = 1.045e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0318587764364, which took 0.046 ms

iter_count = 108, r_2norm = 8.325e-07, tol*||rhs|| = 1.274e-06

Anderson update took 57.171 ms, out of which F'*F took 26.462 ms; b-Ax took 181.300 ms, out of which Lap took 162.596 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.035 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517358, int_b + int_rho = -1.091e-12, checking this took 0.114 ms
2-norm of RHS = 531.2477476974118, which took 0.081 ms

iter_count = 96, r_2norm = 5.073e-04, tol*||rhs|| = 5.312e-04

Anderson update took 51.125 ms, out of which F'*F took 24.411 ms; b-Ax took 164.394 ms, out of which Lap took 148.016 ms
Solving Poisson took 347.217 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.178235 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.138702 
Total time for convolution: 	 convolve: 5.123580 
Total time for convolution: 	 convolve: 5.125663 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.007 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.937 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.289 ms

This SCF took 26643.094 ms, scf error = 1.259e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.137208, lowerbound = -0.847525, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1180.781 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.069 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.253 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.072 ms
rank =  0, Distribute data + matrix mult took 15.406 ms
rank =  0, finding HY took 19.486 ms
rank =  0, distributing HY into block cyclic form took 12.086 ms
rank =  0, finding Y'*HY took 4.179 ms
Rank 0, Project_Hamiltonian used 51.189 ms
Total time for projection: 51.201 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.847459700721857
    last  calculated eigval = 0.037069256666626
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84745970072186
lambda[   2] =  -0.73515219127321
lambda[   3] =  -0.61850466507768
lambda[   4] =  -0.50016942878591
lambda[   5] =  -0.36056747625837
lambda[   6] =  -0.36056736681821
lambda[   7] =  -0.32945682591789
lambda[   8] =  -0.27742291826205
lambda[   9] =  -0.27742285568691
lambda[  10] =  -0.08642018680559
lambda[  11] =  -0.08641997726788
lambda[  12] =  -0.01483884500440
lambda[  13] =   0.01813690627521
lambda[  14] =   0.03450021725229
lambda[  15] =   0.03706925666663
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 3.171 ms
rank =  0, Distributing orbital back into band + domain format took 12.055 ms
rank = 0, Subspace_Rotation used 15.244 ms

Total time for subspace rotation: 15.250 ms
rank = 0, Efermi =  -0.117373608796 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.929 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.374 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.153 ms
rank = 0, Calculating density took 1253.988 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.568 ms
rank = 0, D2D took 1.294 ms
rank = 0, Transfering density took 1.300 ms
Etot    =   -28.926871879403
Eband   =    -8.613446858051
E1      =    19.828413737419
E2      =    -8.003767151456
E3      =   -10.562598377858
Exc     =    -9.635083172988
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 2.256e-07, dEband = 2.261e-04
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -28.926871879, dEtot = 2.256e-07, dEband = 2.261e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0290823005551, which took 0.050 ms

iter_count = 108, r_2norm = 7.300e-07, tol*||rhs|| = 1.163e-06

Anderson update took 56.867 ms, out of which F'*F took 26.584 ms; b-Ax took 181.574 ms, out of which Lap took 162.624 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.866 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517357, int_b + int_rho = -1.102e-12, checking this took 0.100 ms
2-norm of RHS = 531.2477483385445, which took 0.110 ms

iter_count = 96, r_2norm = 4.812e-04, tol*||rhs|| = 5.312e-04

Anderson update took 51.251 ms, out of which F'*F took 24.531 ms; b-Ax took 164.407 ms, out of which Lap took 147.877 ms
Solving Poisson took 347.433 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.131567 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.116461 
Total time for convolution: 	 convolve: 5.130232 
Total time for convolution: 	 convolve: 5.120619 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.889 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.937 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.404 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.363 ms

This SCF took 26516.581 ms, scf error = 1.191e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.137069, lowerbound = -0.847460, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1190.655 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.067 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.299 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.406 ms
rank =  0, finding HY took 19.525 ms
rank =  0, distributing HY into block cyclic form took 12.039 ms
rank =  0, finding Y'*HY took 4.444 ms
Rank 0, Project_Hamiltonian used 51.449 ms
Total time for projection: 51.466 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.095 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -0.847381732306981
    last  calculated eigval = 0.037077360349768
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84738173230698
lambda[   2] =  -0.73508615274149
lambda[   3] =  -0.61843562962067
lambda[   4] =  -0.50010427599697
lambda[   5] =  -0.36049802507036
lambda[   6] =  -0.36049793318967
lambda[   7] =  -0.32938590229257
lambda[   8] =  -0.27735671320417
lambda[   9] =  -0.27735665744984
lambda[  10] =  -0.08635661119049
lambda[  11] =  -0.08635644416816
lambda[  12] =  -0.01441122977644
lambda[  13] =   0.01833344575170
lambda[  14] =   0.03477830173871
lambda[  15] =   0.03707736034977
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.172 ms
rank =  0, subspace rotation using ScaLAPACK took 3.523 ms
rank =  0, Distributing orbital back into band + domain format took 12.017 ms
rank = 0, Subspace_Rotation used 15.556 ms

Total time for subspace rotation: 15.562 ms
rank = 0, Efermi =  -0.117310054452 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 3.029 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.404 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.151 ms
rank = 0, Calculating density took 1264.552 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.646 ms
rank = 0, D2D took 0.822 ms
rank = 0, Transfering density took 0.829 ms
Etot    =   -28.926876563917
Eband   =    -8.612206044192
E1      =    19.827777227057
E2      =    -8.003131370047
E3      =   -10.562714596210
Exc     =    -9.635172597942
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 9.369e-07, dEband = 2.482e-04
rank = 0, Calculating/Estimating energy took 0.947 ms, Etot = -28.926876564, dEtot = 9.369e-07, dEband = 2.482e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0243266355315, which took 0.072 ms

iter_count = 108, r_2norm = 6.882e-07, tol*||rhs|| = 9.731e-07

Anderson update took 57.107 ms, out of which F'*F took 26.508 ms; b-Ax took 180.411 ms, out of which Lap took 161.703 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.333 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517358, int_b + int_rho = -1.099e-12, checking this took 0.113 ms
2-norm of RHS = 531.2489307799259, which took 0.108 ms

iter_count = 96, r_2norm = 4.919e-04, tol*||rhs|| = 5.312e-04

Anderson update took 51.375 ms, out of which F'*F took 24.694 ms; b-Ax took 163.478 ms, out of which Lap took 147.492 ms
Solving Poisson took 346.358 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.085391 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.120092 
Total time for convolution: 	 convolve: 5.125288 
Total time for convolution: 	 convolve: 5.123758 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.137 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.925 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.336 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.285 ms

This SCF took 26487.066 ms, scf error = 1.088e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.137077, lowerbound = -0.847382, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1198.584 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.043 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.285 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.153 ms
rank =  0, Distribute data + matrix mult took 15.494 ms
rank =  0, finding HY took 19.437 ms
rank =  0, distributing HY into block cyclic form took 12.022 ms
rank =  0, finding Y'*HY took 4.190 ms
Rank 0, Project_Hamiltonian used 51.175 ms
Total time for projection: 51.188 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -0.847360422847030
    last  calculated eigval = 0.037219270015308
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84736042284703
lambda[   2] =  -0.73505738196644
lambda[   3] =  -0.61840670331001
lambda[   4] =  -0.50006197601466
lambda[   5] =  -0.36046967845025
lambda[   6] =  -0.36046961173079
lambda[   7] =  -0.32936420280734
lambda[   8] =  -0.27732617438857
lambda[   9] =  -0.27732613568265
lambda[  10] =  -0.08632535496829
lambda[  11] =  -0.08632522143429
lambda[  12] =  -0.01387898241709
lambda[  13] =   0.01859154998270
lambda[  14] =   0.03522285094654
lambda[  15] =   0.03721927001531
==subpsace eigenproblem: bcast eigvals took 0.040 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 3.553 ms
rank =  0, Distributing orbital back into band + domain format took 12.005 ms
rank = 0, Subspace_Rotation used 15.571 ms

Total time for subspace rotation: 15.577 ms
rank = 0, Efermi =  -0.117278814926 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 3.133 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.216 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.157 ms
rank = 0, Calculating density took 1272.175 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.628 ms
rank = 0, D2D took 0.810 ms
rank = 0, Transfering density took 0.813 ms
Etot    =   -28.926874414452
Eband   =    -8.611684574842
E1      =    19.827603228659
E2      =    -8.002790949211
E3      =   -10.562704830636
Exc     =    -9.635167733020
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 4.299e-07, dEband = 1.043e-04
rank = 0, Calculating/Estimating energy took 0.974 ms, Etot = -28.926874414, dEtot = 4.299e-07, dEband = 1.043e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0206989682115, which took 0.051 ms

iter_count = 108, r_2norm = 5.932e-07, tol*||rhs|| = 8.280e-07

Anderson update took 60.392 ms, out of which F'*F took 26.789 ms; b-Ax took 183.699 ms, out of which Lap took 165.303 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 401.141 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517356, int_b + int_rho = -1.113e-12, checking this took 0.118 ms
2-norm of RHS = 531.2516635490020, which took 0.067 ms

iter_count = 114, r_2norm = 5.045e-04, tol*||rhs|| = 5.313e-04

Anderson update took 60.912 ms, out of which F'*F took 29.266 ms; b-Ax took 196.079 ms, out of which Lap took 175.868 ms
Solving Poisson took 412.456 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.924 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.113174 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.101003 
Total time for convolution: 	 convolve: 5.115294 
Total time for convolution: 	 convolve: 5.115366 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.886 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.935 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.326 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.295 ms

This SCF took 26578.711 ms, scf error = 1.203e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.137219, lowerbound = -0.847360, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1217.038 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.079 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.351 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.451 ms
rank =  0, finding HY took 19.476 ms
rank =  0, distributing HY into block cyclic form took 11.989 ms
rank =  0, finding Y'*HY took 4.230 ms
Rank 0, Project_Hamiltonian used 51.179 ms
Total time for projection: 51.191 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -0.847480836730637
    last  calculated eigval = 0.036064519478203
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84748083673064
lambda[   2] =  -0.73516019031210
lambda[   3] =  -0.61850851168945
lambda[   4] =  -0.50013433854284
lambda[   5] =  -0.36056819788718
lambda[   6] =  -0.36056817809994
lambda[   7] =  -0.32947257138726
lambda[   8] =  -0.27741793054296
lambda[   9] =  -0.27741789982456
lambda[  10] =  -0.08641264385350
lambda[  11] =  -0.08641254223920
lambda[  12] =  -0.01475723249194
lambda[  13] =   0.01821185927295
lambda[  14] =   0.03449393044346
lambda[  15] =   0.03606451947820
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 3.503 ms
rank =  0, Distributing orbital back into band + domain format took 12.006 ms
rank = 0, Subspace_Rotation used 15.525 ms

Total time for subspace rotation: 15.530 ms
rank = 0, Efermi =  -0.117366119596 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.128 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.262 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.155 ms
rank = 0, Calculating density took 1290.580 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.599 ms
rank = 0, D2D took 0.782 ms
rank = 0, Transfering density took 0.786 ms
Etot    =   -28.926875449506
Eband   =    -8.613457310481
E1      =    19.828709329039
E2      =    -8.003524327404
E3      =   -10.562394685821
Exc     =    -9.634925366191
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 2.070e-07, dEband = 3.545e-04
rank = 0, Calculating/Estimating energy took 1.057 ms, Etot = -28.926875450, dEtot = 2.070e-07, dEband = 3.545e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0217511273410, which took 0.051 ms

iter_count = 108, r_2norm = 6.102e-07, tol*||rhs|| = 8.700e-07

Anderson update took 57.029 ms, out of which F'*F took 26.645 ms; b-Ax took 181.442 ms, out of which Lap took 162.633 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.804 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517360, int_b + int_rho = -1.070e-12, checking this took 0.123 ms
2-norm of RHS = 531.2453871103248, which took 0.653 ms

iter_count = 132, r_2norm = 5.205e-04, tol*||rhs|| = 5.312e-04

Anderson update took 70.315 ms, out of which F'*F took 33.688 ms; b-Ax took 226.208 ms, out of which Lap took 203.452 ms
Solving Poisson took 476.640 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.121962 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.149430 
Total time for convolution: 	 convolve: 5.162545 
Total time for convolution: 	 convolve: 5.154475 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.828 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 0.946 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.349 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.317 ms

This SCF took 26768.396 ms, scf error = 1.770e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.136065, lowerbound = -0.847481, upperbound = 267.574139

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1193.996 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.043 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.361 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.426 ms
rank =  0, finding HY took 19.449 ms
rank =  0, distributing HY into block cyclic form took 11.996 ms
rank =  0, finding Y'*HY took 4.272 ms
Rank 0, Project_Hamiltonian used 51.178 ms
Total time for projection: 51.193 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.847251852377776
    last  calculated eigval = 0.034936748871589
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84725185237778
lambda[   2] =  -0.73497170063451
lambda[   3] =  -0.61831643311113
lambda[   4] =  -0.50000350102911
lambda[   5] =  -0.36038559859799
lambda[   6] =  -0.36038553566883
lambda[   7] =  -0.32928057599837
lambda[   8] =  -0.27725125994586
lambda[   9] =  -0.27725119830216
lambda[  10] =  -0.08626545882967
lambda[  11] =  -0.08626537127444
lambda[  12] =  -0.01568275862075
lambda[  13] =   0.01768142521582
lambda[  14] =   0.03366509831256
lambda[  15] =   0.03493674887159
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 3.561 ms
rank =  0, Distributing orbital back into band + domain format took 11.984 ms
rank = 0, Subspace_Rotation used 15.559 ms

Total time for subspace rotation: 15.564 ms
rank = 0, Efermi =  -0.117218941784 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.245 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.060 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.161 ms
rank = 0, Calculating density took 1267.524 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.526 ms
rank = 0, D2D took 0.622 ms
rank = 0, Transfering density took 0.624 ms
Etot    =   -28.926881953824
Eband   =    -8.610195311778
E1      =    19.826563122031
E2      =    -8.002263036510
E3      =   -10.563019764564
Exc     =    -9.635411450055
Esc     =   -49.073121114933
Entropy =    -0.000000000164
dE = 1.301e-06, dEband = 6.524e-04
rank = 0, Calculating/Estimating energy took 10.905 ms, Etot = -28.926881954, dEtot = 1.301e-06, dEband = 6.524e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0150485532487, which took 0.087 ms

iter_count = 108, r_2norm = 4.170e-07, tol*||rhs|| = 6.019e-07

Anderson update took 57.226 ms, out of which F'*F took 26.643 ms; b-Ax took 181.201 ms, out of which Lap took 162.596 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.401 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000517467, int_rho =  18.00000000517356, int_b + int_rho = -1.113e-12, checking this took 0.108 ms
2-norm of RHS = 531.2459375444312, which took 0.108 ms

iter_count = 132, r_2norm = 5.071e-04, tol*||rhs|| = 5.312e-04

Anderson update took 70.920 ms, out of which F'*F took 33.721 ms; b-Ax took 225.406 ms, out of which Lap took 203.136 ms
Solving Poisson took 475.523 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.085574 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.290 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.096682 
Total time for convolution: 	 convolve: 5.094055 
Total time for convolution: 	 convolve: 5.121892 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.776 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.566 ms
---Transfer Veff_loc: D2D took 0.932 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.327 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.282 ms

This SCF took 26563.670 ms, scf error = 7.862e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.84725185237778, occ[   1] =   2.00000000000000
lambda[   2] =  -0.73497170063451, occ[   2] =   2.00000000000000
lambda[   3] =  -0.61831643311113, occ[   3] =   2.00000000000000
lambda[   4] =  -0.50000350102911, occ[   4] =   2.00000000000000
lambda[   5] =  -0.36038559859799, occ[   5] =   2.00000000000000
lambda[   6] =  -0.36038553566883, occ[   6] =   2.00000000000000
lambda[   7] =  -0.32928057599837, occ[   7] =   2.00000000000000
lambda[   8] =  -0.27725125994586, occ[   8] =   2.00000000000000
lambda[   9] =  -0.27725119830216, occ[   9] =   2.00000000000000
lambda[  10] =  -0.08626545882967, occ[  10] =   0.00000000258692
lambda[  11] =  -0.08626537127444, occ[  11] =   0.00000000258666
lambda[  12] =  -0.01568275862075, occ[  12] =   0.00000000000000
lambda[  13] =   0.01768142521582, occ[  13] =   0.00000000000000
lambda[  14] =   0.03366509831256, occ[  14] =   0.00000000000000
lambda[  15] =   0.03493674887159, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.588 ms, time for Allreduce/Reduce: 6.205 ms 
Time for calculating local force components: 15.689 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000003915889  -0.00000001076852   0.05637271441882
  0.00000019165943   0.00000016809086  -0.09692786882684
  0.00000021806634  -0.00000105928339   0.12413304668681
 -0.00000067937772  -0.00000057933300   0.02727383413662
 -0.00000016363570   0.00000017499413  -0.95248012063955
force_loc = 
  0.00000001308226   0.00000006059317  -0.06033900537172
  0.00000086474734   0.00000126312451   0.05859107741982
  0.00000003256561   0.00000051857147  -0.09116079592350
 -0.00000057579513   0.00000110556258  -0.05256410264697
 -0.00000021572042  -0.00000077170080   0.95726905197971
Time for calculating nonlocal force components: 26.721 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000005402410   0.00000006986451   0.01877755822549
[0m[32m -0.00000000296305   0.00000002060190  -0.01495571684150
[0m[32m -0.00000003275841   0.00000006449885   0.01143687198022
[0m[32m -0.00000001370507  -0.00000006420472   0.01453399085224
[0mTime for calculating XC forces components: 19.390 ms
 Cartesian force = 
  0.00000010637146  -0.00000014229766  -0.00395839804282
  0.00000116456118   0.00000130895757  -0.01955134027146
  0.00000030179920  -0.00000071223233   0.01802442683188
 -0.00000123380096   0.00000039860612  -0.01384550362006
 -0.00000033893088  -0.00000085303371   0.01933081510247
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.010 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.195 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Time for printing density: 388.552 ms
The program took 600.010 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:07
Job ID:        2266551
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:03:00,vmem=8452K,walltime=00:10:15,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-22-2
---------------------------------------
