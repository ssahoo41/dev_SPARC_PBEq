---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:42
Job ID:    2266447
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:46
Job ID:    2266447
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.055 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 0.810 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 11.
[32m
Time for finding element is 0.012 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 0.754 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 9.981 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.973 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.081 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    7.220158	   11.678129	   10.000000	
   10.329353	    8.771978	   10.000000	
   10.829369	   14.951246	   10.000000	
   12.779842	   12.750386	   11.664046	
   12.779842	   12.750386	    8.335954	
    9.463543	    5.048754	   10.000000	
    7.241261	    6.981882	   11.677276	
    7.241261	    6.981882	    8.322724	
   11.588485	   13.038138	   10.000000	
    9.437912	   11.163691	   10.000000	
    8.437820	    6.835295	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.163 ms
Set up communicators.

--set up spincomm took 3.904 ms

--set up kptcomm took 0.345 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 23, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 23 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 23, mbQ = nbQ = 64
rank = 0, nr_Hp = 23, nc_Hp = 23
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.061 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.633 ms

Calculate_SplineDerivRadFun took 0.218 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.796 ms.
time spent on vectorized spline interp: 3.139 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.720 ms.
time spent on vectorized spline interp: 1.381 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.287 ms.
time spent on vectorized spline interp: 1.676 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.541 ms.

Calculating rb for all atom types took 15.549 ms
----------------------
Estimated memory usage
Total: 1.36 GB
orbitals             : 1.03 GB
global sized vectors : 213.62 MB
subspace matrices : 12.40 kB
others : 126.65 MB
----------------------------------------------
Estimated memory usage per processor: 116.10 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.058 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -30.0000000316714, sum_int_rho = 29.3962580758092
PosCharge = 30.000000031671, NegCharge = -29.396258075809, scal_fac = 1.020538054684
After scaling, int_rho = 30.0000000316715, PosCharge + NegCharge - NetCharge = -9.237e-14
--Calculate Vref took 0.622 ms
--Calculate rho_guess took 3.392 ms

 integral of b = -30.0000000316714,
 int{b} + Nelectron + NetCharge = -3.167e-08,
 Esc = -87.8054861381797,
 MPI_Reduce took 11.261 ms

Calculating b & b_ref took 23.066 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.116 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.128 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.108 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.733 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.464 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167147, int_b + int_rho = 2.547e-14, checking this took 0.515 ms
2-norm of RHS = 804.7971990300190, which took 0.453 ms

iter_count = 420, r_2norm = 6.559e-04, tol*||rhs|| = 8.048e-04

Anderson update took 233.114 ms, out of which F'*F took 106.917 ms; b-Ax took 716.802 ms, out of which Lap took 643.044 ms
Solving Poisson took 1514.710 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
Total time for convolution: 	 convolve: 5.124029 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.009 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
Total time for convolution: 	 convolve: 5.157355 
Total time for convolution: 	 convolve: 5.185731 
Total time for convolution: 	 convolve: 5.126197 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.724 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.898 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.430 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
rank = 0, XC calculation took 24488.644 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 4.978 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.246 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.337 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.148 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.668 ms
    Lanczos iter 53, eigmin  = -1.038743171, eigmax = 264.934788802, err_eigmin = 1.644e-03, err_eigmax = 9.657e-03
rank =   0, Lanczos took 121.064 ms, eigmin = -1.038743170526, eigmax = 267.584136690393

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.222697, lowerbound = -1.138743, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1589.359 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 21.197 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.220 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.439 ms
rank =  0, finding HY took 26.884 ms
rank =  0, distributing HY into block cyclic form took 21.475 ms
rank =  0, finding Y'*HY took 5.053 ms
Rank 0, Project_Hamiltonian used 78.813 ms
Total time for projection: 78.827 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.813 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.916 ms
    first calculated eigval = 2.695155461901784
    last  calculated eigval = 3.279317307108654
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =   2.85798860432539
lambda[   7] =   2.87387490526678
lambda[   8] =   2.90387517516961
lambda[   9] =   2.93989831820134
lambda[  10] =   2.96309447431779
lambda[  11] =   2.97905024275041
lambda[  12] =   2.98983370561054
lambda[  13] =   2.99738246461060
lambda[  14] =   3.02227225203281
lambda[  15] =   3.05674695071314
lambda[  16] =   3.07937140482702
lambda[  17] =   3.09684949917005
lambda[  18] =   3.13725087905520
lambda[  19] =   3.15261205404927
lambda[  20] =   3.16384158790492
lambda[  21] =   3.16924740969550
lambda[  22] =   3.21785602259093
lambda[  23] =   3.27931730710865
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.933 ms
rank =  0, subspace rotation using ScaLAPACK took 8.602 ms
rank =  0, Distributing orbital back into band + domain format took 20.546 ms
rank = 0, Subspace_Rotation used 29.167 ms

Total time for subspace rotation: 29.171 ms
rank = 0, Efermi =   3.068059177818 calculate fermi energy took 0.056 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.379317, lowerbound = -1.138743, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1572.919 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.011 ms
rank =  0, Distribute orbital to block cyclic format took 19.612 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.162 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.796 ms
rank =  0, finding HY took 27.018 ms
rank =  0, distributing HY into block cyclic form took 19.705 ms
rank =  0, finding Y'*HY took 4.848 ms
Rank 0, Project_Hamiltonian used 74.410 ms
Total time for projection: 74.414 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.165 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.265 ms
    first calculated eigval = -0.915044850735230
    last  calculated eigval = 0.457260928500755
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.21124483340005
lambda[   7] =  -0.17501922004372
lambda[   8] =  -0.09206067107236
lambda[   9] =  -0.07497618973254
lambda[  10] =  -0.00587317216347
lambda[  11] =   0.06932089202489
lambda[  12] =   0.15805550227083
lambda[  13] =   0.18217461683361
lambda[  14] =   0.24021749307868
lambda[  15] =   0.29939781976198
lambda[  16] =   0.32281074281508
lambda[  17] =   0.33436488416704
lambda[  18] =   0.34904261919372
lambda[  19] =   0.37012699214651
lambda[  20] =   0.38979868390543
lambda[  21] =   0.40867049744421
lambda[  22] =   0.44682523920603
lambda[  23] =   0.45726092850076
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.274 ms
rank =  0, subspace rotation using ScaLAPACK took 8.559 ms
rank =  0, Distributing orbital back into band + domain format took 20.471 ms
rank = 0, Subspace_Rotation used 29.050 ms

Total time for subspace rotation: 29.055 ms
rank = 0, Efermi =   0.311103969096 calculate fermi energy took 0.025 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.557261, lowerbound = -1.138743, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1565.073 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 19.618 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.109 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.745 ms
rank =  0, finding HY took 26.899 ms
rank =  0, distributing HY into block cyclic form took 19.696 ms
rank =  0, finding Y'*HY took 4.796 ms
Rank 0, Project_Hamiltonian used 74.160 ms
Total time for projection: 74.164 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.141 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -1.049526969387732
    last  calculated eigval = 0.166021776002962
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.51854449021761
lambda[   7] =  -0.49608730152921
lambda[   8] =  -0.49357979112623
lambda[   9] =  -0.46207619944394
lambda[  10] =  -0.45899420300693
lambda[  11] =  -0.40555947180809
lambda[  12] =  -0.37245045668016
lambda[  13] =  -0.35717008473999
lambda[  14] =  -0.28650996229092
lambda[  15] =  -0.26518019163166
lambda[  16] =   0.04965142207970
lambda[  17] =   0.07141495696986
lambda[  18] =   0.08277775896919
lambda[  19] =   0.09272914816566
lambda[  20] =   0.10033984102991
lambda[  21] =   0.11489110625977
lambda[  22] =   0.14505032466577
lambda[  23] =   0.16602177600296
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 8.561 ms
rank =  0, Distributing orbital back into band + domain format took 20.301 ms
rank = 0, Subspace_Rotation used 28.876 ms

Total time for subspace rotation: 28.881 ms
rank = 0, Efermi =   0.020901181632 calculate fermi energy took 0.024 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.266022, lowerbound = -1.138743, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1537.318 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 22.372 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.131 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.519 ms
rank =  0, finding HY took 26.879 ms
rank =  0, distributing HY into block cyclic form took 19.659 ms
rank =  0, finding Y'*HY took 4.790 ms
Rank 0, Project_Hamiltonian used 76.871 ms
Total time for projection: 76.874 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.139 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.238 ms
    first calculated eigval = -1.049765214295643
    last  calculated eigval = 0.101182069667929
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.52366910612909
lambda[   7] =  -0.50230108669767
lambda[   8] =  -0.50092813918065
lambda[   9] =  -0.48239106742348
lambda[  10] =  -0.46403093090466
lambda[  11] =  -0.44643522763614
lambda[  12] =  -0.38792187797982
lambda[  13] =  -0.37647166692878
lambda[  14] =  -0.30717039252792
lambda[  15] =  -0.29756418808347
lambda[  16] =  -0.01769328234509
lambda[  17] =   0.01980907276839
lambda[  18] =   0.03665623037395
lambda[  19] =   0.04199535778040
lambda[  20] =   0.05369893771306
lambda[  21] =   0.06663565676872
lambda[  22] =   0.08560584666815
lambda[  23] =   0.10118206966793
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 8.794 ms
rank =  0, Distributing orbital back into band + domain format took 20.604 ms
rank = 0, Subspace_Rotation used 29.422 ms

Total time for subspace rotation: 29.428 ms
rank = 0, Efermi =  -0.046443522850 calculate fermi energy took 0.024 ms
rank = 0, --- Calculate rho: sum over local bands took 5.355 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.084 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.598 ms
rank = 0, Calculating density took 6828.715 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.818 ms
rank = 0, D2D took 1.920 ms
rank = 0, Transfering density took 1.925 ms
Etot    =   -54.861352998755
Eband   =   -16.845498033755
E1      =    33.791622941890
E2      =   -14.008371916651
E3      =   -18.326978288913
Exc     =   -16.337341973335
Esc     =   -87.805486138180
Entropy =    -0.000000000939
dE = 4.987e+00, dEband = 1.531e+00
rank = 0, Calculating/Estimating energy took 0.908 ms, Etot = -54.861352999, dEtot = 4.987e+00, dEband = 1.531e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 63.8319809325675, which took 0.380 ms

iter_count = 96, r_2norm = 1.605e-03, tol*||rhs|| = 2.553e-03

Anderson update took 51.295 ms, out of which F'*F took 24.068 ms; b-Ax took 162.550 ms, out of which Lap took 145.097 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.213 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167154, int_b + int_rho = 1.019e-13, checking this took 0.109 ms
2-norm of RHS = 800.4749105327252, which took 0.900 ms

iter_count = 276, r_2norm = 7.849e-04, tol*||rhs|| = 8.005e-04

Anderson update took 147.683 ms, out of which F'*F took 68.179 ms; b-Ax took 468.092 ms, out of which Lap took 413.873 ms
Solving Poisson took 991.895 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.197366 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 57.152 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.206956 
Total time for convolution: 	 convolve: 5.250190 
Total time for convolution: 	 convolve: 5.201981 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.200 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 3.541 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.899 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.472 ms

This SCF took 33319.867 ms, scf error = 1.570e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.201182, lowerbound = -1.049765, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1554.140 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 33.150 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.016 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 36.183 ms
rank =  0, finding HY took 27.132 ms
rank =  0, distributing HY into block cyclic form took 20.033 ms
rank =  0, finding Y'*HY took 5.565 ms
Rank 0, Project_Hamiltonian used 88.947 ms
Total time for projection: 88.963 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.149 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.251 ms
    first calculated eigval = -1.040941602188732
    last  calculated eigval = 0.073970925828271
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.50030765010947
lambda[   7] =  -0.48082375748203
lambda[   8] =  -0.47256683636972
lambda[   9] =  -0.45171174608290
lambda[  10] =  -0.43249615184185
lambda[  11] =  -0.42135534716014
lambda[  12] =  -0.37042577279551
lambda[  13] =  -0.35864360829930
lambda[  14] =  -0.29461948766043
lambda[  15] =  -0.26878979338704
lambda[  16] =  -0.03945419092606
lambda[  17] =  -0.01084862497666
lambda[  18] =   0.01622267735857
lambda[  19] =   0.02463992158836
lambda[  20] =   0.02959080177420
lambda[  21] =   0.03971980884276
lambda[  22] =   0.06402818537917
lambda[  23] =   0.07397092582827
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.264 ms
rank =  0, subspace rotation using ScaLAPACK took 9.251 ms
rank =  0, Distributing orbital back into band + domain format took 19.732 ms
rank = 0, Subspace_Rotation used 29.002 ms

Total time for subspace rotation: 29.010 ms
rank = 0, Efermi =  -0.068204431344 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.447 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.022 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.573 ms
rank = 0, Calculating density took 1689.949 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.806 ms
rank = 0, D2D took 1.908 ms
rank = 0, Transfering density took 1.910 ms
Etot    =   -54.787589458239
Eband   =   -16.168588939516
E1      =    33.181043256978
E2      =   -13.974204716140
E3      =   -18.538366363709
Exc     =   -16.507128716431
Esc     =   -87.805486138180
Entropy =    -0.000000000939
dE = 6.706e-03, dEband = 6.154e-02
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -54.787589458, dEtot = 6.706e-03, dEband = 6.154e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 31.6488360677782, which took 0.058 ms

iter_count = 96, r_2norm = 1.101e-03, tol*||rhs|| = 1.266e-03

Anderson update took 51.333 ms, out of which F'*F took 24.083 ms; b-Ax took 162.239 ms, out of which Lap took 145.053 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.824 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167154, int_b + int_rho = 1.019e-13, checking this took 0.102 ms
2-norm of RHS = 795.9074578236003, which took 0.104 ms

iter_count = 288, r_2norm = 7.457e-04, tol*||rhs|| = 7.959e-04

Anderson update took 154.754 ms, out of which F'*F took 72.158 ms; b-Ax took 499.258 ms, out of which Lap took 445.735 ms
Solving Poisson took 1046.571 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.185169 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.489 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.184302 
Total time for convolution: 	 convolve: 5.182883 
Total time for convolution: 	 convolve: 5.183547 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 160.531 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 3.508 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.928 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.468 ms

This SCF took 28393.256 ms, scf error = 1.042e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.173971, lowerbound = -1.040942, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1565.119 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.686 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.517 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.218 ms
rank =  0, finding HY took 26.990 ms
rank =  0, distributing HY into block cyclic form took 22.722 ms
rank =  0, finding Y'*HY took 5.054 ms
Rank 0, Project_Hamiltonian used 78.019 ms
Total time for projection: 78.031 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.139 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.923 ms
    first calculated eigval = -1.028516420612077
    last  calculated eigval = 0.067874474499956
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46704444428815
lambda[   7] =  -0.45364249427166
lambda[   8] =  -0.43987995020748
lambda[   9] =  -0.40867328126075
lambda[  10] =  -0.39400326802776
lambda[  11] =  -0.38233698746991
lambda[  12] =  -0.34586347321323
lambda[  13] =  -0.32977025102602
lambda[  14] =  -0.27590870801068
lambda[  15] =  -0.24230810856511
lambda[  16] =  -0.03841385723326
lambda[  17] =  -0.02247946866109
lambda[  18] =   0.00768960130837
lambda[  19] =   0.01986838442224
lambda[  20] =   0.02500205248596
lambda[  21] =   0.02871889039680
lambda[  22] =   0.05460285791637
lambda[  23] =   0.06787447449996
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.951 ms
rank =  0, subspace rotation using ScaLAPACK took 8.771 ms
rank =  0, Distributing orbital back into band + domain format took 19.825 ms
rank = 0, Subspace_Rotation used 28.614 ms

Total time for subspace rotation: 28.623 ms
rank = 0, Efermi =  -0.067164097669 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.380 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.273 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.570 ms
rank = 0, Calculating density took 1690.577 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.852 ms
rank = 0, D2D took 1.956 ms
rank = 0, Transfering density took 1.961 ms
Etot    =   -54.740855962833
Eband   =   -15.254946950645
E1      =    32.380512574739
E2      =   -13.844787402738
E3      =   -18.857203877468
Exc     =   -16.762926728014
Esc     =   -87.805486138180
Entropy =    -0.000000000939
dE = 4.248e-03, dEband = 8.306e-02
rank = 0, Calculating/Estimating energy took 0.927 ms, Etot = -54.740855963, dEtot = 4.248e-03, dEband = 8.306e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 8.7193471292801, which took 0.092 ms

iter_count = 102, r_2norm = 2.503e-04, tol*||rhs|| = 3.488e-04

Anderson update took 54.060 ms, out of which F'*F took 25.290 ms; b-Ax took 172.647 ms, out of which Lap took 154.414 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 372.830 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167154, int_b + int_rho = 1.019e-13, checking this took 0.104 ms
2-norm of RHS = 795.1442988752561, which took 0.091 ms

iter_count = 276, r_2norm = 6.967e-04, tol*||rhs|| = 7.951e-04

Anderson update took 146.698 ms, out of which F'*F took 68.683 ms; b-Ax took 471.883 ms, out of which Lap took 420.306 ms
Solving Poisson took 990.481 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.191319 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.263 ms
Total time for convolution: 	 convolve: 5.179071 
Total time for convolution: 	 convolve: 5.199541 
Total time for convolution: 	 convolve: 5.179955 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 3.525 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.075 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.631 ms

This SCF took 28220.772 ms, scf error = 4.416e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.167874, lowerbound = -1.028516, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1556.264 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.681 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.079 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.779 ms
rank =  0, finding HY took 26.479 ms
rank =  0, distributing HY into block cyclic form took 19.661 ms
rank =  0, finding Y'*HY took 4.805 ms
Rank 0, Project_Hamiltonian used 74.698 ms
Total time for projection: 74.711 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.235 ms
    first calculated eigval = -1.020745739007615
    last  calculated eigval = 0.064922754703445
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45105719697737
lambda[   7] =  -0.44144616335782
lambda[   8] =  -0.42941530330789
lambda[   9] =  -0.39007334493818
lambda[  10] =  -0.37848645317914
lambda[  11] =  -0.36314301186176
lambda[  12] =  -0.33418043549069
lambda[  13] =  -0.31660657283804
lambda[  14] =  -0.26863972750793
lambda[  15] =  -0.23680631659659
lambda[  16] =  -0.03370540409018
lambda[  17] =  -0.02707999734970
lambda[  18] =   0.00484425296614
lambda[  19] =   0.01722975412705
lambda[  20] =   0.01923434254206
lambda[  21] =   0.02736884472841
lambda[  22] =   0.04881171738226
lambda[  23] =   0.06492275470345
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.248 ms
rank =  0, subspace rotation using ScaLAPACK took 8.775 ms
rank =  0, Distributing orbital back into band + domain format took 20.047 ms
rank = 0, Subspace_Rotation used 28.839 ms

Total time for subspace rotation: 28.843 ms
rank = 0, Efermi =  -0.062455931778 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.416 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.098 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.636 ms
rank = 0, Calculating density took 1678.346 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.013 ms
rank = 0, D2D took 2.131 ms
rank = 0, Transfering density took 2.137 ms
Etot    =   -54.732455654625
Eband   =   -14.863706625389
E1      =    32.076587353914
E2      =   -13.733670623693
E3      =   -19.008959829093
Exc     =   -16.882480696818
Esc     =   -87.805486138180
Entropy =    -0.000000000939
dE = 7.637e-04, dEband = 3.557e-02
rank = 0, Calculating/Estimating energy took 0.892 ms, Etot = -54.732455655, dEtot = 7.637e-04, dEband = 3.557e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.7614298573280, which took 0.100 ms

iter_count = 108, r_2norm = 8.561e-05, tol*||rhs|| = 1.105e-04

Anderson update took 57.366 ms, out of which F'*F took 27.111 ms; b-Ax took 182.601 ms, out of which Lap took 164.154 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.072 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167141, int_b + int_rho = -3.274e-14, checking this took 0.108 ms
2-norm of RHS = 795.4082628222393, which took 0.115 ms

iter_count = 252, r_2norm = 7.089e-04, tol*||rhs|| = 7.954e-04

Anderson update took 134.280 ms, out of which F'*F took 63.089 ms; b-Ax took 430.088 ms, out of which Lap took 384.606 ms
Solving Poisson took 903.786 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.117 ms
Total time for convolution: 	 convolve: 5.190747 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.187453 
Total time for convolution: 	 convolve: 5.211236 
Total time for convolution: 	 convolve: 5.214255 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.182 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 3.544 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.504 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.085 ms

This SCF took 27956.814 ms, scf error = 1.509e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.164923, lowerbound = -1.020746, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1567.043 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.616 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.205 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.839 ms
rank =  0, finding HY took 26.669 ms
rank =  0, distributing HY into block cyclic form took 19.652 ms
rank =  0, finding Y'*HY took 4.904 ms
Rank 0, Project_Hamiltonian used 74.094 ms
Total time for projection: 74.106 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.148 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.234 ms
    first calculated eigval = -1.016719976301759
    last  calculated eigval = 0.062543215159782
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44562353183514
lambda[   7] =  -0.43729652194537
lambda[   8] =  -0.42403827455665
lambda[   9] =  -0.38470474700486
lambda[  10] =  -0.37238247500724
lambda[  11] =  -0.35756819699377
lambda[  12] =  -0.32880655423842
lambda[  13] =  -0.31228590965398
lambda[  14] =  -0.26502276965781
lambda[  15] =  -0.23116788046216
lambda[  16] =  -0.03107385738011
lambda[  17] =  -0.02799632000456
lambda[  18] =   0.00416045740766
lambda[  19] =   0.01585843019766
lambda[  20] =   0.01761720573568
lambda[  21] =   0.02546201783514
lambda[  22] =   0.04519001154662
lambda[  23] =   0.06254321515978
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 8.723 ms
rank =  0, Distributing orbital back into band + domain format took 20.032 ms
rank = 0, Subspace_Rotation used 28.770 ms

Total time for subspace rotation: 28.775 ms
rank = 0, Efermi =  -0.059849887018 calculate fermi energy took 0.871 ms
rank = 0, --- Calculate rho: sum over local bands took 5.472 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.801 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.562 ms
rank = 0, Calculating density took 1688.347 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.815 ms
rank = 0, D2D took 1.917 ms
rank = 0, Transfering density took 1.919 ms
Etot    =   -54.731020392871
Eband   =   -14.713571750169
E1      =    31.987513807899
E2      =   -13.660955607947
E3      =   -19.061330536899
Exc     =   -16.921762456326
Esc     =   -87.805486138180
Entropy =    -0.000000000942
dE = 1.305e-04, dEband = 1.365e-02
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -54.731020393, dEtot = 1.305e-04, dEband = 1.365e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.2174529358368, which took 0.053 ms

iter_count = 108, r_2norm = 4.620e-05, tol*||rhs|| = 4.870e-05

Anderson update took 57.242 ms, out of which F'*F took 27.027 ms; b-Ax took 182.520 ms, out of which Lap took 164.195 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.874 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167158, int_b + int_rho = 1.382e-13, checking this took 0.107 ms
2-norm of RHS = 795.7430808730606, which took 0.109 ms

iter_count = 228, r_2norm = 7.458e-04, tol*||rhs|| = 7.957e-04

Anderson update took 121.866 ms, out of which F'*F took 58.097 ms; b-Ax took 389.604 ms, out of which Lap took 350.214 ms
Solving Poisson took 821.461 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.273702 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.227553 
Total time for convolution: 	 convolve: 5.214688 
Total time for convolution: 	 convolve: 5.197830 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 4.601 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.237 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.873 ms

This SCF took 27823.295 ms, scf error = 5.669e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.162543, lowerbound = -1.016720, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1571.568 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 19.938 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.165 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.120 ms
rank =  0, finding HY took 26.703 ms
rank =  0, distributing HY into block cyclic form took 19.697 ms
rank =  0, finding Y'*HY took 4.810 ms
Rank 0, Project_Hamiltonian used 74.362 ms
Total time for projection: 74.376 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.139 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -1.014552599595697
    last  calculated eigval = 0.060335422406922
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44361963701476
lambda[   7] =  -0.43552061714434
lambda[   8] =  -0.42185434416430
lambda[   9] =  -0.38292669164587
lambda[  10] =  -0.37029624178126
lambda[  11] =  -0.35561088536435
lambda[  12] =  -0.32683885055741
lambda[  13] =  -0.31049342799324
lambda[  14] =  -0.26315075135284
lambda[  15] =  -0.22881796976871
lambda[  16] =  -0.03094208501440
lambda[  17] =  -0.02736144650195
lambda[  18] =   0.00421654450432
lambda[  19] =   0.01513749566258
lambda[  20] =   0.01748009148498
lambda[  21] =   0.02434693516901
lambda[  22] =   0.04247091499302
lambda[  23] =   0.06033542240692
==subpsace eigenproblem: bcast eigvals took 0.065 ms
Total time for solving subspace eigenvalue problem: 0.300 ms
rank =  0, subspace rotation using ScaLAPACK took 8.762 ms
rank =  0, Distributing orbital back into band + domain format took 19.864 ms
rank = 0, Subspace_Rotation used 28.643 ms

Total time for subspace rotation: 28.648 ms
rank = 0, Efermi =  -0.059706411269 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.520 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.941 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.583 ms
rank = 0, Calculating density took 1692.062 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.842 ms
rank = 0, D2D took 1.944 ms
rank = 0, Transfering density took 1.946 ms
Etot    =   -54.730772399312
Eband   =   -14.653961793696
E1      =    31.963455633865
E2      =   -13.621708625115
E3      =   -19.073653473130
Exc     =   -16.930142198606
Esc     =   -87.805486138180
Entropy =    -0.000000000941
dE = 2.254e-05, dEband = 5.419e-03
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -54.730772399, dEtot = 2.254e-05, dEband = 5.419e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5920527246814, which took 0.061 ms

iter_count = 108, r_2norm = 1.932e-05, tol*||rhs|| = 2.368e-05

Anderson update took 57.450 ms, out of which F'*F took 27.167 ms; b-Ax took 184.248 ms, out of which Lap took 164.701 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.938 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167158, int_b + int_rho = 1.382e-13, checking this took 0.073 ms
2-norm of RHS = 796.1284741768753, which took 0.099 ms

iter_count = 240, r_2norm = 7.742e-04, tol*||rhs|| = 7.961e-04

Anderson update took 127.217 ms, out of which F'*F took 59.806 ms; b-Ax took 405.520 ms, out of which Lap took 362.437 ms
Solving Poisson took 859.396 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.216870 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.158 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.208702 
Total time for convolution: 	 convolve: 5.191674 
Total time for convolution: 	 convolve: 5.190383 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.594 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.260 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.414 ms
---Transfer Veff_loc: D2D took 3.524 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.044 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.603 ms

This SCF took 27761.961 ms, scf error = 3.304e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.160335, lowerbound = -1.014553, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1552.394 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 30.353 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.096 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 33.465 ms
rank =  0, finding HY took 26.657 ms
rank =  0, distributing HY into block cyclic form took 19.695 ms
rank =  0, finding Y'*HY took 4.864 ms
Rank 0, Project_Hamiltonian used 84.707 ms
Total time for projection: 84.718 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -1.011056880991615
    last  calculated eigval = 0.058990839640922
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43967949048232
lambda[   7] =  -0.43218663195182
lambda[   8] =  -0.41812668498785
lambda[   9] =  -0.37904063522116
lambda[  10] =  -0.36635949033815
lambda[  11] =  -0.35132661134679
lambda[  12] =  -0.32332631110230
lambda[  13] =  -0.30690609872830
lambda[  14] =  -0.25986602225519
lambda[  15] =  -0.22519500242604
lambda[  16] =  -0.02992263783779
lambda[  17] =  -0.02486622534123
lambda[  18] =   0.00597037052469
lambda[  19] =   0.01590993626518
lambda[  20] =   0.01840709771341
lambda[  21] =   0.02465543481099
lambda[  22] =   0.04098886548879
lambda[  23] =   0.05899083964092
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.254 ms
rank =  0, subspace rotation using ScaLAPACK took 8.751 ms
rank =  0, Distributing orbital back into band + domain format took 19.953 ms
rank = 0, Subspace_Rotation used 28.719 ms

Total time for subspace rotation: 28.724 ms
rank = 0, Efermi =  -0.058675112346 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.510 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.998 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 1683.302 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.830 ms
rank = 0, D2D took 1.925 ms
rank = 0, Transfering density took 1.928 ms
Etot    =   -54.730544916118
Eband   =   -14.541675514097
E1      =    31.908680433030
E2      =   -13.558608854450
E3      =   -19.093635812189
Exc     =   -16.944308362570
Esc     =   -87.805486138180
Entropy =    -0.000000000939
dE = 2.068e-05, dEband = 1.021e-02
rank = 0, Calculating/Estimating energy took 1.318 ms, Etot = -54.730544916, dEtot = 2.068e-05, dEband = 1.021e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3189872838709, which took 0.120 ms

iter_count = 108, r_2norm = 1.157e-05, tol*||rhs|| = 1.276e-05

Anderson update took 57.641 ms, out of which F'*F took 27.040 ms; b-Ax took 183.630 ms, out of which Lap took 164.855 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.016 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167154, int_b + int_rho = 9.459e-14, checking this took 0.107 ms
2-norm of RHS = 796.2043910794264, which took 0.110 ms

iter_count = 216, r_2norm = 7.168e-04, tol*||rhs|| = 7.962e-04

Anderson update took 114.488 ms, out of which F'*F took 53.846 ms; b-Ax took 365.607 ms, out of which Lap took 327.763 ms
Solving Poisson took 773.844 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.176820 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.394 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.188912 
Total time for convolution: 	 convolve: 5.189876 
Total time for convolution: 	 convolve: 5.226889 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.727 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.157 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.581 ms
---Transfer Veff_loc: D2D took 3.529 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.004 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.565 ms

This SCF took 27662.530 ms, scf error = 1.491e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.158991, lowerbound = -1.011057, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1567.246 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.565 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.206 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.789 ms
rank =  0, finding HY took 26.800 ms
rank =  0, distributing HY into block cyclic form took 19.672 ms
rank =  0, finding Y'*HY took 4.798 ms
Rank 0, Project_Hamiltonian used 74.090 ms
Total time for projection: 74.101 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.140 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.242 ms
    first calculated eigval = -1.009678689742005
    last  calculated eigval = 0.057131507617238
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43812228814335
lambda[   7] =  -0.43085713969982
lambda[   8] =  -0.41660306442459
lambda[   9] =  -0.37766375961222
lambda[  10] =  -0.36481958024402
lambda[  11] =  -0.34984433737417
lambda[  12] =  -0.32185386412131
lambda[  13] =  -0.30556430094360
lambda[  14] =  -0.25866693433262
lambda[  15] =  -0.22360742016381
lambda[  16] =  -0.02880811821830
lambda[  17] =  -0.02347083613656
lambda[  18] =   0.00766621925037
lambda[  19] =   0.01691889147868
lambda[  20] =   0.01941741619591
lambda[  21] =   0.02535463367360
lambda[  22] =   0.03990642933021
lambda[  23] =   0.05713150761724
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.257 ms
rank =  0, subspace rotation using ScaLAPACK took 8.993 ms
rank =  0, Distributing orbital back into band + domain format took 19.716 ms
rank = 0, Subspace_Rotation used 28.726 ms

Total time for subspace rotation: 28.730 ms
rank = 0, Efermi =  -0.057559916596 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.519 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.964 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 1687.542 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.787 ms
rank = 0, D2D took 2.889 ms
rank = 0, Transfering density took 2.891 ms
Etot    =   -54.730554823426
Eband   =   -14.498250392501
E1      =    31.888517773841
E2      =   -13.534341850919
E3      =   -19.096793895570
Exc     =   -16.946471812136
Esc     =   -87.805486138180
Entropy =    -0.000000000939
dE = 9.007e-07, dEband = 3.948e-03
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -54.730554823, dEtot = 9.007e-07, dEband = 3.948e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1739114339059, which took 0.059 ms

iter_count = 114, r_2norm = 4.467e-06, tol*||rhs|| = 6.956e-06

Anderson update took 61.027 ms, out of which F'*F took 28.767 ms; b-Ax took 194.069 ms, out of which Lap took 173.944 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.887 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167154, int_b + int_rho = 1.019e-13, checking this took 0.104 ms
2-norm of RHS = 796.1971865507744, which took 0.113 ms

iter_count = 210, r_2norm = 7.530e-04, tol*||rhs|| = 7.962e-04

Anderson update took 111.150 ms, out of which F'*F took 52.592 ms; b-Ax took 355.701 ms, out of which Lap took 318.451 ms
Solving Poisson took 753.386 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.225448 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.828 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.226566 
Total time for convolution: 	 convolve: 5.228132 
Total time for convolution: 	 convolve: 5.225885 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
---Transfer Veff_loc: D2D took 3.548 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.042 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.624 ms

This SCF took 27794.917 ms, scf error = 9.446e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.157132, lowerbound = -1.009679, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1563.522 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.627 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.076 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.720 ms
rank =  0, finding HY took 26.708 ms
rank =  0, distributing HY into block cyclic form took 19.726 ms
rank =  0, finding Y'*HY took 4.876 ms
Rank 0, Project_Hamiltonian used 74.057 ms
Total time for projection: 74.068 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.140 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.230 ms
    first calculated eigval = -1.007990912452022
    last  calculated eigval = 0.055270589643198
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43648347839645
lambda[   7] =  -0.42935326941325
lambda[   8] =  -0.41490342320001
lambda[   9] =  -0.37619734341603
lambda[  10] =  -0.36320525391096
lambda[  11] =  -0.34825365467189
lambda[  12] =  -0.32030038392400
lambda[  13] =  -0.30390977562711
lambda[  14] =  -0.25707010066116
lambda[  15] =  -0.22187660071422
lambda[  16] =  -0.02689082026741
lambda[  17] =  -0.02191594908411
lambda[  18] =   0.01039913725549
lambda[  19] =   0.01871489594061
lambda[  20] =   0.02155840685331
lambda[  21] =   0.02726358759322
lambda[  22] =   0.03908739668926
lambda[  23] =   0.05527058964320
==subpsace eigenproblem: bcast eigvals took 0.049 ms
Total time for solving subspace eigenvalue problem: 0.286 ms
rank =  0, subspace rotation using ScaLAPACK took 8.792 ms
rank =  0, Distributing orbital back into band + domain format took 19.863 ms
rank = 0, Subspace_Rotation used 28.672 ms

Total time for subspace rotation: 28.676 ms
rank = 0, Efermi =  -0.055643539835 calculate fermi energy took 0.669 ms
rank = 0, --- Calculate rho: sum over local bands took 5.356 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.094 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.564 ms
rank = 0, Calculating density took 1685.070 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.841 ms
rank = 0, D2D took 1.943 ms
rank = 0, Transfering density took 1.949 ms
Etot    =   -54.730554591109
Eband   =   -14.449794782465
E1      =    31.863110476221
E2      =   -13.509908771491
E3      =   -19.102379769518
Exc     =   -16.950672686755
Esc     =   -87.805486138180
Entropy =    -0.000000000939
dE = 2.112e-08, dEband = 4.405e-03
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -54.730554591, dEtot = 2.112e-08, dEband = 4.405e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1590239674976, which took 0.091 ms

iter_count = 108, r_2norm = 5.135e-06, tol*||rhs|| = 6.361e-06

Anderson update took 57.667 ms, out of which F'*F took 27.146 ms; b-Ax took 183.748 ms, out of which Lap took 164.949 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.630 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167149, int_b + int_rho = 5.093e-14, checking this took 0.106 ms
2-norm of RHS = 796.1949315710179, which took 0.119 ms

iter_count = 198, r_2norm = 6.337e-04, tol*||rhs|| = 7.962e-04

Anderson update took 104.933 ms, out of which F'*F took 49.253 ms; b-Ax took 334.499 ms, out of which Lap took 299.089 ms
Solving Poisson took 708.996 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.220798 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 29.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.193500 
Total time for convolution: 	 convolve: 5.260329 
Total time for convolution: 	 convolve: 5.205024 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
---Transfer Veff_loc: D2D took 3.925 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.043 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.004 ms

This SCF took 27685.759 ms, scf error = 5.656e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.155271, lowerbound = -1.007991, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1571.162 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.801 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.097 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.924 ms
rank =  0, finding HY took 26.722 ms
rank =  0, distributing HY into block cyclic form took 19.599 ms
rank =  0, finding Y'*HY took 4.780 ms
Rank 0, Project_Hamiltonian used 74.049 ms
Total time for projection: 74.060 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.138 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.226 ms
    first calculated eigval = -1.007207597184538
    last  calculated eigval = 0.052475999157446
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43574845748297
lambda[   7] =  -0.42863821618191
lambda[   8] =  -0.41411017843528
lambda[   9] =  -0.37551167657111
lambda[  10] =  -0.36246056274781
lambda[  11] =  -0.34753245869122
lambda[  12] =  -0.31955234645597
lambda[  13] =  -0.30318212055913
lambda[  14] =  -0.25630379375951
lambda[  15] =  -0.22102013337211
lambda[  16] =  -0.02507873125735
lambda[  17] =  -0.02116078614681
lambda[  18] =   0.01249715748034
lambda[  19] =   0.02072979515020
lambda[  20] =   0.02393401180057
lambda[  21] =   0.02872408767615
lambda[  22] =   0.03794671193347
lambda[  23] =   0.05247599915745
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.247 ms
rank =  0, subspace rotation using ScaLAPACK took 8.812 ms
rank =  0, Distributing orbital back into band + domain format took 20.345 ms
rank = 0, Subspace_Rotation used 29.178 ms

Total time for subspace rotation: 29.183 ms
rank = 0, Efermi =  -0.053838295848 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 5.446 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.024 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.611 ms
rank = 0, Calculating density took 1691.889 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.858 ms
rank = 0, D2D took 1.958 ms
rank = 0, Transfering density took 1.964 ms
Etot    =   -54.730584115033
Eband   =   -14.427302051985
E1      =    31.852276923838
E2      =   -13.498026336228
E3      =   -19.103298111713
Exc     =   -16.951397295708
Esc     =   -87.805486138180
Entropy =    -0.000000000940
dE = 2.684e-06, dEband = 2.045e-03
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -54.730584115, dEtot = 2.684e-06, dEband = 2.045e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0595167841582, which took 0.099 ms

iter_count = 114, r_2norm = 1.595e-06, tol*||rhs|| = 2.381e-06

Anderson update took 61.371 ms, out of which F'*F took 28.644 ms; b-Ax took 193.840 ms, out of which Lap took 173.946 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.925 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167147, int_b + int_rho = 2.910e-14, checking this took 0.111 ms
2-norm of RHS = 796.1967140225895, which took 0.138 ms

iter_count = 192, r_2norm = 7.330e-04, tol*||rhs|| = 7.962e-04

Anderson update took 101.708 ms, out of which F'*F took 47.768 ms; b-Ax took 326.195 ms, out of which Lap took 292.019 ms
Solving Poisson took 690.209 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.231054 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.209569 
Total time for convolution: 	 convolve: 5.199757 
Total time for convolution: 	 convolve: 5.213566 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 3.531 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.988 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.550 ms

This SCF took 27637.046 ms, scf error = 4.106e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.152476, lowerbound = -1.007208, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1569.542 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.650 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.170 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.836 ms
rank =  0, finding HY took 26.626 ms
rank =  0, distributing HY into block cyclic form took 19.678 ms
rank =  0, finding Y'*HY took 4.781 ms
Rank 0, Project_Hamiltonian used 73.951 ms
Total time for projection: 73.962 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.232 ms
    first calculated eigval = -1.006387444214174
    last  calculated eigval = 0.050294037994956
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43492635504444
lambda[   7] =  -0.42783887657239
lambda[   8] =  -0.41330433952865
lambda[   9] =  -0.37470073225702
lambda[  10] =  -0.36163944183937
lambda[  11] =  -0.34669337005762
lambda[  12] =  -0.31874084440229
lambda[  13] =  -0.30240292348468
lambda[  14] =  -0.25551547175452
lambda[  15] =  -0.22020601399999
lambda[  16] =  -0.02214671504689
lambda[  17] =  -0.02032628628954
lambda[  18] =   0.01552498871498
lambda[  19] =   0.02441442758510
lambda[  20] =   0.02786588875165
lambda[  21] =   0.03034408194104
lambda[  22] =   0.03750939966238
lambda[  23] =   0.05029403799496
==subpsace eigenproblem: bcast eigvals took 0.046 ms
Total time for solving subspace eigenvalue problem: 0.285 ms
rank =  0, subspace rotation using ScaLAPACK took 8.897 ms
rank =  0, Distributing orbital back into band + domain format took 19.684 ms
rank = 0, Subspace_Rotation used 28.599 ms

Total time for subspace rotation: 28.605 ms
rank = 0, Efermi =  -0.051005653302 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 5.514 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.017 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.614 ms
rank = 0, Calculating density took 1690.087 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.836 ms
rank = 0, D2D took 1.945 ms
rank = 0, Transfering density took 1.947 ms
Etot    =   -54.730621826779
Eband   =   -14.402977596831
E1      =    31.840263023628
E2      =   -13.485304582591
E3      =   -19.105159358064
Exc     =   -16.952885055101
Esc     =   -87.805486138180
Entropy =    -0.000000000948
dE = 3.428e-06, dEband = 2.211e-03
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -54.730621827, dEtot = 3.428e-06, dEband = 2.211e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0504904711280, which took 0.132 ms

iter_count = 114, r_2norm = 1.498e-06, tol*||rhs|| = 2.020e-06

Anderson update took 60.724 ms, out of which F'*F took 28.701 ms; b-Ax took 193.960 ms, out of which Lap took 174.160 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.543 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167145, int_b + int_rho = 3.638e-15, checking this took 0.131 ms
2-norm of RHS = 796.1968328569932, which took 0.135 ms

iter_count = 132, r_2norm = 7.215e-04, tol*||rhs|| = 7.962e-04

Anderson update took 69.877 ms, out of which F'*F took 32.752 ms; b-Ax took 222.474 ms, out of which Lap took 198.985 ms
Solving Poisson took 473.206 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.236062 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.661 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.181772 
Total time for convolution: 	 convolve: 5.233493 
Total time for convolution: 	 convolve: 5.208582 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
---Transfer Veff_loc: D2D took 3.564 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.079 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.679 ms

This SCF took 27461.784 ms, scf error = 2.436e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.150294, lowerbound = -1.006387, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1568.352 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.640 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.084 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.742 ms
rank =  0, finding HY took 26.795 ms
rank =  0, distributing HY into block cyclic form took 19.519 ms
rank =  0, finding Y'*HY took 4.958 ms
Rank 0, Project_Hamiltonian used 74.041 ms
Total time for projection: 74.050 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.678 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.270 ms
rank = 0, Solve_Generalized_EigenProblem used 0.955 ms
    first calculated eigval = -1.006213408683094
    last  calculated eigval = 0.046543158774825
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43477074912754
lambda[   7] =  -0.42768067012578
lambda[   8] =  -0.41314372702050
lambda[   9] =  -0.37455608010065
lambda[  10] =  -0.36149036106583
lambda[  11] =  -0.34654576435744
lambda[  12] =  -0.31858700590475
lambda[  13] =  -0.30224510658478
lambda[  14] =  -0.25535216638070
lambda[  15] =  -0.22004146607859
lambda[  16] =  -0.02170290649289
lambda[  17] =  -0.02017479497198
lambda[  18] =   0.01570317249093
lambda[  19] =   0.02513548410559
lambda[  20] =   0.02837010985701
lambda[  21] =   0.03022235916634
lambda[  22] =   0.03690626090247
lambda[  23] =   0.04654315877483
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.974 ms
rank =  0, subspace rotation using ScaLAPACK took 8.744 ms
rank =  0, Distributing orbital back into band + domain format took 19.870 ms
rank = 0, Subspace_Rotation used 28.629 ms

Total time for subspace rotation: 28.634 ms
rank = 0, Efermi =  -0.050601949403 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 5.495 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.056 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 1690.079 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.832 ms
rank = 0, D2D took 1.930 ms
rank = 0, Transfering density took 1.936 ms
Etot    =   -54.730646194888
Eband   =   -14.398240845643
E1      =    31.837786269323
E2      =   -13.482955750370
E3      =   -19.105501317559
Exc     =   -16.953162547367
Esc     =   -87.805486138180
Entropy =    -0.000000000950
dE = 2.215e-06, dEband = 4.306e-04
rank = 0, Calculating/Estimating energy took 0.936 ms, Etot = -54.730646195, dEtot = 2.215e-06, dEband = 4.306e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0318833710268, which took 0.148 ms

iter_count = 108, r_2norm = 1.115e-06, tol*||rhs|| = 1.275e-06

Anderson update took 57.916 ms, out of which F'*F took 27.106 ms; b-Ax took 183.527 ms, out of which Lap took 164.510 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.950 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167148, int_b + int_rho = 3.274e-14, checking this took 0.124 ms
2-norm of RHS = 796.2082211057918, which took 0.109 ms

iter_count = 168, r_2norm = 7.628e-04, tol*||rhs|| = 7.962e-04

Anderson update took 89.010 ms, out of which F'*F took 41.677 ms; b-Ax took 284.747 ms, out of which Lap took 254.975 ms
Solving Poisson took 602.980 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.202561 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.009 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 30.553 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.184036 
Total time for convolution: 	 convolve: 5.235537 
Total time for convolution: 	 convolve: 5.191980 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.518 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.973 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.524 ms

This SCF took 27519.940 ms, scf error = 2.113e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.146543, lowerbound = -1.006213, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1564.197 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.711 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.441 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.608 ms
rank =  0, finding HY took 26.316 ms
rank =  0, distributing HY into block cyclic form took 19.535 ms
rank =  0, finding Y'*HY took 4.964 ms
Rank 0, Project_Hamiltonian used 74.455 ms
Total time for projection: 74.466 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.237 ms
    first calculated eigval = -1.005682520493012
    last  calculated eigval = 0.046468874942631
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43425500084211
lambda[   7] =  -0.42716010006294
lambda[   8] =  -0.41262793991184
lambda[   9] =  -0.37405758571106
lambda[  10] =  -0.36098723815840
lambda[  11] =  -0.34604152689380
lambda[  12] =  -0.31807392400035
lambda[  13] =  -0.30174026834296
lambda[  14] =  -0.25483934847894
lambda[  15] =  -0.21952617211500
lambda[  16] =  -0.01964718708869
lambda[  17] =  -0.01893794281117
lambda[  18] =   0.01675628932534
lambda[  19] =   0.02887780411816
lambda[  20] =   0.03098199395230
lambda[  21] =   0.03199356484500
lambda[  22] =   0.03832573809457
lambda[  23] =   0.04646887494263
==subpsace eigenproblem: bcast eigvals took 0.057 ms
Total time for solving subspace eigenvalue problem: 0.301 ms
rank =  0, subspace rotation using ScaLAPACK took 8.761 ms
rank =  0, Distributing orbital back into band + domain format took 19.963 ms
rank = 0, Subspace_Rotation used 28.740 ms

Total time for subspace rotation: 28.745 ms
rank = 0, Efermi =  -0.048734937463 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.553 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.910 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.620 ms
rank = 0, Calculating density took 1684.914 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.853 ms
rank = 0, D2D took 1.952 ms
rank = 0, Transfering density took 1.954 ms
Etot    =   -54.730711874153
Eband   =   -14.382832173453
E1      =    31.830288660815
E2      =   -13.474836591776
E3      =   -19.106313811355
Exc     =   -16.953832625510
Esc     =   -87.805486138180
Entropy =    -0.000000000956
dE = 5.971e-06, dEband = 1.401e-03
rank = 0, Calculating/Estimating energy took 0.910 ms, Etot = -54.730711874, dEtot = 5.971e-06, dEband = 1.401e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0301623806068, which took 0.110 ms

iter_count = 108, r_2norm = 1.169e-06, tol*||rhs|| = 1.206e-06

Anderson update took 57.511 ms, out of which F'*F took 27.096 ms; b-Ax took 183.773 ms, out of which Lap took 164.661 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.080 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167155, int_b + int_rho = 1.091e-13, checking this took 0.136 ms
2-norm of RHS = 796.2092548732306, which took 0.096 ms

iter_count = 132, r_2norm = 7.256e-04, tol*||rhs|| = 7.962e-04

Anderson update took 69.931 ms, out of which F'*F took 32.974 ms; b-Ax took 223.920 ms, out of which Lap took 200.514 ms
Solving Poisson took 474.636 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 5.199808 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 64.248 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.225378 
Total time for convolution: 	 convolve: 5.191029 
Total time for convolution: 	 convolve: 5.242218 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.503 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.008 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.544 ms

This SCF took 27474.434 ms, scf error = 1.258e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.146469, lowerbound = -1.005683, upperbound = 267.584137

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1571.681 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.730 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.070 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.815 ms
rank =  0, finding HY took 26.785 ms
rank =  0, distributing HY into block cyclic form took 19.552 ms
rank =  0, finding Y'*HY took 4.971 ms
Rank 0, Project_Hamiltonian used 74.152 ms
Total time for projection: 74.203 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.140 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.244 ms
    first calculated eigval = -1.005560768083929
    last  calculated eigval = 0.045258682984549
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43414088452376
lambda[   7] =  -0.42704447523189
lambda[   8] =  -0.41250601283335
lambda[   9] =  -0.37395041359786
lambda[  10] =  -0.36087549018708
lambda[  11] =  -0.34593394402433
lambda[  12] =  -0.31795906238628
lambda[  13] =  -0.30161931069843
lambda[  14] =  -0.25471577916860
lambda[  15] =  -0.21940307100387
lambda[  16] =  -0.01953601167842
lambda[  17] =  -0.01836090022903
lambda[  18] =   0.01695987708470
lambda[  19] =   0.02925638209052
lambda[  20] =   0.03123111112756
lambda[  21] =   0.03265584662846
lambda[  22] =   0.03882154176189
lambda[  23] =   0.04525868298455
==subpsace eigenproblem: bcast eigvals took 0.056 ms
Total time for solving subspace eigenvalue problem: 0.307 ms
rank =  0, subspace rotation using ScaLAPACK took 8.736 ms
rank =  0, Distributing orbital back into band + domain format took 19.957 ms
rank = 0, Subspace_Rotation used 28.710 ms

Total time for subspace rotation: 28.715 ms
rank = 0, Efermi =  -0.048500639023 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.491 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.130 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.645 ms
rank = 0, Calculating density took 1692.290 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.853 ms
rank = 0, D2D took 1.947 ms
rank = 0, Transfering density took 1.949 ms
Etot    =   -54.730740049691
Eband   =   -14.379339526554
E1      =    31.828556512777
E2      =   -13.473026427610
E3      =   -19.106449912090
Exc     =   -16.953947236482
Esc     =   -87.805486138180
Entropy =    -0.000000000953
dE = 2.561e-06, dEband = 3.175e-04
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -54.730740050, dEtot = 2.561e-06, dEband = 3.175e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0230150797194, which took 0.101 ms

iter_count = 108, r_2norm = 8.377e-07, tol*||rhs|| = 9.206e-07

Anderson update took 57.880 ms, out of which F'*F took 27.181 ms; b-Ax took 183.687 ms, out of which Lap took 164.973 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.360 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003167144, int_rho =  30.00000003167141, int_b + int_rho = -3.638e-14, checking this took 0.099 ms
2-norm of RHS = 796.2097571281265, which took 0.069 ms

iter_count = 132, r_2norm = 6.602e-04, tol*||rhs|| = 7.962e-04

Anderson update took 69.528 ms, out of which F'*F took 34.678 ms; b-Ax took 224.464 ms, out of which Lap took 200.906 ms
Solving Poisson took 474.801 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.184032 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 71.432 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.185590 
Total time for convolution: 	 convolve: 5.217200 
Total time for convolution: 	 convolve: 5.222190 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.014 ms
======D2D: initiated sending and receiving took 1.020 ms
---Transfer Veff_loc: D2D took 4.309 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.988 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.331 ms

This SCF took 27455.497 ms, scf error = 9.620e-05
The last 18 occupations of kpoints #1 are (Nelectron = 30):
lambda[   6] =  -0.43414088452376, occ[   6] =   2.00000000000000
lambda[   7] =  -0.42704447523189, occ[   7] =   2.00000000000000
lambda[   8] =  -0.41250601283335, occ[   8] =   2.00000000000000
lambda[   9] =  -0.37395041359786, occ[   9] =   2.00000000000000
lambda[  10] =  -0.36087549018708, occ[  10] =   2.00000000000000
lambda[  11] =  -0.34593394402433, occ[  11] =   2.00000000000000
lambda[  12] =  -0.31795906238628, occ[  12] =   2.00000000000000
lambda[  13] =  -0.30161931069843, occ[  13] =   2.00000000000000
lambda[  14] =  -0.25471577916860, occ[  14] =   2.00000000000000
lambda[  15] =  -0.21940307100387, occ[  15] =   2.00000000000000
lambda[  16] =  -0.01953601167842, occ[  16] =   0.00000002501209
lambda[  17] =  -0.01836090022903, occ[  17] =   0.00000000665945
lambda[  18] =   0.01695987708470, occ[  18] =   0.00000000000000
lambda[  19] =   0.02925638209052, occ[  19] =   0.00000000000000
lambda[  20] =   0.03123111112756, occ[  20] =   0.00000000000000
lambda[  21] =   0.03265584662846, occ[  21] =   0.00000000000000
lambda[  22] =   0.03882154176189, occ[  22] =   0.00000000000000
lambda[  23] =   0.04525868298455, occ[  23] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 21 (90%) = 0.000000000000000.
Occupation of state 23 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.778 ms, time for Allreduce/Reduce: 12.552 ms 
Time for calculating local force components: 24.926 ms
Start Calculating nonlocal forces
force_nloc = 
  1.17020888922614  -0.31185299604408   0.00000035131334
 -0.94059288537932   0.25581435549772   0.00000045811606
  0.01869513091643  -0.04713194704668  -0.00000002023170
 -0.02875607569155   0.00666487050283  -0.03969990806311
 -0.02875605397098   0.00666484897318   0.03969986629929
 -0.02543270305862   0.04495553037164   0.00000002269107
  0.03008252290616  -0.00362672980877  -0.04118884205964
  0.03008248726216  -0.00362672500004   0.04118884852965
 -0.01871715820398  -0.03916158248215   0.00000001112420
 -0.04714039856155  -0.15018697846686  -0.00000022468951
  0.14764542051867   0.14672531230480  -0.00000007340193
force_loc = 
 -1.15638244693063   0.30779847887646   0.00000012386418
  0.91836687396510  -0.25628783090821   0.00000197756704
 -0.01875213629038   0.04818085391370  -0.00000035569132
  0.02970171815749  -0.00652550619007   0.04056563181731
  0.02970108870155  -0.00652590030574  -0.04056530813088
  0.02601982774095  -0.04596200363008   0.00000001265500
 -0.03085138854890   0.00354491289500   0.04250543943092
 -0.03085181991992   0.00354495325401  -0.04250591895145
  0.01764007270047   0.03801930984308  -0.00000093013982
  0.06441342736946   0.14736203806557  -0.00000025502170
 -0.14377060921619  -0.14372578382704   0.00000058090499
Time for calculating nonlocal force components: 42.400 ms
[32mforces_xc: 
[0m[32m -0.02697320648800   0.00780502292909   0.00000001677663
[0m[32m  0.02990260812419  -0.00440747552597   0.00000007690438
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00099958691362   0.00163757041331  -0.00000001347729
[0m[32m -0.00855686425470   0.00817486040488  -0.00000001978019
[0m[32m -0.00730654446867  -0.00759865950330   0.00000001455123
[0mTime for calculating XC forces components: 35.270 ms
 Cartesian force = 
 -0.01320306996694   0.00372570580635   0.00000034987173
  0.00762029093552  -0.00490575089158   0.00000237050505
 -0.00011331114840   0.00102410691191  -0.00000051800545
  0.00088933669148   0.00011456435765   0.00086558167176
  0.00088872895611   0.00011414871233  -0.00086558391402
  0.00053081890788  -0.00103127321356  -0.00000010673637
 -0.00082517141719  -0.00010661686889   0.00131645528885
 -0.00082563843222  -0.00010657170115  -0.00131721250423
 -0.00013380436435   0.00047049781912  -0.00000107457534
  0.00865985877876   0.00532512004847  -0.00000064157383
 -0.00348803894065  -0.00462393098066   0.00000037997185
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Time for printing density: 383.917 ms
The program took 421.934 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:26:50
Job ID:        2266447
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:27:48,vmem=8296K,walltime=00:07:19,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-7-1
---------------------------------------
