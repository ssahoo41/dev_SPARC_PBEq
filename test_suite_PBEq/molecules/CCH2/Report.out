---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:16
Job ID:    2266610
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:21
Job ID:    2266610
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.063 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.016 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 8.985 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 4.
[32m
Time for finding element is 0.010 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8

Reading ion file took 0.872 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 51.944 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.921 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.118 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   11.775685	    8.249762	
   10.000000	    8.224315	    8.249762	
   10.000000	   10.000000	    9.280513	
   10.000000	   10.000000	   11.750238	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.193 ms
Set up communicators.

--set up spincomm took 2.226 ms

--set up kptcomm took 0.388 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.007 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 11, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 11, ScaLAPACK topology Dims = (11, 1)
nproc = 12, size_blacscomm = 11 = dims[0] * dims[1] = (11, 1)
Nd_blacscomm 1000000, Nstates 11 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 1), actual size (1000000, 1)
rank = 0, mb = nb = 11, mbQ = nbQ = 64
rank = 0, nr_Hp = 11, nc_Hp = 11
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.094 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 11
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 11
# of bands per bandcomm          : 1
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.395 ms

Calculate_SplineDerivRadFun took 0.951 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.863 ms.
time spent on vectorized spline interp: 2.683 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.757 ms.
time spent on vectorized spline interp: 1.766 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.558 ms.

Calculating rb for all atom types took 11.637 ms
----------------------
Estimated memory usage
Total: 788.88 MB
orbitals             : 503.54 MB
global sized vectors : 213.62 MB
subspace matrices : 2.84 kB
others : 71.72 MB
----------------------------------------------
Estimated memory usage per processor: 65.74 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.053 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -10.0000000059411, sum_int_rho = 9.7919281055261
PosCharge = 10.000000005941, NegCharge = -9.791928105526, scal_fac = 1.021249328853
After scaling, int_rho = 10.0000000059411, PosCharge + NegCharge - NetCharge = -8.882e-15
--Calculate Vref took 0.255 ms
--Calculate rho_guess took 1.318 ms

 integral of b = -10.0000000059411,
 int{b} + Nelectron + NetCharge = -5.941e-09,
 Esc = -23.6085518002266,
 MPI_Reduce took 1.595 ms

Calculating b & b_ref took 7.614 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.036 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.109 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.028 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.239 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.825 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 21.939 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594108, int_b + int_rho = -2.074e-13, checking this took 0.090 ms
2-norm of RHS = 464.1514696527004, which took 0.567 ms

iter_count = 426, r_2norm = 3.618e-04, tol*||rhs|| = 4.642e-04

Anderson update took 263.888 ms, out of which F'*F took 124.992 ms; b-Ax took 858.089 ms, out of which Lap took 754.394 ms
Solving Poisson took 1922.704 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.376 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.821 ms
Total time for convolution: 	 convolve: 5.089908 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.973 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
Total time for convolution: 	 convolve: 5.092838 
Total time for convolution: 	 convolve: 5.094410 
Total time for convolution: 	 convolve: 5.105953 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.717 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.376 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.351 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.840 ms
rank = 0, XC calculation took 24311.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 4.908 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.231 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 15.273 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.154 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.900 ms
    Lanczos iter 53, eigmin  = -0.826880993, eigmax = 264.917729958, err_eigmin = 4.736e-04, err_eigmax = 9.854e-03
rank =   0, Lanczos took 133.520 ms, eigmin = -0.826880992713, eigmax = 267.566907257469

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.320013, lowerbound = -0.926881, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 893.896 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 9.568 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.908 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.509 ms
rank =  0, finding HY took 16.020 ms
rank =  0, distributing HY into block cyclic form took 8.428 ms
rank =  0, finding Y'*HY took 2.650 ms
Rank 0, Project_Hamiltonian used 38.669 ms
Total time for projection: 38.686 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.252 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.105 ms
rank = 0, Solve_Generalized_EigenProblem used 1.364 ms
    first calculated eigval = 2.835209240111889
    last  calculated eigval = 3.189952101069401
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =   2.83520924011189
lambda[   2] =   2.88040850842208
lambda[   3] =   2.88574617842574
lambda[   4] =   2.95460823173187
lambda[   5] =   2.97279524718455
lambda[   6] =   2.98502496709158
lambda[   7] =   3.04306040194040
lambda[   8] =   3.06897890217726
lambda[   9] =   3.12268659184437
lambda[  10] =   3.12858308166448
lambda[  11] =   3.18995210106940
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.381 ms
rank =  0, subspace rotation using ScaLAPACK took 3.246 ms
rank =  0, Distributing orbital back into band + domain format took 8.291 ms
rank = 0, Subspace_Rotation used 11.569 ms

Total time for subspace rotation: 11.574 ms
rank = 0, Efermi =   2.978910126211 calculate fermi energy took 0.076 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.289952, lowerbound = -0.926881, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 893.354 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.366 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.854 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.248 ms
rank =  0, finding HY took 14.836 ms
rank =  0, distributing HY into block cyclic form took 8.469 ms
rank =  0, finding Y'*HY took 2.655 ms
Rank 0, Project_Hamiltonian used 36.885 ms
Total time for projection: 36.898 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -0.530302626891052
    last  calculated eigval = 0.449259999796331
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.53030262689105
lambda[   2] =  -0.19249350612628
lambda[   3] =  -0.08445515287012
lambda[   4] =   0.12812227136906
lambda[   5] =   0.24190635703506
lambda[   6] =   0.33808122186096
lambda[   7] =   0.35159749378119
lambda[   8] =   0.35321879582356
lambda[   9] =   0.37575476242671
lambda[  10] =   0.41503962603276
lambda[  11] =   0.44925999979633
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 3.196 ms
rank =  0, Distributing orbital back into band + domain format took 8.336 ms
rank = 0, Subspace_Rotation used 11.557 ms

Total time for subspace rotation: 11.562 ms
rank = 0, Efermi =   0.307842153624 calculate fermi energy took 0.058 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.549260, lowerbound = -0.926881, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 886.480 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 8.253 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.908 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.205 ms
rank =  0, finding HY took 14.526 ms
rank =  0, distributing HY into block cyclic form took 8.452 ms
rank =  0, finding Y'*HY took 2.629 ms
Rank 0, Project_Hamiltonian used 35.868 ms
Total time for projection: 35.874 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.193 ms
    first calculated eigval = -0.830461769991935
    last  calculated eigval = 0.145048674458503
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.83046176999193
lambda[   2] =  -0.58504587070556
lambda[   3] =  -0.51923832498332
lambda[   4] =  -0.32442501763589
lambda[   5] =  -0.27619416702917
lambda[   6] =  -0.08018211269649
lambda[   7] =   0.02031917892936
lambda[   8] =   0.05603289616039
lambda[   9] =   0.11200378980423
lambda[  10] =   0.13188786988732
lambda[  11] =   0.14504867445850
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 3.247 ms
rank =  0, Distributing orbital back into band + domain format took 8.264 ms
rank = 0, Subspace_Rotation used 11.538 ms

Total time for subspace rotation: 11.543 ms
rank = 0, Efermi =  -0.110421180949 calculate fermi energy took 0.040 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.245049, lowerbound = -0.926881, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 884.815 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 8.322 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.870 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.225 ms
rank =  0, finding HY took 13.880 ms
rank =  0, distributing HY into block cyclic form took 8.494 ms
rank =  0, finding Y'*HY took 2.609 ms
Rank 0, Project_Hamiltonian used 36.332 ms
Total time for projection: 36.340 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.830962431121369
    last  calculated eigval = 0.086099368573077
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.83096243112137
lambda[   2] =  -0.58940309637495
lambda[   3] =  -0.52465430094110
lambda[   4] =  -0.35254055675063
lambda[   5] =  -0.32928416770541
lambda[   6] =  -0.18516835058617
lambda[   7] =  -0.06003904861976
lambda[   8] =   0.00260184133584
lambda[   9] =   0.06459337689288
lambda[  10] =   0.08167294655986
lambda[  11] =   0.08609936857308
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 3.242 ms
rank =  0, Distributing orbital back into band + domain format took 8.266 ms
rank = 0, Subspace_Rotation used 11.532 ms

Total time for subspace rotation: 11.538 ms
rank = 0, Efermi =  -0.215407418797 calculate fermi energy took 0.036 ms
rank = 0, --- Calculate rho: sum over local bands took 3.036 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.358 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.611 ms
rank = 0, Calculating density took 3906.704 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.979 ms
rank = 0, D2D took 2.085 ms
rank = 0, Transfering density took 2.092 ms
Etot    =   -13.146279135705
Eband   =    -5.253689106887
E1      =    11.354803446536
E2      =    -3.899504359661
E3      =    -5.043763215560
Exc     =    -4.582109250164
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 3.287e+00, dEband = 1.313e+00
rank = 0, Calculating/Estimating energy took 1.051 ms, Etot = -13.146279136, dEtot = 3.287e+00, dEband = 1.313e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 38.5600752610069, which took 0.307 ms

iter_count = 96, r_2norm = 1.142e-03, tol*||rhs|| = 1.542e-03

Anderson update took 64.213 ms, out of which F'*F took 27.044 ms; b-Ax took 180.326 ms, out of which Lap took 161.615 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.836 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594111, int_b + int_rho = -1.783e-13, checking this took 0.129 ms
2-norm of RHS = 461.7996972279204, which took 0.210 ms

iter_count = 288, r_2norm = 3.967e-04, tol*||rhs|| = 4.618e-04

Anderson update took 179.701 ms, out of which F'*F took 80.385 ms; b-Ax took 545.026 ms, out of which Lap took 486.793 ms
Solving Poisson took 1233.665 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.371 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.095597 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.639 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.082101 
Total time for convolution: 	 convolve: 5.080108 
Total time for convolution: 	 convolve: 5.075982 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.380 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.538 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.061 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.632 ms

This SCF took 29923.074 ms, scf error = 2.555e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.186099, lowerbound = -0.830962, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 890.608 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 9.069 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.893 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.007 ms
rank =  0, finding HY took 14.605 ms
rank =  0, distributing HY into block cyclic form took 8.322 ms
rank =  0, finding Y'*HY took 2.632 ms
Rank 0, Project_Hamiltonian used 37.682 ms
Total time for projection: 37.721 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 14.754 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.206 ms
rank = 0, Solve_Generalized_EigenProblem used 15.093 ms
    first calculated eigval = -0.792765986242950
    last  calculated eigval = 0.061421064184121
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.79276598624295
lambda[   2] =  -0.55689904341602
lambda[   3] =  -0.49182475817973
lambda[   4] =  -0.32505296833484
lambda[   5] =  -0.31503141586510
lambda[   6] =  -0.18571948291095
lambda[   7] =  -0.07023651217065
lambda[   8] =  -0.01831721742606
lambda[   9] =   0.03792771864038
lambda[  10] =   0.05347217832906
lambda[  11] =   0.06142106418412
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 15.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.196 ms
rank =  0, Distributing orbital back into band + domain format took 8.292 ms
rank = 0, Subspace_Rotation used 11.516 ms

Total time for subspace rotation: 11.524 ms
rank = 0, Efermi =  -0.215958551146 calculate fermi energy took 0.103 ms
rank = 0, --- Calculate rho: sum over local bands took 3.105 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.830 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.601 ms
rank = 0, Calculating density took 970.763 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.940 ms
rank = 0, D2D took 2.043 ms
rank = 0, Transfering density took 2.053 ms
Etot    =   -13.109188356580
Eband   =    -4.963148345181
E1      =    11.104044398465
E2      =    -3.883703555168
E3      =    -5.116434836921
Exc     =    -4.641671001542
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 9.273e-03, dEband = 7.264e-02
rank = 0, Calculating/Estimating energy took 1.070 ms, Etot = -13.109188357, dEtot = 9.273e-03, dEband = 7.264e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 15.0615262614152, which took 0.061 ms

iter_count = 102, r_2norm = 4.482e-04, tol*||rhs|| = 6.025e-04

Anderson update took 65.065 ms, out of which F'*F took 28.697 ms; b-Ax took 191.210 ms, out of which Lap took 172.185 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 442.560 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594113, int_b + int_rho = -1.528e-13, checking this took 0.167 ms
2-norm of RHS = 458.9544253678153, which took 0.149 ms

iter_count = 300, r_2norm = 3.998e-04, tol*||rhs|| = 4.590e-04

Anderson update took 196.926 ms, out of which F'*F took 86.532 ms; b-Ax took 570.212 ms, out of which Lap took 510.840 ms
Solving Poisson took 1279.357 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.149 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.173 ms
Total time for convolution: 	 convolve: 5.074848 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.467 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.074938 
Total time for convolution: 	 convolve: 5.084209 
Total time for convolution: 	 convolve: 5.077972 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.378 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 3.487 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.067 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.587 ms

This SCF took 27055.204 ms, scf error = 1.703e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.161421, lowerbound = -0.792766, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 885.400 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.970 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.648 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 13.634 ms
rank =  0, finding HY took 14.617 ms
rank =  0, distributing HY into block cyclic form took 8.348 ms
rank =  0, finding Y'*HY took 2.649 ms
Rank 0, Project_Hamiltonian used 39.277 ms
Total time for projection: 39.291 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.736888206597159
    last  calculated eigval = 0.049576797638973
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.73688820659716
lambda[   2] =  -0.51160279039662
lambda[   3] =  -0.44750688868061
lambda[   4] =  -0.28569972575989
lambda[   5] =  -0.28132174266314
lambda[   6] =  -0.16482126355285
lambda[   7] =  -0.04716647237087
lambda[   8] =  -0.02551439921390
lambda[   9] =   0.02633605901681
lambda[  10] =   0.03275287485254
lambda[  11] =   0.04957679763897
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 3.177 ms
rank =  0, Distributing orbital back into band + domain format took 8.202 ms
rank = 0, Subspace_Rotation used 11.392 ms

Total time for subspace rotation: 11.397 ms
rank = 0, Efermi =  -0.195060331735 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 2.836 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.125 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 952.383 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.905 ms
rank = 0, D2D took 2.011 ms
rank = 0, Transfering density took 2.017 ms
Etot    =   -13.085351823893
Eband   =    -4.526038709174
E1      =    10.731742114842
E2      =    -3.817235760420
E3      =    -5.252295746574
Exc     =    -4.752034936144
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 5.959e-03, dEband = 1.093e-01
rank = 0, Calculating/Estimating energy took 1.046 ms, Etot = -13.085351824, dEtot = 5.959e-03, dEband = 1.093e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 3.7986453321702, which took 0.067 ms

iter_count = 108, r_2norm = 1.180e-04, tol*||rhs|| = 1.519e-04

Anderson update took 68.408 ms, out of which F'*F took 31.630 ms; b-Ax took 208.999 ms, out of which Lap took 188.282 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 470.653 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594116, int_b + int_rho = -1.237e-13, checking this took 0.131 ms
2-norm of RHS = 458.6928383683322, which took 0.134 ms

iter_count = 282, r_2norm = 4.445e-04, tol*||rhs|| = 4.587e-04

Anderson update took 179.556 ms, out of which F'*F took 79.078 ms; b-Ax took 536.131 ms, out of which Lap took 476.739 ms
Solving Poisson took 1208.454 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.865 ms
Total time for convolution: 	 convolve: 5.092489 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.078914 
Total time for convolution: 	 convolve: 5.077236 
Total time for convolution: 	 convolve: 5.076916 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.400 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
---Transfer Veff_loc: D2D took 3.522 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.962 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.789 ms

This SCF took 26972.504 ms, scf error = 6.451e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.149577, lowerbound = -0.736888, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 896.917 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.192 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.852 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.060 ms
rank =  0, finding HY took 14.884 ms
rank =  0, distributing HY into block cyclic form took 8.312 ms
rank =  0, finding Y'*HY took 2.575 ms
Rank 0, Project_Hamiltonian used 35.875 ms
Total time for projection: 35.889 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.192 ms
    first calculated eigval = -0.722404860000656
    last  calculated eigval = 0.042572367144763
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.72240486000066
lambda[   2] =  -0.50061918695576
lambda[   3] =  -0.43882502061709
lambda[   4] =  -0.27474931543629
lambda[   5] =  -0.26140332837997
lambda[   6] =  -0.14924882653277
lambda[   7] =  -0.03905494856936
lambda[   8] =  -0.02860347253897
lambda[   9] =   0.01963544924078
lambda[  10] =   0.02345517002310
lambda[  11] =   0.04257236714476
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 3.227 ms
rank =  0, Distributing orbital back into band + domain format took 8.247 ms
rank = 0, Subspace_Rotation used 11.485 ms

Total time for subspace rotation: 11.492 ms
rank = 0, Efermi =  -0.179487894692 calculate fermi energy took 0.068 ms
rank = 0, --- Calculate rho: sum over local bands took 2.871 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.084 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.036 ms
rank = 0, Calculating density took 961.634 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.139 ms
rank = 0, D2D took 2.234 ms
rank = 0, Transfering density took 2.237 ms
Etot    =   -13.082164508504
Eband   =    -4.396003423666
E1      =    10.636845499681
E2      =    -3.773663599866
E3      =    -5.306008232253
Exc     =    -4.794126616226
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 7.968e-04, dEband = 3.251e-02
rank = 0, Calculating/Estimating energy took 1.026 ms, Etot = -13.082164509, dEtot = 7.968e-04, dEband = 3.251e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.1889378420218, which took 0.057 ms

iter_count = 108, r_2norm = 6.788e-05, tol*||rhs|| = 8.756e-05

Anderson update took 68.336 ms, out of which F'*F took 29.697 ms; b-Ax took 204.412 ms, out of which Lap took 181.866 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 471.576 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594110, int_b + int_rho = -1.801e-13, checking this took 0.120 ms
2-norm of RHS = 458.8151621568549, which took 0.154 ms

iter_count = 240, r_2norm = 4.058e-04, tol*||rhs|| = 4.588e-04

Anderson update took 416.884 ms, out of which F'*F took 126.358 ms; b-Ax took 1095.087 ms, out of which Lap took 1001.141 ms
Solving Poisson took 2366.620 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.198411 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 94.495 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.077677 
Total time for convolution: 	 convolve: 5.079533 
Total time for convolution: 	 convolve: 5.077765 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.408 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 4.320 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.424 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.786 ms

This SCF took 28381.617 ms, scf error = 2.009e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.142572, lowerbound = -0.722405, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 887.106 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.353 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.851 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.218 ms
rank =  0, finding HY took 14.918 ms
rank =  0, distributing HY into block cyclic form took 8.304 ms
rank =  0, finding Y'*HY took 2.701 ms
Rank 0, Project_Hamiltonian used 36.175 ms
Total time for projection: 36.186 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.720443377304027
    last  calculated eigval = 0.038735933003843
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.72044337730403
lambda[   2] =  -0.49846346815824
lambda[   3] =  -0.43633854131136
lambda[   4] =  -0.27329221873989
lambda[   5] =  -0.26043609642760
lambda[   6] =  -0.14869514866334
lambda[   7] =  -0.03878082020908
lambda[   8] =  -0.02965149128029
lambda[   9] =   0.01575009016701
lambda[  10] =   0.01954525387206
lambda[  11] =   0.03873593300384
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 3.211 ms
rank =  0, Distributing orbital back into band + domain format took 8.273 ms
rank = 0, Subspace_Rotation used 11.497 ms

Total time for subspace rotation: 11.503 ms
rank = 0, Efermi =  -0.178934216822 calculate fermi energy took 0.957 ms
rank = 0, --- Calculate rho: sum over local bands took 3.100 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.569 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.566 ms
rank = 0, Calculating density took 952.245 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.938 ms
rank = 0, D2D took 2.046 ms
rank = 0, Transfering density took 2.051 ms
Etot    =   -13.081872026051
Eband   =    -4.377947404766
E1      =    10.629097692991
E2      =    -3.761844601887
E3      =    -5.312616596021
Exc     =    -4.798931711773
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 7.312e-05, dEband = 4.514e-03
rank = 0, Calculating/Estimating energy took 1.049 ms, Etot = -13.081872026, dEtot = 7.312e-05, dEband = 4.514e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5319073432917, which took 0.062 ms

iter_count = 114, r_2norm = 1.738e-05, tol*||rhs|| = 2.128e-05

Anderson update took 70.965 ms, out of which F'*F took 31.662 ms; b-Ax took 219.050 ms, out of which Lap took 192.025 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 509.108 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594112, int_b + int_rho = -1.583e-13, checking this took 0.147 ms
2-norm of RHS = 459.2950886965527, which took 0.069 ms

iter_count = 258, r_2norm = 4.509e-04, tol*||rhs|| = 4.593e-04

Anderson update took 158.500 ms, out of which F'*F took 75.534 ms; b-Ax took 514.413 ms, out of which Lap took 457.630 ms
Solving Poisson took 1162.933 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.099804 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.084912 
Total time for convolution: 	 convolve: 5.084202 
Total time for convolution: 	 convolve: 5.099242 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.421 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.720 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.044 ms
---Transfer Veff_loc: D2D took 4.314 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.020 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.370 ms

This SCF took 26996.294 ms, scf error = 1.410e-02
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.138736, lowerbound = -0.720443, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 905.214 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 8.252 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.840 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.108 ms
rank =  0, finding HY took 14.924 ms
rank =  0, distributing HY into block cyclic form took 8.396 ms
rank =  0, finding Y'*HY took 2.579 ms
Rank 0, Project_Hamiltonian used 36.037 ms
Total time for projection: 36.052 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -0.719571937880845
    last  calculated eigval = 0.036318329805273
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71957193788085
lambda[   2] =  -0.49670209165358
lambda[   3] =  -0.43411895562188
lambda[   4] =  -0.27218766109059
lambda[   5] =  -0.25918258702882
lambda[   6] =  -0.14791646307318
lambda[   7] =  -0.03799175090010
lambda[   8] =  -0.03023180569852
lambda[   9] =   0.01377818390952
lambda[  10] =   0.01752495210820
lambda[  11] =   0.03631832980527
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 2.958 ms
rank =  0, Distributing orbital back into band + domain format took 8.597 ms
rank = 0, Subspace_Rotation used 11.568 ms

Total time for subspace rotation: 11.574 ms
rank = 0, Efermi =  -0.178155531366 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.972 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.135 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.550 ms
rank = 0, Calculating density took 969.844 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.911 ms
rank = 0, D2D took 2.015 ms
rank = 0, Transfering density took 2.021 ms
Etot    =   -13.081543022317
Eband   =    -4.363526467430
E1      =    10.635804316590
E2      =    -3.738506197697
E3      =    -5.318224944294
Exc     =    -4.802000213057
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 8.225e-05, dEband = 3.605e-03
rank = 0, Calculating/Estimating energy took 1.043 ms, Etot = -13.081543022, dEtot = 8.225e-05, dEband = 3.605e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3618694611650, which took 0.060 ms

iter_count = 114, r_2norm = 9.296e-06, tol*||rhs|| = 1.447e-05

Anderson update took 68.669 ms, out of which F'*F took 32.299 ms; b-Ax took 220.832 ms, out of which Lap took 195.581 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 502.894 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594113, int_b + int_rho = -1.492e-13, checking this took 0.079 ms
2-norm of RHS = 459.3589091036753, which took 0.181 ms

iter_count = 246, r_2norm = 3.936e-04, tol*||rhs|| = 4.594e-04

Anderson update took 149.750 ms, out of which F'*F took 70.692 ms; b-Ax took 479.459 ms, out of which Lap took 426.860 ms
Solving Poisson took 1069.752 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.079545 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.076452 
Total time for convolution: 	 convolve: 5.078444 
Total time for convolution: 	 convolve: 5.075229 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.612 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.231 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.520 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.158 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.715 ms

This SCF took 27043.303 ms, scf error = 4.992e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.136318, lowerbound = -0.719572, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 900.717 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.368 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.886 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.269 ms
rank =  0, finding HY took 14.912 ms
rank =  0, distributing HY into block cyclic form took 8.281 ms
rank =  0, finding Y'*HY took 2.590 ms
Rank 0, Project_Hamiltonian used 36.087 ms
Total time for projection: 36.103 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.123 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -0.717143761784735
    last  calculated eigval = 0.034449349646303
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71714376178474
lambda[   2] =  -0.49491290155882
lambda[   3] =  -0.43276764151344
lambda[   4] =  -0.26978354265464
lambda[   5] =  -0.25605304730151
lambda[   6] =  -0.14562145705305
lambda[   7] =  -0.03615078064932
lambda[   8] =  -0.03034748846067
lambda[   9] =   0.01296180615149
lambda[  10] =   0.01599468012328
lambda[  11] =   0.03444934964630
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.252 ms
rank =  0, subspace rotation using ScaLAPACK took 3.200 ms
rank =  0, Distributing orbital back into band + domain format took 8.212 ms
rank = 0, Subspace_Rotation used 11.426 ms

Total time for subspace rotation: 11.432 ms
rank = 0, Efermi =  -0.175860525272 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 3.129 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.972 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.558 ms
rank = 0, Calculating density took 965.305 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.974 ms
rank = 0, D2D took 2.080 ms
rank = 0, Transfering density took 2.086 ms
Etot    =   -13.081511286766
Eband   =    -4.341321790491
E1      =    10.624005907369
E2      =    -3.726663785046
E3      =    -5.323368817197
Exc     =    -4.805676205475
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 7.934e-06, dEband = 5.551e-03
rank = 0, Calculating/Estimating energy took 1.068 ms, Etot = -13.081511287, dEtot = 7.934e-06, dEband = 5.551e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1970405113180, which took 0.070 ms

iter_count = 114, r_2norm = 6.085e-06, tol*||rhs|| = 7.882e-06

Anderson update took 68.997 ms, out of which F'*F took 32.033 ms; b-Ax took 217.770 ms, out of which Lap took 193.308 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 502.652 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594109, int_b + int_rho = -1.928e-13, checking this took 0.143 ms
2-norm of RHS = 459.4317922881689, which took 0.163 ms

iter_count = 234, r_2norm = 4.192e-04, tol*||rhs|| = 4.594e-04

Anderson update took 154.045 ms, out of which F'*F took 68.370 ms; b-Ax took 458.646 ms, out of which Lap took 409.965 ms
Solving Poisson took 1030.709 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.080329 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.079381 
Total time for convolution: 	 convolve: 5.084063 
Total time for convolution: 	 convolve: 5.080513 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.723 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.136 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.156 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.724 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.416 ms
---Transfer Veff_loc: D2D took 3.508 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.544 ms

This SCF took 26984.741 ms, scf error = 3.022e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.134449, lowerbound = -0.717144, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 901.181 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.406 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.878 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.301 ms
rank =  0, finding HY took 14.969 ms
rank =  0, distributing HY into block cyclic form took 8.218 ms
rank =  0, finding Y'*HY took 2.628 ms
Rank 0, Project_Hamiltonian used 36.149 ms
Total time for projection: 36.171 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -0.716170320914096
    last  calculated eigval = 0.033910288653658
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71617032091410
lambda[   2] =  -0.49401167556140
lambda[   3] =  -0.43193204137834
lambda[   4] =  -0.26867505583749
lambda[   5] =  -0.25477899221636
lambda[   6] =  -0.14467031376550
lambda[   7] =  -0.03522117498587
lambda[   8] =  -0.02983246001653
lambda[   9] =   0.01302784235891
lambda[  10] =   0.01586891841433
lambda[  11] =   0.03391028865366
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 2.972 ms
rank =  0, Distributing orbital back into band + domain format took 8.595 ms
rank = 0, Subspace_Rotation used 11.583 ms

Total time for subspace rotation: 11.589 ms
rank = 0, Efermi =  -0.174909381759 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.996 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.145 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.579 ms
rank = 0, Calculating density took 966.001 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.940 ms
rank = 0, D2D took 2.048 ms
rank = 0, Transfering density took 2.054 ms
Etot    =   -13.081558059123
Eband   =    -4.331136172675
E1      =    10.620971279100
E2      =    -3.718780077994
E3      =    -5.325158589007
Exc     =    -4.806780032137
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 1.169e-05, dEband = 2.546e-03
rank = 0, Calculating/Estimating energy took 1.436 ms, Etot = -13.081558059, dEtot = 1.169e-05, dEband = 2.546e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1056229750546, which took 0.070 ms

iter_count = 108, r_2norm = 4.123e-06, tol*||rhs|| = 4.225e-06

Anderson update took 69.167 ms, out of which F'*F took 30.689 ms; b-Ax took 209.309 ms, out of which Lap took 187.113 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.005 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594109, int_b + int_rho = -1.910e-13, checking this took 0.130 ms
2-norm of RHS = 459.3666269968993, which took 0.209 ms

iter_count = 240, r_2norm = 3.786e-04, tol*||rhs|| = 4.594e-04

Anderson update took 145.448 ms, out of which F'*F took 70.405 ms; b-Ax took 471.824 ms, out of which Lap took 419.317 ms
Solving Poisson took 1044.418 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Total time for convolution: 	 convolve: 5.095697 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.168586 
Total time for convolution: 	 convolve: 5.080994 
Total time for convolution: 	 convolve: 5.080019 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.593 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.712 ms
---Transfer Veff_loc: D2D took 3.462 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.966 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.462 ms

This SCF took 26957.937 ms, scf error = 2.004e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.133910, lowerbound = -0.716170, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 902.323 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 8.246 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.867 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.131 ms
rank =  0, finding HY took 14.921 ms
rank =  0, distributing HY into block cyclic form took 8.327 ms
rank =  0, finding Y'*HY took 2.587 ms
Rank 0, Project_Hamiltonian used 36.009 ms
Total time for projection: 36.023 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.714631920284332
    last  calculated eigval = 0.033581366471847
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71463192028433
lambda[   2] =  -0.49260424349500
lambda[   3] =  -0.43055360824895
lambda[   4] =  -0.26708952182469
lambda[   5] =  -0.25293749369883
lambda[   6] =  -0.14302457633237
lambda[   7] =  -0.03358605528833
lambda[   8] =  -0.02693794903298
lambda[   9] =   0.01655634927644
lambda[  10] =   0.01796664441438
lambda[  11] =   0.03358136647185
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.211 ms
rank =  0, subspace rotation using ScaLAPACK took 3.221 ms
rank =  0, Distributing orbital back into band + domain format took 8.260 ms
rank = 0, Subspace_Rotation used 11.495 ms

Total time for subspace rotation: 11.502 ms
rank = 0, Efermi =  -0.173263644336 calculate fermi energy took 0.075 ms
rank = 0, --- Calculate rho: sum over local bands took 3.128 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.016 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.574 ms
rank = 0, Calculating density took 966.915 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.949 ms
rank = 0, D2D took 2.054 ms
rank = 0, Transfering density took 2.056 ms
Etot    =   -13.081660134652
Eband   =    -4.315633575953
E1      =    10.612514771277
E2      =    -3.711160708614
E3      =    -5.327399198563
Exc     =    -4.808549436742
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 2.552e-05, dEband = 3.876e-03
rank = 0, Calculating/Estimating energy took 1.481 ms, Etot = -13.081660135, dEtot = 2.552e-05, dEband = 3.876e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0912430600640, which took 0.065 ms

iter_count = 114, r_2norm = 2.329e-06, tol*||rhs|| = 3.650e-06

Anderson update took 69.031 ms, out of which F'*F took 33.155 ms; b-Ax took 219.353 ms, out of which Lap took 196.284 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 502.971 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594113, int_b + int_rho = -1.528e-13, checking this took 0.128 ms
2-norm of RHS = 459.3692162416306, which took 0.213 ms

iter_count = 192, r_2norm = 3.963e-04, tol*||rhs|| = 4.594e-04

Anderson update took 120.816 ms, out of which F'*F took 54.328 ms; b-Ax took 368.160 ms, out of which Lap took 328.141 ms
Solving Poisson took 831.952 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.083271 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.081811 
Total time for convolution: 	 convolve: 5.088096 
Total time for convolution: 	 convolve: 5.079489 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.163 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.696 ms
---Transfer Veff_loc: D2D took 3.444 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.970 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.449 ms

This SCF took 27119.399 ms, scf error = 9.732e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.133581, lowerbound = -0.714632, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 884.758 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.282 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.901 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.201 ms
rank =  0, finding HY took 14.835 ms
rank =  0, distributing HY into block cyclic form took 8.256 ms
rank =  0, finding Y'*HY took 2.620 ms
Rank 0, Project_Hamiltonian used 35.944 ms
Total time for projection: 35.956 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.195 ms
    first calculated eigval = -0.714124252941686
    last  calculated eigval = 0.032144756500961
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71412425294169
lambda[   2] =  -0.49215526103276
lambda[   3] =  -0.43012609253677
lambda[   4] =  -0.26662564564834
lambda[   5] =  -0.25247200637750
lambda[   6] =  -0.14261033225194
lambda[   7] =  -0.03320651897058
lambda[   8] =  -0.02600739601570
lambda[   9] =   0.01736390856811
lambda[  10] =   0.01842412421414
lambda[  11] =   0.03214475650096
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 3.217 ms
rank =  0, Distributing orbital back into band + domain format took 8.305 ms
rank = 0, Subspace_Rotation used 11.540 ms

Total time for subspace rotation: 11.546 ms
rank = 0, Efermi =  -0.172849400397 calculate fermi energy took 0.084 ms
rank = 0, --- Calculate rho: sum over local bands took 3.113 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.815 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.569 ms
rank = 0, Calculating density took 949.125 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 2.925 ms
rank = 0, D2D took 3.032 ms
rank = 0, Transfering density took 3.035 ms
Etot    =   -13.081730223940
Eband   =    -4.311006517921
E1      =    10.609871760449
E2      =    -3.708959242977
E3      =    -5.328188346549
Exc     =    -4.809191255582
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 1.752e-05, dEband = 1.157e-03
rank = 0, Calculating/Estimating energy took 1.053 ms, Etot = -13.081730224, dEtot = 1.752e-05, dEband = 1.157e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0928156999448, which took 0.058 ms

iter_count = 102, r_2norm = 3.586e-06, tol*||rhs|| = 3.713e-06

Anderson update took 61.269 ms, out of which F'*F took 28.943 ms; b-Ax took 195.282 ms, out of which Lap took 173.969 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 453.229 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594116, int_b + int_rho = -1.291e-13, checking this took 0.127 ms
2-norm of RHS = 459.3941834101770, which took 0.135 ms

iter_count = 204, r_2norm = 4.574e-04, tol*||rhs|| = 4.594e-04

Anderson update took 123.404 ms, out of which F'*F took 59.950 ms; b-Ax took 400.409 ms, out of which Lap took 356.920 ms
Solving Poisson took 886.695 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.106922 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.090209 
Total time for convolution: 	 convolve: 5.090936 
Total time for convolution: 	 convolve: 5.081941 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.582 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.567 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.696 ms
---Transfer Veff_loc: D2D took 3.460 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.994 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.489 ms

This SCF took 26662.164 ms, scf error = 7.580e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.132145, lowerbound = -0.714124, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 906.949 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 8.363 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.832 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.213 ms
rank =  0, finding HY took 14.952 ms
rank =  0, distributing HY into block cyclic form took 8.305 ms
rank =  0, finding Y'*HY took 2.610 ms
Rank 0, Project_Hamiltonian used 36.118 ms
Total time for projection: 36.133 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -0.713544639863195
    last  calculated eigval = 0.032456870836730
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71354463986320
lambda[   2] =  -0.49156925163832
lambda[   3] =  -0.42952570495093
lambda[   4] =  -0.26602838127208
lambda[   5] =  -0.25190405189266
lambda[   6] =  -0.14199777525971
lambda[   7] =  -0.03254387670526
lambda[   8] =  -0.02188575882108
lambda[   9] =   0.02016848419243
lambda[  10] =   0.02323629596711
lambda[  11] =   0.03245687083673
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 3.206 ms
rank =  0, Distributing orbital back into band + domain format took 8.257 ms
rank = 0, Subspace_Rotation used 11.478 ms

Total time for subspace rotation: 11.484 ms
rank = 0, Efermi =  -0.172236843254 calculate fermi energy took 0.073 ms
rank = 0, --- Calculate rho: sum over local bands took 3.124 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.912 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.561 ms
rank = 0, Calculating density took 971.508 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 2.485 ms
rank = 0, D2D took 2.590 ms
rank = 0, Transfering density took 2.593 ms
Etot    =   -13.081782344583
Eband   =    -4.305144060078
E1      =    10.607553175464
E2      =    -3.705280496848
E3      =    -5.328699232995
Exc     =    -4.809619389400
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 1.303e-05, dEband = 1.466e-03
rank = 0, Calculating/Estimating energy took 1.092 ms, Etot = -13.081782345, dEtot = 1.303e-05, dEband = 1.466e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0535984187849, which took 0.060 ms

iter_count = 108, r_2norm = 1.885e-06, tol*||rhs|| = 2.144e-06

Anderson update took 64.951 ms, out of which F'*F took 31.327 ms; b-Ax took 208.243 ms, out of which Lap took 186.081 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 478.014 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594110, int_b + int_rho = -1.819e-13, checking this took 0.128 ms
2-norm of RHS = 459.3910279243418, which took 0.171 ms

iter_count = 162, r_2norm = 4.481e-04, tol*||rhs|| = 4.594e-04

Anderson update took 98.928 ms, out of which F'*F took 46.992 ms; b-Ax took 315.175 ms, out of which Lap took 280.688 ms
Solving Poisson took 704.477 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.081655 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.080718 
Total time for convolution: 	 convolve: 5.105863 
Total time for convolution: 	 convolve: 5.074575 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.613 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.448 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.957 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.438 ms

This SCF took 26872.827 ms, scf error = 5.115e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132457, lowerbound = -0.713545, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 895.381 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.292 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.859 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.172 ms
rank =  0, finding HY took 14.891 ms
rank =  0, distributing HY into block cyclic form took 10.982 ms
rank =  0, finding Y'*HY took 2.534 ms
Rank 0, Project_Hamiltonian used 38.617 ms
Total time for projection: 38.631 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -0.713203246625174
    last  calculated eigval = 0.032329538593332
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71320324662517
lambda[   2] =  -0.49127439843134
lambda[   3] =  -0.42924772336619
lambda[   4] =  -0.26571961386327
lambda[   5] =  -0.25158123512104
lambda[   6] =  -0.14169756471567
lambda[   7] =  -0.03221446950973
lambda[   8] =  -0.02036957845293
lambda[   9] =   0.02084353663523
lambda[  10] =   0.02476424248996
lambda[  11] =   0.03232953859333
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 3.202 ms
rank =  0, Distributing orbital back into band + domain format took 8.203 ms
rank = 0, Subspace_Rotation used 11.418 ms

Total time for subspace rotation: 11.424 ms
rank = 0, Efermi =  -0.171936632937 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 3.720 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.462 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.593 ms
rank = 0, Calculating density took 962.527 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.949 ms
rank = 0, D2D took 2.055 ms
rank = 0, Transfering density took 2.062 ms
Etot    =   -13.081808688029
Eband   =    -4.302052435656
E1      =    10.605718213159
E2      =    -3.703888065308
E3      =    -5.329242261903
Exc     =    -4.810052992332
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 6.586e-06, dEband = 7.729e-04
rank = 0, Calculating/Estimating energy took 1.224 ms, Etot = -13.081808688, dEtot = 6.586e-06, dEband = 7.729e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0560776124472, which took 0.079 ms

iter_count = 102, r_2norm = 1.769e-06, tol*||rhs|| = 2.243e-06

Anderson update took 61.734 ms, out of which F'*F took 29.587 ms; b-Ax took 195.683 ms, out of which Lap took 174.927 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 453.601 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594112, int_b + int_rho = -1.673e-13, checking this took 0.125 ms
2-norm of RHS = 459.3980746636781, which took 0.179 ms

iter_count = 186, r_2norm = 3.782e-04, tol*||rhs|| = 4.594e-04

Anderson update took 112.258 ms, out of which F'*F took 53.693 ms; b-Ax took 363.483 ms, out of which Lap took 323.742 ms
Solving Poisson took 806.829 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.087276 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.083254 
Total time for convolution: 	 convolve: 5.100884 
Total time for convolution: 	 convolve: 5.081145 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.573 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 3.471 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.152 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.661 ms

This SCF took 26578.664 ms, scf error = 3.806e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132330, lowerbound = -0.713203, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 884.721 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.379 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.836 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.236 ms
rank =  0, finding HY took 14.915 ms
rank =  0, distributing HY into block cyclic form took 8.279 ms
rank =  0, finding Y'*HY took 2.604 ms
Rank 0, Project_Hamiltonian used 36.079 ms
Total time for projection: 36.092 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -0.713057553098929
    last  calculated eigval = 0.034111638716934
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71305755309893
lambda[   2] =  -0.49110051247376
lambda[   3] =  -0.42904515277294
lambda[   4] =  -0.26556617297497
lambda[   5] =  -0.25148553474488
lambda[   6] =  -0.14156890983728
lambda[   7] =  -0.03209447663039
lambda[   8] =  -0.01845347325733
lambda[   9] =   0.02108887708278
lambda[  10] =   0.02577251411541
lambda[  11] =   0.03411163871693
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 3.221 ms
rank =  0, Distributing orbital back into band + domain format took 8.797 ms
rank = 0, Subspace_Rotation used 12.450 ms

Total time for subspace rotation: 12.455 ms
rank = 0, Efermi =  -0.171807977989 calculate fermi energy took 0.083 ms
rank = 0, --- Calculate rho: sum over local bands took 3.055 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.858 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.564 ms
rank = 0, Calculating density took 950.106 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.945 ms
rank = 0, D2D took 2.045 ms
rank = 0, Transfering density took 2.048 ms
Etot    =   -13.081855815561
Eband   =    -4.300509852972
E1      =    10.605381398501
E2      =    -3.702650450384
E3      =    -5.329133593706
Exc     =    -4.809959604768
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 1.178e-05, dEband = 3.856e-04
rank = 0, Calculating/Estimating energy took 1.084 ms, Etot = -13.081855816, dEtot = 1.178e-05, dEband = 3.856e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0565852418937, which took 0.081 ms

iter_count = 102, r_2norm = 1.856e-06, tol*||rhs|| = 2.263e-06

Anderson update took 61.350 ms, out of which F'*F took 28.902 ms; b-Ax took 197.067 ms, out of which Lap took 175.750 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 451.084 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594112, int_b + int_rho = -1.673e-13, checking this took 0.114 ms
2-norm of RHS = 459.3972923586298, which took 0.189 ms

iter_count = 126, r_2norm = 4.539e-04, tol*||rhs|| = 4.594e-04

Anderson update took 76.630 ms, out of which F'*F took 36.366 ms; b-Ax took 244.918 ms, out of which Lap took 218.210 ms
Solving Poisson took 547.706 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.114073 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.079866 
Total time for convolution: 	 convolve: 5.087690 
Total time for convolution: 	 convolve: 5.091882 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.824 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.339 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.464 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.991 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.489 ms

This SCF took 26329.052 ms, scf error = 3.579e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.134112, lowerbound = -0.713058, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 888.975 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.312 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.961 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.292 ms
rank =  0, finding HY took 14.782 ms
rank =  0, distributing HY into block cyclic form took 8.243 ms
rank =  0, finding Y'*HY took 2.574 ms
Rank 0, Project_Hamiltonian used 35.928 ms
Total time for projection: 35.940 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.713011347461050
    last  calculated eigval = 0.034639546655971
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71301134746105
lambda[   2] =  -0.49106106435785
lambda[   3] =  -0.42900852651849
lambda[   4] =  -0.26552269801021
lambda[   5] =  -0.25143210964659
lambda[   6] =  -0.14152676378878
lambda[   7] =  -0.03205815141836
lambda[   8] =  -0.01771241246986
lambda[   9] =   0.02109997246414
lambda[  10] =   0.02599350038987
lambda[  11] =   0.03463954665597
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.218 ms
rank =  0, subspace rotation using ScaLAPACK took 3.131 ms
rank =  0, Distributing orbital back into band + domain format took 8.667 ms
rank = 0, Subspace_Rotation used 11.814 ms

Total time for subspace rotation: 11.821 ms
rank = 0, Efermi =  -0.171765831979 calculate fermi energy took 0.072 ms
rank = 0, --- Calculate rho: sum over local bands took 3.098 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.972 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.596 ms
rank = 0, Calculating density took 953.781 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.935 ms
rank = 0, D2D took 2.040 ms
rank = 0, Transfering density took 2.043 ms
Etot    =   -13.081861323598
Eband   =    -4.300071492829
E1      =    10.605161325071
E2      =    -3.702426046184
E3      =    -5.329165117861
Exc     =    -4.809990519474
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 1.377e-06, dEband = 1.096e-04
rank = 0, Calculating/Estimating energy took 1.062 ms, Etot = -13.081861324, dEtot = 1.377e-06, dEband = 1.096e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0627993735855, which took 0.123 ms

iter_count = 102, r_2norm = 1.872e-06, tol*||rhs|| = 2.512e-06

Anderson update took 61.538 ms, out of which F'*F took 29.241 ms; b-Ax took 194.929 ms, out of which Lap took 174.041 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.489 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594111, int_b + int_rho = -1.764e-13, checking this took 0.153 ms
2-norm of RHS = 459.3974784466628, which took 0.145 ms

iter_count = 108, r_2norm = 4.330e-04, tol*||rhs|| = 4.594e-04

Anderson update took 65.355 ms, out of which F'*F took 31.965 ms; b-Ax took 212.134 ms, out of which Lap took 188.535 ms
Solving Poisson took 471.823 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.087143 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.101373 
Total time for convolution: 	 convolve: 5.077775 
Total time for convolution: 	 convolve: 5.082840 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.576 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.476 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.983 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.494 ms

This SCF took 26419.028 ms, scf error = 3.298e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.134640, lowerbound = -0.713011, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 892.037 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.409 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.899 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.328 ms
rank =  0, finding HY took 14.938 ms
rank =  0, distributing HY into block cyclic form took 8.354 ms
rank =  0, finding Y'*HY took 2.599 ms
Rank 0, Project_Hamiltonian used 36.255 ms
Total time for projection: 36.268 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.713066006887787
    last  calculated eigval = 0.034161511055195
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71306600688779
lambda[   2] =  -0.49110932860587
lambda[   3] =  -0.42905389969420
lambda[   4] =  -0.26557177969458
lambda[   5] =  -0.25148503819686
lambda[   6] =  -0.14157201109390
lambda[   7] =  -0.03209556809570
lambda[   8] =  -0.01798621597581
lambda[   9] =   0.02088784277468
lambda[  10] =   0.02556127567625
lambda[  11] =   0.03416151105519
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.211 ms
rank =  0, subspace rotation using ScaLAPACK took 3.094 ms
rank =  0, Distributing orbital back into band + domain format took 8.890 ms
rank = 0, Subspace_Rotation used 12.006 ms

Total time for subspace rotation: 12.012 ms
rank = 0, Efermi =  -0.171811079199 calculate fermi energy took 0.075 ms
rank = 0, --- Calculate rho: sum over local bands took 3.123 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.884 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.568 ms
rank = 0, Calculating density took 957.267 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.938 ms
rank = 0, D2D took 2.058 ms
rank = 0, Transfering density took 2.065 ms
Etot    =   -13.081856681088
Eband   =    -4.300572107000
E1      =    10.605443512206
E2      =    -3.702667842600
E3      =    -5.329074102616
Exc     =    -4.809918231098
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 1.161e-06, dEband = 1.252e-04
rank = 0, Calculating/Estimating energy took 1.059 ms, Etot = -13.081856681, dEtot = 1.161e-06, dEband = 1.252e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0543337133774, which took 0.077 ms

iter_count = 102, r_2norm = 1.779e-06, tol*||rhs|| = 2.173e-06

Anderson update took 61.480 ms, out of which F'*F took 29.737 ms; b-Ax took 196.684 ms, out of which Lap took 175.680 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 450.765 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594111, int_b + int_rho = -1.710e-13, checking this took 0.149 ms
2-norm of RHS = 459.3982237632263, which took 0.192 ms

iter_count = 138, r_2norm = 4.406e-04, tol*||rhs|| = 4.594e-04

Anderson update took 87.472 ms, out of which F'*F took 39.176 ms; b-Ax took 264.870 ms, out of which Lap took 236.117 ms
Solving Poisson took 600.734 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 6.480153 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.409 ms
Total time for convolution: 	 convolve: 5.096273 
Total time for convolution: 	 convolve: 5.082632 
Total time for convolution: 	 convolve: 5.085490 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.828 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.329 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.478 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.971 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.484 ms

This SCF took 27880.394 ms, scf error = 3.514e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.134162, lowerbound = -0.713066, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 894.345 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.446 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.844 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.309 ms
rank =  0, finding HY took 14.908 ms
rank =  0, distributing HY into block cyclic form took 9.460 ms
rank =  0, finding Y'*HY took 2.489 ms
Rank 0, Project_Hamiltonian used 37.212 ms
Total time for projection: 37.227 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.712890680220703
    last  calculated eigval = 0.033967662281880
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71289068022070
lambda[   2] =  -0.49095306967050
lambda[   3] =  -0.42890690598836
lambda[   4] =  -0.26541477009822
lambda[   5] =  -0.25132614274832
lambda[   6] =  -0.14142842829631
lambda[   7] =  -0.03198940739839
lambda[   8] =  -0.01826989311391
lambda[   9] =   0.02059394228299
lambda[  10] =   0.02496831145280
lambda[  11] =   0.03396766228188
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.227 ms
rank =  0, subspace rotation using ScaLAPACK took 3.095 ms
rank =  0, Distributing orbital back into band + domain format took 8.816 ms
rank = 0, Subspace_Rotation used 11.932 ms

Total time for subspace rotation: 11.938 ms
rank = 0, Efermi =  -0.171667496438 calculate fermi energy took 0.074 ms
rank = 0, --- Calculate rho: sum over local bands took 3.086 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.326 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.968 ms
rank = 0, Calculating density took 961.274 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.151 ms
rank = 0, D2D took 2.270 ms
rank = 0, Transfering density took 2.278 ms
Etot    =   -13.081865537103
Eband   =    -4.298983138292
E1      =    10.604508611215
E2      =    -3.701917900065
E3      =    -5.329425568780
Exc     =    -4.810182678459
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 2.214e-06, dEband = 3.972e-04
rank = 0, Calculating/Estimating energy took 1.032 ms, Etot = -13.081865537, dEtot = 2.214e-06, dEband = 3.972e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0415947335085, which took 0.055 ms

iter_count = 108, r_2norm = 1.015e-06, tol*||rhs|| = 1.664e-06

Anderson update took 65.009 ms, out of which F'*F took 30.336 ms; b-Ax took 206.324 ms, out of which Lap took 183.767 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 478.776 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594113, int_b + int_rho = -1.528e-13, checking this took 0.154 ms
2-norm of RHS = 459.3995524777841, which took 0.175 ms

iter_count = 126, r_2norm = 3.994e-04, tol*||rhs|| = 4.594e-04

Anderson update took 76.457 ms, out of which F'*F took 36.810 ms; b-Ax took 246.498 ms, out of which Lap took 219.318 ms
Solving Poisson took 549.142 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.087135 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.086312 
Total time for convolution: 	 convolve: 5.090106 
Total time for convolution: 	 convolve: 5.079074 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.642 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.334 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 3.486 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.176 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.703 ms

This SCF took 26374.658 ms, scf error = 2.767e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.133968, lowerbound = -0.712891, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 896.160 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.390 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.850 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.262 ms
rank =  0, finding HY took 14.900 ms
rank =  0, distributing HY into block cyclic form took 8.284 ms
rank =  0, finding Y'*HY took 2.614 ms
Rank 0, Project_Hamiltonian used 36.096 ms
Total time for projection: 36.110 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.842 ms
rank = 0, Solve_Generalized_EigenProblem used 1.367 ms
    first calculated eigval = -0.712785513686853
    last  calculated eigval = 0.034194335268214
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71278551368685
lambda[   2] =  -0.49085159506283
lambda[   3] =  -0.42880451540502
lambda[   4] =  -0.26531675323423
lambda[   5] =  -0.25124138584268
lambda[   6] =  -0.14134439971921
lambda[   7] =  -0.03191887340391
lambda[   8] =  -0.01794005679167
lambda[   9] =   0.02044542045625
lambda[  10] =   0.02489165202816
lambda[  11] =   0.03419433526821
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.387 ms
rank =  0, subspace rotation using ScaLAPACK took 3.221 ms
rank =  0, Distributing orbital back into band + domain format took 8.258 ms
rank = 0, Subspace_Rotation used 11.496 ms

Total time for subspace rotation: 11.502 ms
rank = 0, Efermi =  -0.171583467937 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 3.086 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.966 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.555 ms
rank = 0, Calculating density took 961.915 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.909 ms
rank = 0, D2D took 2.014 ms
rank = 0, Transfering density took 2.020 ms
Etot    =   -13.081873710783
Eband   =    -4.297999527303
E1      =    10.604025767815
E2      =    -3.701378225297
E3      =    -5.329547371297
Exc     =    -4.810273747478
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 2.043e-06, dEband = 2.459e-04
rank = 0, Calculating/Estimating energy took 1.059 ms, Etot = -13.081873711, dEtot = 2.043e-06, dEband = 2.459e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0413136664179, which took 0.058 ms

iter_count = 102, r_2norm = 1.284e-06, tol*||rhs|| = 1.653e-06

Anderson update took 61.379 ms, out of which F'*F took 29.470 ms; b-Ax took 195.977 ms, out of which Lap took 175.427 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 452.314 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594113, int_b + int_rho = -1.492e-13, checking this took 0.154 ms
2-norm of RHS = 459.4010407370318, which took 0.196 ms

iter_count = 150, r_2norm = 3.865e-04, tol*||rhs|| = 4.594e-04

Anderson update took 91.410 ms, out of which F'*F took 43.369 ms; b-Ax took 291.739 ms, out of which Lap took 259.626 ms
Solving Poisson took 652.086 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.095807 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.087169 
Total time for convolution: 	 convolve: 5.119950 
Total time for convolution: 	 convolve: 5.081372 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.873 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.451 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.963 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.449 ms

This SCF took 26459.695 ms, scf error = 2.537e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.134194, lowerbound = -0.712786, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 902.804 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.260 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.890 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.170 ms
rank =  0, finding HY took 17.750 ms
rank =  0, distributing HY into block cyclic form took 8.307 ms
rank =  0, finding Y'*HY took 2.449 ms
Rank 0, Project_Hamiltonian used 39.246 ms
Total time for projection: 39.259 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.132 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -0.712662003006392
    last  calculated eigval = 0.035321244241538
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71266200300639
lambda[   2] =  -0.49072855746345
lambda[   3] =  -0.42867751401416
lambda[   4] =  -0.26519667096072
lambda[   5] =  -0.25114153432568
lambda[   6] =  -0.14123096825651
lambda[   7] =  -0.03182216859709
lambda[   8] =  -0.01709499104478
lambda[   9] =   0.02052672585006
lambda[  10] =   0.02512574267965
lambda[  11] =   0.03532124424154
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 3.218 ms
rank =  0, Distributing orbital back into band + domain format took 8.237 ms
rank = 0, Subspace_Rotation used 11.470 ms

Total time for subspace rotation: 11.476 ms
rank = 0, Efermi =  -0.171470036497 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 3.082 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.019 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.559 ms
rank = 0, Calculating density took 970.577 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.948 ms
rank = 0, D2D took 2.055 ms
rank = 0, Transfering density took 2.058 ms
Etot    =   -13.081882410818
Eband   =    -4.296812560380
E1      =    10.603509847903
E2      =    -3.700686778182
E3      =    -5.329596624890
Exc     =    -4.810311301002
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 2.175e-06, dEband = 2.967e-04
rank = 0, Calculating/Estimating energy took 1.052 ms, Etot = -13.081882411, dEtot = 2.175e-06, dEband = 2.967e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0355348735489, which took 0.068 ms

iter_count = 102, r_2norm = 1.047e-06, tol*||rhs|| = 1.421e-06

Anderson update took 61.706 ms, out of which F'*F took 29.550 ms; b-Ax took 196.090 ms, out of which Lap took 175.062 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 453.578 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594112, int_b + int_rho = -1.619e-13, checking this took 0.145 ms
2-norm of RHS = 459.4018640486320, which took 0.162 ms

iter_count = 138, r_2norm = 4.189e-04, tol*||rhs|| = 4.594e-04

Anderson update took 83.588 ms, out of which F'*F took 39.877 ms; b-Ax took 269.316 ms, out of which Lap took 239.664 ms
Solving Poisson took 598.740 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.092630 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.578 ms
Total time for convolution: 	 convolve: 5.095237 
Total time for convolution: 	 convolve: 5.085910 
Total time for convolution: 	 convolve: 5.104923 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 3.483 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.116 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.634 ms

This SCF took 26398.315 ms, scf error = 2.446e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.135321, lowerbound = -0.712662, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 885.577 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.353 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.857 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.861 ms
rank =  0, finding HY took 15.036 ms
rank =  0, distributing HY into block cyclic form took 8.306 ms
rank =  0, finding Y'*HY took 2.598 ms
Rank 0, Project_Hamiltonian used 36.863 ms
Total time for projection: 36.876 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.107 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -0.712503902712848
    last  calculated eigval = 0.036852326680734
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71250390271285
lambda[   2] =  -0.49057784726328
lambda[   3] =  -0.42852916733903
lambda[   4] =  -0.26504743241462
lambda[   5] =  -0.25100044329717
lambda[   6] =  -0.14108758818641
lambda[   7] =  -0.03169401206893
lambda[   8] =  -0.01620048001731
lambda[   9] =   0.02078321662289
lambda[  10] =   0.02542053591429
lambda[  11] =   0.03685232668073
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.228 ms
rank =  0, subspace rotation using ScaLAPACK took 3.237 ms
rank =  0, Distributing orbital back into band + domain format took 8.245 ms
rank = 0, Subspace_Rotation used 11.502 ms

Total time for subspace rotation: 11.509 ms
rank = 0, Efermi =  -0.171326656328 calculate fermi energy took 0.085 ms
rank = 0, --- Calculate rho: sum over local bands took 3.105 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.041 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.562 ms
rank = 0, Calculating density took 951.057 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.908 ms
rank = 0, D2D took 2.005 ms
rank = 0, Transfering density took 2.007 ms
Etot    =   -13.081886325619
Eband   =    -4.295317586892
E1      =    10.602744394893
E2      =    -3.699911738815
E3      =    -5.329783737797
Exc     =    -4.810456809820
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 9.787e-07, dEband = 3.737e-04
rank = 0, Calculating/Estimating energy took 1.077 ms, Etot = -13.081886326, dEtot = 9.787e-07, dEband = 3.737e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0400286085971, which took 0.061 ms

iter_count = 102, r_2norm = 1.085e-06, tol*||rhs|| = 1.601e-06

Anderson update took 61.489 ms, out of which F'*F took 29.279 ms; b-Ax took 196.044 ms, out of which Lap took 175.247 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 452.256 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594114, int_b + int_rho = -1.437e-13, checking this took 0.131 ms
2-norm of RHS = 459.4036213362701, which took 0.115 ms

iter_count = 126, r_2norm = 4.083e-04, tol*||rhs|| = 4.594e-04

Anderson update took 76.846 ms, out of which F'*F took 36.092 ms; b-Ax took 244.667 ms, out of which Lap took 217.804 ms
Solving Poisson took 548.116 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.089461 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.091959 
Total time for convolution: 	 convolve: 5.091118 
Total time for convolution: 	 convolve: 5.079082 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.847 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.858 ms
---Transfer Veff_loc: D2D took 3.497 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.947 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.478 ms

This SCF took 26382.250 ms, scf error = 2.170e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.136852, lowerbound = -0.712504, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 908.314 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 8.828 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.842 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.696 ms
rank =  0, finding HY took 14.948 ms
rank =  0, distributing HY into block cyclic form took 8.347 ms
rank =  0, finding Y'*HY took 2.626 ms
Rank 0, Project_Hamiltonian used 36.674 ms
Total time for projection: 36.686 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.201 ms
    first calculated eigval = -0.712494935004734
    last  calculated eigval = 0.038064957784144
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71249493500473
lambda[   2] =  -0.49055477528661
lambda[   3] =  -0.42850325545041
lambda[   4] =  -0.26503191533500
lambda[   5] =  -0.25098625105125
lambda[   6] =  -0.14107218163433
lambda[   7] =  -0.03171273660298
lambda[   8] =  -0.01614481475822
lambda[   9] =   0.02137961979924
lambda[  10] =   0.02502949024272
lambda[  11] =   0.03806495778414
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 3.193 ms
rank =  0, Distributing orbital back into band + domain format took 8.333 ms
rank = 0, Subspace_Rotation used 11.548 ms

Total time for subspace rotation: 11.555 ms
rank = 0, Efermi =  -0.171311249737 calculate fermi energy took 0.068 ms
rank = 0, --- Calculate rho: sum over local bands took 3.125 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.997 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.588 ms
rank = 0, Calculating density took 974.712 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.935 ms
rank = 0, D2D took 2.043 ms
rank = 0, Transfering density took 2.051 ms
Etot    =   -13.081892640531
Eband   =    -4.295142265094
E1      =    10.602757757251
E2      =    -3.699731426883
E3      =    -5.329730315921
Exc     =    -4.810418075080
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 1.579e-06, dEband = 4.383e-05
rank = 0, Calculating/Estimating energy took 1.127 ms, Etot = -13.081892641, dEtot = 1.579e-06, dEband = 4.383e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0390192681203, which took 0.076 ms

iter_count = 102, r_2norm = 1.091e-06, tol*||rhs|| = 1.561e-06

Anderson update took 61.379 ms, out of which F'*F took 29.543 ms; b-Ax took 195.148 ms, out of which Lap took 174.210 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.029 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594115, int_b + int_rho = -1.310e-13, checking this took 0.129 ms
2-norm of RHS = 459.4028253086475, which took 0.163 ms

iter_count = 78, r_2norm = 4.279e-04, tol*||rhs|| = 4.594e-04

Anderson update took 46.855 ms, out of which F'*F took 22.730 ms; b-Ax took 153.193 ms, out of which Lap took 135.888 ms
Solving Poisson took 343.076 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.168 ms
Total time for convolution: 	 convolve: 5.081465 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.920 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.092632 
Total time for convolution: 	 convolve: 5.095586 
Total time for convolution: 	 convolve: 5.083702 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 3.476 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.942 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.455 ms

This SCF took 26108.799 ms, scf error = 2.494e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.138065, lowerbound = -0.712495, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 898.539 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.389 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.862 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.269 ms
rank =  0, finding HY took 14.871 ms
rank =  0, distributing HY into block cyclic form took 8.291 ms
rank =  0, finding Y'*HY took 2.605 ms
Rank 0, Project_Hamiltonian used 36.068 ms
Total time for projection: 36.083 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.712466137796638
    last  calculated eigval = 0.037268303784337
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71246613779664
lambda[   2] =  -0.49053179234921
lambda[   3] =  -0.42848141491053
lambda[   4] =  -0.26500761068793
lambda[   5] =  -0.25096418496478
lambda[   6] =  -0.14104854938755
lambda[   7] =  -0.03167341340386
lambda[   8] =  -0.01598227687868
lambda[   9] =   0.02108215537770
lambda[  10] =   0.02516654751606
lambda[  11] =   0.03726830378434
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 3.210 ms
rank =  0, Distributing orbital back into band + domain format took 8.228 ms
rank = 0, Subspace_Rotation used 11.452 ms

Total time for subspace rotation: 11.458 ms
rank = 0, Efermi =  -0.171287617657 calculate fermi energy took 0.071 ms
rank = 0, --- Calculate rho: sum over local bands took 3.033 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.070 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.552 ms
rank = 0, Calculating density took 963.069 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.908 ms
rank = 0, D2D took 2.004 ms
rank = 0, Transfering density took 2.008 ms
Etot    =   -13.081893176594
Eband   =    -4.294902282256
E1      =    10.602584433620
E2      =    -3.699652655240
E3      =    -5.329783654594
Exc     =    -4.810459837381
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 1.340e-07, dEband = 6.000e-05
rank = 0, Calculating/Estimating energy took 1.100 ms, Etot = -13.081893177, dEtot = 1.340e-07, dEband = 6.000e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0215797054525, which took 0.072 ms

iter_count = 108, r_2norm = 6.456e-07, tol*||rhs|| = 8.632e-07

Anderson update took 65.288 ms, out of which F'*F took 31.169 ms; b-Ax took 207.948 ms, out of which Lap took 185.892 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 476.939 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594112, int_b + int_rho = -1.583e-13, checking this took 0.149 ms
2-norm of RHS = 459.4009188682083, which took 0.195 ms

iter_count = 126, r_2norm = 4.379e-04, tol*||rhs|| = 4.594e-04

Anderson update took 76.650 ms, out of which F'*F took 36.218 ms; b-Ax took 243.675 ms, out of which Lap took 216.544 ms
Solving Poisson took 546.616 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.090993 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.081874 
Total time for convolution: 	 convolve: 5.102073 
Total time for convolution: 	 convolve: 5.080457 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.454 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.392 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.236 ms

This SCF took 26365.012 ms, scf error = 2.294e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.137268, lowerbound = -0.712466, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 884.022 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.339 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.897 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.256 ms
rank =  0, finding HY took 14.826 ms
rank =  0, distributing HY into block cyclic form took 8.369 ms
rank =  0, finding Y'*HY took 2.550 ms
Rank 0, Project_Hamiltonian used 36.032 ms
Total time for projection: 36.045 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.712364120012779
    last  calculated eigval = 0.036856447528215
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71236412001278
lambda[   2] =  -0.49044755785164
lambda[   3] =  -0.42840546990344
lambda[   4] =  -0.26491794767196
lambda[   5] =  -0.25086356320187
lambda[   6] =  -0.14095401149144
lambda[   7] =  -0.03155880168749
lambda[   8] =  -0.01570321408066
lambda[   9] =   0.02103936584609
lambda[  10] =   0.02559253796220
lambda[  11] =   0.03685644752822
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 3.204 ms
rank =  0, Distributing orbital back into band + domain format took 8.211 ms
rank = 0, Subspace_Rotation used 11.429 ms

Total time for subspace rotation: 11.435 ms
rank = 0, Efermi =  -0.171193079553 calculate fermi energy took 0.069 ms
rank = 0, --- Calculate rho: sum over local bands took 3.076 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.942 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.552 ms
rank = 0, Calculating density took 948.425 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.906 ms
rank = 0, D2D took 2.005 ms
rank = 0, Transfering density took 2.007 ms
Etot    =   -13.081886457224
Eband   =    -4.293997318121
E1      =    10.601956531179
E2      =    -3.699323259371
E3      =    -5.330045760489
Exc     =    -4.810662889732
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 1.680e-06, dEband = 2.262e-04
rank = 0, Calculating/Estimating energy took 1.066 ms, Etot = -13.081886457, dEtot = 1.680e-06, dEband = 2.262e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0486305126592, which took 0.125 ms

iter_count = 96, r_2norm = 1.870e-06, tol*||rhs|| = 1.945e-06

Anderson update took 57.748 ms, out of which F'*F took 26.940 ms; b-Ax took 182.911 ms, out of which Lap took 162.935 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 426.362 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594111, int_b + int_rho = -1.710e-13, checking this took 0.137 ms
2-norm of RHS = 459.4033735368409, which took 0.174 ms

iter_count = 144, r_2norm = 4.044e-04, tol*||rhs|| = 4.594e-04

Anderson update took 86.720 ms, out of which F'*F took 41.586 ms; b-Ax took 280.921 ms, out of which Lap took 249.195 ms
Solving Poisson took 629.314 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.090303 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 45.002 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.373 ms
Total time for convolution: 	 convolve: 5.084797 
Total time for convolution: 	 convolve: 5.098650 
Total time for convolution: 	 convolve: 5.090914 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.351 ms
---Transfer Veff_loc: D2D took 4.605 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.123 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.762 ms

This SCF took 26417.200 ms, scf error = 1.786e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.136856, lowerbound = -0.712364, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 884.897 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.397 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.877 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.294 ms
rank =  0, finding HY took 14.834 ms
rank =  0, distributing HY into block cyclic form took 8.311 ms
rank =  0, finding Y'*HY took 2.558 ms
Rank 0, Project_Hamiltonian used 36.030 ms
Total time for projection: 36.042 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.712527476783362
    last  calculated eigval = 0.035909595450972
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71252747678336
lambda[   2] =  -0.49059384554453
lambda[   3] =  -0.42854920675095
lambda[   4] =  -0.26506033971303
lambda[   5] =  -0.25099265331252
lambda[   6] =  -0.14107804836767
lambda[   7] =  -0.03170897949873
lambda[   8] =  -0.01674632161722
lambda[   9] =   0.02097277637308
lambda[  10] =   0.02452237009837
lambda[  11] =   0.03590959545097
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 3.225 ms
rank =  0, Distributing orbital back into band + domain format took 8.209 ms
rank = 0, Subspace_Rotation used 11.449 ms

Total time for subspace rotation: 11.454 ms
rank = 0, Efermi =  -0.171317116520 calculate fermi energy took 0.071 ms
rank = 0, --- Calculate rho: sum over local bands took 3.113 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.906 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.592 ms
rank = 0, Calculating density took 949.383 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.963 ms
rank = 0, D2D took 2.063 ms
rank = 0, Transfering density took 2.066 ms
Etot    =   -13.081885845440
Eband   =    -4.295447045047
E1      =    10.602882276029
E2      =    -3.699922821012
E3      =    -5.329709830690
Exc     =    -4.810401927713
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 1.529e-07, dEband = 3.624e-04
rank = 0, Calculating/Estimating energy took 1.079 ms, Etot = -13.081885845, dEtot = 1.529e-07, dEband = 3.624e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0232932079736, which took 0.142 ms

iter_count = 108, r_2norm = 6.517e-07, tol*||rhs|| = 9.317e-07

Anderson update took 65.080 ms, out of which F'*F took 31.383 ms; b-Ax took 207.557 ms, out of which Lap took 185.156 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 477.985 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594112, int_b + int_rho = -1.601e-13, checking this took 0.080 ms
2-norm of RHS = 459.3984886112262, which took 1.300 ms

iter_count = 144, r_2norm = 4.304e-04, tol*||rhs|| = 4.594e-04

Anderson update took 86.690 ms, out of which F'*F took 41.576 ms; b-Ax took 280.724 ms, out of which Lap took 249.118 ms
Solving Poisson took 625.984 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.079182 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
Total time for convolution: 	 convolve: 5.088991 
Total time for convolution: 	 convolve: 5.080193 
Total time for convolution: 	 convolve: 5.080733 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.012 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.694 ms
---Transfer Veff_loc: D2D took 3.920 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.952 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.241 ms

This SCF took 26392.521 ms, scf error = 2.710e-04
-------------
SCF iter 24  
-------------

 Chebfilt 27, in Chebyshev filtering, lambda_cutoff = 0.135910, lowerbound = -0.712527, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 886.389 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.430 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.874 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.321 ms
rank =  0, finding HY took 14.855 ms
rank =  0, distributing HY into block cyclic form took 8.318 ms
rank =  0, finding Y'*HY took 2.595 ms
Rank 0, Project_Hamiltonian used 36.122 ms
Total time for projection: 36.134 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -0.712336043278142
    last  calculated eigval = 0.036120671197330
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71233604327814
lambda[   2] =  -0.49042726206749
lambda[   3] =  -0.42838718311617
lambda[   4] =  -0.26489879445671
lambda[   5] =  -0.25084901881664
lambda[   6] =  -0.14094514715220
lambda[   7] =  -0.03155910102437
lambda[   8] =  -0.01594166734769
lambda[   9] =   0.02050979922879
lambda[  10] =   0.02511749164743
lambda[  11] =   0.03612067119733
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 3.176 ms
rank =  0, Distributing orbital back into band + domain format took 8.224 ms
rank = 0, Subspace_Rotation used 11.415 ms

Total time for subspace rotation: 11.421 ms
rank = 0, Efermi =  -0.171184215356 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 3.116 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.899 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.556 ms
rank = 0, Calculating density took 950.861 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.943 ms
rank = 0, D2D took 2.041 ms
rank = 0, Transfering density took 2.043 ms
Etot    =   -13.081887424674
Eband   =    -4.293796604308
E1      =    10.601747156819
E2      =    -3.699317683704
E3      =    -5.330120787070
Exc     =    -4.810724647549
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 3.948e-07, dEband = 4.126e-04
rank = 0, Calculating/Estimating energy took 1.063 ms, Etot = -13.081887425, dEtot = 3.948e-07, dEband = 4.126e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0229974647714, which took 0.084 ms

iter_count = 108, r_2norm = 6.131e-07, tol*||rhs|| = 9.199e-07

Anderson update took 65.279 ms, out of which F'*F took 30.733 ms; b-Ax took 206.467 ms, out of which Lap took 184.535 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 479.351 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594111, int_b + int_rho = -1.783e-13, checking this took 0.145 ms
2-norm of RHS = 459.3961297823737, which took 0.156 ms

iter_count = 126, r_2norm = 4.202e-04, tol*||rhs|| = 4.594e-04

Anderson update took 75.555 ms, out of which F'*F took 36.055 ms; b-Ax took 243.901 ms, out of which Lap took 216.485 ms
Solving Poisson took 547.823 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.080689 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.084694 
Total time for convolution: 	 convolve: 5.087415 
Total time for convolution: 	 convolve: 5.078610 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.244 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.600 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.121 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.760 ms

This SCF took 26318.123 ms, scf error = 1.400e-04
-------------
SCF iter 25  
-------------

 Chebfilt 28, in Chebyshev filtering, lambda_cutoff = 0.136121, lowerbound = -0.712336, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 896.703 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.386 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.829 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.235 ms
rank =  0, finding HY took 14.897 ms
rank =  0, distributing HY into block cyclic form took 8.343 ms
rank =  0, finding Y'*HY took 2.605 ms
Rank 0, Project_Hamiltonian used 36.114 ms
Total time for projection: 36.128 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.712389552774969
    last  calculated eigval = 0.035277637035559
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71238955277497
lambda[   2] =  -0.49047363790636
lambda[   3] =  -0.42843022124360
lambda[   4] =  -0.26495203380081
lambda[   5] =  -0.25091121263309
lambda[   6] =  -0.14100444228499
lambda[   7] =  -0.03164163130687
lambda[   8] =  -0.01693101171205
lambda[   9] =   0.02016301233184
lambda[  10] =   0.02406814549072
lambda[  11] =   0.03527763703556
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 3.198 ms
rank =  0, Distributing orbital back into band + domain format took 8.313 ms
rank = 0, Subspace_Rotation used 11.526 ms

Total time for subspace rotation: 11.533 ms
rank = 0, Efermi =  -0.171243510394 calculate fermi energy took 0.081 ms
rank = 0, --- Calculate rho: sum over local bands took 3.072 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.908 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.578 ms
rank = 0, Calculating density took 961.297 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.915 ms
rank = 0, D2D took 2.016 ms
rank = 0, Transfering density took 2.018 ms
Etot    =   -13.081890468687
Eband   =    -4.294313317555
E1      =    10.601981737357
E2      =    -3.699624869533
E3      =    -5.330011666597
Exc     =    -4.810643624206
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 7.610e-07, dEband = 1.292e-04
rank = 0, Calculating/Estimating energy took 1.069 ms, Etot = -13.081890469, dEtot = 7.610e-07, dEband = 1.292e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0265408017072, which took 0.073 ms

iter_count = 102, r_2norm = 9.398e-07, tol*||rhs|| = 1.062e-06

Anderson update took 61.656 ms, out of which F'*F took 28.990 ms; b-Ax took 195.987 ms, out of which Lap took 174.552 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 452.268 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594111, int_b + int_rho = -1.728e-13, checking this took 0.132 ms
2-norm of RHS = 459.3948693643138, which took 0.142 ms

iter_count = 114, r_2norm = 4.427e-04, tol*||rhs|| = 4.594e-04

Anderson update took 68.655 ms, out of which F'*F took 32.903 ms; b-Ax took 221.770 ms, out of which Lap took 196.911 ms
Solving Poisson took 495.551 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.095541 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.383 ms
Total time for convolution: 	 convolve: 5.079895 
Total time for convolution: 	 convolve: 5.093636 
Total time for convolution: 	 convolve: 5.076245 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.556 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.943 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.536 ms

This SCF took 26264.161 ms, scf error = 1.249e-04
-------------
SCF iter 26  
-------------

 Chebfilt 29, in Chebyshev filtering, lambda_cutoff = 0.135278, lowerbound = -0.712390, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 902.678 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.403 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.825 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.246 ms
rank =  0, finding HY took 14.851 ms
rank =  0, distributing HY into block cyclic form took 8.310 ms
rank =  0, finding Y'*HY took 2.628 ms
Rank 0, Project_Hamiltonian used 36.067 ms
Total time for projection: 36.083 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.712369770547466
    last  calculated eigval = 0.035052190585076
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71236977054747
lambda[   2] =  -0.49045261730754
lambda[   3] =  -0.42840760054532
lambda[   4] =  -0.26493905524124
lambda[   5] =  -0.25091291223392
lambda[   6] =  -0.14099780043085
lambda[   7] =  -0.03165132823851
lambda[   8] =  -0.01741003126625
lambda[   9] =   0.02012197554653
lambda[  10] =   0.02350401359929
lambda[  11] =   0.03505219058508
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 3.177 ms
rank =  0, Distributing orbital back into band + domain format took 8.216 ms
rank = 0, Subspace_Rotation used 11.407 ms

Total time for subspace rotation: 11.414 ms
rank = 0, Efermi =  -0.171236868667 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 3.022 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.079 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.546 ms
rank = 0, Calculating density took 967.165 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.901 ms
rank = 0, D2D took 1.996 ms
rank = 0, Transfering density took 1.999 ms
Etot    =   -13.081892188716
Eband   =    -4.294163912589
E1      =    10.601849320742
E2      =    -3.699599113218
E3      =    -5.330040335373
Exc     =    -4.810665245049
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 4.300e-07, dEband = 3.735e-05
rank = 0, Calculating/Estimating energy took 1.933 ms, Etot = -13.081892189, dEtot = 4.300e-07, dEband = 3.735e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0199333841039, which took 0.063 ms

iter_count = 102, r_2norm = 6.913e-07, tol*||rhs|| = 7.973e-07

Anderson update took 63.241 ms, out of which F'*F took 29.154 ms; b-Ax took 194.769 ms, out of which Lap took 173.602 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.345 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594113, int_b + int_rho = -1.546e-13, checking this took 0.145 ms
2-norm of RHS = 459.3970425854583, which took 0.131 ms

iter_count = 144, r_2norm = 4.012e-04, tol*||rhs|| = 4.594e-04

Anderson update took 86.662 ms, out of which F'*F took 42.209 ms; b-Ax took 282.467 ms, out of which Lap took 250.529 ms
Solving Poisson took 629.070 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.096750 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
Total time for convolution: 	 convolve: 5.084600 
Total time for convolution: 	 convolve: 6.202138 
Total time for convolution: 	 convolve: 5.089360 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.228 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 3.469 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.961 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.462 ms

This SCF took 27542.930 ms, scf error = 1.059e-04
-------------
SCF iter 27  
-------------

 Chebfilt 30, in Chebyshev filtering, lambda_cutoff = 0.135052, lowerbound = -0.712370, upperbound = 267.566907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 894.994 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.358 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.845 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.224 ms
rank =  0, finding HY took 14.915 ms
rank =  0, distributing HY into block cyclic form took 8.280 ms
rank =  0, finding Y'*HY took 2.619 ms
Rank 0, Project_Hamiltonian used 36.075 ms
Total time for projection: 36.089 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.712284229113921
    last  calculated eigval = 0.034908816587408
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.71228422911392
lambda[   2] =  -0.49036922831879
lambda[   3] =  -0.42832563658611
lambda[   4] =  -0.26486391925508
lambda[   5] =  -0.25085704254517
lambda[   6] =  -0.14092958312250
lambda[   7] =  -0.03162511563326
lambda[   8] =  -0.01814683251490
lambda[   9] =   0.02088670961162
lambda[  10] =   0.02264001119593
lambda[  11] =   0.03490881658741
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 3.178 ms
rank =  0, Distributing orbital back into band + domain format took 8.238 ms
rank = 0, Subspace_Rotation used 11.431 ms

Total time for subspace rotation: 11.436 ms
rank = 0, Efermi =  -0.171168651442 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 3.003 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.138 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.550 ms
rank = 0, Calculating density took 959.554 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.908 ms
rank = 0, D2D took 2.846 ms
rank = 0, Transfering density took 2.848 ms
Etot    =   -13.081896292924
Eband   =    -4.293400112475
E1      =    10.601457951649
E2      =    -3.699198305033
E3      =    -5.330130819607
Exc     =    -4.810731456326
Esc     =   -23.608551800227
Entropy =    -0.000000000185
dE = 1.026e-06, dEband = 1.910e-04
rank = 0, Calculating/Estimating energy took 1.053 ms, Etot = -13.081896293, dEtot = 1.026e-06, dEband = 1.910e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0133934761476, which took 0.065 ms

iter_count = 102, r_2norm = 3.953e-07, tol*||rhs|| = 5.357e-07

Anderson update took 61.818 ms, out of which F'*F took 29.452 ms; b-Ax took 196.666 ms, out of which Lap took 175.489 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 450.724 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000594128, int_rho =  10.00000000594112, int_b + int_rho = -1.637e-13, checking this took 0.139 ms
2-norm of RHS = 459.3988943281216, which took 0.182 ms

iter_count = 120, r_2norm = 4.181e-04, tol*||rhs|| = 4.594e-04

Anderson update took 72.753 ms, out of which F'*F took 34.386 ms; b-Ax took 231.820 ms, out of which Lap took 205.907 ms
Solving Poisson took 520.177 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.080367 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.591 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.094352 
Total time for convolution: 	 convolve: 5.086773 
Total time for convolution: 	 convolve: 5.085524 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.775 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.506 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.993 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.533 ms

This SCF took 26304.249 ms, scf error = 7.252e-05
The last 11 occupations of kpoints #1 are (Nelectron = 10):
lambda[   1] =  -0.71228422911392, occ[   1] =   2.00000000000000
lambda[   2] =  -0.49036922831879, occ[   2] =   2.00000000000000
lambda[   3] =  -0.42832563658611, occ[   3] =   2.00000000000000
lambda[   4] =  -0.26486391925508, occ[   4] =   2.00000000000000
lambda[   5] =  -0.25085704254517, occ[   5] =   2.00000000000000
lambda[   6] =  -0.14092958312250, occ[   6] =   0.00000000594112
lambda[   7] =  -0.03162511563326, occ[   7] =   0.00000000000000
lambda[   8] =  -0.01814683251490, occ[   8] =   0.00000000000000
lambda[   9] =   0.02088670961162, occ[   9] =   0.00000000000000
lambda[  10] =   0.02264001119593, occ[  10] =   0.00000000000000
lambda[  11] =   0.03490881658741, occ[  11] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 10 (90%) = 0.000000000000000.
Occupation of state 11 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.388 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.296 ms, time for Allreduce/Reduce: 4.566 ms 
Time for calculating local force components: 11.774 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000000173504  -0.04331631869471   0.02464571371222
 -0.00000001293533   0.04331629708250   0.02464573538130
  0.00000101585324   0.00000019772858  -0.05760656855556
  0.00000053146739   0.00000154340425  -0.46462074068117
force_loc = 
  0.00000011588924   0.04619949740188  -0.02765801342708
 -0.00000005720528  -0.04620009906186  -0.02765792230033
 -0.00000212805015  -0.00000109741100   0.06224156923386
 -0.00000196662175   0.00000202632957   0.44913321434864
Time for calculating nonlocal force components: 24.216 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000011171295  -0.00000005338958   0.01075597510602
[0m[32m -0.00000000535145   0.00000015992936   0.00597883079969
[0mTime for calculating XC forces components: 13.574 ms
 Cartesian force = 
  0.00000076925472   0.00288264037743  -0.00297674811926
  0.00000058495991  -0.00288434030911  -0.00297663532343
 -0.00000056880934  -0.00000149140175   0.01542652737993
 -0.00000078540529   0.00000319133343  -0.00947314393724
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.347 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.361 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Time for printing density: 386.993 ms
The program took 753.504 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:32:55
Job ID:        2266610
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:34:00,vmem=8396K,walltime=00:12:50,mem=8168K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-32-2
---------------------------------------
