---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:36
Job ID:    2266747
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:40
Job ID:    2266747
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.063 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 19.346 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 8.
[32m
Time for finding element is 0.011 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 22.883 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 66.369 ms

Freeing SPARC_INPUT_MPI datatype took 0.018 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.991 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.101 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.355005	    7.870487	   10.000000	
    6.480731	   10.131164	   11.660773	
    6.480731	   10.131164	    8.339227	
   12.364911	    8.793208	   10.000000	
   13.519269	   12.129513	   10.000000	
    7.665071	    9.827018	   10.000000	
   11.937481	   10.820275	   10.000000	
    9.695057	   11.691224	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.193 ms
Set up communicators.

--set up spincomm took 2.312 ms

--set up kptcomm took 0.373 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.011 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.012 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.407 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.664 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.246 ms

Calculate_SplineDerivRadFun took 0.217 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.767 ms.
time spent on vectorized spline interp: 3.040 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.497 ms.
time spent on vectorized spline interp: 1.563 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.468 ms.
time spent on vectorized spline interp: 1.556 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.492 ms.

Calculating rb for all atom types took 15.392 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.053 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.010 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000209097, sum_int_rho = 17.4996446530081
PosCharge = 18.000000020910, NegCharge = -17.499644653008, scal_fac = 1.028592315891
After scaling, int_rho = 18.0000000209097, PosCharge + NegCharge - NetCharge = 1.421e-14
--Calculate Vref took 0.374 ms
--Calculate rho_guess took 1.903 ms

 integral of b = -18.0000000209097,
 int{b} + Nelectron + NetCharge = -2.091e-08,
 Esc = -44.5399096055221,
 MPI_Reduce took 7.677 ms

Calculating b & b_ref took 15.289 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.027 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.061 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.010 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.086 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 28.055 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090961, int_b + int_rho = -7.276e-15, checking this took 0.093 ms
2-norm of RHS = 670.0762235805739, which took 0.520 ms

iter_count = 420, r_2norm = 5.543e-04, tol*||rhs|| = 6.701e-04

Anderson update took 206.845 ms, out of which F'*F took 114.852 ms; b-Ax took 692.498 ms, out of which Lap took 653.351 ms
Solving Poisson took 1190.114 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.446 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
Total time for convolution: 	 convolve: 5.132332 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 63.642 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
Total time for convolution: 	 convolve: 5.115604 
Total time for convolution: 	 convolve: 5.091269 
Total time for convolution: 	 convolve: 5.155123 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.732 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.517 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.169 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.132 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.193 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
rank = 0, XC calculation took 24374.624 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 1.595 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 1.530 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.206 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.142 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.467 ms
    Lanczos iter 53, eigmin  = -0.919667488, eigmax = 264.930658701, err_eigmin = 1.288e-03, err_eigmax = 9.641e-03
rank =   0, Lanczos took 99.025 ms, eigmin = -0.919667488059, eigmax = 267.579965287523

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.280149, lowerbound = -1.019667, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 929.657 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 29.345 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.840 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.721 ms
rank =  0, Distribute data + matrix mult took 35.920 ms
rank =  0, finding HY took 18.134 ms
rank =  0, distributing HY into block cyclic form took 9.599 ms
rank =  0, finding Y'*HY took 6.266 ms
Rank 0, Project_Hamiltonian used 69.947 ms
Total time for projection: 70.245 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.317 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.588 ms
rank = 0, Solve_Generalized_EigenProblem used 0.909 ms
    first calculated eigval = 2.794865405035480
    last  calculated eigval = 3.223622752596803
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.79486540503548
lambda[   2] =   2.84749803006403
lambda[   3] =   2.88058830538251
lambda[   4] =   2.91712737280266
lambda[   5] =   2.93317496168830
lambda[   6] =   2.96128306657560
lambda[   7] =   2.99104312063257
lambda[   8] =   3.01520252961751
lambda[   9] =   3.04067794352325
lambda[  10] =   3.05007624156914
lambda[  11] =   3.09472641825196
lambda[  12] =   3.11278242917753
lambda[  13] =   3.13028843761259
lambda[  14] =   3.16479800368285
lambda[  15] =   3.22362275259680
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.943 ms
rank =  0, subspace rotation using ScaLAPACK took 1.810 ms
rank =  0, Distributing orbital back into band + domain format took 10.096 ms
rank = 0, Subspace_Rotation used 11.917 ms

Total time for subspace rotation: 11.920 ms
rank = 0, Efermi =   3.045377092680 calculate fermi energy took 0.062 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.323623, lowerbound = -1.019667, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 938.030 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 27.735 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.233 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.629 ms
rank =  0, Distribute data + matrix mult took 32.608 ms
rank =  0, finding HY took 17.066 ms
rank =  0, distributing HY into block cyclic form took 8.962 ms
rank =  0, finding Y'*HY took 5.104 ms
Rank 0, Project_Hamiltonian used 63.760 ms
Total time for projection: 63.764 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -0.514375702258147
    last  calculated eigval = 0.461362262620028
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.51437570225815
lambda[   2] =  -0.36983811873282
lambda[   3] =  -0.24245380043637
lambda[   4] =  -0.11225810986524
lambda[   5] =  -0.08399925145964
lambda[   6] =   0.00095216412757
lambda[   7] =   0.12982063822909
lambda[   8] =   0.28231108669057
lambda[   9] =   0.31938162450603
lambda[  10] =   0.33428372132497
lambda[  11] =   0.36711318695755
lambda[  12] =   0.38756796339975
lambda[  13] =   0.39735213403219
lambda[  14] =   0.43016345236417
lambda[  15] =   0.46136226262003
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.166 ms
rank =  0, subspace rotation using ScaLAPACK took 1.815 ms
rank =  0, Distributing orbital back into band + domain format took 8.954 ms
rank = 0, Subspace_Rotation used 10.778 ms

Total time for subspace rotation: 10.783 ms
rank = 0, Efermi =   0.326832673106 calculate fermi energy took 0.026 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.561362, lowerbound = -1.019667, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 934.957 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.330 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.163 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.547 ms
rank =  0, Distribute data + matrix mult took 23.052 ms
rank =  0, finding HY took 16.967 ms
rank =  0, distributing HY into block cyclic form took 9.077 ms
rank =  0, finding Y'*HY took 5.030 ms
Rank 0, Project_Hamiltonian used 54.159 ms
Total time for projection: 54.163 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -0.928580135711764
    last  calculated eigval = 0.151168428127154
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.92858013571176
lambda[   2] =  -0.75086228584278
lambda[   3] =  -0.61149496783629
lambda[   4] =  -0.50630504293310
lambda[   5] =  -0.49622915317284
lambda[   6] =  -0.46522228151767
lambda[   7] =  -0.42686986779092
lambda[   8] =  -0.32221711606690
lambda[   9] =  -0.18413781936692
lambda[  10] =   0.00968098240133
lambda[  11] =   0.06206208146234
lambda[  12] =   0.09067330368282
lambda[  13] =   0.11449381098106
lambda[  14] =   0.13654304832191
lambda[  15] =   0.15116842812715
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 1.788 ms
rank =  0, Distributing orbital back into band + domain format took 8.912 ms
rank = 0, Subspace_Rotation used 10.708 ms

Total time for subspace rotation: 10.712 ms
rank = 0, Efermi =  -0.019445350788 calculate fermi energy took 0.030 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.251168, lowerbound = -1.019667, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 926.007 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 27.795 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.147 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.719 ms
rank =  0, Distribute data + matrix mult took 32.674 ms
rank =  0, finding HY took 17.008 ms
rank =  0, distributing HY into block cyclic form took 8.883 ms
rank =  0, finding Y'*HY took 5.190 ms
Rank 0, Project_Hamiltonian used 63.785 ms
Total time for projection: 63.808 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.930929520804673
    last  calculated eigval = 0.098433203226408
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.93092952080467
lambda[   2] =  -0.75217521447888
lambda[   3] =  -0.61837455163935
lambda[   4] =  -0.52230557992296
lambda[   5] =  -0.50972234240591
lambda[   6] =  -0.48713409337383
lambda[   7] =  -0.43393469592450
lambda[   8] =  -0.34583797030570
lambda[   9] =  -0.30340606078970
lambda[  10] =  -0.09332201037295
lambda[  11] =   0.00877404057543
lambda[  12] =   0.03561385086631
lambda[  13] =   0.06024593091611
lambda[  14] =   0.07788784084714
lambda[  15] =   0.09843320322641
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.168 ms
rank =  0, subspace rotation using ScaLAPACK took 1.784 ms
rank =  0, Distributing orbital back into band + domain format took 8.929 ms
rank = 0, Subspace_Rotation used 10.722 ms

Total time for subspace rotation: 10.727 ms
rank = 0, Efermi =  -0.122448343602 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 1.381 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.427 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 4132.615 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
rank = 0, D2D took 3.029 ms
rank = 0, Transfering density took 3.038 ms
Etot    =   -25.448621203208
Eband   =    -9.807640061242
E1      =    20.392768075869
E2      =    -7.408033116336
E3      =    -9.758029770108
Exc     =    -8.659902498129
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 3.181e+00, dEband = 1.226e+00
rank = 0, Calculating/Estimating energy took 1.040 ms, Etot = -25.448621203, dEtot = 3.181e+00, dEband = 1.226e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 45.1389079112327, which took 0.230 ms

iter_count = 96, r_2norm = 1.393e-03, tol*||rhs|| = 1.806e-03

Anderson update took 45.914 ms, out of which F'*F took 27.314 ms; b-Ax took 164.565 ms, out of which Lap took 155.897 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 277.670 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090962, int_b + int_rho = 0.000e+00, checking this took 0.192 ms
2-norm of RHS = 666.2633594929237, which took 0.243 ms

iter_count = 282, r_2norm = 6.338e-04, tol*||rhs|| = 6.663e-04

Anderson update took 148.872 ms, out of which F'*F took 79.412 ms; b-Ax took 493.251 ms, out of which Lap took 460.462 ms
Solving Poisson took 906.218 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.460 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.115460 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 29.145 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.122009 
Total time for convolution: 	 convolve: 5.155173 
Total time for convolution: 	 convolve: 5.151725 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 1.312 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.129 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.141 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.154 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.977 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.857 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.856 ms

This SCF took 29935.323 ms, scf error = 1.978e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.198433, lowerbound = -0.930930, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 982.788 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.478 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.260 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.420 ms
rank =  0, Distribute data + matrix mult took 16.170 ms
rank =  0, finding HY took 20.256 ms
rank =  0, distributing HY into block cyclic form took 11.803 ms
rank =  0, finding Y'*HY took 5.857 ms
Rank 0, Project_Hamiltonian used 54.119 ms
Total time for projection: 54.138 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.229 ms
    first calculated eigval = -0.905339892239271
    last  calculated eigval = 0.068408585931045
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.90533989223927
lambda[   2] =  -0.72021735925255
lambda[   3] =  -0.59271926383576
lambda[   4] =  -0.49621291584198
lambda[   5] =  -0.48146982947061
lambda[   6] =  -0.45924887864865
lambda[   7] =  -0.40619973158124
lambda[   8] =  -0.32595899490740
lambda[   9] =  -0.28044832362488
lambda[  10] =  -0.09462106499589
lambda[  11] =  -0.02028782435005
lambda[  12] =   0.02334064463991
lambda[  13] =   0.03442481800893
lambda[  14] =   0.05106322755466
lambda[  15] =   0.06840858593105
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.249 ms
rank =  0, subspace rotation using ScaLAPACK took 3.947 ms
rank =  0, Distributing orbital back into band + domain format took 11.193 ms
rank = 0, Subspace_Rotation used 15.153 ms

Total time for subspace rotation: 15.156 ms
rank = 0, Efermi =  -0.123747398279 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 2.546 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.100 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.246 ms
rank = 0, Calculating density took 1058.306 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
rank = 0, D2D took 1.070 ms
rank = 0, Transfering density took 1.079 ms
Etot    =   -25.412339560028
Eband   =    -9.335630380783
E1      =    19.953992644006
E2      =    -7.386240974074
E3      =    -9.893157751181
Exc     =    -8.770190942357
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 4.535e-03, dEband = 5.900e-02
rank = 0, Calculating/Estimating energy took 1.697 ms, Etot = -25.412339560, dEtot = 4.535e-03, dEband = 5.900e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 12.9226996893835, which took 0.185 ms

iter_count = 102, r_2norm = 4.439e-04, tol*||rhs|| = 5.169e-04

Anderson update took 57.080 ms, out of which F'*F took 29.298 ms; b-Ax took 185.096 ms, out of which Lap took 170.799 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 360.480 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090970, int_b + int_rho = 7.640e-14, checking this took 0.162 ms
2-norm of RHS = 660.0962465192810, which took 0.306 ms

iter_count = 300, r_2norm = 5.899e-04, tol*||rhs|| = 6.601e-04

Anderson update took 167.709 ms, out of which F'*F took 83.906 ms; b-Ax took 539.007 ms, out of which Lap took 497.169 ms
Solving Poisson took 1029.431 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.925 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.320071 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.208896 
Total time for convolution: 	 convolve: 5.242424 
Total time for convolution: 	 convolve: 5.252291 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.128 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.212 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.140 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.236 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.932 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.837 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.788 ms

This SCF took 27467.782 ms, scf error = 1.371e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.168409, lowerbound = -0.905340, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 932.215 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.979 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.583 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.190 ms
rank =  0, Distribute data + matrix mult took 14.763 ms
rank =  0, finding HY took 17.541 ms
rank =  0, distributing HY into block cyclic form took 9.316 ms
rank =  0, finding Y'*HY took 5.038 ms
Rank 0, Project_Hamiltonian used 46.684 ms
Total time for projection: 46.696 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.166 ms
    first calculated eigval = -0.855669500813224
    last  calculated eigval = 0.051977873760571
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85566950081322
lambda[   2] =  -0.66059143313007
lambda[   3] =  -0.54220979173431
lambda[   4] =  -0.44593378910985
lambda[   5] =  -0.42638832465656
lambda[   6] =  -0.40651352033749
lambda[   7] =  -0.35176878451380
lambda[   8] =  -0.28647548097691
lambda[   9] =  -0.23169112650597
lambda[  10] =  -0.06511484841117
lambda[  11] =  -0.02903122708990
lambda[  12] =   0.01999426375744
lambda[  13] =   0.02597712388205
lambda[  14] =   0.03545173638569
lambda[  15] =   0.05197787376057
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.179 ms
rank =  0, subspace rotation using ScaLAPACK took 2.277 ms
rank =  0, Distributing orbital back into band + domain format took 9.027 ms
rank = 0, Subspace_Rotation used 11.314 ms

Total time for subspace rotation: 11.320 ms
rank = 0, Efermi =  -0.094241181665 calculate fermi energy took 0.072 ms
rank = 0, --- Calculate rho: sum over local bands took 1.380 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.284 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 995.715 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.334 ms
rank = 0, D2D took 1.856 ms
rank = 0, Transfering density took 1.858 ms
Etot    =   -25.376003447697
Eband   =    -8.414483504918
E1      =    19.142531335833
E2      =    -7.254763918928
E3      =   -10.199704254522
Exc     =    -9.018609845912
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 4.542e-03, dEband = 1.151e-01
rank = 0, Calculating/Estimating energy took 1.271 ms, Etot = -25.376003448, dEtot = 4.542e-03, dEband = 1.151e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.8619412183991, which took 0.213 ms

iter_count = 102, r_2norm = 1.857e-04, tol*||rhs|| = 2.745e-04

Anderson update took 60.376 ms, out of which F'*F took 29.406 ms; b-Ax took 177.823 ms, out of which Lap took 168.648 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 321.588 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090965, int_b + int_rho = 2.183e-14, checking this took 0.181 ms
2-norm of RHS = 660.0921753013449, which took 0.211 ms

iter_count = 264, r_2norm = 5.743e-04, tol*||rhs|| = 6.601e-04

Anderson update took 144.370 ms, out of which F'*F took 92.748 ms; b-Ax took 473.600 ms, out of which Lap took 450.062 ms
Solving Poisson took 808.292 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 5.115348 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 733.907 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.626696 
Total time for convolution: 	 convolve: 5.372311 
Total time for convolution: 	 convolve: 5.087877 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.138 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.137 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.303 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.961 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.840 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.821 ms

This SCF took 28093.486 ms, scf error = 3.821e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.151978, lowerbound = -0.855670, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 938.399 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.550 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.011 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.538 ms
rank =  0, Distribute data + matrix mult took 16.110 ms
rank =  0, finding HY took 17.028 ms
rank =  0, distributing HY into block cyclic form took 9.677 ms
rank =  0, finding Y'*HY took 5.861 ms
Rank 0, Project_Hamiltonian used 48.704 ms
Total time for projection: 48.717 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.164 ms
    first calculated eigval = -0.849665476340598
    last  calculated eigval = 0.040340962950812
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84966547634060
lambda[   2] =  -0.65327709920890
lambda[   3] =  -0.53431631268547
lambda[   4] =  -0.43797587263029
lambda[   5] =  -0.41899764174952
lambda[   6] =  -0.39926742985198
lambda[   7] =  -0.34334174048442
lambda[   8] =  -0.28105496658498
lambda[   9] =  -0.22546680012115
lambda[  10] =  -0.06191126004542
lambda[  11] =  -0.03103195100719
lambda[  12] =   0.01337215428463
lambda[  13] =   0.02088464464081
lambda[  14] =   0.03175050780547
lambda[  15] =   0.04034096295081
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 2.331 ms
rank =  0, Distributing orbital back into band + domain format took 9.142 ms
rank = 0, Subspace_Rotation used 11.485 ms

Total time for subspace rotation: 11.492 ms
rank = 0, Efermi =  -0.091037593256 calculate fermi energy took 0.074 ms
rank = 0, --- Calculate rho: sum over local bands took 1.411 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.474 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.103 ms
rank = 0, Calculating density took 1004.368 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.390 ms
rank = 0, D2D took 1.726 ms
rank = 0, Transfering density took 1.728 ms
Etot    =   -25.373460305130
Eband   =    -8.286726680609
E1      =    19.064424345888
E2      =    -7.195145791398
E3      =   -10.251309718498
Exc     =    -9.057703874156
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 3.179e-04, dEband = 1.597e-02
rank = 0, Calculating/Estimating energy took 1.115 ms, Etot = -25.373460305, dEtot = 3.179e-04, dEband = 1.597e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.2124424456521, which took 0.189 ms

iter_count = 114, r_2norm = 3.442e-05, tol*||rhs|| = 4.850e-05

Anderson update took 54.805 ms, out of which F'*F took 31.801 ms; b-Ax took 191.801 ms, out of which Lap took 181.327 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 327.644 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090969, int_b + int_rho = 6.912e-14, checking this took 0.225 ms
2-norm of RHS = 660.5325256720026, which took 0.211 ms

iter_count = 252, r_2norm = 6.547e-04, tol*||rhs|| = 6.605e-04

Anderson update took 120.938 ms, out of which F'*F took 71.768 ms; b-Ax took 430.413 ms, out of which Lap took 408.012 ms
Solving Poisson took 707.428 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.149 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Total time for convolution: 	 convolve: 5.139623 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.123167 
Total time for convolution: 	 convolve: 5.089956 
Total time for convolution: 	 convolve: 5.087143 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.145 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.138 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.195 ms
---Transfer Veff_loc: D2D took 0.879 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.768 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.672 ms

This SCF took 26719.838 ms, scf error = 1.655e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.140341, lowerbound = -0.849665, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 961.589 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.438 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.014 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.576 ms
rank =  0, Distribute data + matrix mult took 17.040 ms
rank =  0, finding HY took 17.203 ms
rank =  0, distributing HY into block cyclic form took 9.250 ms
rank =  0, finding Y'*HY took 5.090 ms
Rank 0, Project_Hamiltonian used 48.611 ms
Total time for projection: 48.627 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.550 ms
    first calculated eigval = -0.846454931690536
    last  calculated eigval = 0.031348476600522
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84645493169054
lambda[   2] =  -0.64943246512768
lambda[   3] =  -0.53019336688477
lambda[   4] =  -0.43375400012568
lambda[   5] =  -0.41499041485019
lambda[   6] =  -0.39510449051365
lambda[   7] =  -0.33871111133794
lambda[   8] =  -0.27806213831478
lambda[   9] =  -0.22212740713933
lambda[  10] =  -0.06003615848882
lambda[  11] =  -0.03161888658455
lambda[  12] =   0.01020374286003
lambda[  13] =   0.01953188257020
lambda[  14] =   0.02967107789792
lambda[  15] =   0.03134847660052
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.583 ms
rank =  0, subspace rotation using ScaLAPACK took 2.321 ms
rank =  0, Distributing orbital back into band + domain format took 9.174 ms
rank = 0, Subspace_Rotation used 11.506 ms

Total time for subspace rotation: 11.512 ms
rank = 0, Efermi =  -0.089162491755 calculate fermi energy took 3.009 ms
rank = 0, --- Calculate rho: sum over local bands took 1.487 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.488 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1028.436 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
rank = 0, D2D took 1.337 ms
rank = 0, Transfering density took 1.339 ms
Etot    =   -25.372617365200
Eband   =    -8.217660653224
E1      =    19.038092227920
E2      =    -7.145961529650
E3      =   -10.276025793513
Exc     =    -9.075126656908
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 1.054e-04, dEband = 8.633e-03
rank = 0, Calculating/Estimating energy took 1.259 ms, Etot = -25.372617365, dEtot = 1.054e-04, dEband = 8.633e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5651197579698, which took 0.251 ms

iter_count = 108, r_2norm = 2.201e-05, tol*||rhs|| = 2.260e-05

Anderson update took 51.663 ms, out of which F'*F took 31.298 ms; b-Ax took 183.571 ms, out of which Lap took 173.358 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.919 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090966, int_b + int_rho = 3.274e-14, checking this took 0.197 ms
2-norm of RHS = 660.9029135107847, which took 0.220 ms

iter_count = 252, r_2norm = 5.819e-04, tol*||rhs|| = 6.609e-04

Anderson update took 121.688 ms, out of which F'*F took 71.719 ms; b-Ax took 429.736 ms, out of which Lap took 406.165 ms
Solving Poisson took 712.079 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.148 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.155 ms
Total time for convolution: 	 convolve: 5.090827 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.283 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.335 ms
Total time for convolution: 	 convolve: 5.133755 
Total time for convolution: 	 convolve: 5.082917 
Total time for convolution: 	 convolve: 5.080557 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.508 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.203 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.948 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.277 ms

This SCF took 26481.790 ms, scf error = 5.671e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.131348, lowerbound = -0.846455, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 951.820 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 9.046 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.202 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.706 ms
rank =  0, Distribute data + matrix mult took 13.965 ms
rank =  0, finding HY took 17.390 ms
rank =  0, distributing HY into block cyclic form took 9.087 ms
rank =  0, finding Y'*HY took 4.396 ms
Rank 0, Project_Hamiltonian used 45.649 ms
Total time for projection: 45.663 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -0.841139845473259
    last  calculated eigval = 0.028304729218569
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84113984547326
lambda[   2] =  -0.64353739975279
lambda[   3] =  -0.52559095259202
lambda[   4] =  -0.42902358042398
lambda[   5] =  -0.40940617430950
lambda[   6] =  -0.38934660252604
lambda[   7] =  -0.33334844006294
lambda[   8] =  -0.27357944008565
lambda[   9] =  -0.21721009291581
lambda[  10] =  -0.05666618634554
lambda[  11] =  -0.03105695204273
lambda[  12] =   0.00982258655723
lambda[  13] =   0.01964144921623
lambda[  14] =   0.02572666856559
lambda[  15] =   0.02830472921857
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 1.894 ms
rank =  0, Distributing orbital back into band + domain format took 9.314 ms
rank = 0, Subspace_Rotation used 11.220 ms

Total time for subspace rotation: 11.225 ms
rank = 0, Efermi =  -0.085792519470 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 1.430 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.243 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.088 ms
rank = 0, Calculating density took 1013.774 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.386 ms
rank = 0, D2D took 2.721 ms
rank = 0, Transfering density took 2.727 ms
Etot    =   -25.372322122716
Eband   =    -8.124365057469
E1      =    18.990970999828
E2      =    -7.094790846840
E3      =   -10.294287617480
Exc     =    -9.088096923246
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 3.691e-05, dEband = 1.166e-02
rank = 0, Calculating/Estimating energy took 1.205 ms, Etot = -25.372322123, dEtot = 3.691e-05, dEband = 1.166e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3512376648650, which took 0.219 ms

iter_count = 114, r_2norm = 9.124e-06, tol*||rhs|| = 1.405e-05

Anderson update took 55.149 ms, out of which F'*F took 31.896 ms; b-Ax took 193.831 ms, out of which Lap took 183.213 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.723 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090969, int_b + int_rho = 6.548e-14, checking this took 0.187 ms
2-norm of RHS = 661.0131201357567, which took 0.210 ms

iter_count = 222, r_2norm = 5.395e-04, tol*||rhs|| = 6.610e-04

Anderson update took 106.588 ms, out of which F'*F took 63.098 ms; b-Ax took 377.142 ms, out of which Lap took 357.615 ms
Solving Poisson took 629.600 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 5.125934 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.914 ms
Total time for convolution: 	 convolve: 5.333048 
Total time for convolution: 	 convolve: 5.094955 
Total time for convolution: 	 convolve: 5.085045 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.781 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.138 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
---Transfer Veff_loc: D2D took 0.930 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.243 ms

This SCF took 26597.500 ms, scf error = 2.767e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.128305, lowerbound = -0.841140, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 943.496 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.086 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.086 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.392 ms
rank =  0, Distribute data + matrix mult took 21.577 ms
rank =  0, finding HY took 17.139 ms
rank =  0, distributing HY into block cyclic form took 9.127 ms
rank =  0, finding Y'*HY took 4.903 ms
Rank 0, Project_Hamiltonian used 53.674 ms
Total time for projection: 53.693 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.840223440828069
    last  calculated eigval = 0.027409845502829
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84022344082807
lambda[   2] =  -0.64282140792081
lambda[   3] =  -0.52475428538740
lambda[   4] =  -0.42813519217054
lambda[   5] =  -0.40864181648010
lambda[   6] =  -0.38864960393541
lambda[   7] =  -0.33259869484527
lambda[   8] =  -0.27261655557559
lambda[   9] =  -0.21632256230117
lambda[  10] =  -0.05583445140299
lambda[  11] =  -0.03039185810644
lambda[  12] =   0.01015822312450
lambda[  13] =   0.01973637884551
lambda[  14] =   0.02238734127722
lambda[  15] =   0.02740984550283
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 1.812 ms
rank =  0, Distributing orbital back into band + domain format took 9.148 ms
rank = 0, Subspace_Rotation used 10.972 ms

Total time for subspace rotation: 10.977 ms
rank = 0, Efermi =  -0.084960784648 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 1.412 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.262 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1013.206 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
rank = 0, D2D took 2.991 ms
rank = 0, Transfering density took 3.000 ms
Etot    =   -25.372324649245
Eband   =    -8.109527120056
E1      =    18.987937459938
E2      =    -7.082641353425
E3      =   -10.294226764448
Exc     =    -9.087693500850
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 3.158e-07, dEband = 1.855e-03
rank = 0, Calculating/Estimating energy took 1.216 ms, Etot = -25.372324649, dEtot = 3.158e-07, dEband = 1.855e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1961516608092, which took 0.221 ms

iter_count = 114, r_2norm = 5.388e-06, tol*||rhs|| = 7.846e-06

Anderson update took 55.505 ms, out of which F'*F took 32.452 ms; b-Ax took 193.441 ms, out of which Lap took 182.804 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.868 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090964, int_b + int_rho = 1.819e-14, checking this took 0.198 ms
2-norm of RHS = 661.0155939472887, which took 0.203 ms

iter_count = 228, r_2norm = 5.458e-04, tol*||rhs|| = 6.610e-04

Anderson update took 113.039 ms, out of which F'*F took 64.951 ms; b-Ax took 387.406 ms, out of which Lap took 366.997 ms
Solving Poisson took 646.768 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.104 ms
Total time for convolution: 	 convolve: 5.113099 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.149097 
Total time for convolution: 	 convolve: 5.085733 
Total time for convolution: 	 convolve: 5.081530 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.512 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.137 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
---Transfer Veff_loc: D2D took 0.866 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.308 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.185 ms

This SCF took 26410.458 ms, scf error = 1.895e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.127410, lowerbound = -0.840223, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 939.709 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.120 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.008 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.584 ms
rank =  0, Distribute data + matrix mult took 19.723 ms
rank =  0, finding HY took 17.104 ms
rank =  0, distributing HY into block cyclic form took 9.320 ms
rank =  0, finding Y'*HY took 4.717 ms
Rank 0, Project_Hamiltonian used 50.891 ms
Total time for projection: 50.908 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -0.837575312067962
    last  calculated eigval = 0.027824338347842
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83757531206796
lambda[   2] =  -0.64015178712788
lambda[   3] =  -0.52238815184991
lambda[   4] =  -0.42571300375947
lambda[   5] =  -0.40605438163359
lambda[   6] =  -0.38614366984138
lambda[   7] =  -0.33012592708061
lambda[   8] =  -0.27022389418906
lambda[   9] =  -0.21372793138982
lambda[  10] =  -0.05374603384660
lambda[  11] =  -0.02859756528168
lambda[  12] =   0.01198583939945
lambda[  13] =   0.02031695435030
lambda[  14] =   0.02252419152825
lambda[  15] =   0.02782433834784
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 1.830 ms
rank =  0, Distributing orbital back into band + domain format took 9.214 ms
rank = 0, Subspace_Rotation used 11.056 ms

Total time for subspace rotation: 11.060 ms
rank = 0, Efermi =  -0.082872367024 calculate fermi energy took 0.072 ms
rank = 0, --- Calculate rho: sum over local bands took 1.443 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.345 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1006.837 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.371 ms
rank = 0, D2D took 2.635 ms
rank = 0, Transfering density took 2.637 ms
Etot    =   -25.372312288706
Eband   =    -8.064208119003
E1      =    18.962324525066
E2      =    -7.061163535167
E3      =   -10.301556328823
Exc     =    -9.093238952610
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 1.545e-06, dEband = 5.665e-03
rank = 0, Calculating/Estimating energy took 1.232 ms, Etot = -25.372312289, dEtot = 1.545e-06, dEband = 5.665e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1217242155461, which took 0.144 ms

iter_count = 114, r_2norm = 3.472e-06, tol*||rhs|| = 4.869e-06

Anderson update took 55.551 ms, out of which F'*F took 32.490 ms; b-Ax took 193.374 ms, out of which Lap took 182.615 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.998 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090960, int_b + int_rho = -2.183e-14, checking this took 0.183 ms
2-norm of RHS = 661.0198385255537, which took 0.215 ms

iter_count = 216, r_2norm = 5.488e-04, tol*||rhs|| = 6.610e-04

Anderson update took 105.185 ms, out of which F'*F took 61.468 ms; b-Ax took 366.323 ms, out of which Lap took 347.006 ms
Solving Poisson took 611.819 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.101 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Total time for convolution: 	 convolve: 5.128048 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.142252 
Total time for convolution: 	 convolve: 5.114043 
Total time for convolution: 	 convolve: 5.091112 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.514 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
---Transfer Veff_loc: D2D took 1.996 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.312 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.322 ms

This SCF took 26404.823 ms, scf error = 1.192e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.127824, lowerbound = -0.837575, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 936.980 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 57.671 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.006 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.625 ms
rank =  0, Distribute data + matrix mult took 62.315 ms
rank =  0, finding HY took 17.018 ms
rank =  0, distributing HY into block cyclic form took 9.262 ms
rank =  0, finding Y'*HY took 5.046 ms
Rank 0, Project_Hamiltonian used 93.670 ms
Total time for projection: 93.692 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -0.836491838775034
    last  calculated eigval = 0.029356812388789
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83649183877503
lambda[   2] =  -0.63908241384029
lambda[   3] =  -0.52137349098843
lambda[   4] =  -0.42465892610672
lambda[   5] =  -0.40498439599933
lambda[   6] =  -0.38501675565644
lambda[   7] =  -0.32905107996220
lambda[   8] =  -0.26911624448474
lambda[   9] =  -0.21256874426168
lambda[  10] =  -0.05249334392132
lambda[  11] =  -0.02615960650316
lambda[  12] =   0.01453400404487
lambda[  13] =   0.02119219870304
lambda[  14] =   0.02453790055518
lambda[  15] =   0.02935681238879
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 1.815 ms
rank =  0, Distributing orbital back into band + domain format took 9.153 ms
rank = 0, Subspace_Rotation used 10.978 ms

Total time for subspace rotation: 10.983 ms
rank = 0, Efermi =  -0.081619677205 calculate fermi energy took 0.073 ms
rank = 0, --- Calculate rho: sum over local bands took 1.413 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.330 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.083 ms
rank = 0, Calculating density took 1046.774 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.363 ms
rank = 0, D2D took 2.743 ms
rank = 0, Transfering density took 2.746 ms
Etot    =   -25.372336900870
Eband   =    -8.044687781247
E1      =    18.954246804980
E2      =    -7.049527439710
E3      =   -10.302186025014
Exc     =    -9.093699783177
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 3.077e-06, dEband = 2.440e-03
rank = 0, Calculating/Estimating energy took 1.230 ms, Etot = -25.372336901, dEtot = 3.077e-06, dEband = 2.440e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0700535194154, which took 0.267 ms

iter_count = 114, r_2norm = 2.089e-06, tol*||rhs|| = 2.802e-06

Anderson update took 55.967 ms, out of which F'*F took 32.005 ms; b-Ax took 192.638 ms, out of which Lap took 181.870 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.925 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090970, int_b + int_rho = 7.276e-14, checking this took 0.069 ms
2-norm of RHS = 661.0052429588920, which took 0.227 ms

iter_count = 198, r_2norm = 5.785e-04, tol*||rhs|| = 6.610e-04

Anderson update took 96.400 ms, out of which F'*F took 56.231 ms; b-Ax took 335.200 ms, out of which Lap took 317.657 ms
Solving Poisson took 559.416 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 5.113440 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.145576 
Total time for convolution: 	 convolve: 5.083612 
Total time for convolution: 	 convolve: 5.092069 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.519 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.146 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.892 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.317 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.222 ms

This SCF took 26356.291 ms, scf error = 7.045e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.129357, lowerbound = -0.836492, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 949.245 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.185 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.065 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.703 ms
rank =  0, Distribute data + matrix mult took 13.962 ms
rank =  0, finding HY took 17.277 ms
rank =  0, distributing HY into block cyclic form took 9.134 ms
rank =  0, finding Y'*HY took 4.805 ms
Rank 0, Project_Hamiltonian used 45.215 ms
Total time for projection: 45.228 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -0.835666354063558
    last  calculated eigval = 0.030723533064593
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83566635406356
lambda[   2] =  -0.63818148720859
lambda[   3] =  -0.52055585382005
lambda[   4] =  -0.42382698271997
lambda[   5] =  -0.40411613799603
lambda[   6] =  -0.38410550107531
lambda[   7] =  -0.32816541199599
lambda[   8] =  -0.26830277199023
lambda[   9] =  -0.21174700595728
lambda[  10] =  -0.05155282594836
lambda[  11] =  -0.02391356850250
lambda[  12] =   0.01695080293192
lambda[  13] =   0.02246469393745
lambda[  14] =   0.02657744776620
lambda[  15] =   0.03072353306459
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 1.795 ms
rank =  0, Distributing orbital back into band + domain format took 9.078 ms
rank = 0, Subspace_Rotation used 10.885 ms

Total time for subspace rotation: 10.890 ms
rank = 0, Efermi =  -0.080679159183 calculate fermi energy took 0.068 ms
rank = 0, --- Calculate rho: sum over local bands took 1.416 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.337 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1010.485 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.358 ms
rank = 0, D2D took 2.811 ms
rank = 0, Transfering density took 2.814 ms
Etot    =   -25.372362651206
Eband   =    -8.029335014732
E1      =    18.946267974080
E2      =    -7.041847257958
E3      =   -10.303719365013
Exc     =    -9.094952627375
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 3.219e-06, dEband = 1.919e-03
rank = 0, Calculating/Estimating energy took 1.222 ms, Etot = -25.372362651, dEtot = 3.219e-06, dEband = 1.919e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0587006186633, which took 0.258 ms

iter_count = 114, r_2norm = 1.525e-06, tol*||rhs|| = 2.348e-06

Anderson update took 56.868 ms, out of which F'*F took 32.048 ms; b-Ax took 192.575 ms, out of which Lap took 181.734 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 330.330 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090961, int_b + int_rho = -7.276e-15, checking this took 0.236 ms
2-norm of RHS = 661.0082628685590, which took 0.187 ms

iter_count = 180, r_2norm = 6.422e-04, tol*||rhs|| = 6.610e-04

Anderson update took 89.887 ms, out of which F'*F took 50.721 ms; b-Ax took 304.365 ms, out of which Lap took 288.332 ms
Solving Poisson took 510.851 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Total time for convolution: 	 convolve: 5.117153 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.976 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.129919 
Total time for convolution: 	 convolve: 5.100929 
Total time for convolution: 	 convolve: 5.093020 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.507 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.143 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
---Transfer Veff_loc: D2D took 0.862 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.307 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.183 ms

This SCF took 26301.927 ms, scf error = 4.766e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.130724, lowerbound = -0.835666, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 951.433 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.232 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.984 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.137 ms
rank =  0, Distribute data + matrix mult took 13.365 ms
rank =  0, finding HY took 17.170 ms
rank =  0, distributing HY into block cyclic form took 9.207 ms
rank =  0, finding Y'*HY took 4.841 ms
Rank 0, Project_Hamiltonian used 44.606 ms
Total time for projection: 44.620 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.834897972150283
    last  calculated eigval = 0.031557576441164
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83489797215028
lambda[   2] =  -0.63741928909567
lambda[   3] =  -0.51987179128235
lambda[   4] =  -0.42313100107213
lambda[   5] =  -0.40337721861550
lambda[   6] =  -0.38337429798849
lambda[   7] =  -0.32745608988355
lambda[   8] =  -0.26760213533755
lambda[   9] =  -0.21106279108384
lambda[  10] =  -0.05078533615546
lambda[  11] =  -0.02210217319840
lambda[  12] =   0.01865128416380
lambda[  13] =   0.02377943913106
lambda[  14] =   0.02791542880335
lambda[  15] =   0.03155757644116
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 1.787 ms
rank =  0, Distributing orbital back into band + domain format took 9.044 ms
rank = 0, Subspace_Rotation used 10.842 ms

Total time for subspace rotation: 10.848 ms
rank = 0, Efermi =  -0.079911669382 calculate fermi energy took 0.072 ms
rank = 0, --- Calculate rho: sum over local bands took 1.440 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.385 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1012.096 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.372 ms
rank = 0, D2D took 2.742 ms
rank = 0, Transfering density took 2.744 ms
Etot    =   -25.372415608894
Eband   =    -8.016385174081
E1      =    18.939086124630
E2      =    -7.035731975968
E3      =   -10.305256439039
Exc     =    -9.096195368301
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 6.620e-06, dEband = 1.619e-03
rank = 0, Calculating/Estimating energy took 2.070 ms, Etot = -25.372415609, dEtot = 6.620e-06, dEband = 1.619e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0318226884426, which took 0.296 ms

iter_count = 114, r_2norm = 8.253e-07, tol*||rhs|| = 1.273e-06

Anderson update took 57.292 ms, out of which F'*F took 32.489 ms; b-Ax took 192.956 ms, out of which Lap took 182.127 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 330.470 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090974, int_b + int_rho = 1.201e-13, checking this took 0.185 ms
2-norm of RHS = 661.0203902280556, which took 0.208 ms

iter_count = 174, r_2norm = 6.167e-04, tol*||rhs|| = 6.610e-04

Anderson update took 86.441 ms, out of which F'*F took 49.178 ms; b-Ax took 293.820 ms, out of which Lap took 278.211 ms
Solving Poisson took 494.047 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.126 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.119728 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.767 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.106016 
Total time for convolution: 	 convolve: 5.136893 
Total time for convolution: 	 convolve: 5.087700 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.138 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.143 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
---Transfer Veff_loc: D2D took 0.877 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.198 ms

This SCF took 26272.923 ms, scf error = 3.456e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.131558, lowerbound = -0.834898, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 946.188 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 9.070 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.091 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.353 ms
rank =  0, Distribute data + matrix mult took 13.526 ms
rank =  0, finding HY took 17.273 ms
rank =  0, distributing HY into block cyclic form took 9.218 ms
rank =  0, finding Y'*HY took 4.713 ms
Rank 0, Project_Hamiltonian used 44.759 ms
Total time for projection: 44.774 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.163 ms
    first calculated eigval = -0.834566973705518
    last  calculated eigval = 0.032815038798733
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83456697370552
lambda[   2] =  -0.63710644387330
lambda[   3] =  -0.51955080437976
lambda[   4] =  -0.42280117712147
lambda[   5] =  -0.40305718463845
lambda[   6] =  -0.38304104292341
lambda[   7] =  -0.32713341049301
lambda[   8] =  -0.26726069419051
lambda[   9] =  -0.21074107443827
lambda[  10] =  -0.05034812980018
lambda[  11] =  -0.01929697318711
lambda[  12] =   0.02102806235873
lambda[  13] =   0.02564708737684
lambda[  14] =   0.03064934162543
lambda[  15] =   0.03281503879873
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 1.854 ms
rank =  0, Distributing orbital back into band + domain format took 9.052 ms
rank = 0, Subspace_Rotation used 10.918 ms

Total time for subspace rotation: 10.923 ms
rank = 0, Efermi =  -0.079474462938 calculate fermi energy took 0.073 ms
rank = 0, --- Calculate rho: sum over local bands took 1.503 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.254 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1007.026 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.281 ms
rank = 0, D2D took 2.723 ms
rank = 0, Transfering density took 2.725 ms
Etot    =   -25.372454711640
Eband   =    -8.010517612580
E1      =    18.936784293633
E2      =    -7.032119808921
E3      =   -10.305391001416
Exc     =    -9.096322596880
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 4.888e-06, dEband = 7.334e-04
rank = 0, Calculating/Estimating energy took 1.206 ms, Etot = -25.372454712, dEtot = 4.888e-06, dEband = 7.334e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0300056656761, which took 0.175 ms

iter_count = 114, r_2norm = 7.229e-07, tol*||rhs|| = 1.200e-06

Anderson update took 56.664 ms, out of which F'*F took 32.474 ms; b-Ax took 192.876 ms, out of which Lap took 182.187 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 330.757 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090969, int_b + int_rho = 6.548e-14, checking this took 0.155 ms
2-norm of RHS = 661.0227714620827, which took 0.197 ms

iter_count = 144, r_2norm = 5.480e-04, tol*||rhs|| = 6.610e-04

Anderson update took 71.755 ms, out of which F'*F took 40.817 ms; b-Ax took 243.408 ms, out of which Lap took 230.639 ms
Solving Poisson took 409.062 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.131 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Total time for convolution: 	 convolve: 5.121361 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.115191 
Total time for convolution: 	 convolve: 5.161809 
Total time for convolution: 	 convolve: 5.088879 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.088 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.364 ms
---Transfer Veff_loc: D2D took 0.931 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.247 ms

This SCF took 26240.556 ms, scf error = 2.102e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132815, lowerbound = -0.834567, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 943.858 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 13.753 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.053 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.284 ms
rank =  0, Distribute data + matrix mult took 18.101 ms
rank =  0, finding HY took 17.163 ms
rank =  0, distributing HY into block cyclic form took 9.264 ms
rank =  0, finding Y'*HY took 4.669 ms
Rank 0, Project_Hamiltonian used 49.231 ms
Total time for projection: 49.245 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.834407513141494
    last  calculated eigval = 0.033126695284893
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83440751314149
lambda[   2] =  -0.63694457583531
lambda[   3] =  -0.51939580404806
lambda[   4] =  -0.42264425182041
lambda[   5] =  -0.40289769321376
lambda[   6] =  -0.38288309304139
lambda[   7] =  -0.32697862375843
lambda[   8] =  -0.26710507213545
lambda[   9] =  -0.21058081294480
lambda[  10] =  -0.05017887256361
lambda[  11] =  -0.01851341627452
lambda[  12] =   0.02164581766662
lambda[  13] =   0.02580168462890
lambda[  14] =   0.03099429487172
lambda[  15] =   0.03312669528489
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 1.799 ms
rank =  0, Distributing orbital back into band + domain format took 9.167 ms
rank = 0, Subspace_Rotation used 10.977 ms

Total time for subspace rotation: 10.983 ms
rank = 0, Efermi =  -0.079305205788 calculate fermi energy took 0.071 ms
rank = 0, --- Calculate rho: sum over local bands took 2.166 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.687 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1009.167 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.380 ms
rank = 0, D2D took 2.825 ms
rank = 0, Transfering density took 2.831 ms
Etot    =   -25.372482649830
Eband   =    -8.007674880927
E1      =    18.935323308409
E2      =    -7.030658237075
E3      =   -10.305659684864
Exc     =    -9.096539393100
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 3.492e-06, dEband = 3.553e-04
rank = 0, Calculating/Estimating energy took 1.801 ms, Etot = -25.372482650, dEtot = 3.492e-06, dEband = 3.553e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0247134418374, which took 0.254 ms

iter_count = 108, r_2norm = 9.305e-07, tol*||rhs|| = 9.885e-07

Anderson update took 64.749 ms, out of which F'*F took 30.881 ms; b-Ax took 182.850 ms, out of which Lap took 172.736 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 324.127 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090964, int_b + int_rho = 1.819e-14, checking this took 0.185 ms
2-norm of RHS = 661.0246243535599, which took 0.210 ms

iter_count = 138, r_2norm = 5.915e-04, tol*||rhs|| = 6.610e-04

Anderson update took 68.731 ms, out of which F'*F took 39.193 ms; b-Ax took 233.171 ms, out of which Lap took 220.870 ms
Solving Poisson took 392.385 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.150 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Total time for convolution: 	 convolve: 5.124607 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.117187 
Total time for convolution: 	 convolve: 5.151782 
Total time for convolution: 	 convolve: 5.084840 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.484 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.440 ms
---Transfer Veff_loc: D2D took 0.881 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.204 ms

This SCF took 26214.028 ms, scf error = 1.570e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133127, lowerbound = -0.834408, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 958.928 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 9.111 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.062 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.354 ms
rank =  0, Distribute data + matrix mult took 13.537 ms
rank =  0, finding HY took 17.147 ms
rank =  0, distributing HY into block cyclic form took 9.181 ms
rank =  0, finding Y'*HY took 4.930 ms
Rank 0, Project_Hamiltonian used 44.823 ms
Total time for projection: 44.835 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -0.834370290755163
    last  calculated eigval = 0.032986968816658
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83437029075516
lambda[   2] =  -0.63689080084783
lambda[   3] =  -0.51933375490792
lambda[   4] =  -0.42258401022266
lambda[   5] =  -0.40284761004069
lambda[   6] =  -0.38282764596819
lambda[   7] =  -0.32692180420591
lambda[   8] =  -0.26705093802272
lambda[   9] =  -0.21053666021976
lambda[  10] =  -0.05016730812953
lambda[  11] =  -0.01817201152660
lambda[  12] =   0.02202190547420
lambda[  13] =   0.02586590842332
lambda[  14] =   0.03118115130643
lambda[  15] =   0.03298696881666
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 2.376 ms
rank =  0, Distributing orbital back into band + domain format took 9.328 ms
rank = 0, Subspace_Rotation used 11.719 ms

Total time for subspace rotation: 11.726 ms
rank = 0, Efermi =  -0.079293641348 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 1.379 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.228 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.084 ms
rank = 0, Calculating density took 1021.386 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.381 ms
rank = 0, D2D took 1.289 ms
rank = 0, Transfering density took 1.295 ms
Etot    =   -25.372511469102
Eband   =    -8.006727031431
E1      =    18.935004259033
E2      =    -7.030037465998
E3      =   -10.305530337823
Exc     =    -9.096446894377
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 3.602e-06, dEband = 1.185e-04
rank = 0, Calculating/Estimating energy took 1.224 ms, Etot = -25.372511469, dEtot = 3.602e-06, dEband = 1.185e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0227899659406, which took 0.204 ms

iter_count = 108, r_2norm = 8.817e-07, tol*||rhs|| = 9.116e-07

Anderson update took 54.182 ms, out of which F'*F took 30.381 ms; b-Ax took 182.449 ms, out of which Lap took 172.405 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 313.065 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090971, int_b + int_rho = 8.731e-14, checking this took 0.098 ms
2-norm of RHS = 661.0243395374258, which took 0.208 ms

iter_count = 90, r_2norm = 5.668e-04, tol*||rhs|| = 6.610e-04

Anderson update took 44.699 ms, out of which F'*F took 25.318 ms; b-Ax took 152.335 ms, out of which Lap took 144.314 ms
Solving Poisson took 256.651 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Total time for convolution: 	 convolve: 5.120021 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.111791 
Total time for convolution: 	 convolve: 5.148048 
Total time for convolution: 	 convolve: 5.133776 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.139 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.101 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.196 ms
---Transfer Veff_loc: D2D took 0.847 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.173 ms

This SCF took 26105.275 ms, scf error = 1.353e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.132987, lowerbound = -0.834370, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 953.835 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 9.213 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.123 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.151 ms
rank =  0, Distribute data + matrix mult took 13.499 ms
rank =  0, finding HY took 17.240 ms
rank =  0, distributing HY into block cyclic form took 9.247 ms
rank =  0, finding Y'*HY took 4.685 ms
Rank 0, Project_Hamiltonian used 44.710 ms
Total time for projection: 44.727 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -0.834324953995283
    last  calculated eigval = 0.032988327916259
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83432495399528
lambda[   2] =  -0.63684919051093
lambda[   3] =  -0.51929579130848
lambda[   4] =  -0.42254484850880
lambda[   5] =  -0.40280657091152
lambda[   6] =  -0.38278790900438
lambda[   7] =  -0.32688374431099
lambda[   8] =  -0.26701101096387
lambda[   9] =  -0.21049550751256
lambda[  10] =  -0.05014206197694
lambda[  11] =  -0.01796297455088
lambda[  12] =   0.02211231866336
lambda[  13] =   0.02569277182550
lambda[  14] =   0.03138181592190
lambda[  15] =   0.03298832791626
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 1.827 ms
rank =  0, Distributing orbital back into band + domain format took 9.831 ms
rank = 0, Subspace_Rotation used 11.669 ms

Total time for subspace rotation: 11.674 ms
rank = 0, Efermi =  -0.079268395088 calculate fermi energy took 0.093 ms
rank = 0, --- Calculate rho: sum over local bands took 1.422 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.065 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1015.423 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.392 ms
rank = 0, D2D took 1.937 ms
rank = 0, Transfering density took 1.939 ms
Etot    =   -25.372513786416
Eband   =    -8.005999055102
E1      =    18.934600957713
E2      =    -7.029692077081
E3      =   -10.305610818861
Exc     =    -9.096508978820
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 2.897e-07, dEband = 9.100e-05
rank = 0, Calculating/Estimating energy took 1.462 ms, Etot = -25.372513786, dEtot = 2.897e-07, dEband = 9.100e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0147126657284, which took 0.218 ms

iter_count = 108, r_2norm = 4.908e-07, tol*||rhs|| = 5.885e-07

Anderson update took 53.958 ms, out of which F'*F took 30.645 ms; b-Ax took 182.371 ms, out of which Lap took 172.153 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 313.147 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090965, int_b + int_rho = 2.910e-14, checking this took 0.195 ms
2-norm of RHS = 661.0233174456977, which took 0.220 ms

iter_count = 138, r_2norm = 5.354e-04, tol*||rhs|| = 6.610e-04

Anderson update took 68.899 ms, out of which F'*F took 38.929 ms; b-Ax took 233.105 ms, out of which Lap took 220.735 ms
Solving Poisson took 392.411 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Total time for convolution: 	 convolve: 5.114607 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.707 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.124804 
Total time for convolution: 	 convolve: 5.152544 
Total time for convolution: 	 convolve: 5.093144 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.692 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.219 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.166 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
---Transfer Veff_loc: D2D took 0.895 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.221 ms

This SCF took 26197.869 ms, scf error = 1.158e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.132988, lowerbound = -0.834325, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 952.974 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 9.182 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.067 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.538 ms
rank =  0, Distribute data + matrix mult took 13.800 ms
rank =  0, finding HY took 17.212 ms
rank =  0, distributing HY into block cyclic form took 9.193 ms
rank =  0, finding Y'*HY took 4.779 ms
Rank 0, Project_Hamiltonian used 45.009 ms
Total time for projection: 45.022 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.834273861487237
    last  calculated eigval = 0.033562631544142
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83427386148724
lambda[   2] =  -0.63680042782765
lambda[   3] =  -0.51924523507133
lambda[   4] =  -0.42249373964513
lambda[   5] =  -0.40275792561017
lambda[   6] =  -0.38273630438208
lambda[   7] =  -0.32683244734330
lambda[   8] =  -0.26696169316057
lambda[   9] =  -0.21045961676537
lambda[  10] =  -0.05018140535203
lambda[  11] =  -0.01793075216173
lambda[  12] =   0.02172716578717
lambda[  13] =   0.02557033951991
lambda[  14] =   0.03139422293673
lambda[  15] =   0.03356263154414
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.606 ms
rank =  0, subspace rotation using ScaLAPACK took 1.801 ms
rank =  0, Distributing orbital back into band + domain format took 9.176 ms
rank = 0, Subspace_Rotation used 10.987 ms

Total time for subspace rotation: 10.994 ms
rank = 0, Efermi =  -0.079307738486 calculate fermi energy took 0.073 ms
rank = 0, --- Calculate rho: sum over local bands took 1.390 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.422 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1015.139 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.368 ms
rank = 0, D2D took 2.114 ms
rank = 0, Transfering density took 2.116 ms
Etot    =   -25.372535195084
Eband   =    -8.005122503635
E1      =    18.934284333363
E2      =    -7.029136873677
E3      =   -10.305480107038
Exc     =    -9.096404399378
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 2.676e-06, dEband = 1.096e-04
rank = 0, Calculating/Estimating energy took 1.250 ms, Etot = -25.372535195, dEtot = 2.676e-06, dEband = 1.096e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0132908629398, which took 0.146 ms

iter_count = 108, r_2norm = 4.752e-07, tol*||rhs|| = 5.316e-07

Anderson update took 53.720 ms, out of which F'*F took 30.677 ms; b-Ax took 182.596 ms, out of which Lap took 172.590 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 312.960 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090971, int_b + int_rho = 8.367e-14, checking this took 0.192 ms
2-norm of RHS = 661.0236006972069, which took 0.207 ms

iter_count = 90, r_2norm = 5.942e-04, tol*||rhs|| = 6.610e-04

Anderson update took 44.621 ms, out of which F'*F took 25.784 ms; b-Ax took 152.157 ms, out of which Lap took 144.069 ms
Solving Poisson took 256.891 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.121581 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.114156 
Total time for convolution: 	 convolve: 5.141368 
Total time for convolution: 	 convolve: 5.090042 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.502 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.137 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
---Transfer Veff_loc: D2D took 0.873 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.199 ms

This SCF took 26051.090 ms, scf error = 1.018e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.133563, lowerbound = -0.834274, upperbound = 267.579965

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 954.433 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 9.032 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.102 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.131 ms
rank =  0, Distribute data + matrix mult took 13.275 ms
rank =  0, finding HY took 17.278 ms
rank =  0, distributing HY into block cyclic form took 9.246 ms
rank =  0, finding Y'*HY took 4.598 ms
Rank 0, Project_Hamiltonian used 44.854 ms
Total time for projection: 44.867 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.618 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.683 ms
    first calculated eigval = -0.834191118949913
    last  calculated eigval = 0.034356190906351
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83419111894991
lambda[   2] =  -0.63672292201397
lambda[   3] =  -0.51917522980080
lambda[   4] =  -0.42242193512129
lambda[   5] =  -0.40268159260817
lambda[   6] =  -0.38266201092246
lambda[   7] =  -0.32676016080146
lambda[   8] =  -0.26688913068961
lambda[   9] =  -0.21038852031510
lambda[  10] =  -0.05012211558665
lambda[  11] =  -0.01753540124226
lambda[  12] =   0.02181211856871
lambda[  13] =   0.02567491544697
lambda[  14] =   0.03171196489935
lambda[  15] =   0.03435619090635
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.694 ms
rank =  0, subspace rotation using ScaLAPACK took 1.822 ms
rank =  0, Distributing orbital back into band + domain format took 8.982 ms
rank = 0, Subspace_Rotation used 10.815 ms

Total time for subspace rotation: 10.820 ms
rank = 0, Efermi =  -0.079248448702 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 1.398 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.448 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.083 ms
rank = 0, Calculating density took 1015.865 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
rank = 0, D2D took 2.832 ms
rank = 0, Transfering density took 2.834 ms
Etot    =   -25.372539482590
Eband   =    -8.003785243494
E1      =    18.933552147443
E2      =    -7.028489584661
E3      =   -10.305639695466
Exc     =    -9.096526060517
Esc     =   -44.539909605522
Entropy =    -0.000000000627
dE = 5.359e-07, dEband = 1.672e-04
rank = 0, Calculating/Estimating energy took 1.211 ms, Etot = -25.372539483, dEtot = 5.359e-07, dEband = 1.672e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0124723125625, which took 0.167 ms

iter_count = 108, r_2norm = 4.040e-07, tol*||rhs|| = 4.989e-07

Anderson update took 54.304 ms, out of which F'*F took 30.520 ms; b-Ax took 183.107 ms, out of which Lap took 173.083 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 313.698 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002090962, int_rho =  18.00000002090960, int_b + int_rho = -2.547e-14, checking this took 0.241 ms
2-norm of RHS = 661.0244632314977, which took 0.208 ms

iter_count = 90, r_2norm = 5.744e-04, tol*||rhs|| = 6.610e-04

Anderson update took 44.807 ms, out of which F'*F took 25.193 ms; b-Ax took 151.733 ms, out of which Lap took 143.612 ms
Solving Poisson took 256.943 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.138 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Total time for convolution: 	 convolve: 5.151430 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.108964 
Total time for convolution: 	 convolve: 5.158772 
Total time for convolution: 	 convolve: 5.082232 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.777 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 0.143 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
---Transfer Veff_loc: D2D took 0.868 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.184 ms

This SCF took 26152.735 ms, scf error = 7.560e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.83419111894991, occ[   1] =   2.00000000000000
lambda[   2] =  -0.63672292201397, occ[   2] =   2.00000000000000
lambda[   3] =  -0.51917522980080, occ[   3] =   2.00000000000000
lambda[   4] =  -0.42242193512129, occ[   4] =   2.00000000000000
lambda[   5] =  -0.40268159260817, occ[   5] =   2.00000000000000
lambda[   6] =  -0.38266201092246, occ[   6] =   2.00000000000000
lambda[   7] =  -0.32676016080146, occ[   7] =   2.00000000000000
lambda[   8] =  -0.26688913068961, occ[   8] =   2.00000000000000
lambda[   9] =  -0.21038852031510, occ[   9] =   2.00000000000000
lambda[  10] =  -0.05012211558665, occ[  10] =   0.00000002090966
lambda[  11] =  -0.01753540124226, occ[  11] =   0.00000000000000
lambda[  12] =   0.02181211856871, occ[  12] =   0.00000000000000
lambda[  13] =   0.02567491544697, occ[  13] =   0.00000000000000
lambda[  14] =   0.03171196489935, occ[  14] =   0.00000000000000
lambda[  15] =   0.03435619090635, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.460 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.140 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.403 ms, time for Allreduce/Reduce: 9.529 ms 
Time for calculating local force components: 17.514 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.01567043627594   0.04619325869111  -0.00000000163607
  0.02898883994870  -0.00742869312960  -0.04057894017623
  0.02898876894649  -0.00742870358884   0.04057886731948
 -0.01016384251062   0.04842579485330  -0.00000000588152
 -0.03972031389091  -0.03363189810387   0.00000003043360
  0.05588164258853   0.07097422920324  -0.00000091231638
 -0.06053902788832   0.03610216927002  -0.00000084528494
  0.24182475766338  -0.77685984038937   0.00000014497994
force_loc = 
  0.01591712323215  -0.04987362185083  -0.00000014590932
 -0.03152653056009   0.00808963456104   0.04304562736791
 -0.03152510342697   0.00809000412803  -0.04304374755735
  0.01180370577143  -0.05305672503256   0.00000025400272
  0.04321613579187   0.03631404679325  -0.00000041834452
 -0.05040536967487  -0.06424159021130  -0.00000139166047
  0.06054528629854  -0.03193904973223  -0.00000023015622
 -0.23863663698310   0.75139196236919   0.00000063276076
Time for calculating nonlocal force components: 21.779 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00310239438461  -0.00326899927443  -0.00000007446481
[0m[32m -0.00490926849750   0.00129851695639  -0.00000001246442
[0m[32m -0.00097381248927   0.02071147937053   0.00000002943755
[0mTime for calculating XC forces components: 23.875 ms
 Cartesian force = 
  0.00024749649885  -0.00366311002010  -0.00000000510160
 -0.00253688106875   0.00067819457106   0.00246682963546
 -0.00253552493784   0.00067855367880  -0.00246473779409
  0.00164067280345  -0.00461367703965   0.00000039056498
  0.00349663144360   0.00269940182900  -0.00000024546713
  0.00237468807169   0.00348089285713  -0.00000223599788
 -0.00490220054464   0.00547888963379  -0.00000094546179
  0.00221511773365  -0.00473914551003   0.00000094962204
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
Time for printing density: 381.716 ms
The program took 481.362 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:43
Job ID:        2266747
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:38:24,vmem=8464K,walltime=00:08:12,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-008-20-1
---------------------------------------
