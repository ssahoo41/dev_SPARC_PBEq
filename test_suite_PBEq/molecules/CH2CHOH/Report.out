---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:22:00
Job ID:    2266801
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:22:05
Job ID:    2266801
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 13.421 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 7.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 11.730 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 106.897 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.970 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.085 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    6.895137	    9.291742	   10.000000	
   11.734265	    7.454690	   10.000000	
   13.104863	   10.676775	   10.000000	
    8.853916	   12.545310	   10.000000	
    7.199310	    7.494115	   10.000000	
   11.443712	    9.485790	   10.000000	
    9.150873	   10.514969	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.016 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.171 ms
Set up communicators.

--set up spincomm took 2.314 ms

--set up kptcomm took 0.352 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.011 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.090 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.177 ms

Calculate_SplineDerivRadFun took 0.209 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.815 ms.
time spent on vectorized spline interp: 3.623 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.809 ms.
time spent on vectorized spline interp: 1.398 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.326 ms.
time spent on vectorized spline interp: 1.703 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.564 ms.

Calculating rb for all atom types took 16.246 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.823 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000168130, sum_int_rho = 17.5979054444297
PosCharge = 18.000000016813, NegCharge = -17.597905444430, scal_fac = 1.022849001755
After scaling, int_rho = 18.0000000168129, PosCharge + NegCharge - NetCharge = 3.908e-14
--Calculate Vref took 0.425 ms
--Calculate rho_guess took 2.180 ms

 integral of b = -18.0000000168130,
 int{b} + Nelectron + NetCharge = -1.681e-08,
 Esc = -50.5316034356807,
 MPI_Reduce took 5.555 ms

Calculating b & b_ref took 14.165 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.030 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.071 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.023 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.150 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 28.239 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681298, int_b + int_rho = 1.091e-14, checking this took 0.096 ms
2-norm of RHS = 634.8823143007961, which took 0.073 ms

iter_count = 420, r_2norm = 5.399e-04, tol*||rhs|| = 6.349e-04

Anderson update took 231.423 ms, out of which F'*F took 105.650 ms; b-Ax took 723.377 ms, out of which Lap took 648.076 ms
Solving Poisson took 1527.453 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.391 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
Total time for convolution: 	 convolve: 5.218459 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
Total time for convolution: 	 convolve: 5.213089 
Total time for convolution: 	 convolve: 5.150675 
Total time for convolution: 	 convolve: 5.158498 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.745 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.356 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
rank = 0, XC calculation took 24593.699 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 1.588 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.252 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.932 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.217 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.656 ms
    Lanczos iter 53, eigmin  = -1.009313691, eigmax = 264.928713068, err_eigmin = 1.711e-03, err_eigmax = 9.590e-03
rank =   0, Lanczos took 125.345 ms, eigmin = -1.009313690917, eigmax = 267.578000198679

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.234343, lowerbound = -1.109314, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1162.261 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 24.541 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.991 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.024 ms
rank =  0, Distribute data + matrix mult took 29.572 ms
rank =  0, finding HY took 20.572 ms
rank =  0, distributing HY into block cyclic form took 11.981 ms
rank =  0, finding Y'*HY took 5.457 ms
Rank 0, Project_Hamiltonian used 67.608 ms
Total time for projection: 67.621 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.815 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.913 ms
    first calculated eigval = 2.799033817928769
    last  calculated eigval = 3.215633989392904
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.79903381792877
lambda[   2] =   2.83456903426921
lambda[   3] =   2.88289789576708
lambda[   4] =   2.92677149321706
lambda[   5] =   2.93765423298353
lambda[   6] =   2.96663703993898
lambda[   7] =   2.99629632780524
lambda[   8] =   3.01574069882674
lambda[   9] =   3.03498257267175
lambda[  10] =   3.05539695507390
lambda[  11] =   3.10318428702691
lambda[  12] =   3.10549561706761
lambda[  13] =   3.13959169803518
lambda[  14] =   3.16257296088695
lambda[  15] =   3.21563398939290
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.945 ms
rank =  0, subspace rotation using ScaLAPACK took 3.332 ms
rank =  0, Distributing orbital back into band + domain format took 12.772 ms
rank = 0, Subspace_Rotation used 16.121 ms

Total time for subspace rotation: 16.125 ms
rank = 0, Efermi =   3.045189764576 calculate fermi energy took 0.057 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.315634, lowerbound = -1.109314, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1177.212 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.275 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.430 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 18.742 ms
rank =  0, finding HY took 19.603 ms
rank =  0, distributing HY into block cyclic form took 11.917 ms
rank =  0, finding Y'*HY took 4.400 ms
Rank 0, Project_Hamiltonian used 54.696 ms
Total time for projection: 54.706 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -0.840109904310040
    last  calculated eigval = 0.444566589291638
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84010990431004
lambda[   2] =  -0.39996587400117
lambda[   3] =  -0.29112921895890
lambda[   4] =  -0.17436439725750
lambda[   5] =  -0.09937946350469
lambda[   6] =  -0.06566349035629
lambda[   7] =   0.15302465554250
lambda[   8] =   0.26356113005716
lambda[   9] =   0.32149608032906
lambda[  10] =   0.33445511248848
lambda[  11] =   0.36067140030659
lambda[  12] =   0.36235752831482
lambda[  13] =   0.40542778477596
lambda[  14] =   0.43171244180986
lambda[  15] =   0.44456658929164
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 3.592 ms
rank =  0, Distributing orbital back into band + domain format took 12.016 ms
rank = 0, Subspace_Rotation used 15.621 ms

Total time for subspace rotation: 15.626 ms
rank = 0, Efermi =   0.327975596525 calculate fermi energy took 0.023 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.544567, lowerbound = -1.109314, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1201.942 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 78.454 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.448 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.093 ms
rank =  0, Distribute data + matrix mult took 82.009 ms
rank =  0, finding HY took 19.360 ms
rank =  0, distributing HY into block cyclic form took 12.318 ms
rank =  0, finding Y'*HY took 4.319 ms
Rank 0, Project_Hamiltonian used 118.050 ms
Total time for projection: 118.056 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.164 ms
    first calculated eigval = -1.029446941666440
    last  calculated eigval = 0.146099889857213
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02944694166644
lambda[   2] =  -0.81674536035245
lambda[   3] =  -0.64243982539766
lambda[   4] =  -0.55498178237494
lambda[   5] =  -0.53177991890412
lambda[   6] =  -0.44055991646797
lambda[   7] =  -0.39691549103897
lambda[   8] =  -0.35980366810635
lambda[   9] =  -0.23284796292484
lambda[  10] =   0.01100114476788
lambda[  11] =   0.08605244364047
lambda[  12] =   0.09107594766353
lambda[  13] =   0.10525457638869
lambda[  14] =   0.12886474414205
lambda[  15] =   0.14609988985721
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 3.503 ms
rank =  0, Distributing orbital back into band + domain format took 13.468 ms
rank = 0, Subspace_Rotation used 16.982 ms

Total time for subspace rotation: 16.985 ms
rank = 0, Efermi =  -0.018320883100 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.246100, lowerbound = -1.109314, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1184.298 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.448 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.386 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.071 ms
rank =  0, Distribute data + matrix mult took 15.916 ms
rank =  0, finding HY took 19.524 ms
rank =  0, distributing HY into block cyclic form took 12.104 ms
rank =  0, finding Y'*HY took 4.471 ms
Rank 0, Project_Hamiltonian used 52.040 ms
Total time for projection: 52.045 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -1.029568398547735
    last  calculated eigval = 0.088066250525855
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02956839854774
lambda[   2] =  -0.81930599209756
lambda[   3] =  -0.64552440879433
lambda[   4] =  -0.55835876997595
lambda[   5] =  -0.54109858435494
lambda[   6] =  -0.44740867407075
lambda[   7] =  -0.41153905857508
lambda[   8] =  -0.40364742500058
lambda[   9] =  -0.30241036692458
lambda[  10] =  -0.08544694770507
lambda[  11] =   0.01860090696636
lambda[  12] =   0.04158567618762
lambda[  13] =   0.05748116298097
lambda[  14] =   0.07181744396806
lambda[  15] =   0.08806625052586
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 3.594 ms
rank =  0, Distributing orbital back into band + domain format took 12.024 ms
rank = 0, Subspace_Rotation used 15.633 ms

Total time for subspace rotation: 15.637 ms
rank = 0, Efermi =  -0.114768975632 calculate fermi energy took 0.023 ms
rank = 0, --- Calculate rho: sum over local bands took 3.870 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.141 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.140 ms
rank = 0, Calculating density took 5225.949 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.447 ms
rank = 0, D2D took 1.118 ms
rank = 0, Transfering density took 1.127 ms
Etot    =   -31.038401807822
Eband   =   -10.317723358120
E1      =    20.394285148452
E2      =    -8.256945619083
E3      =   -10.656679039491
Exc     =    -9.496984820540
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 4.434e+00, dEband = 1.474e+00
rank = 0, Calculating/Estimating energy took 0.972 ms, Etot = -31.038401808, dEtot = 4.434e+00, dEband = 1.474e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 48.5865946775799, which took 0.060 ms

iter_count = 96, r_2norm = 1.543e-03, tol*||rhs|| = 1.943e-03

Anderson update took 52.302 ms, out of which F'*F took 25.505 ms; b-Ax took 163.034 ms, out of which Lap took 146.992 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 352.077 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681293, int_b + int_rho = -3.274e-14, checking this took 0.114 ms
2-norm of RHS = 631.5578854092651, which took 0.127 ms

iter_count = 288, r_2norm = 5.694e-04, tol*||rhs|| = 6.316e-04

Anderson update took 153.699 ms, out of which F'*F took 72.780 ms; b-Ax took 493.641 ms, out of which Lap took 443.398 ms
Solving Poisson took 1039.281 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.346 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.152970 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.111549 
Total time for convolution: 	 convolve: 5.126861 
Total time for convolution: 	 convolve: 5.197733 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.132 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.169 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.986 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.839 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.847 ms

This SCF took 31203.730 ms, scf error = 1.657e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.188066, lowerbound = -1.029568, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1134.568 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 56.280 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.395 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 59.705 ms
rank =  0, finding HY took 19.499 ms
rank =  0, distributing HY into block cyclic form took 12.139 ms
rank =  0, finding Y'*HY took 4.374 ms
Rank 0, Project_Hamiltonian used 95.745 ms
Total time for projection: 95.763 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -1.017896666301968
    last  calculated eigval = 0.069275893644282
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.01789666630197
lambda[   2] =  -0.77463776665077
lambda[   3] =  -0.62365735251443
lambda[   4] =  -0.52379151450320
lambda[   5] =  -0.50869740410442
lambda[   6] =  -0.41884138616773
lambda[   7] =  -0.39482564852538
lambda[   8] =  -0.38276539898880
lambda[   9] =  -0.27148804661111
lambda[  10] =  -0.07143040075639
lambda[  11] =  -0.01676237490054
lambda[  12] =   0.02065219977820
lambda[  13] =   0.02412704668268
lambda[  14] =   0.04035614183151
lambda[  15] =   0.06927589364428
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 3.574 ms
rank =  0, Distributing orbital back into band + domain format took 12.073 ms
rank = 0, Subspace_Rotation used 15.658 ms

Total time for subspace rotation: 15.686 ms
rank = 0, Efermi =  -0.100752428606 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.209 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.505 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.221 ms
rank = 0, Calculating density took 1253.234 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.498 ms
rank = 0, D2D took 0.597 ms
rank = 0, Transfering density took 0.599 ms
Etot    =   -30.986821382816
Eband   =    -9.833202369937
E1      =    19.974844698158
E2      =    -8.218987491986
E3      =   -10.785256802253
Exc     =    -9.601104569088
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 7.369e-03, dEband = 6.922e-02
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -30.986821383, dEtot = 7.369e-03, dEband = 6.922e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 21.3050775876034, which took 0.072 ms

iter_count = 102, r_2norm = 5.902e-04, tol*||rhs|| = 8.522e-04

Anderson update took 55.549 ms, out of which F'*F took 25.340 ms; b-Ax took 172.441 ms, out of which Lap took 153.744 ms
rank = 0, Mixing (+ precond) took 377.565 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681290, int_b + int_rho = -6.185e-14, checking this took 0.111 ms
2-norm of RHS = 627.4429024620574, which took 0.140 ms

iter_count = 300, r_2norm = 5.510e-04, tol*||rhs|| = 6.274e-04

Anderson update took 165.547 ms, out of which F'*F took 75.066 ms; b-Ax took 509.251 ms, out of which Lap took 454.816 ms
Solving Poisson took 1090.124 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.884 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.256171 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.411 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.258067 
Total time for convolution: 	 convolve: 5.385032 
Total time for convolution: 	 convolve: 5.317468 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.257 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.952 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.844 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.814 ms

This SCF took 27942.996 ms, scf error = 1.104e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.169276, lowerbound = -1.017897, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1218.592 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 14.007 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.764 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 17.810 ms
rank =  0, finding HY took 20.271 ms
rank =  0, distributing HY into block cyclic form took 12.088 ms
rank =  0, finding Y'*HY took 4.820 ms
Rank 0, Project_Hamiltonian used 55.023 ms
Total time for projection: 55.045 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -0.995035744179243
    last  calculated eigval = 0.060773884900924
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99503574417924
lambda[   2] =  -0.71215909578327
lambda[   3] =  -0.58928197447951
lambda[   4] =  -0.47622495334683
lambda[   5] =  -0.45960052725554
lambda[   6] =  -0.37163929911613
lambda[   7] =  -0.36643723631971
lambda[   8] =  -0.34572483582447
lambda[   9] =  -0.22791881251986
lambda[  10] =  -0.03590859041589
lambda[  11] =  -0.02949588438465
lambda[  12] =   0.00395547917466
lambda[  13] =   0.01699555604291
lambda[  14] =   0.02763797744864
lambda[  15] =   0.06077388490092
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.413 ms
rank =  0, Distributing orbital back into band + domain format took 12.770 ms
rank = 0, Subspace_Rotation used 16.198 ms

Total time for subspace rotation: 16.202 ms
rank = 0, Efermi =  -0.065230946102 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.402 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.460 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.242 ms
rank = 0, Calculating density took 1296.232 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
rank = 0, D2D took 0.643 ms
rank = 0, Transfering density took 0.646 ms
Etot    =   -30.950601148456
Eband   =    -9.088044958253
E1      =    19.352282183114
E2      =    -8.089084442301
E3      =   -11.007342463246
Exc     =    -9.779661842676
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 5.174e-03, dEband = 1.065e-01
rank = 0, Calculating/Estimating energy took 0.880 ms, Etot = -30.950601148, dEtot = 5.174e-03, dEband = 1.065e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.8231546364100, which took 0.061 ms

iter_count = 102, r_2norm = 2.274e-04, tol*||rhs|| = 2.729e-04

Anderson update took 55.706 ms, out of which F'*F took 25.625 ms; b-Ax took 178.187 ms, out of which Lap took 160.319 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 385.461 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681295, int_b + int_rho = -1.091e-14, checking this took 0.108 ms
2-norm of RHS = 626.9541704799400, which took 0.126 ms

iter_count = 282, r_2norm = 5.229e-04, tol*||rhs|| = 6.270e-04

Anderson update took 149.714 ms, out of which F'*F took 70.303 ms; b-Ax took 474.896 ms, out of which Lap took 426.859 ms
Solving Poisson took 1020.813 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.083294 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.700 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.142555 
Total time for convolution: 	 convolve: 5.089899 
Total time for convolution: 	 convolve: 5.083202 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.147 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.954 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.840 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.813 ms

This SCF took 27093.500 ms, scf error = 4.382e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.160774, lowerbound = -0.995036, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1178.131 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 30.972 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.440 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.196 ms
rank =  0, Distribute data + matrix mult took 34.623 ms
rank =  0, finding HY took 19.564 ms
rank =  0, distributing HY into block cyclic form took 11.666 ms
rank =  0, finding Y'*HY took 5.925 ms
Rank 0, Project_Hamiltonian used 71.810 ms
Total time for projection: 71.823 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.984858369137457
    last  calculated eigval = 0.050390043725987
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98485836913746
lambda[   2] =  -0.69140437457394
lambda[   3] =  -0.57511267914168
lambda[   4] =  -0.45842100081166
lambda[   5] =  -0.44170901585508
lambda[   6] =  -0.35429578994433
lambda[   7] =  -0.35315906732875
lambda[   8] =  -0.33137461738543
lambda[   9] =  -0.21491761482040
lambda[  10] =  -0.03369735220989
lambda[  11] =  -0.02283119859151
lambda[  12] =  -0.00190053220320
lambda[  13] =   0.01516329827917
lambda[  14] =   0.02245464923935
lambda[  15] =   0.05039004372599
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.166 ms
rank =  0, subspace rotation using ScaLAPACK took 3.481 ms
rank =  0, Distributing orbital back into band + domain format took 12.588 ms
rank = 0, Subspace_Rotation used 16.083 ms

Total time for subspace rotation: 16.089 ms
rank = 0, Efermi =  -0.063019380632 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.212 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.072 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.255 ms
rank = 0, Calculating density took 1272.879 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.676 ms
rank = 0, D2D took 0.774 ms
rank = 0, Transfering density took 0.780 ms
Etot    =   -30.945505723028
Eband   =    -8.810505058564
E1      =    19.155465856175
E2      =    -7.993450539605
E3      =   -11.097290494903
Exc     =    -9.849604118957
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 7.279e-04, dEband = 3.965e-02
rank = 0, Calculating/Estimating energy took 0.883 ms, Etot = -30.945505723, dEtot = 7.279e-04, dEband = 3.965e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.7222111512539, which took 0.085 ms

iter_count = 108, r_2norm = 7.581e-05, tol*||rhs|| = 1.089e-04

Anderson update took 58.417 ms, out of which F'*F took 27.380 ms; b-Ax took 184.186 ms, out of which Lap took 166.128 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 407.737 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681298, int_b + int_rho = 1.455e-14, checking this took 0.108 ms
2-norm of RHS = 627.4707246053346, which took 0.084 ms

iter_count = 264, r_2norm = 5.533e-04, tol*||rhs|| = 6.275e-04

Anderson update took 140.489 ms, out of which F'*F took 67.908 ms; b-Ax took 449.089 ms, out of which Lap took 404.622 ms
Solving Poisson took 954.026 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.084852 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.085300 
Total time for convolution: 	 convolve: 5.112042 
Total time for convolution: 	 convolve: 5.161252 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.179 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.158 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.961 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.795 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.779 ms

This SCF took 27046.133 ms, scf error = 1.635e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.150390, lowerbound = -0.984858, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1183.884 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.258 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.383 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.110 ms
rank =  0, Distribute data + matrix mult took 15.763 ms
rank =  0, finding HY took 19.490 ms
rank =  0, distributing HY into block cyclic form took 11.888 ms
rank =  0, finding Y'*HY took 4.539 ms
Rank 0, Project_Hamiltonian used 51.707 ms
Total time for projection: 51.721 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.981722995952540
    last  calculated eigval = 0.040886660697083
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98172299595254
lambda[   2] =  -0.68592953364962
lambda[   3] =  -0.57063020913405
lambda[   4] =  -0.45272092353761
lambda[   5] =  -0.43605173958640
lambda[   6] =  -0.35074237988176
lambda[   7] =  -0.34623665845109
lambda[   8] =  -0.32734154662008
lambda[   9] =  -0.21105801903368
lambda[  10] =  -0.03470663837944
lambda[  11] =  -0.01914935749634
lambda[  12] =  -0.00356006100060
lambda[  13] =   0.01458132473387
lambda[  14] =   0.02069035420416
lambda[  15] =   0.04088666069708
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 3.530 ms
rank =  0, Distributing orbital back into band + domain format took 12.811 ms
rank = 0, Subspace_Rotation used 16.359 ms

Total time for subspace rotation: 16.364 ms
rank = 0, Efermi =  -0.064028666264 calculate fermi energy took 2.016 ms
rank = 0, --- Calculate rho: sum over local bands took 2.933 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.118 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.165 ms
rank = 0, Calculating density took 1259.459 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.568 ms
rank = 0, D2D took 0.928 ms
rank = 0, Transfering density took 0.936 ms
Etot    =   -30.944558661054
Eband   =    -8.724868012277
E1      =    19.119510626971
E2      =    -7.937028110346
E3      =   -11.123660490009
Exc     =    -9.868286439915
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 1.353e-04, dEband = 1.223e-02
rank = 0, Calculating/Estimating energy took 0.965 ms, Etot = -30.944558661, dEtot = 1.353e-04, dEband = 1.223e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8326060636080, which took 0.055 ms

iter_count = 114, r_2norm = 2.035e-05, tol*||rhs|| = 3.330e-05

Anderson update took 60.828 ms, out of which F'*F took 28.502 ms; b-Ax took 199.625 ms, out of which Lap took 179.319 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.519 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681295, int_b + int_rho = -1.091e-14, checking this took 0.134 ms
2-norm of RHS = 627.7534273925069, which took 0.091 ms

iter_count = 240, r_2norm = 5.758e-04, tol*||rhs|| = 6.278e-04

Anderson update took 128.724 ms, out of which F'*F took 59.290 ms; b-Ax took 401.152 ms, out of which Lap took 360.876 ms
Solving Poisson took 868.160 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.083729 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.078511 
Total time for convolution: 	 convolve: 5.084622 
Total time for convolution: 	 convolve: 5.078446 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.593 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.609 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.956 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.332 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.310 ms

This SCF took 26853.273 ms, scf error = 6.366e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.140887, lowerbound = -0.981723, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1179.780 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.082 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.359 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.119 ms
rank =  0, Distribute data + matrix mult took 15.572 ms
rank =  0, finding HY took 19.655 ms
rank =  0, distributing HY into block cyclic form took 11.952 ms
rank =  0, finding Y'*HY took 4.801 ms
Rank 0, Project_Hamiltonian used 52.036 ms
Total time for projection: 52.065 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.980051657328364
    last  calculated eigval = 0.033652418501823
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98005165732836
lambda[   2] =  -0.68372682618792
lambda[   3] =  -0.56878681922258
lambda[   4] =  -0.45054210291764
lambda[   5] =  -0.43362649859130
lambda[   6] =  -0.34911492707691
lambda[   7] =  -0.34338027493268
lambda[   8] =  -0.32556523371096
lambda[   9] =  -0.20866460648864
lambda[  10] =  -0.03465029971761
lambda[  11] =  -0.01741430773772
lambda[  12] =  -0.00380264013450
lambda[  13] =   0.01475833551873
lambda[  14] =   0.02041261686993
lambda[  15] =   0.03365241850182
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 3.563 ms
rank =  0, Distributing orbital back into band + domain format took 12.150 ms
rank = 0, Subspace_Rotation used 15.728 ms

Total time for subspace rotation: 15.733 ms
rank = 0, Efermi =  -0.063972327595 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.910 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.378 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.153 ms
rank = 0, Calculating density took 1254.288 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.629 ms
rank = 0, D2D took 0.869 ms
rank = 0, Transfering density took 0.878 ms
Etot    =   -30.944305843645
Eband   =    -8.686917893497
E1      =    19.107266528679
E2      =    -7.909119023037
E3      =   -11.130380567611
Exc     =    -9.872550633287
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 3.612e-05, dEband = 5.421e-03
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -30.944305844, dEtot = 3.612e-05, dEband = 5.421e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4032148208825, which took 0.050 ms

iter_count = 108, r_2norm = 1.556e-05, tol*||rhs|| = 1.613e-05

Anderson update took 57.852 ms, out of which F'*F took 27.755 ms; b-Ax took 183.330 ms, out of which Lap took 166.071 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.436 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681290, int_b + int_rho = -6.548e-14, checking this took 0.099 ms
2-norm of RHS = 627.9447521033368, which took 0.093 ms

iter_count = 246, r_2norm = 6.039e-04, tol*||rhs|| = 6.279e-04

Anderson update took 132.327 ms, out of which F'*F took 62.043 ms; b-Ax took 418.227 ms, out of which Lap took 376.700 ms
Solving Poisson took 893.798 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.092071 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 106.314 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.089811 
Total time for convolution: 	 convolve: 5.093334 
Total time for convolution: 	 convolve: 5.091443 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.938 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.762 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.734 ms

This SCF took 26986.456 ms, scf error = 3.479e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.133652, lowerbound = -0.980052, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1153.318 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.849 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.322 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.201 ms
rank =  0, Distribute data + matrix mult took 26.388 ms
rank =  0, finding HY took 19.464 ms
rank =  0, distributing HY into block cyclic form took 11.951 ms
rank =  0, finding Y'*HY took 4.439 ms
Rank 0, Project_Hamiltonian used 62.287 ms
Total time for projection: 62.303 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.976564800397962
    last  calculated eigval = 0.029940523941470
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97656480039796
lambda[   2] =  -0.67923772084043
lambda[   3] =  -0.56520897364198
lambda[   4] =  -0.44658745402787
lambda[   5] =  -0.42945326559429
lambda[   6] =  -0.34541895910725
lambda[   7] =  -0.33937553393783
lambda[   8] =  -0.32193455500018
lambda[   9] =  -0.20454306101396
lambda[  10] =  -0.03352959072345
lambda[  11] =  -0.01333390444137
lambda[  12] =  -0.00220081804179
lambda[  13] =   0.01763549894449
lambda[  14] =   0.02166693243648
lambda[  15] =   0.02994052394147
==subpsace eigenproblem: bcast eigvals took 0.037 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 3.591 ms
rank =  0, Distributing orbital back into band + domain format took 12.096 ms
rank = 0, Subspace_Rotation used 15.700 ms

Total time for subspace rotation: 15.706 ms
rank = 0, Efermi =  -0.062851618643 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.894 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.371 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.177 ms
rank = 0, Calculating density took 1238.069 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.608 ms
rank = 0, D2D took 0.843 ms
rank = 0, Transfering density took 0.853 ms
Etot    =   -30.944065083516
Eband   =    -8.616648647687
E1      =    19.073652405873
E2      =    -7.869472942768
E3      =   -11.141184841915
Exc     =    -9.880123190197
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 3.439e-05, dEband = 1.004e-02
rank = 0, Calculating/Estimating energy took 0.989 ms, Etot = -30.944065084, dEtot = 3.439e-05, dEband = 1.004e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2489757345669, which took 0.086 ms

iter_count = 114, r_2norm = 6.158e-06, tol*||rhs|| = 9.959e-06

Anderson update took 61.305 ms, out of which F'*F took 29.055 ms; b-Ax took 192.862 ms, out of which Lap took 174.655 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.914 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681299, int_b + int_rho = 2.183e-14, checking this took 0.103 ms
2-norm of RHS = 627.9503488251786, which took 0.113 ms

iter_count = 216, r_2norm = 6.076e-04, tol*||rhs|| = 6.280e-04

Anderson update took 116.394 ms, out of which F'*F took 55.007 ms; b-Ax took 367.162 ms, out of which Lap took 330.417 ms
Solving Poisson took 788.510 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.267 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.104555 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.417 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.093118 
Total time for convolution: 	 convolve: 5.127146 
Total time for convolution: 	 convolve: 5.081838 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.947 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.303 ms

This SCF took 26828.237 ms, scf error = 1.601e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.129941, lowerbound = -0.976565, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1164.948 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.759 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.330 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.202 ms
rank =  0, Distribute data + matrix mult took 22.303 ms
rank =  0, finding HY took 19.455 ms
rank =  0, distributing HY into block cyclic form took 11.902 ms
rank =  0, finding Y'*HY took 4.480 ms
Rank 0, Project_Hamiltonian used 58.169 ms
Total time for projection: 58.220 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.975618389171221
    last  calculated eigval = 0.028374417677698
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97561838917122
lambda[   2] =  -0.67747225713897
lambda[   3] =  -0.56400810830503
lambda[   4] =  -0.44513876186163
lambda[   5] =  -0.42792750021339
lambda[   6] =  -0.34424044585896
lambda[   7] =  -0.33788119099612
lambda[   8] =  -0.32069439632599
lambda[   9] =  -0.20301545719184
lambda[  10] =  -0.03276284977818
lambda[  11] =  -0.01179115246050
lambda[  12] =  -0.00084943860071
lambda[  13] =   0.01947319340137
lambda[  14] =   0.02179269973904
lambda[  15] =   0.02837441767770
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 3.576 ms
rank =  0, Distributing orbital back into band + domain format took 12.100 ms
rank = 0, Subspace_Rotation used 15.688 ms

Total time for subspace rotation: 15.694 ms
rank = 0, Efermi =  -0.062084877638 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.883 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.404 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.165 ms
rank = 0, Calculating density took 1245.612 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.597 ms
rank = 0, D2D took 0.809 ms
rank = 0, Transfering density took 0.813 ms
Etot    =   -30.944035317242
Eband   =    -8.591993014677
E1      =    19.060865100144
E2      =    -7.856910643544
E3      =   -11.144033488898
Exc     =    -9.882248098963
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 4.252e-06, dEband = 3.522e-03
rank = 0, Calculating/Estimating energy took 1.058 ms, Etot = -30.944035317, dEtot = 4.252e-06, dEband = 3.522e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1247813532258, which took 0.099 ms

iter_count = 114, r_2norm = 3.489e-06, tol*||rhs|| = 4.991e-06

Anderson update took 61.320 ms, out of which F'*F took 29.073 ms; b-Ax took 192.956 ms, out of which Lap took 174.795 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.976 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681298, int_b + int_rho = 1.819e-14, checking this took 0.115 ms
2-norm of RHS = 627.9423566607459, which took 0.082 ms

iter_count = 222, r_2norm = 5.632e-04, tol*||rhs|| = 6.279e-04

Anderson update took 119.931 ms, out of which F'*F took 56.240 ms; b-Ax took 377.938 ms, out of which Lap took 340.014 ms
Solving Poisson took 811.190 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.123440 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.120193 
Total time for convolution: 	 convolve: 5.090553 
Total time for convolution: 	 convolve: 5.088055 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 1.016 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.344 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.384 ms

This SCF took 26865.323 ms, scf error = 1.134e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.128374, lowerbound = -0.975618, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1174.937 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 13.178 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.295 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.220 ms
rank =  0, Distribute data + matrix mult took 16.705 ms
rank =  0, finding HY took 19.443 ms
rank =  0, distributing HY into block cyclic form took 11.963 ms
rank =  0, finding Y'*HY took 4.459 ms
Rank 0, Project_Hamiltonian used 52.598 ms
Total time for projection: 52.612 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.975003669057120
    last  calculated eigval = 0.029484845250214
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97500366905712
lambda[   2] =  -0.67644024450795
lambda[   3] =  -0.56321034116004
lambda[   4] =  -0.44417681686427
lambda[   5] =  -0.42688021031023
lambda[   6] =  -0.34344649728218
lambda[   7] =  -0.33671656514670
lambda[   8] =  -0.31989095498048
lambda[   9] =  -0.20194671390837
lambda[  10] =  -0.03037664398343
lambda[  11] =  -0.01063887029103
lambda[  12] =   0.00314695579167
lambda[  13] =   0.02225377131441
lambda[  14] =   0.02370343249675
lambda[  15] =   0.02948484525021
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 3.588 ms
rank =  0, Distributing orbital back into band + domain format took 11.994 ms
rank = 0, Subspace_Rotation used 15.595 ms

Total time for subspace rotation: 15.600 ms
rank = 0, Efermi =  -0.059698671891 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 2.876 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.389 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.162 ms
rank = 0, Calculating density took 1249.944 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.599 ms
rank = 0, D2D took 0.803 ms
rank = 0, Transfering density took 0.807 ms
Etot    =   -30.944058087883
Eband   =    -8.575424026945
E1      =    19.054478379336
E2      =    -7.846749772642
E3      =   -11.143883808243
Exc     =    -9.882142584970
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 3.253e-06, dEband = 2.367e-03
rank = 0, Calculating/Estimating energy took 0.988 ms, Etot = -30.944058088, dEtot = 3.253e-06, dEband = 2.367e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0917971775674, which took 0.049 ms

iter_count = 114, r_2norm = 2.657e-06, tol*||rhs|| = 3.672e-06

Anderson update took 61.270 ms, out of which F'*F took 29.055 ms; b-Ax took 193.994 ms, out of which Lap took 175.901 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.032 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681300, int_b + int_rho = 4.002e-14, checking this took 0.904 ms
2-norm of RHS = 627.9193545118002, which took 0.084 ms

iter_count = 198, r_2norm = 5.073e-04, tol*||rhs|| = 6.279e-04

Anderson update took 106.802 ms, out of which F'*F took 50.259 ms; b-Ax took 336.264 ms, out of which Lap took 302.581 ms
Solving Poisson took 722.742 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.112395 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.081532 
Total time for convolution: 	 convolve: 5.121668 
Total time for convolution: 	 convolve: 5.135758 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.943 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.351 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.318 ms

This SCF took 26810.500 ms, scf error = 8.327e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.129485, lowerbound = -0.975004, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1176.759 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.062 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.389 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.136 ms
rank =  0, Distribute data + matrix mult took 15.599 ms
rank =  0, finding HY took 19.425 ms
rank =  0, distributing HY into block cyclic form took 12.042 ms
rank =  0, finding Y'*HY took 4.274 ms
Rank 0, Project_Hamiltonian used 51.364 ms
Total time for projection: 51.376 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.974281290675282
    last  calculated eigval = 0.029717865607782
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97428129067528
lambda[   2] =  -0.67563791861981
lambda[   3] =  -0.56251523005702
lambda[   4] =  -0.44343114087201
lambda[   5] =  -0.42612213295277
lambda[   6] =  -0.34271637738684
lambda[   7] =  -0.33599912425513
lambda[   8] =  -0.31916133798501
lambda[   9] =  -0.20123698809807
lambda[  10] =  -0.02906667985592
lambda[  11] =  -0.00995547578139
lambda[  12] =   0.00474490729276
lambda[  13] =   0.02250397190967
lambda[  14] =   0.02447943674361
lambda[  15] =   0.02971786560778
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 3.589 ms
rank =  0, Distributing orbital back into band + domain format took 12.095 ms
rank = 0, Subspace_Rotation used 15.697 ms

Total time for subspace rotation: 15.702 ms
rank = 0, Efermi =  -0.058388707742 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.895 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.416 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 1250.585 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.593 ms
rank = 0, D2D took 0.803 ms
rank = 0, Transfering density took 0.808 ms
Etot    =   -30.944088194264
Eband   =    -8.562203082293
E1      =    19.046559139604
E2      =    -7.840993577958
E3      =   -11.145956507355
Exc     =    -9.883790900700
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 4.301e-06, dEband = 1.889e-03
rank = 0, Calculating/Estimating energy took 1.024 ms, Etot = -30.944088194, dEtot = 4.301e-06, dEband = 1.889e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0575277516494, which took 0.048 ms

iter_count = 108, r_2norm = 2.177e-06, tol*||rhs|| = 2.301e-06

Anderson update took 58.169 ms, out of which F'*F took 27.578 ms; b-Ax took 182.912 ms, out of which Lap took 165.735 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.215 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681292, int_b + int_rho = -4.729e-14, checking this took 0.083 ms
2-norm of RHS = 627.9323037181315, which took 0.111 ms

iter_count = 204, r_2norm = 5.196e-04, tol*||rhs|| = 6.279e-04

Anderson update took 110.048 ms, out of which F'*F took 51.764 ms; b-Ax took 347.993 ms, out of which Lap took 313.066 ms
Solving Poisson took 745.124 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.153247 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.094105 
Total time for convolution: 	 convolve: 5.163504 
Total time for convolution: 	 convolve: 5.115109 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 4.251 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.931 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.345 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.298 ms

This SCF took 27164.049 ms, scf error = 5.008e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129718, lowerbound = -0.974281, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1205.567 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.124 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.335 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.144 ms
rank =  0, Distribute data + matrix mult took 15.618 ms
rank =  0, finding HY took 19.451 ms
rank =  0, distributing HY into block cyclic form took 12.095 ms
rank =  0, finding Y'*HY took 4.309 ms
Rank 0, Project_Hamiltonian used 51.502 ms
Total time for projection: 51.514 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.973601423835954
    last  calculated eigval = 0.030829529199114
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97360142383595
lambda[   2] =  -0.67490984896691
lambda[   3] =  -0.56181163840324
lambda[   4] =  -0.44270844269766
lambda[   5] =  -0.42539893202393
lambda[   6] =  -0.34204388937071
lambda[   7] =  -0.33524866934550
lambda[   8] =  -0.31854067830959
lambda[   9] =  -0.20052842860323
lambda[  10] =  -0.02563824406051
lambda[  11] =  -0.00927895268491
lambda[  12] =   0.00683845287467
lambda[  13] =   0.02309509712449
lambda[  14] =   0.02700278658622
lambda[  15] =   0.03082952919911
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.181 ms
rank =  0, subspace rotation using ScaLAPACK took 3.583 ms
rank =  0, Distributing orbital back into band + domain format took 11.985 ms
rank = 0, Subspace_Rotation used 15.580 ms

Total time for subspace rotation: 15.587 ms
rank = 0, Efermi =  -0.054960271952 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.808 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.515 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.174 ms
rank = 0, Calculating density took 1279.462 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.592 ms
rank = 0, D2D took 0.870 ms
rank = 0, Transfering density took 0.874 ms
Etot    =   -30.944208077917
Eband   =    -8.549583903545
E1      =    19.040490298160
E2      =    -7.834236995936
E3      =   -11.146644238518
Exc     =    -9.884392270798
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 1.713e-05, dEband = 1.803e-03
rank = 0, Calculating/Estimating energy took 0.991 ms, Etot = -30.944208078, dEtot = 1.713e-05, dEband = 1.803e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0497250725482, which took 0.055 ms

iter_count = 114, r_2norm = 1.328e-06, tol*||rhs|| = 1.989e-06

Anderson update took 61.276 ms, out of which F'*F took 28.990 ms; b-Ax took 193.593 ms, out of which Lap took 175.368 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.907 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681292, int_b + int_rho = -4.002e-14, checking this took 0.113 ms
2-norm of RHS = 627.9298364031891, which took 0.118 ms

iter_count = 150, r_2norm = 5.258e-04, tol*||rhs|| = 6.279e-04

Anderson update took 81.023 ms, out of which F'*F took 38.130 ms; b-Ax took 254.985 ms, out of which Lap took 229.581 ms
Solving Poisson took 548.657 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.125667 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.229 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.124984 
Total time for convolution: 	 convolve: 5.108952 
Total time for convolution: 	 convolve: 5.108374 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.348 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.938 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.333 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.292 ms

This SCF took 26708.593 ms, scf error = 3.158e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.130830, lowerbound = -0.973601, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1166.064 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.313 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.320 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.056 ms
rank =  0, Distribute data + matrix mult took 15.705 ms
rank =  0, finding HY took 19.528 ms
rank =  0, distributing HY into block cyclic form took 12.024 ms
rank =  0, finding Y'*HY took 4.427 ms
Rank 0, Project_Hamiltonian used 51.711 ms
Total time for projection: 51.723 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.973323684876244
    last  calculated eigval = 0.030910279636827
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97332368487624
lambda[   2] =  -0.67464532821764
lambda[   3] =  -0.56156197863293
lambda[   4] =  -0.44246266543556
lambda[   5] =  -0.42514845941266
lambda[   6] =  -0.34178694335609
lambda[   7] =  -0.33502114576471
lambda[   8] =  -0.31828106085028
lambda[   9] =  -0.20028631727708
lambda[  10] =  -0.02496337443184
lambda[  11] =  -0.00912628965966
lambda[  12] =   0.00700070751850
lambda[  13] =   0.02260779984632
lambda[  14] =   0.02723047842269
lambda[  15] =   0.03091027963683
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 3.569 ms
rank =  0, Distributing orbital back into band + domain format took 12.108 ms
rank = 0, Subspace_Rotation used 15.689 ms

Total time for subspace rotation: 15.695 ms
rank = 0, Efermi =  -0.054285402306 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.866 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.376 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.167 ms
rank = 0, Calculating density took 1240.174 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.614 ms
rank = 0, D2D took 1.547 ms
rank = 0, Transfering density took 1.551 ms
Etot    =   -30.944234054332
Eband   =    -8.545035168066
E1      =    19.037792070020
E2      =    -7.832206612674
E3      =   -11.147349559132
Exc     =    -9.884943691903
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 3.711e-06, dEband = 6.498e-04
rank = 0, Calculating/Estimating energy took 1.094 ms, Etot = -30.944234054, dEtot = 3.711e-06, dEband = 6.498e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0375613912590, which took 0.052 ms

iter_count = 114, r_2norm = 1.036e-06, tol*||rhs|| = 1.502e-06

Anderson update took 76.050 ms, out of which F'*F took 33.268 ms; b-Ax took 197.893 ms, out of which Lap took 179.803 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 442.944 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681288, int_b + int_rho = -8.731e-14, checking this took 0.100 ms
2-norm of RHS = 627.9337160319644, which took 0.126 ms

iter_count = 156, r_2norm = 5.408e-04, tol*||rhs|| = 6.279e-04

Anderson update took 84.197 ms, out of which F'*F took 39.681 ms; b-Ax took 265.535 ms, out of which Lap took 238.432 ms
Solving Poisson took 570.333 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.167531 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.163142 
Total time for convolution: 	 convolve: 5.166831 
Total time for convolution: 	 convolve: 5.094634 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.144 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.925 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.332 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.280 ms

This SCF took 26809.250 ms, scf error = 2.426e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.130910, lowerbound = -0.973324, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1165.461 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.300 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.348 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.121 ms
rank =  0, Distribute data + matrix mult took 15.782 ms
rank =  0, finding HY took 19.509 ms
rank =  0, distributing HY into block cyclic form took 12.044 ms
rank =  0, finding Y'*HY took 4.350 ms
Rank 0, Project_Hamiltonian used 51.712 ms
Total time for projection: 51.726 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -0.973091194245107
    last  calculated eigval = 0.031227369362143
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97309119424511
lambda[   2] =  -0.67445817108222
lambda[   3] =  -0.56135612326079
lambda[   4] =  -0.44227781301697
lambda[   5] =  -0.42495983380798
lambda[   6] =  -0.34157361309442
lambda[   7] =  -0.33485051794929
lambda[   8] =  -0.31807497640584
lambda[   9] =  -0.20009775976258
lambda[  10] =  -0.02417042515182
lambda[  11] =  -0.00904144121065
lambda[  12] =   0.00691095448222
lambda[  13] =   0.02220472642388
lambda[  14] =   0.02767484699601
lambda[  15] =   0.03122736936214
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 3.568 ms
rank =  0, Distributing orbital back into band + domain format took 12.006 ms
rank = 0, Subspace_Rotation used 15.589 ms

Total time for subspace rotation: 15.594 ms
rank = 0, Efermi =  -0.053492453005 calculate fermi energy took 0.082 ms
rank = 0, --- Calculate rho: sum over local bands took 2.801 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.906 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.242 ms
rank = 0, Calculating density took 1240.094 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.585 ms
rank = 0, D2D took 0.689 ms
rank = 0, Transfering density took 0.692 ms
Etot    =   -30.944264789223
Eband   =    -8.541480005657
E1      =    19.036098379019
E2      =    -7.830263872854
E3      =   -11.147557627168
Exc     =    -9.885101226420
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 4.391e-06, dEband = 5.079e-04
rank = 0, Calculating/Estimating energy took 0.907 ms, Etot = -30.944264789, dEtot = 4.391e-06, dEband = 5.079e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0279902765431, which took 0.056 ms

iter_count = 114, r_2norm = 7.696e-07, tol*||rhs|| = 1.120e-06

Anderson update took 61.198 ms, out of which F'*F took 29.021 ms; b-Ax took 193.229 ms, out of which Lap took 174.838 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.772 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681295, int_b + int_rho = -1.091e-14, checking this took 0.101 ms
2-norm of RHS = 627.9392688096144, which took 0.090 ms

iter_count = 156, r_2norm = 6.158e-04, tol*||rhs|| = 6.279e-04

Anderson update took 84.184 ms, out of which F'*F took 39.673 ms; b-Ax took 265.035 ms, out of which Lap took 238.234 ms
Solving Poisson took 570.217 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.107157 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 54.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.117414 
Total time for convolution: 	 convolve: 5.096907 
Total time for convolution: 	 convolve: 5.082433 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.492 ms
---Transfer Veff_loc: D2D took 0.944 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.300 ms

This SCF took 26650.537 ms, scf error = 1.838e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.131227, lowerbound = -0.973091, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1165.954 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 13.686 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.360 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.206 ms
rank =  0, Distribute data + matrix mult took 17.265 ms
rank =  0, finding HY took 19.628 ms
rank =  0, distributing HY into block cyclic form took 11.920 ms
rank =  0, finding Y'*HY took 4.506 ms
Rank 0, Project_Hamiltonian used 53.350 ms
Total time for projection: 53.363 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.147 ms
    first calculated eigval = -0.972866135091789
    last  calculated eigval = 0.032466844484799
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97286613509179
lambda[   2] =  -0.67426527581700
lambda[   3] =  -0.56114545591327
lambda[   4] =  -0.44208613526617
lambda[   5] =  -0.42476774583503
lambda[   6] =  -0.34136256537675
lambda[   7] =  -0.33467249612606
lambda[   8] =  -0.31786796692975
lambda[   9] =  -0.19990962521329
lambda[  10] =  -0.02325170855160
lambda[  11] =  -0.00894629068562
lambda[  12] =   0.00669678368535
lambda[  13] =   0.02215217111842
lambda[  14] =   0.02870909544478
lambda[  15] =   0.03246684448480
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 3.499 ms
rank =  0, Distributing orbital back into band + domain format took 12.663 ms
rank = 0, Subspace_Rotation used 16.177 ms

Total time for subspace rotation: 16.184 ms
rank = 0, Efermi =  -0.052573736459 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 2.864 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.225 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.212 ms
rank = 0, Calculating density took 1242.119 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.609 ms
rank = 0, D2D took 0.712 ms
rank = 0, Transfering density took 0.715 ms
Etot    =   -30.944295869689
Eband   =    -8.537886803529
E1      =    19.034457680043
E2      =    -7.828238143123
E3      =   -11.147722185549
Exc     =    -9.885223638686
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 4.440e-06, dEband = 5.133e-04
rank = 0, Calculating/Estimating energy took 0.906 ms, Etot = -30.944295870, dEtot = 4.440e-06, dEband = 5.133e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0154689179277, which took 0.080 ms

iter_count = 114, r_2norm = 4.696e-07, tol*||rhs|| = 6.188e-07

Anderson update took 61.305 ms, out of which F'*F took 29.196 ms; b-Ax took 193.128 ms, out of which Lap took 174.981 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.047 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681291, int_b + int_rho = -5.457e-14, checking this took 0.106 ms
2-norm of RHS = 627.9421983595520, which took 0.119 ms

iter_count = 144, r_2norm = 5.781e-04, tol*||rhs|| = 6.279e-04

Anderson update took 77.514 ms, out of which F'*F took 36.697 ms; b-Ax took 245.112 ms, out of which Lap took 220.369 ms
Solving Poisson took 526.839 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.097312 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.479 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.107043 
Total time for convolution: 	 convolve: 5.114402 
Total time for convolution: 	 convolve: 5.133464 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.041 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.943 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.337 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.302 ms

This SCF took 26634.273 ms, scf error = 1.296e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.132467, lowerbound = -0.972866, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1157.370 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.524 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.288 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.215 ms
rank =  0, Distribute data + matrix mult took 23.041 ms
rank =  0, finding HY took 19.550 ms
rank =  0, distributing HY into block cyclic form took 12.025 ms
rank =  0, finding Y'*HY took 4.354 ms
Rank 0, Project_Hamiltonian used 58.996 ms
Total time for projection: 59.016 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.972769518832203
    last  calculated eigval = 0.034035709110018
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97276951883220
lambda[   2] =  -0.67415306074239
lambda[   3] =  -0.56103290640911
lambda[   4] =  -0.44196944100873
lambda[   5] =  -0.42465360159722
lambda[   6] =  -0.34126139933395
lambda[   7] =  -0.33454942729893
lambda[   8] =  -0.31775860535035
lambda[   9] =  -0.19980769553185
lambda[  10] =  -0.02251087696743
lambda[  11] =  -0.00891439788455
lambda[  12] =   0.00648009429125
lambda[  13] =   0.02240427826089
lambda[  14] =   0.02986354975071
lambda[  15] =   0.03403570911002
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 3.530 ms
rank =  0, Distributing orbital back into band + domain format took 12.774 ms
rank = 0, Subspace_Rotation used 16.323 ms

Total time for subspace rotation: 16.329 ms
rank = 0, Efermi =  -0.051832904893 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.908 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.312 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.148 ms
rank = 0, Calculating density took 1239.431 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.506 ms
rank = 0, D2D took 0.611 ms
rank = 0, Transfering density took 0.616 ms
Etot    =   -30.944313752516
Eband   =    -8.535911312588
E1      =    19.033597064893
E2      =    -7.827089187082
E3      =   -11.147801897920
Exc     =    -9.885287153635
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 2.555e-06, dEband = 2.822e-04
rank = 0, Calculating/Estimating energy took 0.901 ms, Etot = -30.944313753, dEtot = 2.555e-06, dEband = 2.822e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0125993810483, which took 0.081 ms

iter_count = 114, r_2norm = 4.088e-07, tol*||rhs|| = 5.040e-07

Anderson update took 61.254 ms, out of which F'*F took 29.025 ms; b-Ax took 193.052 ms, out of which Lap took 174.786 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.833 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681298, int_b + int_rho = 1.819e-14, checking this took 0.110 ms
2-norm of RHS = 627.9430084732707, which took 0.120 ms

iter_count = 96, r_2norm = 5.337e-04, tol*||rhs|| = 6.279e-04

Anderson update took 51.649 ms, out of which F'*F took 24.512 ms; b-Ax took 163.533 ms, out of which Lap took 146.999 ms
Solving Poisson took 352.319 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.117195 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.118878 
Total time for convolution: 	 convolve: 5.231484 
Total time for convolution: 	 convolve: 5.158868 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 1.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.939 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.326 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.287 ms

This SCF took 26718.128 ms, scf error = 1.075e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.134036, lowerbound = -0.972770, upperbound = 267.578000

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1165.491 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.284 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.359 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.127 ms
rank =  0, Distribute data + matrix mult took 15.782 ms
rank =  0, finding HY took 19.446 ms
rank =  0, distributing HY into block cyclic form took 12.026 ms
rank =  0, finding Y'*HY took 4.329 ms
Rank 0, Project_Hamiltonian used 51.612 ms
Total time for projection: 51.625 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -0.972735256204970
    last  calculated eigval = 0.034543362533151
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97273525620497
lambda[   2] =  -0.67412185143780
lambda[   3] =  -0.56099968485530
lambda[   4] =  -0.44193563951545
lambda[   5] =  -0.42461962837454
lambda[   6] =  -0.34122823521995
lambda[   7] =  -0.33451433881068
lambda[   8] =  -0.31772470237311
lambda[   9] =  -0.19977632353684
lambda[  10] =  -0.02205876767828
lambda[  11] =  -0.00889671207944
lambda[  12] =   0.00660052207145
lambda[  13] =   0.02252865507896
lambda[  14] =   0.03014981860982
lambda[  15] =   0.03454336253315
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 3.516 ms
rank =  0, Distributing orbital back into band + domain format took 12.823 ms
rank = 0, Subspace_Rotation used 16.356 ms

Total time for subspace rotation: 16.362 ms
rank = 0, Efermi =  -0.051380795581 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.862 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.289 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.248 ms
rank = 0, Calculating density took 1240.232 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
rank = 0, D2D took 0.647 ms
rank = 0, Transfering density took 0.652 ms
Etot    =   -30.944317261548
Eband   =    -8.535311321028
E1      =    19.033313016819
E2      =    -7.826758692357
E3      =   -11.147853641475
Exc     =    -9.885327854983
Esc     =   -50.531603435681
Entropy =    -0.000000000508
dE = 5.013e-07, dEband = 8.571e-05
rank = 0, Calculating/Estimating energy took 1.104 ms, Etot = -30.944317262, dEtot = 5.013e-07, dEband = 8.571e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0144734678898, which took 0.047 ms

iter_count = 114, r_2norm = 3.729e-07, tol*||rhs|| = 5.789e-07

Anderson update took 61.311 ms, out of which F'*F took 29.045 ms; b-Ax took 193.329 ms, out of which Lap took 174.935 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.995 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001681296, int_rho =  18.00000001681289, int_b + int_rho = -7.640e-14, checking this took 0.115 ms
2-norm of RHS = 627.9445010720531, which took 0.111 ms

iter_count = 102, r_2norm = 6.126e-04, tol*||rhs|| = 6.279e-04

Anderson update took 55.154 ms, out of which F'*F took 25.923 ms; b-Ax took 173.417 ms, out of which Lap took 156.107 ms
Solving Poisson took 374.053 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.095619 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.545 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.084818 
Total time for convolution: 	 convolve: 5.118054 
Total time for convolution: 	 convolve: 5.110966 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.935 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.952 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.311 ms

This SCF took 26431.354 ms, scf error = 9.659e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.97273525620497, occ[   1] =   2.00000000000000
lambda[   2] =  -0.67412185143780, occ[   2] =   2.00000000000000
lambda[   3] =  -0.56099968485530, occ[   3] =   2.00000000000000
lambda[   4] =  -0.44193563951545, occ[   4] =   2.00000000000000
lambda[   5] =  -0.42461962837454, occ[   5] =   2.00000000000000
lambda[   6] =  -0.34122823521995, occ[   6] =   2.00000000000000
lambda[   7] =  -0.33451433881068, occ[   7] =   2.00000000000000
lambda[   8] =  -0.31772470237311, occ[   8] =   2.00000000000000
lambda[   9] =  -0.19977632353684, occ[   9] =   2.00000000000000
lambda[  10] =  -0.02205876767828, occ[  10] =   0.00000001681294
lambda[  11] =  -0.00889671207944, occ[  11] =   0.00000000000000
lambda[  12] =   0.00660052207145, occ[  12] =   0.00000000000000
lambda[  13] =   0.02252865507896, occ[  13] =   0.00000000000000
lambda[  14] =   0.03014981860982, occ[  14] =   0.00000000000000
lambda[  15] =   0.03454336253315, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.477 ms, time for Allreduce/Reduce: 7.940 ms 
Time for calculating local force components: 17.125 ms
Start Calculating nonlocal forces
force_nloc = 
  0.98505127329935  -0.47248876404971  -0.00000230931223
 -0.00788280733088   0.04953798503816  -0.00000002851635
 -0.04177150135941  -0.02981086310706  -0.00000000449492
  0.00692920142796  -0.05235069279998   0.00000000915809
 -0.00985840718481   0.07396799829900  -0.00000000313037
 -0.01418226150331  -0.00849939228171   0.00000343529458
 -0.20797754231185  -0.09439968927571   0.00000007466534
force_loc = 
 -0.96123405558016   0.45690259040884   0.00000503032999
  0.00833143745052  -0.05162478194568   0.00000094237857
  0.04309435018949   0.03105950419695   0.00000094511118
 -0.00701895822274   0.05438607057082   0.00000054018381
  0.00985570031837  -0.07645138196877  -0.00000023577010
  0.02513130104254   0.00218111599512   0.00000007711203
  0.19334321082093   0.09900617061781   0.00000048374227
Time for calculating nonlocal force components: 26.766 ms
[32mforces_xc: 
[0m[32m -0.02979486578358   0.01407003171807   0.00000022827754
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00458063247755   0.00266099384041   0.00000005161065
[0m[32m  0.01230925577251   0.00201995127643  -0.00000004169439
[0mTime for calculating XC forces components: 23.215 ms
 Cartesian force = 
 -0.00594117643116  -0.00153997714180   0.00000163573163
  0.00048510175287  -0.00211063212652  -0.00000039970145
  0.00135932046331   0.00122480587089  -0.00000037294741
 -0.00005328516154   0.00201154255184  -0.00000076422177
  0.00003376476679  -0.00250721888877  -0.00000155246415
  0.00640487869490  -0.00368111766518   0.00000225045360
 -0.00228860408517   0.00660259739953  -0.00000079685045
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Time for printing density: 384.112 ms
The program took 462.686 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:49
Job ID:        2266801
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:34:36,vmem=30116K,walltime=00:07:53,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-011-13-2
---------------------------------------
