---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:37
Job ID:    2266733
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:41
Job ID:    2266733
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.024 ms

Set default values took 0.005 ms
Reading input file sprc-calc.inpt

Reading input file took 13.741 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 4.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = N.psp8

Reading ion file took 10.342 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 61.272 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.903 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.113 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   11.322000	    9.623603	
   11.526515	    8.678000	    9.623603	
    8.473485	    8.678000	    9.623603	
   10.000000	    9.559334	   10.376397	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.193 ms
Set up communicators.

--set up spincomm took 2.228 ms

--set up kptcomm took 0.378 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 9, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 9 
rank =  0, my blacs rank = 0, BLCYC size (250000, 3), actual size (250000, 3)
rank = 0, mb = nb = 9, mbQ = nbQ = 64
rank = 0, nr_Hp = 9, nc_Hp = 9
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.064 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 3
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.135 ms

Calculate_SplineDerivRadFun took 0.108 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.788 ms.
time spent on vectorized spline interp: 3.397 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.550 ms.
time spent on vectorized spline interp: 1.976 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.524 ms.

Calculating rb for all atom types took 12.244 ms
----------------------
Estimated memory usage
Total: 688.18 MB
orbitals             : 411.99 MB
global sized vectors : 213.62 MB
subspace matrices : 7.59 kB
others : 62.56 MB
----------------------------------------------
Estimated memory usage per processor: 57.35 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.917 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -8.0000000118285, sum_int_rho = 7.7070400993610
PosCharge = 8.000000011828, NegCharge = -7.707040099361, scal_fac = 1.038011987571
After scaling, int_rho = 8.0000000118285, PosCharge + NegCharge - NetCharge = -1.066e-14
--Calculate Vref took 0.166 ms
--Calculate rho_guess took 0.788 ms

 integral of b = -8.0000000118285,
 int{b} + Nelectron + NetCharge = -1.183e-08,
 Esc = -20.9318731659670,
 MPI_Reduce took 1.070 ms

Calculating b & b_ref took 5.510 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.028 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.102 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.009 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.100 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.015 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 16.575 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182849, int_b + int_rho = -8.549e-14, checking this took 0.200 ms
2-norm of RHS = 481.8800005955011, which took 0.843 ms

iter_count = 414, r_2norm = 4.543e-04, tol*||rhs|| = 4.819e-04

Anderson update took 256.615 ms, out of which F'*F took 122.352 ms; b-Ax took 830.399 ms, out of which Lap took 737.410 ms
Solving Poisson took 1845.124 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.482 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
Total time for convolution: 	 convolve: 5.112442 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
Total time for convolution: 	 convolve: 5.125292 
Total time for convolution: 	 convolve: 5.102287 
Total time for convolution: 	 convolve: 5.103363 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.715 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
rank = 0, XC calculation took 24274.009 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.583 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.230 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.948 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.144 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.895 ms
    Lanczos iter 52, eigmin  = -0.891311913, eigmax = 264.907587893, err_eigmin = 1.092e-04, err_eigmax = 9.990e-03
rank =   0, Lanczos took 132.168 ms, eigmin = -0.891311913376, eigmax = 267.556663771728

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.282676, lowerbound = -0.991312, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 873.970 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.184 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.835 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 11.054 ms
rank =  0, finding HY took 14.353 ms
rank =  0, distributing HY into block cyclic form took 8.134 ms
rank =  0, finding Y'*HY took 3.820 ms
Rank 0, Project_Hamiltonian used 37.410 ms
Total time for projection: 37.423 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.353 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.420 ms
    first calculated eigval = 2.857163428669538
    last  calculated eigval = 3.164875093443990
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =   2.85716342866954
lambda[   2] =   2.92280833312480
lambda[   3] =   2.96142354588273
lambda[   4] =   2.98850752602325
lambda[   5] =   3.03289767671163
lambda[   6] =   3.06945411072294
lambda[   7] =   3.10035362497797
lambda[   8] =   3.14662775879198
lambda[   9] =   3.16487509344399
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.440 ms
rank =  0, subspace rotation using ScaLAPACK took 2.653 ms
rank =  0, Distributing orbital back into band + domain format took 8.319 ms
rank = 0, Subspace_Rotation used 10.989 ms

Total time for subspace rotation: 10.993 ms
rank = 0, Efermi =   3.010702953027 calculate fermi energy took 0.054 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.264875, lowerbound = -0.991312, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 855.497 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 23.520 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.541 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.041 ms
rank =  0, Distribute data + matrix mult took 26.116 ms
rank =  0, finding HY took 13.675 ms
rank =  0, distributing HY into block cyclic form took 8.207 ms
rank =  0, finding Y'*HY took 3.808 ms
Rank 0, Project_Hamiltonian used 51.870 ms
Total time for projection: 51.878 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -0.497303621333907
    last  calculated eigval = 0.420154454981767
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.49730362133391
lambda[   2] =  -0.06334911774439
lambda[   3] =   0.10295508185125
lambda[   4] =   0.29943453397062
lambda[   5] =   0.34497526536256
lambda[   6] =   0.36583462302895
lambda[   7] =   0.39358403154650
lambda[   8] =   0.40845355617915
lambda[   9] =   0.42015445498177
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 2.591 ms
rank =  0, Distributing orbital back into band + domain format took 8.265 ms
rank = 0, Subspace_Rotation used 10.873 ms

Total time for subspace rotation: 10.880 ms
rank = 0, Efermi =   0.322205467326 calculate fermi energy took 0.079 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.520154, lowerbound = -0.991312, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 842.289 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.015 ms
rank =  0, Distribute orbital to block cyclic format took 19.072 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.470 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 21.572 ms
rank =  0, finding HY took 13.568 ms
rank =  0, distributing HY into block cyclic form took 8.256 ms
rank =  0, finding Y'*HY took 3.029 ms
Rank 0, Project_Hamiltonian used 46.470 ms
Total time for projection: 46.476 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.891181025592920
    last  calculated eigval = 0.152293293701328
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.89118102559292
lambda[   2] =  -0.50709763955442
lambda[   3] =  -0.49775828235821
lambda[   4] =  -0.30062017567707
lambda[   5] =   0.07411708945646
lambda[   6] =   0.10699535632552
lambda[   7] =   0.12414087286608
lambda[   8] =   0.14115779164258
lambda[   9] =   0.15229329370133
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 2.607 ms
rank =  0, Distributing orbital back into band + domain format took 8.249 ms
rank = 0, Subspace_Rotation used 10.871 ms

Total time for subspace rotation: 10.877 ms
rank = 0, Efermi =   0.044482068385 calculate fermi energy took 0.027 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.252293, lowerbound = -0.991312, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 851.211 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.473 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.401 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 11.900 ms
rank =  0, finding HY took 13.656 ms
rank =  0, distributing HY into block cyclic form took 8.336 ms
rank =  0, finding Y'*HY took 2.902 ms
Rank 0, Project_Hamiltonian used 36.828 ms
Total time for projection: 36.850 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.872 ms
rank = 0, Solve_Generalized_EigenProblem used 0.948 ms
    first calculated eigval = -0.891729521728509
    last  calculated eigval = 0.089242123756106
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.89172952172851
lambda[   2] =  -0.51271278054262
lambda[   3] =  -0.51264514210976
lambda[   4] =  -0.33963010292294
lambda[   5] =   0.00956202053174
lambda[   6] =   0.05395407641923
lambda[   7] =   0.06532242667923
lambda[   8] =   0.08044525825853
lambda[   9] =   0.08924212375611
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.957 ms
rank =  0, subspace rotation using ScaLAPACK took 2.599 ms
rank =  0, Distributing orbital back into band + domain format took 8.165 ms
rank = 0, Subspace_Rotation used 10.781 ms

Total time for subspace rotation: 10.787 ms
rank = 0, Efermi =  -0.020073000588 calculate fermi energy took 0.029 ms
rank = 0, --- Calculate rho: sum over local bands took 1.922 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.813 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.235 ms
rank = 0, Calculating density took 3781.548 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.704 ms
rank = 0, D2D took 1.075 ms
rank = 0, Transfering density took 1.085 ms
Etot    =   -12.216128930941
Eband   =    -4.513435094495
E1      =     9.166496246321
E2      =    -3.478683260575
E3      =    -4.538547998640
Exc     =    -3.954548175656
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 3.054e+00, dEband = 1.128e+00
rank = 0, Calculating/Estimating energy took 1.215 ms, Etot = -12.216128931, dEtot = 3.054e+00, dEband = 1.128e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 34.6526612981755, which took 0.906 ms

iter_count = 96, r_2norm = 1.035e-03, tol*||rhs|| = 1.386e-03

Anderson update took 57.084 ms, out of which F'*F took 27.218 ms; b-Ax took 188.643 ms, out of which Lap took 165.774 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.617 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182849, int_b + int_rho = -8.913e-14, checking this took 0.139 ms
2-norm of RHS = 478.9276413050010, which took 0.188 ms

iter_count = 282, r_2norm = 4.783e-04, tol*||rhs|| = 4.789e-04

Anderson update took 169.768 ms, out of which F'*F took 78.592 ms; b-Ax took 562.206 ms, out of which Lap took 501.564 ms
Solving Poisson took 1247.169 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.149099 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.702 ms
Total time for convolution: 	 convolve: 5.114259 
Total time for convolution: 	 convolve: 5.095003 
Total time for convolution: 	 convolve: 5.155905 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.376 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.610 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.184 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.988 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.841 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.850 ms

This SCF took 29935.257 ms, scf error = 1.779e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.189242, lowerbound = -0.891730, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 866.858 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.560 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.318 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 10.903 ms
rank =  0, finding HY took 13.678 ms
rank =  0, distributing HY into block cyclic form took 8.447 ms
rank =  0, finding Y'*HY took 3.345 ms
Rank 0, Project_Hamiltonian used 36.804 ms
Total time for projection: 36.818 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.060 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.116 ms
    first calculated eigval = -0.849663494723150
    last  calculated eigval = 0.062207135104692
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.84966349472315
lambda[   2] =  -0.47666711832562
lambda[   3] =  -0.47649361966307
lambda[   4] =  -0.29566974022218
lambda[   5] =  -0.02808011650396
lambda[   6] =   0.03013835380756
lambda[   7] =   0.03330566765538
lambda[   8] =   0.04610482517106
lambda[   9] =   0.06220713510469
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 2.604 ms
rank =  0, Distributing orbital back into band + domain format took 8.111 ms
rank = 0, Subspace_Rotation used 10.727 ms

Total time for subspace rotation: 10.732 ms
rank = 0, Efermi =  -0.057715137607 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 1.771 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.893 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.207 ms
rank = 0, Calculating density took 920.548 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.643 ms
rank = 0, D2D took 0.885 ms
rank = 0, Transfering density took 0.895 ms
Etot    =   -12.189740116991
Eband   =    -4.196987946200
E1      =     8.903584746200
E2      =    -3.434569624704
E3      =    -4.620626712693
Exc     =    -4.019660088060
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 6.597e-03, dEband = 7.911e-02
rank = 0, Calculating/Estimating energy took 1.154 ms, Etot = -12.189740117, dEtot = 6.597e-03, dEband = 7.911e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 14.7534686465888, which took 0.107 ms

iter_count = 102, r_2norm = 3.929e-04, tol*||rhs|| = 5.901e-04

Anderson update took 60.804 ms, out of which F'*F took 28.229 ms; b-Ax took 191.773 ms, out of which Lap took 169.964 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.353 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182851, int_b + int_rho = -6.366e-14, checking this took 0.130 ms
2-norm of RHS = 476.3646541076515, which took 0.175 ms

iter_count = 288, r_2norm = 4.327e-04, tol*||rhs|| = 4.764e-04

Anderson update took 171.886 ms, out of which F'*F took 81.963 ms; b-Ax took 550.016 ms, out of which Lap took 490.859 ms
Solving Poisson took 1202.127 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.871 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.725 ms
Total time for convolution: 	 convolve: 5.144554 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.698 ms
Total time for convolution: 	 convolve: 5.150941 
Total time for convolution: 	 convolve: 5.148362 
Total time for convolution: 	 convolve: 5.153287 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.960 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.839 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.819 ms

This SCF took 27119.819 ms, scf error = 1.129e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.162207, lowerbound = -0.849663, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 871.939 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.483 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.662 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 11.546 ms
rank =  0, finding HY took 13.801 ms
rank =  0, distributing HY into block cyclic form took 8.238 ms
rank =  0, finding Y'*HY took 2.959 ms
Rank 0, Project_Hamiltonian used 36.586 ms
Total time for projection: 36.598 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.807485401573363
    last  calculated eigval = 0.050926922699351
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.80748540157336
lambda[   2] =  -0.43984837318953
lambda[   3] =  -0.43973499402214
lambda[   4] =  -0.25250244868206
lambda[   5] =  -0.03825554744638
lambda[   6] =   0.01944533663669
lambda[   7] =   0.02270945290887
lambda[   8] =   0.02938614530371
lambda[   9] =   0.05092692269935
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.138 ms
rank =  0, subspace rotation using ScaLAPACK took 2.624 ms
rank =  0, Distributing orbital back into band + domain format took 8.194 ms
rank = 0, Subspace_Rotation used 10.831 ms

Total time for subspace rotation: 10.837 ms
rank = 0, Efermi =  -0.067890568609 calculate fermi energy took 0.071 ms
rank = 0, --- Calculate rho: sum over local bands took 1.863 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.606 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.210 ms
rank = 0, Calculating density took 925.325 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.661 ms
rank = 0, D2D took 1.036 ms
rank = 0, Transfering density took 1.041 ms
Etot    =   -12.178122822739
Eband   =    -3.879142435387
E1      =     8.646036615537
E2      =    -3.366114033820
E3      =    -4.714481632873
Exc     =    -4.093739503254
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 2.904e-03, dEband = 7.946e-02
rank = 0, Calculating/Estimating energy took 1.172 ms, Etot = -12.178122823, dEtot = 2.904e-03, dEband = 7.946e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.9294465101061, which took 0.057 ms

iter_count = 108, r_2norm = 8.093e-05, tol*||rhs|| = 1.172e-04

Anderson update took 65.118 ms, out of which F'*F took 30.201 ms; b-Ax took 202.548 ms, out of which Lap took 180.329 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.871 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182850, int_b + int_rho = -7.549e-14, checking this took 0.127 ms
2-norm of RHS = 476.2275079415843, which took 0.125 ms

iter_count = 282, r_2norm = 4.403e-04, tol*||rhs|| = 4.762e-04

Anderson update took 175.649 ms, out of which F'*F took 85.798 ms; b-Ax took 542.351 ms, out of which Lap took 486.512 ms
Solving Poisson took 1191.192 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.139780 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.760 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 6.302489 
Total time for convolution: 	 convolve: 5.135725 
Total time for convolution: 	 convolve: 5.136058 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.383 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.387 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.942 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.837 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.797 ms

This SCF took 28358.727 ms, scf error = 5.976e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.150927, lowerbound = -0.807485, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 840.640 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 12.602 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.329 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 14.959 ms
rank =  0, finding HY took 13.986 ms
rank =  0, distributing HY into block cyclic form took 8.829 ms
rank =  0, finding Y'*HY took 2.672 ms
Rank 0, Project_Hamiltonian used 40.997 ms
Total time for projection: 41.018 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.068 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.792942489350519
    last  calculated eigval = 0.044048292218525
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.79294248935052
lambda[   2] =  -0.42485425589438
lambda[   3] =  -0.42483620533977
lambda[   4] =  -0.23938712991446
lambda[   5] =  -0.04055429136626
lambda[   6] =   0.01459903956340
lambda[   7] =   0.01759872414732
lambda[   8] =   0.02071708864316
lambda[   9] =   0.04404829221853
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 2.609 ms
rank =  0, Distributing orbital back into band + domain format took 8.308 ms
rank = 0, Subspace_Rotation used 10.934 ms

Total time for subspace rotation: 10.939 ms
rank = 0, Efermi =  -0.070189312455 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 1.843 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.914 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.198 ms
rank = 0, Calculating density took 898.834 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.741 ms
rank = 0, D2D took 1.298 ms
rank = 0, Transfering density took 1.303 ms
Etot    =   -12.174892220510
Eband   =    -3.764040161478
E1      =     8.577730558146
E2      =    -3.311642628257
E3      =    -4.759412206019
Exc     =    -4.127764285126
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 8.077e-04, dEband = 2.878e-02
rank = 0, Calculating/Estimating energy took 1.102 ms, Etot = -12.174892221, dEtot = 8.077e-04, dEband = 2.878e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0748700513180, which took 0.091 ms

iter_count = 108, r_2norm = 4.150e-05, tol*||rhs|| = 4.299e-05

Anderson update took 65.126 ms, out of which F'*F took 29.541 ms; b-Ax took 201.190 ms, out of which Lap took 178.953 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.425 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182848, int_b + int_rho = -9.641e-14, checking this took 0.158 ms
2-norm of RHS = 476.1760387455245, which took 0.147 ms

iter_count = 240, r_2norm = 4.442e-04, tol*||rhs|| = 4.762e-04

Anderson update took 148.244 ms, out of which F'*F took 68.792 ms; b-Ax took 464.126 ms, out of which Lap took 414.567 ms
Solving Poisson took 1010.082 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.141343 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 165.868 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.162039 
Total time for convolution: 	 convolve: 5.145073 
Total time for convolution: 	 convolve: 5.153412 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.387 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.183 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.953 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.986 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.961 ms

This SCF took 27071.198 ms, scf error = 1.016e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.144048, lowerbound = -0.792942, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 846.863 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.951 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.377 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.352 ms
rank =  0, finding HY took 14.100 ms
rank =  0, distributing HY into block cyclic form took 8.199 ms
rank =  0, finding Y'*HY took 3.088 ms
Rank 0, Project_Hamiltonian used 40.771 ms
Total time for projection: 40.853 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.069 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.788940185134402
    last  calculated eigval = 0.040253913470588
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.78894018513440
lambda[   2] =  -0.42125667139753
lambda[   3] =  -0.42124734426756
lambda[   4] =  -0.23544648319846
lambda[   5] =  -0.04119082959911
lambda[   6] =   0.01326037414287
lambda[   7] =   0.01510486802402
lambda[   8] =   0.01788607908218
lambda[   9] =   0.04025391347059
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.133 ms
rank =  0, subspace rotation using ScaLAPACK took 2.558 ms
rank =  0, Distributing orbital back into band + domain format took 8.088 ms
rank = 0, Subspace_Rotation used 10.661 ms

Total time for subspace rotation: 10.667 ms
rank = 0, Efermi =  -0.070825850685 calculate fermi energy took 1.963 ms
rank = 0, --- Calculate rho: sum over local bands took 2.482 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.264 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.219 ms
rank = 0, Calculating density took 905.879 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.698 ms
rank = 0, D2D took 1.116 ms
rank = 0, Transfering density took 1.118 ms
Etot    =   -12.174671122143
Eband   =    -3.733781368483
E1      =     8.558091039023
E2      =    -3.298997856204
E3      =    -4.768429287992
Exc     =    -4.134534770550
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 5.527e-05, dEband = 7.565e-03
rank = 0, Calculating/Estimating energy took 1.067 ms, Etot = -12.174671122, dEtot = 5.527e-05, dEband = 7.565e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3949004775880, which took 0.054 ms

iter_count = 114, r_2norm = 9.459e-06, tol*||rhs|| = 1.580e-05

Anderson update took 69.243 ms, out of which F'*F took 32.799 ms; b-Ax took 217.937 ms, out of which Lap took 195.051 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.177 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182850, int_b + int_rho = -7.458e-14, checking this took 0.121 ms
2-norm of RHS = 476.4667279060608, which took 0.174 ms

iter_count = 264, r_2norm = 4.705e-04, tol*||rhs|| = 4.765e-04

Anderson update took 161.921 ms, out of which F'*F took 77.289 ms; b-Ax took 522.973 ms, out of which Lap took 471.289 ms
Solving Poisson took 1115.176 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.177 ms
Total time for convolution: 	 convolve: 5.157517 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 169.818 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.226854 
Total time for convolution: 	 convolve: 5.152181 
Total time for convolution: 	 convolve: 5.152032 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.431 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.949 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.371 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.344 ms

This SCF took 27370.764 ms, scf error = 7.662e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.140254, lowerbound = -0.788940, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 846.996 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.373 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.345 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 10.741 ms
rank =  0, finding HY took 13.724 ms
rank =  0, distributing HY into block cyclic form took 8.130 ms
rank =  0, finding Y'*HY took 3.049 ms
Rank 0, Project_Hamiltonian used 35.675 ms
Total time for projection: 35.692 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -0.784247998747453
    last  calculated eigval = 0.036357753505310
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.78424799874745
lambda[   2] =  -0.41697376625019
lambda[   3] =  -0.41697071063193
lambda[   4] =  -0.23066090438920
lambda[   5] =  -0.04107521862294
lambda[   6] =   0.01214850187977
lambda[   7] =   0.01307705981716
lambda[   8] =   0.01692245139074
lambda[   9] =   0.03635775350531
==subpsace eigenproblem: bcast eigvals took 0.047 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 2.570 ms
rank =  0, Distributing orbital back into band + domain format took 8.278 ms
rank = 0, Subspace_Rotation used 10.862 ms

Total time for subspace rotation: 10.868 ms
rank = 0, Efermi =  -0.070710239744 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.401 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.206 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.187 ms
rank = 0, Calculating density took 899.673 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.791 ms
rank = 0, D2D took 1.019 ms
rank = 0, Transfering density took 1.023 ms
Etot    =   -12.174634561790
Eband   =    -3.697706760523
E1      =     8.544816852491
E2      =    -3.273759959680
E3      =    -4.775146775771
Exc     =    -4.138778222881
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 9.140e-06, dEband = 9.019e-03
rank = 0, Calculating/Estimating energy took 1.065 ms, Etot = -12.174634562, dEtot = 9.140e-06, dEband = 9.019e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3176182612143, which took 0.068 ms

iter_count = 108, r_2norm = 1.135e-05, tol*||rhs|| = 1.270e-05

Anderson update took 65.436 ms, out of which F'*F took 31.003 ms; b-Ax took 207.871 ms, out of which Lap took 185.645 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.672 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182852, int_b + int_rho = -5.912e-14, checking this took 0.146 ms
2-norm of RHS = 476.4055581737475, which took 0.143 ms

iter_count = 222, r_2norm = 4.682e-04, tol*||rhs|| = 4.764e-04

Anderson update took 145.242 ms, out of which F'*F took 63.977 ms; b-Ax took 413.138 ms, out of which Lap took 376.353 ms
Solving Poisson took 931.068 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.853 ms
Total time for convolution: 	 convolve: 5.177342 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 943.900 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.147401 
Total time for convolution: 	 convolve: 5.182886 
Total time for convolution: 	 convolve: 5.153077 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.400 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.146 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.200 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.958 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.375 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.022 ms

This SCF took 27993.082 ms, scf error = 2.972e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.136358, lowerbound = -0.784248, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 824.660 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 8.296 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.393 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 10.711 ms
rank =  0, finding HY took 13.617 ms
rank =  0, distributing HY into block cyclic form took 8.294 ms
rank =  0, finding Y'*HY took 3.184 ms
Rank 0, Project_Hamiltonian used 35.852 ms
Total time for projection: 35.868 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.782314347447975
    last  calculated eigval = 0.034464586010214
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.78231434744797
lambda[   2] =  -0.41517123250888
lambda[   3] =  -0.41516585859912
lambda[   4] =  -0.22860189481750
lambda[   5] =  -0.04061589768467
lambda[   6] =   0.01121056973012
lambda[   7] =   0.01344214815894
lambda[   8] =   0.01691488156073
lambda[   9] =   0.03446458601021
==subpsace eigenproblem: bcast eigvals took 0.057 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 2.569 ms
rank =  0, Distributing orbital back into band + domain format took 8.242 ms
rank = 0, Subspace_Rotation used 10.825 ms

Total time for subspace rotation: 10.831 ms
rank = 0, Efermi =  -0.070250918816 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 2.378 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.302 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.200 ms
rank = 0, Calculating density took 877.557 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 0.801 ms
rank = 0, D2D took 1.029 ms
rank = 0, Transfering density took 1.032 ms
Etot    =   -12.174694391247
Eband   =    -3.682506667227
E1      =     8.535046192096
E2      =    -3.267460808361
E3      =    -4.778634740671
Exc     =    -4.141456298819
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 1.496e-05, dEband = 3.800e-03
rank = 0, Calculating/Estimating energy took 1.085 ms, Etot = -12.174694391, dEtot = 1.496e-05, dEband = 3.800e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1313143590069, which took 0.062 ms

iter_count = 114, r_2norm = 3.418e-06, tol*||rhs|| = 5.253e-06

Anderson update took 73.540 ms, out of which F'*F took 32.577 ms; b-Ax took 212.735 ms, out of which Lap took 192.412 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.192 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182847, int_b + int_rho = -1.037e-13, checking this took 0.115 ms
2-norm of RHS = 476.4131431855588, which took 0.162 ms

iter_count = 234, r_2norm = 4.403e-04, tol*||rhs|| = 4.764e-04

Anderson update took 151.366 ms, out of which F'*F took 65.862 ms; b-Ax took 433.086 ms, out of which Lap took 391.736 ms
Solving Poisson took 993.761 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.170230 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 169.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.202857 
Total time for convolution: 	 convolve: 5.187459 
Total time for convolution: 	 convolve: 5.155758 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.606 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.976 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 1.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.627 ms

This SCF took 27180.179 ms, scf error = 2.240e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.134465, lowerbound = -0.782314, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 836.715 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.216 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.373 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 14.632 ms
rank =  0, finding HY took 13.413 ms
rank =  0, distributing HY into block cyclic form took 8.003 ms
rank =  0, finding Y'*HY took 3.473 ms
Rank 0, Project_Hamiltonian used 39.553 ms
Total time for projection: 39.576 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.047 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.781177162550436
    last  calculated eigval = 0.033244254492842
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.78117716255044
lambda[   2] =  -0.41395183599268
lambda[   3] =  -0.41394476765625
lambda[   4] =  -0.22725286584979
lambda[   5] =  -0.03780343500028
lambda[   6] =   0.01109621692342
lambda[   7] =   0.01660318020773
lambda[   8] =   0.01946673876646
lambda[   9] =   0.03324425449284
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 2.473 ms
rank =  0, Distributing orbital back into band + domain format took 8.281 ms
rank = 0, Subspace_Rotation used 10.769 ms

Total time for subspace rotation: 10.774 ms
rank = 0, Efermi =  -0.067438456139 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 2.456 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.252 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.212 ms
rank = 0, Calculating density took 893.264 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.846 ms
rank = 0, D2D took 1.075 ms
rank = 0, Transfering density took 1.079 ms
Etot    =   -12.174794016207
Eband   =    -3.672653264545
E1      =     8.531449742721
E2      =    -3.261049696846
E3      =    -4.778939964194
Exc     =    -4.141706989094
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 2.491e-05, dEband = 2.463e-03
rank = 0, Calculating/Estimating energy took 1.117 ms, Etot = -12.174794016, dEtot = 2.491e-05, dEband = 2.463e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1416811060885, which took 0.067 ms

iter_count = 102, r_2norm = 5.517e-06, tol*||rhs|| = 5.667e-06

Anderson update took 61.036 ms, out of which F'*F took 28.947 ms; b-Ax took 193.657 ms, out of which Lap took 173.627 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 447.379 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182852, int_b + int_rho = -5.730e-14, checking this took 0.151 ms
2-norm of RHS = 476.4389086894478, which took 0.185 ms

iter_count = 222, r_2norm = 4.622e-04, tol*||rhs|| = 4.764e-04

Anderson update took 133.570 ms, out of which F'*F took 61.296 ms; b-Ax took 417.647 ms, out of which Lap took 373.473 ms
Solving Poisson took 930.208 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.194789 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 121.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.191740 
Total time for convolution: 	 convolve: 5.152816 
Total time for convolution: 	 convolve: 5.160269 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.728 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.141 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.280 ms
---Transfer Veff_loc: D2D took 2.015 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.367 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.405 ms

This SCF took 27025.366 ms, scf error = 1.121e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.133244, lowerbound = -0.781177, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 826.278 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.606 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.372 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 25.021 ms
rank =  0, finding HY took 13.593 ms
rank =  0, distributing HY into block cyclic form took 8.385 ms
rank =  0, finding Y'*HY took 2.931 ms
Rank 0, Project_Hamiltonian used 49.973 ms
Total time for projection: 49.992 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.779689245286466
    last  calculated eigval = 0.033409573601302
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77968924528647
lambda[   2] =  -0.41251321334094
lambda[   3] =  -0.41250673523577
lambda[   4] =  -0.22603308555934
lambda[   5] =  -0.03296948548547
lambda[   6] =   0.01166824054160
lambda[   7] =   0.02294103400533
lambda[   8] =   0.02475818478406
lambda[   9] =   0.03340957360130
==subpsace eigenproblem: bcast eigvals took 0.049 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 2.468 ms
rank =  0, Distributing orbital back into band + domain format took 8.218 ms
rank = 0, Subspace_Rotation used 10.702 ms

Total time for subspace rotation: 10.708 ms
rank = 0, Efermi =  -0.062604506620 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 2.422 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.241 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.207 ms
rank = 0, Calculating density took 893.173 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.819 ms
rank = 0, D2D took 1.011 ms
rank = 0, Transfering density took 1.014 ms
Etot    =   -12.174866586988
Eband   =    -3.661484559235
E1      =     8.526313843033
E2      =    -3.254711666782
E3      =    -4.780268874506
Exc     =    -4.142803245746
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 1.814e-05, dEband = 2.792e-03
rank = 0, Calculating/Estimating energy took 1.083 ms, Etot = -12.174866587, dEtot = 1.814e-05, dEband = 2.792e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0717233213735, which took 0.062 ms

iter_count = 108, r_2norm = 2.543e-06, tol*||rhs|| = 2.869e-06

Anderson update took 65.462 ms, out of which F'*F took 30.229 ms; b-Ax took 204.180 ms, out of which Lap took 182.300 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.666 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182849, int_b + int_rho = -8.185e-14, checking this took 0.132 ms
2-norm of RHS = 476.4280978715731, which took 0.069 ms

iter_count = 174, r_2norm = 4.498e-04, tol*||rhs|| = 4.764e-04

Anderson update took 105.688 ms, out of which F'*F took 50.064 ms; b-Ax took 334.748 ms, out of which Lap took 300.550 ms
Solving Poisson took 739.752 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.154670 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 158.476 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.160007 
Total time for convolution: 	 convolve: 5.151411 
Total time for convolution: 	 convolve: 5.152985 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.000 ms
---Transfer Veff_loc: D2D took 1.737 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.357 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.117 ms

This SCF took 26831.509 ms, scf error = 8.264e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.133410, lowerbound = -0.779689, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 834.004 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 28.258 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.405 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 30.712 ms
rank =  0, finding HY took 13.599 ms
rank =  0, distributing HY into block cyclic form took 8.302 ms
rank =  0, finding Y'*HY took 3.020 ms
Rank 0, Project_Hamiltonian used 55.663 ms
Total time for projection: 55.681 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.779602151524373
    last  calculated eigval = 0.033565497075565
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77960215152437
lambda[   2] =  -0.41241831842714
lambda[   3] =  -0.41241222999492
lambda[   4] =  -0.22595174187954
lambda[   5] =  -0.03251093165866
lambda[   6] =   0.01136734238508
lambda[   7] =   0.02364243154314
lambda[   8] =   0.02527623821049
lambda[   9] =   0.03356549707556
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 2.467 ms
rank =  0, Distributing orbital back into band + domain format took 8.185 ms
rank = 0, Subspace_Rotation used 10.668 ms

Total time for subspace rotation: 10.674 ms
rank = 0, Efermi =  -0.062145952701 calculate fermi energy took 0.110 ms
rank = 0, --- Calculate rho: sum over local bands took 2.430 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.233 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.245 ms
rank = 0, Calculating density took 906.614 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.793 ms
rank = 0, D2D took 1.027 ms
rank = 0, Transfering density took 1.032 ms
Etot    =   -12.174912384182
Eband   =    -3.660768884037
E1      =     8.525721769940
E2      =    -3.254610872183
E3      =    -4.780190082377
Exc     =    -4.142793058318
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 1.145e-05, dEband = 1.789e-04
rank = 0, Calculating/Estimating energy took 1.072 ms, Etot = -12.174912384, dEtot = 1.145e-05, dEband = 1.789e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0523908354903, which took 0.085 ms

iter_count = 108, r_2norm = 1.541e-06, tol*||rhs|| = 2.096e-06

Anderson update took 65.470 ms, out of which F'*F took 30.212 ms; b-Ax took 204.685 ms, out of which Lap took 182.693 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.642 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182850, int_b + int_rho = -7.276e-14, checking this took 0.819 ms
2-norm of RHS = 476.4464058660772, which took 0.138 ms

iter_count = 192, r_2norm = 4.127e-04, tol*||rhs|| = 4.764e-04

Anderson update took 116.542 ms, out of which F'*F took 55.291 ms; b-Ax took 368.412 ms, out of which Lap took 331.266 ms
Solving Poisson took 816.043 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.151774 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 143.620 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.142763 
Total time for convolution: 	 convolve: 5.155000 
Total time for convolution: 	 convolve: 5.143273 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.161 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.957 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.379 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.358 ms

This SCF took 26937.627 ms, scf error = 6.047e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.133565, lowerbound = -0.779602, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 826.127 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.221 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.431 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 23.676 ms
rank =  0, finding HY took 13.539 ms
rank =  0, distributing HY into block cyclic form took 8.425 ms
rank =  0, finding Y'*HY took 2.961 ms
Rank 0, Project_Hamiltonian used 48.633 ms
Total time for projection: 48.655 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.053 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.779145237150657
    last  calculated eigval = 0.034897680831086
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77914523715066
lambda[   2] =  -0.41194673549954
lambda[   3] =  -0.41193996106345
lambda[   4] =  -0.22549158850939
lambda[   5] =  -0.03033510706277
lambda[   6] =   0.01131580932214
lambda[   7] =   0.02710773443840
lambda[   8] =   0.02847592286655
lambda[   9] =   0.03489768083109
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 2.440 ms
rank =  0, Distributing orbital back into band + domain format took 8.353 ms
rank = 0, Subspace_Rotation used 10.810 ms

Total time for subspace rotation: 10.816 ms
rank = 0, Efermi =  -0.059970128144 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 2.481 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.109 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.206 ms
rank = 0, Calculating density took 891.680 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.837 ms
rank = 0, D2D took 1.052 ms
rank = 0, Transfering density took 1.056 ms
Etot    =   -12.174970564109
Eband   =    -3.657047044805
E1      =     8.524238100379
E2      =    -3.252236048693
E3      =    -4.780571143513
Exc     =    -4.143095645562
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 1.454e-05, dEband = 9.305e-04
rank = 0, Calculating/Estimating energy took 1.079 ms, Etot = -12.174970564, dEtot = 1.454e-05, dEband = 9.305e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0515081540341, which took 0.055 ms

iter_count = 108, r_2norm = 1.371e-06, tol*||rhs|| = 2.060e-06

Anderson update took 65.376 ms, out of which F'*F took 30.107 ms; b-Ax took 203.871 ms, out of which Lap took 181.698 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.287 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182847, int_b + int_rho = -1.037e-13, checking this took 0.107 ms
2-norm of RHS = 476.4462281255863, which took 0.133 ms

iter_count = 150, r_2norm = 4.719e-04, tol*||rhs|| = 4.764e-04

Anderson update took 90.924 ms, out of which F'*F took 43.312 ms; b-Ax took 288.302 ms, out of which Lap took 258.729 ms
Solving Poisson took 637.616 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.139 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.159501 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 137.203 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.148904 
Total time for convolution: 	 convolve: 5.142335 
Total time for convolution: 	 convolve: 5.153802 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.140 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 0.969 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.371 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.362 ms

This SCF took 26692.535 ms, scf error = 6.439e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.134898, lowerbound = -0.779145, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 830.939 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.252 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.405 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.682 ms
rank =  0, finding HY took 13.564 ms
rank =  0, distributing HY into block cyclic form took 8.294 ms
rank =  0, finding Y'*HY took 3.072 ms
Rank 0, Project_Hamiltonian used 43.643 ms
Total time for projection: 43.658 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.058 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.779049042237683
    last  calculated eigval = 0.035849831824309
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77904904223768
lambda[   2] =  -0.41184921655584
lambda[   3] =  -0.41184213858986
lambda[   4] =  -0.22536277276859
lambda[   5] =  -0.02958872299703
lambda[   6] =   0.01130444500468
lambda[   7] =   0.02809427359337
lambda[   8] =   0.02943994751172
lambda[   9] =   0.03584983182431
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 2.444 ms
rank =  0, Distributing orbital back into band + domain format took 8.311 ms
rank = 0, Subspace_Rotation used 10.772 ms

Total time for subspace rotation: 10.779 ms
rank = 0, Efermi =  -0.059223744044 calculate fermi energy took 0.082 ms
rank = 0, --- Calculate rho: sum over local bands took 2.451 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.209 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.204 ms
rank = 0, Calculating density took 891.560 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.832 ms
rank = 0, D2D took 1.055 ms
rank = 0, Transfering density took 1.059 ms
Etot    =   -12.174985754438
Eband   =    -3.656206340654
E1      =     8.523850329366
E2      =    -3.251767109174
E3      =    -4.780609977052
Exc     =    -4.143133663049
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 3.798e-06, dEband = 2.102e-04
rank = 0, Calculating/Estimating energy took 1.039 ms, Etot = -12.174985754, dEtot = 3.798e-06, dEband = 2.102e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0516012610467, which took 0.096 ms

iter_count = 108, r_2norm = 1.355e-06, tol*||rhs|| = 2.064e-06

Anderson update took 65.494 ms, out of which F'*F took 30.163 ms; b-Ax took 204.203 ms, out of which Lap took 182.205 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.338 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182848, int_b + int_rho = -9.277e-14, checking this took 0.132 ms
2-norm of RHS = 476.4464032874102, which took 0.165 ms

iter_count = 78, r_2norm = 4.222e-04, tol*||rhs|| = 4.764e-04

Anderson update took 47.179 ms, out of which F'*F took 22.129 ms; b-Ax took 148.969 ms, out of which Lap took 133.642 ms
Solving Poisson took 332.500 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.160006 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 138.986 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.145121 
Total time for convolution: 	 convolve: 5.151638 
Total time for convolution: 	 convolve: 5.149098 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.969 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.372 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.363 ms

This SCF took 26399.544 ms, scf error = 5.748e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.135850, lowerbound = -0.779049, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 829.476 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.399 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.359 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 21.782 ms
rank =  0, finding HY took 13.725 ms
rank =  0, distributing HY into block cyclic form took 8.164 ms
rank =  0, finding Y'*HY took 3.112 ms
Rank 0, Project_Hamiltonian used 46.815 ms
Total time for projection: 46.890 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -0.779030337172677
    last  calculated eigval = 0.035819600204746
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77903033717268
lambda[   2] =  -0.41183237343250
lambda[   3] =  -0.41182532155386
lambda[   4] =  -0.22534583834772
lambda[   5] =  -0.02956532108550
lambda[   6] =   0.01112952508503
lambda[   7] =   0.02809381450869
lambda[   8] =   0.02937560295318
lambda[   9] =   0.03581960020475
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 2.469 ms
rank =  0, Distributing orbital back into band + domain format took 8.283 ms
rank = 0, Subspace_Rotation used 10.768 ms

Total time for subspace rotation: 10.773 ms
rank = 0, Efermi =  -0.059200342134 calculate fermi energy took 0.086 ms
rank = 0, --- Calculate rho: sum over local bands took 2.414 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.298 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.223 ms
rank = 0, Calculating density took 893.401 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.828 ms
rank = 0, D2D took 1.038 ms
rank = 0, Transfering density took 1.042 ms
Etot    =   -12.174985511297
Eband   =    -3.656067741363
E1      =     8.523780306034
E2      =    -3.251692551088
E3      =    -4.780636649835
Exc     =    -4.143154110563
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 6.079e-08, dEband = 3.465e-05
rank = 0, Calculating/Estimating energy took 1.434 ms, Etot = -12.174985511, dEtot = 6.079e-08, dEband = 3.465e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0756185142367, which took 0.052 ms

iter_count = 102, r_2norm = 1.929e-06, tol*||rhs|| = 3.025e-06

Anderson update took 61.892 ms, out of which F'*F took 28.554 ms; b-Ax took 192.308 ms, out of which Lap took 171.562 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.390 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182845, int_b + int_rho = -1.282e-13, checking this took 0.143 ms
2-norm of RHS = 476.4445343433079, which took 0.155 ms

iter_count = 156, r_2norm = 4.747e-04, tol*||rhs|| = 4.764e-04

Anderson update took 94.686 ms, out of which F'*F took 45.028 ms; b-Ax took 300.076 ms, out of which Lap took 269.639 ms
Solving Poisson took 664.541 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.150618 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 169.985 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.163445 
Total time for convolution: 	 convolve: 5.152233 
Total time for convolution: 	 convolve: 5.139576 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.411 ms
---Transfer Veff_loc: D2D took 0.957 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.396 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.376 ms

This SCF took 26742.620 ms, scf error = 5.612e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135820, lowerbound = -0.779030, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 831.062 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 23.282 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.392 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 25.696 ms
rank =  0, finding HY took 13.584 ms
rank =  0, distributing HY into block cyclic form took 8.264 ms
rank =  0, finding Y'*HY took 3.018 ms
Rank 0, Project_Hamiltonian used 50.608 ms
Total time for projection: 50.643 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -0.778890625386592
    last  calculated eigval = 0.036615538891900
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77889062538659
lambda[   2] =  -0.41169283675499
lambda[   3] =  -0.41168535217861
lambda[   4] =  -0.22523692688206
lambda[   5] =  -0.03040589515784
lambda[   6] =   0.01181592512166
lambda[   7] =   0.02695942026611
lambda[   8] =   0.02842240543987
lambda[   9] =   0.03661553889190
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.166 ms
rank =  0, subspace rotation using ScaLAPACK took 2.461 ms
rank =  0, Distributing orbital back into band + domain format took 8.219 ms
rank = 0, Subspace_Rotation used 10.695 ms

Total time for subspace rotation: 10.702 ms
rank = 0, Efermi =  -0.060040916247 calculate fermi energy took 0.082 ms
rank = 0, --- Calculate rho: sum over local bands took 2.426 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.241 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.212 ms
rank = 0, Calculating density took 898.607 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.852 ms
rank = 0, D2D took 1.063 ms
rank = 0, Transfering density took 1.069 ms
Etot    =   -12.175020734919
Eband   =    -3.655011482764
E1      =     8.523268417524
E2      =    -3.251109447472
E3      =    -4.780647828720
Exc     =    -4.143161779543
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 8.806e-06, dEband = 2.641e-04
rank = 0, Calculating/Estimating energy took 1.755 ms, Etot = -12.175020735, dEtot = 8.806e-06, dEband = 2.641e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0935653576266, which took 0.109 ms

iter_count = 96, r_2norm = 3.058e-06, tol*||rhs|| = 3.743e-06

Anderson update took 58.256 ms, out of which F'*F took 27.031 ms; b-Ax took 181.912 ms, out of which Lap took 162.490 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 413.466 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182850, int_b + int_rho = -7.640e-14, checking this took 0.147 ms
2-norm of RHS = 476.4484361678599, which took 0.156 ms

iter_count = 156, r_2norm = 3.961e-04, tol*||rhs|| = 4.764e-04

Anderson update took 94.443 ms, out of which F'*F took 44.761 ms; b-Ax took 299.676 ms, out of which Lap took 269.276 ms
Solving Poisson took 663.904 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.143867 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 164.770 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.177139 
Total time for convolution: 	 convolve: 5.158427 
Total time for convolution: 	 convolve: 5.146726 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.467 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.947 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.378 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.347 ms

This SCF took 26734.222 ms, scf error = 5.583e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136616, lowerbound = -0.778891, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 831.816 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.067 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.321 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 21.415 ms
rank =  0, finding HY took 13.584 ms
rank =  0, distributing HY into block cyclic form took 8.353 ms
rank =  0, finding Y'*HY took 2.917 ms
Rank 0, Project_Hamiltonian used 46.299 ms
Total time for projection: 46.375 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -0.779177541572082
    last  calculated eigval = 0.038944403278108
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77917754157208
lambda[   2] =  -0.41194706855037
lambda[   3] =  -0.41193961752816
lambda[   4] =  -0.22550432847051
lambda[   5] =  -0.03058058347817
lambda[   6] =   0.01321147832179
lambda[   7] =   0.02705279309442
lambda[   8] =   0.02862428351528
lambda[   9] =   0.03894440327811
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 2.461 ms
rank =  0, Distributing orbital back into band + domain format took 8.164 ms
rank = 0, Subspace_Rotation used 10.643 ms

Total time for subspace rotation: 10.648 ms
rank = 0, Efermi =  -0.060215604682 calculate fermi energy took 0.085 ms
rank = 0, --- Calculate rho: sum over local bands took 2.351 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.449 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.211 ms
rank = 0, Calculating density took 895.166 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.823 ms
rank = 0, D2D took 1.042 ms
rank = 0, Transfering density took 1.789 ms
Etot    =   -12.175029819059
Eband   =    -3.657137112604
E1      =     8.524706615598
E2      =    -3.251924732087
E3      =    -4.780040637502
Exc     =    -4.142691525315
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 2.271e-06, dEband = 5.314e-04
rank = 0, Calculating/Estimating energy took 1.657 ms, Etot = -12.175029819, dEtot = 2.271e-06, dEband = 5.314e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0541337700553, which took 0.094 ms

iter_count = 102, r_2norm = 1.559e-06, tol*||rhs|| = 2.165e-06

Anderson update took 61.699 ms, out of which F'*F took 28.345 ms; b-Ax took 191.773 ms, out of which Lap took 171.142 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 437.423 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182847, int_b + int_rho = -1.028e-13, checking this took 0.138 ms
2-norm of RHS = 476.4417648564161, which took 0.160 ms

iter_count = 156, r_2norm = 4.230e-04, tol*||rhs|| = 4.764e-04

Anderson update took 94.185 ms, out of which F'*F took 44.874 ms; b-Ax took 299.005 ms, out of which Lap took 267.913 ms
Solving Poisson took 662.331 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.147802 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 203.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.154826 
Total time for convolution: 	 convolve: 5.162637 
Total time for convolution: 	 convolve: 5.247678 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.831 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.726 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.957 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.368 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.347 ms

This SCF took 26872.164 ms, scf error = 8.227e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.138944, lowerbound = -0.779178, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 829.938 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 30.690 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.424 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.035 ms
rank =  0, Distribute data + matrix mult took 33.167 ms
rank =  0, finding HY took 13.494 ms
rank =  0, distributing HY into block cyclic form took 8.450 ms
rank =  0, finding Y'*HY took 2.902 ms
Rank 0, Project_Hamiltonian used 58.043 ms
Total time for projection: 58.062 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.047 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.109 ms
    first calculated eigval = -0.778804367235055
    last  calculated eigval = 0.037791105924425
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77880436723505
lambda[   2] =  -0.41160896290524
lambda[   3] =  -0.41160147954359
lambda[   4] =  -0.22515992775183
lambda[   5] =  -0.03047135887376
lambda[   6] =   0.01230323503524
lambda[   7] =   0.02690861460106
lambda[   8] =   0.02822895627656
lambda[   9] =   0.03779110592442
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 2.470 ms
rank =  0, Distributing orbital back into band + domain format took 8.276 ms
rank = 0, Subspace_Rotation used 10.762 ms

Total time for subspace rotation: 10.767 ms
rank = 0, Efermi =  -0.060106380037 calculate fermi energy took 0.078 ms
rank = 0, --- Calculate rho: sum over local bands took 2.443 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.129 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.304 ms
rank = 0, Calculating density took 904.952 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 2.120 ms
rank = 0, D2D took 2.221 ms
rank = 0, Transfering density took 2.225 ms
Etot    =   -12.175028804068
Eband   =    -3.654349475232
E1      =     8.522808699194
E2      =    -3.250865446419
E3      =    -4.780788707296
Exc     =    -4.143269015418
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 2.537e-07, dEband = 6.969e-04
rank = 0, Calculating/Estimating energy took 1.024 ms, Etot = -12.175028804, dEtot = 2.537e-07, dEband = 6.969e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0474944593332, which took 0.059 ms

iter_count = 102, r_2norm = 1.486e-06, tol*||rhs|| = 1.900e-06

Anderson update took 70.165 ms, out of which F'*F took 28.676 ms; b-Ax took 195.974 ms, out of which Lap took 174.914 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 448.944 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182852, int_b + int_rho = -5.730e-14, checking this took 0.120 ms
2-norm of RHS = 476.4405897585793, which took 0.548 ms

iter_count = 114, r_2norm = 4.494e-04, tol*||rhs|| = 4.764e-04

Anderson update took 69.261 ms, out of which F'*F took 32.875 ms; b-Ax took 219.476 ms, out of which Lap took 197.082 ms
Solving Poisson took 487.007 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.162880 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 187.985 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.137787 
Total time for convolution: 	 convolve: 5.155088 
Total time for convolution: 	 convolve: 5.210540 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.772 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.216 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.960 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.387 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.370 ms

This SCF took 28422.977 ms, scf error = 4.369e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.137791, lowerbound = -0.778804, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 829.970 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.289 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.353 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 21.666 ms
rank =  0, finding HY took 13.612 ms
rank =  0, distributing HY into block cyclic form took 8.372 ms
rank =  0, finding Y'*HY took 2.925 ms
Rank 0, Project_Hamiltonian used 46.607 ms
Total time for projection: 46.634 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.778670734528468
    last  calculated eigval = 0.038002758349080
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77867073452847
lambda[   2] =  -0.41148485534948
lambda[   3] =  -0.41147746428017
lambda[   4] =  -0.22504702084445
lambda[   5] =  -0.03042254833618
lambda[   6] =   0.01254934004596
lambda[   7] =   0.02699965840114
lambda[   8] =   0.02818844334056
lambda[   9] =   0.03800275834908
==subpsace eigenproblem: bcast eigvals took 0.045 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 2.441 ms
rank =  0, Distributing orbital back into band + domain format took 8.214 ms
rank = 0, Subspace_Rotation used 10.675 ms

Total time for subspace rotation: 10.682 ms
rank = 0, Efermi =  -0.060057569537 calculate fermi energy took 0.130 ms
rank = 0, --- Calculate rho: sum over local bands took 2.463 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.136 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.197 ms
rank = 0, Calculating density took 893.465 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.119 ms
rank = 0, D2D took 1.218 ms
rank = 0, Transfering density took 1.226 ms
Etot    =   -12.175031465636
Eband   =    -3.653360150365
E1      =     8.522222655910
E2      =    -3.250412284084
E3      =    -4.780994951472
Exc     =    -4.143428040409
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 6.654e-07, dEband = 2.473e-04
rank = 0, Calculating/Estimating energy took 1.010 ms, Etot = -12.175031466, dEtot = 6.654e-07, dEband = 2.473e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0393890471244, which took 0.109 ms

iter_count = 102, r_2norm = 1.392e-06, tol*||rhs|| = 1.576e-06

Anderson update took 62.580 ms, out of which F'*F took 28.685 ms; b-Ax took 193.019 ms, out of which Lap took 172.297 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 440.617 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182850, int_b + int_rho = -7.094e-14, checking this took 0.125 ms
2-norm of RHS = 476.4394251991409, which took 0.178 ms

iter_count = 120, r_2norm = 4.322e-04, tol*||rhs|| = 4.764e-04

Anderson update took 73.121 ms, out of which F'*F took 34.715 ms; b-Ax took 229.708 ms, out of which Lap took 206.339 ms
Solving Poisson took 510.207 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.143045 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 221.163 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.192072 
Total time for convolution: 	 convolve: 5.179449 
Total time for convolution: 	 convolve: 5.153327 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 1.363 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.150 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.946 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.372 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.342 ms

This SCF took 26702.142 ms, scf error = 3.735e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.138003, lowerbound = -0.778671, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 831.583 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 22.495 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.369 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 24.896 ms
rank =  0, finding HY took 13.512 ms
rank =  0, distributing HY into block cyclic form took 8.146 ms
rank =  0, finding Y'*HY took 3.131 ms
Rank 0, Project_Hamiltonian used 49.725 ms
Total time for projection: 49.755 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.778516775236821
    last  calculated eigval = 0.038265797748728
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77851677523682
lambda[   2] =  -0.41134233463287
lambda[   3] =  -0.41133498198392
lambda[   4] =  -0.22490515256225
lambda[   5] =  -0.03020989177360
lambda[   6] =   0.01270406360582
lambda[   7] =   0.02729651029066
lambda[   8] =   0.02836009584950
lambda[   9] =   0.03826579774873
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 0.191 ms
rank =  0, subspace rotation using ScaLAPACK took 2.458 ms
rank =  0, Distributing orbital back into band + domain format took 8.228 ms
rank = 0, Subspace_Rotation used 10.703 ms

Total time for subspace rotation: 10.710 ms
rank = 0, Efermi =  -0.059844912825 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 2.424 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.175 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.819 ms
rank = 0, Calculating density took 899.238 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
rank = 0, D2D took 0.633 ms
rank = 0, Transfering density took 0.635 ms
Etot    =   -12.175032010005
Eband   =    -3.652198489189
E1      =     8.521530747394
E2      =    -3.249886291732
E3      =    -4.781234161415
Exc     =    -4.143611555030
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 1.361e-07, dEband = 2.904e-04
rank = 0, Calculating/Estimating energy took 0.991 ms, Etot = -12.175032010, dEtot = 1.361e-07, dEband = 2.904e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0384977259006, which took 0.078 ms

iter_count = 102, r_2norm = 1.159e-06, tol*||rhs|| = 1.540e-06

Anderson update took 61.786 ms, out of which F'*F took 28.892 ms; b-Ax took 197.182 ms, out of which Lap took 176.041 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.746 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182848, int_b + int_rho = -9.732e-14, checking this took 0.148 ms
2-norm of RHS = 476.4405243692776, which took 0.162 ms

iter_count = 144, r_2norm = 4.201e-04, tol*||rhs|| = 4.764e-04

Anderson update took 87.780 ms, out of which F'*F took 41.058 ms; b-Ax took 273.928 ms, out of which Lap took 246.116 ms
Solving Poisson took 609.040 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.159328 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 174.940 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.156920 
Total time for convolution: 	 convolve: 5.151257 
Total time for convolution: 	 convolve: 5.151709 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.674 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.951 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.396 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.369 ms

This SCF took 26748.329 ms, scf error = 2.826e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.138266, lowerbound = -0.778517, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 825.469 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.328 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.404 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 21.759 ms
rank =  0, finding HY took 13.610 ms
rank =  0, distributing HY into block cyclic form took 8.270 ms
rank =  0, finding Y'*HY took 2.958 ms
Rank 0, Project_Hamiltonian used 46.641 ms
Total time for projection: 46.661 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.778390216338744
    last  calculated eigval = 0.037406679119944
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77839021633874
lambda[   2] =  -0.41122493803209
lambda[   3] =  -0.41121753775754
lambda[   4] =  -0.22478724303011
lambda[   5] =  -0.03138729298570
lambda[   6] =   0.01300074580517
lambda[   7] =   0.02556808393055
lambda[   8] =   0.02663387967786
lambda[   9] =   0.03740667911994
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 2.342 ms
rank =  0, Distributing orbital back into band + domain format took 8.040 ms
rank = 0, Subspace_Rotation used 10.397 ms

Total time for subspace rotation: 10.404 ms
rank = 0, Efermi =  -0.061022314159 calculate fermi energy took 0.088 ms
rank = 0, --- Calculate rho: sum over local bands took 2.751 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.963 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.181 ms
rank = 0, Calculating density took 888.677 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.693 ms
rank = 0, D2D took 1.680 ms
rank = 0, Transfering density took 1.690 ms
Etot    =   -12.175038061990
Eband   =    -3.651239870688
E1      =     8.521006896304
E2      =    -3.249397695175
E3      =    -4.781394057298
Exc     =    -4.143723673750
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 1.513e-06, dEband = 2.397e-04
rank = 0, Calculating/Estimating energy took 1.014 ms, Etot = -12.175038062, dEtot = 1.513e-06, dEband = 2.397e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0345180317617, which took 0.065 ms

iter_count = 102, r_2norm = 1.092e-06, tol*||rhs|| = 1.381e-06

Anderson update took 61.797 ms, out of which F'*F took 28.721 ms; b-Ax took 193.112 ms, out of which Lap took 172.276 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 439.167 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182850, int_b + int_rho = -7.731e-14, checking this took 0.119 ms
2-norm of RHS = 476.4407708055555, which took 0.161 ms

iter_count = 108, r_2norm = 4.509e-04, tol*||rhs|| = 4.764e-04

Anderson update took 65.527 ms, out of which F'*F took 30.835 ms; b-Ax took 206.367 ms, out of which Lap took 185.202 ms
Solving Poisson took 460.587 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.156903 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 176.962 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.142504 
Total time for convolution: 	 convolve: 5.147762 
Total time for convolution: 	 convolve: 5.143495 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.971 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.385 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.378 ms

This SCF took 26527.642 ms, scf error = 2.056e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.137407, lowerbound = -0.778390, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 826.834 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 32.850 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.421 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 35.299 ms
rank =  0, finding HY took 13.682 ms
rank =  0, distributing HY into block cyclic form took 8.160 ms
rank =  0, finding Y'*HY took 3.038 ms
Rank 0, Project_Hamiltonian used 60.216 ms
Total time for projection: 60.245 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.778285158644225
    last  calculated eigval = 0.037769472094493
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77828515864423
lambda[   2] =  -0.41112770250368
lambda[   3] =  -0.41112032873828
lambda[   4] =  -0.22469565895931
lambda[   5] =  -0.03132816270166
lambda[   6] =   0.01327792204103
lambda[   7] =   0.02563268285095
lambda[   8] =   0.02661407279907
lambda[   9] =   0.03776947209449
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 2.466 ms
rank =  0, Distributing orbital back into band + domain format took 8.217 ms
rank = 0, Subspace_Rotation used 11.519 ms

Total time for subspace rotation: 11.528 ms
rank = 0, Efermi =  -0.060963183730 calculate fermi energy took 0.584 ms
rank = 0, --- Calculate rho: sum over local bands took 2.443 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.232 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.257 ms
rank = 0, Calculating density took 904.343 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.855 ms
rank = 0, D2D took 1.020 ms
rank = 0, Transfering density took 1.027 ms
Etot    =   -12.175040282694
Eband   =    -3.650457698062
E1      =     8.520544393635
E2      =    -3.249036784080
E3      =    -4.781554764951
Exc     =    -4.143845360971
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 5.552e-07, dEband = 1.955e-04
rank = 0, Calculating/Estimating energy took 1.015 ms, Etot = -12.175040283, dEtot = 5.552e-07, dEband = 1.955e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0144464932563, which took 0.056 ms

iter_count = 108, r_2norm = 4.196e-07, tol*||rhs|| = 5.779e-07

Anderson update took 65.307 ms, out of which F'*F took 30.389 ms; b-Ax took 204.112 ms, out of which Lap took 182.056 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 473.587 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182850, int_b + int_rho = -7.367e-14, checking this took 0.126 ms
2-norm of RHS = 476.4462150822488, which took 0.137 ms

iter_count = 150, r_2norm = 4.078e-04, tol*||rhs|| = 4.764e-04

Anderson update took 90.740 ms, out of which F'*F took 42.919 ms; b-Ax took 287.404 ms, out of which Lap took 258.535 ms
Solving Poisson took 636.334 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.151278 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 175.321 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.144399 
Total time for convolution: 	 convolve: 5.156643 
Total time for convolution: 	 convolve: 5.143918 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.357 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.951 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.376 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.350 ms

This SCF took 26748.843 ms, scf error = 1.489e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.137769, lowerbound = -0.778285, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 831.779 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.514 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.376 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 21.916 ms
rank =  0, finding HY took 13.555 ms
rank =  0, distributing HY into block cyclic form took 8.255 ms
rank =  0, finding Y'*HY took 3.004 ms
Rank 0, Project_Hamiltonian used 46.766 ms
Total time for projection: 46.786 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.049 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.113 ms
    first calculated eigval = -0.778213471788559
    last  calculated eigval = 0.041025260686676
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77821347178856
lambda[   2] =  -0.41105212441285
lambda[   3] =  -0.41104499131465
lambda[   4] =  -0.22464096313623
lambda[   5] =  -0.03022009802459
lambda[   6] =   0.01521719317569
lambda[   7] =   0.02738338585429
lambda[   8] =   0.02831142195419
lambda[   9] =   0.04102526068668
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.163 ms
rank =  0, subspace rotation using ScaLAPACK took 2.655 ms
rank =  0, Distributing orbital back into band + domain format took 7.857 ms
rank = 0, Subspace_Rotation used 10.531 ms

Total time for subspace rotation: 10.543 ms
rank = 0, Efermi =  -0.059855119085 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 2.383 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.346 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.231 ms
rank = 0, Calculating density took 896.319 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.528 ms
rank = 0, D2D took 0.645 ms
rank = 0, Transfering density took 0.650 ms
Etot    =   -12.175045792845
Eband   =    -3.649903101662
E1      =     8.520409474109
E2      =    -3.248620170253
E3      =    -4.781533359407
Exc     =    -4.143832528624
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 1.378e-06, dEband = 1.386e-04
rank = 0, Calculating/Estimating energy took 1.002 ms, Etot = -12.175045793, dEtot = 1.378e-06, dEband = 1.386e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0125737210638, which took 0.088 ms

iter_count = 108, r_2norm = 3.762e-07, tol*||rhs|| = 5.029e-07

Anderson update took 68.806 ms, out of which F'*F took 30.254 ms; b-Ax took 204.221 ms, out of which Lap took 182.306 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.057 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182850, int_b + int_rho = -7.367e-14, checking this took 0.134 ms
2-norm of RHS = 476.4453715894632, which took 0.181 ms

iter_count = 90, r_2norm = 4.272e-04, tol*||rhs|| = 4.764e-04

Anderson update took 54.845 ms, out of which F'*F took 25.870 ms; b-Ax took 171.792 ms, out of which Lap took 154.311 ms
Solving Poisson took 385.359 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.174838 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 130.235 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.144963 
Total time for convolution: 	 convolve: 5.149945 
Total time for convolution: 	 convolve: 5.148685 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.959 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.384 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.366 ms

This SCF took 26469.739 ms, scf error = 2.158e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.141025, lowerbound = -0.778213, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 827.818 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 31.649 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.453 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 34.126 ms
rank =  0, finding HY took 13.522 ms
rank =  0, distributing HY into block cyclic form took 8.322 ms
rank =  0, finding Y'*HY took 2.947 ms
Rank 0, Project_Hamiltonian used 58.947 ms
Total time for projection: 58.962 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.778137057590795
    last  calculated eigval = 0.040853506106407
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77813705759079
lambda[   2] =  -0.41098246983974
lambda[   3] =  -0.41097535303304
lambda[   4] =  -0.22457170314582
lambda[   5] =  -0.03016594375163
lambda[   6] =   0.01510695125417
lambda[   7] =   0.02742002264362
lambda[   8] =   0.02824570730265
lambda[   9] =   0.04085350610641
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 2.605 ms
rank =  0, Distributing orbital back into band + domain format took 7.833 ms
rank = 0, Subspace_Rotation used 10.458 ms

Total time for subspace rotation: 10.470 ms
rank = 0, Efermi =  -0.059800964936 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.315 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.157 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.297 ms
rank = 0, Calculating density took 904.265 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
rank = 0, D2D took 0.667 ms
rank = 0, Transfering density took 0.672 ms
Etot    =   -12.175045214042
Eband   =    -3.649333167576
E1      =     8.520042516834
E2      =    -3.248386077012
E3      =    -4.781672628665
Exc     =    -4.143940102650
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 1.447e-07, dEband = 1.425e-04
rank = 0, Calculating/Estimating energy took 0.987 ms, Etot = -12.175045214, dEtot = 1.447e-07, dEband = 1.425e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0169410851855, which took 0.084 ms

iter_count = 96, r_2norm = 5.469e-07, tol*||rhs|| = 6.776e-07

Anderson update took 58.331 ms, out of which F'*F took 27.329 ms; b-Ax took 194.071 ms, out of which Lap took 174.450 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 423.311 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182847, int_b + int_rho = -1.037e-13, checking this took 0.116 ms
2-norm of RHS = 476.4424288654880, which took 0.122 ms

iter_count = 138, r_2norm = 4.242e-04, tol*||rhs|| = 4.764e-04

Anderson update took 83.861 ms, out of which F'*F took 39.501 ms; b-Ax took 263.348 ms, out of which Lap took 236.619 ms
Solving Poisson took 585.297 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.165012 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 135.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.144241 
Total time for convolution: 	 convolve: 5.150454 
Total time for convolution: 	 convolve: 5.145503 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.949 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.383 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.354 ms

This SCF took 26659.080 ms, scf error = 1.503e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.140854, lowerbound = -0.778137, upperbound = 267.556664

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 835.197 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 21.029 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.384 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 23.435 ms
rank =  0, finding HY took 13.562 ms
rank =  0, distributing HY into block cyclic form took 8.377 ms
rank =  0, finding Y'*HY took 2.929 ms
Rank 0, Project_Hamiltonian used 48.349 ms
Total time for projection: 48.372 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.778018075836202
    last  calculated eigval = 0.039839423542275
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.77801807583620
lambda[   2] =  -0.41087335119018
lambda[   3] =  -0.41086623742711
lambda[   4] =  -0.22446809433876
lambda[   5] =  -0.03069705807252
lambda[   6] =   0.01515123436099
lambda[   7] =   0.02678573774175
lambda[   8] =   0.02752865452004
lambda[   9] =   0.03983942354228
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 2.797 ms
rank =  0, Distributing orbital back into band + domain format took 7.916 ms
rank = 0, Subspace_Rotation used 10.728 ms

Total time for subspace rotation: 10.739 ms
rank = 0, Efermi =  -0.060332079160 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 2.422 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.034 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.319 ms
rank = 0, Calculating density took 900.811 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.669 ms
rank = 0, D2D took 0.787 ms
rank = 0, Transfering density took 0.790 ms
Etot    =   -12.175046342461
Eband   =    -3.648451517948
E1      =     8.519438362767
E2      =    -3.248071217546
E3      =    -4.781856342019
Exc     =    -4.144087580519
Esc     =   -20.931873165967
Entropy =    -0.000000000361
dE = 2.821e-07, dEband = 2.204e-04
rank = 0, Calculating/Estimating energy took 0.997 ms, Etot = -12.175046342, dEtot = 2.821e-07, dEband = 2.204e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0147702229947, which took 0.136 ms

iter_count = 96, r_2norm = 4.839e-07, tol*||rhs|| = 5.908e-07

Anderson update took 58.261 ms, out of which F'*F took 26.957 ms; b-Ax took 181.211 ms, out of which Lap took 161.926 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 412.551 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001182858, int_rho =   8.00000001182849, int_b + int_rho = -8.458e-14, checking this took 0.141 ms
2-norm of RHS = 476.4424312318486, which took 0.129 ms

iter_count = 72, r_2norm = 4.467e-04, tol*||rhs|| = 4.764e-04

Anderson update took 43.805 ms, out of which F'*F took 20.590 ms; b-Ax took 136.771 ms, out of which Lap took 122.882 ms
Solving Poisson took 307.353 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.148 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.155393 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 161.867 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.164531 
Total time for convolution: 	 convolve: 5.150951 
Total time for convolution: 	 convolve: 5.138400 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.984 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.967 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.358 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.356 ms

This SCF took 26357.627 ms, scf error = 3.832e-05
The last 9 occupations of kpoints #1 are (Nelectron = 8):
lambda[   1] =  -0.77801807583620, occ[   1] =   2.00000000000000
lambda[   2] =  -0.41087335119018, occ[   2] =   2.00000000000000
lambda[   3] =  -0.41086623742711, occ[   3] =   2.00000000000000
lambda[   4] =  -0.22446809433876, occ[   4] =   2.00000000000000
lambda[   5] =  -0.03069705807252, occ[   5] =   0.00000001182849
lambda[   6] =   0.01515123436099, occ[   6] =   0.00000000000000
lambda[   7] =   0.02678573774175, occ[   7] =   0.00000000000000
lambda[   8] =   0.02752865452004, occ[   8] =   0.00000000000000
lambda[   9] =   0.03983942354228, occ[   9] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 8 (90%) = 0.000000000000000.
Occupation of state 9 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.035 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.159 ms, time for Allreduce/Reduce: 4.430 ms 
Time for calculating local force components: 9.994 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000002323406  -0.05936101191568   0.02337079511784
 -0.05142002935000   0.02970294241031   0.02340304757145
  0.05142001330440   0.02970290557176   0.02340304085151
 -0.00000011796920  -0.00039117278485  -0.73891402523618
force_loc = 
 -0.00000020615782   0.06366004905164  -0.02331169400162
  0.05521692443147  -0.03185589688745  -0.02340139877438
 -0.05521678768721  -0.03185589983913  -0.02340131207835
 -0.00000656605188   0.00039629057576   0.72004816427608
Time for calculating nonlocal force components: 20.417 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000027315267   0.00000481465320   0.01886108487247
[0mTime for calculating XC forces components: 11.221 ms
 Cartesian force = 
  0.00000157192596   0.00429828192707   0.00004467546651
  0.00379864993119  -0.00215370968603  -0.00001277685264
 -0.00379501953310  -0.00215374947626  -0.00001269687654
 -0.00000520232405   0.00000917723522  -0.00001920173733
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Time for printing density: 388.273 ms
The program took 651.762 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:31:33
Job ID:        2266733
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:13:48,vmem=8304K,walltime=00:11:09,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-23-2
---------------------------------------
