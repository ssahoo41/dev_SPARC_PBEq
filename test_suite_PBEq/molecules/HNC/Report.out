---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:53
Job ID:    2267018
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:57
Job ID:    2267018
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.063 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 14.747 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 3.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 7.350 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 57.007 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.015 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.104 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   12.052120	
   10.000000	   10.000000	    7.947880	
   10.000000	   10.000000	   10.169195	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.019 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.188 ms
Set up communicators.

--set up spincomm took 3.125 ms

--set up kptcomm took 0.348 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 11, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 11, ScaLAPACK topology Dims = (11, 1)
nproc = 12, size_blacscomm = 11 = dims[0] * dims[1] = (11, 1)
Nd_blacscomm 1000000, Nstates 11 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 1), actual size (1000000, 1)
rank = 0, mb = nb = 11, mbQ = nbQ = 64
rank = 0, nr_Hp = 11, nc_Hp = 11
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.235 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 11
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 11
# of bands per bandcomm          : 1
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.126 ms

Calculate_SplineDerivRadFun took 0.198 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.878 ms.
time spent on vectorized spline interp: 2.978 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.676 ms.
time spent on vectorized spline interp: 1.909 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.657 ms.
time spent on vectorized spline interp: 1.800 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.564 ms.

Calculating rb for all atom types took 16.479 ms
----------------------
Estimated memory usage
Total: 788.88 MB
orbitals             : 503.54 MB
global sized vectors : 213.62 MB
subspace matrices : 2.84 kB
others : 71.72 MB
----------------------------------------------
Estimated memory usage per processor: 65.74 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.883 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.020 ms
Calculating pseudocharge density ... 
the global sum of int_b = -10.0000000032229, sum_int_rho = 9.8935790303716
PosCharge = 10.000000003223, NegCharge = -9.893579030372, scal_fac = 1.010756569743
After scaling, int_rho = 10.0000000032230, PosCharge + NegCharge - NetCharge = -3.020e-14
--Calculate Vref took 0.255 ms
--Calculate rho_guess took 1.509 ms

 integral of b = -10.0000000032229,
 int{b} + Nelectron + NetCharge = -3.223e-09,
 Esc = -28.3734393489427,
 MPI_Reduce took 0.048 ms

Calculating b & b_ref took 6.416 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.076 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.084 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.026 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.219 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 21.952 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322299, int_b + int_rho = -1.692e-13, checking this took 0.092 ms
2-norm of RHS = 424.9980159213712, which took 0.100 ms

iter_count = 426, r_2norm = 3.318e-04, tol*||rhs|| = 4.250e-04

Anderson update took 257.028 ms, out of which F'*F took 122.554 ms; b-Ax took 844.123 ms, out of which Lap took 742.084 ms
Solving Poisson took 1851.574 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.380 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
Total time for convolution: 	 convolve: 5.117826 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 44.278 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.785 ms
Total time for convolution: 	 convolve: 5.170050 
Total time for convolution: 	 convolve: 5.108934 
Total time for convolution: 	 convolve: 5.098198 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.730 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.194 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.345 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
rank = 0, XC calculation took 24397.098 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 4.945 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.376 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 15.417 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.156 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.865 ms
    Lanczos iter 54, eigmin  = -1.000875776, eigmax = 264.925558877, err_eigmin = 3.376e-04, err_eigmax = 9.604e-03
rank =   0, Lanczos took 134.923 ms, eigmin = -1.000875776470, eigmax = 267.574814466259

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.236969, lowerbound = -1.100876, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 864.168 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.326 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.015 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.361 ms
rank =  0, finding HY took 15.879 ms
rank =  0, distributing HY into block cyclic form took 8.162 ms
rank =  0, finding Y'*HY took 2.704 ms
Rank 0, Project_Hamiltonian used 38.135 ms
Total time for projection: 38.151 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.284 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.123 ms
rank = 0, Solve_Generalized_EigenProblem used 0.433 ms
    first calculated eigval = 2.833822029552992
    last  calculated eigval = 3.187702276687205
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =   2.83382202955299
lambda[   2] =   2.87508014745963
lambda[   3] =   2.88837282889484
lambda[   4] =   2.95212740118573
lambda[   5] =   2.96990917803744
lambda[   6] =   2.99000963312967
lambda[   7] =   3.04589964283424
lambda[   8] =   3.06799230243553
lambda[   9] =   3.12158079642115
lambda[  10] =   3.12605530035500
lambda[  11] =   3.18770227668721
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.451 ms
rank =  0, subspace rotation using ScaLAPACK took 2.775 ms
rank =  0, Distributing orbital back into band + domain format took 9.140 ms
rank = 0, Subspace_Rotation used 11.932 ms

Total time for subspace rotation: 11.937 ms
rank = 0, Efermi =   2.979959407457 calculate fermi energy took 0.079 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.287702, lowerbound = -1.100876, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 863.456 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.204 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.904 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.129 ms
rank =  0, finding HY took 14.044 ms
rank =  0, distributing HY into block cyclic form took 8.198 ms
rank =  0, finding Y'*HY took 2.655 ms
Rank 0, Project_Hamiltonian used 35.075 ms
Total time for projection: 35.088 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.849967423948840
    last  calculated eigval = 0.427268075279415
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84996742394884
lambda[   2] =  -0.26221557012698
lambda[   3] =  -0.00504849775161
lambda[   4] =   0.26145369523406
lambda[   5] =   0.29886941956855
lambda[   6] =   0.32437611115863
lambda[   7] =   0.33977934141055
lambda[   8] =   0.36124135636068
lambda[   9] =   0.40148527070226
lambda[  10] =   0.41709123892918
lambda[  11] =   0.42726807527941
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.191 ms
rank =  0, subspace rotation using ScaLAPACK took 3.056 ms
rank =  0, Distributing orbital back into band + domain format took 8.141 ms
rank = 0, Subspace_Rotation used 11.212 ms

Total time for subspace rotation: 11.218 ms
rank = 0, Efermi =   0.311622761585 calculate fermi energy took 0.029 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.527268, lowerbound = -1.100876, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 858.651 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 8.216 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.836 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.071 ms
rank =  0, finding HY took 14.179 ms
rank =  0, distributing HY into block cyclic form took 8.104 ms
rank =  0, finding Y'*HY took 2.671 ms
Rank 0, Project_Hamiltonian used 35.053 ms
Total time for projection: 35.058 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.199 ms
    first calculated eigval = -1.004262867279711
    last  calculated eigval = 0.153859098964315
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -1.00426286727971
lambda[   2] =  -0.69525811951403
lambda[   3] =  -0.43008126581404
lambda[   4] =  -0.39728562696692
lambda[   5] =  -0.27693237824343
lambda[   6] =  -0.03545132477678
lambda[   7] =   0.04795198133218
lambda[   8] =   0.07378840016999
lambda[   9] =   0.08286603187253
lambda[  10] =   0.12124508108960
lambda[  11] =   0.15385909896432
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 2.875 ms
rank =  0, Distributing orbital back into band + domain format took 8.614 ms
rank = 0, Subspace_Rotation used 11.502 ms

Total time for subspace rotation: 11.507 ms
rank = 0, Efermi =  -0.066217443551 calculate fermi energy took 0.031 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.253859, lowerbound = -1.100876, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 860.766 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 8.198 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.970 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.187 ms
rank =  0, finding HY took 14.056 ms
rank =  0, distributing HY into block cyclic form took 8.019 ms
rank =  0, finding Y'*HY took 2.686 ms
Rank 0, Project_Hamiltonian used 34.972 ms
Total time for projection: 34.977 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -1.004386089110701
    last  calculated eigval = 0.090686310922083
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -1.00438608911070
lambda[   2] =  -0.70156839953356
lambda[   3] =  -0.43922345596625
lambda[   4] =  -0.43884607504978
lambda[   5] =  -0.36554382687666
lambda[   6] =  -0.09601718864879
lambda[   7] =  -0.07348136290618
lambda[   8] =   0.00958746282640
lambda[   9] =   0.04185844798507
lambda[  10] =   0.07486894484747
lambda[  11] =   0.09068631092208
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 3.127 ms
rank =  0, Distributing orbital back into band + domain format took 8.106 ms
rank = 0, Subspace_Rotation used 11.246 ms

Total time for subspace rotation: 11.252 ms
rank = 0, Efermi =  -0.126783307291 calculate fermi energy took 0.031 ms
rank = 0, --- Calculate rho: sum over local bands took 2.871 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.020 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.621 ms
rank = 0, Calculating density took 3790.185 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.926 ms
rank = 0, D2D took 2.031 ms
rank = 0, Transfering density took 2.038 ms
Etot    =   -16.981706355492
Eband   =    -5.899135693383
E1      =    11.969738001576
E2      =    -4.808728664993
E3      =    -5.712750714090
Exc     =    -5.200348693723
Esc     =   -28.373439348943
Entropy =    -0.000000000102
dE = 5.661e+00, dEband = 1.966e+00
rank = 0, Calculating/Estimating energy took 1.006 ms, Etot = -16.981706355, dEtot = 5.661e+00, dEband = 1.966e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 34.2466859226151, which took 0.084 ms

iter_count = 96, r_2norm = 1.011e-03, tol*||rhs|| = 1.370e-03

Anderson update took 58.749 ms, out of which F'*F took 27.213 ms; b-Ax took 182.571 ms, out of which Lap took 161.737 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 411.497 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322298, int_b + int_rho = -1.801e-13, checking this took 0.099 ms
2-norm of RHS = 422.1100223453407, which took 0.156 ms

iter_count = 288, r_2norm = 3.568e-04, tol*||rhs|| = 4.221e-04

Anderson update took 169.002 ms, out of which F'*F took 78.024 ms; b-Ax took 535.547 ms, out of which Lap took 473.755 ms
Solving Poisson took 1206.322 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.490 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.103384 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.079053 
Total time for convolution: 	 convolve: 5.077318 
Total time for convolution: 	 convolve: 5.079953 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.380 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.183 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.477 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.183 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.697 ms

This SCF took 29729.191 ms, scf error = 1.829e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.190686, lowerbound = -1.004386, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 856.753 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 11.517 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.937 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 13.480 ms
rank =  0, finding HY took 14.496 ms
rank =  0, distributing HY into block cyclic form took 8.139 ms
rank =  0, finding Y'*HY took 2.677 ms
Rank 0, Project_Hamiltonian used 38.821 ms
Total time for projection: 38.844 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.955717665456841
    last  calculated eigval = 0.067423163608440
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.95571766545684
lambda[   2] =  -0.66886515999669
lambda[   3] =  -0.40440091806787
lambda[   4] =  -0.40438952193709
lambda[   5] =  -0.34829728096683
lambda[   6] =  -0.08374226764922
lambda[   7] =  -0.07955573752261
lambda[   8] =  -0.01570852871764
lambda[   9] =   0.02317687019432
lambda[  10] =   0.05060925725211
lambda[  11] =   0.06742316360844
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 3.104 ms
rank =  0, Distributing orbital back into band + domain format took 8.158 ms
rank = 0, Subspace_Rotation used 11.274 ms

Total time for subspace rotation: 11.279 ms
rank = 0, Efermi =  -0.114513015347 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 2.878 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.296 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.556 ms
rank = 0, Calculating density took 923.935 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.869 ms
rank = 0, D2D took 1.966 ms
rank = 0, Transfering density took 1.968 ms
Etot    =   -16.952550302212
Eband   =    -5.563341093120
E1      =    11.685047691196
E2      =    -4.769830705669
E3      =    -5.795164154987
Exc     =    -5.265812411900
Esc     =   -28.373439348943
Entropy =    -0.000000000102
dE = 9.719e-03, dEband = 1.119e-01
rank = 0, Calculating/Estimating energy took 1.915 ms, Etot = -16.952550302, dEtot = 9.719e-03, dEband = 1.119e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 14.0909971845489, which took 0.084 ms

iter_count = 102, r_2norm = 5.251e-04, tol*||rhs|| = 5.636e-04

Anderson update took 60.566 ms, out of which F'*F took 27.249 ms; b-Ax took 187.046 ms, out of which Lap took 165.690 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 434.111 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322298, int_b + int_rho = -1.764e-13, checking this took 0.120 ms
2-norm of RHS = 419.8019596109050, which took 0.213 ms

iter_count = 300, r_2norm = 3.421e-04, tol*||rhs|| = 4.198e-04

Anderson update took 178.750 ms, out of which F'*F took 83.209 ms; b-Ax took 559.353 ms, out of which Lap took 498.460 ms
Solving Poisson took 1252.382 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.074149 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.223 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.096398 
Total time for convolution: 	 convolve: 5.133586 
Total time for convolution: 	 convolve: 5.077935 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.021 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.213 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.524 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.557 ms

This SCF took 27000.954 ms, scf error = 1.175e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.167423, lowerbound = -0.955718, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 862.149 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.524 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.452 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 17.992 ms
rank =  0, finding HY took 14.565 ms
rank =  0, distributing HY into block cyclic form took 8.083 ms
rank =  0, finding Y'*HY took 2.642 ms
Rank 0, Project_Hamiltonian used 43.315 ms
Total time for projection: 43.335 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.900773983852217
    last  calculated eigval = 0.051319707292735
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.90077398385222
lambda[   2] =  -0.63540124683054
lambda[   3] =  -0.36640224750423
lambda[   4] =  -0.36639075860125
lambda[   5] =  -0.31107004267493
lambda[   6] =  -0.05553125264694
lambda[   7] =  -0.05446032996321
lambda[   8] =  -0.02667377062436
lambda[   9] =   0.01503491447512
lambda[  10] =   0.03996935275007
lambda[  11] =   0.05131970729274
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 3.094 ms
rank =  0, Distributing orbital back into band + domain format took 8.076 ms
rank = 0, Subspace_Rotation used 11.185 ms

Total time for subspace rotation: 11.190 ms
rank = 0, Efermi =  -0.086506078098 calculate fermi energy took 0.068 ms
rank = 0, --- Calculate rho: sum over local bands took 2.897 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.009 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.640 ms
rank = 0, Calculating density took 932.554 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.951 ms
rank = 0, D2D took 3.056 ms
rank = 0, Transfering density took 3.059 ms
Etot    =   -16.931689794758
Eband   =    -5.160076559105
E1      =    11.353723308931
E2      =    -4.695979941851
E3      =    -5.904371062517
Exc     =    -5.352248199905
Esc     =   -28.373439348943
Entropy =    -0.000000000103
dE = 6.954e-03, dEband = 1.344e-01
rank = 0, Calculating/Estimating energy took 0.984 ms, Etot = -16.931689795, dEtot = 6.954e-03, dEband = 1.344e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.8996060459790, which took 0.133 ms

iter_count = 108, r_2norm = 1.250e-04, tol*||rhs|| = 1.960e-04

Anderson update took 64.288 ms, out of which F'*F took 29.287 ms; b-Ax took 198.197 ms, out of which Lap took 176.927 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.525 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322298, int_b + int_rho = -1.837e-13, checking this took 0.112 ms
2-norm of RHS = 419.8413144627295, which took 0.151 ms

iter_count = 282, r_2norm = 3.706e-04, tol*||rhs|| = 4.198e-04

Anderson update took 167.933 ms, out of which F'*F took 77.592 ms; b-Ax took 529.316 ms, out of which Lap took 470.426 ms
Solving Poisson took 1176.347 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.078650 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.078594 
Total time for convolution: 	 convolve: 5.076941 
Total time for convolution: 	 convolve: 5.076416 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.331 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.388 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.885 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.562 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.195 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.792 ms

This SCF took 26885.649 ms, scf error = 4.637e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.151320, lowerbound = -0.900774, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 866.046 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.193 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.909 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.123 ms
rank =  0, finding HY took 14.400 ms
rank =  0, distributing HY into block cyclic form took 8.189 ms
rank =  0, finding Y'*HY took 2.581 ms
Rank 0, Project_Hamiltonian used 35.320 ms
Total time for projection: 35.340 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.881096938476170
    last  calculated eigval = 0.039268689588022
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.88109693847617
lambda[   2] =  -0.62283624876785
lambda[   3] =  -0.35271892259929
lambda[   4] =  -0.35271037191247
lambda[   5] =  -0.29167362758602
lambda[   6] =  -0.04311997659186
lambda[   7] =  -0.04273745962507
lambda[   8] =  -0.03123925572306
lambda[   9] =   0.01142855768640
lambda[  10] =   0.03579431499161
lambda[  11] =   0.03926868958802
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 3.134 ms
rank =  0, Distributing orbital back into band + domain format took 8.145 ms
rank = 0, Subspace_Rotation used 11.293 ms

Total time for subspace rotation: 11.299 ms
rank = 0, Efermi =  -0.074303053019 calculate fermi energy took 0.068 ms
rank = 0, --- Calculate rho: sum over local bands took 2.889 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.763 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.852 ms
rank = 0, Calculating density took 929.510 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.014 ms
======D2D: initiated sending and receiving took 3.556 ms
rank = 0, D2D took 3.662 ms
rank = 0, Transfering density took 3.668 ms
Etot    =   -16.928358691865
Eband   =    -5.002072218822
E1      =    11.239935650576
E2      =    -4.644564567871
E3      =    -5.950474918220
Exc     =    -5.387822260664
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 1.110e-03, dEband = 5.267e-02
rank = 0, Calculating/Estimating energy took 1.153 ms, Etot = -16.928358692, dEtot = 1.110e-03, dEband = 5.267e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9353182639763, which took 0.061 ms

iter_count = 114, r_2norm = 3.084e-05, tol*||rhs|| = 3.741e-05

Anderson update took 68.036 ms, out of which F'*F took 31.248 ms; b-Ax took 213.935 ms, out of which Lap took 191.159 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.443 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322298, int_b + int_rho = -1.837e-13, checking this took 0.130 ms
2-norm of RHS = 421.0030220553193, which took 0.189 ms

iter_count = 276, r_2norm = 3.770e-04, tol*||rhs|| = 4.210e-04

Anderson update took 165.204 ms, out of which F'*F took 76.428 ms; b-Ax took 521.267 ms, out of which Lap took 461.972 ms
Solving Poisson took 1160.090 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.080562 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.076944 
Total time for convolution: 	 convolve: 5.082636 
Total time for convolution: 	 convolve: 5.196918 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.393 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.275 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.565 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.106 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.708 ms

This SCF took 27030.711 ms, scf error = 2.062e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.139269, lowerbound = -0.881097, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 866.122 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.210 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.973 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.205 ms
rank =  0, finding HY took 14.414 ms
rank =  0, distributing HY into block cyclic form took 8.179 ms
rank =  0, finding Y'*HY took 2.684 ms
Rank 0, Project_Hamiltonian used 35.525 ms
Total time for projection: 35.539 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.877640518649134
    last  calculated eigval = 0.032850286408879
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.87764051864913
lambda[   2] =  -0.61921868688876
lambda[   3] =  -0.34974999236468
lambda[   4] =  -0.34974500879971
lambda[   5] =  -0.28516258742331
lambda[   6] =  -0.03936125852983
lambda[   7] =  -0.03922188252246
lambda[   8] =  -0.03412913868032
lambda[   9] =   0.00907058787927
lambda[  10] =   0.03055893193495
lambda[  11] =   0.03285028640888
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.194 ms
rank =  0, subspace rotation using ScaLAPACK took 3.113 ms
rank =  0, Distributing orbital back into band + domain format took 8.156 ms
rank = 0, Subspace_Rotation used 11.280 ms

Total time for subspace rotation: 11.287 ms
rank = 0, Efermi =  -0.070648206278 calculate fermi energy took 1.028 ms
rank = 0, --- Calculate rho: sum over local bands took 3.042 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.561 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.551 ms
rank = 0, Calculating density took 930.627 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.912 ms
rank = 0, D2D took 2.011 ms
rank = 0, Transfering density took 2.020 ms
Etot    =   -16.927264237168
Eband   =    -4.963033588378
E1      =    11.239514165212
E2      =    -4.602588663538
E3      =    -5.961824181851
Exc     =    -5.394718310344
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 3.648e-04, dEband = 1.301e-02
rank = 0, Calculating/Estimating energy took 1.013 ms, Etot = -16.927264237, dEtot = 3.648e-04, dEband = 1.301e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5037678603483, which took 0.070 ms

iter_count = 114, r_2norm = 1.508e-05, tol*||rhs|| = 2.015e-05

Anderson update took 67.800 ms, out of which F'*F took 31.797 ms; b-Ax took 216.799 ms, out of which Lap took 191.778 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.730 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322293, int_b + int_rho = -2.292e-13, checking this took 0.120 ms
2-norm of RHS = 421.0989630418331, which took 0.186 ms

iter_count = 240, r_2norm = 3.610e-04, tol*||rhs|| = 4.211e-04

Anderson update took 142.075 ms, out of which F'*F took 66.892 ms; b-Ax took 462.465 ms, out of which Lap took 409.089 ms
Solving Poisson took 1032.285 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.425 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.077930 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 45.154 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.086579 
Total time for convolution: 	 convolve: 5.113967 
Total time for convolution: 	 convolve: 5.107689 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.763 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.566 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.653 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.252 ms

This SCF took 27118.919 ms, scf error = 6.586e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.132850, lowerbound = -0.877641, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 866.623 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.214 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.908 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.142 ms
rank =  0, finding HY took 14.555 ms
rank =  0, distributing HY into block cyclic form took 8.258 ms
rank =  0, finding Y'*HY took 2.626 ms
Rank 0, Project_Hamiltonian used 35.623 ms
Total time for projection: 35.638 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.877086412890890
    last  calculated eigval = 0.030230933272532
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.87708641289089
lambda[   2] =  -0.61869512224815
lambda[   3] =  -0.34892609481733
lambda[   4] =  -0.34892252854677
lambda[   5] =  -0.28451824513223
lambda[   6] =  -0.03874918272377
lambda[   7] =  -0.03868494006426
lambda[   8] =  -0.03537849493144
lambda[   9] =   0.00719981079207
lambda[  10] =   0.02599235402367
lambda[  11] =   0.03023093327253
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 3.128 ms
rank =  0, Distributing orbital back into band + domain format took 8.132 ms
rank = 0, Subspace_Rotation used 12.188 ms

Total time for subspace rotation: 12.196 ms
rank = 0, Efermi =  -0.070077326670 calculate fermi energy took 0.668 ms
rank = 0, --- Calculate rho: sum over local bands took 2.935 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.936 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.525 ms
rank = 0, Calculating density took 931.820 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.894 ms
rank = 0, D2D took 1.995 ms
rank = 0, Transfering density took 2.004 ms
Etot    =   -16.927191959558
Eband   =    -4.956296807395
E1      =    11.239681872061
E2      =    -4.595209201339
E3      =    -5.962685554946
Exc     =    -5.395032431464
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 2.409e-05, dEband = 2.246e-03
rank = 0, Calculating/Estimating energy took 1.010 ms, Etot = -16.927191960, dEtot = 2.409e-05, dEband = 2.246e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2469870733638, which took 1.025 ms

iter_count = 114, r_2norm = 7.913e-06, tol*||rhs|| = 9.879e-06

Anderson update took 67.080 ms, out of which F'*F took 31.620 ms; b-Ax took 217.110 ms, out of which Lap took 191.839 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.071 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322298, int_b + int_rho = -1.764e-13, checking this took 0.137 ms
2-norm of RHS = 421.1779371893577, which took 0.160 ms

iter_count = 264, r_2norm = 3.599e-04, tol*||rhs|| = 4.212e-04

Anderson update took 155.649 ms, out of which F'*F took 73.930 ms; b-Ax took 498.586 ms, out of which Lap took 443.897 ms
Solving Poisson took 1101.063 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.645 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.074877 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.082821 
Total time for convolution: 	 convolve: 5.074466 
Total time for convolution: 	 convolve: 5.076752 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.575 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.014 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.492 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.636 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.161 ms

This SCF took 26844.801 ms, scf error = 4.441e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.130231, lowerbound = -0.877086, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 868.150 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.285 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.849 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.153 ms
rank =  0, finding HY took 14.572 ms
rank =  0, distributing HY into block cyclic form took 8.163 ms
rank =  0, finding Y'*HY took 2.556 ms
Rank 0, Project_Hamiltonian used 35.476 ms
Total time for projection: 35.490 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.874603276969853
    last  calculated eigval = 0.028846399116451
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.87460327696985
lambda[   2] =  -0.61757271270936
lambda[   3] =  -0.34623699858107
lambda[   4] =  -0.34623498517479
lambda[   5] =  -0.28009999541511
lambda[   6] =  -0.03664047404906
lambda[   7] =  -0.03575706157006
lambda[   8] =  -0.03571553018854
lambda[   9] =   0.00629449739789
lambda[  10] =   0.02463315539345
lambda[  11] =   0.02884639911645
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 3.350 ms
rank =  0, Distributing orbital back into band + domain format took 8.079 ms
rank = 0, Subspace_Rotation used 11.442 ms

Total time for subspace rotation: 11.450 ms
rank = 0, Efermi =  -0.067844393750 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 2.987 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.122 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.574 ms
rank = 0, Calculating density took 932.576 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.935 ms
rank = 0, D2D took 2.041 ms
rank = 0, Transfering density took 2.047 ms
Etot    =   -16.926906177457
Eband   =    -4.929495937817
E1      =    11.229199753127
E2      =    -4.577467594281
E3      =    -5.967552521446
Exc     =    -5.398190759447
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 9.526e-05, dEband = 8.934e-03
rank = 0, Calculating/Estimating energy took 1.014 ms, Etot = -16.926906177, dEtot = 9.526e-05, dEband = 8.934e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2693750004762, which took 0.059 ms

iter_count = 108, r_2norm = 1.057e-05, tol*||rhs|| = 1.078e-05

Anderson update took 62.949 ms, out of which F'*F took 29.386 ms; b-Ax took 203.457 ms, out of which Lap took 179.654 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.646 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322296, int_b + int_rho = -1.965e-13, checking this took 0.115 ms
2-norm of RHS = 421.0997934833867, which took 0.130 ms

iter_count = 228, r_2norm = 3.768e-04, tol*||rhs|| = 4.211e-04

Anderson update took 133.741 ms, out of which F'*F took 65.533 ms; b-Ax took 442.449 ms, out of which Lap took 394.982 ms
Solving Poisson took 965.403 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 6.203521 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.081596 
Total time for convolution: 	 convolve: 5.084305 
Total time for convolution: 	 convolve: 5.080039 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.728 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.080 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.410 ms
---Transfer Veff_loc: D2D took 3.514 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.650 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.197 ms

This SCF took 28011.224 ms, scf error = 2.403e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.128846, lowerbound = -0.874603, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 868.746 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.284 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.969 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.275 ms
rank =  0, finding HY took 14.457 ms
rank =  0, distributing HY into block cyclic form took 8.171 ms
rank =  0, finding Y'*HY took 2.609 ms
Rank 0, Project_Hamiltonian used 35.536 ms
Total time for projection: 35.549 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.872936288921928
    last  calculated eigval = 0.027227797701451
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.87293628892193
lambda[   2] =  -0.61659241996836
lambda[   3] =  -0.34480576534530
lambda[   4] =  -0.34480407703410
lambda[   5] =  -0.27839141867962
lambda[   6] =  -0.03630197822570
lambda[   7] =  -0.03463084208640
lambda[   8] =  -0.03461630468910
lambda[   9] =   0.00511069596475
lambda[  10] =   0.02351324693167
lambda[  11] =   0.02722779770145
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 2.939 ms
rank =  0, Distributing orbital back into band + domain format took 8.573 ms
rank = 0, Subspace_Rotation used 11.527 ms

Total time for subspace rotation: 11.532 ms
rank = 0, Efermi =  -0.067267449116 calculate fermi energy took 0.079 ms
rank = 0, --- Calculate rho: sum over local bands took 3.018 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.093 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.547 ms
rank = 0, Calculating density took 932.861 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.885 ms
rank = 0, D2D took 1.986 ms
rank = 0, Transfering density took 1.997 ms
Etot    =   -16.927014570721
Eband   =    -4.915059940015
E1      =    11.219291318025
E2      =    -4.572193317137
E3      =    -5.970494468594
Exc     =    -5.400494385417
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 3.613e-05, dEband = 4.812e-03
rank = 0, Calculating/Estimating energy took 1.052 ms, Etot = -16.927014571, dEtot = 3.613e-05, dEband = 4.812e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1485452235120, which took 0.140 ms

iter_count = 108, r_2norm = 5.682e-06, tol*||rhs|| = 5.942e-06

Anderson update took 63.785 ms, out of which F'*F took 30.254 ms; b-Ax took 204.027 ms, out of which Lap took 181.184 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.108 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322297, int_b + int_rho = -1.855e-13, checking this took 0.113 ms
2-norm of RHS = 421.1157013428256, which took 0.153 ms

iter_count = 234, r_2norm = 3.500e-04, tol*||rhs|| = 4.211e-04

Anderson update took 137.978 ms, out of which F'*F took 66.208 ms; b-Ax took 446.337 ms, out of which Lap took 397.899 ms
Solving Poisson took 980.646 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Total time for convolution: 	 convolve: 5.079555 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.078977 
Total time for convolution: 	 convolve: 5.085322 
Total time for convolution: 	 convolve: 5.079148 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.750 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.587 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.352 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.713 ms
---Transfer Veff_loc: D2D took 3.504 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.633 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.168 ms

This SCF took 26745.884 ms, scf error = 1.738e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.127228, lowerbound = -0.872936, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 868.751 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.268 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.866 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.153 ms
rank =  0, finding HY took 14.549 ms
rank =  0, distributing HY into block cyclic form took 8.258 ms
rank =  0, finding Y'*HY took 2.583 ms
Rank 0, Project_Hamiltonian used 35.570 ms
Total time for projection: 35.583 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -0.872385903829396
    last  calculated eigval = 0.027431274447622
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.87238590382940
lambda[   2] =  -0.61594541245818
lambda[   3] =  -0.34413300497151
lambda[   4] =  -0.34413243058849
lambda[   5] =  -0.27783459026541
lambda[   6] =  -0.03399857048357
lambda[   7] =  -0.03398824962751
lambda[   8] =  -0.03233672080118
lambda[   9] =   0.00598229570314
lambda[  10] =   0.02460059847590
lambda[  11] =   0.02743127444762
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 3.018 ms
rank =  0, Distributing orbital back into band + domain format took 8.644 ms
rank = 0, Subspace_Rotation used 11.677 ms

Total time for subspace rotation: 11.692 ms
rank = 0, Efermi =  -0.065400243818 calculate fermi energy took 0.082 ms
rank = 0, --- Calculate rho: sum over local bands took 3.039 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.141 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.586 ms
rank = 0, Calculating density took 933.177 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.935 ms
rank = 0, D2D took 2.034 ms
rank = 0, Transfering density took 2.037 ms
Etot    =   -16.927173120255
Eband   =    -4.908862684335
E1      =    11.217710328250
E2      =    -4.567536190009
E3      =    -5.970206216740
Exc     =    -5.400323821872
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 5.285e-05, dEband = 2.066e-03
rank = 0, Calculating/Estimating energy took 1.039 ms, Etot = -16.927173120, dEtot = 5.285e-05, dEband = 2.066e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1082144913394, which took 0.062 ms

iter_count = 108, r_2norm = 3.575e-06, tol*||rhs|| = 4.329e-06

Anderson update took 63.186 ms, out of which F'*F took 30.637 ms; b-Ax took 206.261 ms, out of which Lap took 183.523 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.428 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322292, int_b + int_rho = -2.383e-13, checking this took 0.118 ms
2-norm of RHS = 421.1356484941523, which took 0.192 ms

iter_count = 216, r_2norm = 3.905e-04, tol*||rhs|| = 4.211e-04

Anderson update took 127.362 ms, out of which F'*F took 60.339 ms; b-Ax took 406.482 ms, out of which Lap took 362.049 ms
Solving Poisson took 901.890 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.079035 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.078366 
Total time for convolution: 	 convolve: 5.084097 
Total time for convolution: 	 convolve: 5.083510 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.728 ms
---Transfer Veff_loc: D2D took 3.499 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.681 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.215 ms

This SCF took 26638.586 ms, scf error = 1.112e-03
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.127431, lowerbound = -0.872386, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 867.853 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.284 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.935 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.240 ms
rank =  0, finding HY took 14.830 ms
rank =  0, distributing HY into block cyclic form took 8.261 ms
rank =  0, finding Y'*HY took 2.608 ms
Rank 0, Project_Hamiltonian used 35.973 ms
Total time for projection: 35.987 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.650 ms
rank = 0, Solve_Generalized_EigenProblem used 1.193 ms
    first calculated eigval = -0.871034418111870
    last  calculated eigval = 0.028158418794860
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.87103441811187
lambda[   2] =  -0.61468081098041
lambda[   3] =  -0.34287824635259
lambda[   4] =  -0.34287780381567
lambda[   5] =  -0.27661023848791
lambda[   6] =  -0.03278355703700
lambda[   7] =  -0.03277748237012
lambda[   8] =  -0.02886911231867
lambda[   9] =   0.00663141368672
lambda[  10] =   0.02618577680336
lambda[  11] =   0.02815841879486
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 1.217 ms
rank =  0, subspace rotation using ScaLAPACK took 3.118 ms
rank =  0, Distributing orbital back into band + domain format took 8.139 ms
rank = 0, Subspace_Rotation used 11.271 ms

Total time for subspace rotation: 11.278 ms
rank = 0, Efermi =  -0.064136803178 calculate fermi energy took 0.138 ms
rank = 0, --- Calculate rho: sum over local bands took 3.060 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.094 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 933.284 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.915 ms
rank = 0, D2D took 2.025 ms
rank = 0, Transfering density took 2.028 ms
Etot    =   -16.927246364542
Eband   =    -4.896163035603
E1      =    11.210837001448
E2      =    -4.561194756058
E3      =    -5.972269992214
Exc     =    -5.401945729614
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 2.441e-05, dEband = 4.233e-03
rank = 0, Calculating/Estimating energy took 1.020 ms, Etot = -16.927246365, dEtot = 2.441e-05, dEband = 4.233e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0838924533000, which took 0.058 ms

iter_count = 108, r_2norm = 2.835e-06, tol*||rhs|| = 3.356e-06

Anderson update took 63.975 ms, out of which F'*F took 30.043 ms; b-Ax took 204.710 ms, out of which Lap took 182.633 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 464.824 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322298, int_b + int_rho = -1.801e-13, checking this took 0.103 ms
2-norm of RHS = 421.1353540078567, which took 0.184 ms

iter_count = 198, r_2norm = 3.468e-04, tol*||rhs|| = 4.211e-04

Anderson update took 117.146 ms, out of which F'*F took 56.592 ms; b-Ax took 375.875 ms, out of which Lap took 335.954 ms
Solving Poisson took 834.688 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.079188 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.080170 
Total time for convolution: 	 convolve: 5.079621 
Total time for convolution: 	 convolve: 5.082342 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.862 ms
---Transfer Veff_loc: D2D took 3.458 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.626 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.115 ms

This SCF took 26600.173 ms, scf error = 6.907e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.128158, lowerbound = -0.871034, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 877.130 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.249 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.900 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.170 ms
rank =  0, finding HY took 14.498 ms
rank =  0, distributing HY into block cyclic form took 8.140 ms
rank =  0, finding Y'*HY took 2.575 ms
Rank 0, Project_Hamiltonian used 35.918 ms
Total time for projection: 35.937 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.653 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.761 ms
    first calculated eigval = -0.870294720146289
    last  calculated eigval = 0.029465520035732
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.87029472014629
lambda[   2] =  -0.61398104544560
lambda[   3] =  -0.34218030909977
lambda[   4] =  -0.34218016071602
lambda[   5] =  -0.27605996085763
lambda[   6] =  -0.03217783094694
lambda[   7] =  -0.03217245286184
lambda[   8] =  -0.02530822572192
lambda[   9] =   0.00727180730150
lambda[  10] =   0.02810633360543
lambda[  11] =   0.02946552003573
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.785 ms
rank =  0, subspace rotation using ScaLAPACK took 3.115 ms
rank =  0, Distributing orbital back into band + domain format took 8.139 ms
rank = 0, Subspace_Rotation used 11.265 ms

Total time for subspace rotation: 11.272 ms
rank = 0, Efermi =  -0.063528465501 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 2.969 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.101 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.549 ms
rank = 0, Calculating density took 941.897 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.905 ms
rank = 0, D2D took 2.015 ms
rank = 0, Transfering density took 2.022 ms
Etot    =   -16.927285518483
Eband   =    -4.889392392634
E1      =    11.207053358407
E2      =    -4.557978000506
E3      =    -5.973221541516
Exc     =    -5.402706677231
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 1.305e-05, dEband = 2.257e-03
rank = 0, Calculating/Estimating energy took 1.048 ms, Etot = -16.927285518, dEtot = 1.305e-05, dEband = 2.257e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0526832529413, which took 0.055 ms

iter_count = 108, r_2norm = 1.387e-06, tol*||rhs|| = 2.107e-06

Anderson update took 64.819 ms, out of which F'*F took 30.292 ms; b-Ax took 202.929 ms, out of which Lap took 181.716 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.684 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322298, int_b + int_rho = -1.837e-13, checking this took 0.103 ms
2-norm of RHS = 421.1644527982362, which took 0.167 ms

iter_count = 204, r_2norm = 3.445e-04, tol*||rhs|| = 4.212e-04

Anderson update took 120.837 ms, out of which F'*F took 57.380 ms; b-Ax took 388.572 ms, out of which Lap took 346.420 ms
Solving Poisson took 863.459 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.105722 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 1.284 ms
Total time for convolution: 	 convolve: 5.089899 
Total time for convolution: 	 convolve: 5.095911 
Total time for convolution: 	 convolve: 5.082752 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.012 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 3.453 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.670 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.156 ms

This SCF took 26665.938 ms, scf error = 4.686e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.129466, lowerbound = -0.870295, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 865.329 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.277 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.913 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.211 ms
rank =  0, finding HY took 14.508 ms
rank =  0, distributing HY into block cyclic form took 8.259 ms
rank =  0, finding Y'*HY took 2.568 ms
Rank 0, Project_Hamiltonian used 36.202 ms
Total time for projection: 36.219 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.870176064849238
    last  calculated eigval = 0.032703600200390
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.87017606484924
lambda[   2] =  -0.61385230321326
lambda[   3] =  -0.34200389888933
lambda[   4] =  -0.34200377172454
lambda[   5] =  -0.27578024214704
lambda[   6] =  -0.03206763988376
lambda[   7] =  -0.03206119886320
lambda[   8] =  -0.02176265345053
lambda[   9] =   0.00627068732939
lambda[  10] =   0.03160555423481
lambda[  11] =   0.03270360020039
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.211 ms
rank =  0, subspace rotation using ScaLAPACK took 3.137 ms
rank =  0, Distributing orbital back into band + domain format took 8.142 ms
rank = 0, Subspace_Rotation used 11.292 ms

Total time for subspace rotation: 11.298 ms
rank = 0, Efermi =  -0.063417694972 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 2.975 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.094 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.603 ms
rank = 0, Calculating density took 929.876 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.896 ms
rank = 0, D2D took 2.003 ms
rank = 0, Transfering density took 2.009 ms
Etot    =   -16.927368438386
Eband   =    -4.887632561750
E1      =    11.207427747018
E2      =    -4.555880483131
E3      =    -5.972682926535
Exc     =    -5.402287684274
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 2.764e-05, dEband = 5.866e-04
rank = 0, Calculating/Estimating energy took 1.047 ms, Etot = -16.927368438, dEtot = 2.764e-05, dEband = 5.866e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0567079073323, which took 0.081 ms

iter_count = 108, r_2norm = 1.506e-06, tol*||rhs|| = 2.268e-06

Anderson update took 63.989 ms, out of which F'*F took 30.804 ms; b-Ax took 206.388 ms, out of which Lap took 183.626 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 464.143 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322302, int_b + int_rho = -1.382e-13, checking this took 0.140 ms
2-norm of RHS = 421.1560383237777, which took 0.188 ms

iter_count = 138, r_2norm = 4.063e-04, tol*||rhs|| = 4.212e-04

Anderson update took 81.289 ms, out of which F'*F took 38.834 ms; b-Ax took 260.733 ms, out of which Lap took 232.697 ms
Solving Poisson took 582.090 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.087803 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.087947 
Total time for convolution: 	 convolve: 5.085953 
Total time for convolution: 	 convolve: 5.084049 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.572 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 3.499 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.631 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.163 ms

This SCF took 26338.019 ms, scf error = 6.232e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132704, lowerbound = -0.870176, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 867.848 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.480 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.549 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.051 ms
rank =  0, finding HY took 14.230 ms
rank =  0, distributing HY into block cyclic form took 8.094 ms
rank =  0, finding Y'*HY took 2.600 ms
Rank 0, Project_Hamiltonian used 36.425 ms
Total time for projection: 36.438 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -0.870029290105393
    last  calculated eigval = 0.032651294713435
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.87002929010539
lambda[   2] =  -0.61372512950432
lambda[   3] =  -0.34187462213103
lambda[   4] =  -0.34187443522245
lambda[   5] =  -0.27569216643119
lambda[   6] =  -0.03197108697134
lambda[   7] =  -0.03196774799134
lambda[   8] =  -0.02102145179515
lambda[   9] =   0.00627694176449
lambda[  10] =   0.03166680151908
lambda[  11] =   0.03265129471343
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 3.122 ms
rank =  0, Distributing orbital back into band + domain format took 8.151 ms
rank = 0, Subspace_Rotation used 11.284 ms

Total time for subspace rotation: 11.291 ms
rank = 0, Efermi =  -0.063322688548 calculate fermi energy took 0.069 ms
rank = 0, --- Calculate rho: sum over local bands took 2.959 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.081 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.553 ms
rank = 0, Calculating density took 932.491 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.889 ms
rank = 0, D2D took 1.987 ms
rank = 0, Transfering density took 1.990 ms
Etot    =   -16.927367506651
Eband   =    -4.886391286892
E1      =    11.206517509724
E2      =    -4.555507679412
E3      =    -5.972937497914
Exc     =    -5.402499557763
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 3.106e-07, dEband = 4.138e-04
rank = 0, Calculating/Estimating energy took 1.029 ms, Etot = -16.927367507, dEtot = 3.106e-07, dEband = 4.138e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0587623654490, which took 0.061 ms

iter_count = 108, r_2norm = 1.714e-06, tol*||rhs|| = 2.350e-06

Anderson update took 64.344 ms, out of which F'*F took 30.726 ms; b-Ax took 205.451 ms, out of which Lap took 183.842 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 465.569 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322299, int_b + int_rho = -1.655e-13, checking this took 0.125 ms
2-norm of RHS = 421.1476862546698, which took 0.146 ms

iter_count = 120, r_2norm = 3.705e-04, tol*||rhs|| = 4.211e-04

Anderson update took 70.736 ms, out of which F'*F took 33.812 ms; b-Ax took 228.039 ms, out of which Lap took 202.966 ms
Solving Poisson took 508.884 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.280 ms
Total time for convolution: 	 convolve: 5.088377 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.082334 
Total time for convolution: 	 convolve: 5.097527 
Total time for convolution: 	 convolve: 5.079907 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
---Transfer Veff_loc: D2D took 3.492 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.831 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.358 ms

This SCF took 26288.555 ms, scf error = 4.586e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.132651, lowerbound = -0.870029, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 868.185 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.272 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.891 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.182 ms
rank =  0, finding HY took 14.545 ms
rank =  0, distributing HY into block cyclic form took 8.195 ms
rank =  0, finding Y'*HY took 2.586 ms
Rank 0, Project_Hamiltonian used 35.542 ms
Total time for projection: 35.553 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.869913883044451
    last  calculated eigval = 0.032585905421916
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.86991388304445
lambda[   2] =  -0.61363465992945
lambda[   3] =  -0.34177545440218
lambda[   4] =  -0.34177526967425
lambda[   5] =  -0.27561521457729
lambda[   6] =  -0.03188831870426
lambda[   7] =  -0.03188690752078
lambda[   8] =  -0.02075818830935
lambda[   9] =   0.00642199580756
lambda[  10] =   0.03165518352162
lambda[  11] =   0.03258590542192
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 3.114 ms
rank =  0, Distributing orbital back into band + domain format took 8.180 ms
rank = 0, Subspace_Rotation used 11.308 ms

Total time for subspace rotation: 11.313 ms
rank = 0, Efermi =  -0.063240882590 calculate fermi energy took 0.073 ms
rank = 0, --- Calculate rho: sum over local bands took 3.028 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.002 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.543 ms
rank = 0, Calculating density took 932.429 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.884 ms
rank = 0, D2D took 1.982 ms
rank = 0, Transfering density took 1.984 ms
Etot    =   -16.927365215965
Eband   =    -4.885428963358
E1      =    11.205751905222
E2      =    -4.555275495721
E3      =    -5.973149987335
Exc     =    -5.402674291840
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 7.636e-07, dEband = 3.208e-04
rank = 0, Calculating/Estimating energy took 1.029 ms, Etot = -16.927365216, dEtot = 7.636e-07, dEband = 3.208e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0587059183839, which took 0.138 ms

iter_count = 108, r_2norm = 1.769e-06, tol*||rhs|| = 2.348e-06

Anderson update took 63.808 ms, out of which F'*F took 30.628 ms; b-Ax took 205.481 ms, out of which Lap took 182.903 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.234 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322297, int_b + int_rho = -1.946e-13, checking this took 0.121 ms
2-norm of RHS = 421.1463024787956, which took 0.149 ms

iter_count = 96, r_2norm = 3.876e-04, tol*||rhs|| = 4.211e-04

Anderson update took 56.688 ms, out of which F'*F took 27.190 ms; b-Ax took 183.077 ms, out of which Lap took 163.716 ms
Solving Poisson took 409.445 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.913 ms
Total time for convolution: 	 convolve: 5.081844 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.080414 
Total time for convolution: 	 convolve: 5.083401 
Total time for convolution: 	 convolve: 5.081659 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 3.437 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.896 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.868 ms

This SCF took 26138.578 ms, scf error = 3.715e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.132586, lowerbound = -0.869914, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 866.168 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.249 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.912 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.181 ms
rank =  0, finding HY took 14.434 ms
rank =  0, distributing HY into block cyclic form took 8.146 ms
rank =  0, finding Y'*HY took 2.593 ms
Rank 0, Project_Hamiltonian used 35.384 ms
Total time for projection: 35.397 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.869859887879046
    last  calculated eigval = 0.032662095354962
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.86985988787905
lambda[   2] =  -0.61359009696305
lambda[   3] =  -0.34172588219490
lambda[   4] =  -0.34172568679531
lambda[   5] =  -0.27556804808123
lambda[   6] =  -0.03184994945384
lambda[   7] =  -0.03184922449762
lambda[   8] =  -0.02060020908484
lambda[   9] =   0.00632381696858
lambda[  10] =   0.03177385728246
lambda[  11] =   0.03266209535496
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 3.106 ms
rank =  0, Distributing orbital back into band + domain format took 8.141 ms
rank = 0, Subspace_Rotation used 11.261 ms

Total time for subspace rotation: 11.267 ms
rank = 0, Efermi =  -0.063202856444 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 3.081 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.049 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.571 ms
rank = 0, Calculating density took 929.897 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.918 ms
rank = 0, D2D took 2.033 ms
rank = 0, Transfering density took 2.038 ms
Etot    =   -16.927368122426
Eband   =    -4.884939203930
E1      =    11.205452476487
E2      =    -4.555065516022
E3      =    -5.973229143533
Exc     =    -5.402736705491
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 9.688e-07, dEband = 1.633e-04
rank = 0, Calculating/Estimating energy took 1.020 ms, Etot = -16.927368122, dEtot = 9.688e-07, dEband = 1.633e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0533131589916, which took 0.081 ms

iter_count = 108, r_2norm = 1.399e-06, tol*||rhs|| = 2.133e-06

Anderson update took 63.408 ms, out of which F'*F took 30.670 ms; b-Ax took 206.038 ms, out of which Lap took 183.444 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.096 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322297, int_b + int_rho = -1.910e-13, checking this took 0.119 ms
2-norm of RHS = 421.1483255986688, which took 0.139 ms

iter_count = 168, r_2norm = 3.368e-04, tol*||rhs|| = 4.211e-04

Anderson update took 98.621 ms, out of which F'*F took 46.698 ms; b-Ax took 316.665 ms, out of which Lap took 281.823 ms
Solving Poisson took 707.184 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.086708 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.082373 
Total time for convolution: 	 convolve: 5.083362 
Total time for convolution: 	 convolve: 5.079493 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.162 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 4.278 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.857 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.176 ms

This SCF took 26429.348 ms, scf error = 3.501e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.132662, lowerbound = -0.869860, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 866.776 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.216 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.971 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.210 ms
rank =  0, finding HY took 14.408 ms
rank =  0, distributing HY into block cyclic form took 8.144 ms
rank =  0, finding Y'*HY took 2.586 ms
Rank 0, Project_Hamiltonian used 35.387 ms
Total time for projection: 35.400 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.869501657958210
    last  calculated eigval = 0.034377855144023
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.86950165795821
lambda[   2] =  -0.61327841458063
lambda[   3] =  -0.34137858298840
lambda[   4] =  -0.34137832180059
lambda[   5] =  -0.27521388657261
lambda[   6] =  -0.03161394507769
lambda[   7] =  -0.03161359054328
lambda[   8] =  -0.02010071802039
lambda[   9] =   0.00585398143531
lambda[  10] =   0.03329174743960
lambda[  11] =   0.03437785514402
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 3.115 ms
rank =  0, Distributing orbital back into band + domain format took 8.119 ms
rank = 0, Subspace_Rotation used 11.247 ms

Total time for subspace rotation: 11.253 ms
rank = 0, Efermi =  -0.062967037074 calculate fermi energy took 0.066 ms
rank = 0, --- Calculate rho: sum over local bands took 3.005 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.596 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.795 ms
rank = 0, Calculating density took 931.188 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.138 ms
rank = 0, D2D took 2.238 ms
rank = 0, Transfering density took 2.241 ms
Etot    =   -16.927406034267
Eband   =    -4.881501727903
E1      =    11.203755138720
E2      =    -4.553185279453
E3      =    -5.973634136113
Exc     =    -5.403039511603
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 1.264e-05, dEband = 1.146e-03
rank = 0, Calculating/Estimating energy took 1.017 ms, Etot = -16.927406034, dEtot = 1.264e-05, dEband = 1.146e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0522816313635, which took 0.059 ms

iter_count = 102, r_2norm = 2.079e-06, tol*||rhs|| = 2.091e-06

Anderson update took 60.599 ms, out of which F'*F took 28.569 ms; b-Ax took 193.945 ms, out of which Lap took 173.061 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 440.976 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322297, int_b + int_rho = -1.855e-13, checking this took 0.090 ms
2-norm of RHS = 421.1524811984264, which took 0.069 ms

iter_count = 162, r_2norm = 3.457e-04, tol*||rhs|| = 4.212e-04

Anderson update took 95.955 ms, out of which F'*F took 46.043 ms; b-Ax took 309.268 ms, out of which Lap took 276.415 ms
Solving Poisson took 686.610 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.091716 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.114063 
Total time for convolution: 	 convolve: 5.079743 
Total time for convolution: 	 convolve: 5.086301 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.828 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.568 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.010 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.426 ms
---Transfer Veff_loc: D2D took 4.688 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.818 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.539 ms

This SCF took 26437.296 ms, scf error = 2.754e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.134378, lowerbound = -0.869502, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 867.820 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.214 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.951 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.185 ms
rank =  0, finding HY took 14.431 ms
rank =  0, distributing HY into block cyclic form took 8.180 ms
rank =  0, finding Y'*HY took 2.607 ms
Rank 0, Project_Hamiltonian used 35.429 ms
Total time for projection: 35.442 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -0.869653335692139
    last  calculated eigval = 0.035321449011781
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.86965333569214
lambda[   2] =  -0.61337529434167
lambda[   3] =  -0.34148964352716
lambda[   4] =  -0.34148950350888
lambda[   5] =  -0.27530019675713
lambda[   6] =  -0.03173042499867
lambda[   7] =  -0.03172988407742
lambda[   8] =  -0.01946453376144
lambda[   9] =   0.00632235983270
lambda[  10] =   0.03405035341110
lambda[  11] =   0.03532144901178
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 3.114 ms
rank =  0, Distributing orbital back into band + domain format took 8.151 ms
rank = 0, Subspace_Rotation used 11.279 ms

Total time for subspace rotation: 11.285 ms
rank = 0, Efermi =  -0.063083423934 calculate fermi energy took 0.072 ms
rank = 0, --- Calculate rho: sum over local bands took 3.017 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.122 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.553 ms
rank = 0, Calculating density took 931.596 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.894 ms
rank = 0, D2D took 1.997 ms
rank = 0, Transfering density took 2.000 ms
Etot    =   -16.927417314246
Eband   =    -4.882615947756
E1      =    11.204735870370
E2      =    -4.553427809758
E3      =    -5.973148217170
Exc     =    -5.402673914743
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 3.760e-06, dEband = 3.714e-04
rank = 0, Calculating/Estimating energy took 1.029 ms, Etot = -16.927417314, dEtot = 3.760e-06, dEband = 3.714e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0489951091574, which took 0.073 ms

iter_count = 102, r_2norm = 1.860e-06, tol*||rhs|| = 1.960e-06

Anderson update took 60.750 ms, out of which F'*F took 29.110 ms; b-Ax took 193.263 ms, out of which Lap took 173.005 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 440.194 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322295, int_b + int_rho = -2.128e-13, checking this took 0.119 ms
2-norm of RHS = 421.1495261488455, which took 0.178 ms

iter_count = 156, r_2norm = 4.180e-04, tol*||rhs|| = 4.211e-04

Anderson update took 91.961 ms, out of which F'*F took 43.656 ms; b-Ax took 296.317 ms, out of which Lap took 263.952 ms
Solving Poisson took 658.653 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.081486 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.626 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.373 ms
Total time for convolution: 	 convolve: 5.164515 
Total time for convolution: 	 convolve: 5.092974 
Total time for convolution: 	 convolve: 5.085966 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.870 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.499 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.671 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.208 ms

This SCF took 28918.187 ms, scf error = 4.369e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.135321, lowerbound = -0.869653, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 863.697 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.200 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.979 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.200 ms
rank =  0, finding HY took 14.406 ms
rank =  0, distributing HY into block cyclic form took 8.068 ms
rank =  0, finding Y'*HY took 2.602 ms
Rank 0, Project_Hamiltonian used 35.302 ms
Total time for projection: 35.314 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.869447810866703
    last  calculated eigval = 0.033535943408387
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.86944781086670
lambda[   2] =  -0.61322193074031
lambda[   3] =  -0.34133155921248
lambda[   4] =  -0.34133135284787
lambda[   5] =  -0.27520652787526
lambda[   6] =  -0.03165713296739
lambda[   7] =  -0.03165679052488
lambda[   8] =  -0.02147475697099
lambda[   9] =   0.00509004762103
lambda[  10] =   0.03238803692345
lambda[  11] =   0.03353594340839
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 3.136 ms
rank =  0, Distributing orbital back into band + domain format took 8.454 ms
rank = 0, Subspace_Rotation used 11.604 ms

Total time for subspace rotation: 11.610 ms
rank = 0, Efermi =  -0.063010231377 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 3.033 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.078 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.566 ms
rank = 0, Calculating density took 927.651 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.926 ms
rank = 0, D2D took 2.042 ms
rank = 0, Transfering density took 2.044 ms
Etot    =   -16.927420022625
Eband   =    -4.881078363187
E1      =    11.203534446424
E2      =    -4.552950088107
E3      =    -5.973663379367
Exc     =    -5.403050224290
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 9.028e-07, dEband = 5.125e-04
rank = 0, Calculating/Estimating energy took 1.031 ms, Etot = -16.927420023, dEtot = 9.028e-07, dEband = 5.125e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0401165392945, which took 0.132 ms

iter_count = 108, r_2norm = 9.994e-07, tol*||rhs|| = 1.605e-06

Anderson update took 63.684 ms, out of which F'*F took 30.666 ms; b-Ax took 204.849 ms, out of which Lap took 182.278 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.285 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322300, int_b + int_rho = -1.637e-13, checking this took 0.125 ms
2-norm of RHS = 421.1490632206790, which took 0.170 ms

iter_count = 126, r_2norm = 3.989e-04, tol*||rhs|| = 4.211e-04

Anderson update took 74.089 ms, out of which F'*F took 35.214 ms; b-Ax took 238.800 ms, out of which Lap took 212.182 ms
Solving Poisson took 529.670 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.081561 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.358 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.106980 
Total time for convolution: 	 convolve: 5.243190 
Total time for convolution: 	 convolve: 5.123608 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.816 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.482 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.620 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.137 ms

This SCF took 26483.651 ms, scf error = 2.269e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.133536, lowerbound = -0.869448, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 870.117 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.211 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.940 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.171 ms
rank =  0, finding HY took 14.442 ms
rank =  0, distributing HY into block cyclic form took 8.138 ms
rank =  0, finding Y'*HY took 2.580 ms
Rank 0, Project_Hamiltonian used 35.363 ms
Total time for projection: 35.374 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.869464533391110
    last  calculated eigval = 0.033782386522638
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.86946453339111
lambda[   2] =  -0.61323058486824
lambda[   3] =  -0.34135198352198
lambda[   4] =  -0.34135187140671
lambda[   5] =  -0.27524610285740
lambda[   6] =  -0.03170299823371
lambda[   7] =  -0.03170269832732
lambda[   8] =  -0.02159225966630
lambda[   9] =   0.00498791735211
lambda[  10] =   0.03260479839371
lambda[  11] =   0.03378238652264
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 3.098 ms
rank =  0, Distributing orbital back into band + domain format took 8.111 ms
rank = 0, Subspace_Rotation used 11.221 ms

Total time for subspace rotation: 11.227 ms
rank = 0, Efermi =  -0.063056118000 calculate fermi energy took 0.078 ms
rank = 0, --- Calculate rho: sum over local bands took 3.084 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.015 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.545 ms
rank = 0, Calculating density took 933.701 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.902 ms
rank = 0, D2D took 1.999 ms
rank = 0, Transfering density took 2.002 ms
Etot    =   -16.927423690153
Eband   =    -4.881290152193
E1      =    11.203693189528
E2      =    -4.553024867286
E3      =    -5.973561002707
Exc     =    -5.402973248434
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 1.223e-06, dEband = 7.060e-05
rank = 0, Calculating/Estimating energy took 1.953 ms, Etot = -16.927423690, dEtot = 1.223e-06, dEband = 7.060e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0340157089787, which took 0.055 ms

iter_count = 108, r_2norm = 9.813e-07, tol*||rhs|| = 1.361e-06

Anderson update took 63.687 ms, out of which F'*F took 30.443 ms; b-Ax took 204.273 ms, out of which Lap took 183.057 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.017 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322297, int_b + int_rho = -1.910e-13, checking this took 0.108 ms
2-norm of RHS = 421.1465967357921, which took 0.178 ms

iter_count = 114, r_2norm = 3.887e-04, tol*||rhs|| = 4.211e-04

Anderson update took 67.058 ms, out of which F'*F took 31.737 ms; b-Ax took 216.897 ms, out of which Lap took 192.378 ms
Solving Poisson took 481.959 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.081011 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.083383 
Total time for convolution: 	 convolve: 5.087895 
Total time for convolution: 	 convolve: 5.085955 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.007 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.342 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.465 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.658 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.156 ms

This SCF took 26218.716 ms, scf error = 2.182e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.133782, lowerbound = -0.869465, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 866.149 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.210 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.975 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.206 ms
rank =  0, finding HY took 14.376 ms
rank =  0, distributing HY into block cyclic form took 8.135 ms
rank =  0, finding Y'*HY took 2.598 ms
Rank 0, Project_Hamiltonian used 35.343 ms
Total time for projection: 35.356 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.869347936008321
    last  calculated eigval = 0.033941026938748
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.86934793600832
lambda[   2] =  -0.61312654876476
lambda[   3] =  -0.34125096821911
lambda[   4] =  -0.34125087878311
lambda[   5] =  -0.27516834071318
lambda[   6] =  -0.03162796215114
lambda[   7] =  -0.03162773982758
lambda[   8] =  -0.02157655878906
lambda[   9] =   0.00510789178525
lambda[  10] =   0.03277987064845
lambda[  11] =   0.03394102693875
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 3.123 ms
rank =  0, Distributing orbital back into band + domain format took 8.099 ms
rank = 0, Subspace_Rotation used 11.236 ms

Total time for subspace rotation: 11.242 ms
rank = 0, Efermi =  -0.062981120807 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 2.982 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.148 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.545 ms
rank = 0, Calculating density took 929.743 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.892 ms
rank = 0, D2D took 1.989 ms
rank = 0, Transfering density took 1.992 ms
Etot    =   -16.927425293090
Eband   =    -4.880289345079
E1      =    11.203033740804
E2      =    -4.552636490601
E3      =    -5.973761284538
Exc     =    -5.403128114908
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 5.343e-07, dEband = 3.336e-04
rank = 0, Calculating/Estimating energy took 1.010 ms, Etot = -16.927425293, dEtot = 5.343e-07, dEband = 3.336e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0295023222762, which took 0.113 ms

iter_count = 102, r_2norm = 8.821e-07, tol*||rhs|| = 1.180e-06

Anderson update took 60.428 ms, out of which F'*F took 28.751 ms; b-Ax took 195.130 ms, out of which Lap took 174.570 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 440.165 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322297, int_b + int_rho = -1.946e-13, checking this took 0.121 ms
2-norm of RHS = 421.1481487976293, which took 0.270 ms

iter_count = 156, r_2norm = 3.762e-04, tol*||rhs|| = 4.211e-04

Anderson update took 91.175 ms, out of which F'*F took 43.736 ms; b-Ax took 297.716 ms, out of which Lap took 264.941 ms
Solving Poisson took 657.672 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.083006 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.080147 
Total time for convolution: 	 convolve: 5.092528 
Total time for convolution: 	 convolve: 5.081477 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.339 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.519 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.675 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.230 ms

This SCF took 26384.329 ms, scf error = 1.660e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.133941, lowerbound = -0.869348, upperbound = 267.574814

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 868.273 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.212 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.947 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.181 ms
rank =  0, finding HY took 14.502 ms
rank =  0, distributing HY into block cyclic form took 8.224 ms
rank =  0, finding Y'*HY took 2.541 ms
Rank 0, Project_Hamiltonian used 35.494 ms
Total time for projection: 35.510 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.869144156700102
    last  calculated eigval = 0.032861132620442
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.86914415670010
lambda[   2] =  -0.61290248332592
lambda[   3] =  -0.34107002643624
lambda[   4] =  -0.34106997784335
lambda[   5] =  -0.27503685850028
lambda[   6] =  -0.03150745138541
lambda[   7] =  -0.03150728640098
lambda[   8] =  -0.02275012013304
lambda[   9] =   0.00506525658501
lambda[  10] =   0.03162775569880
lambda[  11] =   0.03286113262044
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 3.232 ms
rank =  0, Distributing orbital back into band + domain format took 8.103 ms
rank = 0, Subspace_Rotation used 11.351 ms

Total time for subspace rotation: 11.357 ms
rank = 0, Efermi =  -0.062860641218 calculate fermi energy took 0.076 ms
rank = 0, --- Calculate rho: sum over local bands took 3.002 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.083 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 932.157 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 3.597 ms
rank = 0, D2D took 3.709 ms
rank = 0, Transfering density took 3.714 ms
Etot    =   -16.927433685464
Eband   =    -4.878447005713
E1      =    11.201945535478
E2      =    -4.551812650973
E3      =    -5.974046542790
Exc     =    -5.403352059946
Esc     =   -28.373439348943
Entropy =    -0.000000000104
dE = 2.797e-06, dEband = 6.141e-04
rank = 0, Calculating/Estimating energy took 1.000 ms, Etot = -16.927433685, dEtot = 2.797e-06, dEband = 6.141e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0205614332424, which took 0.112 ms

iter_count = 102, r_2norm = 5.839e-07, tol*||rhs|| = 8.225e-07

Anderson update took 59.837 ms, out of which F'*F took 29.317 ms; b-Ax took 194.790 ms, out of which Lap took 173.988 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.296 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000322316, int_rho =  10.00000000322297, int_b + int_rho = -1.874e-13, checking this took 0.104 ms
2-norm of RHS = 421.1528228214773, which took 0.097 ms

iter_count = 150, r_2norm = 3.938e-04, tol*||rhs|| = 4.212e-04

Anderson update took 87.890 ms, out of which F'*F took 41.566 ms; b-Ax took 282.704 ms, out of which Lap took 251.056 ms
Solving Poisson took 628.878 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.089350 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.081216 
Total time for convolution: 	 convolve: 5.083475 
Total time for convolution: 	 convolve: 5.080181 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.141 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
---Transfer Veff_loc: D2D took 3.483 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.706 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.226 ms

This SCF took 26373.521 ms, scf error = 8.952e-05
The last 11 occupations of kpoints #1 are (Nelectron = 10):
lambda[   1] =  -0.86914415670010, occ[   1] =   2.00000000000000
lambda[   2] =  -0.61290248332592, occ[   2] =   2.00000000000000
lambda[   3] =  -0.34107002643624, occ[   3] =   2.00000000000000
lambda[   4] =  -0.34106997784335, occ[   4] =   2.00000000000000
lambda[   5] =  -0.27503685850028, occ[   5] =   2.00000000000000
lambda[   6] =  -0.03150745138541, occ[   6] =   0.00000000161164
lambda[   7] =  -0.03150728640098, occ[   7] =   0.00000000161132
lambda[   8] =  -0.02275012013304, occ[   8] =   0.00000000000001
lambda[   9] =   0.00506525658501, occ[   9] =   0.00000000000000
lambda[  10] =   0.03162775569880, occ[  10] =   0.00000000000000
lambda[  11] =   0.03286113262044, occ[  11] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 10 (90%) = 0.000000000000000.
Occupation of state 11 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.380 ms, time for Allreduce/Reduce: 3.083 ms 
Time for calculating local force components: 10.597 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000001541449   0.00000001206686  -0.06900655610970
 -0.00000183120060  -0.00000094702456   0.63045008071102
 -0.00000009358690  -0.00000104238247  -0.01816087086711
force_loc = 
  0.00000029831527  -0.00000011993598   0.07433971147438
  0.00000136648085   0.00000002551643  -0.62470996919245
  0.00000089230089  -0.00000210320678   0.02355601508173
Time for calculating nonlocal force components: 23.953 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000008514425   0.00000004878005  -0.00383092737245
[0m[32m  0.00000011316989  -0.00000005560853  -0.01241499575694
[0mTime for calculating XC forces components: 11.459 ms
 Cartesian force = 
  0.00000003171704   0.00000128606254   0.00525899270852
 -0.00000066158822   0.00000052120358   0.00183502148996
  0.00000062987117  -0.00000180726612  -0.00709401419848
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.332 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.358 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.180 ms
Time for printing density: 381.890 ms
The program took 593.281 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:38:51
Job ID:        2267018
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:00:12,vmem=8252K,walltime=00:10:01,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-12-1
---------------------------------------
