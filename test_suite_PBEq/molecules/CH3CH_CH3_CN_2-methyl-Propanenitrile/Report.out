---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:12
Job ID:    2266767
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:17
Job ID:    2266767
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.061 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 19.052 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 12.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 17.106 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 105.350 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.957 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.094 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    7.489268	   10.634140	   10.000000	
    9.721683	   13.997437	   12.415225	
    9.788215	   11.100113	   14.096114	
   12.510732	   12.143633	   12.456230	
    9.721683	   13.997437	    7.584775	
    9.788215	   11.100113	    5.903886	
   12.510732	   12.143633	    7.543770	
   10.449961	    8.071932	   10.000000	
    9.554310	   10.711744	   10.000000	
   10.449961	   12.067677	   12.401343	
   10.449961	   12.067677	    7.598657	
   11.191782	    6.002563	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.006 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.186 ms
Set up communicators.

--set up spincomm took 2.338 ms

--set up kptcomm took 0.364 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 21, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 21 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 21, mbQ = nbQ = 64
rank = 0, nr_Hp = 21, nc_Hp = 21
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.033 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.413 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.700 ms

Calculate_SplineDerivRadFun took 0.195 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.816 ms.
time spent on vectorized spline interp: 3.221 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.611 ms.
time spent on vectorized spline interp: 1.566 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.471 ms.
time spent on vectorized spline interp: 1.571 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.516 ms.

Calculating rb for all atom types took 15.783 ms
----------------------
Estimated memory usage
Total: 1.26 GB
orbitals             : 961.30 MB
global sized vectors : 213.62 MB
subspace matrices : 10.34 kB
others : 117.49 MB
----------------------------------------------
Estimated memory usage per processor: 107.70 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.061 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -28.0000000391493, sum_int_rho = 27.2918791939820
PosCharge = 28.000000039149, NegCharge = -27.291879193982, scal_fac = 1.025946210597
After scaling, int_rho = 28.0000000391492, PosCharge + NegCharge - NetCharge = 7.105e-15
--Calculate Vref took 0.539 ms
--Calculate rho_guess took 2.964 ms

 integral of b = -28.0000000391493,
 int{b} + Nelectron + NetCharge = -3.915e-08,
 Esc = -68.1483736023595,
 MPI_Reduce took 11.344 ms

Calculating b & b_ref took 21.756 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.076 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.083 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.106 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.653 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.509 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914928, int_b + int_rho = -7.276e-14, checking this took 0.555 ms
2-norm of RHS = 814.8390936951895, which took 0.526 ms

iter_count = 420, r_2norm = 6.993e-04, tol*||rhs|| = 8.148e-04

Anderson update took 258.383 ms, out of which F'*F took 153.161 ms; b-Ax took 759.671 ms, out of which Lap took 706.790 ms
Solving Poisson took 1473.894 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.449 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
Total time for convolution: 	 convolve: 5.124924 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 93.298 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.787 ms
Total time for convolution: 	 convolve: 5.189392 
Total time for convolution: 	 convolve: 5.133110 
Total time for convolution: 	 convolve: 5.121389 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.158 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.163 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.531 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
rank = 0, XC calculation took 24543.604 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 5.147 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.476 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.746 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.155 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.488 ms
    Lanczos iter 54, eigmin  = -0.882403772, eigmax = 264.946889427, err_eigmin = 6.481e-04, err_eigmax = 9.649e-03
rank =   0, Lanczos took 103.027 ms, eigmin = -0.882403771920, eigmax = 267.596358321254

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.306977, lowerbound = -0.982404, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1375.313 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 18.240 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.753 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.011 ms
rank =  0, finding HY took 24.502 ms
rank =  0, distributing HY into block cyclic form took 18.132 ms
rank =  0, finding Y'*HY took 4.899 ms
Rank 0, Project_Hamiltonian used 68.595 ms
Total time for projection: 68.607 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.762 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.862 ms
    first calculated eigval = 2.731186836813893
    last  calculated eigval = 3.256395304622456
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =   2.82830057075812
lambda[   6] =   2.85879082704902
lambda[   7] =   2.89752257888699
lambda[   8] =   2.93433912142835
lambda[   9] =   2.96926332718158
lambda[  10] =   2.97368242825373
lambda[  11] =   2.99054279648928
lambda[  12] =   2.99674647700793
lambda[  13] =   3.02931696818409
lambda[  14] =   3.04004826265595
lambda[  15] =   3.09579172051749
lambda[  16] =   3.11812900246328
lambda[  17] =   3.12965457717380
lambda[  18] =   3.14568769652359
lambda[  19] =   3.18377547218195
lambda[  20] =   3.22040358827624
lambda[  21] =   3.25639530462246
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.878 ms
rank =  0, subspace rotation using ScaLAPACK took 7.638 ms
rank =  0, Distributing orbital back into band + domain format took 16.383 ms
rank = 0, Subspace_Rotation used 24.034 ms

Total time for subspace rotation: 24.038 ms
rank = 0, Efermi =   3.068142398731 calculate fermi energy took 0.048 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.356395, lowerbound = -0.982404, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1377.002 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 19.697 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.386 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.098 ms
rank =  0, finding HY took 24.360 ms
rank =  0, distributing HY into block cyclic form took 16.485 ms
rank =  0, finding Y'*HY took 3.873 ms
Rank 0, Project_Hamiltonian used 66.849 ms
Total time for projection: 66.853 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.740551017529050
    last  calculated eigval = 0.445871882945982
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.23567506170880
lambda[   6] =  -0.21251653079311
lambda[   7] =  -0.09657370726839
lambda[   8] =  -0.05723302653608
lambda[   9] =   0.02248183148459
lambda[  10] =   0.09979232966264
lambda[  11] =   0.10667524736641
lambda[  12] =   0.16109553432241
lambda[  13] =   0.19753552587850
lambda[  14] =   0.24694606011059
lambda[  15] =   0.29894207119080
lambda[  16] =   0.31381184528827
lambda[  17] =   0.32058220901185
lambda[  18] =   0.34349048427664
lambda[  19] =   0.38453899454297
lambda[  20] =   0.41823627158016
lambda[  21] =   0.44587188294598
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 7.524 ms
rank =  0, Distributing orbital back into band + domain format took 16.254 ms
rank = 0, Subspace_Rotation used 23.791 ms

Total time for subspace rotation: 23.795 ms
rank = 0, Efermi =   0.272978680817 calculate fermi energy took 0.024 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.545872, lowerbound = -0.982404, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1372.691 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 31.238 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.396 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 33.654 ms
rank =  0, finding HY took 24.066 ms
rank =  0, distributing HY into block cyclic form took 16.582 ms
rank =  0, finding Y'*HY took 3.877 ms
Rank 0, Project_Hamiltonian used 78.215 ms
Total time for projection: 78.219 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -0.912681104122793
    last  calculated eigval = 0.138175982415950
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55083858506398
lambda[   6] =  -0.52065863080048
lambda[   7] =  -0.49279422426038
lambda[   8] =  -0.46733535475977
lambda[   9] =  -0.44713245262742
lambda[  10] =  -0.43242742231520
lambda[  11] =  -0.40872885184205
lambda[  12] =  -0.34752292286208
lambda[  13] =  -0.32768284807672
lambda[  14] =  -0.30952772472752
lambda[  15] =   0.00204453943213
lambda[  16] =   0.02701935813047
lambda[  17] =   0.06446532752457
lambda[  18] =   0.07868553534405
lambda[  19] =   0.09653765751825
lambda[  20] =   0.12352709460051
lambda[  21] =   0.13817598241595
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 7.383 ms
rank =  0, Distributing orbital back into band + domain format took 16.240 ms
rank = 0, Subspace_Rotation used 23.636 ms

Total time for subspace rotation: 23.639 ms
rank = 0, Efermi =  -0.026511905179 calculate fermi energy took 0.019 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.238176, lowerbound = -0.982404, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1379.428 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 16.244 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.432 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.689 ms
rank =  0, finding HY took 24.401 ms
rank =  0, distributing HY into block cyclic form took 16.225 ms
rank =  0, finding Y'*HY took 3.844 ms
Rank 0, Project_Hamiltonian used 63.182 ms
Total time for projection: 63.185 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.912811026320082
    last  calculated eigval = 0.081561443837346
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55704090813605
lambda[   6] =  -0.53005814375824
lambda[   7] =  -0.49945756489216
lambda[   8] =  -0.47732474575808
lambda[   9] =  -0.45488910251233
lambda[  10] =  -0.44341808580494
lambda[  11] =  -0.42885832728517
lambda[  12] =  -0.38004128287895
lambda[  13] =  -0.34722807453331
lambda[  14] =  -0.34392354238175
lambda[  15] =  -0.04435403831805
lambda[  16] =  -0.03159473422339
lambda[  17] =   0.01634517714111
lambda[  18] =   0.03501011687350
lambda[  19] =   0.04925621054295
lambda[  20] =   0.06089869171842
lambda[  21] =   0.08156144383735
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 7.539 ms
rank =  0, Distributing orbital back into band + domain format took 16.289 ms
rank = 0, Subspace_Rotation used 23.861 ms

Total time for subspace rotation: 23.865 ms
rank = 0, Efermi =  -0.072910482927 calculate fermi energy took 0.022 ms
rank = 0, --- Calculate rho: sum over local bands took 4.185 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.130 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.628 ms
rank = 0, Calculating density took 6003.643 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.870 ms
rank = 0, D2D took 1.995 ms
rank = 0, Transfering density took 2.002 ms
Etot    =   -38.792681148739
Eband   =   -15.353241406967
E1      =    31.703172661494
E2      =   -11.392202564808
E3      =   -14.993180598166
Exc     =   -13.379621962727
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 3.233e+00, dEband = 1.279e+00
rank = 0, Calculating/Estimating energy took 0.862 ms, Etot = -38.792681149, dEtot = 3.233e+00, dEband = 1.279e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 51.3916960471576, which took 1.364 ms

iter_count = 96, r_2norm = 1.805e-03, tol*||rhs|| = 2.056e-03

Anderson update took 41.435 ms, out of which F'*F took 21.669 ms; b-Ax took 144.634 ms, out of which Lap took 131.030 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 286.225 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914927, int_b + int_rho = -8.367e-14, checking this took 0.087 ms
2-norm of RHS = 809.9517889068497, which took 0.086 ms

iter_count = 282, r_2norm = 8.077e-04, tol*||rhs|| = 8.100e-04

Anderson update took 121.458 ms, out of which F'*F took 64.430 ms; b-Ax took 428.890 ms, out of which Lap took 388.614 ms
Solving Poisson took 821.788 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.426 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Total time for convolution: 	 convolve: 5.334190 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.276267 
Total time for convolution: 	 convolve: 5.155234 
Total time for convolution: 	 convolve: 5.158269 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.214 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.739 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.292 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.068 ms

This SCF took 32099.202 ms, scf error = 2.051e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.181561, lowerbound = -0.912811, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1355.085 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 16.442 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.441 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.896 ms
rank =  0, finding HY took 24.370 ms
rank =  0, distributing HY into block cyclic form took 17.429 ms
rank =  0, finding Y'*HY took 3.834 ms
Rank 0, Project_Hamiltonian used 64.559 ms
Total time for projection: 64.569 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.226 ms
    first calculated eigval = -0.880252583728027
    last  calculated eigval = 0.059249053680496
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.53350128826502
lambda[   6] =  -0.49908508939007
lambda[   7] =  -0.46705325301530
lambda[   8] =  -0.44190054796574
lambda[   9] =  -0.42641038622504
lambda[  10] =  -0.40889695112659
lambda[  11] =  -0.40252116997857
lambda[  12] =  -0.35042450646283
lambda[  13] =  -0.32615391046919
lambda[  14] =  -0.32405136320003
lambda[  15] =  -0.03737590731632
lambda[  16] =  -0.03387680450332
lambda[  17] =  -0.00793757227448
lambda[  18] =   0.01265254854317
lambda[  19] =   0.02944735982704
lambda[  20] =   0.03251122733566
lambda[  21] =   0.05924905368050
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.240 ms
rank =  0, subspace rotation using ScaLAPACK took 7.451 ms
rank =  0, Distributing orbital back into band + domain format took 16.945 ms
rank = 0, Subspace_Rotation used 24.414 ms

Total time for subspace rotation: 24.420 ms
rank = 0, Efermi =  -0.065948384939 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.117 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.956 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.576 ms
rank = 0, Calculating density took 1459.379 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.856 ms
rank = 0, D2D took 1.992 ms
rank = 0, Transfering density took 1.998 ms
Etot    =   -38.706556835649
Eband   =   -14.531810808278
E1      =    30.960473780494
E2      =   -11.358082715823
E3      =   -15.219041356112
Exc     =   -13.563970276285
Esc     =   -68.148373602359
Entropy =    -0.000000001156
dE = 7.177e-03, dEband = 6.845e-02
rank = 0, Calculating/Estimating energy took 0.821 ms, Etot = -38.706556836, dEtot = 7.177e-03, dEband = 6.845e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 21.8161828782156, which took 0.085 ms

iter_count = 102, r_2norm = 6.968e-04, tol*||rhs|| = 8.726e-04

Anderson update took 46.104 ms, out of which F'*F took 23.643 ms; b-Ax took 154.630 ms, out of which Lap took 141.053 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 307.307 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914916, int_b + int_rho = -1.928e-13, checking this took 0.086 ms
2-norm of RHS = 803.4824736407983, which took 0.087 ms

iter_count = 300, r_2norm = 6.936e-04, tol*||rhs|| = 8.035e-04

Anderson update took 132.407 ms, out of which F'*F took 69.731 ms; b-Ax took 459.146 ms, out of which Lap took 417.840 ms
Solving Poisson took 879.768 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Total time for convolution: 	 convolve: 5.154871 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 58.455 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.189486 
Total time for convolution: 	 convolve: 5.198468 
Total time for convolution: 	 convolve: 5.196950 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.234 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 3.910 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.267 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.217 ms

This SCF took 27490.403 ms, scf error = 1.405e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.159249, lowerbound = -0.880253, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1372.564 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 16.496 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.116 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.625 ms
rank =  0, finding HY took 24.620 ms
rank =  0, distributing HY into block cyclic form took 16.455 ms
rank =  0, finding Y'*HY took 3.925 ms
Rank 0, Project_Hamiltonian used 64.654 ms
Total time for projection: 64.663 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -0.835436882684984
    last  calculated eigval = 0.045191441984918
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49213820239021
lambda[   6] =  -0.44857250296585
lambda[   7] =  -0.41584128531347
lambda[   8] =  -0.38624723537164
lambda[   9] =  -0.37823026545268
lambda[  10] =  -0.35677498750891
lambda[  11] =  -0.35454079306004
lambda[  12] =  -0.31518359910256
lambda[  13] =  -0.29668263510185
lambda[  14] =  -0.29576453043628
lambda[  15] =  -0.02993794211936
lambda[  16] =  -0.01503665023074
lambda[  17] =  -0.00822102185615
lambda[  18] =   0.00756551216420
lambda[  19] =   0.02371123328875
lambda[  20] =   0.02521312425530
lambda[  21] =   0.04519144198492
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.238 ms
rank =  0, subspace rotation using ScaLAPACK took 7.432 ms
rank =  0, Distributing orbital back into band + domain format took 16.747 ms
rank = 0, Subspace_Rotation used 24.192 ms

Total time for subspace rotation: 24.197 ms
rank = 0, Efermi =  -0.058494386775 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.130 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.072 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 1476.623 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.949 ms
rank = 0, D2D took 2.083 ms
rank = 0, Transfering density took 2.085 ms
Etot    =   -38.641965945444
Eband   =   -13.249139101858
E1      =    29.834647659506
E2      =   -11.190138724450
E3      =   -15.624576981280
Exc     =   -13.893816605309
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 5.383e-03, dEband = 1.069e-01
rank = 0, Calculating/Estimating energy took 0.835 ms, Etot = -38.641965945, dEtot = 5.383e-03, dEband = 1.069e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.7579164882193, which took 0.051 ms

iter_count = 102, r_2norm = 2.693e-04, tol*||rhs|| = 2.703e-04

Anderson update took 44.190 ms, out of which F'*F took 23.470 ms; b-Ax took 156.383 ms, out of which Lap took 141.543 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 307.197 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914928, int_b + int_rho = -6.912e-14, checking this took 0.085 ms
2-norm of RHS = 802.4317804440775, which took 0.086 ms

iter_count = 276, r_2norm = 6.720e-04, tol*||rhs|| = 8.024e-04

Anderson update took 119.422 ms, out of which F'*F took 63.467 ms; b-Ax took 421.492 ms, out of which Lap took 382.143 ms
Solving Poisson took 807.952 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.191128 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 53.641 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.195821 
Total time for convolution: 	 convolve: 5.365210 
Total time for convolution: 	 convolve: 5.192672 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 3.759 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 7.807 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 14.880 ms

This SCF took 27635.365 ms, scf error = 5.122e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.145191, lowerbound = -0.835437, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1368.753 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.425 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.462 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.903 ms
rank =  0, finding HY took 24.536 ms
rank =  0, distributing HY into block cyclic form took 17.092 ms
rank =  0, finding Y'*HY took 4.004 ms
Rank 0, Project_Hamiltonian used 64.560 ms
Total time for projection: 64.586 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.398 ms
rank = 0, Solve_Generalized_EigenProblem used 0.526 ms
    first calculated eigval = -0.823935013527904
    last  calculated eigval = 0.032357590494586
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47675700273523
lambda[   6] =  -0.43259511669677
lambda[   7] =  -0.40030793343743
lambda[   8] =  -0.36951422357674
lambda[   9] =  -0.36292160788369
lambda[  10] =  -0.34155032057189
lambda[  11] =  -0.33824178977881
lambda[  12] =  -0.30652985860923
lambda[  13] =  -0.28873907226240
lambda[  14] =  -0.28766149644563
lambda[  15] =  -0.03301814530999
lambda[  16] =  -0.00874952947433
lambda[  17] =  -0.00579948274726
lambda[  18] =   0.00651987226544
lambda[  19] =   0.02089954819407
lambda[  20] =   0.02271493311419
lambda[  21] =   0.03235759049459
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.540 ms
rank =  0, subspace rotation using ScaLAPACK took 7.363 ms
rank =  0, Distributing orbital back into band + domain format took 16.536 ms
rank = 0, Subspace_Rotation used 23.913 ms

Total time for subspace rotation: 23.918 ms
rank = 0, Efermi =  -0.061574589898 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.240 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.376 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.032 ms
rank = 0, Calculating density took 1473.638 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.001 ms
rank = 0, D2D took 2.128 ms
rank = 0, Transfering density took 2.130 ms
Etot    =   -38.634478297010
Eband   =   -12.859015955862
E1      =    29.538117604171
E2      =   -11.073638258495
E3      =   -15.768918475536
Exc     =   -14.007763075838
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 6.240e-04, dEband = 3.251e-02
rank = 0, Calculating/Estimating energy took 0.831 ms, Etot = -38.634478297, dEtot = 6.240e-04, dEband = 3.251e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.9424816749931, which took 0.133 ms

iter_count = 114, r_2norm = 5.094e-05, tol*||rhs|| = 7.770e-05

Anderson update took 50.246 ms, out of which F'*F took 26.226 ms; b-Ax took 173.923 ms, out of which Lap took 158.387 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 341.788 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914920, int_b + int_rho = -1.564e-13, checking this took 0.094 ms
2-norm of RHS = 802.8296601648125, which took 0.093 ms

iter_count = 258, r_2norm = 6.956e-04, tol*||rhs|| = 8.028e-04

Anderson update took 112.181 ms, out of which F'*F took 58.913 ms; b-Ax took 394.364 ms, out of which Lap took 357.138 ms
Solving Poisson took 756.586 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Total time for convolution: 	 convolve: 5.190234 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.593 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.201866 
Total time for convolution: 	 convolve: 5.204036 
Total time for convolution: 	 convolve: 5.210927 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 3.779 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.163 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.982 ms

This SCF took 27449.414 ms, scf error = 2.097e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.132358, lowerbound = -0.823935, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1359.494 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.764 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.419 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.202 ms
rank =  0, finding HY took 24.330 ms
rank =  0, distributing HY into block cyclic form took 16.426 ms
rank =  0, finding Y'*HY took 4.002 ms
Rank 0, Project_Hamiltonian used 65.002 ms
Total time for projection: 65.022 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.205 ms
    first calculated eigval = -0.820282070386077
    last  calculated eigval = 0.024955581929193
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47104951175175
lambda[   6] =  -0.42693669288768
lambda[   7] =  -0.39507064202323
lambda[   8] =  -0.36341427778645
lambda[   9] =  -0.35717428626405
lambda[  10] =  -0.33581383738973
lambda[  11] =  -0.33253876326436
lambda[  12] =  -0.30109455737138
lambda[  13] =  -0.28525395527325
lambda[  14] =  -0.28390228775481
lambda[  15] =  -0.03454030919331
lambda[  16] =  -0.00572613149155
lambda[  17] =  -0.00418401925809
lambda[  18] =   0.00613326766969
lambda[  19] =   0.01957731006438
lambda[  20] =   0.02180269028704
lambda[  21] =   0.02495558192919
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 7.521 ms
rank =  0, Distributing orbital back into band + domain format took 16.344 ms
rank = 0, Subspace_Rotation used 23.880 ms

Total time for subspace rotation: 23.885 ms
rank = 0, Efermi =  -0.063096753839 calculate fermi energy took 0.802 ms
rank = 0, --- Calculate rho: sum over local bands took 3.995 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.287 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.626 ms
rank = 0, Calculating density took 1464.398 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.911 ms
rank = 0, D2D took 2.028 ms
rank = 0, Transfering density took 2.035 ms
Etot    =   -38.632708371013
Eband   =   -12.714474166641
E1      =    29.467571809207
E2      =   -10.986496344537
E3      =   -15.824547909159
Exc     =   -14.048476663763
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 1.475e-04, dEband = 1.205e-02
rank = 0, Calculating/Estimating energy took 0.902 ms, Etot = -38.632708371, dEtot = 1.475e-04, dEband = 1.205e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.1801842302981, which took 0.120 ms

iter_count = 108, r_2norm = 4.565e-05, tol*||rhs|| = 4.721e-05

Anderson update took 47.205 ms, out of which F'*F took 25.060 ms; b-Ax took 166.398 ms, out of which Lap took 151.129 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 322.864 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914928, int_b + int_rho = -7.640e-14, checking this took 0.085 ms
2-norm of RHS = 803.1257494220454, which took 0.092 ms

iter_count = 234, r_2norm = 6.942e-04, tol*||rhs|| = 8.031e-04

Anderson update took 102.756 ms, out of which F'*F took 54.017 ms; b-Ax took 359.651 ms, out of which Lap took 326.862 ms
Solving Poisson took 684.720 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Total time for convolution: 	 convolve: 5.228603 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.861 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.210075 
Total time for convolution: 	 convolve: 5.209622 
Total time for convolution: 	 convolve: 5.215113 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.163 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.182 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.402 ms
---Transfer Veff_loc: D2D took 3.783 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.240 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.061 ms

This SCF took 27379.463 ms, scf error = 6.909e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.124956, lowerbound = -0.820282, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1358.529 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.011 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.432 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.459 ms
rank =  0, finding HY took 23.979 ms
rank =  0, distributing HY into block cyclic form took 16.497 ms
rank =  0, finding Y'*HY took 3.875 ms
Rank 0, Project_Hamiltonian used 63.838 ms
Total time for projection: 63.848 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.134 ms
rank = 0, Solve_Generalized_EigenProblem used 0.256 ms
    first calculated eigval = -0.818819080158124
    last  calculated eigval = 0.022205210208924
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46890321739935
lambda[   6] =  -0.42402568085306
lambda[   7] =  -0.39222275468457
lambda[   8] =  -0.36010709003423
lambda[   9] =  -0.35427941102991
lambda[  10] =  -0.33329110970249
lambda[  11] =  -0.32947878098158
lambda[  12] =  -0.29894216369546
lambda[  13] =  -0.28339564423604
lambda[  14] =  -0.28221619993075
lambda[  15] =  -0.03487043385816
lambda[  16] =  -0.00419577208630
lambda[  17] =  -0.00355076569375
lambda[  18] =   0.00593374701810
lambda[  19] =   0.01891955917802
lambda[  20] =   0.02059303752191
lambda[  21] =   0.02220521020892
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 0.317 ms
rank =  0, subspace rotation using ScaLAPACK took 7.381 ms
rank =  0, Distributing orbital back into band + domain format took 16.208 ms
rank = 0, Subspace_Rotation used 23.604 ms

Total time for subspace rotation: 23.608 ms
rank = 0, Efermi =  -0.063426878441 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.175 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.028 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.625 ms
rank = 0, Calculating density took 1461.312 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.917 ms
rank = 0, D2D took 2.047 ms
rank = 0, Transfering density took 2.049 ms
Etot    =   -38.632358487168
Eband   =   -12.643726775102
E1      =    29.434561145409
E2      =   -10.944666535934
E3      =   -15.839406111833
Exc     =   -14.058891901730
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 2.916e-05, dEband = 5.896e-03
rank = 0, Calculating/Estimating energy took 0.824 ms, Etot = -38.632358487, dEtot = 2.916e-05, dEband = 5.896e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4881732087285, which took 0.149 ms

iter_count = 114, r_2norm = 1.384e-05, tol*||rhs|| = 1.953e-05

Anderson update took 49.861 ms, out of which F'*F took 26.119 ms; b-Ax took 173.421 ms, out of which Lap took 157.676 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 340.702 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914924, int_b + int_rho = -1.128e-13, checking this took 0.091 ms
2-norm of RHS = 803.4349746535988, which took 0.068 ms

iter_count = 234, r_2norm = 7.877e-04, tol*||rhs|| = 8.034e-04

Anderson update took 103.123 ms, out of which F'*F took 53.633 ms; b-Ax took 356.192 ms, out of which Lap took 323.570 ms
Solving Poisson took 685.013 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Total time for convolution: 	 convolve: 5.190413 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 42.366 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.198546 
Total time for convolution: 	 convolve: 5.196238 
Total time for convolution: 	 convolve: 5.190184 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.167 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.161 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.012 ms
======D2D: initiated sending and receiving took 0.247 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
---Transfer Veff_loc: D2D took 3.797 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.280 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.115 ms

This SCF took 27353.740 ms, scf error = 4.253e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.122205, lowerbound = -0.818819, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1365.819 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 16.819 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.442 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.277 ms
rank =  0, finding HY took 23.992 ms
rank =  0, distributing HY into block cyclic form took 16.490 ms
rank =  0, finding Y'*HY took 4.269 ms
Rank 0, Project_Hamiltonian used 64.055 ms
Total time for projection: 64.065 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.116 ms
rank = 0, Solve_Generalized_EigenProblem used 0.244 ms
    first calculated eigval = -0.816858599177737
    last  calculated eigval = 0.022464011138240
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46605004448365
lambda[   6] =  -0.42069033698099
lambda[   7] =  -0.38894101204112
lambda[   8] =  -0.35658029070204
lambda[   9] =  -0.35100782249824
lambda[  10] =  -0.33033131667621
lambda[  11] =  -0.32609269327995
lambda[  12] =  -0.29652967161597
lambda[  13] =  -0.28116130186247
lambda[  14] =  -0.28011949337153
lambda[  15] =  -0.03419860354750
lambda[  16] =  -0.00233698290231
lambda[  17] =  -0.00208502053629
lambda[  18] =   0.00651205379802
lambda[  19] =   0.01958688653709
lambda[  20] =   0.02037279417245
lambda[  21] =   0.02246401113824
==subpsace eigenproblem: bcast eigvals took 0.048 ms
Total time for solving subspace eigenvalue problem: 0.300 ms
rank =  0, subspace rotation using ScaLAPACK took 7.468 ms
rank =  0, Distributing orbital back into band + domain format took 16.237 ms
rank = 0, Subspace_Rotation used 23.720 ms

Total time for subspace rotation: 23.726 ms
rank = 0, Efermi =  -0.062755048156 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.260 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.093 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.619 ms
rank = 0, Calculating density took 1469.043 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.928 ms
rank = 0, D2D took 2.037 ms
rank = 0, Transfering density took 2.038 ms
Etot    =   -38.632081899395
Eband   =   -12.561207035669
E1      =    29.396846277852
E2      =   -10.895131521132
E3      =   -15.855903034128
Exc     =   -14.070382093326
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 2.305e-05, dEband = 6.877e-03
rank = 0, Calculating/Estimating energy took 0.871 ms, Etot = -38.632081899, dEtot = 2.305e-05, dEband = 6.877e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2321837472609, which took 0.115 ms

iter_count = 114, r_2norm = 6.732e-06, tol*||rhs|| = 9.287e-06

Anderson update took 49.962 ms, out of which F'*F took 26.003 ms; b-Ax took 174.522 ms, out of which Lap took 158.836 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 343.172 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914924, int_b + int_rho = -1.128e-13, checking this took 0.169 ms
2-norm of RHS = 803.5170525218250, which took 0.087 ms

iter_count = 228, r_2norm = 7.572e-04, tol*||rhs|| = 8.035e-04

Anderson update took 99.557 ms, out of which F'*F took 52.400 ms; b-Ax took 348.386 ms, out of which Lap took 316.464 ms
Solving Poisson took 668.242 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.160 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Total time for convolution: 	 convolve: 5.221033 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.584 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.191992 
Total time for convolution: 	 convolve: 5.191214 
Total time for convolution: 	 convolve: 5.199485 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.579 ms
---Transfer Veff_loc: D2D took 3.871 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.374 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.285 ms

This SCF took 27592.080 ms, scf error = 2.291e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.122464, lowerbound = -0.816859, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1384.964 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 16.618 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.450 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.085 ms
rank =  0, finding HY took 24.189 ms
rank =  0, distributing HY into block cyclic form took 16.732 ms
rank =  0, finding Y'*HY took 3.936 ms
Rank 0, Project_Hamiltonian used 63.969 ms
Total time for projection: 63.981 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.129 ms
rank = 0, Solve_Generalized_EigenProblem used 0.254 ms
    first calculated eigval = -0.814093110951149
    last  calculated eigval = 0.024546019453629
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46322541265313
lambda[   6] =  -0.41774771351661
lambda[   7] =  -0.38595483684642
lambda[   8] =  -0.35373083392212
lambda[   9] =  -0.34813034763669
lambda[  10] =  -0.32765246257956
lambda[  11] =  -0.32318864505797
lambda[  12] =  -0.29383222517965
lambda[  13] =  -0.27856898006421
lambda[  14] =  -0.27765657558952
lambda[  15] =  -0.03259320305365
lambda[  16] =  -0.00056662787913
lambda[  17] =   0.00050859802063
lambda[  18] =   0.00844778204549
lambda[  19] =   0.02137637718622
lambda[  20] =   0.02158888535968
lambda[  21] =   0.02454601945363
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 0.312 ms
rank =  0, subspace rotation using ScaLAPACK took 7.415 ms
rank =  0, Distributing orbital back into band + domain format took 16.254 ms
rank = 0, Subspace_Rotation used 23.684 ms

Total time for subspace rotation: 23.689 ms
rank = 0, Efermi =  -0.061149647681 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.491 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.876 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.626 ms
rank = 0, Calculating density took 1488.156 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.957 ms
rank = 0, D2D took 2.100 ms
rank = 0, Transfering density took 2.102 ms
Etot    =   -38.631979919440
Eband   =   -12.481795246383
E1      =    29.355044642624
E2      =   -10.854462394649
E3      =   -15.867427492560
Exc     =   -14.078745599379
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 8.498e-06, dEband = 6.618e-03
rank = 0, Calculating/Estimating energy took 0.854 ms, Etot = -38.631979919, dEtot = 8.498e-06, dEband = 6.618e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1668830254762, which took 0.145 ms

iter_count = 108, r_2norm = 6.654e-06, tol*||rhs|| = 6.675e-06

Anderson update took 47.096 ms, out of which F'*F took 24.786 ms; b-Ax took 165.427 ms, out of which Lap took 150.255 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 324.956 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914923, int_b + int_rho = -1.237e-13, checking this took 0.091 ms
2-norm of RHS = 803.5214040580059, which took 0.105 ms

iter_count = 216, r_2norm = 6.752e-04, tol*||rhs|| = 8.035e-04

Anderson update took 94.702 ms, out of which F'*F took 49.772 ms; b-Ax took 329.455 ms, out of which Lap took 299.842 ms
Solving Poisson took 631.766 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
Total time for convolution: 	 convolve: 5.192576 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 54.726 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.209471 
Total time for convolution: 	 convolve: 5.291895 
Total time for convolution: 	 convolve: 5.244618 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.523 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.326 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.711 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.169 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.918 ms

This SCF took 27483.132 ms, scf error = 1.220e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.124546, lowerbound = -0.814093, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1362.568 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.689 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.460 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.164 ms
rank =  0, finding HY took 24.053 ms
rank =  0, distributing HY into block cyclic form took 16.474 ms
rank =  0, finding Y'*HY took 3.864 ms
Rank 0, Project_Hamiltonian used 63.584 ms
Total time for projection: 63.595 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.121 ms
rank = 0, Solve_Generalized_EigenProblem used 0.245 ms
    first calculated eigval = -0.812711742317134
    last  calculated eigval = 0.027891074724033
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46206333737789
lambda[   6] =  -0.41657747387005
lambda[   7] =  -0.38472084406219
lambda[   8] =  -0.35243797016886
lambda[   9] =  -0.34680455957544
lambda[  10] =  -0.32640862872719
lambda[  11] =  -0.32196360931467
lambda[  12] =  -0.29243786238620
lambda[  13] =  -0.27721318715329
lambda[  14] =  -0.27634065044934
lambda[  15] =  -0.02971148918559
lambda[  16] =   0.00109631691931
lambda[  17] =   0.00242615256595
lambda[  18] =   0.01240551277324
lambda[  19] =   0.02390657853437
lambda[  20] =   0.02422231931225
lambda[  21] =   0.02789107472403
==subpsace eigenproblem: bcast eigvals took 0.039 ms
Total time for solving subspace eigenvalue problem: 0.293 ms
rank =  0, subspace rotation using ScaLAPACK took 7.503 ms
rank =  0, Distributing orbital back into band + domain format took 16.393 ms
rank = 0, Subspace_Rotation used 23.910 ms

Total time for subspace rotation: 23.916 ms
rank = 0, Efermi =  -0.058267933801 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.073 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.149 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 1465.307 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.983 ms
rank = 0, D2D took 2.139 ms
rank = 0, Transfering density took 2.145 ms
Etot    =   -38.632002595688
Eband   =   -12.446326459997
E1      =    29.339806917319
E2      =   -10.833831561840
E3      =   -15.868585803937
Exc     =   -14.079526815275
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 1.890e-06, dEband = 2.956e-03
rank = 0, Calculating/Estimating energy took 0.994 ms, Etot = -38.632002596, dEtot = 1.890e-06, dEband = 2.956e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0922860048913, which took 0.120 ms

iter_count = 114, r_2norm = 2.928e-06, tol*||rhs|| = 3.691e-06

Anderson update took 49.381 ms, out of which F'*F took 26.179 ms; b-Ax took 173.550 ms, out of which Lap took 157.592 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 341.469 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914923, int_b + int_rho = -1.273e-13, checking this took 0.083 ms
2-norm of RHS = 803.4963666733992, which took 0.067 ms

iter_count = 186, r_2norm = 6.979e-04, tol*||rhs|| = 8.035e-04

Anderson update took 81.160 ms, out of which F'*F took 42.965 ms; b-Ax took 283.551 ms, out of which Lap took 258.074 ms
Solving Poisson took 543.194 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Total time for convolution: 	 convolve: 5.199315 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.459 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.186412 
Total time for convolution: 	 convolve: 5.209583 
Total time for convolution: 	 convolve: 5.193585 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.746 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.446 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.233 ms

This SCF took 27201.292 ms, scf error = 7.783e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.127891, lowerbound = -0.812712, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1363.403 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 16.538 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.553 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.106 ms
rank =  0, finding HY took 24.382 ms
rank =  0, distributing HY into block cyclic form took 16.274 ms
rank =  0, finding Y'*HY took 3.943 ms
Rank 0, Project_Hamiltonian used 63.734 ms
Total time for projection: 63.743 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.139 ms
rank = 0, Solve_Generalized_EigenProblem used 0.261 ms
    first calculated eigval = -0.812119498715808
    last  calculated eigval = 0.028787549333897
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46141502190471
lambda[   6] =  -0.41588119237016
lambda[   7] =  -0.38401306441690
lambda[   8] =  -0.35170537926430
lambda[   9] =  -0.34611073064089
lambda[  10] =  -0.32575092293241
lambda[  11] =  -0.32125543884400
lambda[  12] =  -0.29189138746882
lambda[  13] =  -0.27665447567303
lambda[  14] =  -0.27580096536491
lambda[  15] =  -0.02842349758425
lambda[  16] =   0.00176352427278
lambda[  17] =   0.00309807580252
lambda[  18] =   0.01393124971341
lambda[  19] =   0.02488353099280
lambda[  20] =   0.02525554624785
lambda[  21] =   0.02878754933390
==subpsace eigenproblem: bcast eigvals took 0.063 ms
Total time for solving subspace eigenvalue problem: 0.331 ms
rank =  0, subspace rotation using ScaLAPACK took 7.395 ms
rank =  0, Distributing orbital back into band + domain format took 16.243 ms
rank = 0, Subspace_Rotation used 23.651 ms

Total time for subspace rotation: 23.657 ms
rank = 0, Efermi =  -0.056979942200 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.252 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.943 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.607 ms
rank = 0, Calculating density took 1467.064 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.903 ms
rank = 0, D2D took 2.035 ms
rank = 0, Transfering density took 2.038 ms
Etot    =   -38.632024977157
Eband   =   -12.427871940980
E1      =    29.328714673290
E2      =   -10.825901600440
E3      =   -15.871361902999
Exc     =   -14.081757609393
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 1.865e-06, dEband = 1.538e-03
rank = 0, Calculating/Estimating energy took 0.879 ms, Etot = -38.632024977, dEtot = 1.865e-06, dEband = 1.538e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0549951018272, which took 0.049 ms

iter_count = 114, r_2norm = 1.626e-06, tol*||rhs|| = 2.200e-06

Anderson update took 49.409 ms, out of which F'*F took 26.069 ms; b-Ax took 173.509 ms, out of which Lap took 157.691 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 342.151 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914926, int_b + int_rho = -9.095e-14, checking this took 0.083 ms
2-norm of RHS = 803.5064655223642, which took 0.077 ms

iter_count = 192, r_2norm = 6.472e-04, tol*||rhs|| = 8.035e-04

Anderson update took 84.369 ms, out of which F'*F took 44.111 ms; b-Ax took 292.875 ms, out of which Lap took 266.341 ms
Solving Poisson took 561.743 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.125 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.258908 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.190256 
Total time for convolution: 	 convolve: 5.200900 
Total time for convolution: 	 convolve: 5.221377 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 3.785 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.116 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.936 ms

This SCF took 27280.237 ms, scf error = 5.222e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.128788, lowerbound = -0.812119, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1364.503 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.391 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.484 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.891 ms
rank =  0, finding HY took 24.310 ms
rank =  0, distributing HY into block cyclic form took 16.421 ms
rank =  0, finding Y'*HY took 3.911 ms
Rank 0, Project_Hamiltonian used 63.562 ms
Total time for projection: 63.574 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.138 ms
rank = 0, Solve_Generalized_EigenProblem used 0.264 ms
    first calculated eigval = -0.811515199027556
    last  calculated eigval = 0.030028523485401
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46062486411779
lambda[   6] =  -0.41505367441995
lambda[   7] =  -0.38317292390304
lambda[   8] =  -0.35085514810993
lambda[   9] =  -0.34529404620597
lambda[  10] =  -0.32496813808425
lambda[  11] =  -0.32043719905983
lambda[  12] =  -0.29122696168572
lambda[  13] =  -0.27596155974455
lambda[  14] =  -0.27512917444561
lambda[  15] =  -0.02617195696268
lambda[  16] =   0.00297956859880
lambda[  17] =   0.00384444266184
lambda[  18] =   0.01607262416336
lambda[  19] =   0.02659511048267
lambda[  20] =   0.02733432906888
lambda[  21] =   0.03002852348540
==subpsace eigenproblem: bcast eigvals took 0.035 ms
Total time for solving subspace eigenvalue problem: 0.308 ms
rank =  0, subspace rotation using ScaLAPACK took 7.397 ms
rank =  0, Distributing orbital back into band + domain format took 16.887 ms
rank = 0, Subspace_Rotation used 24.298 ms

Total time for subspace rotation: 24.304 ms
rank = 0, Efermi =  -0.054728401609 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.050 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.243 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.590 ms
rank = 0, Calculating density took 1467.705 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.857 ms
rank = 0, D2D took 2.010 ms
rank = 0, Transfering density took 2.012 ms
Etot    =   -38.632118932568
Eband   =   -12.406140662540
E1      =    29.318118888484
E2      =   -10.814388672373
E3      =   -15.872852319066
Exc     =   -14.082964546439
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 7.830e-06, dEband = 1.811e-03
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -38.632118933, dEtot = 7.830e-06, dEband = 1.811e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0417343621105, which took 0.057 ms

iter_count = 114, r_2norm = 1.454e-06, tol*||rhs|| = 1.669e-06

Anderson update took 49.387 ms, out of which F'*F took 26.547 ms; b-Ax took 175.587 ms, out of which Lap took 159.539 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 343.319 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914935, int_b + int_rho = -1.091e-14, checking this took 0.085 ms
2-norm of RHS = 803.5088642143654, which took 0.099 ms

iter_count = 144, r_2norm = 7.921e-04, tol*||rhs|| = 8.035e-04

Anderson update took 63.428 ms, out of which F'*F took 33.261 ms; b-Ax took 219.689 ms, out of which Lap took 199.721 ms
Solving Poisson took 422.202 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
Total time for convolution: 	 convolve: 5.202015 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.904 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.221947 
Total time for convolution: 	 convolve: 5.202477 
Total time for convolution: 	 convolve: 5.223347 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 3.713 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.476 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.229 ms

This SCF took 27135.872 ms, scf error = 3.263e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.130029, lowerbound = -0.811515, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1362.797 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 16.511 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.437 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.963 ms
rank =  0, finding HY took 24.075 ms
rank =  0, distributing HY into block cyclic form took 16.616 ms
rank =  0, finding Y'*HY took 3.963 ms
Rank 0, Project_Hamiltonian used 63.644 ms
Total time for projection: 63.654 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.117 ms
rank = 0, Solve_Generalized_EigenProblem used 0.245 ms
    first calculated eigval = -0.811282975726793
    last  calculated eigval = 0.030437709150888
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46041142349468
lambda[   6] =  -0.41484937766501
lambda[   7] =  -0.38296318686654
lambda[   8] =  -0.35065408681650
lambda[   9] =  -0.34508702218420
lambda[  10] =  -0.32476282192764
lambda[  11] =  -0.32023702198688
lambda[  12] =  -0.29101576867877
lambda[  13] =  -0.27573825028395
lambda[  14] =  -0.27491004696440
lambda[  15] =  -0.02553465510853
lambda[  16] =   0.00335211647977
lambda[  17] =   0.00404753574723
lambda[  18] =   0.01659567739156
lambda[  19] =   0.02708295696990
lambda[  20] =   0.02756680328961
lambda[  21] =   0.03043770915089
==subpsace eigenproblem: bcast eigvals took 0.072 ms
Total time for solving subspace eigenvalue problem: 0.325 ms
rank =  0, subspace rotation using ScaLAPACK took 7.461 ms
rank =  0, Distributing orbital back into band + domain format took 17.080 ms
rank = 0, Subspace_Rotation used 24.557 ms

Total time for subspace rotation: 24.562 ms
rank = 0, Efermi =  -0.054091099757 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.172 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.188 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.609 ms
rank = 0, Calculating density took 1466.430 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.954 ms
rank = 0, D2D took 2.087 ms
rank = 0, Transfering density took 2.089 ms
Etot    =   -38.632155513987
Eband   =   -12.400214107507
E1      =    29.315161849911
E2      =   -10.811298598585
E3      =   -15.873277096076
Exc     =   -14.083305347541
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 3.048e-06, dEband = 4.939e-04
rank = 0, Calculating/Estimating energy took 0.869 ms, Etot = -38.632155514, dEtot = 3.048e-06, dEband = 4.939e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0324247016547, which took 0.144 ms

iter_count = 114, r_2norm = 8.174e-07, tol*||rhs|| = 1.297e-06

Anderson update took 49.394 ms, out of which F'*F took 26.257 ms; b-Ax took 175.609 ms, out of which Lap took 159.459 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 343.156 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914935, int_b + int_rho = -3.638e-15, checking this took 0.079 ms
2-norm of RHS = 803.5144856795407, which took 0.083 ms

iter_count = 168, r_2norm = 6.545e-04, tol*||rhs|| = 8.035e-04

Anderson update took 105.419 ms, out of which F'*F took 38.768 ms; b-Ax took 256.454 ms, out of which Lap took 233.197 ms
Solving Poisson took 524.251 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.149 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
Total time for convolution: 	 convolve: 5.203188 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.344 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.252378 
Total time for convolution: 	 convolve: 5.199576 
Total time for convolution: 	 convolve: 5.206941 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.861 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 3.808 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.119 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.965 ms

This SCF took 27300.445 ms, scf error = 2.669e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.130438, lowerbound = -0.811283, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1366.724 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.624 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.483 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.123 ms
rank =  0, finding HY took 24.133 ms
rank =  0, distributing HY into block cyclic form took 16.649 ms
rank =  0, finding Y'*HY took 3.857 ms
Rank 0, Project_Hamiltonian used 63.792 ms
Total time for projection: 63.802 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.259 ms
rank = 0, Solve_Generalized_EigenProblem used 1.386 ms
    first calculated eigval = -0.810787089384760
    last  calculated eigval = 0.031415484120647
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46000513429455
lambda[   6] =  -0.41446254199611
lambda[   7] =  -0.38256435773475
lambda[   8] =  -0.35027118598338
lambda[   9] =  -0.34468762211722
lambda[  10] =  -0.32436410867554
lambda[  11] =  -0.31985247338047
lambda[  12] =  -0.29058527701090
lambda[  13] =  -0.27528101432820
lambda[  14] =  -0.27446106241641
lambda[  15] =  -0.02389407884740
lambda[  16] =   0.00426953935888
lambda[  17] =   0.00449620746373
lambda[  18] =   0.01787914613325
lambda[  19] =   0.02845108612722
lambda[  20] =   0.02857751340994
lambda[  21] =   0.03141548412065
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.422 ms
rank =  0, subspace rotation using ScaLAPACK took 7.560 ms
rank =  0, Distributing orbital back into band + domain format took 16.306 ms
rank = 0, Subspace_Rotation used 23.881 ms

Total time for subspace rotation: 23.887 ms
rank = 0, Efermi =  -0.052450523509 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.098 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.022 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.598 ms
rank = 0, Calculating density took 1470.749 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.887 ms
rank = 0, D2D took 2.034 ms
rank = 0, Transfering density took 2.041 ms
Etot    =   -38.632215628916
Eband   =   -12.388614449072
E1      =    29.309386236191
E2      =   -10.805256398960
E3      =   -15.874078849888
Exc     =   -14.083949061370
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 5.010e-06, dEband = 9.666e-04
rank = 0, Calculating/Estimating energy took 0.843 ms, Etot = -38.632215629, dEtot = 5.010e-06, dEband = 9.666e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0274414327261, which took 0.151 ms

iter_count = 108, r_2norm = 1.043e-06, tol*||rhs|| = 1.098e-06

Anderson update took 46.805 ms, out of which F'*F took 24.810 ms; b-Ax took 164.642 ms, out of which Lap took 149.643 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 324.306 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914926, int_b + int_rho = -9.095e-14, checking this took 0.084 ms
2-norm of RHS = 803.5175256648733, which took 0.087 ms

iter_count = 144, r_2norm = 7.433e-04, tol*||rhs|| = 8.035e-04

Anderson update took 63.027 ms, out of which F'*F took 33.210 ms; b-Ax took 219.178 ms, out of which Lap took 199.218 ms
Solving Poisson took 420.818 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Total time for convolution: 	 convolve: 5.242333 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.223188 
Total time for convolution: 	 convolve: 5.246758 
Total time for convolution: 	 convolve: 5.186119 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.842 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.712 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.159 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.910 ms

This SCF took 27161.618 ms, scf error = 1.603e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.131415, lowerbound = -0.810787, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1364.704 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.582 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.464 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.087 ms
rank =  0, finding HY took 24.426 ms
rank =  0, distributing HY into block cyclic form took 16.632 ms
rank =  0, finding Y'*HY took 4.047 ms
Rank 0, Project_Hamiltonian used 64.224 ms
Total time for projection: 64.239 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.115 ms
rank = 0, Solve_Generalized_EigenProblem used 0.237 ms
    first calculated eigval = -0.810591644600034
    last  calculated eigval = 0.030817256699041
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.45984485557987
lambda[   6] =  -0.41430656796618
lambda[   7] =  -0.38240297578766
lambda[   8] =  -0.35011843521482
lambda[   9] =  -0.34452969701525
lambda[  10] =  -0.32420674539283
lambda[  11] =  -0.31969636021072
lambda[  12] =  -0.29041836334986
lambda[  13] =  -0.27510220609544
lambda[  14] =  -0.27428564952561
lambda[  15] =  -0.02327493749346
lambda[  16] =   0.00444806918237
lambda[  17] =   0.00459014014654
lambda[  18] =   0.01804313352580
lambda[  19] =   0.02870627383229
lambda[  20] =   0.02896769098754
lambda[  21] =   0.03081725669904
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.264 ms
rank =  0, subspace rotation using ScaLAPACK took 7.270 ms
rank =  0, Distributing orbital back into band + domain format took 16.303 ms
rank = 0, Subspace_Rotation used 23.587 ms

Total time for subspace rotation: 23.593 ms
rank = 0, Efermi =  -0.051831382065 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 4.320 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.203 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.682 ms
rank = 0, Calculating density took 1468.190 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.881 ms
rank = 0, D2D took 2.016 ms
rank = 0, Transfering density took 2.023 ms
Etot    =   -38.632254719804
Eband   =   -12.384007304123
E1      =    29.307111469884
E2      =   -10.802859627144
E3      =   -15.874244391041
Exc     =   -14.084089300237
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 3.258e-06, dEband = 3.839e-04
rank = 0, Calculating/Estimating energy took 0.824 ms, Etot = -38.632254720, dEtot = 3.258e-06, dEband = 3.839e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0199112541903, which took 0.055 ms

iter_count = 114, r_2norm = 5.087e-07, tol*||rhs|| = 7.965e-07

Anderson update took 49.424 ms, out of which F'*F took 26.364 ms; b-Ax took 175.015 ms, out of which Lap took 159.135 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 342.570 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914927, int_b + int_rho = -8.367e-14, checking this took 0.090 ms
2-norm of RHS = 803.5176837500248, which took 0.090 ms

iter_count = 114, r_2norm = 7.264e-04, tol*||rhs|| = 8.035e-04

Anderson update took 49.947 ms, out of which F'*F took 26.688 ms; b-Ax took 174.621 ms, out of which Lap took 158.674 ms
Solving Poisson took 335.426 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.247712 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.362 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.209887 
Total time for convolution: 	 convolve: 5.260830 
Total time for convolution: 	 convolve: 5.200535 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.270 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.874 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.101 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.014 ms

This SCF took 27142.613 ms, scf error = 1.055e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.130817, lowerbound = -0.810592, upperbound = 267.596358

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1371.631 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 16.637 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.484 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.137 ms
rank =  0, finding HY took 24.484 ms
rank =  0, distributing HY into block cyclic form took 16.289 ms
rank =  0, finding Y'*HY took 4.064 ms
Rank 0, Project_Hamiltonian used 64.001 ms
Total time for projection: 64.012 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.125 ms
rank = 0, Solve_Generalized_EigenProblem used 0.250 ms
    first calculated eigval = -0.810556326915755
    last  calculated eigval = 0.030415735748773
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.45981478683261
lambda[   6] =  -0.41428267515770
lambda[   7] =  -0.38237676954602
lambda[   8] =  -0.35009400481740
lambda[   9] =  -0.34450302775338
lambda[  10] =  -0.32417774780053
lambda[  11] =  -0.31967251220529
lambda[  12] =  -0.29038447343962
lambda[  13] =  -0.27506771437285
lambda[  14] =  -0.27424976447978
lambda[  15] =  -0.02322536017173
lambda[  16] =   0.00447584918785
lambda[  17] =   0.00457491679834
lambda[  18] =   0.01772582276747
lambda[  19] =   0.02856126092590
lambda[  20] =   0.02900708890511
lambda[  21] =   0.03041573574877
==subpsace eigenproblem: bcast eigvals took 0.047 ms
Total time for solving subspace eigenvalue problem: 0.304 ms
rank =  0, subspace rotation using ScaLAPACK took 7.283 ms
rank =  0, Distributing orbital back into band + domain format took 16.222 ms
rank = 0, Subspace_Rotation used 23.519 ms

Total time for subspace rotation: 23.524 ms
rank = 0, Efermi =  -0.051781804815 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.296 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.108 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.625 ms
rank = 0, Calculating density took 1474.684 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.972 ms
rank = 0, D2D took 2.080 ms
rank = 0, Transfering density took 2.083 ms
Etot    =   -38.632263479986
Eband   =   -12.383210817001
E1      =    29.306839878982
E2      =   -10.802357067281
E3      =   -15.874124306147
Exc     =   -14.084000311883
Esc     =   -68.148373602359
Entropy =    -0.000000001153
dE = 7.300e-07, dEband = 6.637e-05
rank = 0, Calculating/Estimating energy took 0.807 ms, Etot = -38.632263480, dEtot = 7.300e-07, dEband = 6.637e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0119955753509, which took 0.070 ms

iter_count = 114, r_2norm = 3.951e-07, tol*||rhs|| = 4.798e-07

Anderson update took 49.438 ms, out of which F'*F took 26.376 ms; b-Ax took 174.748 ms, out of which Lap took 157.933 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 342.906 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003914936, int_rho =  28.00000003914926, int_b + int_rho = -9.823e-14, checking this took 0.089 ms
2-norm of RHS = 803.5167695650415, which took 0.084 ms

iter_count = 108, r_2norm = 6.989e-04, tol*||rhs|| = 8.035e-04

Anderson update took 47.256 ms, out of which F'*F took 24.825 ms; b-Ax took 165.240 ms, out of which Lap took 149.994 ms
Solving Poisson took 317.679 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Total time for convolution: 	 convolve: 5.199382 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 14.734 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.160981 
Total time for convolution: 	 convolve: 5.156409 
Total time for convolution: 	 convolve: 5.194184 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.844 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.849 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.458 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.343 ms

This SCF took 26911.316 ms, scf error = 9.034e-05
The last 17 occupations of kpoints #1 are (Nelectron = 28):
lambda[   5] =  -0.45981478683261, occ[   5] =   2.00000000000000
lambda[   6] =  -0.41428267515770, occ[   6] =   2.00000000000000
lambda[   7] =  -0.38237676954602, occ[   7] =   2.00000000000000
lambda[   8] =  -0.35009400481740, occ[   8] =   2.00000000000000
lambda[   9] =  -0.34450302775338, occ[   9] =   2.00000000000000
lambda[  10] =  -0.32417774780053, occ[  10] =   2.00000000000000
lambda[  11] =  -0.31967251220529, occ[  11] =   2.00000000000000
lambda[  12] =  -0.29038447343962, occ[  12] =   2.00000000000000
lambda[  13] =  -0.27506771437285, occ[  13] =   2.00000000000000
lambda[  14] =  -0.27424976447978, occ[  14] =   2.00000000000000
lambda[  15] =  -0.02322536017173, occ[  15] =   0.00000003914925
lambda[  16] =   0.00447584918785, occ[  16] =   0.00000000000000
lambda[  17] =   0.00457491679834, occ[  17] =   0.00000000000000
lambda[  18] =   0.01772582276747, occ[  18] =   0.00000000000000
lambda[  19] =   0.02856126092590, occ[  19] =   0.00000000000000
lambda[  20] =   0.02900708890511, occ[  20] =   0.00000000000000
lambda[  21] =   0.03041573574877, occ[  21] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 19 (90%) = 0.000000000000000.
Occupation of state 21 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.683 ms, time for Allreduce/Reduce: 14.545 ms 
Time for calculating local force components: 25.627 ms
Start Calculating nonlocal forces
force_nloc = 
  0.05041083725672   0.00161220489437   0.00000000536903
  0.01731713723704  -0.04672630257967  -0.00101152232867
  0.01578348532735   0.02323563059191  -0.04161326301454
 -0.04998225180844  -0.00204572318812  -0.00196380459235
  0.01731715076408  -0.04672634170441   0.00101155486326
  0.01578351193253   0.02323562798534   0.04161330399601
 -0.04998228016378  -0.00204573633550   0.00196380954123
 -0.00000256011131  -0.00379966097474  -0.00000016252184
  0.05024825844030  -0.12294277917139  -0.00000013135629
 -0.01463745678922  -0.01741169817445  -0.03200756296837
 -0.01463760754315  -0.01741193320890   0.03200800026924
 -0.31151546567856   0.86887044766177   0.00000022919826
force_loc = 
 -0.05420176310263  -0.00189873206972   0.00000000308526
 -0.01789910907913   0.04909952339858   0.00142620573102
 -0.01633255584060  -0.02394797498361   0.04402951025993
  0.05200695171458   0.00258207161733   0.00262970287794
 -0.01789929502880   0.04909955105920  -0.00142614722323
 -0.01633264920752  -0.02394789542816  -0.04402965605632
  0.05200731417247   0.00258217638575  -0.00262989393252
 -0.00807947640419   0.02196618871520  -0.00000016730114
 -0.04212232805466   0.11275515156773  -0.00000017227574
  0.01329309303136   0.01619292086509   0.03127919421621
  0.01329222270725   0.01619364815450  -0.03127970159563
  0.30671630468164  -0.85568546716384  -0.00000030291845
Time for calculating nonlocal force components: 35.998 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00611359912628  -0.01645780192992  -0.00000002147567
[0m[32m -0.00333060736017   0.00365529436839  -0.00000001936464
[0m[32m  0.00101711348076   0.00134567225312   0.00233874012080
[0m[32m  0.00101709744092   0.00134570274506  -0.00233876350001
[0m[32m  0.00455039896507  -0.01263340740324  -0.00000000906928
[0mTime for calculating XC forces components: 39.465 ms
 Cartesian force = 
 -0.00378418168809  -0.00029405700433   0.00000009528484
 -0.00057522768427   0.00236569098994   0.00041477023289
 -0.00054232635543  -0.00071987422067   0.00241633407593
  0.00203144406396   0.00052881860023   0.00066598511613
 -0.00057540010690   0.00236567952583  -0.00041450552943
 -0.00054239311717  -0.00071979727179  -0.00241626522977
  0.00203177816651   0.00052891022128  -0.00066599756075
 -0.00196169323141   0.00170119598157  -0.00000026446810
  0.00480206718329  -0.00653986306424  -0.00000023616613
 -0.00032050611928   0.00011936511479   0.00161045819918
 -0.00032154323716   0.00011988786168  -0.00161037799585
 -0.00024201787403   0.00054404326572   0.00000000404107
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Time for printing density: 393.876 ms
The program took 442.585 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:41
Job ID:        2266767
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:30:36,vmem=8440K,walltime=00:07:33,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-004-7-1
---------------------------------------
