---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:18
Job ID:    2266656
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:23
Job ID:    2266656
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.074 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.005 ms
Reading input file sprc-calc.inpt

Reading input file took 1.405 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 8.
[32m
Time for finding element is 0.008 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 0.751 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 10.944 ms

Freeing SPARC_INPUT_MPI datatype took 0.015 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.993 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.171 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.196887	   12.742197	   10.000000	
    7.471607	    9.488228	   10.000000	
   13.685552	    9.329920	   10.000000	
   11.595849	    7.257803	   11.664144	
   11.595849	    7.257803	    8.335856	
    6.314448	   10.908004	   10.000000	
   11.819302	    8.463171	   10.000000	
    9.825210	   10.497845	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.383 ms
Set up communicators.

--set up spincomm took 2.158 ms

--set up kptcomm took 0.360 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 19, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 19 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 19, mbQ = nbQ = 64
rank = 0, nr_Hp = 19, nc_Hp = 19
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.296 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.720 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.081 ms

Calculate_SplineDerivRadFun took 0.231 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.790 ms.
time spent on vectorized spline interp: 3.191 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.744 ms.
time spent on vectorized spline interp: 1.396 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.311 ms.
time spent on vectorized spline interp: 1.705 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.536 ms.

Calculating rb for all atom types took 15.685 ms
----------------------
Estimated memory usage
Total: 1.16 GB
orbitals             : 869.75 MB
global sized vectors : 213.62 MB
subspace matrices : 8.46 kB
others : 108.34 MB
----------------------------------------------
Estimated memory usage per processor: 99.31 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.832 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.015 ms
Calculating pseudocharge density ... 
the global sum of int_b = -24.0000000231398, sum_int_rho = 23.5968527779260
PosCharge = 24.000000023140, NegCharge = -23.596852777926, scal_fac = 1.017084788764
After scaling, int_rho = 24.0000000231398, PosCharge + NegCharge - NetCharge = 7.105e-15
--Calculate Vref took 0.511 ms
--Calculate rho_guess took 2.446 ms

 integral of b = -24.0000000231398,
 int{b} + Nelectron + NetCharge = -2.314e-08,
 Esc = -74.5467365797321,
 MPI_Reduce took 7.730 ms

Calculating b & b_ref took 16.849 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.106 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.120 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.091 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.593 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.687 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313979, int_b + int_rho = 2.910e-14, checking this took 0.579 ms
2-norm of RHS = 697.1638597969305, which took 0.469 ms

iter_count = 420, r_2norm = 5.962e-04, tol*||rhs|| = 6.972e-04

Anderson update took 231.022 ms, out of which F'*F took 105.626 ms; b-Ax took 711.236 ms, out of which Lap took 638.240 ms
Solving Poisson took 1512.831 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.402 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
Total time for convolution: 	 convolve: 5.123317 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 107.465 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
Total time for convolution: 	 convolve: 5.172687 
Total time for convolution: 	 convolve: 5.180629 
Total time for convolution: 	 convolve: 5.260831 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 2.148 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.480 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.237 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
rank = 0, XC calculation took 24773.875 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 4.905 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.821 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 15.850 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.143 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.667 ms
    Lanczos iter 53, eigmin  = -1.066707598, eigmax = 264.929888028, err_eigmin = 1.438e-03, err_eigmax = 9.587e-03
rank =   0, Lanczos took 119.773 ms, eigmin = -1.066707597598, eigmax = 267.579186908236

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.206240, lowerbound = -1.166708, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1434.492 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.323 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.709 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.055 ms
rank =  0, finding HY took 24.320 ms
rank =  0, distributing HY into block cyclic form took 20.807 ms
rank =  0, finding Y'*HY took 3.987 ms
Rank 0, Project_Hamiltonian used 71.198 ms
Total time for projection: 71.927 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.306 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.392 ms
rank = 0, Solve_Generalized_EigenProblem used 1.705 ms
    first calculated eigval = 2.756178228076062
    last  calculated eigval = 3.247490466392381
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =   2.81626796008250
lambda[   4] =   2.83034873223332
lambda[   5] =   2.84930815209018
lambda[   6] =   2.91952424181298
lambda[   7] =   2.93088097200134
lambda[   8] =   2.97024753448849
lambda[   9] =   2.98403590249049
lambda[  10] =   3.00538563444430
lambda[  11] =   3.02626599594247
lambda[  12] =   3.03887198256224
lambda[  13] =   3.08827963938330
lambda[  14] =   3.11624618485840
lambda[  15] =   3.12937370668760
lambda[  16] =   3.14263011550136
lambda[  17] =   3.18528156715042
lambda[  18] =   3.21842768758206
lambda[  19] =   3.24749046639238
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.723 ms
rank =  0, subspace rotation using ScaLAPACK took 7.075 ms
rank =  0, Distributing orbital back into band + domain format took 17.684 ms
rank = 0, Subspace_Rotation used 24.776 ms

Total time for subspace rotation: 24.780 ms
rank = 0, Efermi =   3.063581884848 calculate fermi energy took 0.054 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.347490, lowerbound = -1.166708, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1459.214 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.109 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.551 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.677 ms
rank =  0, finding HY took 23.633 ms
rank =  0, distributing HY into block cyclic form took 17.235 ms
rank =  0, finding Y'*HY took 3.529 ms
Rank 0, Project_Hamiltonian used 64.104 ms
Total time for projection: 64.115 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.214 ms
    first calculated eigval = -0.892898325794812
    last  calculated eigval = 0.442383350340695
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.57733438422621
lambda[   4] =  -0.27851786909263
lambda[   5] =  -0.23415150912687
lambda[   6] =  -0.14991348624457
lambda[   7] =  -0.08463208013030
lambda[   8] =   0.00200644703034
lambda[   9] =   0.04736972488682
lambda[  10] =   0.15134518271210
lambda[  11] =   0.20244456214002
lambda[  12] =   0.27189079112779
lambda[  13] =   0.28177263913879
lambda[  14] =   0.31597044320425
lambda[  15] =   0.33914580007123
lambda[  16] =   0.35696729223484
lambda[  17] =   0.38520020418576
lambda[  18] =   0.39721145345557
lambda[  19] =   0.44238335034069
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 7.033 ms
rank =  0, Distributing orbital back into band + domain format took 17.393 ms
rank = 0, Subspace_Rotation used 24.442 ms

Total time for subspace rotation: 24.446 ms
rank = 0, Efermi =   0.276831715252 calculate fermi energy took 0.023 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.542383, lowerbound = -1.166708, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1452.521 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.201 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.819 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.449 ms
rank =  0, finding HY took 23.450 ms
rank =  0, distributing HY into block cyclic form took 17.274 ms
rank =  0, finding Y'*HY took 3.551 ms
Rank 0, Project_Hamiltonian used 64.754 ms
Total time for projection: 64.758 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -1.077135447326459
    last  calculated eigval = 0.156096100659575
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.80784019818811
lambda[   4] =  -0.61795079563901
lambda[   5] =  -0.53269347133688
lambda[   6] =  -0.50231714595942
lambda[   7] =  -0.50090444296235
lambda[   8] =  -0.48053344974860
lambda[   9] =  -0.41821379029549
lambda[  10] =  -0.40403441535246
lambda[  11] =  -0.33076383245845
lambda[  12] =  -0.28493608053588
lambda[  13] =  -0.03431225928284
lambda[  14] =   0.02800250224001
lambda[  15] =   0.08124132508981
lambda[  16] =   0.09141844646754
lambda[  17] =   0.10610285069101
lambda[  18] =   0.12174897210601
lambda[  19] =   0.15609610065957
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 7.012 ms
rank =  0, Distributing orbital back into band + domain format took 17.285 ms
rank = 0, Subspace_Rotation used 24.315 ms

Total time for subspace rotation: 24.319 ms
rank = 0, Efermi =  -0.063347220534 calculate fermi energy took 0.022 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.256096, lowerbound = -1.166708, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1460.441 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.206 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.563 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.798 ms
rank =  0, finding HY took 23.590 ms
rank =  0, distributing HY into block cyclic form took 17.151 ms
rank =  0, finding Y'*HY took 3.550 ms
Rank 0, Project_Hamiltonian used 64.116 ms
Total time for projection: 64.121 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.213 ms
    first calculated eigval = -1.077275572835082
    last  calculated eigval = 0.091875336594544
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.80845831669526
lambda[   4] =  -0.62173362339374
lambda[   5] =  -0.53630901457435
lambda[   6] =  -0.51544175579642
lambda[   7] =  -0.50338635269800
lambda[   8] =  -0.48447093149894
lambda[   9] =  -0.42644273087949
lambda[  10] =  -0.42602933138920
lambda[  11] =  -0.34562085762824
lambda[  12] =  -0.32186779621261
lambda[  13] =  -0.07740973500896
lambda[  14] =  -0.01829052752563
lambda[  15] =   0.03583322469658
lambda[  16] =   0.05023165167040
lambda[  17] =   0.06067075570480
lambda[  18] =   0.07166041063731
lambda[  19] =   0.09187533659454
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 7.033 ms
rank =  0, Distributing orbital back into band + domain format took 17.513 ms
rank = 0, Subspace_Rotation used 24.563 ms

Total time for subspace rotation: 24.567 ms
rank = 0, Efermi =  -0.106444696211 calculate fermi energy took 0.026 ms
rank = 0, --- Calculate rho: sum over local bands took 5.149 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.721 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.568 ms
rank = 0, Calculating density took 6311.688 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.817 ms
rank = 0, D2D took 1.931 ms
rank = 0, Transfering density took 1.938 ms
Etot    =   -47.633978060389
Eband   =   -14.142142053732
E1      =    27.417372160878
E2      =   -12.015172907464
E3      =   -15.239409931404
Exc     =   -13.617054425979
Esc     =   -74.546736579732
Entropy =    -0.000000000692
dE = 5.954e+00, dEband = 1.768e+00
rank = 0, Calculating/Estimating energy took 0.916 ms, Etot = -47.633978060, dEtot = 5.954e+00, dEband = 1.768e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 59.0696537495360, which took 0.687 ms

iter_count = 96, r_2norm = 1.547e-03, tol*||rhs|| = 2.363e-03

Anderson update took 52.150 ms, out of which F'*F took 24.168 ms; b-Ax took 162.139 ms, out of which Lap took 145.549 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.265 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313974, int_b + int_rho = -2.547e-14, checking this took 0.107 ms
2-norm of RHS = 692.9612820040180, which took 0.221 ms

iter_count = 282, r_2norm = 6.868e-04, tol*||rhs|| = 6.930e-04

Anderson update took 153.780 ms, out of which F'*F took 70.610 ms; b-Ax took 474.821 ms, out of which Lap took 425.735 ms
Solving Poisson took 1016.562 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.396 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.270037 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.238288 
Total time for convolution: 	 convolve: 5.210527 
Total time for convolution: 	 convolve: 5.273879 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.208 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 3.507 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.795 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.336 ms

This SCF took 32673.466 ms, scf error = 1.441e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.191875, lowerbound = -1.077276, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1444.558 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.160 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.572 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.748 ms
rank =  0, finding HY took 23.183 ms
rank =  0, distributing HY into block cyclic form took 20.356 ms
rank =  0, finding Y'*HY took 3.530 ms
Rank 0, Project_Hamiltonian used 66.849 ms
Total time for projection: 66.860 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.104 ms
rank = 0, Solve_Generalized_EigenProblem used 0.234 ms
    first calculated eigval = -1.055818907335563
    last  calculated eigval = 0.069208132117313
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.77174191683417
lambda[   4] =  -0.60126953900826
lambda[   5] =  -0.50494207898330
lambda[   6] =  -0.48419176280464
lambda[   7] =  -0.47416418320019
lambda[   8] =  -0.44953102136203
lambda[   9] =  -0.40443752946546
lambda[  10] =  -0.39723242383802
lambda[  11] =  -0.31829518914094
lambda[  12] =  -0.28601280831943
lambda[  13] =  -0.07103978028680
lambda[  14] =  -0.03291918012498
lambda[  15] =   0.01295050579921
lambda[  16] =   0.02901357350278
lambda[  17] =   0.03894321994785
lambda[  18] =   0.04341684691810
lambda[  19] =   0.06920813211731
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.249 ms
rank =  0, subspace rotation using ScaLAPACK took 7.393 ms
rank =  0, Distributing orbital back into band + domain format took 17.264 ms
rank = 0, Subspace_Rotation used 24.672 ms

Total time for subspace rotation: 24.677 ms
rank = 0, Efermi =  -0.100074741533 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.230 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.390 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.596 ms
rank = 0, Calculating density took 1552.699 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.829 ms
rank = 0, D2D took 1.930 ms
rank = 0, Transfering density took 1.932 ms
Etot    =   -47.569273180738
Eband   =   -13.449947563281
E1      =    26.842825627623
E2      =   -11.922762712775
E3      =   -15.430311186082
Exc     =   -13.768488563513
Esc     =   -74.546736579732
Entropy =    -0.000000000692
dE = 8.088e-03, dEband = 8.652e-02
rank = 0, Calculating/Estimating energy took 0.927 ms, Etot = -47.569273181, dEtot = 8.088e-03, dEband = 8.652e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 28.1371987905633, which took 0.068 ms

iter_count = 96, r_2norm = 1.112e-03, tol*||rhs|| = 1.125e-03

Anderson update took 51.690 ms, out of which F'*F took 24.129 ms; b-Ax took 162.520 ms, out of which Lap took 145.172 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.805 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313978, int_b + int_rho = 2.183e-14, checking this took 0.112 ms
2-norm of RHS = 689.8510785961597, which took 0.139 ms

iter_count = 294, r_2norm = 5.641e-04, tol*||rhs|| = 6.899e-04

Anderson update took 156.972 ms, out of which F'*F took 73.281 ms; b-Ax took 505.654 ms, out of which Lap took 454.900 ms
Solving Poisson took 1060.605 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.185384 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.252636 
Total time for convolution: 	 convolve: 5.188839 
Total time for convolution: 	 convolve: 5.205638 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.538 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.891 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.466 ms

This SCF took 27861.810 ms, scf error = 9.135e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.169208, lowerbound = -1.055819, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1403.911 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.248 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.798 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.061 ms
rank =  0, finding HY took 24.371 ms
rank =  0, distributing HY into block cyclic form took 17.743 ms
rank =  0, finding Y'*HY took 3.741 ms
Rank 0, Project_Hamiltonian used 65.953 ms
Total time for projection: 65.965 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -1.034687759826143
    last  calculated eigval = 0.061258846775362
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.72692935760343
lambda[   4] =  -0.57614523581889
lambda[   5] =  -0.46874617709068
lambda[   6] =  -0.44932106804995
lambda[   7] =  -0.44458541080073
lambda[   8] =  -0.40623594578937
lambda[   9] =  -0.37668226637196
lambda[  10] =  -0.36741509778204
lambda[  11] =  -0.29498653434363
lambda[  12] =  -0.25422487030163
lambda[  13] =  -0.05575374229182
lambda[  14] =  -0.03564740789928
lambda[  15] =   0.00585924201725
lambda[  16] =   0.02206849667961
lambda[  17] =   0.02946319859368
lambda[  18] =   0.03545941950480
lambda[  19] =   0.06125884677536
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.228 ms
rank =  0, subspace rotation using ScaLAPACK took 7.902 ms
rank =  0, Distributing orbital back into band + domain format took 17.168 ms
rank = 0, Subspace_Rotation used 25.090 ms

Total time for subspace rotation: 25.098 ms
rank = 0, Efermi =  -0.084788703558 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.302 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.409 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.608 ms
rank = 0, Calculating density took 1512.352 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.826 ms
rank = 0, D2D took 1.928 ms
rank = 0, Transfering density took 1.934 ms
Etot    =   -47.536350414658
Eband   =   -12.702212387042
E1      =    26.236681970466
E2      =   -11.767868346441
E3      =   -15.653567905002
Exc     =   -13.945519669102
Esc     =   -74.546736579732
Entropy =    -0.000000000692
dE = 4.115e-03, dEband = 9.347e-02
rank = 0, Calculating/Estimating energy took 0.934 ms, Etot = -47.536350415, dEtot = 4.115e-03, dEband = 9.347e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 6.2159423470024, which took 0.601 ms

iter_count = 102, r_2norm = 2.471e-04, tol*||rhs|| = 2.486e-04

Anderson update took 54.743 ms, out of which F'*F took 25.553 ms; b-Ax took 171.796 ms, out of which Lap took 154.509 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 377.859 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313985, int_b + int_rho = 8.731e-14, checking this took 0.103 ms
2-norm of RHS = 690.1218244047674, which took 0.111 ms

iter_count = 288, r_2norm = 5.415e-04, tol*||rhs|| = 6.901e-04

Anderson update took 154.285 ms, out of which F'*F took 76.322 ms; b-Ax took 493.485 ms, out of which Lap took 443.861 ms
Solving Poisson took 1038.025 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.198660 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.177170 
Total time for convolution: 	 convolve: 5.186707 
Total time for convolution: 	 convolve: 5.187873 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.348 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 3.518 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.864 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.413 ms

This SCF took 28603.731 ms, scf error = 4.396e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.161259, lowerbound = -1.034688, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1410.900 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.191 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.476 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.686 ms
rank =  0, finding HY took 23.124 ms
rank =  0, distributing HY into block cyclic form took 17.371 ms
rank =  0, finding Y'*HY took 3.549 ms
Rank 0, Project_Hamiltonian used 63.762 ms
Total time for projection: 63.773 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.692 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.294 ms
rank = 0, Solve_Generalized_EigenProblem used 0.996 ms
    first calculated eigval = -1.025695825404827
    last  calculated eigval = 0.056487945374347
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.70026411512311
lambda[   4] =  -0.56261140666888
lambda[   5] =  -0.44832334555228
lambda[   6] =  -0.43223443840184
lambda[   7] =  -0.43062894583784
lambda[   8] =  -0.37886689805693
lambda[   9] =  -0.35841311376241
lambda[  10] =  -0.35504145983722
lambda[  11] =  -0.29018539589108
lambda[  12] =  -0.24410875826085
lambda[  13] =  -0.04353087290053
lambda[  14] =  -0.03607448824370
lambda[  15] =   0.00348043902383
lambda[  16] =   0.01917268673617
lambda[  17] =   0.02519831524001
lambda[  18] =   0.03094213035184
lambda[  19] =   0.05648794537435
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.709 ms
rank =  0, subspace rotation using ScaLAPACK took 7.386 ms
rank =  0, Distributing orbital back into band + domain format took 17.074 ms
rank = 0, Subspace_Rotation used 24.477 ms

Total time for subspace rotation: 24.482 ms
rank = 0, Efermi =  -0.072565919712 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.339 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.370 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.602 ms
rank = 0, Calculating density took 1518.305 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.993 ms
rank = 0, D2D took 2.102 ms
rank = 0, Transfering density took 2.109 ms
Etot    =   -47.528471703716
Eband   =   -12.335405854098
E1      =    25.980149752985
E2      =   -11.639108270861
E3      =   -15.773019760313
Exc     =   -14.038607053353
Esc     =   -74.546736579732
Entropy =    -0.000000000692
dE = 9.848e-04, dEband = 4.585e-02
rank = 0, Calculating/Estimating energy took 0.904 ms, Etot = -47.528471704, dEtot = 9.848e-04, dEband = 4.585e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.9121056566997, which took 0.062 ms

iter_count = 108, r_2norm = 7.891e-05, tol*||rhs|| = 1.165e-04

Anderson update took 58.178 ms, out of which F'*F took 27.536 ms; b-Ax took 184.997 ms, out of which Lap took 166.924 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.319 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313982, int_b + int_rho = 5.093e-14, checking this took 0.104 ms
2-norm of RHS = 690.4732550282926, which took 0.152 ms

iter_count = 258, r_2norm = 6.012e-04, tol*||rhs|| = 6.905e-04

Anderson update took 137.662 ms, out of which F'*F took 64.584 ms; b-Ax took 454.842 ms, out of which Lap took 408.981 ms
Solving Poisson took 940.617 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.220392 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.165 ms
Total time for convolution: 	 convolve: 5.191908 
Total time for convolution: 	 convolve: 5.187411 
Total time for convolution: 	 convolve: 5.286618 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.526 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.522 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.086 ms

This SCF took 27940.272 ms, scf error = 1.235e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.156488, lowerbound = -1.025696, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1414.650 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.169 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.548 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.741 ms
rank =  0, finding HY took 22.827 ms
rank =  0, distributing HY into block cyclic form took 17.191 ms
rank =  0, finding Y'*HY took 3.820 ms
Rank 0, Project_Hamiltonian used 64.617 ms
Total time for projection: 64.634 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.197 ms
    first calculated eigval = -1.022816741278566
    last  calculated eigval = 0.052598271425097
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.69606029900008
lambda[   4] =  -0.56008027935914
lambda[   5] =  -0.44308519498966
lambda[   6] =  -0.42843974371975
lambda[   7] =  -0.42693131795891
lambda[   8] =  -0.37335078492068
lambda[   9] =  -0.35404533231828
lambda[  10] =  -0.35138832585223
lambda[  11] =  -0.28681099003007
lambda[  12] =  -0.23853990869129
lambda[  13] =  -0.03986285235847
lambda[  14] =  -0.03624734212095
lambda[  15] =   0.00219802242765
lambda[  16] =   0.01799767812899
lambda[  17] =   0.02394486592360
lambda[  18] =   0.02712540157348
lambda[  19] =   0.05259827142510
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 7.456 ms
rank =  0, Distributing orbital back into band + domain format took 16.991 ms
rank = 0, Subspace_Rotation used 24.464 ms

Total time for subspace rotation: 24.469 ms
rank = 0, Efermi =  -0.068910706214 calculate fermi energy took 0.609 ms
rank = 0, --- Calculate rho: sum over local bands took 5.353 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.391 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.566 ms
rank = 0, Calculating density took 1520.961 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.806 ms
rank = 0, D2D took 1.916 ms
rank = 0, Transfering density took 1.924 ms
Etot    =   -47.527483974243
Eband   =   -12.236750793256
E1      =    25.929226059836
E2      =   -11.584388025799
E3      =   -15.802690602530
Exc     =   -14.060301288727
Esc     =   -74.546736579732
Entropy =    -0.000000000694
dE = 1.235e-04, dEband = 1.233e-02
rank = 0, Calculating/Estimating energy took 1.566 ms, Etot = -47.527483974, dEtot = 1.235e-04, dEband = 1.233e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.3234259433365, which took 0.055 ms

iter_count = 108, r_2norm = 4.580e-05, tol*||rhs|| = 5.294e-05

Anderson update took 58.007 ms, out of which F'*F took 27.340 ms; b-Ax took 182.591 ms, out of which Lap took 164.037 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.140 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313989, int_b + int_rho = 1.310e-13, checking this took 0.092 ms
2-norm of RHS = 690.7579392390703, which took 0.163 ms

iter_count = 234, r_2norm = 6.537e-04, tol*||rhs|| = 6.908e-04

Anderson update took 126.399 ms, out of which F'*F took 59.363 ms; b-Ax took 399.232 ms, out of which Lap took 357.813 ms
Solving Poisson took 841.717 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.168 ms
Total time for convolution: 	 convolve: 5.197702 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.186890 
Total time for convolution: 	 convolve: 5.205766 
Total time for convolution: 	 convolve: 5.170635 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.361 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.550 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.973 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.559 ms

This SCF took 27539.946 ms, scf error = 5.630e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.152598, lowerbound = -1.022817, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1410.300 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.284 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.550 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.853 ms
rank =  0, finding HY took 23.278 ms
rank =  0, distributing HY into block cyclic form took 17.192 ms
rank =  0, finding Y'*HY took 3.549 ms
Rank 0, Project_Hamiltonian used 63.903 ms
Total time for projection: 63.913 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -1.021704686872714
    last  calculated eigval = 0.049354079828316
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.69443264705275
lambda[   4] =  -0.55884685210110
lambda[   5] =  -0.44168701214425
lambda[   6] =  -0.42728688359592
lambda[   7] =  -0.42555871212817
lambda[   8] =  -0.37148544826749
lambda[   9] =  -0.35256661270839
lambda[  10] =  -0.35029520115023
lambda[  11] =  -0.28582841135366
lambda[  12] =  -0.23760431797089
lambda[  13] =  -0.03863698631572
lambda[  14] =  -0.03610474907135
lambda[  15] =   0.00147310861160
lambda[  16] =   0.01778452872560
lambda[  17] =   0.02378265132674
lambda[  18] =   0.02478945475974
lambda[  19] =   0.04935407982832
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.227 ms
rank =  0, subspace rotation using ScaLAPACK took 7.378 ms
rank =  0, Distributing orbital back into band + domain format took 17.073 ms
rank = 0, Subspace_Rotation used 24.466 ms

Total time for subspace rotation: 24.471 ms
rank = 0, Efermi =  -0.067719141974 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.310 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.512 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.563 ms
rank = 0, Calculating density took 1515.408 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.824 ms
rank = 0, D2D took 1.920 ms
rank = 0, Transfering density took 1.923 ms
Etot    =   -47.527298771681
Eband   =   -12.206360313619
E1      =    25.921342236579
E2      =   -11.560291641307
E3      =   -15.807113079207
Exc     =   -14.062948834726
Esc     =   -74.546736579732
Entropy =    -0.000000000696
dE = 2.315e-05, dEband = 3.799e-03
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -47.527298772, dEtot = 2.315e-05, dEband = 3.799e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6523461824067, which took 0.056 ms

iter_count = 108, r_2norm = 2.133e-05, tol*||rhs|| = 2.609e-05

Anderson update took 57.751 ms, out of which F'*F took 27.217 ms; b-Ax took 183.660 ms, out of which Lap took 164.761 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.297 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313981, int_b + int_rho = 4.729e-14, checking this took 0.104 ms
2-norm of RHS = 690.9990400250180, which took 0.130 ms

iter_count = 246, r_2norm = 6.490e-04, tol*||rhs|| = 6.910e-04

Anderson update took 131.787 ms, out of which F'*F took 62.237 ms; b-Ax took 418.731 ms, out of which Lap took 375.550 ms
Solving Poisson took 884.648 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.193333 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.180187 
Total time for convolution: 	 convolve: 5.172267 
Total time for convolution: 	 convolve: 5.187727 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.029 ms
---Transfer Veff_loc: D2D took 4.274 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.294 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.607 ms

This SCF took 27548.999 ms, scf error = 3.467e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.149354, lowerbound = -1.021705, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1418.734 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.274 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.500 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.794 ms
rank =  0, finding HY took 23.126 ms
rank =  0, distributing HY into block cyclic form took 17.278 ms
rank =  0, finding Y'*HY took 3.510 ms
Rank 0, Project_Hamiltonian used 63.743 ms
Total time for projection: 63.754 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -1.019445485429570
    last  calculated eigval = 0.046739135423569
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.69054980640268
lambda[   4] =  -0.55639056911599
lambda[   5] =  -0.43817665599839
lambda[   6] =  -0.42452009118641
lambda[   7] =  -0.42261558698213
lambda[   8] =  -0.36722365266305
lambda[   9] =  -0.34915343070505
lambda[  10] =  -0.34750777397617
lambda[  11] =  -0.28337302656619
lambda[  12] =  -0.23449831228441
lambda[  13] =  -0.03613593576225
lambda[  14] =  -0.03529350750767
lambda[  15] =   0.00176959402331
lambda[  16] =   0.01897756824946
lambda[  17] =   0.02346670594183
lambda[  18] =   0.02566042697300
lambda[  19] =   0.04673913542357
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 7.380 ms
rank =  0, Distributing orbital back into band + domain format took 16.959 ms
rank = 0, Subspace_Rotation used 24.352 ms

Total time for subspace rotation: 24.357 ms
rank = 0, Efermi =  -0.065463559327 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.318 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.498 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.561 ms
rank = 0, Calculating density took 1523.556 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.806 ms
rank = 0, D2D took 1.901 ms
rank = 0, Transfering density took 1.903 ms
Etot    =   -47.527085088774
Eband   =   -12.133378526348
E1      =    25.886422901618
E2      =   -11.518499326342
E3      =   -15.820643306969
Exc     =   -14.072535516919
Esc     =   -74.546736579732
Entropy =    -0.000000000704
dE = 2.671e-05, dEband = 9.123e-03
rank = 0, Calculating/Estimating energy took 0.937 ms, Etot = -47.527085089, dEtot = 2.671e-05, dEband = 9.123e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3022007164818, which took 0.051 ms

iter_count = 114, r_2norm = 7.541e-06, tol*||rhs|| = 1.209e-05

Anderson update took 61.293 ms, out of which F'*F took 28.511 ms; b-Ax took 191.090 ms, out of which Lap took 171.588 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.443 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313993, int_b + int_rho = 1.637e-13, checking this took 0.098 ms
2-norm of RHS = 691.0872316134239, which took 0.134 ms

iter_count = 228, r_2norm = 6.599e-04, tol*||rhs|| = 6.911e-04

Anderson update took 123.266 ms, out of which F'*F took 57.675 ms; b-Ax took 386.455 ms, out of which Lap took 347.346 ms
Solving Poisson took 818.917 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.165712 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 106.321 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.195772 
Total time for convolution: 	 convolve: 5.176323 
Total time for convolution: 	 convolve: 5.167451 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.344 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.217 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.398 ms
---Transfer Veff_loc: D2D took 3.498 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.973 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.507 ms

This SCF took 27627.143 ms, scf error = 1.843e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.146739, lowerbound = -1.019445, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1412.901 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.176 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.531 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.727 ms
rank =  0, finding HY took 23.067 ms
rank =  0, distributing HY into block cyclic form took 17.224 ms
rank =  0, finding Y'*HY took 3.547 ms
Rank 0, Project_Hamiltonian used 63.596 ms
Total time for projection: 63.608 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -1.018321484143221
    last  calculated eigval = 0.044377616137134
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.68824646156427
lambda[   4] =  -0.55512083851344
lambda[   5] =  -0.43624452048549
lambda[   6] =  -0.42311891259419
lambda[   7] =  -0.42087878602288
lambda[   8] =  -0.36492412232554
lambda[   9] =  -0.34732291694298
lambda[  10] =  -0.34610758857596
lambda[  11] =  -0.28231690846338
lambda[  12] =  -0.23300425897218
lambda[  13] =  -0.03449168823109
lambda[  14] =  -0.03420545691087
lambda[  15] =   0.00260864760092
lambda[  16] =   0.02064928225900
lambda[  17] =   0.02338499952519
lambda[  18] =   0.02791793834761
lambda[  19] =   0.04437761613713
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 7.399 ms
rank =  0, Distributing orbital back into band + domain format took 16.956 ms
rank = 0, Subspace_Rotation used 24.371 ms

Total time for subspace rotation: 24.377 ms
rank = 0, Efermi =  -0.064014363745 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.298 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.537 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.555 ms
rank = 0, Calculating density took 1517.631 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.809 ms
rank = 0, D2D took 1.912 ms
rank = 0, Transfering density took 1.915 ms
Etot    =   -47.527056241886
Eband   =   -12.095069602789
E1      =    25.868640847735
E2      =   -11.496972600550
E3      =   -15.823995656487
Exc     =   -14.074859163431
Esc     =   -74.546736579732
Entropy =    -0.000000000706
dE = 3.606e-06, dEband = 4.789e-03
rank = 0, Calculating/Estimating energy took 1.823 ms, Etot = -47.527056242, dEtot = 3.606e-06, dEband = 4.789e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1738384849782, which took 0.053 ms

iter_count = 114, r_2norm = 4.272e-06, tol*||rhs|| = 6.954e-06

Anderson update took 61.303 ms, out of which F'*F took 28.710 ms; b-Ax took 192.595 ms, out of which Lap took 172.996 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.642 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313984, int_b + int_rho = 7.640e-14, checking this took 0.116 ms
2-norm of RHS = 691.0711721466590, which took 0.111 ms

iter_count = 222, r_2norm = 6.892e-04, tol*||rhs|| = 6.911e-04

Anderson update took 118.883 ms, out of which F'*F took 55.575 ms; b-Ax took 376.581 ms, out of which Lap took 336.685 ms
Solving Poisson took 796.348 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.278652 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.249955 
Total time for convolution: 	 convolve: 5.171962 
Total time for convolution: 	 convolve: 5.189878 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.173 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.184 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.886 ms
---Transfer Veff_loc: D2D took 3.530 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.962 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.528 ms

This SCF took 27671.277 ms, scf error = 1.073e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.144378, lowerbound = -1.018321, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1409.172 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.246 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.552 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.818 ms
rank =  0, finding HY took 23.261 ms
rank =  0, distributing HY into block cyclic form took 17.292 ms
rank =  0, finding Y'*HY took 3.573 ms
Rank 0, Project_Hamiltonian used 63.979 ms
Total time for projection: 63.991 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -1.016898749212822
    last  calculated eigval = 0.043221990271371
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.68639847173995
lambda[   4] =  -0.55373416846240
lambda[   5] =  -0.43438803936230
lambda[   6] =  -0.42153302532288
lambda[   7] =  -0.41918834909679
lambda[   8] =  -0.36293186922290
lambda[   9] =  -0.34557434443184
lambda[  10] =  -0.34454969374349
lambda[  11] =  -0.28092032048495
lambda[  12] =  -0.23131061488518
lambda[  13] =  -0.03267165016848
lambda[  14] =  -0.03196548016986
lambda[  15] =   0.00523884504514
lambda[  16] =   0.02341041906235
lambda[  17] =   0.02574591480090
lambda[  18] =   0.03158140246079
lambda[  19] =   0.04322199027137
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 7.375 ms
rank =  0, Distributing orbital back into band + domain format took 17.168 ms
rank = 0, Subspace_Rotation used 24.558 ms

Total time for subspace rotation: 24.563 ms
rank = 0, Efermi =  -0.062040015979 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.219 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.567 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.561 ms
rank = 0, Calculating density took 1514.422 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.683 ms
rank = 0, D2D took 2.780 ms
rank = 0, Transfering density took 2.783 ms
Etot    =   -47.527063139704
Eband   =   -12.055443779593
E1      =    25.848330901325
E2      =   -11.476737583174
E3      =   -15.827760887193
Exc     =   -14.077712151367
Esc     =   -74.546736579732
Entropy =    -0.000000000705
dE = 8.622e-07, dEband = 4.953e-03
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -47.527063140, dEtot = 8.622e-07, dEband = 4.953e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1466882077602, which took 0.299 ms

iter_count = 108, r_2norm = 5.031e-06, tol*||rhs|| = 5.868e-06

Anderson update took 58.006 ms, out of which F'*F took 27.354 ms; b-Ax took 184.539 ms, out of which Lap took 165.616 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.325 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313982, int_b + int_rho = 5.821e-14, checking this took 0.115 ms
2-norm of RHS = 691.0568973677542, which took 0.126 ms

iter_count = 198, r_2norm = 6.411e-04, tol*||rhs|| = 6.911e-04

Anderson update took 106.159 ms, out of which F'*F took 49.470 ms; b-Ax took 335.217 ms, out of which Lap took 299.970 ms
Solving Poisson took 710.606 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.209663 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.188165 
Total time for convolution: 	 convolve: 5.194818 
Total time for convolution: 	 convolve: 5.218865 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.588 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.868 ms
---Transfer Veff_loc: D2D took 3.481 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.966 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.483 ms

This SCF took 27459.822 ms, scf error = 6.239e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.143222, lowerbound = -1.016899, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1414.448 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.252 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.498 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.771 ms
rank =  0, finding HY took 23.118 ms
rank =  0, distributing HY into block cyclic form took 17.395 ms
rank =  0, finding Y'*HY took 3.549 ms
Rank 0, Project_Hamiltonian used 63.863 ms
Total time for projection: 63.874 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -1.016450279007828
    last  calculated eigval = 0.041254437111010
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.68570985297807
lambda[   4] =  -0.55322813424896
lambda[   5] =  -0.43382191038556
lambda[   6] =  -0.42103160718463
lambda[   7] =  -0.41862429909015
lambda[   8] =  -0.36220754243259
lambda[   9] =  -0.34493491446844
lambda[  10] =  -0.34404654209712
lambda[  11] =  -0.28043730730056
lambda[  12] =  -0.23080582277157
lambda[  13] =  -0.03217218475475
lambda[  14] =  -0.03062697389651
lambda[  15] =   0.00675559995270
lambda[  16] =   0.02458477845358
lambda[  17] =   0.02697704976351
lambda[  18] =   0.03165522597762
lambda[  19] =   0.04125443711101
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 7.379 ms
rank =  0, Distributing orbital back into band + domain format took 36.080 ms
rank = 0, Subspace_Rotation used 43.477 ms

Total time for subspace rotation: 43.481 ms
rank = 0, Efermi =  -0.061349855147 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 6.323 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.343 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.575 ms
rank = 0, Calculating density took 1539.246 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.820 ms
rank = 0, D2D took 1.915 ms
rank = 0, Transfering density took 1.923 ms
Etot    =   -47.527124350867
Eband   =   -12.042283071411
E1      =    25.841609417561
E2      =   -11.470188490561
E3      =   -15.828212186005
Exc     =   -14.078114793150
Esc     =   -74.546736579732
Entropy =    -0.000000000701
dE = 7.651e-06, dEband = 1.645e-03
rank = 0, Calculating/Estimating energy took 1.129 ms, Etot = -47.527124351, dEtot = 7.651e-06, dEband = 1.645e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0670001712047, which took 0.063 ms

iter_count = 114, r_2norm = 2.028e-06, tol*||rhs|| = 2.680e-06

Anderson update took 60.829 ms, out of which F'*F took 28.618 ms; b-Ax took 194.763 ms, out of which Lap took 175.542 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.496 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313976, int_b + int_rho = -7.276e-15, checking this took 0.113 ms
2-norm of RHS = 691.0673374742988, which took 0.141 ms

iter_count = 198, r_2norm = 5.685e-04, tol*||rhs|| = 6.911e-04

Anderson update took 105.872 ms, out of which F'*F took 49.556 ms; b-Ax took 335.468 ms, out of which Lap took 300.537 ms
Solving Poisson took 712.554 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Total time for convolution: 	 convolve: 5.197957 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 30.600 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.231866 
Total time for convolution: 	 convolve: 5.171121 
Total time for convolution: 	 convolve: 5.230852 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.719 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.588 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 3.536 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.164 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.738 ms

This SCF took 27553.499 ms, scf error = 4.674e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.141254, lowerbound = -1.016450, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1407.844 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.236 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.515 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.768 ms
rank =  0, finding HY took 23.063 ms
rank =  0, distributing HY into block cyclic form took 17.403 ms
rank =  0, finding Y'*HY took 3.647 ms
Rank 0, Project_Hamiltonian used 63.912 ms
Total time for projection: 63.924 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.107 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -1.015982928988524
    last  calculated eigval = 0.039947636608221
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.68504386137210
lambda[   4] =  -0.55272748427784
lambda[   5] =  -0.43321222766745
lambda[   6] =  -0.42053489042333
lambda[   7] =  -0.41802859566509
lambda[   8] =  -0.36146986142853
lambda[   9] =  -0.34428427968775
lambda[  10] =  -0.34355302456835
lambda[  11] =  -0.27996586228136
lambda[  12] =  -0.23026266659132
lambda[  13] =  -0.03159776141197
lambda[  14] =  -0.02864029483876
lambda[  15] =   0.00905222020655
lambda[  16] =   0.02619205080968
lambda[  17] =   0.02837163505258
lambda[  18] =   0.03241772222424
lambda[  19] =   0.03994763660822
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.244 ms
rank =  0, subspace rotation using ScaLAPACK took 7.363 ms
rank =  0, Distributing orbital back into band + domain format took 18.203 ms
rank = 0, Subspace_Rotation used 25.590 ms

Total time for subspace rotation: 25.595 ms
rank = 0, Efermi =  -0.060661315518 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.421 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.318 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.568 ms
rank = 0, Calculating density took 1514.062 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.828 ms
rank = 0, D2D took 1.941 ms
rank = 0, Transfering density took 1.946 ms
Etot    =   -47.527190673231
Eband   =   -12.028821541859
E1      =    25.835304525727
E2      =   -11.462787691093
E3      =   -15.829105714070
Exc     =   -14.078830481835
Esc     =   -74.546736579732
Entropy =    -0.000000000695
dE = 8.290e-06, dEband = 1.683e-03
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -47.527190673, dEtot = 8.290e-06, dEband = 1.683e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0683012798027, which took 0.066 ms

iter_count = 108, r_2norm = 2.730e-06, tol*||rhs|| = 2.732e-06

Anderson update took 57.795 ms, out of which F'*F took 26.881 ms; b-Ax took 182.780 ms, out of which Lap took 163.836 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.020 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313980, int_b + int_rho = 4.366e-14, checking this took 0.122 ms
2-norm of RHS = 691.0693943634981, which took 0.147 ms

iter_count = 174, r_2norm = 5.862e-04, tol*||rhs|| = 6.911e-04

Anderson update took 93.318 ms, out of which F'*F took 43.462 ms; b-Ax took 294.651 ms, out of which Lap took 264.288 ms
Solving Poisson took 625.396 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.194603 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 58.790 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.282993 
Total time for convolution: 	 convolve: 5.168529 
Total time for convolution: 	 convolve: 5.177802 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.490 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.975 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.501 ms

This SCF took 27453.404 ms, scf error = 3.037e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.139948, lowerbound = -1.015983, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1409.254 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.205 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.520 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.743 ms
rank =  0, finding HY took 23.183 ms
rank =  0, distributing HY into block cyclic form took 17.374 ms
rank =  0, finding Y'*HY took 3.646 ms
Rank 0, Project_Hamiltonian used 63.978 ms
Total time for projection: 63.990 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -1.015550442555793
    last  calculated eigval = 0.038823716484626
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.68454155317168
lambda[   4] =  -0.55230893387942
lambda[   5] =  -0.43275199926460
lambda[   6] =  -0.42011409393111
lambda[   7] =  -0.41757674814459
lambda[   8] =  -0.36099505182598
lambda[   9] =  -0.34383170199091
lambda[  10] =  -0.34313327654575
lambda[  11] =  -0.27956036538240
lambda[  12] =  -0.22983240861340
lambda[  13] =  -0.03120863889650
lambda[  14] =  -0.02767292963328
lambda[  15] =   0.00982642255813
lambda[  16] =   0.02635531976778
lambda[  17] =   0.02876376220594
lambda[  18] =   0.03227726951546
lambda[  19] =   0.03882371648463
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 7.391 ms
rank =  0, Distributing orbital back into band + domain format took 17.799 ms
rank = 0, Subspace_Rotation used 25.209 ms

Total time for subspace rotation: 25.215 ms
rank = 0, Efermi =  -0.060257817239 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.011 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.025 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.599 ms
rank = 0, Calculating density took 1515.476 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.848 ms
rank = 0, D2D took 1.945 ms
rank = 0, Transfering density took 1.953 ms
Etot    =   -47.527254264145
Eband   =   -12.018197913394
E1      =    25.829517808083
E2      =   -11.457673237226
E3      =   -15.830170549582
Exc     =   -14.079681365217
Esc     =   -74.546736579732
Entropy =    -0.000000000694
dE = 7.949e-06, dEband = 1.328e-03
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -47.527254264, dEtot = 7.949e-06, dEband = 1.328e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0515334734978, which took 0.089 ms

iter_count = 114, r_2norm = 1.289e-06, tol*||rhs|| = 2.061e-06

Anderson update took 61.237 ms, out of which F'*F took 28.457 ms; b-Ax took 191.946 ms, out of which Lap took 172.497 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.940 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313979, int_b + int_rho = 2.547e-14, checking this took 0.123 ms
2-norm of RHS = 691.0764205139134, which took 0.127 ms

iter_count = 162, r_2norm = 5.912e-04, tol*||rhs|| = 6.911e-04

Anderson update took 87.093 ms, out of which F'*F took 40.386 ms; b-Ax took 273.852 ms, out of which Lap took 245.455 ms
Solving Poisson took 583.452 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.196483 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.861 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.226265 
Total time for convolution: 	 convolve: 5.179430 
Total time for convolution: 	 convolve: 5.220614 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.538 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.959 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.534 ms

This SCF took 27749.424 ms, scf error = 2.172e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.138824, lowerbound = -1.015550, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1411.571 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.238 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.536 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.791 ms
rank =  0, finding HY took 23.107 ms
rank =  0, distributing HY into block cyclic form took 17.365 ms
rank =  0, finding Y'*HY took 3.606 ms
Rank 0, Project_Hamiltonian used 63.905 ms
Total time for projection: 63.916 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.634 ms
rank = 0, Solve_Generalized_EigenProblem used 1.149 ms
    first calculated eigval = -1.015238861138773
    last  calculated eigval = 0.038522428348057
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.68423666419298
lambda[   4] =  -0.55201999203554
lambda[   5] =  -0.43245642216135
lambda[   6] =  -0.41982587102190
lambda[   7] =  -0.41727303598885
lambda[   8] =  -0.36071284438703
lambda[   9] =  -0.34354334933756
lambda[  10] =  -0.34285088204641
lambda[  11] =  -0.27926940433063
lambda[  12] =  -0.22954281984354
lambda[  13] =  -0.03092058419617
lambda[  14] =  -0.02647279416317
lambda[  15] =   0.01083523571589
lambda[  16] =   0.02664560929191
lambda[  17] =   0.03000912312449
lambda[  18] =   0.03297488271989
lambda[  19] =   0.03852242834806
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 1.177 ms
rank =  0, subspace rotation using ScaLAPACK took 7.518 ms
rank =  0, Distributing orbital back into band + domain format took 16.992 ms
rank = 0, Subspace_Rotation used 24.529 ms

Total time for subspace rotation: 24.535 ms
rank = 0, Efermi =  -0.059960114828 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.483 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.267 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.612 ms
rank = 0, Calculating density took 1517.683 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.830 ms
rank = 0, D2D took 1.932 ms
rank = 0, Transfering density took 1.935 ms
Etot    =   -47.527288035745
Eband   =   -12.011130114325
E1      =    25.826022014932
E2      =   -11.453963418614
E3      =   -15.830659521727
Exc     =   -14.080066296268
Esc     =   -74.546736579732
Entropy =    -0.000000000693
dE = 4.221e-06, dEband = 8.835e-04
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -47.527288036, dEtot = 4.221e-06, dEband = 8.835e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0313062733598, which took 0.129 ms

iter_count = 114, r_2norm = 8.025e-07, tol*||rhs|| = 1.252e-06

Anderson update took 61.211 ms, out of which F'*F took 28.624 ms; b-Ax took 193.176 ms, out of which Lap took 173.648 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.148 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313984, int_b + int_rho = 7.276e-14, checking this took 0.106 ms
2-norm of RHS = 691.0851136243152, which took 0.117 ms

iter_count = 162, r_2norm = 5.721e-04, tol*||rhs|| = 6.911e-04

Anderson update took 86.844 ms, out of which F'*F took 40.418 ms; b-Ax took 274.212 ms, out of which Lap took 244.931 ms
Solving Poisson took 583.728 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.190557 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.752 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.248 ms
Total time for convolution: 	 convolve: 5.178306 
Total time for convolution: 	 convolve: 5.175778 
Total time for convolution: 	 convolve: 5.193396 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 3.509 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.976 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.522 ms

This SCF took 27314.049 ms, scf error = 1.597e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.138522, lowerbound = -1.015239, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1415.780 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.296 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.551 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.865 ms
rank =  0, finding HY took 23.206 ms
rank =  0, distributing HY into block cyclic form took 17.300 ms
rank =  0, finding Y'*HY took 3.758 ms
Rank 0, Project_Hamiltonian used 64.984 ms
Total time for projection: 64.999 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -1.015036914144260
    last  calculated eigval = 0.038879108500028
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.68407370522877
lambda[   4] =  -0.55183310812408
lambda[   5] =  -0.43228492232275
lambda[   6] =  -0.41964097354476
lambda[   7] =  -0.41708621466509
lambda[   8] =  -0.36056288027549
lambda[   9] =  -0.34337449564216
lambda[  10] =  -0.34267337835894
lambda[  11] =  -0.27907240495307
lambda[  12] =  -0.22936041123352
lambda[  13] =  -0.03074399464096
lambda[  14] =  -0.02528832480126
lambda[  15] =   0.01183873042571
lambda[  16] =   0.02701507595314
lambda[  17] =   0.03108895898796
lambda[  18] =   0.03345202920496
lambda[  19] =   0.03887910850003
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 7.363 ms
rank =  0, Distributing orbital back into band + domain format took 17.251 ms
rank = 0, Subspace_Rotation used 24.632 ms

Total time for subspace rotation: 24.637 ms
rank = 0, Efermi =  -0.059780208485 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 5.510 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.200 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.576 ms
rank = 0, Calculating density took 1522.144 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.827 ms
rank = 0, D2D took 1.934 ms
rank = 0, Transfering density took 1.940 ms
Etot    =   -47.527315377175
Eband   =   -12.006802781205
E1      =    25.824260355453
E2      =   -11.451379874417
E3      =   -15.830612545737
Exc     =   -14.080028791153
Esc     =   -74.546736579732
Entropy =    -0.000000000692
dE = 3.418e-06, dEband = 5.409e-04
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -47.527315377, dEtot = 3.418e-06, dEband = 5.409e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0242221437529, which took 0.052 ms

iter_count = 114, r_2norm = 6.450e-07, tol*||rhs|| = 9.689e-07

Anderson update took 61.417 ms, out of which F'*F took 28.496 ms; b-Ax took 192.949 ms, out of which Lap took 172.817 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.649 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313976, int_b + int_rho = -7.276e-15, checking this took 0.100 ms
2-norm of RHS = 691.0848064985009, which took 0.115 ms

iter_count = 132, r_2norm = 6.908e-04, tol*||rhs|| = 6.911e-04

Anderson update took 70.744 ms, out of which F'*F took 32.840 ms; b-Ax took 222.499 ms, out of which Lap took 199.315 ms
Solving Poisson took 475.748 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.160 ms
Total time for convolution: 	 convolve: 5.225430 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.753 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.199657 
Total time for convolution: 	 convolve: 5.189425 
Total time for convolution: 	 convolve: 5.275842 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.839 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.506 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.966 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.508 ms

This SCF took 27377.726 ms, scf error = 1.222e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.138879, lowerbound = -1.015037, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1429.196 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 17.231 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.547 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.800 ms
rank =  0, finding HY took 23.314 ms
rank =  0, distributing HY into block cyclic form took 17.400 ms
rank =  0, finding Y'*HY took 3.941 ms
Rank 0, Project_Hamiltonian used 64.502 ms
Total time for projection: 64.526 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.237 ms
    first calculated eigval = -1.014952314377062
    last  calculated eigval = 0.039707719943441
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.68399773173892
lambda[   4] =  -0.55174749213942
lambda[   5] =  -0.43220300645524
lambda[   6] =  -0.41955191054369
lambda[   7] =  -0.41700271037534
lambda[   8] =  -0.36048576142349
lambda[   9] =  -0.34329312107274
lambda[  10] =  -0.34258696999742
lambda[  11] =  -0.27898346502140
lambda[  12] =  -0.22927429979069
lambda[  13] =  -0.03066894205984
lambda[  14] =  -0.02480507764893
lambda[  15] =   0.01190856580056
lambda[  16] =   0.02768446209659
lambda[  17] =   0.03171534182600
lambda[  18] =   0.03444047212479
lambda[  19] =   0.03970771994344
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.266 ms
rank =  0, subspace rotation using ScaLAPACK took 7.360 ms
rank =  0, Distributing orbital back into band + domain format took 16.956 ms
rank = 0, Subspace_Rotation used 24.340 ms

Total time for subspace rotation: 24.345 ms
rank = 0, Efermi =  -0.059704636646 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.362 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.722 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.557 ms
rank = 0, Calculating density took 1535.527 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.836 ms
rank = 0, D2D took 1.940 ms
rank = 0, Transfering density took 1.948 ms
Etot    =   -47.527329952756
Eband   =   -12.004787571808
E1      =    25.823307275340
E2      =   -11.450313763288
E3      =   -15.830611174152
Exc     =   -14.080038013304
Esc     =   -74.546736579732
Entropy =    -0.000000000692
dE = 1.822e-06, dEband = 2.519e-04
rank = 0, Calculating/Estimating energy took 0.952 ms, Etot = -47.527329953, dEtot = 1.822e-06, dEband = 2.519e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0248876192476, which took 0.116 ms

iter_count = 114, r_2norm = 6.388e-07, tol*||rhs|| = 9.955e-07

Anderson update took 61.574 ms, out of which F'*F took 28.313 ms; b-Ax took 192.349 ms, out of which Lap took 172.536 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.328 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313982, int_b + int_rho = 5.821e-14, checking this took 0.103 ms
2-norm of RHS = 691.0843182301184, which took 0.121 ms

iter_count = 84, r_2norm = 6.820e-04, tol*||rhs|| = 6.911e-04

Anderson update took 45.141 ms, out of which F'*F took 21.185 ms; b-Ax took 143.130 ms, out of which Lap took 128.197 ms
Solving Poisson took 304.751 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.177055 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.185905 
Total time for convolution: 	 convolve: 5.181117 
Total time for convolution: 	 convolve: 5.187637 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.828 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.544 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.488 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.876 ms

This SCF took 27201.050 ms, scf error = 1.092e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.139708, lowerbound = -1.014952, upperbound = 267.579187

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1421.744 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.249 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.477 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.755 ms
rank =  0, finding HY took 23.147 ms
rank =  0, distributing HY into block cyclic form took 17.377 ms
rank =  0, finding Y'*HY took 3.867 ms
Rank 0, Project_Hamiltonian used 64.187 ms
Total time for projection: 64.199 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -1.014902265664030
    last  calculated eigval = 0.039804570617292
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.68395117719462
lambda[   4] =  -0.55170069932684
lambda[   5] =  -0.43215694996714
lambda[   6] =  -0.41950438368174
lambda[   7] =  -0.41695666252100
lambda[   8] =  -0.36044146914005
lambda[   9] =  -0.34324767325276
lambda[  10] =  -0.34254019183564
lambda[  11] =  -0.27893636695163
lambda[  12] =  -0.22922811797321
lambda[  13] =  -0.03062805930225
lambda[  14] =  -0.02447830650778
lambda[  15] =   0.01210271703975
lambda[  16] =   0.02784807218498
lambda[  17] =   0.03198454064360
lambda[  18] =   0.03464787315924
lambda[  19] =   0.03980457061729
==subpsace eigenproblem: bcast eigvals took 0.041 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 7.364 ms
rank =  0, Distributing orbital back into band + domain format took 17.297 ms
rank = 0, Subspace_Rotation used 24.688 ms

Total time for subspace rotation: 24.693 ms
rank = 0, Efermi =  -0.059663522757 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 5.414 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.865 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.572 ms
rank = 0, Calculating density took 1527.883 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.986 ms
rank = 0, D2D took 2.114 ms
rank = 0, Transfering density took 2.117 ms
Etot    =   -47.527328730786
Eband   =   -12.003663524378
E1      =    25.822697744600
E2      =   -11.449776745366
E3      =   -15.830722374401
Exc     =   -14.080125490351
Esc     =   -74.546736579732
Entropy =    -0.000000000692
dE = 1.527e-07, dEband = 1.405e-04
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -47.527328731, dEtot = 1.527e-07, dEband = 1.405e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0252993082976, which took 0.067 ms

iter_count = 108, r_2norm = 7.150e-07, tol*||rhs|| = 1.012e-06

Anderson update took 58.182 ms, out of which F'*F took 27.400 ms; b-Ax took 182.830 ms, out of which Lap took 164.618 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.383 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002313976, int_rho =  24.00000002313977, int_b + int_rho = 7.276e-15, checking this took 0.087 ms
2-norm of RHS = 691.0890983028028, which took 0.085 ms

iter_count = 150, r_2norm = 5.664e-04, tol*||rhs|| = 6.911e-04

Anderson update took 80.320 ms, out of which F'*F took 37.545 ms; b-Ax took 255.581 ms, out of which Lap took 227.560 ms
Solving Poisson took 543.067 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.241952 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.436 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.212899 
Total time for convolution: 	 convolve: 5.172802 
Total time for convolution: 	 convolve: 5.212143 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.843 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.486 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.956 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.480 ms

This SCF took 27339.199 ms, scf error = 9.852e-05
The last 17 occupations of kpoints #1 are (Nelectron = 24):
lambda[   3] =  -0.68395117719462, occ[   3] =   2.00000000000000
lambda[   4] =  -0.55170069932684, occ[   4] =   2.00000000000000
lambda[   5] =  -0.43215694996714, occ[   5] =   2.00000000000000
lambda[   6] =  -0.41950438368174, occ[   6] =   2.00000000000000
lambda[   7] =  -0.41695666252100, occ[   7] =   2.00000000000000
lambda[   8] =  -0.36044146914005, occ[   8] =   2.00000000000000
lambda[   9] =  -0.34324767325276, occ[   9] =   2.00000000000000
lambda[  10] =  -0.34254019183564, occ[  10] =   2.00000000000000
lambda[  11] =  -0.27893636695163, occ[  11] =   2.00000000000000
lambda[  12] =  -0.22922811797321, occ[  12] =   2.00000000000000
lambda[  13] =  -0.03062805930225, occ[  13] =   0.00000002312694
lambda[  14] =  -0.02447830650778, occ[  14] =   0.00000000001287
lambda[  15] =   0.01210271703975, occ[  15] =   0.00000000000000
lambda[  16] =   0.02784807218498, occ[  16] =   0.00000000000000
lambda[  17] =   0.03198454064360, occ[  17] =   0.00000000000000
lambda[  18] =   0.03464787315924, occ[  18] =   0.00000000000000
lambda[  19] =   0.03980457061729, occ[  19] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 17 (90%) = 0.000000000000000.
Occupation of state 19 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.538 ms, time for Allreduce/Reduce: 10.320 ms 
Time for calculating local force components: 20.230 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.24253805749491  -1.18962447830916   0.00000028739824
  0.24330369409427   1.01250039901927   0.00000002518224
 -0.04626656439091  -0.02135870258916   0.00000000992930
  0.00498377334826   0.02907960652886  -0.03978989801433
  0.00498375013297   0.02907958559501   0.03978987262824
  0.04803508271464  -0.05617743800697  -0.00000000023854
 -0.04512507636889   0.02051118968475  -0.00000011093595
 -0.16073547962922   0.03804551164495  -0.00000012041778
force_loc = 
  0.23837309968163   1.17520081969153  -0.00000007889906
 -0.24517992366373  -0.98821679619291  -0.00000390185621
  0.04729739898328   0.02141872916738   0.00000015590114
 -0.00489189385847  -0.02999042555022   0.04054532699665
 -0.00489221360897  -0.02999057958074  -0.04054554074072
 -0.05013297694089   0.05791818058766  -0.00000007732992
  0.04394052978603  -0.01885498601506   0.00000267726231
  0.15879385222272  -0.05647164622994   0.00000024353172
Time for calculating nonlocal force components: 38.089 ms
[32mforces_xc: 
[0m[32m  0.00618258670787   0.02747959647051  -0.00000000168541
[0m[32m -0.00576767447768  -0.02885462973007  -0.00000017707441
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00181078260788  -0.00102333340079   0.00000013638523
[0m[32m  0.00820780150698   0.00927569994086   0.00000000786361
[0mTime for calculating XC forces components: 27.719 ms
 Cartesian force = 
  0.00196981747548   0.01306265001216   0.00000035232798
 -0.00769171546625  -0.00456431474444  -0.00000390823417
  0.00098302317327   0.00006673873750   0.00000031134465
  0.00004406807069  -0.00090410686208   0.00075557449652
  0.00004372510489  -0.00090428182645  -0.00075552259827
 -0.00214570564535   0.00174745473998   0.00000006794575
  0.00057842460591   0.00063958242818   0.00000284822578
  0.00621836268137  -0.00914372248485   0.00000027649176
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Time for printing density: 395.525 ms
The program took 475.034 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:18
Job ID:        2266656
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:37:00,vmem=8292K,walltime=00:08:05,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-4-1
---------------------------------------
