---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:54
Job ID:    2266477
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:57
Job ID:    2266477
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 13.231 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 7.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 14.906 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 86.055 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.946 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.079 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.031020	   12.796741	   10.000000	
   13.821998	   10.071871	   10.000000	
   11.761964	    7.203259	   10.000000	
    6.178002	   11.085533	   10.000000	
    9.775319	   10.749221	   10.000000	
   11.956828	    9.238628	   10.000000	
    7.520925	    9.699793	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.155 ms
Set up communicators.

--set up spincomm took 2.276 ms

--set up kptcomm took 0.339 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.012 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.096 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.311 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.303 ms

Calculate_SplineDerivRadFun took 0.203 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.309 ms.
time spent on vectorized spline interp: 2.258 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.985 ms.
time spent on vectorized spline interp: 1.678 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.482 ms.
time spent on vectorized spline interp: 1.670 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.500 ms.

Calculating rb for all atom types took 14.905 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.930 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -17.0000000169277, sum_int_rho = 16.5959445140883
PosCharge = 17.000000016928, NegCharge = -16.595944514088, scal_fac = 1.024346640982
After scaling, int_rho = 17.0000000169276, PosCharge + NegCharge - NetCharge = 9.237e-14
--Calculate Vref took 0.360 ms
--Calculate rho_guess took 1.956 ms

 integral of b = -17.0000000169277,
 int{b} + Nelectron + NetCharge = -1.693e-08,
 Esc = -43.0862872479024,
 MPI_Reduce took 28.058 ms

Calculating b & b_ref took 35.988 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.047 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.056 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 29.093 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692777, int_b + int_rho = 1.164e-13, checking this took 0.090 ms
2-norm of RHS = 629.1070148288391, which took 0.492 ms

iter_count = 420, r_2norm = 5.470e-04, tol*||rhs|| = 6.291e-04

Anderson update took 230.908 ms, out of which F'*F took 105.584 ms; b-Ax took 725.177 ms, out of which Lap took 651.800 ms
Solving Poisson took 1525.887 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.409 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
Total time for convolution: 	 convolve: 5.105777 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
Total time for convolution: 	 convolve: 5.118072 
Total time for convolution: 	 convolve: 5.104764 
Total time for convolution: 	 convolve: 5.099202 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 2.080 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.389 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
rank = 0, XC calculation took 24293.162 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.105 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.759 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 2.980 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.168 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.682 ms
    Lanczos iter 53, eigmin  = -0.908231792, eigmax = 264.928613683, err_eigmin = 1.044e-03, err_eigmax = 9.583e-03
rank =   0, Lanczos took 119.754 ms, eigmin = -0.908231791692, eigmax = 267.577899819684

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.284834, lowerbound = -1.008232, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1164.731 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.354 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.489 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.126 ms
rank =  0, Distribute data + matrix mult took 16.990 ms
rank =  0, finding HY took 18.839 ms
rank =  0, distributing HY into block cyclic form took 13.659 ms
rank =  0, finding Y'*HY took 2.014 ms
Rank 0, Project_Hamiltonian used 51.543 ms
Total time for projection: 51.554 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.340 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.746 ms
rank = 0, Solve_Generalized_EigenProblem used 1.534 ms
    first calculated eigval = 2.785555016437468
    last  calculated eigval = 3.177659413919257
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =   2.78555501643747
lambda[   2] =   2.83956764818535
lambda[   3] =   2.85645427609865
lambda[   4] =   2.91306699348414
lambda[   5] =   2.94449241530519
lambda[   6] =   2.99146991208114
lambda[   7] =   3.00306900490617
lambda[   8] =   3.04716059722615
lambda[   9] =   3.06047969469515
lambda[  10] =   3.07176687682294
lambda[  11] =   3.10602667396350
lambda[  12] =   3.12764102151644
lambda[  13] =   3.16442426148299
lambda[  14] =   3.17765941391926
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.570 ms
rank =  0, subspace rotation using ScaLAPACK took 3.904 ms
rank =  0, Distributing orbital back into band + domain format took 11.071 ms
rank = 0, Subspace_Rotation used 14.996 ms

Total time for subspace rotation: 15.002 ms
rank = 0, Efermi =   3.060367453610 calculate fermi energy took 0.048 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.277659, lowerbound = -1.008232, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1154.823 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.525 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.468 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 14.034 ms
rank =  0, finding HY took 18.136 ms
rank =  0, distributing HY into block cyclic form took 12.588 ms
rank =  0, finding Y'*HY took 2.169 ms
Rank 0, Project_Hamiltonian used 46.957 ms
Total time for projection: 46.968 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.710581534132624
    last  calculated eigval = 0.440221828977920
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.71058153413262
lambda[   2] =  -0.35445790318875
lambda[   3] =  -0.26934566031522
lambda[   4] =  -0.17157713642828
lambda[   5] =   0.03108034557877
lambda[   6] =   0.07934191946742
lambda[   7] =   0.14825185452872
lambda[   8] =   0.19969339886016
lambda[   9] =   0.22749288011635
lambda[  10] =   0.31323147649407
lambda[  11] =   0.35043802498508
lambda[  12] =   0.38311943049399
lambda[  13] =   0.41782919228199
lambda[  14] =   0.44022182897792
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.322 ms
rank =  0, Distributing orbital back into band + domain format took 12.091 ms
rank = 0, Subspace_Rotation used 15.428 ms

Total time for subspace rotation: 15.431 ms
rank = 0, Efermi =   0.227492880803 calculate fermi energy took 0.025 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.540222, lowerbound = -1.008232, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1142.664 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 15.139 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.451 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.624 ms
rank =  0, finding HY took 18.211 ms
rank =  0, distributing HY into block cyclic form took 12.594 ms
rank =  0, finding Y'*HY took 1.810 ms
Rank 0, Project_Hamiltonian used 50.182 ms
Total time for projection: 50.188 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.922018089624801
    last  calculated eigval = 0.161262149813468
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.92201808962480
lambda[   2] =  -0.76998672860719
lambda[   3] =  -0.60513568452354
lambda[   4] =  -0.56128630456937
lambda[   5] =  -0.46653868108736
lambda[   6] =  -0.45711764732634
lambda[   7] =  -0.37336967687109
lambda[   8] =  -0.31571274871434
lambda[   9] =  -0.22580704609027
lambda[  10] =  -0.02169931705507
lambda[  11] =   0.07654490240107
lambda[  12] =   0.09706371769004
lambda[  13] =   0.11577402000882
lambda[  14] =   0.16126214981347
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.343 ms
rank =  0, Distributing orbital back into band + domain format took 12.036 ms
rank = 0, Subspace_Rotation used 15.393 ms

Total time for subspace rotation: 15.396 ms
rank = 0, Efermi =  -0.225807045980 calculate fermi energy took 0.018 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.261262, lowerbound = -1.008232, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1153.155 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.537 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.424 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 14.004 ms
rank =  0, finding HY took 18.351 ms
rank =  0, distributing HY into block cyclic form took 12.738 ms
rank =  0, finding Y'*HY took 2.043 ms
Rank 0, Project_Hamiltonian used 47.163 ms
Total time for projection: 47.170 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.922437616456551
    last  calculated eigval = 0.076081946880812
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.92243761645655
lambda[   2] =  -0.77208664400010
lambda[   3] =  -0.60954146827306
lambda[   4] =  -0.56309737062353
lambda[   5] =  -0.48516231256400
lambda[   6] =  -0.46505967336894
lambda[   7] =  -0.39136975849619
lambda[   8] =  -0.33385008983058
lambda[   9] =  -0.26082802124012
lambda[  10] =  -0.08208951682658
lambda[  11] =   0.02274897697792
lambda[  12] =   0.05021657580854
lambda[  13] =   0.06941162899483
lambda[  14] =   0.07608194688081
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 3.600 ms
rank =  0, Distributing orbital back into band + domain format took 11.823 ms
rank = 0, Subspace_Rotation used 15.439 ms

Total time for subspace rotation: 15.442 ms
rank = 0, Efermi =  -0.260828021130 calculate fermi energy took 0.019 ms
rank = 0, --- Calculate rho: sum over local bands took 2.148 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.629 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.094 ms
rank = 0, Calculating density took 5000.337 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.297 ms
rank = 0, D2D took 1.398 ms
rank = 0, Transfering density took 1.406 ms
Etot    =   -24.800966032091
Eband   =    -9.346037892881
E1      =    19.451129611127
E2      =    -7.197538322002
E3      =    -9.275219087052
Exc     =    -8.288381194534
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 3.543e+00, dEband = 1.335e+00
rank = 0, Calculating/Estimating energy took 0.898 ms, Etot = -24.800966032, dEtot = 3.543e+00, dEband = 1.335e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 42.8863256813244, which took 0.045 ms

iter_count = 96, r_2norm = 1.379e-03, tol*||rhs|| = 1.715e-03

Anderson update took 51.825 ms, out of which F'*F took 23.837 ms; b-Ax took 161.867 ms, out of which Lap took 144.575 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 350.405 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692767, int_b + int_rho = 1.091e-14, checking this took 0.113 ms
2-norm of RHS = 625.3812742353812, which took 0.108 ms

iter_count = 288, r_2norm = 4.862e-04, tol*||rhs|| = 6.254e-04

Anderson update took 154.992 ms, out of which F'*F took 73.017 ms; b-Ax took 492.280 ms, out of which Lap took 442.065 ms
Solving Poisson took 1038.904 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.280 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.115041 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.086864 
Total time for convolution: 	 convolve: 5.095266 
Total time for convolution: 	 convolve: 5.091878 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.394 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 0.687 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.006 ms

This SCF took 30728.758 ms, scf error = 1.912e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.176082, lowerbound = -0.922438, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1162.984 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.618 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.430 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 14.084 ms
rank =  0, finding HY took 18.101 ms
rank =  0, distributing HY into block cyclic form took 12.543 ms
rank =  0, finding Y'*HY took 2.233 ms
Rank 0, Project_Hamiltonian used 46.991 ms
Total time for projection: 47.005 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -0.892075368707387
    last  calculated eigval = 0.049928110466541
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.89207536870739
lambda[   2] =  -0.74040239316185
lambda[   3] =  -0.58209185835355
lambda[   4] =  -0.53569919865783
lambda[   5] =  -0.45337906817558
lambda[   6] =  -0.43706104865764
lambda[   7] =  -0.36892423291860
lambda[   8] =  -0.30206805289134
lambda[   9] =  -0.23490986519529
lambda[  10] =  -0.06682222477247
lambda[  11] =  -0.00114520500679
lambda[  12] =   0.01263992256864
lambda[  13] =   0.04011531442994
lambda[  14] =   0.04992811046654
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 3.302 ms
rank =  0, Distributing orbital back into band + domain format took 12.059 ms
rank = 0, Subspace_Rotation used 15.374 ms

Total time for subspace rotation: 15.377 ms
rank = 0, Efermi =  -0.234909865085 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.133 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.735 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.738 ms
rank = 0, Calculating density took 1229.660 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.380 ms
rank = 0, D2D took 0.492 ms
rank = 0, Transfering density took 0.493 ms
Etot    =   -24.762236975197
Eband   =    -8.858312312219
E1      =    19.012648309251
E2      =    -7.162323115413
E3      =    -9.406856446689
Exc     =    -8.395318569474
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 5.533e-03, dEband = 6.968e-02
rank = 0, Calculating/Estimating energy took 0.910 ms, Etot = -24.762236975, dEtot = 5.533e-03, dEband = 6.968e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 13.3958770328800, which took 0.058 ms

iter_count = 102, r_2norm = 4.566e-04, tol*||rhs|| = 5.358e-04

Anderson update took 54.774 ms, out of which F'*F took 25.744 ms; b-Ax took 174.247 ms, out of which Lap took 156.255 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 378.447 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692767, int_b + int_rho = 1.455e-14, checking this took 0.103 ms
2-norm of RHS = 620.0553967322857, which took 0.147 ms

iter_count = 300, r_2norm = 5.671e-04, tol*||rhs|| = 6.201e-04

Anderson update took 161.688 ms, out of which F'*F took 76.773 ms; b-Ax took 516.702 ms, out of which Lap took 464.855 ms
Solving Poisson took 1091.519 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.549 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.089500 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.794 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.105484 
Total time for convolution: 	 convolve: 5.108900 
Total time for convolution: 	 convolve: 5.086733 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.346 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.420 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.725 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.411 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.658 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.969 ms

This SCF took 27077.384 ms, scf error = 1.319e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.149928, lowerbound = -0.892075, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1143.508 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.544 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.629 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 14.198 ms
rank =  0, finding HY took 19.530 ms
rank =  0, distributing HY into block cyclic form took 12.681 ms
rank =  0, finding Y'*HY took 2.117 ms
Rank 0, Project_Hamiltonian used 48.559 ms
Total time for projection: 48.572 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.839328230705767
    last  calculated eigval = 0.036081325030102
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.83932823070577
lambda[   2] =  -0.68314415095170
lambda[   3] =  -0.53039688142981
lambda[   4] =  -0.48466346261100
lambda[   5] =  -0.39519083012938
lambda[   6] =  -0.38446478034485
lambda[   7] =  -0.32925799988244
lambda[   8] =  -0.24903077653696
lambda[   9] =  -0.19145186755565
lambda[  10] =  -0.02993117314764
lambda[  11] =  -0.01629682138459
lambda[  12] =   0.00469284326007
lambda[  13] =   0.02615971195971
lambda[  14] =   0.03608132503010
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.288 ms
rank =  0, Distributing orbital back into band + domain format took 11.856 ms
rank = 0, Subspace_Rotation used 15.615 ms

Total time for subspace rotation: 15.618 ms
rank = 0, Efermi =  -0.191451867445 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.138 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.712 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.135 ms
rank = 0, Calculating density took 1210.975 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.512 ms
rank = 0, D2D took 0.718 ms
rank = 0, Transfering density took 0.721 ms
Etot    =   -24.728126151319
Eband   =    -7.982406095978
E1      =    18.260026270322
E2      =    -7.021646086020
E3      =    -9.676004622279
Exc     =    -8.612963069105
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 4.873e-03, dEband = 1.251e-01
rank = 0, Calculating/Estimating energy took 0.978 ms, Etot = -24.728126151, dEtot = 4.873e-03, dEband = 1.251e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.1412657017190, which took 0.118 ms

iter_count = 108, r_2norm = 1.058e-04, tol*||rhs|| = 1.657e-04

Anderson update took 57.752 ms, out of which F'*F took 26.959 ms; b-Ax took 182.910 ms, out of which Lap took 163.933 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.186 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692758, int_b + int_rho = -8.004e-14, checking this took 0.109 ms
2-norm of RHS = 620.4463861109980, which took 0.082 ms

iter_count = 270, r_2norm = 5.983e-04, tol*||rhs|| = 6.204e-04

Anderson update took 143.945 ms, out of which F'*F took 67.358 ms; b-Ax took 458.556 ms, out of which Lap took 408.300 ms
Solving Poisson took 972.059 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Total time for convolution: 	 convolve: 5.081882 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.096173 
Total time for convolution: 	 convolve: 5.081080 
Total time for convolution: 	 convolve: 5.089520 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 1.210 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 0.695 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.016 ms

This SCF took 26979.496 ms, scf error = 4.067e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.136081, lowerbound = -0.839328, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1155.822 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.534 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.440 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 14.024 ms
rank =  0, finding HY took 17.983 ms
rank =  0, distributing HY into block cyclic form took 12.396 ms
rank =  0, finding Y'*HY took 2.532 ms
Rank 0, Project_Hamiltonian used 47.014 ms
Total time for projection: 47.030 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.118 ms
    first calculated eigval = -0.832933563791263
    last  calculated eigval = 0.027264231145785
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.83293356379126
lambda[   2] =  -0.67393361364424
lambda[   3] =  -0.51960718240499
lambda[   4] =  -0.47503308460597
lambda[   5] =  -0.38546244017730
lambda[   6] =  -0.37351810007815
lambda[   7] =  -0.32381252544796
lambda[   8] =  -0.24365099824199
lambda[   9] =  -0.18786117017874
lambda[  10] =  -0.02501682304912
lambda[  11] =  -0.02348476459282
lambda[  12] =   0.00277106382009
lambda[  13] =   0.02014210155903
lambda[  14] =   0.02726423114578
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.131 ms
rank =  0, subspace rotation using ScaLAPACK took 3.871 ms
rank =  0, Distributing orbital back into band + domain format took 11.012 ms
rank = 0, Subspace_Rotation used 14.901 ms

Total time for subspace rotation: 14.918 ms
rank = 0, Efermi =  -0.187861170068 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.108 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.007 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.103 ms
rank = 0, Calculating density took 1222.091 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
rank = 0, D2D took 0.718 ms
rank = 0, Transfering density took 0.726 ms
Etot    =   -24.725265904243
Eband   =    -7.843764190142
E1      =    18.183899196198
E2      =    -6.949743480743
E3      =    -9.725451997126
Exc     =    -8.650162423312
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 4.086e-04, dEband = 1.981e-02
rank = 0, Calculating/Estimating energy took 0.969 ms, Etot = -24.725265904, dEtot = 4.086e-04, dEband = 1.981e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.0459932574825, which took 0.062 ms

iter_count = 108, r_2norm = 6.414e-05, tol*||rhs|| = 8.184e-05

Anderson update took 57.775 ms, out of which F'*F took 26.937 ms; b-Ax took 182.578 ms, out of which Lap took 163.021 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.345 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692765, int_b + int_rho = -3.638e-15, checking this took 0.113 ms
2-norm of RHS = 620.7371189173936, which took 0.120 ms

iter_count = 252, r_2norm = 5.799e-04, tol*||rhs|| = 6.207e-04

Anderson update took 133.373 ms, out of which F'*F took 62.542 ms; b-Ax took 425.526 ms, out of which Lap took 380.821 ms
Solving Poisson took 907.104 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.111695 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.758 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.091433 
Total time for convolution: 	 convolve: 5.104244 
Total time for convolution: 	 convolve: 5.089726 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.396 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.663 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.986 ms

This SCF took 28770.627 ms, scf error = 1.369e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.127264, lowerbound = -0.832934, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1161.853 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.601 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.458 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 14.092 ms
rank =  0, finding HY took 18.072 ms
rank =  0, distributing HY into block cyclic form took 12.383 ms
rank =  0, finding Y'*HY took 2.426 ms
Rank 0, Project_Hamiltonian used 47.004 ms
Total time for projection: 47.021 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.041 ms
rank = 0, Solve_Generalized_EigenProblem used 0.112 ms
    first calculated eigval = -0.828526371902272
    last  calculated eigval = 0.022129439118640
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.82852637190227
lambda[   2] =  -0.67058018737725
lambda[   3] =  -0.51566514230677
lambda[   4] =  -0.47081350255035
lambda[   5] =  -0.38181617852375
lambda[   6] =  -0.36934319182207
lambda[   7] =  -0.32077837132726
lambda[   8] =  -0.23864189984574
lambda[   9] =  -0.18497358132088
lambda[  10] =  -0.02893657795948
lambda[  11] =  -0.02182865666538
lambda[  12] =   0.00195680368759
lambda[  13] =   0.01741190039126
lambda[  14] =   0.02212943911864
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 3.198 ms
rank =  0, Distributing orbital back into band + domain format took 10.977 ms
rank = 0, Subspace_Rotation used 14.194 ms

Total time for subspace rotation: 14.735 ms
rank = 0, Efermi =  -0.184973581211 calculate fermi energy took 0.362 ms
rank = 0, --- Calculate rho: sum over local bands took 2.035 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.678 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.072 ms
rank = 0, Calculating density took 1227.934 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.462 ms
rank = 0, D2D took 0.823 ms
rank = 0, Transfering density took 0.833 ms
Etot    =   -24.724586285199
Eband   =    -7.777303275763
E1      =    18.152501873581
E2      =    -6.909680979084
E3      =    -9.745546941433
Exc     =    -8.664578838676
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 9.709e-05, dEband = 9.494e-03
rank = 0, Calculating/Estimating energy took 0.968 ms, Etot = -24.724586285, dEtot = 9.709e-05, dEband = 9.494e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7490810027448, which took 0.051 ms

iter_count = 114, r_2norm = 1.961e-05, tol*||rhs|| = 2.996e-05

Anderson update took 61.058 ms, out of which F'*F took 28.611 ms; b-Ax took 193.327 ms, out of which Lap took 172.795 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.319 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692759, int_b + int_rho = -7.276e-14, checking this took 0.105 ms
2-norm of RHS = 620.9983837273980, which took 0.129 ms

iter_count = 234, r_2norm = 5.689e-04, tol*||rhs|| = 6.210e-04

Anderson update took 126.827 ms, out of which F'*F took 59.280 ms; b-Ax took 394.629 ms, out of which Lap took 356.479 ms
Solving Poisson took 850.722 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.082936 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.081428 
Total time for convolution: 	 convolve: 5.099512 
Total time for convolution: 	 convolve: 5.081200 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.599 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
---Transfer Veff_loc: D2D took 0.691 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.024 ms

This SCF took 26824.488 ms, scf error = 6.458e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.122129, lowerbound = -0.828526, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1163.226 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.623 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.480 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 14.144 ms
rank =  0, finding HY took 18.029 ms
rank =  0, distributing HY into block cyclic form took 12.605 ms
rank =  0, finding Y'*HY took 2.085 ms
Rank 0, Project_Hamiltonian used 46.894 ms
Total time for projection: 46.911 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.577 ms
rank = 0, Solve_Generalized_EigenProblem used 1.026 ms
    first calculated eigval = -0.826691369744977
    last  calculated eigval = 0.019681269055060
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.82669136974498
lambda[   2] =  -0.66899061880078
lambda[   3] =  -0.51401900566112
lambda[   4] =  -0.46908386515698
lambda[   5] =  -0.38027211221831
lambda[   6] =  -0.36753165295381
lambda[   7] =  -0.31926022542816
lambda[   8] =  -0.23650406941056
lambda[   9] =  -0.18337165463199
lambda[  10] =  -0.03125578730162
lambda[  11] =  -0.02071784020610
lambda[  12] =   0.00159248925997
lambda[  13] =   0.01622223735035
lambda[  14] =   0.01968126905506
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 1.038 ms
rank =  0, subspace rotation using ScaLAPACK took 3.313 ms
rank =  0, Distributing orbital back into band + domain format took 11.951 ms
rank = 0, Subspace_Rotation used 15.277 ms

Total time for subspace rotation: 15.281 ms
rank = 0, Efermi =  -0.183371654522 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.172 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.750 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1229.613 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
rank = 0, D2D took 0.742 ms
rank = 0, Transfering density took 0.745 ms
Etot    =   -24.724395318575
Eband   =    -7.748077496485
E1      =    18.144017951538
E2      =    -6.887010240997
E3      =    -9.751162085351
Exc     =    -8.668074135119
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 2.728e-05, dEband = 4.175e-03
rank = 0, Calculating/Estimating energy took 1.005 ms, Etot = -24.724395319, dEtot = 2.728e-05, dEband = 4.175e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3779392841188, which took 0.086 ms

iter_count = 114, r_2norm = 9.443e-06, tol*||rhs|| = 1.512e-05

Anderson update took 61.426 ms, out of which F'*F took 28.757 ms; b-Ax took 194.316 ms, out of which Lap took 175.014 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.541 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692768, int_b + int_rho = 2.183e-14, checking this took 0.108 ms
2-norm of RHS = 621.2506213573500, which took 0.119 ms

iter_count = 246, r_2norm = 6.147e-04, tol*||rhs|| = 6.213e-04

Anderson update took 134.413 ms, out of which F'*F took 62.320 ms; b-Ax took 416.644 ms, out of which Lap took 377.054 ms
Solving Poisson took 893.959 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.080042 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.324 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.163 ms
Total time for convolution: 	 convolve: 5.095200 
Total time for convolution: 	 convolve: 5.088048 
Total time for convolution: 	 convolve: 5.093309 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.147 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.676 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.296 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.994 ms

This SCF took 26925.331 ms, scf error = 4.221e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.119681, lowerbound = -0.826691, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1133.160 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.483 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.457 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 13.978 ms
rank =  0, finding HY took 19.017 ms
rank =  0, distributing HY into block cyclic form took 12.522 ms
rank =  0, finding Y'*HY took 2.108 ms
Rank 0, Project_Hamiltonian used 48.130 ms
Total time for projection: 48.145 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -0.822989556033660
    last  calculated eigval = 0.019406110003560
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.82298955603366
lambda[   2] =  -0.66486061468793
lambda[   3] =  -0.51047353098313
lambda[   4] =  -0.46559483101553
lambda[   5] =  -0.37643461059978
lambda[   6] =  -0.36382465579460
lambda[   7] =  -0.31565077788633
lambda[   8] =  -0.23265984103056
lambda[   9] =  -0.17953782974697
lambda[  10] =  -0.03178947912181
lambda[  11] =  -0.01759742853591
lambda[  12] =   0.00240553526224
lambda[  13] =   0.01663341896246
lambda[  14] =   0.01940611000356
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.139 ms
rank =  0, subspace rotation using ScaLAPACK took 3.226 ms
rank =  0, Distributing orbital back into band + domain format took 12.028 ms
rank = 0, Subspace_Rotation used 15.265 ms

Total time for subspace rotation: 15.269 ms
rank = 0, Efermi =  -0.179537829637 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.175 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.831 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.083 ms
rank = 0, Calculating density took 1199.904 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
rank = 0, D2D took 0.763 ms
rank = 0, Transfering density took 0.766 ms
Etot    =   -24.724253884326
Eband   =    -7.684514668849
E1      =    18.114978407409
E2      =    -6.849597057665
E3      =    -9.760627520270
Exc     =    -8.674508235965
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 2.020e-05, dEband = 9.080e-03
rank = 0, Calculating/Estimating energy took 0.976 ms, Etot = -24.724253884, dEtot = 2.020e-05, dEband = 9.080e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2101081424736, which took 0.054 ms

iter_count = 114, r_2norm = 5.649e-06, tol*||rhs|| = 8.404e-06

Anderson update took 61.513 ms, out of which F'*F took 29.045 ms; b-Ax took 193.380 ms, out of which Lap took 174.185 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.489 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692768, int_b + int_rho = 1.819e-14, checking this took 0.124 ms
2-norm of RHS = 621.2822298223688, which took 0.098 ms

iter_count = 228, r_2norm = 5.876e-04, tol*||rhs|| = 6.213e-04

Anderson update took 124.775 ms, out of which F'*F took 57.853 ms; b-Ax took 388.020 ms, out of which Lap took 349.814 ms
Solving Poisson took 825.132 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.084186 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.651 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.086345 
Total time for convolution: 	 convolve: 5.085447 
Total time for convolution: 	 convolve: 5.086439 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
---Transfer Veff_loc: D2D took 0.652 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.301 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.972 ms

This SCF took 26756.053 ms, scf error = 2.055e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.119406, lowerbound = -0.822990, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1160.403 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.331 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.401 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 13.774 ms
rank =  0, finding HY took 18.234 ms
rank =  0, distributing HY into block cyclic form took 12.607 ms
rank =  0, finding Y'*HY took 2.057 ms
Rank 0, Project_Hamiltonian used 47.192 ms
Total time for projection: 47.204 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.820630545274856
    last  calculated eigval = 0.020231572457124
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.82063054527486
lambda[   2] =  -0.66282822134194
lambda[   3] =  -0.50847895877814
lambda[   4] =  -0.46351358013008
lambda[   5] =  -0.37431504348663
lambda[   6] =  -0.36195800093751
lambda[   7] =  -0.31342774038294
lambda[   8] =  -0.23032889862552
lambda[   9] =  -0.17762744820755
lambda[  10] =  -0.03108473358138
lambda[  11] =  -0.01554594260059
lambda[  12] =   0.00410807295077
lambda[  13] =   0.01799470522789
lambda[  14] =   0.02023157245712
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 3.226 ms
rank =  0, Distributing orbital back into band + domain format took 12.049 ms
rank = 0, Subspace_Rotation used 15.286 ms

Total time for subspace rotation: 15.290 ms
rank = 0, Efermi =  -0.177627448097 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.210 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.686 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1226.166 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
rank = 0, D2D took 0.720 ms
rank = 0, Transfering density took 0.722 ms
Etot    =   -24.724298299497
Eband   =    -7.648589429130
E1      =    18.097393350644
E2      =    -6.830031616190
E3      =    -9.764852541370
Exc     =    -8.677552413714
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 6.345e-06, dEband = 5.132e-03
rank = 0, Calculating/Estimating energy took 1.023 ms, Etot = -24.724298299, dEtot = 6.345e-06, dEband = 5.132e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1780233280342, which took 0.047 ms

iter_count = 108, r_2norm = 6.422e-06, tol*||rhs|| = 7.121e-06

Anderson update took 58.131 ms, out of which F'*F took 27.265 ms; b-Ax took 183.735 ms, out of which Lap took 165.290 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.360 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692763, int_b + int_rho = -3.274e-14, checking this took 0.132 ms
2-norm of RHS = 621.2372061443334, which took 0.097 ms

iter_count = 216, r_2norm = 5.639e-04, tol*||rhs|| = 6.212e-04

Anderson update took 117.726 ms, out of which F'*F took 55.470 ms; b-Ax took 368.438 ms, out of which Lap took 331.903 ms
Solving Poisson took 781.500 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.169 ms
Total time for convolution: 	 convolve: 5.081950 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.084903 
Total time for convolution: 	 convolve: 5.090516 
Total time for convolution: 	 convolve: 5.086510 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.673 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.291 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.985 ms

This SCF took 26705.572 ms, scf error = 1.268e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.120232, lowerbound = -0.820631, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1132.253 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.564 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.456 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 14.064 ms
rank =  0, finding HY took 18.145 ms
rank =  0, distributing HY into block cyclic form took 12.587 ms
rank =  0, finding Y'*HY took 2.086 ms
Rank 0, Project_Hamiltonian used 46.912 ms
Total time for projection: 46.952 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.819185970739274
    last  calculated eigval = 0.021829637278743
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81918597073927
lambda[   2] =  -0.66132449608882
lambda[   3] =  -0.50705441130131
lambda[   4] =  -0.46211440871836
lambda[   5] =  -0.37286298056115
lambda[   6] =  -0.36046137310416
lambda[   7] =  -0.31203964836158
lambda[   8] =  -0.22878820532837
lambda[   9] =  -0.17614019324088
lambda[  10] =  -0.02926917879290
lambda[  11] =  -0.01410300437613
lambda[  12] =   0.00677717280434
lambda[  13] =   0.01986324815621
lambda[  14] =   0.02182963727874
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.236 ms
rank =  0, Distributing orbital back into band + domain format took 12.084 ms
rank = 0, Subspace_Rotation used 15.331 ms

Total time for subspace rotation: 15.335 ms
rank = 0, Efermi =  -0.176140193131 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.198 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.767 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1197.830 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.548 ms
rank = 0, D2D took 0.752 ms
rank = 0, Transfering density took 0.755 ms
Etot    =   -24.724339819374
Eband   =    -7.623803184629
E1      =    18.083774730353
E2      =    -6.818228633298
E3      =    -9.767772718200
Exc     =    -8.679878751740
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 5.931e-06, dEband = 3.541e-03
rank = 0, Calculating/Estimating energy took 0.965 ms, Etot = -24.724339819, dEtot = 5.931e-06, dEband = 3.541e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0920960672450, which took 0.054 ms

iter_count = 114, r_2norm = 2.326e-06, tol*||rhs|| = 3.684e-06

Anderson update took 61.257 ms, out of which F'*F took 28.925 ms; b-Ax took 193.999 ms, out of which Lap took 174.307 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.692 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692761, int_b + int_rho = -4.729e-14, checking this took 0.107 ms
2-norm of RHS = 621.2377103231660, which took 0.102 ms

iter_count = 204, r_2norm = 5.502e-04, tol*||rhs|| = 6.212e-04

Anderson update took 112.318 ms, out of which F'*F took 51.646 ms; b-Ax took 351.496 ms, out of which Lap took 317.883 ms
Solving Poisson took 742.891 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.091528 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.078502 
Total time for convolution: 	 convolve: 5.085883 
Total time for convolution: 	 convolve: 5.077544 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 1.429 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.756 ms

This SCF took 26647.924 ms, scf error = 8.220e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.121830, lowerbound = -0.819186, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1154.752 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.592 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.462 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 14.089 ms
rank =  0, finding HY took 18.359 ms
rank =  0, distributing HY into block cyclic form took 12.479 ms
rank =  0, finding Y'*HY took 2.153 ms
Rank 0, Project_Hamiltonian used 47.108 ms
Total time for projection: 47.123 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.818602785049979
    last  calculated eigval = 0.023870979526643
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81860278504998
lambda[   2] =  -0.66067751314540
lambda[   3] =  -0.50642711742924
lambda[   4] =  -0.46151460754230
lambda[   5] =  -0.37225398458280
lambda[   6] =  -0.35981022432428
lambda[   7] =  -0.31137370091462
lambda[   8] =  -0.22821286101604
lambda[   9] =  -0.17547308564399
lambda[  10] =  -0.02693693409816
lambda[  11] =  -0.01328425751189
lambda[  12] =   0.00950919050106
lambda[  13] =   0.02203004798868
lambda[  14] =   0.02387097952664
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 3.253 ms
rank =  0, Distributing orbital back into band + domain format took 12.127 ms
rank = 0, Subspace_Rotation used 15.394 ms

Total time for subspace rotation: 15.398 ms
rank = 0, Efermi =  -0.175473085534 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.182 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.719 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1220.537 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.578 ms
rank = 0, D2D took 0.763 ms
rank = 0, Transfering density took 0.766 ms
Etot    =   -24.724360417117
Eband   =    -7.613218676624
E1      =    18.079433817451
E2      =    -6.811982350283
E3      =    -9.767858861322
Exc     =    -8.679982804692
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 2.943e-06, dEband = 1.512e-03
rank = 0, Calculating/Estimating energy took 0.968 ms, Etot = -24.724360417, dEtot = 2.943e-06, dEband = 1.512e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0672532642264, which took 0.053 ms

iter_count = 108, r_2norm = 2.008e-06, tol*||rhs|| = 2.690e-06

Anderson update took 58.176 ms, out of which F'*F took 27.379 ms; b-Ax took 184.056 ms, out of which Lap took 165.840 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.154 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692765, int_b + int_rho = -3.638e-15, checking this took 0.076 ms
2-norm of RHS = 621.2610549452075, which took 0.114 ms

iter_count = 198, r_2norm = 6.024e-04, tol*||rhs|| = 6.213e-04

Anderson update took 107.699 ms, out of which F'*F took 50.662 ms; b-Ax took 338.205 ms, out of which Lap took 305.019 ms
Solving Poisson took 716.733 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.095725 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.086368 
Total time for convolution: 	 convolve: 5.116690 
Total time for convolution: 	 convolve: 5.089774 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.666 ms
---Transfer Veff_loc: D2D took 1.101 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.307 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.769 ms

This SCF took 26673.344 ms, scf error = 5.317e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.123871, lowerbound = -0.818603, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.057 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.552 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.460 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 14.055 ms
rank =  0, finding HY took 18.113 ms
rank =  0, distributing HY into block cyclic form took 12.397 ms
rank =  0, finding Y'*HY took 2.198 ms
Rank 0, Project_Hamiltonian used 46.792 ms
Total time for projection: 46.805 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.045 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -0.817529302151667
    last  calculated eigval = 0.028537760153292
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81752930215167
lambda[   2] =  -0.65960841561751
lambda[   3] =  -0.50541836221068
lambda[   4] =  -0.46049691861330
lambda[   5] =  -0.37122234192271
lambda[   6] =  -0.35878694099086
lambda[   7] =  -0.31032218847063
lambda[   8] =  -0.22723519364102
lambda[   9] =  -0.17444462758181
lambda[  10] =  -0.02259183497988
lambda[  11] =  -0.01228503995076
lambda[  12] =   0.01368307650232
lambda[  13] =   0.02571619601076
lambda[  14] =   0.02853776015329
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 3.233 ms
rank =  0, Distributing orbital back into band + domain format took 12.055 ms
rank = 0, Subspace_Rotation used 15.301 ms

Total time for subspace rotation: 15.306 ms
rank = 0, Efermi =  -0.174444627472 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.190 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.760 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1185.431 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
rank = 0, D2D took 0.757 ms
rank = 0, Transfering density took 0.760 ms
Etot    =   -24.724451653938
Eband   =    -7.595683957772
E1      =    18.070713840156
E2      =    -6.802741918385
E3      =    -9.769604071059
Exc     =    -8.681393560909
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 1.303e-05, dEband = 2.505e-03
rank = 0, Calculating/Estimating energy took 0.983 ms, Etot = -24.724451654, dEtot = 1.303e-05, dEband = 2.505e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0529526372824, which took 0.130 ms

iter_count = 108, r_2norm = 1.764e-06, tol*||rhs|| = 2.118e-06

Anderson update took 58.099 ms, out of which F'*F took 27.357 ms; b-Ax took 184.029 ms, out of which Lap took 165.358 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.224 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692769, int_b + int_rho = 3.274e-14, checking this took 0.108 ms
2-norm of RHS = 621.2599327703693, which took 0.106 ms

iter_count = 144, r_2norm = 5.800e-04, tol*||rhs|| = 6.213e-04

Anderson update took 78.692 ms, out of which F'*F took 36.585 ms; b-Ax took 245.264 ms, out of which Lap took 221.184 ms
Solving Poisson took 522.380 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.099147 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.084613 
Total time for convolution: 	 convolve: 5.088008 
Total time for convolution: 	 convolve: 5.077776 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.013 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.701 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.388 ms
---Transfer Veff_loc: D2D took 0.650 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.970 ms

This SCF took 26408.406 ms, scf error = 2.649e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.128538, lowerbound = -0.817529, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1159.337 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.562 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.460 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.068 ms
rank =  0, Distribute data + matrix mult took 14.105 ms
rank =  0, finding HY took 18.174 ms
rank =  0, distributing HY into block cyclic form took 12.564 ms
rank =  0, finding Y'*HY took 2.107 ms
Rank 0, Project_Hamiltonian used 46.979 ms
Total time for projection: 46.994 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.817437445768693
    last  calculated eigval = 0.029387240097418
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81743744576869
lambda[   2] =  -0.65951527191153
lambda[   3] =  -0.50532480661678
lambda[   4] =  -0.46040538341666
lambda[   5] =  -0.37113344342254
lambda[   6] =  -0.35869321795518
lambda[   7] =  -0.31022587962882
lambda[   8] =  -0.22714845686477
lambda[   9] =  -0.17434781222677
lambda[  10] =  -0.02169504207868
lambda[  11] =  -0.01224319048372
lambda[  12] =   0.01403923828321
lambda[  13] =   0.02603638804166
lambda[  14] =   0.02938724009742
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.136 ms
rank =  0, subspace rotation using ScaLAPACK took 3.232 ms
rank =  0, Distributing orbital back into band + domain format took 12.006 ms
rank = 0, Subspace_Rotation used 15.250 ms

Total time for subspace rotation: 15.254 ms
rank = 0, Efermi =  -0.174347812117 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.171 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.743 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1224.841 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.572 ms
rank = 0, D2D took 0.761 ms
rank = 0, Transfering density took 0.764 ms
Etot    =   -24.724480894794
Eband   =    -7.594115626348
E1      =    18.069953607429
E2      =    -6.801923883211
E3      =    -9.769602247110
Exc     =    -8.681411041340
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 4.177e-06, dEband = 2.240e-04
rank = 0, Calculating/Estimating energy took 1.817 ms, Etot = -24.724480895, dEtot = 4.177e-06, dEband = 2.240e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0352452054694, which took 0.089 ms

iter_count = 108, r_2norm = 1.314e-06, tol*||rhs|| = 1.410e-06

Anderson update took 58.414 ms, out of which F'*F took 27.406 ms; b-Ax took 183.949 ms, out of which Lap took 165.719 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.779 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692771, int_b + int_rho = 5.821e-14, checking this took 0.140 ms
2-norm of RHS = 621.2640333272432, which took 0.106 ms

iter_count = 150, r_2norm = 6.172e-04, tol*||rhs|| = 6.213e-04

Anderson update took 81.747 ms, out of which F'*F took 38.516 ms; b-Ax took 255.365 ms, out of which Lap took 230.413 ms
Solving Poisson took 543.912 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.075506 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.093760 
Total time for convolution: 	 convolve: 5.098952 
Total time for convolution: 	 convolve: 5.080863 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.820 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.505 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.414 ms
---Transfer Veff_loc: D2D took 0.676 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.292 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.988 ms

This SCF took 26471.192 ms, scf error = 2.184e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.129387, lowerbound = -0.817437, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1159.526 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.666 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.441 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 14.152 ms
rank =  0, finding HY took 18.064 ms
rank =  0, distributing HY into block cyclic form took 12.461 ms
rank =  0, finding Y'*HY took 2.207 ms
Rank 0, Project_Hamiltonian used 46.909 ms
Total time for projection: 46.921 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.817308082358162
    last  calculated eigval = 0.029975232325980
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81730808235816
lambda[   2] =  -0.65937185583230
lambda[   3] =  -0.50518135056008
lambda[   4] =  -0.46027011857814
lambda[   5] =  -0.37099737357642
lambda[   6] =  -0.35855114209912
lambda[   7] =  -0.31008549412141
lambda[   8] =  -0.22702293382289
lambda[   9] =  -0.17421192779725
lambda[  10] =  -0.02102451933646
lambda[  11] =  -0.01222402707346
lambda[  12] =   0.01359141414931
lambda[  13] =   0.02605383449006
lambda[  14] =   0.02997523232598
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.136 ms
rank =  0, subspace rotation using ScaLAPACK took 3.225 ms
rank =  0, Distributing orbital back into band + domain format took 12.081 ms
rank = 0, Subspace_Rotation used 15.321 ms

Total time for subspace rotation: 15.325 ms
rank = 0, Efermi =  -0.174211927687 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.185 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.779 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1225.042 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.334 ms
rank = 0, D2D took 1.456 ms
rank = 0, Transfering density took 1.460 ms
Etot    =   -24.724522821111
Eband   =    -7.591788632642
E1      =    18.068991771276
E2      =    -6.800515274936
E3      =    -9.769615326511
Exc     =    -8.681422596335
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 5.989e-06, dEband = 3.324e-04
rank = 0, Calculating/Estimating energy took 1.029 ms, Etot = -24.724522821, dEtot = 5.989e-06, dEband = 3.324e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0228486263622, which took 0.050 ms

iter_count = 108, r_2norm = 8.191e-07, tol*||rhs|| = 9.139e-07

Anderson update took 57.719 ms, out of which F'*F took 31.134 ms; b-Ax took 187.307 ms, out of which Lap took 168.743 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.857 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692761, int_b + int_rho = -5.093e-14, checking this took 0.106 ms
2-norm of RHS = 621.2646691555112, which took 0.124 ms

iter_count = 144, r_2norm = 6.069e-04, tol*||rhs|| = 6.213e-04

Anderson update took 81.393 ms, out of which F'*F took 36.560 ms; b-Ax took 245.302 ms, out of which Lap took 221.259 ms
Solving Poisson took 525.145 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.077805 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.358 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.085097 
Total time for convolution: 	 convolve: 5.098630 
Total time for convolution: 	 convolve: 5.081771 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.568 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.407 ms
---Transfer Veff_loc: D2D took 0.668 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.316 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.008 ms

This SCF took 26444.899 ms, scf error = 1.749e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.129975, lowerbound = -0.817308, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1161.644 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.616 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.440 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 14.099 ms
rank =  0, finding HY took 18.137 ms
rank =  0, distributing HY into block cyclic form took 12.433 ms
rank =  0, finding Y'*HY took 2.225 ms
Rank 0, Project_Hamiltonian used 46.921 ms
Total time for projection: 46.935 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.817302201683537
    last  calculated eigval = 0.030605092133377
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81730220168354
lambda[   2] =  -0.65934026017547
lambda[   3] =  -0.50512963499137
lambda[   4] =  -0.46023626435879
lambda[   5] =  -0.37096742874817
lambda[   6] =  -0.35849729976831
lambda[   7] =  -0.31006345007227
lambda[   8] =  -0.22699562904478
lambda[   9] =  -0.17418690161580
lambda[  10] =  -0.02047976659761
lambda[  11] =  -0.01228967439143
lambda[  12] =   0.01299318254207
lambda[  13] =   0.02635790065917
lambda[  14] =   0.03060509213338
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.140 ms
rank =  0, subspace rotation using ScaLAPACK took 3.212 ms
rank =  0, Distributing orbital back into band + domain format took 12.079 ms
rank = 0, Subspace_Rotation used 15.311 ms

Total time for subspace rotation: 15.315 ms
rank = 0, Efermi =  -0.174186901506 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.185 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.658 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.088 ms
rank = 0, Calculating density took 1227.546 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.059 ms
rank = 0, D2D took 1.175 ms
rank = 0, Transfering density took 1.177 ms
Etot    =   -24.724550943247
Eband   =    -7.591251242244
E1      =    18.068956664143
E2      =    -6.800024842970
E3      =    -9.769441111085
Exc     =    -8.681288354343
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 4.017e-06, dEband = 7.677e-05
rank = 0, Calculating/Estimating energy took 0.891 ms, Etot = -24.724550943, dEtot = 4.017e-06, dEband = 7.677e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0235618492088, which took 0.071 ms

iter_count = 108, r_2norm = 8.652e-07, tol*||rhs|| = 9.425e-07

Anderson update took 58.357 ms, out of which F'*F took 27.457 ms; b-Ax took 183.900 ms, out of which Lap took 165.162 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.437 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692768, int_b + int_rho = 2.183e-14, checking this took 0.103 ms
2-norm of RHS = 621.2659089866866, which took 0.106 ms

iter_count = 60, r_2norm = 6.181e-04, tol*||rhs|| = 6.213e-04

Anderson update took 39.149 ms, out of which F'*F took 15.212 ms; b-Ax took 106.107 ms, out of which Lap took 96.296 ms
Solving Poisson took 227.756 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.084075 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.077707 
Total time for convolution: 	 convolve: 5.101132 
Total time for convolution: 	 convolve: 5.078734 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.772 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.572 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.160 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.078 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.292 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.977 ms

This SCF took 26147.819 ms, scf error = 1.829e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.130605, lowerbound = -0.817302, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1160.833 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.529 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.449 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 14.016 ms
rank =  0, finding HY took 18.236 ms
rank =  0, distributing HY into block cyclic form took 12.405 ms
rank =  0, finding Y'*HY took 2.195 ms
Rank 0, Project_Hamiltonian used 46.883 ms
Total time for projection: 46.896 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.817263248014361
    last  calculated eigval = 0.030467976182854
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81726324801436
lambda[   2] =  -0.65930479990314
lambda[   3] =  -0.50510081808695
lambda[   4] =  -0.46020440288932
lambda[   5] =  -0.37093292173790
lambda[   6] =  -0.35846878030242
lambda[   7] =  -0.31002921528150
lambda[   8] =  -0.22696141080146
lambda[   9] =  -0.17415320228227
lambda[  10] =  -0.02042702715039
lambda[  11] =  -0.01225183128989
lambda[  12] =   0.01300168996361
lambda[  13] =   0.02607703127110
lambda[  14] =   0.03046797618285
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.138 ms
rank =  0, subspace rotation using ScaLAPACK took 3.215 ms
rank =  0, Distributing orbital back into band + domain format took 12.051 ms
rank = 0, Subspace_Rotation used 16.065 ms

Total time for subspace rotation: 16.070 ms
rank = 0, Efermi =  -0.174153202172 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.175 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.740 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1227.032 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
rank = 0, D2D took 0.744 ms
rank = 0, Transfering density took 0.747 ms
Etot    =   -24.724549480114
Eband   =    -7.590684399260
E1      =    18.068638955368
E2      =    -6.799748843593
E3      =    -9.769551304778
Exc     =    -8.681370219736
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 2.090e-07, dEband = 8.098e-05
rank = 0, Calculating/Estimating energy took 0.992 ms, Etot = -24.724549480, dEtot = 2.090e-07, dEband = 8.098e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0230543073366, which took 0.059 ms

iter_count = 108, r_2norm = 8.933e-07, tol*||rhs|| = 9.222e-07

Anderson update took 58.139 ms, out of which F'*F took 27.303 ms; b-Ax took 184.427 ms, out of which Lap took 165.739 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.478 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692759, int_b + int_rho = -6.548e-14, checking this took 0.104 ms
2-norm of RHS = 621.2659406795630, which took 0.099 ms

iter_count = 72, r_2norm = 5.452e-04, tol*||rhs|| = 6.213e-04

Anderson update took 39.346 ms, out of which F'*F took 18.270 ms; b-Ax took 122.474 ms, out of which Lap took 110.561 ms
Solving Poisson took 262.941 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.077123 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.863 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.081645 
Total time for convolution: 	 convolve: 5.084436 
Total time for convolution: 	 convolve: 5.104761 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.982 ms

This SCF took 26182.974 ms, scf error = 1.645e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.130468, lowerbound = -0.817263, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1172.154 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.543 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.435 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 14.015 ms
rank =  0, finding HY took 18.170 ms
rank =  0, distributing HY into block cyclic form took 12.528 ms
rank =  0, finding Y'*HY took 2.141 ms
Rank 0, Project_Hamiltonian used 46.884 ms
Total time for projection: 46.899 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.817222600245307
    last  calculated eigval = 0.030536287814735
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81722260024531
lambda[   2] =  -0.65927368919662
lambda[   3] =  -0.50507342596965
lambda[   4] =  -0.46017279570857
lambda[   5] =  -0.37090099471017
lambda[   6] =  -0.35844261481206
lambda[   7] =  -0.30999585243295
lambda[   8] =  -0.22692943455629
lambda[   9] =  -0.17412397525017
lambda[  10] =  -0.02018268563435
lambda[  11] =  -0.01222716584647
lambda[  12] =   0.01307267621530
lambda[  13] =   0.02601550293008
lambda[  14] =   0.03053628781473
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 3.284 ms
rank =  0, Distributing orbital back into band + domain format took 12.345 ms
rank = 0, Subspace_Rotation used 15.651 ms

Total time for subspace rotation: 15.656 ms
rank = 0, Efermi =  -0.174123975140 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.993 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.680 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1238.031 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.527 ms
rank = 0, D2D took 0.716 ms
rank = 0, Transfering density took 0.724 ms
Etot    =   -24.724550564587
Eband   =    -7.590146793456
E1      =    18.068317014756
E2      =    -6.799514564110
E3      =    -9.769632179775
Exc     =    -8.681433564914
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 1.549e-07, dEband = 7.680e-05
rank = 0, Calculating/Estimating energy took 1.231 ms, Etot = -24.724550565, dEtot = 1.549e-07, dEband = 7.680e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0246901063895, which took 0.056 ms

iter_count = 108, r_2norm = 6.486e-07, tol*||rhs|| = 9.876e-07

Anderson update took 58.226 ms, out of which F'*F took 27.255 ms; b-Ax took 184.090 ms, out of which Lap took 165.626 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.543 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692756, int_b + int_rho = -9.459e-14, checking this took 0.114 ms
2-norm of RHS = 621.2654346410648, which took 0.098 ms

iter_count = 138, r_2norm = 5.285e-04, tol*||rhs|| = 6.213e-04

Anderson update took 75.006 ms, out of which F'*F took 35.509 ms; b-Ax took 235.145 ms, out of which Lap took 211.967 ms
Solving Poisson took 501.252 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.087132 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1094.227 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.082566 
Total time for convolution: 	 convolve: 5.085746 
Total time for convolution: 	 convolve: 5.082317 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.778 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.565 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.662 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.289 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.972 ms

This SCF took 27530.998 ms, scf error = 1.439e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.130536, lowerbound = -0.817223, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1161.155 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.635 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.468 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 14.148 ms
rank =  0, finding HY took 18.221 ms
rank =  0, distributing HY into block cyclic form took 12.434 ms
rank =  0, finding Y'*HY took 2.151 ms
Rank 0, Project_Hamiltonian used 46.984 ms
Total time for projection: 46.999 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -0.817138944224388
    last  calculated eigval = 0.030199777416793
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81713894422439
lambda[   2] =  -0.65918651544931
lambda[   3] =  -0.50498440960604
lambda[   4] =  -0.46008775870501
lambda[   5] =  -0.37081602390840
lambda[   6] =  -0.35835254088969
lambda[   7] =  -0.30991141682023
lambda[   8] =  -0.22686119661250
lambda[   9] =  -0.17404561415979
lambda[  10] =  -0.02017543523537
lambda[  11] =  -0.01222127956254
lambda[  12] =   0.01265490478768
lambda[  13] =   0.02630927310214
lambda[  14] =   0.03019977741679
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.140 ms
rank =  0, subspace rotation using ScaLAPACK took 3.184 ms
rank =  0, Distributing orbital back into band + domain format took 10.999 ms
rank = 0, Subspace_Rotation used 14.201 ms

Total time for subspace rotation: 14.757 ms
rank = 0, Efermi =  -0.174045614050 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.960 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.124 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.089 ms
rank = 0, Calculating density took 1227.263 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.610 ms
rank = 0, D2D took 0.799 ms
rank = 0, Transfering density took 0.806 ms
Etot    =   -24.724568281676
Eband   =    -7.588723229536
E1      =    18.067695615769
E2      =    -6.798708102977
E3      =    -9.769576300838
Exc     =    -8.681391106867
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 2.531e-06, dEband = 2.034e-04
rank = 0, Calculating/Estimating energy took 0.950 ms, Etot = -24.724568282, dEtot = 2.531e-06, dEband = 2.034e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0228913779571, which took 0.047 ms

iter_count = 108, r_2norm = 6.292e-07, tol*||rhs|| = 9.157e-07

Anderson update took 58.166 ms, out of which F'*F took 27.441 ms; b-Ax took 183.452 ms, out of which Lap took 164.978 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.065 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692770, int_b + int_rho = 4.729e-14, checking this took 0.098 ms
2-norm of RHS = 621.2652135275742, which took 0.075 ms

iter_count = 90, r_2norm = 6.086e-04, tol*||rhs|| = 6.213e-04

Anderson update took 49.089 ms, out of which F'*F took 22.812 ms; b-Ax took 152.832 ms, out of which Lap took 138.160 ms
Solving Poisson took 327.899 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.085851 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.077258 
Total time for convolution: 	 convolve: 5.084715 
Total time for convolution: 	 convolve: 5.078389 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.323 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 0.694 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.308 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.025 ms

This SCF took 26231.847 ms, scf error = 1.452e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.130200, lowerbound = -0.817139, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1161.064 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.566 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.494 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 14.098 ms
rank =  0, finding HY took 18.166 ms
rank =  0, distributing HY into block cyclic form took 12.478 ms
rank =  0, finding Y'*HY took 2.192 ms
Rank 0, Project_Hamiltonian used 46.963 ms
Total time for projection: 46.975 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.848 ms
    first calculated eigval = -0.817124322890927
    last  calculated eigval = 0.030122259095344
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81712432289093
lambda[   2] =  -0.65917827988590
lambda[   3] =  -0.50497711972369
lambda[   4] =  -0.46007815312352
lambda[   5] =  -0.37080676332070
lambda[   6] =  -0.35834625900260
lambda[   7] =  -0.30990156694011
lambda[   8] =  -0.22685293874576
lambda[   9] =  -0.17403791243925
lambda[  10] =  -0.02007558552920
lambda[  11] =  -0.01223115502851
lambda[  12] =   0.01254965846994
lambda[  13] =   0.02627210984836
lambda[  14] =   0.03012225909534
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.874 ms
rank =  0, subspace rotation using ScaLAPACK took 3.269 ms
rank =  0, Distributing orbital back into band + domain format took 11.742 ms
rank = 0, Subspace_Rotation used 15.029 ms

Total time for subspace rotation: 15.039 ms
rank = 0, Efermi =  -0.174037912329 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.149 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.759 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1227.605 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
rank = 0, D2D took 0.767 ms
rank = 0, Transfering density took 0.775 ms
Etot    =   -24.724565469159
Eband   =    -7.588568722651
E1      =    18.067579775729
E2      =    -6.798668313821
E3      =    -9.769601077934
Exc     =    -8.681411949135
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 4.018e-07, dEband = 2.207e-05
rank = 0, Calculating/Estimating energy took 0.946 ms, Etot = -24.724565469, dEtot = 4.018e-07, dEband = 2.207e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0232052786505, which took 0.117 ms

iter_count = 108, r_2norm = 6.302e-07, tol*||rhs|| = 9.282e-07

Anderson update took 58.047 ms, out of which F'*F took 27.360 ms; b-Ax took 198.542 ms, out of which Lap took 180.081 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 412.278 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692769, int_b + int_rho = 3.638e-14, checking this took 0.105 ms
2-norm of RHS = 621.2656000811329, which took 0.109 ms

iter_count = 96, r_2norm = 5.703e-04, tol*||rhs|| = 6.213e-04

Anderson update took 52.249 ms, out of which F'*F took 24.799 ms; b-Ax took 163.697 ms, out of which Lap took 147.698 ms
Solving Poisson took 349.336 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.083578 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.078359 
Total time for convolution: 	 convolve: 5.079668 
Total time for convolution: 	 convolve: 5.085782 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.673 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.993 ms

This SCF took 26281.361 ms, scf error = 1.243e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.130122, lowerbound = -0.817124, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1170.050 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.503 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.472 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 14.014 ms
rank =  0, finding HY took 18.391 ms
rank =  0, distributing HY into block cyclic form took 12.635 ms
rank =  0, finding Y'*HY took 2.309 ms
Rank 0, Project_Hamiltonian used 47.838 ms
Total time for projection: 47.852 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -0.817100569096737
    last  calculated eigval = 0.030109523284574
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81710056909674
lambda[   2] =  -0.65915817845344
lambda[   3] =  -0.50495677404716
lambda[   4] =  -0.46005624845771
lambda[   5] =  -0.37078586493423
lambda[   6] =  -0.35832736812060
lambda[   7] =  -0.30988036374279
lambda[   8] =  -0.22683373412375
lambda[   9] =  -0.17401987440079
lambda[  10] =  -0.01996322453588
lambda[  11] =  -0.01222943262728
lambda[  12] =   0.01250841225832
lambda[  13] =   0.02633725962205
lambda[  14] =   0.03010952328457
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 3.207 ms
rank =  0, Distributing orbital back into band + domain format took 12.137 ms
rank = 0, Subspace_Rotation used 15.358 ms

Total time for subspace rotation: 15.362 ms
rank = 0, Efermi =  -0.174019874291 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.186 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.754 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1236.546 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
rank = 0, D2D took 0.730 ms
rank = 0, Transfering density took 0.737 ms
Etot    =   -24.724568403295
Eband   =    -7.588218079298
E1      =    18.067383390692
E2      =    -6.798507137227
E3      =    -9.769627038109
Exc     =    -8.681433925166
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 4.192e-07, dEband = 5.009e-05
rank = 0, Calculating/Estimating energy took 0.986 ms, Etot = -24.724568403, dEtot = 4.192e-07, dEband = 5.009e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0262220116868, which took 0.061 ms

iter_count = 102, r_2norm = 9.755e-07, tol*||rhs|| = 1.049e-06

Anderson update took 54.976 ms, out of which F'*F took 25.948 ms; b-Ax took 173.113 ms, out of which Lap took 155.634 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.553 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692764, int_b + int_rho = -1.455e-14, checking this took 0.099 ms
2-norm of RHS = 621.2673269324597, which took 0.088 ms

iter_count = 96, r_2norm = 5.764e-04, tol*||rhs|| = 6.213e-04

Anderson update took 52.464 ms, out of which F'*F took 24.438 ms; b-Ax took 163.379 ms, out of which Lap took 147.526 ms
Solving Poisson took 350.054 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.096634 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.079190 
Total time for convolution: 	 convolve: 5.083724 
Total time for convolution: 	 convolve: 5.078610 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.672 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.289 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.983 ms

This SCF took 26316.319 ms, scf error = 1.120e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.130110, lowerbound = -0.817101, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1161.873 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.508 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.949 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 14.915 ms
rank =  0, finding HY took 18.998 ms
rank =  0, distributing HY into block cyclic form took 12.507 ms
rank =  0, finding Y'*HY took 2.169 ms
Rank 0, Project_Hamiltonian used 48.619 ms
Total time for projection: 48.633 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.817082953217830
    last  calculated eigval = 0.029514980425032
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81708295321783
lambda[   2] =  -0.65914320297014
lambda[   3] =  -0.50494147221571
lambda[   4] =  -0.46003977742863
lambda[   5] =  -0.37076998368838
lambda[   6] =  -0.35831357078041
lambda[   7] =  -0.30986454091145
lambda[   8] =  -0.22681634385233
lambda[   9] =  -0.17400722832624
lambda[  10] =  -0.02058660925231
lambda[  11] =  -0.01224405390550
lambda[  12] =   0.01215269380359
lambda[  13] =   0.02597754813884
lambda[  14] =   0.02951498042503
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 3.228 ms
rank =  0, Distributing orbital back into band + domain format took 12.121 ms
rank = 0, Subspace_Rotation used 15.362 ms

Total time for subspace rotation: 15.366 ms
rank = 0, Efermi =  -0.174007228216 calculate fermi energy took 0.038 ms
rank = 0, --- Calculate rho: sum over local bands took 2.201 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.732 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.075 ms
rank = 0, Calculating density took 1229.201 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
rank = 0, D2D took 0.760 ms
rank = 0, Transfering density took 0.768 ms
Etot    =   -24.724571693545
Eband   =    -7.587950921401
E1      =    18.067256912546
E2      =    -6.798352519254
E3      =    -9.769659557752
Exc     =    -8.681455796838
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 4.700e-07, dEband = 3.817e-05
rank = 0, Calculating/Estimating energy took 0.982 ms, Etot = -24.724571694, dEtot = 4.700e-07, dEband = 3.817e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0267855744713, which took 0.052 ms

iter_count = 102, r_2norm = 9.622e-07, tol*||rhs|| = 1.071e-06

Anderson update took 58.610 ms, out of which F'*F took 25.776 ms; b-Ax took 173.405 ms, out of which Lap took 156.169 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 378.958 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692761, int_b + int_rho = -4.366e-14, checking this took 0.107 ms
2-norm of RHS = 621.2681569578422, which took 0.097 ms

iter_count = 54, r_2norm = 5.827e-04, tol*||rhs|| = 6.213e-04

Anderson update took 30.017 ms, out of which F'*F took 13.748 ms; b-Ax took 91.658 ms, out of which Lap took 82.703 ms
Solving Poisson took 197.670 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.115 ms
Total time for convolution: 	 convolve: 5.086607 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.091189 
Total time for convolution: 	 convolve: 5.109103 
Total time for convolution: 	 convolve: 5.078763 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.652 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.978 ms

This SCF took 26119.889 ms, scf error = 1.054e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.129515, lowerbound = -0.817083, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1110.449 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.549 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.475 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 14.061 ms
rank =  0, finding HY took 18.188 ms
rank =  0, distributing HY into block cyclic form took 12.454 ms
rank =  0, finding Y'*HY took 2.133 ms
Rank 0, Project_Hamiltonian used 46.862 ms
Total time for projection: 46.877 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.817113760043168
    last  calculated eigval = 0.030330819892309
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81711376004317
lambda[   2] =  -0.65916567665795
lambda[   3] =  -0.50495959773791
lambda[   4] =  -0.46006174078662
lambda[   5] =  -0.37079408706954
lambda[   6] =  -0.35833005169988
lambda[   7] =  -0.30988676270380
lambda[   8] =  -0.22684187526773
lambda[   9] =  -0.17402613918704
lambda[  10] =  -0.01976133340536
lambda[  11] =  -0.01224130895647
lambda[  12] =   0.01258070392474
lambda[  13] =   0.02614648793375
lambda[  14] =   0.03033081989231
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 3.192 ms
rank =  0, Distributing orbital back into band + domain format took 12.104 ms
rank = 0, Subspace_Rotation used 15.307 ms

Total time for subspace rotation: 15.311 ms
rank = 0, Efermi =  -0.174026139077 calculate fermi energy took 0.038 ms
rank = 0, --- Calculate rho: sum over local bands took 2.166 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.806 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1175.936 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
rank = 0, D2D took 0.767 ms
rank = 0, Transfering density took 0.775 ms
Etot    =   -24.724572965810
Eband   =    -7.588333246064
E1      =    18.067541651639
E2      =    -6.798477450247
E3      =    -9.769546066597
Exc     =    -8.681370923371
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 1.818e-07, dEband = 5.462e-05
rank = 0, Calculating/Estimating energy took 0.958 ms, Etot = -24.724572966, dEtot = 1.818e-07, dEband = 5.462e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0210560250572, which took 0.051 ms

iter_count = 102, r_2norm = 8.140e-07, tol*||rhs|| = 8.422e-07

Anderson update took 55.217 ms, out of which F'*F took 25.872 ms; b-Ax took 173.557 ms, out of which Lap took 156.074 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.963 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692757, int_b + int_rho = -8.731e-14, checking this took 0.118 ms
2-norm of RHS = 621.2636435718632, which took 0.099 ms

iter_count = 102, r_2norm = 5.990e-04, tol*||rhs|| = 6.213e-04

Anderson update took 56.297 ms, out of which F'*F took 25.957 ms; b-Ax took 173.720 ms, out of which Lap took 156.778 ms
Solving Poisson took 371.692 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.106465 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.078251 
Total time for convolution: 	 convolve: 5.080269 
Total time for convolution: 	 convolve: 5.078561 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.667 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.439 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.474 ms

This SCF took 26380.229 ms, scf error = 1.330e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.130331, lowerbound = -0.817114, upperbound = 267.577900

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1161.013 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.538 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.487 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 14.066 ms
rank =  0, finding HY took 18.207 ms
rank =  0, distributing HY into block cyclic form took 12.482 ms
rank =  0, finding Y'*HY took 2.172 ms
Rank 0, Project_Hamiltonian used 46.958 ms
Total time for projection: 46.973 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.817047391725273
    last  calculated eigval = 0.028085679764177
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 17):
lambda[   1] =  -0.81704739172527
lambda[   2] =  -0.65911114384677
lambda[   3] =  -0.50491418844473
lambda[   4] =  -0.46000987827222
lambda[   5] =  -0.37073757127794
lambda[   6] =  -0.35828822713318
lambda[   7] =  -0.30983390971808
lambda[   8] =  -0.22678740073587
lambda[   9] =  -0.17398005803650
lambda[  10] =  -0.02174207177507
lambda[  11] =  -0.01222702164382
lambda[  12] =   0.01142850955641
lambda[  13] =   0.02447338770542
lambda[  14] =   0.02808567976418
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.206 ms
rank =  0, Distributing orbital back into band + domain format took 12.171 ms
rank = 0, Subspace_Rotation used 15.390 ms

Total time for subspace rotation: 15.394 ms
rank = 0, Efermi =  -0.173980057926 calculate fermi energy took 0.038 ms
rank = 0, --- Calculate rho: sum over local bands took 2.178 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.751 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1226.681 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.598 ms
rank = 0, D2D took 0.785 ms
rank = 0, Transfering density took 0.792 ms
Etot    =   -24.724578166730
Eband   =    -7.587439483290
E1      =    18.066872923215
E2      =    -6.798199870440
E3      =    -9.769737305275
Exc     =    -8.681514817512
Esc     =   -43.086287247902
Entropy =    -0.004146716955
dE = 7.430e-07, dEband = 1.277e-04
rank = 0, Calculating/Estimating energy took 0.934 ms, Etot = -24.724578167, dEtot = 7.430e-07, dEband = 1.277e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0160682354206, which took 0.056 ms

iter_count = 108, r_2norm = 4.289e-07, tol*||rhs|| = 6.427e-07

Anderson update took 58.416 ms, out of which F'*F took 27.369 ms; b-Ax took 183.605 ms, out of which Lap took 165.350 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.204 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -17.00000001692766, int_rho =  17.00000001692764, int_b + int_rho = -1.819e-14, checking this took 0.123 ms
2-norm of RHS = 621.2623113649838, which took 0.062 ms

iter_count = 90, r_2norm = 6.078e-04, tol*||rhs|| = 6.213e-04

Anderson update took 49.032 ms, out of which F'*F took 23.152 ms; b-Ax took 153.182 ms, out of which Lap took 138.391 ms
Solving Poisson took 327.182 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.078279 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.747 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.094619 
Total time for convolution: 	 convolve: 5.095199 
Total time for convolution: 	 convolve: 5.086184 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.175 ms
---Transfer Veff_loc: D2D took 1.626 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.957 ms

This SCF took 26265.039 ms, scf error = 7.522e-05
The last 14 occupations of kpoints #1 are (Nelectron = 17):
lambda[   1] =  -0.81704739172527, occ[   1] =   2.00000000000000
lambda[   2] =  -0.65911114384677, occ[   2] =   2.00000000000000
lambda[   3] =  -0.50491418844473, occ[   3] =   2.00000000000000
lambda[   4] =  -0.46000987827222, occ[   4] =   2.00000000000000
lambda[   5] =  -0.37073757127794, occ[   5] =   2.00000000000000
lambda[   6] =  -0.35828822713318, occ[   6] =   2.00000000000000
lambda[   7] =  -0.30983390971808, occ[   7] =   2.00000000000000
lambda[   8] =  -0.22678740073587, occ[   8] =   2.00000000000000
lambda[   9] =  -0.17398005803650, occ[   9] =   1.00000001692766
lambda[  10] =  -0.02174207177507, occ[  10] =   0.00000000000000
lambda[  11] =  -0.01222702164382, occ[  11] =   0.00000000000000
lambda[  12] =   0.01142850955641, occ[  12] =   0.00000000000000
lambda[  13] =   0.02447338770542, occ[  13] =   0.00000000000000
lambda[  14] =   0.02808567976418, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.427 ms, time for Allreduce/Reduce: 8.015 ms 
Time for calculating local force components: 16.225 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00637812286554  -0.05030033751653   0.00000000035587
 -0.04799223712735  -0.02118923566104  -0.00000002479091
  0.00565137902533   0.05222000370350  -0.00000000453958
  0.04566203090927  -0.04336328189541  -0.00000000818474
 -0.03327659596483  -0.04463283927836   0.00000218764510
  0.00286282580892   0.01938108877060  -0.00000159392889
  0.22978197407703   0.80345278855369   0.00000134276811
force_loc = 
  0.00726630438464   0.05526089122959   0.00000036565917
  0.05112202543021   0.02222837765178  -0.00000000650429
 -0.00533178739021  -0.05560742192835  -0.00000042248067
 -0.04958402806567   0.04463657572575  -0.00000027300696
  0.04384385907503   0.03884097057325   0.00000082715609
 -0.00609384456118  -0.01481701318548   0.00000104717156
 -0.23057363233976  -0.78483108092828  -0.00000387263822
Time for calculating nonlocal force components: 23.822 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00113444281179  -0.00135363580954  -0.00000006004454
[0m[32m -0.00220314505672   0.00064000889694   0.00000004253002
[0m[32m -0.00356838174923  -0.02053222568930  -0.00000015265391
[0mTime for calculating XC forces components: 21.702 ms
 Cartesian force = 
  0.00088044140793   0.00495574896837   0.00000045251315
  0.00312204819170   0.00103433724605   0.00000005520291
  0.00031185152396  -0.00339222296953  -0.00000034052213
 -0.00392973726756   0.00126848908565  -0.00000019469359
  0.00942508018725  -0.00715030925934   0.00000304125476
 -0.00544190392015   0.00519927973737  -0.00000041772920
 -0.00436778012313  -0.00191532280857  -0.00000259602591
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Time for printing density: 388.140 ms
The program took 618.525 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:17
Job ID:        2266477
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:07:24,vmem=8340K,walltime=00:10:37,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-19-2
---------------------------------------
