---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:51
Job ID:    2266518
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:58
Job ID:    2266518
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.062 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 10.012 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 8.347 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 84.908 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.949 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.102 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   14.575793	
   10.000000	   10.000000	    5.424207	
   10.000000	   14.074964	   12.081978	
   10.000000	    5.925036	   12.081978	
   10.000000	   10.000000	   12.525110	
   10.000000	   10.000000	    7.480225	
   10.000000	   12.242833	   11.145804	
   10.000000	    7.757167	   11.145804	
   10.000000	   12.272437	    8.607307	
   10.000000	    7.727563	    8.607307	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.185 ms
Set up communicators.

--set up spincomm took 2.275 ms

--set up kptcomm took 0.349 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 23, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 23 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 23, mbQ = nbQ = 64
rank = 0, nr_Hp = 23, nc_Hp = 23
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.031 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.083 ms

Calculate_SplineDerivRadFun took 0.203 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.799 ms.
time spent on vectorized spline interp: 2.763 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.613 ms.
time spent on vectorized spline interp: 1.677 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.471 ms.
time spent on vectorized spline interp: 1.631 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.522 ms.

Calculating rb for all atom types took 15.484 ms
----------------------
Estimated memory usage
Total: 1.36 GB
orbitals             : 1.03 GB
global sized vectors : 213.62 MB
subspace matrices : 12.40 kB
others : 126.65 MB
----------------------------------------------
Estimated memory usage per processor: 116.10 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.051 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -30.0000000206883, sum_int_rho = 29.5788561373335
PosCharge = 30.000000020688, NegCharge = -29.578856137334, scal_fac = 1.014238004384
After scaling, int_rho = 30.0000000206885, PosCharge + NegCharge - NetCharge = -1.599e-13
--Calculate Vref took 0.633 ms
--Calculate rho_guess took 3.908 ms

 integral of b = -30.0000000206883,
 int{b} + Nelectron + NetCharge = -2.069e-08,
 Esc = -80.3550519371100,
 MPI_Reduce took 9.352 ms

Calculating b & b_ref took 22.194 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.067 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.076 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.077 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.623 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.008 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.009 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.002 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.013 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.659 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068842, int_b + int_rho = -1.928e-13, checking this took 0.556 ms
2-norm of RHS = 761.8695128522482, which took 0.513 ms

iter_count = 420, r_2norm = 7.239e-04, tol*||rhs|| = 7.619e-04

Anderson update took 235.853 ms, out of which F'*F took 107.366 ms; b-Ax took 724.116 ms, out of which Lap took 650.697 ms
Solving Poisson took 1526.583 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.463 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
Total time for convolution: 	 convolve: 5.160203 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.781 ms
Total time for convolution: 	 convolve: 5.140025 
Total time for convolution: 	 convolve: 5.112309 
Total time for convolution: 	 convolve: 5.103120 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.736 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.524 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.473 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
rank = 0, XC calculation took 24406.973 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 4.895 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.906 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 15.942 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.154 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.665 ms
    Lanczos iter 55, eigmin  = -0.990288852, eigmax = 264.948989366, err_eigmin = 5.222e-04, err_eigmax = 9.782e-03
rank =   0, Lanczos took 124.537 ms, eigmin = -0.990288852351, eigmax = 267.598479260075

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.254095, lowerbound = -1.090289, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1581.680 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.710 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.363 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.090 ms
rank =  0, finding HY took 26.764 ms
rank =  0, distributing HY into block cyclic form took 21.327 ms
rank =  0, finding Y'*HY took 6.096 ms
Rank 0, Project_Hamiltonian used 78.303 ms
Total time for projection: 79.274 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.531 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.277 ms
rank = 0, Solve_Generalized_EigenProblem used 1.813 ms
    first calculated eigval = 2.702103135261303
    last  calculated eigval = 3.263727765757443
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =   2.86215718843987
lambda[   7] =   2.88243104905027
lambda[   8] =   2.89190415991939
lambda[   9] =   2.93538581440730
lambda[  10] =   2.95610447154243
lambda[  11] =   2.96924091578453
lambda[  12] =   2.98243171728435
lambda[  13] =   3.00565638703111
lambda[  14] =   3.01997070168408
lambda[  15] =   3.05644362211677
lambda[  16] =   3.06395192065491
lambda[  17] =   3.09725982865116
lambda[  18] =   3.13304006102098
lambda[  19] =   3.14564906432830
lambda[  20] =   3.16560744178417
lambda[  21] =   3.17865148094762
lambda[  22] =   3.21777344570942
lambda[  23] =   3.26372776575744
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.828 ms
rank =  0, subspace rotation using ScaLAPACK took 8.631 ms
rank =  0, Distributing orbital back into band + domain format took 20.251 ms
rank = 0, Subspace_Rotation used 28.895 ms

Total time for subspace rotation: 28.898 ms
rank = 0, Efermi =   3.060197771473 calculate fermi energy took 0.051 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.363728, lowerbound = -1.090289, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1540.542 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.014 ms
rank =  0, Distribute orbital to block cyclic format took 28.753 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.217 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 31.994 ms
rank =  0, finding HY took 26.890 ms
rank =  0, distributing HY into block cyclic form took 19.356 ms
rank =  0, finding Y'*HY took 4.998 ms
Rank 0, Project_Hamiltonian used 83.275 ms
Total time for projection: 83.280 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.148 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.111 ms
rank = 0, Solve_Generalized_EigenProblem used 0.262 ms
    first calculated eigval = -0.819943338129275
    last  calculated eigval = 0.467775728842357
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.27615652372484
lambda[   7] =  -0.17910396064024
lambda[   8] =  -0.13892192278080
lambda[   9] =  -0.07403876986028
lambda[  10] =   0.03343202043314
lambda[  11] =   0.05507742576268
lambda[  12] =   0.10202725949439
lambda[  13] =   0.19701457205849
lambda[  14] =   0.25474663854427
lambda[  15] =   0.28010155810509
lambda[  16] =   0.31321932978820
lambda[  17] =   0.32171972873146
lambda[  18] =   0.34031344417468
lambda[  19] =   0.34673359634869
lambda[  20] =   0.37132442232532
lambda[  21] =   0.39768906486988
lambda[  22] =   0.42692837073622
lambda[  23] =   0.46777572884236
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.270 ms
rank =  0, subspace rotation using ScaLAPACK took 8.573 ms
rank =  0, Distributing orbital back into band + domain format took 20.097 ms
rank = 0, Subspace_Rotation used 28.685 ms

Total time for subspace rotation: 28.690 ms
rank = 0, Efermi =   0.296659713250 calculate fermi energy took 0.027 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.567776, lowerbound = -1.090289, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1542.604 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 29.074 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.209 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 32.304 ms
rank =  0, finding HY took 26.939 ms
rank =  0, distributing HY into block cyclic form took 19.273 ms
rank =  0, finding Y'*HY took 5.041 ms
Rank 0, Project_Hamiltonian used 84.517 ms
Total time for projection: 84.521 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.162 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.264 ms
    first calculated eigval = -0.995072546434046
    last  calculated eigval = 0.146314690620538
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.57594998638166
lambda[   7] =  -0.57230381818670
lambda[   8] =  -0.51841562434152
lambda[   9] =  -0.46277740439310
lambda[  10] =  -0.45160616969998
lambda[  11] =  -0.41898440071298
lambda[  12] =  -0.34520972414436
lambda[  13] =  -0.33536808169962
lambda[  14] =  -0.31118073684835
lambda[  15] =  -0.27629451136293
lambda[  16] =  -0.11025898685990
lambda[  17] =  -0.07352341629562
lambda[  18] =   0.06949395810335
lambda[  19] =   0.09042003360126
lambda[  20] =   0.10339842879653
lambda[  21] =   0.11539605699783
lambda[  22] =   0.13287513436291
lambda[  23] =   0.14631469062054
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.272 ms
rank =  0, subspace rotation using ScaLAPACK took 8.569 ms
rank =  0, Distributing orbital back into band + domain format took 20.169 ms
rank = 0, Subspace_Rotation used 28.755 ms

Total time for subspace rotation: 28.760 ms
rank = 0, Efermi =  -0.139394892334 calculate fermi energy took 0.028 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.246315, lowerbound = -1.090289, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1542.940 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 23.598 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.123 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.740 ms
rank =  0, finding HY took 26.906 ms
rank =  0, distributing HY into block cyclic form took 19.311 ms
rank =  0, finding Y'*HY took 4.985 ms
Rank 0, Project_Hamiltonian used 77.969 ms
Total time for projection: 77.973 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.157 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.248 ms
    first calculated eigval = -0.995417788123098
    last  calculated eigval = 0.096160630280973
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.58087530595623
lambda[   7] =  -0.57956753571816
lambda[   8] =  -0.52504565749944
lambda[   9] =  -0.47585795490331
lambda[  10] =  -0.45859578012769
lambda[  11] =  -0.45495664965509
lambda[  12] =  -0.36587840470314
lambda[  13] =  -0.36483836494863
lambda[  14] =  -0.34048970699279
lambda[  15] =  -0.32046488632657
lambda[  16] =  -0.15466916482130
lambda[  17] =  -0.13499987442035
lambda[  18] =   0.01095157311722
lambda[  19] =   0.03408790018647
lambda[  20] =   0.04474102722664
lambda[  21] =   0.05861247328579
lambda[  22] =   0.06634683955171
lambda[  23] =   0.09616063028097
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.257 ms
rank =  0, subspace rotation using ScaLAPACK took 8.549 ms
rank =  0, Distributing orbital back into band + domain format took 19.598 ms
rank = 0, Subspace_Rotation used 29.087 ms

Total time for subspace rotation: 29.091 ms
rank = 0, Efermi =  -0.183805070342 calculate fermi energy took 0.027 ms
rank = 0, --- Calculate rho: sum over local bands took 5.577 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.085 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.567 ms
rank = 0, Calculating density took 6795.186 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.814 ms
rank = 0, D2D took 1.914 ms
rank = 0, Transfering density took 1.920 ms
Etot    =   -47.323971019743
Eband   =   -17.214229478552
E1      =    34.907600244803
E2      =   -13.687077575565
E3      =   -17.028690300105
Exc     =   -15.378057723934
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 4.732e+00, dEband = 1.721e+00
rank = 0, Calculating/Estimating energy took 0.906 ms, Etot = -47.323971020, dEtot = 4.732e+00, dEband = 1.721e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 57.3713278088474, which took 0.044 ms

iter_count = 96, r_2norm = 1.737e-03, tol*||rhs|| = 2.295e-03

Anderson update took 51.488 ms, out of which F'*F took 23.944 ms; b-Ax took 161.784 ms, out of which Lap took 144.465 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.938 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068852, int_b + int_rho = -9.095e-14, checking this took 0.120 ms
2-norm of RHS = 757.1684276287450, which took 0.899 ms

iter_count = 282, r_2norm = 7.382e-04, tol*||rhs|| = 7.572e-04

Anderson update took 151.189 ms, out of which F'*F took 70.249 ms; b-Ax took 476.715 ms, out of which Lap took 424.724 ms
Solving Poisson took 1013.155 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.416 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.238284 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.172025 
Total time for convolution: 	 convolve: 5.265260 
Total time for convolution: 	 convolve: 5.169120 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.014 ms
======D2D: initiated sending and receiving took 0.857 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.490 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.951 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.473 ms

This SCF took 33082.702 ms, scf error = 1.828e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.196161, lowerbound = -0.995418, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1565.644 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.620 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.018 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.658 ms
rank =  0, finding HY took 26.827 ms
rank =  0, distributing HY into block cyclic form took 19.828 ms
rank =  0, finding Y'*HY took 5.520 ms
Rank 0, Project_Hamiltonian used 74.863 ms
Total time for projection: 74.873 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.153 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.252 ms
    first calculated eigval = -0.970050542219679
    last  calculated eigval = 0.073058602283555
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.55698661450799
lambda[   7] =  -0.54591300198628
lambda[   8] =  -0.49629416368240
lambda[   9] =  -0.44885260269340
lambda[  10] =  -0.43559947994969
lambda[  11] =  -0.43557479824979
lambda[  12] =  -0.34252641646850
lambda[  13] =  -0.33246245440746
lambda[  14] =  -0.31857258655863
lambda[  15] =  -0.28606898645395
lambda[  16] =  -0.13457303353045
lambda[  17] =  -0.12019631929700
lambda[  18] =  -0.00717039354444
lambda[  19] =   0.01662240160899
lambda[  20] =   0.02851661399699
lambda[  21] =   0.03017929174814
lambda[  22] =   0.04007430449875
lambda[  23] =   0.07305860228355
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.264 ms
rank =  0, subspace rotation using ScaLAPACK took 9.287 ms
rank =  0, Distributing orbital back into band + domain format took 19.561 ms
rank = 0, Subspace_Rotation used 28.865 ms

Total time for subspace rotation: 28.871 ms
rank = 0, Efermi =  -0.163708939057 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.475 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.916 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.578 ms
rank = 0, Calculating density took 1687.109 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.808 ms
rank = 0, D2D took 1.931 ms
rank = 0, Transfering density took 1.934 ms
Etot    =   -47.256113835383
Eband   =   -16.393864711113
E1      =    34.176576621083
E2      =   -13.625300263440
E3      =   -17.243438248112
Exc     =   -15.552512319175
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 6.786e-03, dEband = 8.204e-02
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -47.256113835, dEtot = 6.786e-03, dEband = 8.204e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 20.8360187793697, which took 0.053 ms

iter_count = 102, r_2norm = 6.456e-04, tol*||rhs|| = 8.334e-04

Anderson update took 54.781 ms, out of which F'*F took 25.120 ms; b-Ax took 170.901 ms, out of which Lap took 152.927 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.086 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068845, int_b + int_rho = -1.637e-13, checking this took 0.108 ms
2-norm of RHS = 751.1812116739121, which took 0.142 ms

iter_count = 300, r_2norm = 6.631e-04, tol*||rhs|| = 7.512e-04

Anderson update took 160.451 ms, out of which F'*F took 74.635 ms; b-Ax took 506.299 ms, out of which Lap took 452.191 ms
Solving Poisson took 1076.787 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Total time for convolution: 	 convolve: 5.158861 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 41.015 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.147202 
Total time for convolution: 	 convolve: 5.161451 
Total time for convolution: 	 convolve: 5.160875 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 3.533 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.941 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.506 ms

This SCF took 27919.375 ms, scf error = 1.252e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.173059, lowerbound = -0.970051, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1557.791 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 30.496 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.924 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 34.437 ms
rank =  0, finding HY took 27.225 ms
rank =  0, distributing HY into block cyclic form took 19.285 ms
rank =  0, finding Y'*HY took 4.993 ms
Rank 0, Project_Hamiltonian used 85.971 ms
Total time for projection: 85.982 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.147 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.232 ms
    first calculated eigval = -0.926419780387438
    last  calculated eigval = 0.061885186176982
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.50974840267595
lambda[   7] =  -0.48753172405835
lambda[   8] =  -0.44327977507537
lambda[   9] =  -0.40273261190187
lambda[  10] =  -0.39635719143128
lambda[  11] =  -0.38908500676892
lambda[  12] =  -0.30653256955682
lambda[  13] =  -0.28014014797417
lambda[  14] =  -0.27907769294581
lambda[  15] =  -0.23232167537194
lambda[  16] =  -0.09661850295345
lambda[  17] =  -0.08446464115021
lambda[  18] =  -0.02218772166063
lambda[  19] =   0.01761241221930
lambda[  20] =   0.02363566059297
lambda[  21] =   0.03068328008368
lambda[  22] =   0.04390491194841
lambda[  23] =   0.06188518617698
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.630 ms
rank =  0, subspace rotation using ScaLAPACK took 9.226 ms
rank =  0, Distributing orbital back into band + domain format took 19.841 ms
rank = 0, Subspace_Rotation used 29.085 ms

Total time for subspace rotation: 29.092 ms
rank = 0, Efermi =  -0.125754408572 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.449 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.932 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.596 ms
rank = 0, Calculating density took 1690.593 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.846 ms
rank = 0, D2D took 1.947 ms
rank = 0, Transfering density took 1.951 ms
Etot    =   -47.196576769048
Eband   =   -14.948022634526
E1      =    32.947674657775
E2      =   -13.388686710389
E3      =   -17.661089775928
Exc     =   -15.890953340884
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 5.954e-03, dEband = 1.446e-01
rank = 0, Calculating/Estimating energy took 0.904 ms, Etot = -47.196576769, dEtot = 5.954e-03, dEband = 1.446e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.8910310966201, which took 0.051 ms

iter_count = 108, r_2norm = 1.588e-04, tol*||rhs|| = 2.356e-04

Anderson update took 58.220 ms, out of which F'*F took 26.939 ms; b-Ax took 181.486 ms, out of which Lap took 163.287 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.553 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068840, int_b + int_rho = -2.110e-13, checking this took 0.113 ms
2-norm of RHS = 751.3720595818613, which took 0.108 ms

iter_count = 276, r_2norm = 6.081e-04, tol*||rhs|| = 7.514e-04

Anderson update took 151.736 ms, out of which F'*F took 70.029 ms; b-Ax took 470.747 ms, out of which Lap took 423.415 ms
Solving Poisson took 998.125 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.166008 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.272 ms
Total time for convolution: 	 convolve: 5.166503 
Total time for convolution: 	 convolve: 5.164291 
Total time for convolution: 	 convolve: 5.146641 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 0.261 ms
---Transfer Veff_loc: D2D took 3.565 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.929 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.524 ms

This SCF took 27824.254 ms, scf error = 3.765e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.161885, lowerbound = -0.926420, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1558.831 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.411 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.175 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.603 ms
rank =  0, finding HY took 26.751 ms
rank =  0, distributing HY into block cyclic form took 19.616 ms
rank =  0, finding Y'*HY took 5.075 ms
Rank 0, Project_Hamiltonian used 74.466 ms
Total time for projection: 74.478 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.232 ms
    first calculated eigval = -0.914742534807615
    last  calculated eigval = 0.058877523740783
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.49467192715251
lambda[   7] =  -0.47379880427447
lambda[   8] =  -0.42953547042646
lambda[   9] =  -0.39409688864563
lambda[  10] =  -0.38172539971677
lambda[  11] =  -0.37429744613090
lambda[  12] =  -0.29855365819550
lambda[  13] =  -0.27087909283060
lambda[  14] =  -0.26786391994874
lambda[  15] =  -0.22158685866588
lambda[  16] =  -0.08760155244063
lambda[  17] =  -0.07490648825821
lambda[  18] =  -0.02720229845196
lambda[  19] =   0.01608716868342
lambda[  20] =   0.02075428004369
lambda[  21] =   0.02927248664515
lambda[  22] =   0.03751758334413
lambda[  23] =   0.05887752374078
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.247 ms
rank =  0, subspace rotation using ScaLAPACK took 8.742 ms
rank =  0, Distributing orbital back into band + domain format took 19.980 ms
rank = 0, Subspace_Rotation used 28.737 ms

Total time for subspace rotation: 28.741 ms
rank = 0, Efermi =  -0.116737457899 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.485 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.781 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.580 ms
rank = 0, Calculating density took 1680.271 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.017 ms
rank = 0, D2D took 2.124 ms
rank = 0, Transfering density took 2.130 ms
Etot    =   -47.191395587102
Eband   =   -14.580693268067
E1      =    32.698012661344
E2      =   -13.252651347276
E3      =   -17.768242260467
Exc     =   -15.974556650390
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 5.181e-04, dEband = 3.673e-02
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -47.191395587, dEtot = 5.181e-04, dEband = 3.673e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.8794520265792, which took 0.082 ms

iter_count = 108, r_2norm = 7.253e-05, tol*||rhs|| = 7.518e-05

Anderson update took 57.755 ms, out of which F'*F took 27.111 ms; b-Ax took 181.724 ms, out of which Lap took 163.374 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.396 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068852, int_b + int_rho = -8.731e-14, checking this took 0.105 ms
2-norm of RHS = 752.5686404170634, which took 0.115 ms

iter_count = 264, r_2norm = 6.727e-04, tol*||rhs|| = 7.526e-04

Anderson update took 141.093 ms, out of which F'*F took 65.845 ms; b-Ax took 447.648 ms, out of which Lap took 401.064 ms
Solving Poisson took 948.094 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.171150 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.167196 
Total time for convolution: 	 convolve: 5.194297 
Total time for convolution: 	 convolve: 5.215532 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.160 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.497 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.645 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.175 ms

This SCF took 27814.872 ms, scf error = 1.621e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.158878, lowerbound = -0.914743, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1553.659 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 27.045 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.215 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 30.277 ms
rank =  0, finding HY took 26.580 ms
rank =  0, distributing HY into block cyclic form took 19.339 ms
rank =  0, finding Y'*HY took 5.008 ms
Rank 0, Project_Hamiltonian used 81.234 ms
Total time for projection: 81.245 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.139 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.223 ms
    first calculated eigval = -0.908057127238822
    last  calculated eigval = 0.056308480706240
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.48741100082598
lambda[   7] =  -0.46796307230853
lambda[   8] =  -0.42293979651362
lambda[   9] =  -0.38908336283216
lambda[  10] =  -0.37516083414987
lambda[  11] =  -0.36671271857636
lambda[  12] =  -0.29369107631318
lambda[  13] =  -0.26683424019870
lambda[  14] =  -0.26154496814460
lambda[  15] =  -0.21538796961025
lambda[  16] =  -0.08323389627910
lambda[  17] =  -0.07033106425991
lambda[  18] =  -0.02865964911812
lambda[  19] =   0.01592484372980
lambda[  20] =   0.01913549467858
lambda[  21] =   0.02781420816474
lambda[  22] =   0.03073889002839
lambda[  23] =   0.05630848070624
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.236 ms
rank =  0, subspace rotation using ScaLAPACK took 8.704 ms
rank =  0, Distributing orbital back into band + domain format took 19.802 ms
rank = 0, Subspace_Rotation used 28.521 ms

Total time for subspace rotation: 28.526 ms
rank = 0, Efermi =  -0.112369801758 calculate fermi energy took 0.917 ms
rank = 0, --- Calculate rho: sum over local bands took 5.459 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.850 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.595 ms
rank = 0, Calculating density took 1681.561 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.832 ms
rank = 0, D2D took 1.934 ms
rank = 0, Transfering density took 1.940 ms
Etot    =   -47.189796337144
Eband   =   -14.397893460821
E1      =    32.625977974664
E2      =   -13.130228350470
E3      =   -17.811864014466
Exc     =   -16.004921278191
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 1.599e-04, dEband = 1.828e-02
rank = 0, Calculating/Estimating energy took 0.940 ms, Etot = -47.189796337, dEtot = 1.599e-04, dEband = 1.828e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9055696667480, which took 0.064 ms

iter_count = 108, r_2norm = 3.556e-05, tol*||rhs|| = 3.622e-05

Anderson update took 57.198 ms, out of which F'*F took 27.102 ms; b-Ax took 183.548 ms, out of which Lap took 164.369 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.190 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068849, int_b + int_rho = -1.237e-13, checking this took 0.124 ms
2-norm of RHS = 752.9368199390834, which took 0.102 ms

iter_count = 240, r_2norm = 6.279e-04, tol*||rhs|| = 7.529e-04

Anderson update took 127.695 ms, out of which F'*F took 59.644 ms; b-Ax took 405.765 ms, out of which Lap took 363.401 ms
Solving Poisson took 860.815 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.660 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.147673 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.561 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.158751 
Total time for convolution: 	 convolve: 5.162356 
Total time for convolution: 	 convolve: 5.168102 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 3.508 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.604 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.488 ms

This SCF took 27607.800 ms, scf error = 5.584e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.156308, lowerbound = -0.908057, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1567.479 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.467 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.114 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.600 ms
rank =  0, finding HY took 26.731 ms
rank =  0, distributing HY into block cyclic form took 19.297 ms
rank =  0, finding Y'*HY took 4.932 ms
Rank 0, Project_Hamiltonian used 73.590 ms
Total time for projection: 73.602 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -0.905676314124173
    last  calculated eigval = 0.050818195750601
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.48552446494335
lambda[   7] =  -0.46578353670331
lambda[   8] =  -0.42082104370959
lambda[   9] =  -0.38696680387418
lambda[  10] =  -0.37314891840590
lambda[  11] =  -0.36481341343980
lambda[  12] =  -0.29134691500134
lambda[  13] =  -0.26494934763244
lambda[  14] =  -0.25886816911917
lambda[  15] =  -0.21263249040474
lambda[  16] =  -0.08129906661201
lambda[  17] =  -0.06858722607073
lambda[  18] =  -0.02914173277779
lambda[  19] =   0.01568704448198
lambda[  20] =   0.01834818367293
lambda[  21] =   0.02316596300653
lambda[  22] =   0.02982190941656
lambda[  23] =   0.05081819575060
==subpsace eigenproblem: bcast eigvals took 0.089 ms
Total time for solving subspace eigenvalue problem: 0.323 ms
rank =  0, subspace rotation using ScaLAPACK took 8.755 ms
rank =  0, Distributing orbital back into band + domain format took 19.808 ms
rank = 0, Subspace_Rotation used 28.578 ms

Total time for subspace rotation: 28.583 ms
rank = 0, Efermi =  -0.110434972069 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.529 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.900 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.573 ms
rank = 0, Calculating density took 1687.105 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.828 ms
rank = 0, D2D took 1.928 ms
rank = 0, Transfering density took 1.933 ms
Etot    =   -47.189478777266
Eband   =   -14.331780109050
E1      =    32.603250645776
E2      =   -13.083848210567
E3      =   -17.820163723750
Exc     =   -16.009909310579
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 3.176e-05, dEband = 6.611e-03
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -47.189478777, dEtot = 3.176e-05, dEband = 6.611e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4529239621391, which took 0.059 ms

iter_count = 114, r_2norm = 1.109e-05, tol*||rhs|| = 1.812e-05

Anderson update took 60.023 ms, out of which F'*F took 28.548 ms; b-Ax took 193.908 ms, out of which Lap took 172.948 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.661 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068839, int_b + int_rho = -2.256e-13, checking this took 0.077 ms
2-norm of RHS = 753.1998789523982, which took 0.128 ms

iter_count = 246, r_2norm = 6.321e-04, tol*||rhs|| = 7.532e-04

Anderson update took 131.942 ms, out of which F'*F took 61.249 ms; b-Ax took 416.596 ms, out of which Lap took 372.723 ms
Solving Poisson took 885.130 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.172645 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.209698 
Total time for convolution: 	 convolve: 5.189103 
Total time for convolution: 	 convolve: 5.168361 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.781 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.598 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.419 ms
---Transfer Veff_loc: D2D took 3.504 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.127 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.661 ms

This SCF took 27790.018 ms, scf error = 3.405e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.150818, lowerbound = -0.905676, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1568.849 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.378 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.215 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.614 ms
rank =  0, finding HY took 26.762 ms
rank =  0, distributing HY into block cyclic form took 19.380 ms
rank =  0, finding Y'*HY took 4.861 ms
Rank 0, Project_Hamiltonian used 73.651 ms
Total time for projection: 73.666 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.104 ms
rank = 0, Solve_Generalized_EigenProblem used 0.244 ms
    first calculated eigval = -0.901855222320746
    last  calculated eigval = 0.043779348685020
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.48177832748354
lambda[   7] =  -0.46171103958186
lambda[   8] =  -0.41726612120855
lambda[   9] =  -0.38345969136310
lambda[  10] =  -0.36926618385736
lambda[  11] =  -0.36121325424830
lambda[  12] =  -0.28779591166397
lambda[  13] =  -0.26139182234034
lambda[  14] =  -0.25496197119908
lambda[  15] =  -0.20872885233984
lambda[  16] =  -0.07784987756185
lambda[  17] =  -0.06518116357258
lambda[  18] =  -0.02851538005962
lambda[  19] =   0.01671252759952
lambda[  20] =   0.01850243293877
lambda[  21] =   0.02122759376337
lambda[  22] =   0.03098684307471
lambda[  23] =   0.04377934868502
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.267 ms
rank =  0, subspace rotation using ScaLAPACK took 8.713 ms
rank =  0, Distributing orbital back into band + domain format took 19.797 ms
rank = 0, Subspace_Rotation used 28.528 ms

Total time for subspace rotation: 28.535 ms
rank = 0, Efermi =  -0.106985783077 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 5.485 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.006 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.603 ms
rank = 0, Calculating density took 1688.542 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.845 ms
rank = 0, D2D took 1.945 ms
rank = 0, Transfering density took 1.950 ms
Etot    =   -47.189188904381
Eband   =   -14.217980393630
E1      =    32.548058717456
E2      =   -13.020980063719
E3      =   -17.835291605586
Exc     =   -16.020486959782
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 2.899e-05, dEband = 1.138e-02
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -47.189188904, dEtot = 2.899e-05, dEband = 1.138e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2744644365212, which took 0.089 ms

iter_count = 108, r_2norm = 1.000e-05, tol*||rhs|| = 1.098e-05

Anderson update took 57.662 ms, out of which F'*F took 27.152 ms; b-Ax took 182.004 ms, out of which Lap took 163.924 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.664 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068852, int_b + int_rho = -8.731e-14, checking this took 0.097 ms
2-norm of RHS = 753.1676863066247, which took 0.132 ms

iter_count = 234, r_2norm = 6.159e-04, tol*||rhs|| = 7.532e-04

Anderson update took 125.429 ms, out of which F'*F took 59.055 ms; b-Ax took 395.427 ms, out of which Lap took 355.316 ms
Solving Poisson took 841.948 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.160231 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.171119 
Total time for convolution: 	 convolve: 5.153023 
Total time for convolution: 	 convolve: 5.164571 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.716 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.164 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.412 ms
---Transfer Veff_loc: D2D took 3.474 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.147 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.656 ms

This SCF took 27880.793 ms, scf error = 1.763e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.143779, lowerbound = -0.901855, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1564.901 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.454 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.102 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.574 ms
rank =  0, finding HY took 26.726 ms
rank =  0, distributing HY into block cyclic form took 19.386 ms
rank =  0, finding Y'*HY took 4.871 ms
Rank 0, Project_Hamiltonian used 73.584 ms
Total time for projection: 73.594 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.135 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.240 ms
    first calculated eigval = -0.898764972301616
    last  calculated eigval = 0.036428568397481
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47914479611911
lambda[   7] =  -0.45874119784629
lambda[   8] =  -0.41497644740963
lambda[   9] =  -0.38068834806534
lambda[  10] =  -0.36667925225344
lambda[  11] =  -0.35838922206123
lambda[  12] =  -0.28496056104593
lambda[  13] =  -0.25887104461736
lambda[  14] =  -0.25175609226281
lambda[  15] =  -0.20549572123302
lambda[  16] =  -0.07517983476567
lambda[  17] =  -0.06250251977850
lambda[  18] =  -0.02683887833185
lambda[  19] =   0.01882881770209
lambda[  20] =   0.01959934220849
lambda[  21] =   0.02189462307197
lambda[  22] =   0.03220093022621
lambda[  23] =   0.03642856839748
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.265 ms
rank =  0, subspace rotation using ScaLAPACK took 8.712 ms
rank =  0, Distributing orbital back into band + domain format took 19.696 ms
rank = 0, Subspace_Rotation used 28.422 ms

Total time for subspace rotation: 28.428 ms
rank = 0, Efermi =  -0.104315740258 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.513 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.003 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.563 ms
rank = 0, Calculating density took 1684.388 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.803 ms
rank = 0, D2D took 2.907 ms
rank = 0, Transfering density took 2.914 ms
Etot    =   -47.189164682235
Eband   =   -14.133016307713
E1      =    32.502122637487
E2      =   -12.979641830237
E3      =   -17.844554159341
Exc     =   -16.027415063856
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 2.422e-06, dEband = 8.496e-03
rank = 0, Calculating/Estimating energy took 0.901 ms, Etot = -47.189164682, dEtot = 2.422e-06, dEband = 8.496e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1908950633766, which took 0.054 ms

iter_count = 114, r_2norm = 5.822e-06, tol*||rhs|| = 7.636e-06

Anderson update took 60.625 ms, out of which F'*F took 28.254 ms; b-Ax took 192.798 ms, out of which Lap took 171.982 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.326 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068846, int_b + int_rho = -1.528e-13, checking this took 0.103 ms
2-norm of RHS = 753.1995261710565, which took 0.118 ms

iter_count = 180, r_2norm = 7.506e-04, tol*||rhs|| = 7.532e-04

Anderson update took 96.246 ms, out of which F'*F took 45.321 ms; b-Ax took 304.862 ms, out of which Lap took 273.375 ms
Solving Poisson took 649.554 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Total time for convolution: 	 convolve: 5.174100 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.177817 
Total time for convolution: 	 convolve: 5.172459 
Total time for convolution: 	 convolve: 5.175260 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.543 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.479 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.136 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.647 ms

This SCF took 27452.597 ms, scf error = 1.123e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.136429, lowerbound = -0.898765, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1579.834 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.431 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.202 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.653 ms
rank =  0, finding HY took 26.585 ms
rank =  0, distributing HY into block cyclic form took 19.332 ms
rank =  0, finding Y'*HY took 4.942 ms
Rank 0, Project_Hamiltonian used 73.541 ms
Total time for projection: 73.554 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.230 ms
    first calculated eigval = -0.898512801134422
    last  calculated eigval = 0.032443417284067
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47890490396513
lambda[   7] =  -0.45855682935066
lambda[   8] =  -0.41473185968452
lambda[   9] =  -0.38042532035545
lambda[  10] =  -0.36645232308201
lambda[  11] =  -0.35815082014597
lambda[  12] =  -0.28469886412895
lambda[  13] =  -0.25862900000673
lambda[  14] =  -0.25153460643798
lambda[  15] =  -0.20527818601801
lambda[  16] =  -0.07494015383197
lambda[  17] =  -0.06225370547077
lambda[  18] =  -0.02636882688132
lambda[  19] =   0.01841723021311
lambda[  20] =   0.01994038421650
lambda[  21] =   0.02186523318441
lambda[  22] =   0.02916860558272
lambda[  23] =   0.03244341728407
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.252 ms
rank =  0, subspace rotation using ScaLAPACK took 8.730 ms
rank =  0, Distributing orbital back into band + domain format took 19.824 ms
rank = 0, Subspace_Rotation used 28.570 ms

Total time for subspace rotation: 28.575 ms
rank = 0, Efermi =  -0.104076059357 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.480 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.540 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.607 ms
rank = 0, Calculating density took 1699.435 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.834 ms
rank = 0, D2D took 1.935 ms
rank = 0, Transfering density took 1.940 ms
Etot    =   -47.189194353810
Eband   =   -14.126081672897
E1      =    32.500935515328
E2      =   -12.973883996454
E3      =   -17.844032504338
Exc     =   -16.026912759302
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 2.967e-06, dEband = 6.935e-04
rank = 0, Calculating/Estimating energy took 0.934 ms, Etot = -47.189194354, dEtot = 2.967e-06, dEband = 6.935e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1053367341181, which took 0.054 ms

iter_count = 108, r_2norm = 4.020e-06, tol*||rhs|| = 4.213e-06

Anderson update took 57.565 ms, out of which F'*F took 27.038 ms; b-Ax took 182.580 ms, out of which Lap took 163.364 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.331 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068847, int_b + int_rho = -1.346e-13, checking this took 0.129 ms
2-norm of RHS = 753.1743823401297, which took 0.146 ms

iter_count = 216, r_2norm = 6.785e-04, tol*||rhs|| = 7.532e-04

Anderson update took 115.483 ms, out of which F'*F took 54.164 ms; b-Ax took 365.228 ms, out of which Lap took 327.004 ms
Solving Poisson took 777.308 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.154292 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 14.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.183681 
Total time for convolution: 	 convolve: 5.155806 
Total time for convolution: 	 convolve: 5.180366 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.728 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.500 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.142 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.674 ms

This SCF took 27606.946 ms, scf error = 8.745e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.132443, lowerbound = -0.898513, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1555.067 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 30.567 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.301 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 33.892 ms
rank =  0, finding HY took 26.589 ms
rank =  0, distributing HY into block cyclic form took 19.301 ms
rank =  0, finding Y'*HY took 4.894 ms
Rank 0, Project_Hamiltonian used 84.704 ms
Total time for projection: 84.711 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.230 ms
    first calculated eigval = -0.896954871484753
    last  calculated eigval = 0.034731979998172
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47733550756344
lambda[   7] =  -0.45703554645925
lambda[   8] =  -0.41322425559220
lambda[   9] =  -0.37889063332580
lambda[  10] =  -0.36488906464668
lambda[  11] =  -0.35659680741918
lambda[  12] =  -0.28317416709503
lambda[  13] =  -0.25709043532477
lambda[  14] =  -0.25002342348610
lambda[  15] =  -0.20378642639694
lambda[  16] =  -0.07338962757070
lambda[  17] =  -0.06066001918117
lambda[  18] =  -0.02232728181484
lambda[  19] =   0.02087827604617
lambda[  20] =   0.02488411512558
lambda[  21] =   0.02585858924060
lambda[  22] =   0.03024495675271
lambda[  23] =   0.03473197999817
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.255 ms
rank =  0, subspace rotation using ScaLAPACK took 9.292 ms
rank =  0, Distributing orbital back into band + domain format took 19.754 ms
rank = 0, Subspace_Rotation used 29.064 ms

Total time for subspace rotation: 29.094 ms
rank = 0, Efermi =  -0.102525533089 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.469 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.026 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.600 ms
rank = 0, Calculating density took 1686.717 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.841 ms
rank = 0, D2D took 1.944 ms
rank = 0, Transfering density took 1.949 ms
Etot    =   -47.189275812239
Eband   =   -14.079941567119
E1      =    32.478446621426
E2      =   -12.949728032756
E3      =   -17.846362938128
Exc     =   -16.028819899698
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 8.146e-06, dEband = 4.614e-03
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -47.189275812, dEtot = 8.146e-06, dEband = 4.614e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0755382605477, which took 0.055 ms

iter_count = 114, r_2norm = 2.149e-06, tol*||rhs|| = 3.022e-06

Anderson update took 60.566 ms, out of which F'*F took 28.711 ms; b-Ax took 193.461 ms, out of which Lap took 173.439 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.344 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068846, int_b + int_rho = -1.455e-13, checking this took 0.139 ms
2-norm of RHS = 753.1720083975288, which took 0.148 ms

iter_count = 168, r_2norm = 7.304e-04, tol*||rhs|| = 7.532e-04

Anderson update took 90.106 ms, out of which F'*F took 42.449 ms; b-Ax took 283.977 ms, out of which Lap took 254.887 ms
Solving Poisson took 605.656 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.167154 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.157074 
Total time for convolution: 	 convolve: 5.189799 
Total time for convolution: 	 convolve: 5.166757 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.547 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.497 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.127 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.656 ms

This SCF took 27379.714 ms, scf error = 4.559e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.134732, lowerbound = -0.896955, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1572.897 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.863 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.200 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.081 ms
rank =  0, finding HY took 26.595 ms
rank =  0, distributing HY into block cyclic form took 19.372 ms
rank =  0, finding Y'*HY took 4.834 ms
Rank 0, Project_Hamiltonian used 73.917 ms
Total time for projection: 73.929 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.230 ms
    first calculated eigval = -0.896423917460387
    last  calculated eigval = 0.033973013966404
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47686165502941
lambda[   7] =  -0.45649816825507
lambda[   8] =  -0.41278905088383
lambda[   9] =  -0.37839188572194
lambda[  10] =  -0.36440333233932
lambda[  11] =  -0.35611909240176
lambda[  12] =  -0.28265702462464
lambda[  13] =  -0.25661776322300
lambda[  14] =  -0.24948621351283
lambda[  15] =  -0.20324898198610
lambda[  16] =  -0.07289536245668
lambda[  17] =  -0.06019062066205
lambda[  18] =  -0.02160231824196
lambda[  19] =   0.02121444036974
lambda[  20] =   0.02503038276831
lambda[  21] =   0.02645746096214
lambda[  22] =   0.02955793205309
lambda[  23] =   0.03397301396640
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.248 ms
rank =  0, subspace rotation using ScaLAPACK took 8.737 ms
rank =  0, Distributing orbital back into band + domain format took 19.793 ms
rank = 0, Subspace_Rotation used 28.550 ms

Total time for subspace rotation: 29.079 ms
rank = 0, Efermi =  -0.102031267921 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 5.545 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.908 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1693.719 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.847 ms
rank = 0, D2D took 1.945 ms
rank = 0, Transfering density took 1.950 ms
Etot    =   -47.189346973000
Eband   =   -14.064780894095
E1      =    32.469935007970
E2      =   -12.942690263088
E3      =   -17.847956478411
Exc     =   -16.030095890643
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 7.116e-06, dEband = 1.516e-03
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -47.189346973, dEtot = 7.116e-06, dEband = 1.516e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0721891359519, which took 0.107 ms

iter_count = 108, r_2norm = 2.019e-06, tol*||rhs|| = 2.888e-06

Anderson update took 57.717 ms, out of which F'*F took 27.210 ms; b-Ax took 182.503 ms, out of which Lap took 163.615 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.277 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068848, int_b + int_rho = -1.310e-13, checking this took 0.103 ms
2-norm of RHS = 753.2027292279432, which took 0.134 ms

iter_count = 186, r_2norm = 6.304e-04, tol*||rhs|| = 7.532e-04

Anderson update took 99.581 ms, out of which F'*F took 46.772 ms; b-Ax took 314.268 ms, out of which Lap took 281.900 ms
Solving Poisson took 670.358 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.161659 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.153578 
Total time for convolution: 	 convolve: 5.175991 
Total time for convolution: 	 convolve: 5.166133 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.632 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.522 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.147 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.701 ms

This SCF took 27406.605 ms, scf error = 3.582e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.133973, lowerbound = -0.896424, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1568.108 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.364 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.183 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.567 ms
rank =  0, finding HY took 26.629 ms
rank =  0, distributing HY into block cyclic form took 19.353 ms
rank =  0, finding Y'*HY took 4.996 ms
Rank 0, Project_Hamiltonian used 73.577 ms
Total time for projection: 73.589 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.647 ms
rank = 0, Solve_Generalized_EigenProblem used 1.181 ms
    first calculated eigval = -0.895851954000374
    last  calculated eigval = 0.034666455772408
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47627651827533
lambda[   7] =  -0.45595030372674
lambda[   8] =  -0.41225098589709
lambda[   9] =  -0.37779752920748
lambda[  10] =  -0.36383240483452
lambda[  11] =  -0.35555380588588
lambda[  12] =  -0.28207401241596
lambda[  13] =  -0.25603769289065
lambda[  14] =  -0.24896512276881
lambda[  15] =  -0.20274329339986
lambda[  16] =  -0.07232134623112
lambda[  17] =  -0.05960086953652
lambda[  18] =  -0.01804409854676
lambda[  19] =   0.02518561530986
lambda[  20] =   0.02909699860060
lambda[  21] =   0.02944854710730
lambda[  22] =   0.03271678313952
lambda[  23] =   0.03466645577241
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 1.198 ms
rank =  0, subspace rotation using ScaLAPACK took 8.788 ms
rank =  0, Distributing orbital back into band + domain format took 19.619 ms
rank = 0, Subspace_Rotation used 28.421 ms

Total time for subspace rotation: 28.428 ms
rank = 0, Efermi =  -0.101457251752 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 5.479 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.025 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.590 ms
rank = 0, Calculating density took 1688.551 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.843 ms
rank = 0, D2D took 1.944 ms
rank = 0, Transfering density took 1.949 ms
Etot    =   -47.189432558297
Eband   =   -14.047936445805
E1      =    32.462685819834
E2      =   -12.932939106140
E3      =   -17.848399424621
Exc     =   -16.030468525358
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 8.559e-06, dEband = 1.684e-03
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -47.189432558, dEtot = 8.559e-06, dEband = 1.684e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0586989719493, which took 0.099 ms

iter_count = 108, r_2norm = 1.798e-06, tol*||rhs|| = 2.348e-06

Anderson update took 57.359 ms, out of which F'*F took 26.817 ms; b-Ax took 182.178 ms, out of which Lap took 162.690 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.546 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068850, int_b + int_rho = -1.091e-13, checking this took 0.107 ms
2-norm of RHS = 753.2029571055041, which took 0.124 ms

iter_count = 144, r_2norm = 7.197e-04, tol*||rhs|| = 7.532e-04

Anderson update took 77.160 ms, out of which F'*F took 36.448 ms; b-Ax took 244.001 ms, out of which Lap took 219.238 ms
Solving Poisson took 519.681 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.147686 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.681 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.590 ms
Total time for convolution: 	 convolve: 5.165443 
Total time for convolution: 	 convolve: 5.156893 
Total time for convolution: 	 convolve: 5.184838 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.842 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
---Transfer Veff_loc: D2D took 3.525 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.345 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.903 ms

This SCF took 27326.368 ms, scf error = 2.232e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134666, lowerbound = -0.895852, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1570.518 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.800 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.236 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.554 ms
rank =  0, finding HY took 26.719 ms
rank =  0, distributing HY into block cyclic form took 19.225 ms
rank =  0, finding Y'*HY took 4.964 ms
Rank 0, Project_Hamiltonian used 74.518 ms
Total time for projection: 74.529 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.238 ms
    first calculated eigval = -0.895641335886804
    last  calculated eigval = 0.034900215904107
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47608146044534
lambda[   7] =  -0.45573705122383
lambda[   8] =  -0.41205663982051
lambda[   9] =  -0.37759517560663
lambda[  10] =  -0.36364101528302
lambda[  11] =  -0.35535176792351
lambda[  12] =  -0.28187029316380
lambda[  13] =  -0.25584093095875
lambda[  14] =  -0.24873882150131
lambda[  15] =  -0.20251881467813
lambda[  16] =  -0.07212372668136
lambda[  17] =  -0.05940907440721
lambda[  18] =  -0.01696950426258
lambda[  19] =   0.02605959087619
lambda[  20] =   0.02964342482362
lambda[  21] =   0.03073404364559
lambda[  22] =   0.03357566525523
lambda[  23] =   0.03490021590411
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.270 ms
rank =  0, subspace rotation using ScaLAPACK took 8.719 ms
rank =  0, Distributing orbital back into band + domain format took 19.703 ms
rank = 0, Subspace_Rotation used 28.433 ms

Total time for subspace rotation: 28.439 ms
rank = 0, Efermi =  -0.101259632211 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.446 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.017 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 1690.925 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.831 ms
rank = 0, D2D took 1.927 ms
rank = 0, Transfering density took 1.940 ms
Etot    =   -47.189464026682
Eband   =   -14.041748712841
E1      =    32.459391424137
E2      =   -12.929906340318
E3      =   -17.848939345821
Exc     =   -16.030900486386
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 3.147e-06, dEband = 6.188e-04
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -47.189464027, dEtot = 3.147e-06, dEband = 6.188e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0353521883560, which took 0.086 ms

iter_count = 114, r_2norm = 8.677e-07, tol*||rhs|| = 1.414e-06

Anderson update took 60.427 ms, out of which F'*F took 28.583 ms; b-Ax took 193.526 ms, out of which Lap took 173.168 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.243 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068851, int_b + int_rho = -1.019e-13, checking this took 0.125 ms
2-norm of RHS = 753.2034620810165, which took 0.135 ms

iter_count = 138, r_2norm = 6.410e-04, tol*||rhs|| = 7.532e-04

Anderson update took 73.842 ms, out of which F'*F took 34.655 ms; b-Ax took 233.268 ms, out of which Lap took 209.290 ms
Solving Poisson took 498.313 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.162 ms
Total time for convolution: 	 convolve: 5.197654 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.170571 
Total time for convolution: 	 convolve: 5.142075 
Total time for convolution: 	 convolve: 5.198058 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.515 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.151 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.699 ms

This SCF took 27311.755 ms, scf error = 1.699e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.134900, lowerbound = -0.895641, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1556.007 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 30.380 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.141 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 33.538 ms
rank =  0, finding HY took 26.730 ms
rank =  0, distributing HY into block cyclic form took 19.289 ms
rank =  0, finding Y'*HY took 4.951 ms
Rank 0, Project_Hamiltonian used 84.536 ms
Total time for projection: 84.546 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.145 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.232 ms
    first calculated eigval = -0.895503859712362
    last  calculated eigval = 0.035053035246901
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47594575240579
lambda[   7] =  -0.45559800815684
lambda[   8] =  -0.41191442687056
lambda[   9] =  -0.37746048249666
lambda[  10] =  -0.36350925744955
lambda[  11] =  -0.35521571574630
lambda[  12] =  -0.28174239749945
lambda[  13] =  -0.25570285680210
lambda[  14] =  -0.24860589575274
lambda[  15] =  -0.20238842276021
lambda[  16] =  -0.07200778508784
lambda[  17] =  -0.05929067296198
lambda[  18] =  -0.01709991734893
lambda[  19] =   0.02587910531103
lambda[  20] =   0.02849093488982
lambda[  21] =   0.03074461616681
lambda[  22] =   0.03330730944030
lambda[  23] =   0.03505303524690
==subpsace eigenproblem: bcast eigvals took 0.263 ms
Total time for solving subspace eigenvalue problem: 0.503 ms
rank =  0, subspace rotation using ScaLAPACK took 8.704 ms
rank =  0, Distributing orbital back into band + domain format took 19.730 ms
rank = 0, Subspace_Rotation used 28.449 ms

Total time for subspace rotation: 28.456 ms
rank = 0, Efermi =  -0.101143690573 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.463 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.993 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.586 ms
rank = 0, Calculating density took 1686.682 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.834 ms
rank = 0, D2D took 1.937 ms
rank = 0, Transfering density took 1.943 ms
Etot    =   -47.189505467800
Eband   =   -14.037665234280
E1      =    32.457343832802
E2      =   -12.927786645403
E3      =   -17.849145899343
Exc     =   -16.031064673337
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 4.144e-06, dEband = 4.083e-04
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -47.189505468, dEtot = 4.144e-06, dEband = 4.083e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0255197388071, which took 0.106 ms

iter_count = 108, r_2norm = 1.001e-06, tol*||rhs|| = 1.021e-06

Anderson update took 57.309 ms, out of which F'*F took 26.752 ms; b-Ax took 182.795 ms, out of which Lap took 163.258 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.858 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068845, int_b + int_rho = -1.601e-13, checking this took 0.100 ms
2-norm of RHS = 753.2046450544321, which took 0.120 ms

iter_count = 138, r_2norm = 7.033e-04, tol*||rhs|| = 7.532e-04

Anderson update took 74.041 ms, out of which F'*F took 34.619 ms; b-Ax took 232.823 ms, out of which Lap took 208.985 ms
Solving Poisson took 497.512 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.271 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.154225 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.365 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.230570 
Total time for convolution: 	 convolve: 5.280160 
Total time for convolution: 	 convolve: 5.167918 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.026 ms
---Transfer Veff_loc: D2D took 4.244 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.124 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.398 ms

This SCF took 27508.385 ms, scf error = 1.379e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.135053, lowerbound = -0.895504, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1558.017 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 28.942 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.381 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 32.345 ms
rank =  0, finding HY took 26.561 ms
rank =  0, distributing HY into block cyclic form took 19.296 ms
rank =  0, finding Y'*HY took 4.830 ms
Rank 0, Project_Hamiltonian used 83.061 ms
Total time for projection: 83.074 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.138 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -0.895341836960837
    last  calculated eigval = 0.036063359399500
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47580065759224
lambda[   7] =  -0.45544426677262
lambda[   8] =  -0.41177117493436
lambda[   9] =  -0.37730719817198
lambda[  10] =  -0.36335996857430
lambda[  11] =  -0.35507428342449
lambda[  12] =  -0.28159219853102
lambda[  13] =  -0.25555280626909
lambda[  14] =  -0.24847138091737
lambda[  15] =  -0.20225479389425
lambda[  16] =  -0.07187792401915
lambda[  17] =  -0.05916137457975
lambda[  18] =  -0.01684271072455
lambda[  19] =   0.02659219381421
lambda[  20] =   0.02842383190074
lambda[  21] =   0.03058259132827
lambda[  22] =   0.03305190921527
lambda[  23] =   0.03606335939950
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 8.695 ms
rank =  0, Distributing orbital back into band + domain format took 19.790 ms
rank = 0, Subspace_Rotation used 28.500 ms

Total time for subspace rotation: 28.505 ms
rank = 0, Efermi =  -0.101013829527 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.508 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.913 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.573 ms
rank = 0, Calculating density took 1686.988 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.846 ms
rank = 0, D2D took 1.944 ms
rank = 0, Transfering density took 1.949 ms
Etot    =   -47.189535370372
Eband   =   -14.033196911663
E1      =    32.455197946327
E2      =   -12.925387237822
E3      =   -17.849297735057
Exc     =   -16.031169440184
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 2.990e-06, dEband = 4.468e-04
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -47.189535370, dEtot = 2.990e-06, dEband = 4.468e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0272737131002, which took 0.057 ms

iter_count = 108, r_2norm = 8.551e-07, tol*||rhs|| = 1.091e-06

Anderson update took 57.500 ms, out of which F'*F took 26.961 ms; b-Ax took 181.779 ms, out of which Lap took 162.765 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.731 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068845, int_b + int_rho = -1.601e-13, checking this took 0.105 ms
2-norm of RHS = 753.2033218719636, which took 0.127 ms

iter_count = 108, r_2norm = 7.213e-04, tol*||rhs|| = 7.532e-04

Anderson update took 57.766 ms, out of which F'*F took 26.928 ms; b-Ax took 181.737 ms, out of which Lap took 162.750 ms
Solving Poisson took 389.108 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.163462 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 50.335 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.205165 
Total time for convolution: 	 convolve: 5.287156 
Total time for convolution: 	 convolve: 5.460243 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.278 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.018 ms
======D2D: initiated sending and receiving took 1.182 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.488 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.147 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.667 ms

This SCF took 27636.660 ms, scf error = 1.036e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136063, lowerbound = -0.895342, upperbound = 267.598479

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1575.207 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.814 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.165 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.996 ms
rank =  0, finding HY took 26.848 ms
rank =  0, distributing HY into block cyclic form took 19.312 ms
rank =  0, finding Y'*HY took 4.868 ms
Rank 0, Project_Hamiltonian used 74.054 ms
Total time for projection: 74.064 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.237 ms
    first calculated eigval = -0.895271380302694
    last  calculated eigval = 0.037122944934038
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47573366292903
lambda[   7] =  -0.45537674362328
lambda[   8] =  -0.41170721736351
lambda[   9] =  -0.37723585543016
lambda[  10] =  -0.36329447750120
lambda[  11] =  -0.35500566545757
lambda[  12] =  -0.28152094905044
lambda[  13] =  -0.25548533932289
lambda[  14] =  -0.24840042783333
lambda[  15] =  -0.20218419234032
lambda[  16] =  -0.07181215671706
lambda[  17] =  -0.05909451887040
lambda[  18] =  -0.01607744902492
lambda[  19] =   0.02724403883411
lambda[  20] =   0.02915351145710
lambda[  21] =   0.03119920508713
lambda[  22] =   0.03371489226374
lambda[  23] =   0.03712294493404
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.269 ms
rank =  0, subspace rotation using ScaLAPACK took 8.686 ms
rank =  0, Distributing orbital back into band + domain format took 19.639 ms
rank = 0, Subspace_Rotation used 28.339 ms

Total time for subspace rotation: 28.346 ms
rank = 0, Efermi =  -0.100948062191 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 5.485 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.545 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.586 ms
rank = 0, Calculating density took 1695.637 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.981 ms
rank = 0, D2D took 2.092 ms
rank = 0, Transfering density took 2.095 ms
Etot    =   -47.189540765773
Eband   =   -14.031142023821
E1      =    32.454227032308
E2      =   -12.924294575467
E3      =   -17.849322382864
Exc     =   -16.031190794861
Esc     =   -80.355051937110
Entropy =    -0.000000000621
dE = 5.395e-07, dEband = 2.055e-04
rank = 0, Calculating/Estimating energy took 1.764 ms, Etot = -47.189540766, dEtot = 5.395e-07, dEband = 2.055e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0227042119630, which took 0.055 ms

iter_count = 108, r_2norm = 8.087e-07, tol*||rhs|| = 9.082e-07

Anderson update took 57.310 ms, out of which F'*F took 27.224 ms; b-Ax took 183.585 ms, out of which Lap took 163.507 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.081 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002068861, int_rho =  30.00000002068855, int_b + int_rho = -6.185e-14, checking this took 0.103 ms
2-norm of RHS = 753.2014145491515, which took 0.130 ms

iter_count = 102, r_2norm = 6.263e-04, tol*||rhs|| = 7.532e-04

Anderson update took 54.598 ms, out of which F'*F took 25.528 ms; b-Ax took 172.508 ms, out of which Lap took 154.630 ms
Solving Poisson took 368.840 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.158175 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.987 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.163413 
Total time for convolution: 	 convolve: 5.161864 
Total time for convolution: 	 convolve: 5.163111 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.825 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 3.490 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.106 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.627 ms

This SCF took 27110.837 ms, scf error = 9.409e-05
The last 18 occupations of kpoints #1 are (Nelectron = 30):
lambda[   6] =  -0.47573366292903, occ[   6] =   2.00000000000000
lambda[   7] =  -0.45537674362328, occ[   7] =   2.00000000000000
lambda[   8] =  -0.41170721736351, occ[   8] =   2.00000000000000
lambda[   9] =  -0.37723585543016, occ[   9] =   2.00000000000000
lambda[  10] =  -0.36329447750120, occ[  10] =   2.00000000000000
lambda[  11] =  -0.35500566545757, occ[  11] =   2.00000000000000
lambda[  12] =  -0.28152094905044, occ[  12] =   2.00000000000000
lambda[  13] =  -0.25548533932289, occ[  13] =   2.00000000000000
lambda[  14] =  -0.24840042783333, occ[  14] =   2.00000000000000
lambda[  15] =  -0.20218419234032, occ[  15] =   2.00000000000000
lambda[  16] =  -0.07181215671706, occ[  16] =   0.00000002068848
lambda[  17] =  -0.05909451887040, occ[  17] =   0.00000000000000
lambda[  18] =  -0.01607744902492, occ[  18] =   0.00000000000000
lambda[  19] =   0.02724403883411, occ[  19] =   0.00000000000000
lambda[  20] =   0.02915351145710, occ[  20] =   0.00000000000000
lambda[  21] =   0.03119920508713, occ[  21] =   0.00000000000000
lambda[  22] =   0.03371489226374, occ[  22] =   0.00000000000000
lambda[  23] =   0.03712294493404, occ[  23] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 21 (90%) = 0.000000000000000.
Occupation of state 23 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.949 ms, time for Allreduce/Reduce: 10.861 ms 
Time for calculating local force components: 24.163 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000000660057  -0.00000000242737  -0.05170096152048
  0.00000000931657  -0.00000000826888   0.05295649839162
 -0.00000005472716  -0.04688920993115  -0.02339373849926
 -0.00000000309826   0.04688919016706  -0.02339370680322
 -0.00000018275093  -0.00000022671500  -0.02638211277686
 -0.00000031677941  -0.00000008743769   0.09361870053970
 -0.00000019012437  -0.01799282918069  -0.09014908085509
 -0.00000027839069   0.01799229899531  -0.09014902112851
 -0.00000019437900  -0.71852198005347   0.45699079776938
 -0.00000036559348   0.71852145229857   0.45699064576878
force_loc = 
  0.00000015468956   0.00000005463621   0.05319055607024
 -0.00000051001883  -0.00000009025091  -0.05505498547075
  0.00000066171036   0.04814367896114   0.02412063999838
 -0.00000014338884  -0.04814382587099   0.02412041540793
 -0.00000015883405   0.00000037916741   0.02900770015911
  0.00000030063333  -0.00000042828343  -0.09039176035192
 -0.00000048184541   0.01971722420197   0.08655469186817
 -0.00000033721752  -0.01971685321577   0.08655304308600
 -0.00000134849205   0.70004924477765  -0.44497585099341
  0.00000052574829  -0.70005146192225  -0.44497775699100
Time for calculating nonlocal force components: 42.669 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000001379079   0.00000000600021  -0.00245312486801
[0m[32m  0.00000002578439  -0.00000004159284  -0.00028438180481
[0m[32m -0.00000004351798  -0.00191559723501   0.00140039291401
[0m[32m -0.00000001009584   0.00191558937351   0.00140027290801
[0m[32m -0.00000002681269   0.01788453169890  -0.01185043866110
[0m[32m  0.00000003815010  -0.01788461444597  -0.01185055276361
[0mTime for calculating XC forces components: 34.011 ms
 Cartesian force = 
  0.00000044313151   0.00000041286419   0.00149990641043
 -0.00000020565973   0.00000026213556  -0.00208817521846
  0.00000090202573   0.00125482968533   0.00073721335979
  0.00000014855542  -0.00125427504858   0.00073702046538
 -0.00000006033325   0.00000051910797   0.00018277437491
  0.00000030468084  -0.00000019665860   0.00295287024364
 -0.00000042044523  -0.00019084155839  -0.00218368421224
 -0.00000033066152   0.00019139580840  -0.00218539327383
 -0.00000127464121  -0.00058784292157   0.00017481997554
  0.00000049334743   0.00058573658570   0.00017264787484
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.194 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Time for printing density: 377.758 ms
The program took 474.440 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:54
Job ID:        2266518
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:37:36,vmem=8432K,walltime=00:08:08,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-12-2
---------------------------------------
