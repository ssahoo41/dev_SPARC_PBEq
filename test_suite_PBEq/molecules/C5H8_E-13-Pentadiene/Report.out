---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:32
Job ID:    2266940
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:37
Job ID:    2266940
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 12.008 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 13.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8

Reading ion file took 14.496 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 142.090 ms

Freeing SPARC_INPUT_MPI datatype took 0.020 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.924 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.281 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    6.264379	   13.370289	   10.000000	
    3.942062	   10.765392	   10.000000	
    7.356518	    7.662454	   10.000000	
   10.917316	   12.331497	   10.000000	
   11.868464	    6.629711	   10.000000	
   15.423863	   11.300818	   10.000000	
   16.057938	    8.457583	   11.659518	
   16.057938	    8.457583	    8.340482	
    5.905386	   11.349289	   10.000000	
    7.796278	    9.673777	   10.000000	
   10.462921	   10.322164	   10.000000	
   12.347141	    8.633335	   10.000000	
   15.105363	    9.258570	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.364 ms
Set up communicators.

--set up spincomm took 2.094 ms

--set up kptcomm took 0.366 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 21, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 21 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 21, mbQ = nbQ = 64
rank = 0, nr_Hp = 21, nc_Hp = 21
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.058 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.107 ms

Calculate_SplineDerivRadFun took 0.108 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.804 ms.
time spent on vectorized spline interp: 2.717 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.717 ms.
time spent on vectorized spline interp: 1.703 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.554 ms.

Calculating rb for all atom types took 11.503 ms
----------------------
Estimated memory usage
Total: 1.26 GB
orbitals             : 961.30 MB
global sized vectors : 213.62 MB
subspace matrices : 10.34 kB
others : 117.49 MB
----------------------------------------------
Estimated memory usage per processor: 107.70 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.048 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -28.0000000308226, sum_int_rho = 27.1910565908983
PosCharge = 28.000000030823, NegCharge = -27.191056590898, scal_fac = 1.029750349613
After scaling, int_rho = 28.0000000308224, PosCharge + NegCharge - NetCharge = 1.847e-13
--Calculate Vref took 0.620 ms
--Calculate rho_guess took 3.109 ms

 integral of b = -28.0000000308226,
 int{b} + Nelectron + NetCharge = -3.082e-08,
 Esc = -63.3838088308409,
 MPI_Reduce took 14.735 ms

Calculating b & b_ref took 25.899 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.084 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.170 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.084 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.642 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.035 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082277, int_rho =  28.00000003082262, int_b + int_rho = -1.528e-13, checking this took 0.539 ms
2-norm of RHS = 835.4506839376564, which took 0.491 ms

iter_count = 420, r_2norm = 6.864e-04, tol*||rhs|| = 8.355e-04

Anderson update took 232.731 ms, out of which F'*F took 106.236 ms; b-Ax took 718.076 ms, out of which Lap took 643.169 ms
Solving Poisson took 1521.355 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.344 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
Total time for convolution: 	 convolve: 5.145343 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
Total time for convolution: 	 convolve: 5.130537 
Total time for convolution: 	 convolve: 5.154051 
Total time for convolution: 	 convolve: 5.147169 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 2.568 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.502 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
rank = 0, XC calculation took 24477.123 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 4.876 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.601 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.585 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.164 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.678 ms
    Lanczos iter 52, eigmin  = -0.840594854, eigmax = 264.916166753, err_eigmin = 5.504e-04, err_eigmax = 9.826e-03
rank =   0, Lanczos took 118.190 ms, eigmin = -0.840594853977, eigmax = 267.565328420849

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.312367, lowerbound = -0.940595, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1508.646 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.754 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.861 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.638 ms
rank =  0, finding HY took 25.811 ms
rank =  0, distributing HY into block cyclic form took 20.007 ms
rank =  0, finding Y'*HY took 4.158 ms
Rank 0, Project_Hamiltonian used 72.648 ms
Total time for projection: 72.659 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.756 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.855 ms
    first calculated eigval = 2.719304495051418
    last  calculated eigval = 3.262316088843785
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =   2.84295290175500
lambda[   6] =   2.85673986962324
lambda[   7] =   2.89013173040044
lambda[   8] =   2.92945717434351
lambda[   9] =   2.96196131291928
lambda[  10] =   2.98052400293634
lambda[  11] =   2.99097188520556
lambda[  12] =   3.00289406287666
lambda[  13] =   3.02772532831184
lambda[  14] =   3.03724904740043
lambda[  15] =   3.07810628377422
lambda[  16] =   3.11521939507759
lambda[  17] =   3.12933845507294
lambda[  18] =   3.14578752066219
lambda[  19] =   3.17501978110255
lambda[  20] =   3.21425336501628
lambda[  21] =   3.26231608884379
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.872 ms
rank =  0, subspace rotation using ScaLAPACK took 7.752 ms
rank =  0, Distributing orbital back into band + domain format took 19.047 ms
rank = 0, Subspace_Rotation used 26.817 ms

Total time for subspace rotation: 26.820 ms
rank = 0, Efermi =   3.057677953817 calculate fermi energy took 0.050 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.362316, lowerbound = -0.940595, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1512.025 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.196 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.513 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.728 ms
rank =  0, finding HY took 25.388 ms
rank =  0, distributing HY into block cyclic form took 18.426 ms
rank =  0, finding Y'*HY took 4.000 ms
Rank 0, Project_Hamiltonian used 68.578 ms
Total time for projection: 68.582 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.221 ms
    first calculated eigval = -0.617616748276755
    last  calculated eigval = 0.417902765689854
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.23809092298021
lambda[   6] =  -0.17664092861078
lambda[   7] =  -0.14735107527994
lambda[   8] =  -0.06633509542587
lambda[   9] =  -0.03903359053134
lambda[  10] =   0.01696080064024
lambda[  11] =   0.11736312529403
lambda[  12] =   0.16440498944540
lambda[  13] =   0.20530135070802
lambda[  14] =   0.24151970040452
lambda[  15] =   0.30190945097116
lambda[  16] =   0.33699637648814
lambda[  17] =   0.34594441593653
lambda[  18] =   0.36661580153465
lambda[  19] =   0.38023616829330
lambda[  20] =   0.40288210784535
lambda[  21] =   0.41790276568985
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 7.688 ms
rank =  0, Distributing orbital back into band + domain format took 18.419 ms
rank = 0, Subspace_Rotation used 26.125 ms

Total time for subspace rotation: 26.130 ms
rank = 0, Efermi =   0.273167345605 calculate fermi energy took 0.025 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.517903, lowerbound = -0.940595, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1506.097 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.280 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.579 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.881 ms
rank =  0, finding HY took 25.131 ms
rank =  0, distributing HY into block cyclic form took 18.322 ms
rank =  0, finding Y'*HY took 4.027 ms
Rank 0, Project_Hamiltonian used 68.388 ms
Total time for projection: 68.392 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -0.847385273520785
    last  calculated eigval = 0.143272317530141
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.58713717977608
lambda[   6] =  -0.52303403761796
lambda[   7] =  -0.51224861170492
lambda[   8] =  -0.46678102686258
lambda[   9] =  -0.46256359682821
lambda[  10] =  -0.44891609458142
lambda[  11] =  -0.41758331558535
lambda[  12] =  -0.38626212589539
lambda[  13] =  -0.35425459679838
lambda[  14] =  -0.24429317815520
lambda[  15] =  -0.08392408700910
lambda[  16] =   0.03199117620117
lambda[  17] =   0.06035978005955
lambda[  18] =   0.08387474988061
lambda[  19] =   0.09759889639576
lambda[  20] =   0.11609670620186
lambda[  21] =   0.14327231753014
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.236 ms
rank =  0, subspace rotation using ScaLAPACK took 7.722 ms
rank =  0, Distributing orbital back into band + domain format took 18.448 ms
rank = 0, Subspace_Rotation used 26.188 ms

Total time for subspace rotation: 26.193 ms
rank = 0, Efermi =  -0.112699086608 calculate fermi energy took 0.025 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.243272, lowerbound = -0.940595, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1510.241 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.284 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.602 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.905 ms
rank =  0, finding HY took 25.314 ms
rank =  0, distributing HY into block cyclic form took 18.270 ms
rank =  0, finding Y'*HY took 4.027 ms
Rank 0, Project_Hamiltonian used 68.558 ms
Total time for projection: 68.562 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -0.848078407579967
    last  calculated eigval = 0.071449689321369
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.59065035015437
lambda[   6] =  -0.52981895950097
lambda[   7] =  -0.51773329291315
lambda[   8] =  -0.47945412027281
lambda[   9] =  -0.47104894014095
lambda[  10] =  -0.45815318129309
lambda[  11] =  -0.42495628963338
lambda[  12] =  -0.39325793207358
lambda[  13] =  -0.36568440831617
lambda[  14] =  -0.28772534561438
lambda[  15] =  -0.13287979838394
lambda[  16] =  -0.02601664503086
lambda[  17] =   0.00320166211457
lambda[  18] =   0.03142483577159
lambda[  19] =   0.04925258706646
lambda[  20] =   0.05986515803264
lambda[  21] =   0.07144968932137
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.228 ms
rank =  0, subspace rotation using ScaLAPACK took 7.714 ms
rank =  0, Distributing orbital back into band + domain format took 18.394 ms
rank = 0, Subspace_Rotation used 26.127 ms

Total time for subspace rotation: 26.132 ms
rank = 0, Efermi =  -0.161654797940 calculate fermi energy took 0.023 ms
rank = 0, --- Calculate rho: sum over local bands took 5.352 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.223 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.625 ms
rank = 0, Calculating density took 6561.901 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.835 ms
rank = 0, D2D took 1.930 ms
rank = 0, Transfering density took 1.933 ms
Etot    =   -35.024187330879
Eband   =   -15.089455699620
E1      =    31.216944099983
E2      =   -10.652123104177
E3      =   -14.394856340002
Exc     =   -12.814846343665
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 2.694e+00, dEband = 1.161e+00
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -35.024187331, dEtot = 2.694e+00, dEband = 1.161e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 49.9284827488758, which took 1.303 ms

iter_count = 96, r_2norm = 1.878e-03, tol*||rhs|| = 1.997e-03

Anderson update took 51.423 ms, out of which F'*F took 24.338 ms; b-Ax took 163.794 ms, out of which Lap took 147.139 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 353.085 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082225, int_b + int_rho = -5.239e-13, checking this took 0.102 ms
2-norm of RHS = 830.3817550975173, which took 0.145 ms

iter_count = 288, r_2norm = 6.813e-04, tol*||rhs|| = 8.304e-04

Anderson update took 155.269 ms, out of which F'*F took 72.919 ms; b-Ax took 489.868 ms, out of which Lap took 439.337 ms
Solving Poisson took 1039.724 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.422 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.194553 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.445 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.358139 
Total time for convolution: 	 convolve: 5.184558 
Total time for convolution: 	 convolve: 5.256363 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.757 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.513 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.183 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.734 ms

This SCF took 33067.384 ms, scf error = 2.185e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.171450, lowerbound = -0.848078, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1490.727 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.116 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.568 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.704 ms
rank =  0, finding HY took 24.618 ms
rank =  0, distributing HY into block cyclic form took 19.177 ms
rank =  0, finding Y'*HY took 4.100 ms
Rank 0, Project_Hamiltonian used 69.629 ms
Total time for projection: 69.651 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.230 ms
    first calculated eigval = -0.815750606220389
    last  calculated eigval = 0.043709311352639
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.56471608815725
lambda[   6] =  -0.49941386101435
lambda[   7] =  -0.48262968772026
lambda[   8] =  -0.44704295878442
lambda[   9] =  -0.43920240211548
lambda[  10] =  -0.42173907482529
lambda[  11] =  -0.39540422362598
lambda[  12] =  -0.36777032468192
lambda[  13] =  -0.34188143514241
lambda[  14] =  -0.26178972570835
lambda[  15] =  -0.11300333016481
lambda[  16] =  -0.02226836193183
lambda[  17] =  -0.01689620994187
lambda[  18] =   0.00771543329307
lambda[  19] =   0.02123113353444
lambda[  20] =   0.03070669246080
lambda[  21] =   0.04370931135264
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 8.217 ms
rank =  0, Distributing orbital back into band + domain format took 18.022 ms
rank = 0, Subspace_Rotation used 26.257 ms

Total time for subspace rotation: 26.261 ms
rank = 0, Efermi =  -0.141778329703 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.316 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.637 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.605 ms
rank = 0, Calculating density took 1603.623 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.817 ms
rank = 0, D2D took 1.914 ms
rank = 0, Transfering density took 1.916 ms
Etot    =   -34.940484741325
Eband   =   -14.221668644936
E1      =    30.431300242788
E2      =   -10.613993216122
E3      =   -14.621060197621
Exc     =   -13.001360921165
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 6.439e-03, dEband = 6.675e-02
rank = 0, Calculating/Estimating energy took 1.823 ms, Etot = -34.940484741, dEtot = 6.439e-03, dEband = 6.675e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 14.6279085262483, which took 0.057 ms

iter_count = 102, r_2norm = 5.738e-04, tol*||rhs|| = 5.851e-04

Anderson update took 55.315 ms, out of which F'*F took 26.079 ms; b-Ax took 172.885 ms, out of which Lap took 156.205 ms
rank = 0, Mixing (+ precond) took 376.545 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082239, int_b + int_rho = -3.856e-13, checking this took 0.135 ms
2-norm of RHS = 821.9061549003967, which took 0.130 ms

iter_count = 306, r_2norm = 7.209e-04, tol*||rhs|| = 8.219e-04

Anderson update took 164.810 ms, out of which F'*F took 78.205 ms; b-Ax took 527.698 ms, out of which Lap took 473.088 ms
Solving Poisson took 1102.408 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.160511 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.934 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.157431 
Total time for convolution: 	 convolve: 5.165770 
Total time for convolution: 	 convolve: 5.165345 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.500 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.219 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.752 ms

This SCF took 27830.587 ms, scf error = 1.522e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.143709, lowerbound = -0.815751, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1501.570 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.382 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.113 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.510 ms
rank =  0, finding HY took 25.270 ms
rank =  0, distributing HY into block cyclic form took 18.830 ms
rank =  0, finding Y'*HY took 4.240 ms
Rank 0, Project_Hamiltonian used 69.880 ms
Total time for projection: 69.896 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -0.752908798076662
    last  calculated eigval = 0.032770520883417
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.51203215654665
lambda[   6] =  -0.43946889331450
lambda[   7] =  -0.41512069357476
lambda[   8] =  -0.38598741688072
lambda[   9] =  -0.37793201009130
lambda[  10] =  -0.35203011065184
lambda[  11] =  -0.33575361640861
lambda[  12] =  -0.31489902468100
lambda[  13] =  -0.29584298462739
lambda[  14] =  -0.21167482506380
lambda[  15] =  -0.06704987528329
lambda[  16] =  -0.02479681089107
lambda[  17] =   0.00501249957822
lambda[  18] =   0.00998808731372
lambda[  19] =   0.01380040307860
lambda[  20] =   0.02000766120395
lambda[  21] =   0.03277052088342
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 8.245 ms
rank =  0, Distributing orbital back into band + domain format took 18.091 ms
rank = 0, Subspace_Rotation used 26.350 ms

Total time for subspace rotation: 26.355 ms
rank = 0, Efermi =  -0.095824874886 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.241 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.704 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.575 ms
rank = 0, Calculating density took 1614.741 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.819 ms
rank = 0, D2D took 2.928 ms
rank = 0, Transfering density took 2.936 ms
Etot    =   -34.866842655226
Eband   =   -12.534216529762
E1      =    28.955033983804
E2      =   -10.382143668144
E3      =   -15.139729893293
Exc     =   -13.425724838950
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 5.665e-03, dEband = 1.298e-01
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -34.866842655, dEtot = 5.665e-03, dEband = 1.298e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.2133975167825, which took 0.065 ms

iter_count = 108, r_2norm = 1.214e-04, tol*||rhs|| = 1.685e-04

Anderson update took 58.276 ms, out of which F'*F took 27.732 ms; b-Ax took 184.105 ms, out of which Lap took 166.623 ms
rank = 0, Mixing (+ precond) took 398.712 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082241, int_b + int_rho = -3.638e-13, checking this took 0.129 ms
2-norm of RHS = 821.8787895988290, which took 0.114 ms

iter_count = 270, r_2norm = 7.692e-04, tol*||rhs|| = 8.219e-04

Anderson update took 147.938 ms, out of which F'*F took 69.309 ms; b-Ax took 466.366 ms, out of which Lap took 421.429 ms
Solving Poisson took 977.013 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.298292 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.159700 
Total time for convolution: 	 convolve: 5.163146 
Total time for convolution: 	 convolve: 5.155354 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.344 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.527 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.209 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.768 ms

This SCF took 27795.442 ms, scf error = 4.511e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.132771, lowerbound = -0.752909, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1477.765 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.159 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.614 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.789 ms
rank =  0, finding HY took 24.582 ms
rank =  0, distributing HY into block cyclic form took 18.292 ms
rank =  0, finding Y'*HY took 4.048 ms
Rank 0, Project_Hamiltonian used 67.751 ms
Total time for projection: 67.763 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.235 ms
    first calculated eigval = -0.741930620587052
    last  calculated eigval = 0.027706789130664
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49994030956683
lambda[   6] =  -0.42831910422756
lambda[   7] =  -0.40572274608293
lambda[   8] =  -0.37636269329279
lambda[   9] =  -0.36780635505246
lambda[  10] =  -0.34228738638688
lambda[  11] =  -0.32411245028670
lambda[  12] =  -0.30311031825104
lambda[  13] =  -0.28765032565090
lambda[  14] =  -0.20472667099462
lambda[  15] =  -0.06011210746903
lambda[  16] =  -0.02788942874722
lambda[  17] =   0.00489001637064
lambda[  18] =   0.01114466172601
lambda[  19] =   0.01425707626117
lambda[  20] =   0.01708666992190
lambda[  21] =   0.02770678913066
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 8.245 ms
rank =  0, Distributing orbital back into band + domain format took 18.083 ms
rank = 0, Subspace_Rotation used 26.350 ms

Total time for subspace rotation: 26.355 ms
rank = 0, Efermi =  -0.088887107084 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.071 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.912 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.590 ms
rank = 0, Calculating density took 1590.258 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.540 ms
rank = 0, D2D took 2.641 ms
rank = 0, Transfering density took 2.647 ms
Etot    =   -34.861591774596
Eband   =   -12.253774577070
E1      =    28.794415188629
E2      =   -10.241267749322
E3      =   -15.244983452561
Exc     =   -13.504674756281
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 4.039e-04, dEband = 2.157e-02
rank = 0, Calculating/Estimating energy took 0.907 ms, Etot = -34.861591775, dEtot = 4.039e-04, dEband = 2.157e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.1155906698638, which took 0.057 ms

iter_count = 108, r_2norm = 8.082e-05, tol*||rhs|| = 8.462e-05

Anderson update took 58.103 ms, out of which F'*F took 27.300 ms; b-Ax took 182.517 ms, out of which Lap took 164.583 ms
rank = 0, Mixing (+ precond) took 395.823 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082241, int_b + int_rho = -3.674e-13, checking this took 0.122 ms
2-norm of RHS = 822.0277071373462, which took 0.134 ms

iter_count = 246, r_2norm = 6.961e-04, tol*||rhs|| = 8.220e-04

Anderson update took 133.645 ms, out of which F'*F took 62.715 ms; b-Ax took 420.621 ms, out of which Lap took 378.648 ms
Solving Poisson took 883.227 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.176476 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 78.854 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.173904 
Total time for convolution: 	 convolve: 5.165478 
Total time for convolution: 	 convolve: 5.173037 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.443 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 3.481 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 11.827 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 15.346 ms

This SCF took 27680.151 ms, scf error = 1.330e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.127707, lowerbound = -0.741931, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1471.869 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.250 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.637 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.903 ms
rank =  0, finding HY took 24.645 ms
rank =  0, distributing HY into block cyclic form took 18.188 ms
rank =  0, finding Y'*HY took 4.169 ms
Rank 0, Project_Hamiltonian used 67.937 ms
Total time for projection: 67.948 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.210 ms
    first calculated eigval = -0.737760082545958
    last  calculated eigval = 0.024857532467527
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49569052898973
lambda[   6] =  -0.42372225557621
lambda[   7] =  -0.40083892426859
lambda[   8] =  -0.37132526744214
lambda[   9] =  -0.36247029866104
lambda[  10] =  -0.33768162277235
lambda[  11] =  -0.31922051869559
lambda[  12] =  -0.29873567600689
lambda[  13] =  -0.28416019685303
lambda[  14] =  -0.20091075909436
lambda[  15] =  -0.05653640879640
lambda[  16] =  -0.02873856894026
lambda[  17] =   0.00467655939145
lambda[  18] =   0.01045571518179
lambda[  19] =   0.01482305036600
lambda[  20] =   0.01641695572700
lambda[  21] =   0.02485753246753
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 8.244 ms
rank =  0, Distributing orbital back into band + domain format took 17.997 ms
rank = 0, Subspace_Rotation used 26.629 ms

Total time for subspace rotation: 26.633 ms
rank = 0, Efermi =  -0.085311408323 calculate fermi energy took 0.607 ms
rank = 0, --- Calculate rho: sum over local bands took 5.275 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.633 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.574 ms
rank = 0, Calculating density took 1583.842 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.831 ms
rank = 0, D2D took 1.934 ms
rank = 0, Transfering density took 1.939 ms
Etot    =   -34.860514523482
Eband   =   -12.125531287975
E1      =    28.721325269441
E2      =   -10.177365139610
E3      =   -15.282802007046
Exc     =   -13.532666819848
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 8.287e-05, dEband = 9.865e-03
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -34.860514523, dEtot = 8.287e-05, dEband = 9.865e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8809480760562, which took 0.062 ms

iter_count = 114, r_2norm = 2.375e-05, tol*||rhs|| = 3.524e-05

Anderson update took 61.390 ms, out of which F'*F took 28.920 ms; b-Ax took 193.699 ms, out of which Lap took 173.471 ms
rank = 0, Mixing (+ precond) took 417.753 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082246, int_b + int_rho = -3.201e-13, checking this took 0.108 ms
2-norm of RHS = 822.4220641016359, which took 0.132 ms

iter_count = 240, r_2norm = 6.790e-04, tol*||rhs|| = 8.224e-04

Anderson update took 128.196 ms, out of which F'*F took 60.722 ms; b-Ax took 410.165 ms, out of which Lap took 367.510 ms
Solving Poisson took 865.121 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.171820 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 75.248 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.175815 
Total time for convolution: 	 convolve: 5.197840 
Total time for convolution: 	 convolve: 5.244091 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.252 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.178 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 3.525 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.331 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.893 ms

This SCF took 27774.448 ms, scf error = 7.387e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.124858, lowerbound = -0.737760, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1480.793 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.330 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.587 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.933 ms
rank =  0, finding HY took 24.653 ms
rank =  0, distributing HY into block cyclic form took 18.231 ms
rank =  0, finding Y'*HY took 4.009 ms
Rank 0, Project_Hamiltonian used 67.858 ms
Total time for projection: 67.871 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -0.735080062168192
    last  calculated eigval = 0.023690633497082
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49302728116813
lambda[   6] =  -0.42081889066342
lambda[   7] =  -0.39773051278572
lambda[   8] =  -0.36780464635093
lambda[   9] =  -0.35905256591477
lambda[  10] =  -0.33475216387447
lambda[  11] =  -0.31610887278418
lambda[  12] =  -0.29595016473735
lambda[  13] =  -0.28165011209805
lambda[  14] =  -0.19822674550373
lambda[  15] =  -0.05394187069639
lambda[  16] =  -0.02858433426874
lambda[  17] =   0.00479001473082
lambda[  18] =   0.01036758798391
lambda[  19] =   0.01529388359963
lambda[  20] =   0.01638913015811
lambda[  21] =   0.02369063349708
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.248 ms
rank =  0, subspace rotation using ScaLAPACK took 8.736 ms
rank =  0, Distributing orbital back into band + domain format took 18.249 ms
rank = 0, Subspace_Rotation used 27.004 ms

Total time for subspace rotation: 27.010 ms
rank = 0, Efermi =  -0.082716870291 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.266 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.662 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.583 ms
rank = 0, Calculating density took 1592.913 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.836 ms
rank = 0, D2D took 1.935 ms
rank = 0, Transfering density took 1.941 ms
Etot    =   -34.859996012199
Eband   =   -12.041852823812
E1      =    28.688239890541
E2      =   -10.121747340295
E3      =   -15.299082773236
Exc     =   -13.543404360705
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 3.989e-05, dEband = 6.437e-03
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -34.859996012, dEtot = 3.989e-05, dEband = 6.437e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3729807824430, which took 0.056 ms

iter_count = 114, r_2norm = 1.091e-05, tol*||rhs|| = 1.492e-05

Anderson update took 60.657 ms, out of which F'*F took 28.511 ms; b-Ax took 193.832 ms, out of which Lap took 173.182 ms
rank = 0, Mixing (+ precond) took 416.255 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082246, int_b + int_rho = -3.165e-13, checking this took 0.108 ms
2-norm of RHS = 822.7236090983228, which took 0.132 ms

iter_count = 240, r_2norm = 7.215e-04, tol*||rhs|| = 8.227e-04

Anderson update took 127.316 ms, out of which F'*F took 59.632 ms; b-Ax took 407.240 ms, out of which Lap took 364.371 ms
Solving Poisson took 857.885 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.166423 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.156119 
Total time for convolution: 	 convolve: 5.163143 
Total time for convolution: 	 convolve: 5.149013 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.370 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 3.529 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.123 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.689 ms

This SCF took 27553.589 ms, scf error = 4.163e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.123691, lowerbound = -0.735080, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1487.169 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.235 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.655 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.907 ms
rank =  0, finding HY took 24.698 ms
rank =  0, distributing HY into block cyclic form took 18.245 ms
rank =  0, finding Y'*HY took 4.056 ms
Rank 0, Project_Hamiltonian used 67.939 ms
Total time for projection: 67.951 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -0.730430053350654
    last  calculated eigval = 0.024155653731667
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48897780333812
lambda[   6] =  -0.41645269448559
lambda[   7] =  -0.39309844580653
lambda[   8] =  -0.36295866518745
lambda[   9] =  -0.35464222328455
lambda[  10] =  -0.33008834665450
lambda[  11] =  -0.31171325353264
lambda[  12] =  -0.29186060285611
lambda[  13] =  -0.27746828678307
lambda[  14] =  -0.19405690654393
lambda[  15] =  -0.04987503669824
lambda[  16] =  -0.02747061426491
lambda[  17] =   0.00553147764210
lambda[  18] =   0.01127179580694
lambda[  19] =   0.01656416588133
lambda[  20] =   0.01766473200208
lambda[  21] =   0.02415565373167
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 8.725 ms
rank =  0, Distributing orbital back into band + domain format took 18.243 ms
rank = 0, Subspace_Rotation used 26.986 ms

Total time for subspace rotation: 26.992 ms
rank = 0, Efermi =  -0.078650036346 calculate fermi energy took 0.121 ms
rank = 0, --- Calculate rho: sum over local bands took 5.362 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.497 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.577 ms
rank = 0, Calculating density took 1599.350 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.825 ms
rank = 0, D2D took 1.929 ms
rank = 0, Transfering density took 1.935 ms
Etot    =   -34.859609796275
Eband   =   -11.916570110714
E1      =    28.626565287297
E2      =   -10.052387009276
E3      =   -15.319335638078
Exc     =   -13.557518788457
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 2.971e-05, dEband = 9.637e-03
rank = 0, Calculating/Estimating energy took 0.935 ms, Etot = -34.859609796, dEtot = 2.971e-05, dEband = 9.637e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2079193623882, which took 0.056 ms

iter_count = 114, r_2norm = 7.300e-06, tol*||rhs|| = 8.317e-06

Anderson update took 60.647 ms, out of which F'*F took 28.449 ms; b-Ax took 194.339 ms, out of which Lap took 174.638 ms
rank = 0, Mixing (+ precond) took 416.791 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082237, int_b + int_rho = -4.002e-13, checking this took 0.128 ms
2-norm of RHS = 822.7895964870474, which took 0.146 ms

iter_count = 222, r_2norm = 6.941e-04, tol*||rhs|| = 8.228e-04

Anderson update took 118.157 ms, out of which F'*F took 56.428 ms; b-Ax took 377.337 ms, out of which Lap took 339.516 ms
Solving Poisson took 796.210 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.184118 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 103.859 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.149919 
Total time for convolution: 	 convolve: 5.184146 
Total time for convolution: 	 convolve: 5.199572 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.523 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.598 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.413 ms
---Transfer Veff_loc: D2D took 3.527 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.121 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.683 ms

This SCF took 27676.606 ms, scf error = 2.122e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.124156, lowerbound = -0.730430, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1480.900 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.301 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.669 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.992 ms
rank =  0, finding HY took 24.661 ms
rank =  0, distributing HY into block cyclic form took 18.208 ms
rank =  0, finding Y'*HY took 4.090 ms
Rank 0, Project_Hamiltonian used 67.984 ms
Total time for projection: 67.999 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.657 ms
rank = 0, Solve_Generalized_EigenProblem used 1.170 ms
    first calculated eigval = -0.728067564781493
    last  calculated eigval = 0.025081411236701
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48685876375595
lambda[   6] =  -0.41429662357479
lambda[   7] =  -0.39089058517707
lambda[   8] =  -0.36093725952240
lambda[   9] =  -0.35252791537460
lambda[  10] =  -0.32794217818288
lambda[  11] =  -0.30962463882977
lambda[  12] =  -0.28977913729497
lambda[  13] =  -0.27519961182999
lambda[  14] =  -0.19182619538992
lambda[  15] =  -0.04768890439953
lambda[  16] =  -0.02607272475163
lambda[  17] =   0.00716411344354
lambda[  18] =   0.01284747357371
lambda[  19] =   0.01764760083332
lambda[  20] =   0.01908707542027
lambda[  21] =   0.02508141123670
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 1.191 ms
rank =  0, subspace rotation using ScaLAPACK took 8.246 ms
rank =  0, Distributing orbital back into band + domain format took 18.088 ms
rank = 0, Subspace_Rotation used 26.349 ms

Total time for subspace rotation: 26.354 ms
rank = 0, Efermi =  -0.076463903967 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.207 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.800 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.595 ms
rank = 0, Calculating density took 1593.169 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.830 ms
rank = 0, D2D took 1.932 ms
rank = 0, Transfering density took 1.939 ms
Etot    =   -34.859482981699
Eband   =   -11.855662850741
E1      =    28.597715070204
E2      =   -10.018661850688
E3      =   -15.325120486467
Exc     =   -13.561508706563
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 9.755e-06, dEband = 4.685e-03
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -34.859482982, dEtot = 9.755e-06, dEband = 4.685e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1778963102240, which took 0.055 ms

iter_count = 114, r_2norm = 4.705e-06, tol*||rhs|| = 7.116e-06

Anderson update took 60.685 ms, out of which F'*F took 28.965 ms; b-Ax took 194.697 ms, out of which Lap took 174.665 ms
rank = 0, Mixing (+ precond) took 417.197 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082231, int_b + int_rho = -4.620e-13, checking this took 0.109 ms
2-norm of RHS = 822.7486746739919, which took 0.136 ms

iter_count = 210, r_2norm = 6.890e-04, tol*||rhs|| = 8.227e-04

Anderson update took 112.117 ms, out of which F'*F took 53.374 ms; b-Ax took 358.222 ms, out of which Lap took 320.971 ms
Solving Poisson took 755.236 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.189573 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.179 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.333 ms
Total time for convolution: 	 convolve: 5.249499 
Total time for convolution: 	 convolve: 5.252013 
Total time for convolution: 	 convolve: 5.231983 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.490 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.835 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.367 ms

This SCF took 28532.785 ms, scf error = 1.327e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.125081, lowerbound = -0.728068, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1481.582 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.210 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.705 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.931 ms
rank =  0, finding HY took 24.490 ms
rank =  0, distributing HY into block cyclic form took 18.326 ms
rank =  0, finding Y'*HY took 4.424 ms
Rank 0, Project_Hamiltonian used 68.717 ms
Total time for projection: 68.729 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.229 ms
    first calculated eigval = -0.726237331968033
    last  calculated eigval = 0.026799547106852
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48515757308193
lambda[   6] =  -0.41251233919526
lambda[   7] =  -0.38903005358939
lambda[   8] =  -0.35909680188958
lambda[   9] =  -0.35070447498352
lambda[  10] =  -0.32609195442614
lambda[  11] =  -0.30782225784067
lambda[  12] =  -0.28807677983266
lambda[  13] =  -0.27350517647672
lambda[  14] =  -0.19008000462012
lambda[  15] =  -0.04596252925039
lambda[  16] =  -0.02409348532176
lambda[  17] =   0.00966374341105
lambda[  18] =   0.01488452282696
lambda[  19] =   0.01948017300755
lambda[  20] =   0.02128843852217
lambda[  21] =   0.02679954710685
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 8.211 ms
rank =  0, Distributing orbital back into band + domain format took 18.042 ms
rank = 0, Subspace_Rotation used 26.267 ms

Total time for subspace rotation: 26.272 ms
rank = 0, Efermi =  -0.074737528891 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.229 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.711 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.612 ms
rank = 0, Calculating density took 1593.497 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.827 ms
rank = 0, D2D took 2.044 ms
rank = 0, Transfering density took 2.049 ms
Etot    =   -34.859416789582
Eband   =   -11.805153979980
E1      =    28.569493017446
E2      =    -9.994963832069
E3      =   -15.331708797012
Exc     =   -13.566619624373
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 5.092e-06, dEband = 3.885e-03
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -34.859416790, dEtot = 5.092e-06, dEband = 3.885e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0850750090992, which took 0.064 ms

iter_count = 114, r_2norm = 2.439e-06, tol*||rhs|| = 3.403e-06

Anderson update took 61.074 ms, out of which F'*F took 28.931 ms; b-Ax took 194.614 ms, out of which Lap took 174.610 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.830 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082250, int_b + int_rho = -2.765e-13, checking this took 0.109 ms
2-norm of RHS = 822.7502954569019, which took 0.133 ms

iter_count = 204, r_2norm = 7.007e-04, tol*||rhs|| = 8.228e-04

Anderson update took 108.995 ms, out of which F'*F took 51.624 ms; b-Ax took 347.250 ms, out of which Lap took 311.545 ms
Solving Poisson took 732.371 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.145 ms
Total time for convolution: 	 convolve: 5.179523 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.499 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.225188 
Total time for convolution: 	 convolve: 5.237435 
Total time for convolution: 	 convolve: 5.166693 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.503 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.100 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.638 ms

This SCF took 27618.737 ms, scf error = 9.269e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.126800, lowerbound = -0.726237, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1476.635 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.338 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.762 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.122 ms
rank =  0, finding HY took 24.640 ms
rank =  0, distributing HY into block cyclic form took 18.510 ms
rank =  0, finding Y'*HY took 4.030 ms
Rank 0, Project_Hamiltonian used 68.353 ms
Total time for projection: 68.368 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.107 ms
rank = 0, Solve_Generalized_EigenProblem used 0.247 ms
    first calculated eigval = -0.725270938008822
    last  calculated eigval = 0.029658082928690
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48417457669764
lambda[   6] =  -0.41153171942884
lambda[   7] =  -0.38805672391268
lambda[   8] =  -0.35805185916234
lambda[   9] =  -0.34967888387151
lambda[  10] =  -0.32513354525181
lambda[  11] =  -0.30681727466010
lambda[  12] =  -0.28708440915719
lambda[  13] =  -0.27248895991675
lambda[  14] =  -0.18905989582323
lambda[  15] =  -0.04492564194508
lambda[  16] =  -0.02092003172351
lambda[  17] =   0.01340707151275
lambda[  18] =   0.01793435072726
lambda[  19] =   0.02256768765230
lambda[  20] =   0.02423050092987
lambda[  21] =   0.02965808292869
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.278 ms
rank =  0, subspace rotation using ScaLAPACK took 8.231 ms
rank =  0, Distributing orbital back into band + domain format took 18.173 ms
rank = 0, Subspace_Rotation used 26.430 ms

Total time for subspace rotation: 26.435 ms
rank = 0, Efermi =  -0.073700641556 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.238 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.768 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 1588.856 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.834 ms
rank = 0, D2D took 1.939 ms
rank = 0, Transfering density took 1.945 ms
Etot    =   -34.859401877362
Eband   =   -11.777275665645
E1      =    28.557610810061
E2      =    -9.978899463668
E3      =   -15.332140360688
Exc     =   -13.566968014379
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 1.147e-06, dEband = 2.144e-03
rank = 0, Calculating/Estimating energy took 0.933 ms, Etot = -34.859401877, dEtot = 1.147e-06, dEband = 2.144e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0526334521744, which took 0.057 ms

iter_count = 114, r_2norm = 1.639e-06, tol*||rhs|| = 2.105e-06

Anderson update took 60.912 ms, out of which F'*F took 28.665 ms; b-Ax took 193.748 ms, out of which Lap took 173.877 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.969 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082239, int_b + int_rho = -3.856e-13, checking this took 0.139 ms
2-norm of RHS = 822.7538121975347, which took 0.126 ms

iter_count = 174, r_2norm = 7.928e-04, tol*||rhs|| = 8.228e-04

Anderson update took 94.038 ms, out of which F'*F took 44.455 ms; b-Ax took 298.700 ms, out of which Lap took 268.207 ms
Solving Poisson took 628.174 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.176497 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 86.816 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.160100 
Total time for convolution: 	 convolve: 5.165596 
Total time for convolution: 	 convolve: 5.147242 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.556 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.558 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.513 ms

This SCF took 27925.492 ms, scf error = 5.434e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129658, lowerbound = -0.725271, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1477.931 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.229 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.659 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.911 ms
rank =  0, finding HY took 24.682 ms
rank =  0, distributing HY into block cyclic form took 18.340 ms
rank =  0, finding Y'*HY took 4.023 ms
Rank 0, Project_Hamiltonian used 68.005 ms
Total time for projection: 68.018 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.107 ms
rank = 0, Solve_Generalized_EigenProblem used 0.250 ms
    first calculated eigval = -0.724490543881845
    last  calculated eigval = 0.031517431353946
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48342081792596
lambda[   6] =  -0.41077606992350
lambda[   7] =  -0.38729014630077
lambda[   8] =  -0.35729416438030
lambda[   9] =  -0.34890647913410
lambda[  10] =  -0.32437571780505
lambda[  11] =  -0.30607028342713
lambda[  12] =  -0.28632487419692
lambda[  13] =  -0.27172997965937
lambda[  14] =  -0.18833424935442
lambda[  15] =  -0.04421287233953
lambda[  16] =  -0.01913084849261
lambda[  17] =   0.01522551021664
lambda[  18] =   0.01880980117518
lambda[  19] =   0.02433564422481
lambda[  20] =   0.02560328053840
lambda[  21] =   0.03151743135395
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.268 ms
rank =  0, subspace rotation using ScaLAPACK took 8.225 ms
rank =  0, Distributing orbital back into band + domain format took 18.110 ms
rank = 0, Subspace_Rotation used 26.357 ms

Total time for subspace rotation: 26.363 ms
rank = 0, Efermi =  -0.072987871856 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.183 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.818 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.596 ms
rank = 0, Calculating density took 1589.308 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.818 ms
rank = 0, D2D took 1.915 ms
rank = 0, Transfering density took 1.918 ms
Etot    =   -34.859475334933
Eband   =   -11.755967480877
E1      =    28.546520050478
E2      =    -9.968195797817
E3      =   -15.334250375020
Exc     =   -13.568665245615
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 5.651e-06, dEband = 1.639e-03
rank = 0, Calculating/Estimating energy took 0.946 ms, Etot = -34.859475335, dEtot = 5.651e-06, dEband = 1.639e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0418864637267, which took 0.054 ms

iter_count = 114, r_2norm = 1.376e-06, tol*||rhs|| = 1.675e-06

Anderson update took 61.182 ms, out of which F'*F took 28.941 ms; b-Ax took 194.535 ms, out of which Lap took 174.482 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.600 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082228, int_b + int_rho = -4.948e-13, checking this took 0.078 ms
2-norm of RHS = 822.7602921829798, which took 0.126 ms

iter_count = 156, r_2norm = 8.127e-04, tol*||rhs|| = 8.228e-04

Anderson update took 83.082 ms, out of which F'*F took 39.613 ms; b-Ax took 265.608 ms, out of which Lap took 238.360 ms
Solving Poisson took 560.565 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.187612 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 47.465 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.173251 
Total time for convolution: 	 convolve: 5.159853 
Total time for convolution: 	 convolve: 5.170252 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 3.490 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.123 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.647 ms

This SCF took 27366.277 ms, scf error = 3.628e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.131517, lowerbound = -0.724491, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1477.796 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.213 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.641 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.878 ms
rank =  0, finding HY took 24.644 ms
rank =  0, distributing HY into block cyclic form took 18.297 ms
rank =  0, finding Y'*HY took 4.040 ms
Rank 0, Project_Hamiltonian used 67.900 ms
Total time for projection: 67.913 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.146 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.253 ms
    first calculated eigval = -0.724091635591805
    last  calculated eigval = 0.032917565259263
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48304216931060
lambda[   6] =  -0.41039430584316
lambda[   7] =  -0.38690043056673
lambda[   8] =  -0.35693094547704
lambda[   9] =  -0.34852583795447
lambda[  10] =  -0.32399186093042
lambda[  11] =  -0.30570063090425
lambda[  12] =  -0.28594907877742
lambda[  13] =  -0.27134062106697
lambda[  14] =  -0.18794842209390
lambda[  15] =  -0.04384229750179
lambda[  16] =  -0.01786078777285
lambda[  17] =   0.01611103653925
lambda[  18] =   0.01940457813891
lambda[  19] =   0.02563387528920
lambda[  20] =   0.02634100478138
lambda[  21] =   0.03291756525926
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.270 ms
rank =  0, subspace rotation using ScaLAPACK took 8.215 ms
rank =  0, Distributing orbital back into band + domain format took 18.239 ms
rank = 0, Subspace_Rotation used 26.476 ms

Total time for subspace rotation: 26.481 ms
rank = 0, Efermi =  -0.072617297115 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.297 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.680 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.605 ms
rank = 0, Calculating density took 1589.166 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.832 ms
rank = 0, D2D took 1.930 ms
rank = 0, Transfering density took 1.931 ms
Etot    =   -34.859542258051
Eband   =   -11.745234629149
E1      =    28.541064472983
E2      =    -9.962722837369
E3      =   -15.335010286840
Exc     =   -13.569296394340
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 5.148e-06, dEband = 8.256e-04
rank = 0, Calculating/Estimating energy took 0.943 ms, Etot = -34.859542258, dEtot = 5.148e-06, dEband = 8.256e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0342001611844, which took 0.054 ms

iter_count = 114, r_2norm = 9.951e-07, tol*||rhs|| = 1.368e-06

Anderson update took 60.900 ms, out of which F'*F took 28.793 ms; b-Ax took 193.889 ms, out of which Lap took 174.167 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.259 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082237, int_b + int_rho = -4.038e-13, checking this took 0.120 ms
2-norm of RHS = 822.7691811170739, which took 0.117 ms

iter_count = 156, r_2norm = 8.205e-04, tol*||rhs|| = 8.228e-04

Anderson update took 83.143 ms, out of which F'*F took 39.649 ms; b-Ax took 266.174 ms, out of which Lap took 238.747 ms
Solving Poisson took 560.968 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.203133 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 63.995 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.163759 
Total time for convolution: 	 convolve: 5.183665 
Total time for convolution: 	 convolve: 5.170062 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.529 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.098 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.664 ms

This SCF took 27415.087 ms, scf error = 2.566e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132918, lowerbound = -0.724092, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1475.505 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.193 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.620 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.833 ms
rank =  0, finding HY took 24.566 ms
rank =  0, distributing HY into block cyclic form took 18.363 ms
rank =  0, finding Y'*HY took 4.059 ms
Rank 0, Project_Hamiltonian used 67.854 ms
Total time for projection: 67.866 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.231 ms
    first calculated eigval = -0.723773345153148
    last  calculated eigval = 0.034742281243255
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48273150344342
lambda[   6] =  -0.41008337417187
lambda[   7] =  -0.38658773357635
lambda[   8] =  -0.35664044132305
lambda[   9] =  -0.34821783785160
lambda[  10] =  -0.32368500043656
lambda[  11] =  -0.30539859378954
lambda[  12] =  -0.28564416773577
lambda[  13] =  -0.27102585866622
lambda[  14] =  -0.18762803351808
lambda[  15] =  -0.04353654952340
lambda[  16] =  -0.01614952246079
lambda[  17] =   0.01720034395213
lambda[  18] =   0.02057990947311
lambda[  19] =   0.02664022265918
lambda[  20] =   0.02753198364862
lambda[  21] =   0.03474228124326
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.266 ms
rank =  0, subspace rotation using ScaLAPACK took 8.239 ms
rank =  0, Distributing orbital back into band + domain format took 18.080 ms
rank = 0, Subspace_Rotation used 26.335 ms

Total time for subspace rotation: 26.339 ms
rank = 0, Efermi =  -0.072311549062 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.210 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.770 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1586.668 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.844 ms
rank = 0, D2D took 2.952 ms
rank = 0, Transfering density took 2.957 ms
Etot    =   -34.859597395106
Eband   =   -11.736561841411
E1      =    28.536976019874
E2      =    -9.958015359738
E3      =   -15.335426337447
Exc     =   -13.569644438998
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 4.241e-06, dEband = 6.671e-04
rank = 0, Calculating/Estimating energy took 0.910 ms, Etot = -34.859597395, dEtot = 4.241e-06, dEband = 6.671e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0222371808349, which took 0.070 ms

iter_count = 114, r_2norm = 6.437e-07, tol*||rhs|| = 8.895e-07

Anderson update took 61.039 ms, out of which F'*F took 28.886 ms; b-Ax took 194.154 ms, out of which Lap took 174.209 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.784 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082243, int_b + int_rho = -3.456e-13, checking this took 0.098 ms
2-norm of RHS = 822.7728601572234, which took 0.126 ms

iter_count = 138, r_2norm = 8.067e-04, tol*||rhs|| = 8.228e-04

Anderson update took 73.681 ms, out of which F'*F took 34.881 ms; b-Ax took 234.688 ms, out of which Lap took 210.515 ms
Solving Poisson took 496.485 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.191180 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 74.008 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.244530 
Total time for convolution: 	 convolve: 5.229577 
Total time for convolution: 	 convolve: 5.179821 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.762 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.578 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
---Transfer Veff_loc: D2D took 3.554 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.116 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.706 ms

This SCF took 27466.241 ms, scf error = 1.706e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.134742, lowerbound = -0.723773, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1479.028 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.231 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.658 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.908 ms
rank =  0, finding HY took 24.601 ms
rank =  0, distributing HY into block cyclic form took 18.165 ms
rank =  0, finding Y'*HY took 4.095 ms
Rank 0, Project_Hamiltonian used 67.802 ms
Total time for projection: 67.815 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -0.723602104737133
    last  calculated eigval = 0.034914416559652
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48256042711260
lambda[   6] =  -0.40991190684394
lambda[   7] =  -0.38641557600732
lambda[   8] =  -0.35647892066078
lambda[   9] =  -0.34804693955782
lambda[  10] =  -0.32351669512936
lambda[  11] =  -0.30522934951108
lambda[  12] =  -0.28547723359461
lambda[  13] =  -0.27086365472023
lambda[  14] =  -0.18746397681713
lambda[  15] =  -0.04338942861257
lambda[  16] =  -0.01547984429909
lambda[  17] =   0.01725636604981
lambda[  18] =   0.02152356319019
lambda[  19] =   0.02630891835541
lambda[  20] =   0.02831075251141
lambda[  21] =   0.03491441655965
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.260 ms
rank =  0, subspace rotation using ScaLAPACK took 8.237 ms
rank =  0, Distributing orbital back into band + domain format took 18.095 ms
rank = 0, Subspace_Rotation used 26.350 ms

Total time for subspace rotation: 26.355 ms
rank = 0, Efermi =  -0.072164428161 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.195 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.818 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.573 ms
rank = 0, Calculating density took 1591.063 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.816 ms
rank = 0, D2D took 1.917 ms
rank = 0, Transfering density took 1.920 ms
Etot    =   -34.859640759706
Eband   =   -11.731834869762
E1      =    28.534664817975
E2      =    -9.955475611089
E3      =   -15.335796914502
Exc     =   -13.569934401755
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 3.336e-06, dEband = 3.636e-04
rank = 0, Calculating/Estimating energy took 0.950 ms, Etot = -34.859640760, dEtot = 3.336e-06, dEband = 3.636e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0220035061401, which took 0.122 ms

iter_count = 108, r_2norm = 6.267e-07, tol*||rhs|| = 8.801e-07

Anderson update took 57.803 ms, out of which F'*F took 27.291 ms; b-Ax took 188.021 ms, out of which Lap took 169.520 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 401.065 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082239, int_b + int_rho = -3.856e-13, checking this took 0.124 ms
2-norm of RHS = 822.7728191144620, which took 0.142 ms

iter_count = 144, r_2norm = 7.317e-04, tol*||rhs|| = 8.228e-04

Anderson update took 76.591 ms, out of which F'*F took 36.422 ms; b-Ax took 245.186 ms, out of which Lap took 219.895 ms
Solving Poisson took 517.299 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.199848 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.175168 
Total time for convolution: 	 convolve: 5.180098 
Total time for convolution: 	 convolve: 5.147258 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.727 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.511 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.203 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.753 ms

This SCF took 27263.872 ms, scf error = 1.169e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.134914, lowerbound = -0.723602, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1475.209 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.239 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.720 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.973 ms
rank =  0, finding HY took 24.529 ms
rank =  0, distributing HY into block cyclic form took 18.300 ms
rank =  0, finding Y'*HY took 4.054 ms
Rank 0, Project_Hamiltonian used 67.883 ms
Total time for projection: 67.899 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -0.723638978254778
    last  calculated eigval = 0.034669209626916
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48257660065317
lambda[   6] =  -0.40993143024288
lambda[   7] =  -0.38643874829849
lambda[   8] =  -0.35649208073670
lambda[   9] =  -0.34805789696634
lambda[  10] =  -0.32354377467808
lambda[  11] =  -0.30524412575072
lambda[  12] =  -0.28549438633943
lambda[  13] =  -0.27088674580193
lambda[  14] =  -0.18748827298361
lambda[  15] =  -0.04342371413241
lambda[  16] =  -0.01526434368036
lambda[  17] =   0.01645249207263
lambda[  18] =   0.02174376371833
lambda[  19] =   0.02589292267254
lambda[  20] =   0.02842285201346
lambda[  21] =   0.03466920962692
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.257 ms
rank =  0, subspace rotation using ScaLAPACK took 8.219 ms
rank =  0, Distributing orbital back into band + domain format took 18.175 ms
rank = 0, Subspace_Rotation used 26.407 ms

Total time for subspace rotation: 26.412 ms
rank = 0, Efermi =  -0.072198713695 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.222 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.718 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.579 ms
rank = 0, Calculating density took 1586.424 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.828 ms
rank = 0, D2D took 1.934 ms
rank = 0, Transfering density took 1.940 ms
Etot    =   -34.859665008973
Eband   =   -11.732430170493
E1      =    28.535328074367
E2      =    -9.955501403143
E3      =   -15.335278910391
Exc     =   -13.569534394626
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 1.865e-06, dEband = 4.579e-05
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -34.859665009, dEtot = 1.865e-06, dEband = 4.579e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0216665547995, which took 0.060 ms

iter_count = 108, r_2norm = 6.262e-07, tol*||rhs|| = 8.667e-07

Anderson update took 57.748 ms, out of which F'*F took 27.427 ms; b-Ax took 183.739 ms, out of which Lap took 164.758 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.999 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082246, int_b + int_rho = -3.129e-13, checking this took 0.111 ms
2-norm of RHS = 822.7725241475539, which took 0.130 ms

iter_count = 42, r_2norm = 8.054e-04, tol*||rhs|| = 8.228e-04

Anderson update took 22.330 ms, out of which F'*F took 10.671 ms; b-Ax took 71.555 ms, out of which Lap took 64.068 ms
Solving Poisson took 153.207 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.207365 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.213160 
Total time for convolution: 	 convolve: 5.175164 
Total time for convolution: 	 convolve: 5.182566 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.822 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.513 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.112 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.660 ms

This SCF took 27007.799 ms, scf error = 1.159e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.134669, lowerbound = -0.723639, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1482.491 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.553 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.607 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.179 ms
rank =  0, finding HY took 24.578 ms
rank =  0, distributing HY into block cyclic form took 18.296 ms
rank =  0, finding Y'*HY took 4.098 ms
Rank 0, Project_Hamiltonian used 68.184 ms
Total time for projection: 68.197 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.213 ms
    first calculated eigval = -0.723628263463841
    last  calculated eigval = 0.034687094316563
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48256809574123
lambda[   6] =  -0.40992221160889
lambda[   7] =  -0.38642869885855
lambda[   8] =  -0.35648355083087
lambda[   9] =  -0.34804962566371
lambda[  10] =  -0.32353340386864
lambda[  11] =  -0.30523570881388
lambda[  12] =  -0.28548582451612
lambda[  13] =  -0.27087777100996
lambda[  14] =  -0.18747967443656
lambda[  15] =  -0.04341547449534
lambda[  16] =  -0.01518566644825
lambda[  17] =   0.01648975150880
lambda[  18] =   0.02178097028670
lambda[  19] =   0.02591613152285
lambda[  20] =   0.02822605079008
lambda[  21] =   0.03468709431656
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.239 ms
rank =  0, subspace rotation using ScaLAPACK took 8.236 ms
rank =  0, Distributing orbital back into band + domain format took 18.321 ms
rank = 0, Subspace_Rotation used 26.579 ms

Total time for subspace rotation: 26.583 ms
rank = 0, Efermi =  -0.072190474133 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 5.076 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.527 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.618 ms
rank = 0, Calculating density took 1594.888 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.012 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.958 ms
rank = 0, D2D took 2.075 ms
rank = 0, Transfering density took 2.083 ms
Etot    =   -34.859667237384
Eband   =   -11.732170115641
E1      =    28.535149344788
E2      =    -9.955408148084
E3      =   -15.335330181687
Exc     =   -13.569575964546
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 1.714e-07, dEband = 2.000e-05
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -34.859667237, dEtot = 1.714e-07, dEband = 2.000e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0208962903146, which took 0.055 ms

iter_count = 108, r_2norm = 5.027e-07, tol*||rhs|| = 8.359e-07

Anderson update took 57.637 ms, out of which F'*F took 27.390 ms; b-Ax took 183.700 ms, out of which Lap took 165.015 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.277 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082241, int_b + int_rho = -3.638e-13, checking this took 0.110 ms
2-norm of RHS = 822.7708645916869, which took 0.161 ms

iter_count = 96, r_2norm = 7.778e-04, tol*||rhs|| = 8.228e-04

Anderson update took 51.106 ms, out of which F'*F took 24.158 ms; b-Ax took 163.471 ms, out of which Lap took 146.773 ms
Solving Poisson took 346.177 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.220603 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.208378 
Total time for convolution: 	 convolve: 5.173649 
Total time for convolution: 	 convolve: 5.239228 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 2.242 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.523 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.144 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.702 ms

This SCF took 27209.996 ms, scf error = 1.028e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.134687, lowerbound = -0.723628, upperbound = 267.565328

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1482.634 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.199 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.657 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.874 ms
rank =  0, finding HY took 24.590 ms
rank =  0, distributing HY into block cyclic form took 18.203 ms
rank =  0, finding Y'*HY took 4.048 ms
Rank 0, Project_Hamiltonian used 67.746 ms
Total time for projection: 67.759 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.989 ms
    first calculated eigval = -0.723514040429682
    last  calculated eigval = 0.034357511782537
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48246652684011
lambda[   6] =  -0.40981484894348
lambda[   7] =  -0.38631633501625
lambda[   8] =  -0.35637427211985
lambda[   9] =  -0.34794103185928
lambda[  10] =  -0.32342268858528
lambda[  11] =  -0.30513030178184
lambda[  12] =  -0.28538116473141
lambda[  13] =  -0.27077127376652
lambda[  14] =  -0.18737835995591
lambda[  15] =  -0.04331834701854
lambda[  16] =  -0.01557962206311
lambda[  17] =   0.01626634881802
lambda[  18] =   0.02151687598514
lambda[  19] =   0.02579672306391
lambda[  20] =   0.02747670399066
lambda[  21] =   0.03435751178254
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 1.016 ms
rank =  0, subspace rotation using ScaLAPACK took 8.748 ms
rank =  0, Distributing orbital back into band + domain format took 18.050 ms
rank = 0, Subspace_Rotation used 26.821 ms

Total time for subspace rotation: 26.828 ms
rank = 0, Efermi =  -0.072093346554 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.190 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.762 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.583 ms
rank = 0, Calculating density took 1594.905 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.831 ms
rank = 0, D2D took 1.934 ms
rank = 0, Transfering density took 1.941 ms
Etot    =   -34.859677755197
Eband   =   -11.729131984627
E1      =    28.533462903775
E2      =    -9.953990094672
E3      =   -15.335599202283
Exc     =   -13.569789139545
Esc     =   -63.383808830841
Entropy =    -0.000000000914
dE = 8.091e-07, dEband = 2.337e-04
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -34.859677755, dEtot = 8.091e-07, dEband = 2.337e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0172561529918, which took 0.062 ms

iter_count = 108, r_2norm = 4.461e-07, tol*||rhs|| = 6.902e-07

Anderson update took 57.872 ms, out of which F'*F took 27.457 ms; b-Ax took 184.040 ms, out of which Lap took 165.107 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.972 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003082278, int_rho =  28.00000003082233, int_b + int_rho = -4.438e-13, checking this took 0.110 ms
2-norm of RHS = 822.7707157477023, which took 0.101 ms

iter_count = 78, r_2norm = 6.967e-04, tol*||rhs|| = 8.228e-04

Anderson update took 41.565 ms, out of which F'*F took 19.615 ms; b-Ax took 135.902 ms, out of which Lap took 122.195 ms
Solving Poisson took 283.157 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.215955 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 65.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.278 ms
Total time for convolution: 	 convolve: 5.205369 
Total time for convolution: 	 convolve: 5.218706 
Total time for convolution: 	 convolve: 5.190542 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.517 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.094 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.649 ms

This SCF took 27182.977 ms, scf error = 6.594e-05
The last 17 occupations of kpoints #1 are (Nelectron = 28):
lambda[   5] =  -0.48246652684011, occ[   5] =   2.00000000000000
lambda[   6] =  -0.40981484894348, occ[   6] =   2.00000000000000
lambda[   7] =  -0.38631633501625, occ[   7] =   2.00000000000000
lambda[   8] =  -0.35637427211985, occ[   8] =   2.00000000000000
lambda[   9] =  -0.34794103185928, occ[   9] =   2.00000000000000
lambda[  10] =  -0.32342268858528, occ[  10] =   2.00000000000000
lambda[  11] =  -0.30513030178184, occ[  11] =   2.00000000000000
lambda[  12] =  -0.28538116473141, occ[  12] =   2.00000000000000
lambda[  13] =  -0.27077127376652, occ[  13] =   2.00000000000000
lambda[  14] =  -0.18737835995591, occ[  14] =   2.00000000000000
lambda[  15] =  -0.04331834701854, occ[  15] =   0.00000003082238
lambda[  16] =  -0.01557962206311, occ[  16] =   0.00000000000000
lambda[  17] =   0.01626634881802, occ[  17] =   0.00000000000000
lambda[  18] =   0.02151687598514, occ[  18] =   0.00000000000000
lambda[  19] =   0.02579672306391, occ[  19] =   0.00000000000000
lambda[  20] =   0.02747670399066, occ[  20] =   0.00000000000000
lambda[  21] =   0.03435751178254, occ[  21] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 19 (90%) = 0.000000000000000.
Occupation of state 21 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.632 ms, time for Allreduce/Reduce: 16.104 ms 
Time for calculating local force components: 27.772 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00885486978530  -0.04995503401165  -0.00000002011657
  0.04908242850598   0.01458815492360  -0.00000002862126
  0.01130995937272   0.04933419599081  -0.00000002002105
 -0.01125607654664  -0.04904810412416   0.00000002207302
  0.01190421080534   0.04894067829549  -0.00000002814192
 -0.00799827422595  -0.04864856116811   0.00000000091259
 -0.02250365572180   0.01840210290347  -0.03881266108166
 -0.02250364656637   0.01840208819695   0.03881263913167
 -0.01076961368567   0.00896618768766   0.00000040466251
  0.02902305560119  -0.00758470563719   0.00000030866130
 -0.02901303884950   0.00393822257478   0.00000012550518
  0.03510037363788  -0.01253625269505   0.00000001091062
 -0.01446692288784  -0.01435391273817  -0.00000026546090
force_loc = 
  0.00923436339079   0.05206709199455   0.00000015529835
 -0.05095695861833  -0.01542959943006   0.00000009280700
 -0.01194527145958  -0.05131345818894  -0.00000017080233
  0.01178859285432   0.05112955040142  -0.00000010934833
 -0.01243507975429  -0.05098842061637   0.00000007265290
  0.00830438174032   0.04972048910796   0.00000003963002
  0.02295399705576  -0.01899803372003   0.03964824382624
  0.02295385237939  -0.01899751062311  -0.03964755191537
  0.00112860458720  -0.00045748710639   0.00000154007465
 -0.01815808990772  -0.00024747660232   0.00000215931887
  0.01814944345870   0.00366286293112  -0.00000014515689
 -0.02201652461148   0.00497571711333   0.00000085063840
  0.01220971674687   0.01401499511698  -0.00000111120471
Time for calculating nonlocal force components: 40.226 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00411248647431  -0.00357898699003   0.00000008129268
[0m[32m -0.00420009636398   0.00339870995754   0.00000012678479
[0m[32m  0.00424927065815  -0.00336119274385  -0.00000000280467
[0m[32m -0.00582556248559   0.00327889739671   0.00000005189665
[0m[32m  0.00139518330515   0.00068632602319  -0.00000004012981
[0mTime for calculating XC forces components: 40.575 ms
 Cartesian force = 
  0.00037978290517   0.00211147842750  -0.00000023183914
 -0.00187424081266  -0.00084202406186  -0.00000030283518
 -0.00063502278717  -0.00197984175352  -0.00000055784430
  0.00053280560737   0.00208086672187  -0.00000045429623
 -0.00053057964926  -0.00204832187628  -0.00000032250994
  0.00030639681406   0.00107134838446  -0.00000032647831
  0.00045063063365  -0.00059651037196   0.00083521572365
  0.00045049511272  -0.00059600198155  -0.00083527980462
 -0.00552823332446   0.00492913403585   0.00000165900892
  0.00666515862918  -0.00443405183736   0.00000222774405
 -0.00661403543296   0.00423931320665  -0.00000038947730
  0.00725857584050  -0.00428221774040   0.00000054642475
 -0.00086173353613   0.00034682884661  -0.00000178381633
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
Time for printing density: 2072.253 ms
The program took 504.127 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:37:02
Job ID:        2266940
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:43:36,vmem=8352K,walltime=00:08:38,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-4-1
---------------------------------------
