---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:27
Job ID:    2266944
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:33
Job ID:    2266944
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.017 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 5.628 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 7.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 29.442 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 136.670 ms

Freeing SPARC_INPUT_MPI datatype took 0.022 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.959 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.090 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   12.018570	   12.818855	   10.000000	
    7.876247	   13.850555	   10.000000	
    8.236684	    5.353606	   10.000000	
   12.123753	   14.646394	   10.000000	
    9.528125	   12.280624	   10.000000	
    9.086596	    9.566550	   10.000000	
    8.634201	    7.324393	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.168 ms
Set up communicators.

--set up spincomm took 2.267 ms

--set up kptcomm took 0.349 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.008 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.102 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.332 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.575 ms

Calculate_SplineDerivRadFun took 0.214 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.273 ms.
time spent on vectorized spline interp: 3.255 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.030 ms.
time spent on vectorized spline interp: 1.550 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.355 ms.
time spent on vectorized spline interp: 1.735 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.539 ms.

Calculating rb for all atom types took 15.747 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.831 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000195833, sum_int_rho = 25.7832178007992
PosCharge = 26.000000019583, NegCharge = -25.783217800799, scal_fac = 1.008407880679
After scaling, int_rho = 26.0000000195831, PosCharge + NegCharge - NetCharge = 1.954e-13
--Calculate Vref took 0.546 ms
--Calculate rho_guess took 2.801 ms

 integral of b = -26.0000000195833,
 int{b} + Nelectron + NetCharge = -1.958e-08,
 Esc = -81.9888367574436,
 MPI_Reduce took 10.907 ms

Calculating b & b_ref took 21.180 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.012 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.022 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.031 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 39.781 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958312, int_b + int_rho = -2.401e-13, checking this took 0.110 ms
2-norm of RHS = 658.9753390163816, which took 0.421 ms

iter_count = 420, r_2norm = 6.372e-04, tol*||rhs|| = 6.590e-04

Anderson update took 260.055 ms, out of which F'*F took 115.653 ms; b-Ax took 793.138 ms, out of which Lap took 704.316 ms
Solving Poisson took 1745.862 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.392 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
Total time for convolution: 	 convolve: 5.211178 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.777 ms
Total time for convolution: 	 convolve: 5.357902 
Total time for convolution: 	 convolve: 5.215375 
Total time for convolution: 	 convolve: 5.225700 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.764 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.640 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
rank = 0, XC calculation took 24960.413 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 2.222 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.129 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.425 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.267 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.910 ms
    Lanczos iter 53, eigmin  = -1.098006461, eigmax = 264.929956421, err_eigmin = 1.333e-03, err_eigmax = 9.617e-03
rank =   0, Lanczos took 138.469 ms, eigmin = -1.098006460673, eigmax = 267.579255985018

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.190625, lowerbound = -1.198006, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1994.776 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 23.371 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.177 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 27.597 ms
rank =  0, finding HY took 33.867 ms
rank =  0, distributing HY into block cyclic form took 21.819 ms
rank =  0, finding Y'*HY took 6.447 ms
Rank 0, Project_Hamiltonian used 89.767 ms
Total time for projection: 89.779 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.480 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.557 ms
    first calculated eigval = 2.686529734940781
    last  calculated eigval = 3.213956274984933
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.81147825317752
lambda[   5] =   2.84529676458379
lambda[   6] =   2.89590856285811
lambda[   7] =   2.91841863769062
lambda[   8] =   2.94384525097890
lambda[   9] =   2.96069792348758
lambda[  10] =   2.97772080085560
lambda[  11] =   2.99382448856647
lambda[  12] =   3.02327908492556
lambda[  13] =   3.04908421261280
lambda[  14] =   3.07543206977621
lambda[  15] =   3.11690141750552
lambda[  16] =   3.12996642838736
lambda[  17] =   3.14633706003039
lambda[  18] =   3.15995459372222
lambda[  19] =   3.18121779938332
lambda[  20] =   3.21395627498493
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.590 ms
rank =  0, subspace rotation using ScaLAPACK took 6.492 ms
rank =  0, Distributing orbital back into band + domain format took 20.230 ms
rank = 0, Subspace_Rotation used 26.747 ms

Total time for subspace rotation: 26.751 ms
rank = 0, Efermi =   3.062258142779 calculate fermi energy took 0.074 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.313956, lowerbound = -1.198006, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2008.301 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.571 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.092 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 24.707 ms
rank =  0, finding HY took 33.345 ms
rank =  0, distributing HY into block cyclic form took 20.795 ms
rank =  0, finding Y'*HY took 5.993 ms
Rank 0, Project_Hamiltonian used 84.876 ms
Total time for projection: 84.889 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -0.945475273739733
    last  calculated eigval = 0.433168414391027
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.46195726758282
lambda[   5] =  -0.36014803720631
lambda[   6] =  -0.20320576127845
lambda[   7] =  -0.12401036803923
lambda[   8] =  -0.01544217235122
lambda[   9] =   0.05910523681372
lambda[  10] =   0.07704637877973
lambda[  11] =   0.13167194881680
lambda[  12] =   0.25115246838298
lambda[  13] =   0.28773787498735
lambda[  14] =   0.29834981564356
lambda[  15] =   0.32081768212998
lambda[  16] =   0.35910914540708
lambda[  17] =   0.36594887139641
lambda[  18] =   0.38116139163105
lambda[  19] =   0.43232678033354
lambda[  20] =   0.43316841439103
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 6.564 ms
rank =  0, Distributing orbital back into band + domain format took 20.660 ms
rank = 0, Subspace_Rotation used 27.244 ms

Total time for subspace rotation: 27.250 ms
rank = 0, Efermi =   0.293043844925 calculate fermi energy took 0.043 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.533168, lowerbound = -1.198006, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2057.863 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 20.864 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.142 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.175 ms
rank =  0, Distribute data + matrix mult took 25.199 ms
rank =  0, finding HY took 33.104 ms
rank =  0, distributing HY into block cyclic form took 20.524 ms
rank =  0, finding Y'*HY took 6.122 ms
Rank 0, Project_Hamiltonian used 84.985 ms
Total time for projection: 84.990 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -1.111804787967312
    last  calculated eigval = 0.136391224669245
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.70800101856436
lambda[   5] =  -0.60514485018263
lambda[   6] =  -0.57343062779726
lambda[   7] =  -0.53056939288995
lambda[   8] =  -0.47036307666237
lambda[   9] =  -0.45425081438443
lambda[  10] =  -0.38543950090284
lambda[  11] =  -0.38170484856162
lambda[  12] =  -0.33419044970054
lambda[  13] =  -0.31487725922068
lambda[  14] =  -0.06900064673688
lambda[  15] =  -0.03086478754488
lambda[  16] =   0.06624669346041
lambda[  17] =   0.07826010284274
lambda[  18] =   0.08905944542268
lambda[  19] =   0.12537192725521
lambda[  20] =   0.13639122466925
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.194 ms
rank =  0, subspace rotation using ScaLAPACK took 6.532 ms
rank =  0, Distributing orbital back into band + domain format took 20.290 ms
rank = 0, Subspace_Rotation used 26.842 ms

Total time for subspace rotation: 26.847 ms
rank = 0, Efermi =  -0.098185929998 calculate fermi energy took 0.036 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.236391, lowerbound = -1.198006, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2054.409 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.934 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.121 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.085 ms
rank =  0, finding HY took 33.342 ms
rank =  0, distributing HY into block cyclic form took 20.267 ms
rank =  0, finding Y'*HY took 6.255 ms
Rank 0, Project_Hamiltonian used 84.984 ms
Total time for projection: 85.001 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.107 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.163 ms
    first calculated eigval = -1.112071609913706
    last  calculated eigval = 0.084203599796257
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.70890342103181
lambda[   5] =  -0.60854995091186
lambda[   6] =  -0.57490509416232
lambda[   7] =  -0.53925898130133
lambda[   8] =  -0.48073168406119
lambda[   9] =  -0.46252712853563
lambda[  10] =  -0.39480565777288
lambda[  11] =  -0.39075806637690
lambda[  12] =  -0.37832500431869
lambda[  13] =  -0.35628950936845
lambda[  14] =  -0.15048713887521
lambda[  15] =  -0.09908965482271
lambda[  16] =   0.00887460830859
lambda[  17] =   0.01751981220330
lambda[  18] =   0.04148209191099
lambda[  19] =   0.07063359123814
lambda[  20] =   0.08420359979626
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 6.482 ms
rank =  0, Distributing orbital back into band + domain format took 20.628 ms
rank = 0, Subspace_Rotation used 27.130 ms

Total time for subspace rotation: 27.135 ms
rank = 0, Efermi =  -0.179672422164 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 4.670 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.301 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.272 ms
rank = 0, Calculating density took 8719.585 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.793 ms
rank = 0, D2D took 1.792 ms
rank = 0, Transfering density took 1.801 ms
Etot    =   -52.399928644771
Eband   =   -15.848468818564
E1      =    30.388146516438
E2      =   -13.496721450449
E3      =   -16.425867848247
Exc     =   -14.873358883308
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 7.486e+00, dEband = 2.264e+00
rank = 0, Calculating/Estimating energy took 1.590 ms, Etot = -52.399928645, dEtot = 7.486e+00, dEband = 2.264e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 62.0021863655715, which took 0.047 ms

iter_count = 96, r_2norm = 1.597e-03, tol*||rhs|| = 2.480e-03

Anderson update took 57.349 ms, out of which F'*F took 26.524 ms; b-Ax took 182.114 ms, out of which Lap took 161.878 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 400.195 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958312, int_b + int_rho = -2.474e-13, checking this took 0.108 ms
2-norm of RHS = 654.1252292074637, which took 0.203 ms

iter_count = 288, r_2norm = 5.483e-04, tol*||rhs|| = 6.541e-04

Anderson update took 172.923 ms, out of which F'*F took 87.903 ms; b-Ax took 549.463 ms, out of which Lap took 488.640 ms
Solving Poisson took 1193.982 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.474 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.140910 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 68.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.179947 
Total time for convolution: 	 convolve: 5.157911 
Total time for convolution: 	 convolve: 5.251358 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 1.400 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.467 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.894 ms

This SCF took 35142.542 ms, scf error = 1.531e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.184204, lowerbound = -1.112072, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2026.342 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.870 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.090 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 24.990 ms
rank =  0, finding HY took 33.783 ms
rank =  0, distributing HY into block cyclic form took 20.737 ms
rank =  0, finding Y'*HY took 6.406 ms
Rank 0, Project_Hamiltonian used 85.951 ms
Total time for projection: 85.964 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -1.085029180529973
    last  calculated eigval = 0.054667479097882
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.69231974299064
lambda[   5] =  -0.57889614692262
lambda[   6] =  -0.55070839666967
lambda[   7] =  -0.50066527956525
lambda[   8] =  -0.46204018869986
lambda[   9] =  -0.42872586674404
lambda[  10] =  -0.35905510164589
lambda[  11] =  -0.35566004613635
lambda[  12] =  -0.34239247231784
lambda[  13] =  -0.31393882757616
lambda[  14] =  -0.13871970581468
lambda[  15] =  -0.08114203450005
lambda[  16] =  -0.01238003256378
lambda[  17] =   0.00439843618031
lambda[  18] =   0.01893670469685
lambda[  19] =   0.04899087887622
lambda[  20] =   0.05466747909788
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 6.440 ms
rank =  0, Distributing orbital back into band + domain format took 21.759 ms
rank = 0, Subspace_Rotation used 28.220 ms

Total time for subspace rotation: 28.224 ms
rank = 0, Efermi =  -0.167904989282 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 5.172 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.016 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.289 ms
rank = 0, Calculating density took 2150.362 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.942 ms
rank = 0, D2D took 1.078 ms
rank = 0, Transfering density took 1.087 ms
Etot    =   -52.312116947639
Eband   =   -14.995179328115
E1      =    29.689102765841
E2      =   -13.384295000691
E3      =   -16.649639163219
Exc     =   -15.051137791242
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 1.254e-02, dEband = 1.219e-01
rank = 0, Calculating/Estimating energy took 1.700 ms, Etot = -52.312116948, dEtot = 1.254e-02, dEband = 1.219e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 28.7687167489137, which took 0.062 ms

iter_count = 102, r_2norm = 6.998e-04, tol*||rhs|| = 1.151e-03

Anderson update took 60.281 ms, out of which F'*F took 28.109 ms; b-Ax took 194.076 ms, out of which Lap took 172.314 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 429.531 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958303, int_b + int_rho = -3.347e-13, checking this took 0.124 ms
2-norm of RHS = 651.0506977492533, which took 0.159 ms

iter_count = 294, r_2norm = 5.731e-04, tol*||rhs|| = 6.511e-04

Anderson update took 175.731 ms, out of which F'*F took 80.318 ms; b-Ax took 548.243 ms, out of which Lap took 486.097 ms
Solving Poisson took 1208.198 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.167623 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.146448 
Total time for convolution: 	 convolve: 5.173418 
Total time for convolution: 	 convolve: 5.146760 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.225 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.373 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.415 ms
---Transfer Veff_loc: D2D took 1.290 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.472 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.782 ms

This SCF took 28476.460 ms, scf error = 9.500e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.154667, lowerbound = -1.085029, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2007.937 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.713 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.435 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 25.171 ms
rank =  0, finding HY took 34.296 ms
rank =  0, distributing HY into block cyclic form took 21.517 ms
rank =  0, finding Y'*HY took 6.114 ms
Rank 0, Project_Hamiltonian used 87.128 ms
Total time for projection: 87.144 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -1.057756010771931
    last  calculated eigval = 0.043315169712872
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.66095004138226
lambda[   5] =  -0.54697302887474
lambda[   6] =  -0.51283724814658
lambda[   7] =  -0.46501218432183
lambda[   8] =  -0.44166603038564
lambda[   9] =  -0.39432311310167
lambda[  10] =  -0.31721078375950
lambda[  11] =  -0.31524963683192
lambda[  12] =  -0.30650805680665
lambda[  13] =  -0.27478472029454
lambda[  14] =  -0.11391956703821
lambda[  15] =  -0.04961943975475
lambda[  16] =  -0.02386351898061
lambda[  17] =   0.00284467805024
lambda[  18] =   0.02551425794376
lambda[  19] =   0.03703027945405
lambda[  20] =   0.04331516971287
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 7.553 ms
rank =  0, Distributing orbital back into band + domain format took 20.882 ms
rank = 0, Subspace_Rotation used 28.456 ms

Total time for subspace rotation: 28.461 ms
rank = 0, Efermi =  -0.143104850366 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.274 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.759 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.287 ms
rank = 0, Calculating density took 2133.433 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.010 ms
rank = 0, D2D took 1.171 ms
rank = 0, Transfering density took 1.179 ms
Etot    =   -52.266724237244
Eband   =   -14.048538500237
E1      =    28.937169432706
E2      =   -13.182531885131
E3      =   -16.903548898143
Exc     =   -15.252599194956
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 6.485e-03, dEband = 1.352e-01
rank = 0, Calculating/Estimating energy took 0.990 ms, Etot = -52.266724237, dEtot = 6.485e-03, dEband = 1.352e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.3488191045355, which took 0.071 ms

iter_count = 108, r_2norm = 1.594e-04, tol*||rhs|| = 2.540e-04

Anderson update took 63.687 ms, out of which F'*F took 29.663 ms; b-Ax took 204.319 ms, out of which Lap took 181.205 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.053 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958314, int_b + int_rho = -2.256e-13, checking this took 0.118 ms
2-norm of RHS = 652.2896785691792, which took 0.196 ms

iter_count = 282, r_2norm = 6.393e-04, tol*||rhs|| = 6.523e-04

Anderson update took 166.833 ms, out of which F'*F took 76.819 ms; b-Ax took 523.958 ms, out of which Lap took 465.530 ms
Solving Poisson took 1154.855 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.141685 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.143899 
Total time for convolution: 	 convolve: 5.156974 
Total time for convolution: 	 convolve: 5.168114 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.402 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.427 ms
---Transfer Veff_loc: D2D took 1.378 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.486 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.889 ms

This SCF took 28404.237 ms, scf error = 4.185e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.143315, lowerbound = -1.057756, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1970.838 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.647 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.608 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.284 ms
rank =  0, finding HY took 64.578 ms
rank =  0, distributing HY into block cyclic form took 20.689 ms
rank =  0, finding Y'*HY took 5.906 ms
Rank 0, Project_Hamiltonian used 116.496 ms
Total time for projection: 116.510 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -1.046764305787094
    last  calculated eigval = 0.038927652585532
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.63975413954065
lambda[   5] =  -0.53062774654666
lambda[   6] =  -0.48852021251509
lambda[   7] =  -0.45393902346244
lambda[   8] =  -0.43052178121888
lambda[   9] =  -0.38294799084531
lambda[  10] =  -0.30881764630261
lambda[  11] =  -0.29464188785459
lambda[  12] =  -0.28732564494784
lambda[  13] =  -0.26211513440170
lambda[  14] =  -0.09997979055899
lambda[  15] =  -0.03520349304807
lambda[  16] =  -0.02711771958038
lambda[  17] =   0.00232630626843
lambda[  18] =   0.02432215684104
lambda[  19] =   0.03445029820598
lambda[  20] =   0.03892765258553
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 7.262 ms
rank =  0, Distributing orbital back into band + domain format took 21.033 ms
rank = 0, Subspace_Rotation used 28.315 ms

Total time for subspace rotation: 28.320 ms
rank = 0, Efermi =  -0.129165073944 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 5.080 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.540 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.440 ms
rank = 0, Calculating density took 2126.075 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.112 ms
rank = 0, D2D took 1.289 ms
rank = 0, Transfering density took 1.297 ms
Etot    =   -52.259139265631
Eband   =   -13.630173109555
E1      =    28.660328020392
E2      =   -13.025369701965
E3      =   -17.007530154579
Exc     =   -15.333357274980
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 1.084e-03, dEband = 5.977e-02
rank = 0, Calculating/Estimating energy took 1.156 ms, Etot = -52.259139266, dEtot = 1.084e-03, dEband = 5.977e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.1757401287713, which took 0.145 ms

iter_count = 108, r_2norm = 9.332e-05, tol*||rhs|| = 1.270e-04

Anderson update took 63.861 ms, out of which F'*F took 29.885 ms; b-Ax took 205.124 ms, out of which Lap took 182.236 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.080 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958314, int_b + int_rho = -2.183e-13, checking this took 0.144 ms
2-norm of RHS = 652.9036119528198, which took 0.181 ms

iter_count = 258, r_2norm = 5.757e-04, tol*||rhs|| = 6.529e-04

Anderson update took 152.512 ms, out of which F'*F took 69.851 ms; b-Ax took 478.939 ms, out of which Lap took 425.184 ms
Solving Poisson took 1056.075 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.116537 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.120735 
Total time for convolution: 	 convolve: 5.145906 
Total time for convolution: 	 convolve: 5.108150 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.299 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.630 ms

This SCF took 28161.327 ms, scf error = 1.294e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.138928, lowerbound = -1.046764, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1969.141 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.645 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.410 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 25.105 ms
rank =  0, finding HY took 32.274 ms
rank =  0, distributing HY into block cyclic form took 20.531 ms
rank =  0, finding Y'*HY took 5.975 ms
Rank 0, Project_Hamiltonian used 83.921 ms
Total time for projection: 83.934 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.163 ms
rank = 0, Solve_Generalized_EigenProblem used 0.286 ms
    first calculated eigval = -1.042705494946476
    last  calculated eigval = 0.036613307418846
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.63568497224589
lambda[   5] =  -0.52658668874705
lambda[   6] =  -0.48323560320835
lambda[   7] =  -0.44805347020029
lambda[   8] =  -0.42662614996751
lambda[   9] =  -0.37823461654263
lambda[  10] =  -0.30502960222078
lambda[  11] =  -0.29022739490275
lambda[  12] =  -0.28319093459475
lambda[  13] =  -0.25605923795576
lambda[  14] =  -0.09594761989316
lambda[  15] =  -0.03446600163902
lambda[  16] =  -0.02668493726340
lambda[  17] =   0.00101335501096
lambda[  18] =   0.01763887078415
lambda[  19] =   0.03350966946985
lambda[  20] =   0.03661330741885
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.297 ms
rank =  0, subspace rotation using ScaLAPACK took 7.431 ms
rank =  0, Distributing orbital back into band + domain format took 20.955 ms
rank = 0, Subspace_Rotation used 28.401 ms

Total time for subspace rotation: 28.405 ms
rank = 0, Efermi =  -0.125132903260 calculate fermi energy took 2.427 ms
rank = 0, --- Calculate rho: sum over local bands took 5.664 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.436 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.325 ms
rank = 0, Calculating density took 2092.705 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.014 ms
rank = 0, D2D took 1.167 ms
rank = 0, Transfering density took 1.170 ms
Etot    =   -52.258255974769
Eband   =   -13.508994147013
E1      =    28.599711447800
E2      =   -12.957939711389
E3      =   -17.035750153926
Exc     =   -15.353826382838
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 1.262e-04, dEband = 1.731e-02
rank = 0, Calculating/Estimating energy took 0.998 ms, Etot = -52.258255975, dEtot = 1.262e-04, dEband = 1.731e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.6092931360513, which took 0.082 ms

iter_count = 108, r_2norm = 5.243e-05, tol*||rhs|| = 6.437e-05

Anderson update took 64.213 ms, out of which F'*F took 29.245 ms; b-Ax took 200.612 ms, out of which Lap took 178.058 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.686 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958313, int_b + int_rho = -2.292e-13, checking this took 0.200 ms
2-norm of RHS = 653.5647331434944, which took 0.209 ms

iter_count = 252, r_2norm = 5.374e-04, tol*||rhs|| = 6.536e-04

Anderson update took 148.485 ms, out of which F'*F took 70.525 ms; b-Ax took 478.312 ms, out of which Lap took 426.161 ms
Solving Poisson took 1042.021 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.126 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.112337 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.108995 
Total time for convolution: 	 convolve: 5.120358 
Total time for convolution: 	 convolve: 5.110422 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.592 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.520 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 1.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.924 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.632 ms

This SCF took 28081.534 ms, scf error = 7.340e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.136613, lowerbound = -1.042705, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1995.201 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.728 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.462 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.221 ms
rank =  0, finding HY took 32.502 ms
rank =  0, distributing HY into block cyclic form took 20.897 ms
rank =  0, finding Y'*HY took 5.720 ms
Rank 0, Project_Hamiltonian used 84.376 ms
Total time for projection: 84.389 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.188 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.245 ms
    first calculated eigval = -1.040218941111002
    last  calculated eigval = 0.035440223952832
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.63368163044025
lambda[   5] =  -0.52416788930587
lambda[   6] =  -0.48103925526146
lambda[   7] =  -0.44523918587560
lambda[   8] =  -0.42422786216715
lambda[   9] =  -0.37579218708045
lambda[  10] =  -0.30290458433631
lambda[  11] =  -0.28841719933960
lambda[  12] =  -0.28166653354965
lambda[  13] =  -0.25364761277331
lambda[  14] =  -0.09379210183778
lambda[  15] =  -0.03442403838724
lambda[  16] =  -0.02579921757395
lambda[  17] =  -0.00006487564654
lambda[  18] =   0.01444288501197
lambda[  19] =   0.03212962939685
lambda[  20] =   0.03544022395283
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.262 ms
rank =  0, subspace rotation using ScaLAPACK took 7.372 ms
rank =  0, Distributing orbital back into band + domain format took 21.089 ms
rank = 0, Subspace_Rotation used 28.475 ms

Total time for subspace rotation: 28.480 ms
rank = 0, Efermi =  -0.122977385246 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.645 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.908 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.317 ms
rank = 0, Calculating density took 2118.346 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.971 ms
rank = 0, D2D took 1.123 ms
rank = 0, Transfering density took 1.126 ms
Etot    =   -52.257851645615
Eband   =   -13.451641742456
E1      =    28.587992856557
E2      =   -12.909234963862
E3      =   -17.043888544616
Exc     =   -15.358489510162
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 5.776e-05, dEband = 8.193e-03
rank = 0, Calculating/Estimating energy took 1.068 ms, Etot = -52.257851646, dEtot = 5.776e-05, dEband = 8.193e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5979014554183, which took 0.086 ms

iter_count = 114, r_2norm = 1.614e-05, tol*||rhs|| = 2.392e-05

Anderson update took 67.288 ms, out of which F'*F took 32.042 ms; b-Ax took 218.052 ms, out of which Lap took 193.866 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.105 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958312, int_b + int_rho = -2.401e-13, checking this took 0.131 ms
2-norm of RHS = 653.7897373252981, which took 0.126 ms

iter_count = 240, r_2norm = 5.730e-04, tol*||rhs|| = 6.538e-04

Anderson update took 141.562 ms, out of which F'*F took 67.589 ms; b-Ax took 454.273 ms, out of which Lap took 406.468 ms
Solving Poisson took 1001.567 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.111702 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.110881 
Total time for convolution: 	 convolve: 5.116979 
Total time for convolution: 	 convolve: 5.111024 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.171 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 1.655 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.852 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.563 ms

This SCF took 28148.927 ms, scf error = 3.447e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.135440, lowerbound = -1.040219, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1991.543 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.661 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.309 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 24.998 ms
rank =  0, finding HY took 32.617 ms
rank =  0, distributing HY into block cyclic form took 20.634 ms
rank =  0, finding Y'*HY took 5.849 ms
Rank 0, Project_Hamiltonian used 84.132 ms
Total time for projection: 84.147 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -1.038168265086126
    last  calculated eigval = 0.034905057290555
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.63170439196720
lambda[   5] =  -0.52216912968450
lambda[   6] =  -0.47899809111784
lambda[   7] =  -0.44289461076483
lambda[   8] =  -0.42237751247197
lambda[   9] =  -0.37357235979140
lambda[  10] =  -0.30077105346976
lambda[  11] =  -0.28617126973645
lambda[  12] =  -0.27955165924996
lambda[  13] =  -0.25140217466228
lambda[  14] =  -0.09192312011689
lambda[  15] =  -0.03421483905466
lambda[  16] =  -0.02427625193464
lambda[  17] =  -0.00054923208675
lambda[  18] =   0.01319691456429
lambda[  19] =   0.03101543788026
lambda[  20] =   0.03490505729055
==subpsace eigenproblem: bcast eigvals took 0.056 ms
Total time for solving subspace eigenvalue problem: 0.247 ms
rank =  0, subspace rotation using ScaLAPACK took 7.438 ms
rank =  0, Distributing orbital back into band + domain format took 20.912 ms
rank = 0, Subspace_Rotation used 28.366 ms

Total time for subspace rotation: 28.370 ms
rank = 0, Efermi =  -0.121108403605 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.402 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.793 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.382 ms
rank = 0, Calculating density took 2114.019 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.992 ms
rank = 0, D2D took 1.137 ms
rank = 0, Transfering density took 1.140 ms
Etot    =   -52.257670163825
Eband   =   -13.396581899028
E1      =    28.564933792005
E2      =   -12.874701849797
E3      =   -17.052227503618
Exc     =   -15.364114652185
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 2.593e-05, dEband = 7.866e-03
rank = 0, Calculating/Estimating energy took 1.177 ms, Etot = -52.257670164, dEtot = 2.593e-05, dEband = 7.866e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2832650197062, which took 0.062 ms

iter_count = 114, r_2norm = 7.801e-06, tol*||rhs|| = 1.133e-05

Anderson update took 67.095 ms, out of which F'*F took 31.624 ms; b-Ax took 215.481 ms, out of which Lap took 191.571 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.627 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958305, int_b + int_rho = -3.092e-13, checking this took 0.864 ms
2-norm of RHS = 653.8929012406830, which took 0.135 ms

iter_count = 246, r_2norm = 5.388e-04, tol*||rhs|| = 6.539e-04

Anderson update took 144.542 ms, out of which F'*F took 69.813 ms; b-Ax took 469.763 ms, out of which Lap took 421.092 ms
Solving Poisson took 1025.263 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.115148 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.116074 
Total time for convolution: 	 convolve: 5.366105 
Total time for convolution: 	 convolve: 5.114429 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.623 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
---Transfer Veff_loc: D2D took 1.642 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.923 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.602 ms

This SCF took 28371.616 ms, scf error = 2.105e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.134905, lowerbound = -1.038168, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1974.567 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 23.334 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.553 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 27.920 ms
rank =  0, finding HY took 32.493 ms
rank =  0, distributing HY into block cyclic form took 20.636 ms
rank =  0, finding Y'*HY took 6.247 ms
Rank 0, Project_Hamiltonian used 87.329 ms
Total time for projection: 87.343 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -1.036162194195797
    last  calculated eigval = 0.035520767788470
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62921508233423
lambda[   5] =  -0.52000567436988
lambda[   6] =  -0.47648460606773
lambda[   7] =  -0.44040579537336
lambda[   8] =  -0.42018857715893
lambda[   9] =  -0.37131127359325
lambda[  10] =  -0.29867563673029
lambda[  11] =  -0.28299820118136
lambda[  12] =  -0.27640611606464
lambda[  13] =  -0.24860877715414
lambda[  14] =  -0.08939382860217
lambda[  15] =  -0.03350933402709
lambda[  16] =  -0.02166873292118
lambda[  17] =   0.00032141110415
lambda[  18] =   0.01383097079534
lambda[  19] =   0.03093204313662
lambda[  20] =   0.03552076778847
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.212 ms
rank =  0, subspace rotation using ScaLAPACK took 7.500 ms
rank =  0, Distributing orbital back into band + domain format took 20.868 ms
rank = 0, Subspace_Rotation used 28.383 ms

Total time for subspace rotation: 28.389 ms
rank = 0, Efermi =  -0.118579111965 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.742 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.113 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.322 ms
rank = 0, Calculating density took 2100.817 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.993 ms
rank = 0, D2D took 1.118 ms
rank = 0, Transfering density took 1.122 ms
Etot    =   -52.257623046141
Eband   =   -13.330727505500
E1      =    28.534795751322
E2      =   -12.836960032943
E3      =   -17.058888604565
Exc     =   -15.368703171440
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 6.731e-06, dEband = 9.408e-03
rank = 0, Calculating/Estimating energy took 0.974 ms, Etot = -52.257623046, dEtot = 6.731e-06, dEband = 9.408e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2601097323321, which took 0.063 ms

iter_count = 108, r_2norm = 8.301e-06, tol*||rhs|| = 1.040e-05

Anderson update took 63.491 ms, out of which F'*F took 40.056 ms; b-Ax took 215.887 ms, out of which Lap took 193.322 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.157 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958320, int_b + int_rho = -1.601e-13, checking this took 0.133 ms
2-norm of RHS = 653.8545630360977, which took 0.166 ms

iter_count = 228, r_2norm = 5.353e-04, tol*||rhs|| = 6.539e-04

Anderson update took 135.086 ms, out of which F'*F took 72.317 ms; b-Ax took 440.638 ms, out of which Lap took 395.830 ms
Solving Poisson took 952.919 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.112164 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.113360 
Total time for convolution: 	 convolve: 5.120346 
Total time for convolution: 	 convolve: 5.115013 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.704 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.939 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.683 ms

This SCF took 28013.332 ms, scf error = 1.091e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.135521, lowerbound = -1.036162, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1976.257 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.686 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.447 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.163 ms
rank =  0, finding HY took 32.525 ms
rank =  0, distributing HY into block cyclic form took 20.592 ms
rank =  0, finding Y'*HY took 5.847 ms
Rank 0, Project_Hamiltonian used 84.165 ms
Total time for projection: 84.179 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -1.034634783155125
    last  calculated eigval = 0.036167975554275
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62745386812558
lambda[   5] =  -0.51845091322476
lambda[   6] =  -0.47472033131354
lambda[   7] =  -0.43877323254650
lambda[   8] =  -0.41855544206893
lambda[   9] =  -0.36976653508012
lambda[  10] =  -0.29724517665029
lambda[  11] =  -0.28109207241405
lambda[  12] =  -0.27450973262970
lambda[  13] =  -0.24684924656915
lambda[  14] =  -0.08762864153923
lambda[  15] =  -0.03210043222861
lambda[  16] =  -0.01986017958469
lambda[  17] =   0.00231663175549
lambda[  18] =   0.01535147906316
lambda[  19] =   0.03155403648301
lambda[  20] =   0.03616797555427
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 7.458 ms
rank =  0, Distributing orbital back into band + domain format took 20.952 ms
rank = 0, Subspace_Rotation used 28.434 ms

Total time for subspace rotation: 28.440 ms
rank = 0, Efermi =  -0.116813924940 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 5.396 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.920 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.329 ms
rank = 0, Calculating density took 2098.939 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.990 ms
rank = 0, D2D took 1.161 ms
rank = 0, Transfering density took 1.171 ms
Etot    =   -52.257689199978
Eband   =   -13.286358810090
E1      =    28.510777216007
E2      =   -12.815614607300
E3      =   -17.063078548520
Exc     =   -15.371964003683
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 9.451e-06, dEband = 6.338e-03
rank = 0, Calculating/Estimating energy took 1.606 ms, Etot = -52.257689200, dEtot = 9.451e-06, dEband = 6.338e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1485282246810, which took 0.050 ms

iter_count = 108, r_2norm = 5.638e-06, tol*||rhs|| = 5.941e-06

Anderson update took 63.375 ms, out of which F'*F took 30.101 ms; b-Ax took 204.666 ms, out of which Lap took 182.006 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.846 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958303, int_b + int_rho = -3.347e-13, checking this took 0.131 ms
2-norm of RHS = 653.8485289614679, which took 0.077 ms

iter_count = 204, r_2norm = 5.327e-04, tol*||rhs|| = 6.538e-04

Anderson update took 122.414 ms, out of which F'*F took 57.014 ms; b-Ax took 388.141 ms, out of which Lap took 347.704 ms
Solving Poisson took 852.608 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.111283 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.119212 
Total time for convolution: 	 convolve: 5.118006 
Total time for convolution: 	 convolve: 5.114170 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 1.716 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.925 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.680 ms

This SCF took 27901.784 ms, scf error = 6.972e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.136168, lowerbound = -1.034635, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2014.310 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.696 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.422 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.146 ms
rank =  0, finding HY took 32.547 ms
rank =  0, distributing HY into block cyclic form took 20.812 ms
rank =  0, finding Y'*HY took 5.729 ms
Rank 0, Project_Hamiltonian used 84.263 ms
Total time for projection: 84.277 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -1.033969794791162
    last  calculated eigval = 0.036110927879397
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62691578331598
lambda[   5] =  -0.51787905361120
lambda[   6] =  -0.47423894451182
lambda[   7] =  -0.43811885429792
lambda[   8] =  -0.41789593630290
lambda[   9] =  -0.36914645991367
lambda[  10] =  -0.29659031202720
lambda[  11] =  -0.28054774337327
lambda[  12] =  -0.27398862179357
lambda[  13] =  -0.24622307028603
lambda[  14] =  -0.08700604365874
lambda[  15] =  -0.03078589151535
lambda[  16] =  -0.01921192887895
lambda[  17] =   0.00386416405846
lambda[  18] =   0.01675346150836
lambda[  19] =   0.03183215099517
lambda[  20] =   0.03611092787940
==subpsace eigenproblem: bcast eigvals took 0.057 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 7.487 ms
rank =  0, Distributing orbital back into band + domain format took 20.898 ms
rank = 0, Subspace_Rotation used 28.401 ms

Total time for subspace rotation: 28.406 ms
rank = 0, Efermi =  -0.116191327061 calculate fermi energy took 0.098 ms
rank = 0, --- Calculate rho: sum over local bands took 5.499 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.751 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.358 ms
rank = 0, Calculating density took 2137.151 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.992 ms
rank = 0, D2D took 1.136 ms
rank = 0, Transfering density took 1.140 ms
Etot    =   -52.257740964104
Eband   =   -13.271011364781
E1      =    28.503812174383
E2      =   -12.807051373045
E3      =   -17.063630439800
Exc     =   -15.372386828518
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 7.395e-06, dEband = 2.192e-03
rank = 0, Calculating/Estimating energy took 1.053 ms, Etot = -52.257740964, dEtot = 7.395e-06, dEband = 2.192e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0691569571138, which took 0.058 ms

iter_count = 114, r_2norm = 2.279e-06, tol*||rhs|| = 2.766e-06

Anderson update took 67.413 ms, out of which F'*F took 31.933 ms; b-Ax took 217.567 ms, out of which Lap took 193.191 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.584 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958319, int_b + int_rho = -1.710e-13, checking this took 0.146 ms
2-norm of RHS = 653.8595085644357, which took 0.137 ms

iter_count = 204, r_2norm = 5.266e-04, tol*||rhs|| = 6.539e-04

Anderson update took 120.221 ms, out of which F'*F took 57.396 ms; b-Ax took 387.951 ms, out of which Lap took 347.144 ms
Solving Poisson took 848.514 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.117077 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.142755 
Total time for convolution: 	 convolve: 5.123329 
Total time for convolution: 	 convolve: 5.147588 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 1.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.931 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.652 ms

This SCF took 28020.130 ms, scf error = 4.813e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.136111, lowerbound = -1.033970, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1977.912 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.730 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.473 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.235 ms
rank =  0, finding HY took 32.552 ms
rank =  0, distributing HY into block cyclic form took 20.505 ms
rank =  0, finding Y'*HY took 5.950 ms
Rank 0, Project_Hamiltonian used 84.274 ms
Total time for projection: 84.289 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -1.033154794438358
    last  calculated eigval = 0.036587176937024
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62602505666466
lambda[   5] =  -0.51702841286967
lambda[   6] =  -0.47333712779983
lambda[   7] =  -0.43732848207068
lambda[   8] =  -0.41705672144439
lambda[   9] =  -0.36836443135911
lambda[  10] =  -0.29578921720419
lambda[  11] =  -0.27961234544306
lambda[  12] =  -0.27304737821355
lambda[  13] =  -0.24536649579701
lambda[  14] =  -0.08611931084311
lambda[  15] =  -0.02818858914334
lambda[  16] =  -0.01812033941792
lambda[  17] =   0.00653991276010
lambda[  18] =   0.01997862189462
lambda[  19] =   0.03288436027996
lambda[  20] =   0.03658717693702
==subpsace eigenproblem: bcast eigvals took 0.059 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 7.406 ms
rank =  0, Distributing orbital back into band + domain format took 20.930 ms
rank = 0, Subspace_Rotation used 28.358 ms

Total time for subspace rotation: 28.364 ms
rank = 0, Efermi =  -0.115304594253 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 5.389 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.713 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.484 ms
rank = 0, Calculating density took 2100.561 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.988 ms
rank = 0, D2D took 1.165 ms
rank = 0, Transfering density took 1.173 ms
Etot    =   -52.257813772980
Eband   =   -13.248589555154
E1      =    28.492664470480
E2      =   -12.795411936381
E3      =   -17.065141500709
Exc     =   -15.373605367365
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 1.040e-05, dEband = 3.203e-03
rank = 0, Calculating/Estimating energy took 1.109 ms, Etot = -52.257813773, dEtot = 1.040e-05, dEband = 3.203e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0596083291250, which took 0.061 ms

iter_count = 114, r_2norm = 1.542e-06, tol*||rhs|| = 2.384e-06

Anderson update took 66.972 ms, out of which F'*F took 31.706 ms; b-Ax took 219.689 ms, out of which Lap took 194.714 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.185 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958317, int_b + int_rho = -1.965e-13, checking this took 0.125 ms
2-norm of RHS = 653.8678578022746, which took 0.165 ms

iter_count = 174, r_2norm = 6.363e-04, tol*||rhs|| = 6.539e-04

Anderson update took 147.539 ms, out of which F'*F took 71.005 ms; b-Ax took 352.620 ms, out of which Lap took 318.678 ms
Solving Poisson took 789.595 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.114767 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.383 ms
Total time for convolution: 	 convolve: 5.116285 
Total time for convolution: 	 convolve: 5.093926 
Total time for convolution: 	 convolve: 5.089787 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.582 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.012 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.687 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.918 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.644 ms

This SCF took 27793.044 ms, scf error = 2.873e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.136587, lowerbound = -1.033155, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2014.004 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.572 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.573 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 25.172 ms
rank =  0, finding HY took 32.443 ms
rank =  0, distributing HY into block cyclic form took 20.403 ms
rank =  0, finding Y'*HY took 6.059 ms
Rank 0, Project_Hamiltonian used 84.109 ms
Total time for projection: 84.126 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -1.032775659837102
    last  calculated eigval = 0.036700768065119
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62561766585776
lambda[   5] =  -0.51663096664082
lambda[   6] =  -0.47291907447284
lambda[   7] =  -0.43696047656119
lambda[   8] =  -0.41666743269528
lambda[   9] =  -0.36799973781329
lambda[  10] =  -0.29540827151894
lambda[  11] =  -0.27918455496446
lambda[  12] =  -0.27261340163152
lambda[  13] =  -0.24496887709555
lambda[  14] =  -0.08570847519109
lambda[  15] =  -0.02639252993034
lambda[  16] =  -0.01752184874957
lambda[  17] =   0.00833051118713
lambda[  18] =   0.02235861793152
lambda[  19] =   0.03333512116394
lambda[  20] =   0.03670076806512
==subpsace eigenproblem: bcast eigvals took 0.053 ms
Total time for solving subspace eigenvalue problem: 0.232 ms
rank =  0, subspace rotation using ScaLAPACK took 7.400 ms
rank =  0, Distributing orbital back into band + domain format took 20.904 ms
rank = 0, Subspace_Rotation used 28.321 ms

Total time for subspace rotation: 28.327 ms
rank = 0, Efermi =  -0.114893758631 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 5.489 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.755 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.363 ms
rank = 0, Calculating density took 2136.444 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.009 ms
rank = 0, D2D took 1.169 ms
rank = 0, Transfering density took 1.172 ms
Etot    =   -52.257849876146
Eband   =   -13.238225050764
E1      =    28.487656826301
E2      =   -12.789906598788
E3      =   -17.065754452987
Exc     =   -15.374105945425
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 5.158e-06, dEband = 1.481e-03
rank = 0, Calculating/Estimating energy took 1.198 ms, Etot = -52.257849876, dEtot = 5.158e-06, dEband = 1.481e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0376729998371, which took 0.061 ms

iter_count = 114, r_2norm = 1.157e-06, tol*||rhs|| = 1.507e-06

Anderson update took 67.522 ms, out of which F'*F took 32.516 ms; b-Ax took 217.338 ms, out of which Lap took 193.673 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.624 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958312, int_b + int_rho = -2.401e-13, checking this took 0.121 ms
2-norm of RHS = 653.8724873054049, which took 0.162 ms

iter_count = 162, r_2norm = 5.961e-04, tol*||rhs|| = 6.539e-04

Anderson update took 95.490 ms, out of which F'*F took 46.385 ms; b-Ax took 308.939 ms, out of which Lap took 277.323 ms
Solving Poisson took 674.004 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.083695 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.086276 
Total time for convolution: 	 convolve: 5.090621 
Total time for convolution: 	 convolve: 5.081845 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.828 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.160 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 1.718 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.973 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.730 ms

This SCF took 27635.663 ms, scf error = 2.213e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136701, lowerbound = -1.032776, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2003.218 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.583 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.480 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 25.090 ms
rank =  0, finding HY took 32.332 ms
rank =  0, distributing HY into block cyclic form took 20.709 ms
rank =  0, finding Y'*HY took 6.263 ms
Rank 0, Project_Hamiltonian used 84.430 ms
Total time for projection: 84.445 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -1.032478571357005
    last  calculated eigval = 0.036467045277838
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62531987773387
lambda[   5] =  -0.51634230395762
lambda[   6] =  -0.47262800062214
lambda[   7] =  -0.43666709897983
lambda[   8] =  -0.41636942290246
lambda[   9] =  -0.36771183456164
lambda[  10] =  -0.29511347279897
lambda[  11] =  -0.27888356388679
lambda[  12] =  -0.27230941326874
lambda[  13] =  -0.24466806196270
lambda[  14] =  -0.08541369707199
lambda[  15] =  -0.02548325080345
lambda[  16] =  -0.01706332550471
lambda[  17] =   0.00896330722799
lambda[  18] =   0.02306705719321
lambda[  19] =   0.03312388321610
lambda[  20] =   0.03646704527784
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 7.403 ms
rank =  0, Distributing orbital back into band + domain format took 21.179 ms
rank = 0, Subspace_Rotation used 28.600 ms

Total time for subspace rotation: 28.606 ms
rank = 0, Efermi =  -0.114598980559 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 5.467 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.470 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.394 ms
rank = 0, Calculating density took 2125.948 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.985 ms
rank = 0, D2D took 1.154 ms
rank = 0, Transfering density took 1.158 ms
Etot    =   -52.257908810313
Eband   =   -13.230496185239
E1      =    28.483827328510
E2      =   -12.785849002172
E3      =   -17.066246378650
Exc     =   -15.374498576374
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 8.419e-06, dEband = 1.104e-03
rank = 0, Calculating/Estimating energy took 1.204 ms, Etot = -52.257908810, dEtot = 8.419e-06, dEband = 1.104e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0345498172191, which took 0.108 ms

iter_count = 108, r_2norm = 1.154e-06, tol*||rhs|| = 1.382e-06

Anderson update took 64.082 ms, out of which F'*F took 30.286 ms; b-Ax took 204.297 ms, out of which Lap took 181.997 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.667 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958318, int_b + int_rho = -1.819e-13, checking this took 0.123 ms
2-norm of RHS = 653.8810649177765, which took 0.168 ms

iter_count = 162, r_2norm = 6.347e-04, tol*||rhs|| = 6.539e-04

Anderson update took 95.566 ms, out of which F'*F took 45.553 ms; b-Ax took 308.252 ms, out of which Lap took 276.629 ms
Solving Poisson took 675.741 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.121755 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
Total time for convolution: 	 convolve: 5.086289 
Total time for convolution: 	 convolve: 5.092541 
Total time for convolution: 	 convolve: 5.079473 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.388 ms
---Transfer Veff_loc: D2D took 1.699 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.926 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.660 ms

This SCF took 27674.823 ms, scf error = 1.554e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136467, lowerbound = -1.032479, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2000.452 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.727 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.431 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.189 ms
rank =  0, finding HY took 32.377 ms
rank =  0, distributing HY into block cyclic form took 20.240 ms
rank =  0, finding Y'*HY took 6.010 ms
Rank 0, Project_Hamiltonian used 83.871 ms
Total time for projection: 83.890 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -1.032242309204749
    last  calculated eigval = 0.037194817976431
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62507329672966
lambda[   5] =  -0.51610094767760
lambda[   6] =  -0.47238696283008
lambda[   7] =  -0.43643766777846
lambda[   8] =  -0.41612110612829
lambda[   9] =  -0.36748408081382
lambda[  10] =  -0.29487979204528
lambda[  11] =  -0.27863450951501
lambda[  12] =  -0.27205715893611
lambda[  13] =  -0.24443311223323
lambda[  14] =  -0.08516833242088
lambda[  15] =  -0.02367809820174
lambda[  16] =  -0.01621722980385
lambda[  17] =   0.00992189348797
lambda[  18] =   0.02426227689006
lambda[  19] =   0.03414047392955
lambda[  20] =   0.03719481797643
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 7.381 ms
rank =  0, Distributing orbital back into band + domain format took 20.928 ms
rank = 0, Subspace_Rotation used 28.324 ms

Total time for subspace rotation: 28.330 ms
rank = 0, Efermi =  -0.114353615722 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 5.409 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.816 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.358 ms
rank = 0, Calculating density took 2122.594 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.991 ms
rank = 0, D2D took 1.145 ms
rank = 0, Transfering density took 1.148 ms
Etot    =   -52.257950130990
Eband   =   -13.224241918751
E1      =    28.481020076087
E2      =   -12.782330412587
E3      =   -17.066419498767
Exc     =   -15.374641441648
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 5.903e-06, dEband = 8.935e-04
rank = 0, Calculating/Estimating energy took 1.227 ms, Etot = -52.257950131, dEtot = 5.903e-06, dEband = 8.935e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0314632945382, which took 0.079 ms

iter_count = 108, r_2norm = 1.000e-06, tol*||rhs|| = 1.259e-06

Anderson update took 64.261 ms, out of which F'*F took 30.636 ms; b-Ax took 205.668 ms, out of which Lap took 183.123 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.710 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958313, int_b + int_rho = -2.328e-13, checking this took 0.121 ms
2-norm of RHS = 653.8832488895912, which took 0.160 ms

iter_count = 126, r_2norm = 5.575e-04, tol*||rhs|| = 6.539e-04

Anderson update took 74.510 ms, out of which F'*F took 36.046 ms; b-Ax took 240.008 ms, out of which Lap took 215.394 ms
Solving Poisson took 525.146 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.084250 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.094479 
Total time for convolution: 	 convolve: 5.101830 
Total time for convolution: 	 convolve: 5.087501 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 1.699 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.927 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.666 ms

This SCF took 27472.045 ms, scf error = 1.151e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.137195, lowerbound = -1.032242, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2008.202 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 22.931 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.912 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 26.876 ms
rank =  0, finding HY took 32.362 ms
rank =  0, distributing HY into block cyclic form took 20.307 ms
rank =  0, finding Y'*HY took 6.136 ms
Rank 0, Project_Hamiltonian used 85.711 ms
Total time for projection: 85.730 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -1.032195105582400
    last  calculated eigval = 0.037199389575652
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62502464027872
lambda[   5] =  -0.51604916076118
lambda[   6] =  -0.47233651468585
lambda[   7] =  -0.43639021182726
lambda[   8] =  -0.41606865735851
lambda[   9] =  -0.36743713621342
lambda[  10] =  -0.29483123837084
lambda[  11] =  -0.27858578699708
lambda[  12] =  -0.27200780459694
lambda[  13] =  -0.24438708328372
lambda[  14] =  -0.08511842444849
lambda[  15] =  -0.02327797735983
lambda[  16] =  -0.01593499857691
lambda[  17] =   0.01008590298617
lambda[  18] =   0.02451765753734
lambda[  19] =   0.03478796357963
lambda[  20] =   0.03719938957565
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 7.367 ms
rank =  0, Distributing orbital back into band + domain format took 20.969 ms
rank = 0, Subspace_Rotation used 28.351 ms

Total time for subspace rotation: 28.356 ms
rank = 0, Efermi =  -0.114303707819 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.455 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.566 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.399 ms
rank = 0, Calculating density took 2132.077 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.996 ms
rank = 0, D2D took 1.169 ms
rank = 0, Transfering density took 1.178 ms
Etot    =   -52.257959103867
Eband   =   -13.222984645378
E1      =    28.480569389865
E2      =   -12.781533056920
E3      =   -17.066354220997
Exc     =   -15.374594368240
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 1.282e-06, dEband = 1.796e-04
rank = 0, Calculating/Estimating energy took 1.242 ms, Etot = -52.257959104, dEtot = 1.282e-06, dEband = 1.796e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0322266324614, which took 0.050 ms

iter_count = 108, r_2norm = 9.590e-07, tol*||rhs|| = 1.289e-06

Anderson update took 63.927 ms, out of which F'*F took 30.317 ms; b-Ax took 204.384 ms, out of which Lap took 181.982 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.430 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958313, int_b + int_rho = -2.328e-13, checking this took 0.104 ms
2-norm of RHS = 653.8818847577908, which took 0.171 ms

iter_count = 102, r_2norm = 6.393e-04, tol*||rhs|| = 6.539e-04

Anderson update took 60.045 ms, out of which F'*F took 28.708 ms; b-Ax took 193.861 ms, out of which Lap took 173.832 ms
Solving Poisson took 426.169 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.083966 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.091474 
Total time for convolution: 	 convolve: 5.090663 
Total time for convolution: 	 convolve: 5.084002 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.217 ms
---Transfer Veff_loc: D2D took 1.688 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.913 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.666 ms

This SCF took 27366.618 ms, scf error = 1.192e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.137199, lowerbound = -1.032195, upperbound = 267.579256

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2004.281 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.427 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.662 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.121 ms
rank =  0, finding HY took 32.337 ms
rank =  0, distributing HY into block cyclic form took 20.358 ms
rank =  0, finding Y'*HY took 6.032 ms
Rank 0, Project_Hamiltonian used 83.880 ms
Total time for projection: 83.898 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -1.032138116000431
    last  calculated eigval = 0.036570569250808
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62497506379697
lambda[   5] =  -0.51599944239384
lambda[   6] =  -0.47228965515625
lambda[   7] =  -0.43633453131173
lambda[   8] =  -0.41601623209018
lambda[   9] =  -0.36738204655223
lambda[  10] =  -0.29477675985394
lambda[  11] =  -0.27854024022470
lambda[  12] =  -0.27196389297161
lambda[  13] =  -0.24433488143012
lambda[  14] =  -0.08507791936557
lambda[  15] =  -0.02347476204302
lambda[  16] =  -0.01599014288535
lambda[  17] =   0.00979712087447
lambda[  18] =   0.02410408467310
lambda[  19] =   0.03498253161953
lambda[  20] =   0.03657056925081
==subpsace eigenproblem: bcast eigvals took 0.081 ms
Total time for solving subspace eigenvalue problem: 0.267 ms
rank =  0, subspace rotation using ScaLAPACK took 7.405 ms
rank =  0, Distributing orbital back into band + domain format took 20.943 ms
rank = 0, Subspace_Rotation used 28.366 ms

Total time for subspace rotation: 28.372 ms
rank = 0, Efermi =  -0.114263202764 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 5.401 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.687 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.427 ms
rank = 0, Calculating density took 2126.461 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.086 ms
rank = 0, D2D took 1.257 ms
rank = 0, Transfering density took 1.261 ms
Etot    =   -52.257966974258
Eband   =   -13.221647462818
E1      =    28.479829451592
E2      =   -12.780904883962
E3      =   -17.066471362130
Exc     =   -15.374688451090
Esc     =   -81.988836757444
Entropy =    -0.000000000589
dE = 1.124e-06, dEband = 1.910e-04
rank = 0, Calculating/Estimating energy took 1.248 ms, Etot = -52.257966974, dEtot = 1.124e-06, dEband = 1.910e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0263486166681, which took 0.165 ms

iter_count = 108, r_2norm = 8.598e-07, tol*||rhs|| = 1.054e-06

Anderson update took 64.206 ms, out of which F'*F took 30.536 ms; b-Ax took 205.857 ms, out of which Lap took 183.009 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.586 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000001958336, int_rho =  26.00000001958313, int_b + int_rho = -2.328e-13, checking this took 0.122 ms
2-norm of RHS = 653.8811149206762, which took 0.779 ms

iter_count = 108, r_2norm = 5.968e-04, tol*||rhs|| = 6.539e-04

Anderson update took 63.771 ms, out of which F'*F took 30.786 ms; b-Ax took 205.541 ms, out of which Lap took 184.432 ms
Solving Poisson took 450.859 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.087980 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.101664 
Total time for convolution: 	 convolve: 5.125567 
Total time for convolution: 	 convolve: 5.081438 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 1.493 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.535 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.052 ms

This SCF took 27650.677 ms, scf error = 9.885e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.62497506379697, occ[   4] =   2.00000000000000
lambda[   5] =  -0.51599944239384, occ[   5] =   2.00000000000000
lambda[   6] =  -0.47228965515625, occ[   6] =   2.00000000000000
lambda[   7] =  -0.43633453131173, occ[   7] =   2.00000000000000
lambda[   8] =  -0.41601623209018, occ[   8] =   2.00000000000000
lambda[   9] =  -0.36738204655223, occ[   9] =   2.00000000000000
lambda[  10] =  -0.29477675985394, occ[  10] =   2.00000000000000
lambda[  11] =  -0.27854024022470, occ[  11] =   2.00000000000000
lambda[  12] =  -0.27196389297161, occ[  12] =   2.00000000000000
lambda[  13] =  -0.24433488143012, occ[  13] =   2.00000000000000
lambda[  14] =  -0.08507791936557, occ[  14] =   0.00000001958313
lambda[  15] =  -0.02347476204302, occ[  15] =   0.00000000000000
lambda[  16] =  -0.01599014288535, occ[  16] =   0.00000000000000
lambda[  17] =   0.00979712087447, occ[  17] =   0.00000000000000
lambda[  18] =   0.02410408467310, occ[  18] =   0.00000000000000
lambda[  19] =   0.03498253161953, occ[  19] =   0.00000000000000
lambda[  20] =   0.03657056925081, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.607 ms, time for Allreduce/Reduce: 11.677 ms 
Time for calculating local force components: 22.748 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.83088000339369   0.68672166127013   0.00000030336348
  0.92637883751539  -0.81424447452876   0.00000010334910
  0.01089281965902   0.05465225260100  -0.00000000314023
 -0.00610365437473  -0.07365006357397   0.00000000754449
  0.09028724044950   0.02194859611606  -0.00000004328394
 -0.00183161502601   0.04621339412573   0.00000001204018
  0.00198993250465   0.01535568370806   0.00000025272600
force_loc = 
  0.81603873320633  -0.66732990745076  -0.00000067998887
 -0.91265160456501   0.80386253991973  -0.00000128807641
 -0.01186114167874  -0.05774040483596   0.00000013351430
  0.00798438035807   0.07791365804389   0.00000000499061
 -0.08121319424280  -0.04326855168646  -0.00000008518722
  0.00521321902703  -0.03140003504171   0.00000031465839
 -0.00361625667275  -0.02148189769177  -0.00000139314299
Time for calculating nonlocal force components: 49.074 ms
[32mforces_xc: 
[0m[32m  0.02258158350207  -0.02017400414492   0.00000001779799
[0m[32m -0.02228431504444   0.01880422881557  -0.00000008286251
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.01117182303723   0.00544583502988   0.00000000663659
[0m[32m -0.00228977752667  -0.01329113288807   0.00000001029087
[0m[32m  0.00233517691719   0.01138488371240  -0.00000005223667
[0mTime for calculating XC forces components: 29.885 ms
 Cartesian force = 
  0.00776909366083  -0.00074257339698  -0.00000000725499
 -0.00852830174794   0.00846197113511  -0.00000091601742
 -0.00093954167360  -0.00304847530640   0.00000048194647
  0.00190950632946   0.00430327139848   0.00000036410751
 -0.00206899648442  -0.01583444361197   0.00000022973784
  0.00112060682047   0.00156190312451   0.00000068856186
  0.00073763309520   0.00529834665725  -0.00000084108126
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.369 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.374 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Time for printing density: 389.060 ms
The program took 482.940 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:36:37
Job ID:        2266944
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:38:36,vmem=8320K,walltime=00:08:13,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-3-2
---------------------------------------
