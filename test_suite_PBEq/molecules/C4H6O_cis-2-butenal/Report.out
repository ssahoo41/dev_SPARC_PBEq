---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:34
Job ID:    2266743
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:39
Job ID:    2266743
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.061 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.021 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 32.724 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 11.
[32m
Time for finding element is 0.009 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 32.337 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 114.037 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.972 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.100 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    5.499042	    8.733708	   10.000000	
    5.585113	   12.545865	   10.000000	
   10.172737	   12.889010	   10.000000	
   10.027719	    7.110990	   10.000000	
   14.495459	   10.939629	   10.000000	
   14.500958	    8.016209	   11.657350	
   14.500958	    8.016209	    8.342650	
    6.632921	   10.722573	   10.000000	
    9.412166	   10.979443	   10.000000	
   10.933745	    8.959218	   10.000000	
   13.752339	    9.012469	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.184 ms
Set up communicators.

--set up spincomm took 2.301 ms

--set up kptcomm took 0.359 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 21, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 21 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 21, mbQ = nbQ = 64
rank = 0, nr_Hp = 21, nc_Hp = 21
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.058 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.377 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.507 ms

Calculate_SplineDerivRadFun took 0.231 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.799 ms.
time spent on vectorized spline interp: 3.147 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.712 ms.
time spent on vectorized spline interp: 1.351 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.306 ms.
time spent on vectorized spline interp: 1.652 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.504 ms.

Calculating rb for all atom types took 15.480 ms
----------------------
Estimated memory usage
Total: 1.26 GB
orbitals             : 961.30 MB
global sized vectors : 213.62 MB
subspace matrices : 10.34 kB
others : 117.49 MB
----------------------------------------------
Estimated memory usage per processor: 107.70 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.055 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -28.0000000283143, sum_int_rho = 27.3901524216739
PosCharge = 28.000000028314, NegCharge = -27.390152421674, scal_fac = 1.022265214054
After scaling, int_rho = 28.0000000283142, PosCharge + NegCharge - NetCharge = 4.263e-14
--Calculate Vref took 0.628 ms
--Calculate rho_guess took 3.358 ms

 integral of b = -28.0000000283143,
 int{b} + Nelectron + NetCharge = -2.831e-08,
 Esc = -74.1399432078371,
 MPI_Reduce took 10.895 ms

Calculating b & b_ref took 22.578 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.076 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.084 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.089 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.678 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.428 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831425, int_b + int_rho = 6.185e-14, checking this took 0.598 ms
2-norm of RHS = 786.8105468975237, which took 0.522 ms

iter_count = 420, r_2norm = 6.884e-04, tol*||rhs|| = 7.868e-04

Anderson update took 233.722 ms, out of which F'*F took 107.659 ms; b-Ax took 732.263 ms, out of which Lap took 658.549 ms
Solving Poisson took 1545.053 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.418 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.813 ms
Total time for convolution: 	 convolve: 5.158267 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
Total time for convolution: 	 convolve: 5.145344 
Total time for convolution: 	 convolve: 5.129566 
Total time for convolution: 	 convolve: 5.168785 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.868 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.453 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
rank = 0, XC calculation took 24505.808 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
---Transfer Veff_loc: D2D took 4.955 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.043 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.126 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.145 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.755 ms
    Lanczos iter 52, eigmin  = -0.959987360, eigmax = 264.922073073, err_eigmin = 2.727e-03, err_eigmax = 9.780e-03
rank =   0, Lanczos took 127.963 ms, eigmin = -0.959987360003, eigmax = 267.571293803998

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.255653, lowerbound = -1.059987, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1472.100 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 54.085 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.772 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 56.874 ms
rank =  0, finding HY took 25.875 ms
rank =  0, distributing HY into block cyclic form took 20.091 ms
rank =  0, finding Y'*HY took 5.093 ms
Rank 0, Project_Hamiltonian used 107.987 ms
Total time for projection: 108.003 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.768 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.864 ms
    first calculated eigval = 2.726883809387004
    last  calculated eigval = 3.275451685822085
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =   2.84393372953069
lambda[   6] =   2.86409980259509
lambda[   7] =   2.88832344841205
lambda[   8] =   2.93887951193225
lambda[   9] =   2.96419600567620
lambda[  10] =   2.97323707911544
lambda[  11] =   2.99128257765539
lambda[  12] =   2.99815689964790
lambda[  13] =   3.03037068454050
lambda[  14] =   3.03329962898006
lambda[  15] =   3.09598196362087
lambda[  16] =   3.10687288289517
lambda[  17] =   3.14052699392477
lambda[  18] =   3.14653753241112
lambda[  19] =   3.17038409813649
lambda[  20] =   3.22549322873475
lambda[  21] =   3.27545168582209
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.878 ms
rank =  0, subspace rotation using ScaLAPACK took 8.270 ms
rank =  0, Distributing orbital back into band + domain format took 18.364 ms
rank = 0, Subspace_Rotation used 26.645 ms

Total time for subspace rotation: 26.649 ms
rank = 0, Efermi =   3.067132227431 calculate fermi energy took 0.047 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.375452, lowerbound = -1.059987, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1507.562 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.011 ms
rank =  0, Distribute orbital to block cyclic format took 18.365 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.608 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.988 ms
rank =  0, finding HY took 25.120 ms
rank =  0, distributing HY into block cyclic form took 18.367 ms
rank =  0, finding Y'*HY took 4.058 ms
Rank 0, Project_Hamiltonian used 68.563 ms
Total time for projection: 68.567 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.226 ms
    first calculated eigval = -0.745339147086110
    last  calculated eigval = 0.445654486190306
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.26478687405075
lambda[   6] =  -0.14936843022756
lambda[   7] =  -0.09813442060838
lambda[   8] =  -0.06428055948726
lambda[   9] =  -0.01432054928357
lambda[  10] =   0.04342763647693
lambda[  11] =   0.09932874213975
lambda[  12] =   0.17922724513674
lambda[  13] =   0.21763642202742
lambda[  14] =   0.25519861879374
lambda[  15] =   0.29011480185192
lambda[  16] =   0.30821347862578
lambda[  17] =   0.34270556187043
lambda[  18] =   0.35469732259931
lambda[  19] =   0.37693318419006
lambda[  20] =   0.39970393098147
lambda[  21] =   0.44565448619031
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 8.189 ms
rank =  0, Distributing orbital back into band + domain format took 18.147 ms
rank = 0, Subspace_Rotation used 26.348 ms

Total time for subspace rotation: 26.352 ms
rank = 0, Efermi =   0.272656736323 calculate fermi energy took 0.021 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.545654, lowerbound = -1.059987, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1503.859 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.373 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.598 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.988 ms
rank =  0, finding HY took 25.136 ms
rank =  0, distributing HY into block cyclic form took 18.388 ms
rank =  0, finding Y'*HY took 4.023 ms
Rank 0, Project_Hamiltonian used 68.560 ms
Total time for projection: 68.563 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -1.014857733353827
    last  calculated eigval = 0.157358595404488
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.57959935167297
lambda[   6] =  -0.53151938289242
lambda[   7] =  -0.50197581252887
lambda[   8] =  -0.49960361468642
lambda[   9] =  -0.45975181124460
lambda[  10] =  -0.43826981755409
lambda[  11] =  -0.40878751566258
lambda[  12] =  -0.38261310912666
lambda[  13] =  -0.31162484956802
lambda[  14] =  -0.22580715487931
lambda[  15] =  -0.02958964902399
lambda[  16] =   0.02526665205782
lambda[  17] =   0.04897357838898
lambda[  18] =   0.08689479460535
lambda[  19] =   0.10832008209496
lambda[  20] =   0.11374852894428
lambda[  21] =   0.15735859540449
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 8.182 ms
rank =  0, Distributing orbital back into band + domain format took 18.178 ms
rank = 0, Subspace_Rotation used 26.371 ms

Total time for subspace rotation: 26.376 ms
rank = 0, Efermi =  -0.058441843093 calculate fermi energy took 0.020 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.257359, lowerbound = -1.059987, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1508.004 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.350 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.582 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.947 ms
rank =  0, finding HY took 25.215 ms
rank =  0, distributing HY into block cyclic form took 18.424 ms
rank =  0, finding Y'*HY took 4.044 ms
Rank 0, Project_Hamiltonian used 68.652 ms
Total time for projection: 68.656 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -1.015277991040605
    last  calculated eigval = 0.072816190711456
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.58425264955167
lambda[   6] =  -0.53793899697502
lambda[   7] =  -0.50905983729526
lambda[   8] =  -0.50528369549651
lambda[   9] =  -0.46969153614181
lambda[  10] =  -0.45382361302947
lambda[  11] =  -0.42387870111420
lambda[  12] =  -0.39965829822633
lambda[  13] =  -0.32609048842688
lambda[  14] =  -0.27604142410423
lambda[  15] =  -0.14061284286494
lambda[  16] =  -0.01763376414347
lambda[  17] =  -0.00391297656807
lambda[  18] =   0.03079534934615
lambda[  19] =   0.05228505506192
lambda[  20] =   0.06187999206528
lambda[  21] =   0.07281619071146
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 8.204 ms
rank =  0, Distributing orbital back into band + domain format took 19.018 ms
rank = 0, Subspace_Rotation used 27.253 ms

Total time for subspace rotation: 27.257 ms
rank = 0, Efermi =  -0.169465036946 calculate fermi energy took 0.019 ms
rank = 0, --- Calculate rho: sum over local bands took 5.336 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.117 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 6562.058 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.824 ms
rank = 0, D2D took 1.924 ms
rank = 0, Transfering density took 1.930 ms
Etot    =   -44.319661611072
Eband   =   -15.592784472234
E1      =    31.582016812272
E2      =   -12.156346249657
E3      =   -15.887379557068
Exc     =   -14.212676549156
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 4.029e+00, dEband = 1.418e+00
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -44.319661611, dEtot = 4.029e+00, dEband = 1.418e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 59.1082534383040, which took 1.229 ms

iter_count = 96, r_2norm = 1.902e-03, tol*||rhs|| = 2.364e-03

Anderson update took 51.751 ms, out of which F'*F took 24.380 ms; b-Ax took 164.154 ms, out of which Lap took 147.569 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 354.126 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831426, int_b + int_rho = 7.276e-14, checking this took 0.124 ms
2-norm of RHS = 782.3127106598832, which took 0.110 ms

iter_count = 288, r_2norm = 6.813e-04, tol*||rhs|| = 7.823e-04

Anderson update took 157.124 ms, out of which F'*F took 73.792 ms; b-Ax took 496.613 ms, out of which Lap took 444.037 ms
Solving Poisson took 1060.628 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.400 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.203901 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.186924 
Total time for convolution: 	 convolve: 5.210584 
Total time for convolution: 	 convolve: 5.285163 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.578 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.948 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.557 ms

This SCF took 32827.636 ms, scf error = 1.779e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.172816, lowerbound = -1.015278, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1448.894 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 64.893 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.637 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 67.548 ms
rank =  0, finding HY took 24.903 ms
rank =  0, distributing HY into block cyclic form took 18.898 ms
rank =  0, finding Y'*HY took 4.066 ms
Rank 0, Project_Hamiltonian used 115.442 ms
Total time for projection: 115.459 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -0.995712641038916
    last  calculated eigval = 0.045021905565957
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55592339866717
lambda[   6] =  -0.50835030382100
lambda[   7] =  -0.47774050927249
lambda[   8] =  -0.46832226085057
lambda[   9] =  -0.43674204236486
lambda[  10] =  -0.42805506402754
lambda[  11] =  -0.39623487368609
lambda[  12] =  -0.38624684985754
lambda[  13] =  -0.30111271216678
lambda[  14] =  -0.25467256067108
lambda[  15] =  -0.13995249877348
lambda[  16] =  -0.02722437817589
lambda[  17] =  -0.01551325544831
lambda[  18] =   0.01200348439102
lambda[  19] =   0.02902722680997
lambda[  20] =   0.03637449944052
lambda[  21] =   0.04502190556596
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 7.796 ms
rank =  0, Distributing orbital back into band + domain format took 18.991 ms
rank = 0, Subspace_Rotation used 26.802 ms

Total time for subspace rotation: 26.806 ms
rank = 0, Efermi =  -0.168804692825 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.479 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.434 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.569 ms
rank = 0, Calculating density took 1608.304 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.829 ms
rank = 0, D2D took 1.931 ms
rank = 0, Transfering density took 1.937 ms
Etot    =   -44.248092669625
Eband   =   -14.806485689567
E1      =    30.888428990231
E2      =   -12.096908524378
E3      =   -16.093950421292
Exc     =   -14.380951707279
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 6.506e-03, dEband = 7.148e-02
rank = 0, Calculating/Estimating energy took 0.931 ms, Etot = -44.248092670, dEtot = 6.506e-03, dEband = 7.148e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 20.8847791650608, which took 0.069 ms

iter_count = 102, r_2norm = 6.323e-04, tol*||rhs|| = 8.354e-04

Anderson update took 55.538 ms, out of which F'*F took 27.767 ms; b-Ax took 176.322 ms, out of which Lap took 158.805 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 384.133 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831418, int_b + int_rho = -3.638e-15, checking this took 0.124 ms
2-norm of RHS = 776.0849810370279, which took 0.109 ms

iter_count = 306, r_2norm = 6.416e-04, tol*||rhs|| = 7.761e-04

Anderson update took 178.846 ms, out of which F'*F took 81.559 ms; b-Ax took 529.207 ms, out of which Lap took 480.895 ms
Solving Poisson took 1134.513 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.181052 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.444 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.193414 
Total time for convolution: 	 convolve: 5.197927 
Total time for convolution: 	 convolve: 5.290074 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 3.517 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.940 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.488 ms

This SCF took 28104.678 ms, scf error = 1.226e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.145022, lowerbound = -0.995713, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1470.778 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 31.880 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.979 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 34.872 ms
rank =  0, finding HY took 25.563 ms
rank =  0, distributing HY into block cyclic form took 18.516 ms
rank =  0, finding Y'*HY took 4.206 ms
Rank 0, Project_Hamiltonian used 83.187 ms
Total time for projection: 83.203 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.080 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -0.966072023503241
    last  calculated eigval = 0.039029754174311
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50441567369633
lambda[   6] =  -0.46037676290530
lambda[   7] =  -0.42245126859199
lambda[   8] =  -0.40597862149759
lambda[   9] =  -0.38450170302464
lambda[  10] =  -0.37387023000325
lambda[  11] =  -0.36439245327262
lambda[  12] =  -0.34386375191232
lambda[  13] =  -0.25834623398407
lambda[  14] =  -0.22091557060428
lambda[  15] =  -0.11052081114911
lambda[  16] =  -0.02804140637149
lambda[  17] =   0.00798627185393
lambda[  18] =   0.00872201986681
lambda[  19] =   0.02264742968802
lambda[  20] =   0.02299676846142
lambda[  21] =   0.03902975417431
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 7.791 ms
rank =  0, Distributing orbital back into band + domain format took 18.891 ms
rank = 0, Subspace_Rotation used 26.699 ms

Total time for subspace rotation: 26.703 ms
rank = 0, Efermi =  -0.139373005202 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.255 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.786 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.564 ms
rank = 0, Calculating density took 1597.642 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.816 ms
rank = 0, D2D took 1.917 ms
rank = 0, Transfering density took 1.923 ms
Etot    =   -44.187481211801
Eband   =   -13.440462930319
E1      =    29.723692532067
E2      =   -11.878109812413
E3      =   -16.508439205744
Exc     =   -14.717316623027
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 5.510e-03, dEband = 1.242e-01
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -44.187481212, dEtot = 5.510e-03, dEband = 1.242e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.1422227135789, which took 0.085 ms

iter_count = 102, r_2norm = 2.563e-04, tol*||rhs|| = 2.857e-04

Anderson update took 58.205 ms, out of which F'*F took 26.094 ms; b-Ax took 173.949 ms, out of which Lap took 157.120 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 389.190 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831426, int_b + int_rho = 7.640e-14, checking this took 0.101 ms
2-norm of RHS = 775.9318778945035, which took 0.112 ms

iter_count = 270, r_2norm = 6.768e-04, tol*||rhs|| = 7.759e-04

Anderson update took 158.825 ms, out of which F'*F took 72.286 ms; b-Ax took 466.301 ms, out of which Lap took 427.406 ms
Solving Poisson took 1000.294 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.232060 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.171896 
Total time for convolution: 	 convolve: 5.180876 
Total time for convolution: 	 convolve: 5.182723 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.348 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.503 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.917 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.448 ms

This SCF took 27751.832 ms, scf error = 3.861e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.139030, lowerbound = -0.966072, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1450.754 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 59.602 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.648 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 62.270 ms
rank =  0, finding HY took 24.797 ms
rank =  0, distributing HY into block cyclic form took 18.392 ms
rank =  0, finding Y'*HY took 4.041 ms
Rank 0, Project_Hamiltonian used 109.547 ms
Total time for projection: 109.561 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.954 ms
rank = 0, Solve_Generalized_EigenProblem used 1.086 ms
    first calculated eigval = -0.959058536368821
    last  calculated eigval = 0.034346900036654
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49233070901942
lambda[   6] =  -0.44894486821985
lambda[   7] =  -0.41172354500436
lambda[   8] =  -0.39386023584277
lambda[   9] =  -0.37462427645111
lambda[  10] =  -0.36167322094099
lambda[  11] =  -0.35840837523584
lambda[  12] =  -0.33142804758245
lambda[  13] =  -0.25068942442811
lambda[  14] =  -0.21408365685409
lambda[  15] =  -0.10337607096748
lambda[  16] =  -0.02878387706370
lambda[  17] =   0.00525495639183
lambda[  18] =   0.01432888280172
lambda[  19] =   0.01787062984881
lambda[  20] =   0.02141572865020
lambda[  21] =   0.03434690003665
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 1.106 ms
rank =  0, subspace rotation using ScaLAPACK took 7.825 ms
rank =  0, Distributing orbital back into band + domain format took 18.454 ms
rank = 0, Subspace_Rotation used 26.292 ms

Total time for subspace rotation: 26.297 ms
rank = 0, Efermi =  -0.132228264994 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.295 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.574 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.633 ms
rank = 0, Calculating density took 1605.351 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.013 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.007 ms
rank = 0, D2D took 2.113 ms
rank = 0, Transfering density took 2.119 ms
Etot    =   -44.182320216266
Eband   =   -13.152246171132
E1      =    29.528251964563
E2      =   -11.767927702641
E3      =   -16.608421309740
Exc     =   -14.794731813399
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 4.692e-04, dEband = 2.620e-02
rank = 0, Calculating/Estimating energy took 0.899 ms, Etot = -44.182320216, dEtot = 4.692e-04, dEband = 2.620e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.2061714436489, which took 0.074 ms

iter_count = 108, r_2norm = 8.266e-05, tol*||rhs|| = 8.825e-05

Anderson update took 58.801 ms, out of which F'*F took 27.596 ms; b-Ax took 185.322 ms, out of which Lap took 166.431 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 404.840 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831427, int_b + int_rho = 8.367e-14, checking this took 0.127 ms
2-norm of RHS = 776.4251268138277, which took 0.111 ms

iter_count = 258, r_2norm = 6.279e-04, tol*||rhs|| = 7.764e-04

Anderson update took 147.719 ms, out of which F'*F took 67.353 ms; b-Ax took 440.924 ms, out of which Lap took 401.608 ms
Solving Poisson took 949.944 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.346141 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.206550 
Total time for convolution: 	 convolve: 5.223181 
Total time for convolution: 	 convolve: 5.198314 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
---Transfer Veff_loc: D2D took 3.528 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.485 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.048 ms

This SCF took 28057.354 ms, scf error = 1.643e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.134347, lowerbound = -0.959059, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1444.228 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 60.599 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.694 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 63.310 ms
rank =  0, finding HY took 24.751 ms
rank =  0, distributing HY into block cyclic form took 18.469 ms
rank =  0, finding Y'*HY took 4.092 ms
Rank 0, Project_Hamiltonian used 110.670 ms
Total time for projection: 110.686 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.214 ms
    first calculated eigval = -0.953128093897299
    last  calculated eigval = 0.030311765736695
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48654525307891
lambda[   6] =  -0.44334223665225
lambda[   7] =  -0.40589983402978
lambda[   8] =  -0.38801564631937
lambda[   9] =  -0.36877482279095
lambda[  10] =  -0.35605400199327
lambda[  11] =  -0.35357422763164
lambda[  12] =  -0.32532534102081
lambda[  13] =  -0.24698389808798
lambda[  14] =  -0.20852419259735
lambda[  15] =  -0.09933647434794
lambda[  16] =  -0.02889905469206
lambda[  17] =   0.00415907172041
lambda[  18] =   0.01651594088313
lambda[  19] =   0.01736832904592
lambda[  20] =   0.02100107039626
lambda[  21] =   0.03031176573670
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 7.789 ms
rank =  0, Distributing orbital back into band + domain format took 18.349 ms
rank = 0, Subspace_Rotation used 26.150 ms

Total time for subspace rotation: 26.154 ms
rank = 0, Efermi =  -0.128188668392 calculate fermi energy took 0.630 ms
rank = 0, --- Calculate rho: sum over local bands took 5.260 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.520 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.604 ms
rank = 0, Calculating density took 1598.372 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.825 ms
rank = 0, D2D took 1.921 ms
rank = 0, Transfering density took 1.923 ms
Etot    =   -44.180686008931
Eband   =   -13.000264057638
E1      =    29.453865313845
E2      =   -11.678751201046
E3      =   -16.656491691548
Exc     =   -14.829586949053
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 1.486e-04, dEband = 1.382e-02
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -44.180686009, dEtot = 1.486e-04, dEband = 1.382e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.1334976744493, which took 0.581 ms

iter_count = 108, r_2norm = 4.524e-05, tol*||rhs|| = 4.534e-05

Anderson update took 62.446 ms, out of which F'*F took 28.678 ms; b-Ax took 185.307 ms, out of which Lap took 169.415 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 408.481 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831426, int_b + int_rho = 7.640e-14, checking this took 0.108 ms
2-norm of RHS = 776.7020277870945, which took 0.131 ms

iter_count = 228, r_2norm = 7.017e-04, tol*||rhs|| = 7.767e-04

Anderson update took 127.374 ms, out of which F'*F took 60.046 ms; b-Ax took 396.871 ms, out of which Lap took 359.811 ms
Solving Poisson took 842.583 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.173876 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 146.634 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.177868 
Total time for convolution: 	 convolve: 5.206207 
Total time for convolution: 	 convolve: 5.250434 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.537 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.587 ms

This SCF took 27885.331 ms, scf error = 5.760e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.130312, lowerbound = -0.953128, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1447.513 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 63.834 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.779 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 66.630 ms
rank =  0, finding HY took 24.720 ms
rank =  0, distributing HY into block cyclic form took 18.353 ms
rank =  0, finding Y'*HY took 4.050 ms
Rank 0, Project_Hamiltonian used 113.779 ms
Total time for projection: 113.792 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.210 ms
    first calculated eigval = -0.951142498301837
    last  calculated eigval = 0.027258174790813
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48442890504500
lambda[   6] =  -0.44131288015464
lambda[   7] =  -0.40352166176856
lambda[   8] =  -0.38511798189439
lambda[   9] =  -0.36647915282774
lambda[  10] =  -0.35332140556755
lambda[  11] =  -0.35173877828332
lambda[  12] =  -0.32294281596247
lambda[  13] =  -0.24500474709348
lambda[  14] =  -0.20648662663128
lambda[  15] =  -0.09766885864793
lambda[  16] =  -0.02886740798125
lambda[  17] =   0.00355925865171
lambda[  18] =   0.01660872861414
lambda[  19] =   0.01795731645070
lambda[  20] =   0.02055655338068
lambda[  21] =   0.02725817479081
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 7.792 ms
rank =  0, Distributing orbital back into band + domain format took 18.367 ms
rank = 0, Subspace_Rotation used 26.179 ms

Total time for subspace rotation: 26.183 ms
rank = 0, Efermi =  -0.126521052710 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.361 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.596 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.558 ms
rank = 0, Calculating density took 1604.412 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.817 ms
rank = 0, D2D took 1.919 ms
rank = 0, Transfering density took 1.921 ms
Etot    =   -44.180321024511
Eband   =   -12.936824503721
E1      =    29.425943008344
E2      =   -11.639876515818
E3      =   -16.668225640098
Exc     =   -14.837598476371
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 3.318e-05, dEband = 5.767e-03
rank = 0, Calculating/Estimating energy took 0.976 ms, Etot = -44.180321025, dEtot = 3.318e-05, dEband = 5.767e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5305912553381, which took 0.076 ms

iter_count = 108, r_2norm = 2.112e-05, tol*||rhs|| = 2.122e-05

Anderson update took 58.141 ms, out of which F'*F took 27.172 ms; b-Ax took 184.208 ms, out of which Lap took 165.361 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.663 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831428, int_b + int_rho = 9.095e-14, checking this took 0.112 ms
2-norm of RHS = 777.1064364620835, which took 0.116 ms

iter_count = 246, r_2norm = 6.377e-04, tol*||rhs|| = 7.771e-04

Anderson update took 131.666 ms, out of which F'*F took 63.751 ms; b-Ax took 426.230 ms, out of which Lap took 383.227 ms
Solving Poisson took 894.273 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.171848 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 39.476 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.176765 
Total time for convolution: 	 convolve: 5.178645 
Total time for convolution: 	 convolve: 5.206000 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.616 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.138 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.787 ms

This SCF took 27669.298 ms, scf error = 3.886e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.127258, lowerbound = -0.951142, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1449.450 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 59.986 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.660 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 62.665 ms
rank =  0, finding HY took 24.745 ms
rank =  0, distributing HY into block cyclic form took 18.370 ms
rank =  0, finding Y'*HY took 4.018 ms
Rank 0, Project_Hamiltonian used 109.825 ms
Total time for projection: 109.839 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.080 ms
rank = 0, Solve_Generalized_EigenProblem used 0.210 ms
    first calculated eigval = -0.948171273729518
    last  calculated eigval = 0.026692506653502
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48059373520282
lambda[   6] =  -0.43759030805139
lambda[   7] =  -0.39952513802559
lambda[   8] =  -0.38008803497358
lambda[   9] =  -0.36264914549370
lambda[  10] =  -0.34874061980550
lambda[  11] =  -0.34845660021403
lambda[  12] =  -0.31870184895582
lambda[  13] =  -0.24135588343714
lambda[  14] =  -0.20346438735458
lambda[  15] =  -0.09459630172689
lambda[  16] =  -0.02742266934234
lambda[  17] =   0.00396493676177
lambda[  18] =   0.01825626267574
lambda[  19] =   0.01976325228764
lambda[  20] =   0.02132175109712
lambda[  21] =   0.02669250665350
==subpsace eigenproblem: bcast eigvals took 0.058 ms
Total time for solving subspace eigenvalue problem: 0.274 ms
rank =  0, subspace rotation using ScaLAPACK took 7.795 ms
rank =  0, Distributing orbital back into band + domain format took 18.423 ms
rank = 0, Subspace_Rotation used 26.229 ms

Total time for subspace rotation: 26.233 ms
rank = 0, Efermi =  -0.123448495762 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 5.321 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.648 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1602.515 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.811 ms
rank = 0, D2D took 1.911 ms
rank = 0, Transfering density took 1.913 ms
Etot    =   -44.179940564142
Eband   =   -12.826234520893
E1      =    29.375119430828
E2      =   -11.574929143325
E3      =   -16.686032864683
Exc     =   -14.849844273407
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 3.459e-05, dEband = 1.005e-02
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -44.179940564, dEtot = 3.459e-05, dEband = 1.005e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2231305094704, which took 0.065 ms

iter_count = 114, r_2norm = 6.125e-06, tol*||rhs|| = 8.925e-06

Anderson update took 61.186 ms, out of which F'*F took 28.587 ms; b-Ax took 196.284 ms, out of which Lap took 175.533 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.106 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831418, int_b + int_rho = -3.638e-15, checking this took 0.122 ms
2-norm of RHS = 777.1388594162217, which took 0.129 ms

iter_count = 228, r_2norm = 7.377e-04, tol*||rhs|| = 7.771e-04

Anderson update took 121.414 ms, out of which F'*F took 57.239 ms; b-Ax took 388.951 ms, out of which Lap took 348.674 ms
Solving Poisson took 822.719 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.194807 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.204812 
Total time for convolution: 	 convolve: 5.215901 
Total time for convolution: 	 convolve: 5.213659 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.589 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.407 ms
---Transfer Veff_loc: D2D took 3.525 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.011 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.568 ms

This SCF took 27682.312 ms, scf error = 1.845e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.126693, lowerbound = -0.948171, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1444.422 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 58.774 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.612 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 61.414 ms
rank =  0, finding HY took 24.827 ms
rank =  0, distributing HY into block cyclic form took 18.486 ms
rank =  0, finding Y'*HY took 4.409 ms
Rank 0, Project_Hamiltonian used 109.163 ms
Total time for projection: 109.179 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -0.945293789693608
    last  calculated eigval = 0.027539230901091
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47775286349451
lambda[   6] =  -0.43471980127596
lambda[   7] =  -0.39652165677993
lambda[   8] =  -0.37692269987869
lambda[   9] =  -0.35969061109898
lambda[  10] =  -0.34609274935504
lambda[  11] =  -0.34519022769983
lambda[  12] =  -0.31574319460459
lambda[  13] =  -0.23848728362966
lambda[  14] =  -0.20077571897410
lambda[  15] =  -0.09196952578454
lambda[  16] =  -0.02525314095145
lambda[  17] =   0.00566065412538
lambda[  18] =   0.02074415312685
lambda[  19] =   0.02186976813253
lambda[  20] =   0.02330456410660
lambda[  21] =   0.02753923090109
==subpsace eigenproblem: bcast eigvals took 0.043 ms
Total time for solving subspace eigenvalue problem: 0.261 ms
rank =  0, subspace rotation using ScaLAPACK took 7.775 ms
rank =  0, Distributing orbital back into band + domain format took 18.379 ms
rank = 0, Subspace_Rotation used 26.165 ms

Total time for subspace rotation: 26.170 ms
rank = 0, Efermi =  -0.120821719859 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 5.327 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.620 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.613 ms
rank = 0, Calculating density took 1596.750 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.839 ms
rank = 0, D2D took 1.936 ms
rank = 0, Transfering density took 1.939 ms
Etot    =   -44.179831550126
Eband   =   -12.743243885116
E1      =    29.331146627100
E2      =   -11.533296161988
E3      =   -16.696324405613
Exc     =   -14.857411651033
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 9.910e-06, dEband = 7.545e-03
rank = 0, Calculating/Estimating energy took 0.940 ms, Etot = -44.179831550, dEtot = 9.910e-06, dEband = 7.545e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1770693049785, which took 0.058 ms

iter_count = 114, r_2norm = 5.289e-06, tol*||rhs|| = 7.083e-06

Anderson update took 61.601 ms, out of which F'*F took 28.891 ms; b-Ax took 193.594 ms, out of which Lap took 173.988 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.178 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831429, int_b + int_rho = 9.823e-14, checking this took 0.100 ms
2-norm of RHS = 777.1549232198099, which took 0.136 ms

iter_count = 192, r_2norm = 7.690e-04, tol*||rhs|| = 7.772e-04

Anderson update took 103.065 ms, out of which F'*F took 49.033 ms; b-Ax took 326.753 ms, out of which Lap took 294.066 ms
Solving Poisson took 692.324 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.258873 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.273463 
Total time for convolution: 	 convolve: 5.205859 
Total time for convolution: 	 convolve: 5.243578 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.733 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 3.538 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.987 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.557 ms

This SCF took 27810.500 ms, scf error = 1.005e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.127539, lowerbound = -0.945294, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1443.847 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 63.757 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.654 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 66.427 ms
rank =  0, finding HY took 24.689 ms
rank =  0, distributing HY into block cyclic form took 18.396 ms
rank =  0, finding Y'*HY took 4.027 ms
Rank 0, Project_Hamiltonian used 113.567 ms
Total time for projection: 113.583 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.221 ms
    first calculated eigval = -0.944727706306456
    last  calculated eigval = 0.027471851043054
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47723241508643
lambda[   6] =  -0.43418688417191
lambda[   7] =  -0.39598026176109
lambda[   8] =  -0.37628467756230
lambda[   9] =  -0.35914674543541
lambda[  10] =  -0.34551529842224
lambda[  11] =  -0.34460770988105
lambda[  12] =  -0.31518318681276
lambda[  13] =  -0.23797452296580
lambda[  14] =  -0.20023261197019
lambda[  15] =  -0.09143280723022
lambda[  16] =  -0.02446014295812
lambda[  17] =   0.00652707437349
lambda[  18] =   0.02168838331317
lambda[  19] =   0.02235801636422
lambda[  20] =   0.02385500350399
lambda[  21] =   0.02747185104305
==subpsace eigenproblem: bcast eigvals took 0.057 ms
Total time for solving subspace eigenvalue problem: 0.286 ms
rank =  0, subspace rotation using ScaLAPACK took 7.757 ms
rank =  0, Distributing orbital back into band + domain format took 18.415 ms
rank = 0, Subspace_Rotation used 26.184 ms

Total time for subspace rotation: 26.188 ms
rank = 0, Efermi =  -0.120285001300 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.308 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.659 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.622 ms
rank = 0, Calculating density took 1600.612 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.941 ms
rank = 0, D2D took 2.045 ms
rank = 0, Transfering density took 2.049 ms
Etot    =   -44.179853073061
Eband   =   -12.727855552600
E1      =    29.325179184857
E2      =   -11.523743277084
E3      =   -16.696478661959
Exc     =   -14.857455435683
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 1.957e-06, dEband = 1.399e-03
rank = 0, Calculating/Estimating energy took 1.149 ms, Etot = -44.179853073, dEtot = 1.957e-06, dEband = 1.399e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0931644034566, which took 0.053 ms

iter_count = 114, r_2norm = 2.636e-06, tol*||rhs|| = 3.727e-06

Anderson update took 61.304 ms, out of which F'*F took 28.665 ms; b-Ax took 193.338 ms, out of which Lap took 173.177 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.629 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831412, int_b + int_rho = -6.548e-14, checking this took 0.102 ms
2-norm of RHS = 777.1288806994569, which took 0.126 ms

iter_count = 210, r_2norm = 6.343e-04, tol*||rhs|| = 7.771e-04

Anderson update took 112.075 ms, out of which F'*F took 52.587 ms; b-Ax took 357.119 ms, out of which Lap took 319.513 ms
Solving Poisson took 756.629 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.163573 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.453 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.186968 
Total time for convolution: 	 convolve: 5.198553 
Total time for convolution: 	 convolve: 5.159247 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.548 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.216 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.800 ms

This SCF took 27512.858 ms, scf error = 7.659e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.127472, lowerbound = -0.944728, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1446.552 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 63.402 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.643 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 66.060 ms
rank =  0, finding HY took 24.782 ms
rank =  0, distributing HY into block cyclic form took 18.372 ms
rank =  0, finding Y'*HY took 4.012 ms
Rank 0, Project_Hamiltonian used 113.253 ms
Total time for projection: 113.268 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.226 ms
    first calculated eigval = -0.943462373594644
    last  calculated eigval = 0.029811663261201
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47583158964559
lambda[   6] =  -0.43281351394980
lambda[   7] =  -0.39456529240617
lambda[   8] =  -0.37462242822608
lambda[   9] =  -0.35775280720027
lambda[  10] =  -0.34423994723541
lambda[  11] =  -0.34301235382127
lambda[  12] =  -0.31368446181374
lambda[  13] =  -0.23661837689892
lambda[  14] =  -0.19896065479146
lambda[  15] =  -0.09009928257234
lambda[  16] =  -0.02110865882367
lambda[  17] =   0.01008646444960
lambda[  18] =   0.02477994174266
lambda[  19] =   0.02546225693108
lambda[  20] =   0.02682555192723
lambda[  21] =   0.02981166326120
==subpsace eigenproblem: bcast eigvals took 0.075 ms
Total time for solving subspace eigenvalue problem: 0.308 ms
rank =  0, subspace rotation using ScaLAPACK took 7.814 ms
rank =  0, Distributing orbital back into band + domain format took 18.303 ms
rank = 0, Subspace_Rotation used 26.129 ms

Total time for subspace rotation: 26.153 ms
rank = 0, Efermi =  -0.118951476633 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.312 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.025 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.568 ms
rank = 0, Calculating density took 1603.353 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.829 ms
rank = 0, D2D took 1.928 ms
rank = 0, Transfering density took 1.935 ms
Etot    =   -44.179872934205
Eband   =   -12.687977680902
E1      =    29.304754292154
E2      =   -11.503645991358
E3      =   -16.699598893377
Exc     =   -14.859951221514
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 1.806e-06, dEband = 3.625e-03
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -44.179872934, dEtot = 1.806e-06, dEband = 3.625e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0712220327135, which took 0.102 ms

iter_count = 114, r_2norm = 2.093e-06, tol*||rhs|| = 2.849e-06

Anderson update took 61.606 ms, out of which F'*F took 28.836 ms; b-Ax took 193.893 ms, out of which Lap took 174.110 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.074 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831427, int_b + int_rho = 8.004e-14, checking this took 0.099 ms
2-norm of RHS = 777.1310972186645, which took 0.109 ms

iter_count = 168, r_2norm = 6.918e-04, tol*||rhs|| = 7.771e-04

Anderson update took 89.674 ms, out of which F'*F took 42.761 ms; b-Ax took 285.404 ms, out of which Lap took 255.768 ms
Solving Poisson took 605.442 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.174945 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.712 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.193196 
Total time for convolution: 	 convolve: 5.170715 
Total time for convolution: 	 convolve: 5.159722 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.138 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.517 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.998 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.547 ms

This SCF took 27552.346 ms, scf error = 4.367e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129812, lowerbound = -0.943462, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1444.847 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 60.494 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.621 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 63.133 ms
rank =  0, finding HY took 25.744 ms
rank =  0, distributing HY into block cyclic form took 21.278 ms
rank =  0, finding Y'*HY took 3.739 ms
Rank 0, Project_Hamiltonian used 113.930 ms
Total time for projection: 113.952 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.231 ms
    first calculated eigval = -0.942955484284529
    last  calculated eigval = 0.030527201345545
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47532991922962
lambda[   6] =  -0.43232195475918
lambda[   7] =  -0.39405363372182
lambda[   8] =  -0.37411330565340
lambda[   9] =  -0.35725119660306
lambda[  10] =  -0.34376039806544
lambda[  11] =  -0.34248436652857
lambda[  12] =  -0.31317609618306
lambda[  13] =  -0.23610231263215
lambda[  14] =  -0.19846910378482
lambda[  15] =  -0.08960777735806
lambda[  16] =  -0.02040104211366
lambda[  17] =   0.01105964907660
lambda[  18] =   0.02483826445108
lambda[  19] =   0.02591057866927
lambda[  20] =   0.02720225573971
lambda[  21] =   0.03052720134555
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.270 ms
rank =  0, subspace rotation using ScaLAPACK took 7.835 ms
rank =  0, Distributing orbital back into band + domain format took 19.072 ms
rank = 0, Subspace_Rotation used 26.918 ms

Total time for subspace rotation: 26.922 ms
rank = 0, Efermi =  -0.118459971394 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.327 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.723 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.616 ms
rank = 0, Calculating density took 1602.785 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.841 ms
rank = 0, D2D took 1.941 ms
rank = 0, Transfering density took 1.943 ms
Etot    =   -44.179933468140
Eband   =   -12.673740050078
E1      =    29.297193613458
E2      =   -11.496639332566
E3      =   -16.700927563844
Exc     =   -14.861010719250
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 5.503e-06, dEband = 1.294e-03
rank = 0, Calculating/Estimating energy took 0.914 ms, Etot = -44.179933468, dEtot = 5.503e-06, dEband = 1.294e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0714006984186, which took 0.119 ms

iter_count = 108, r_2norm = 2.137e-06, tol*||rhs|| = 2.856e-06

Anderson update took 58.284 ms, out of which F'*F took 27.307 ms; b-Ax took 183.483 ms, out of which Lap took 164.603 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.661 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831430, int_b + int_rho = 1.091e-13, checking this took 0.125 ms
2-norm of RHS = 777.1500957421342, which took 0.142 ms

iter_count = 180, r_2norm = 6.841e-04, tol*||rhs|| = 7.772e-04

Anderson update took 95.813 ms, out of which F'*F took 45.547 ms; b-Ax took 306.265 ms, out of which Lap took 274.149 ms
Solving Poisson took 649.516 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.162638 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 120.324 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.206624 
Total time for convolution: 	 convolve: 5.177486 
Total time for convolution: 	 convolve: 5.231908 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 3.544 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.201 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.779 ms

This SCF took 27530.646 ms, scf error = 3.370e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.130527, lowerbound = -0.942955, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1445.823 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 62.378 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.591 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 64.986 ms
rank =  0, finding HY took 24.930 ms
rank =  0, distributing HY into block cyclic form took 18.438 ms
rank =  0, finding Y'*HY took 4.047 ms
Rank 0, Project_Hamiltonian used 112.426 ms
Total time for projection: 112.439 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -0.942404856536856
    last  calculated eigval = 0.033356786959482
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47471072440695
lambda[   6] =  -0.43171837544408
lambda[   7] =  -0.39346928155441
lambda[   8] =  -0.37350353643295
lambda[   9] =  -0.35668020160144
lambda[  10] =  -0.34318178504156
lambda[  11] =  -0.34187246770240
lambda[  12] =  -0.31255604535362
lambda[  13] =  -0.23548161252586
lambda[  14] =  -0.19791959879623
lambda[  15] =  -0.08899067862552
lambda[  16] =  -0.01758232072387
lambda[  17] =   0.01371335765760
lambda[  18] =   0.02612538628148
lambda[  19] =   0.02713188800499
lambda[  20] =   0.03009811153233
lambda[  21] =   0.03335678695948
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.239 ms
rank =  0, subspace rotation using ScaLAPACK took 7.856 ms
rank =  0, Distributing orbital back into band + domain format took 18.927 ms
rank = 0, Subspace_Rotation used 26.795 ms

Total time for subspace rotation: 26.800 ms
rank = 0, Efermi =  -0.117842872665 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.304 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.736 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.597 ms
rank = 0, Calculating density took 1602.062 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.808 ms
rank = 0, D2D took 1.904 ms
rank = 0, Transfering density took 1.905 ms
Etot    =   -44.180013219176
Eband   =   -12.656958650695
E1      =    29.289321148593
E2      =   -11.487525785475
E3      =   -16.701710410916
Exc     =   -14.861668704786
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 7.250e-06, dEband = 1.526e-03
rank = 0, Calculating/Estimating energy took 0.928 ms, Etot = -44.180013219, dEtot = 7.250e-06, dEband = 1.526e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0583746964410, which took 0.057 ms

iter_count = 108, r_2norm = 1.996e-06, tol*||rhs|| = 2.335e-06

Anderson update took 58.551 ms, out of which F'*F took 27.508 ms; b-Ax took 183.865 ms, out of which Lap took 165.460 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.995 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831430, int_b + int_rho = 1.128e-13, checking this took 0.099 ms
2-norm of RHS = 777.1508418341946, which took 0.100 ms

iter_count = 138, r_2norm = 6.756e-04, tol*||rhs|| = 7.772e-04

Anderson update took 73.782 ms, out of which F'*F took 35.089 ms; b-Ax took 234.584 ms, out of which Lap took 210.240 ms
Solving Poisson took 498.689 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.197001 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.193659 
Total time for convolution: 	 convolve: 5.168988 
Total time for convolution: 	 convolve: 5.291994 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
---Transfer Veff_loc: D2D took 3.533 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.208 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.776 ms

This SCF took 27333.648 ms, scf error = 2.151e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.133357, lowerbound = -0.942405, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1447.190 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 63.057 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.632 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 65.706 ms
rank =  0, finding HY took 24.855 ms
rank =  0, distributing HY into block cyclic form took 18.338 ms
rank =  0, finding Y'*HY took 4.025 ms
Rank 0, Project_Hamiltonian used 112.949 ms
Total time for projection: 112.966 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.394 ms
rank = 0, Solve_Generalized_EigenProblem used 0.526 ms
    first calculated eigval = -0.942184425095957
    last  calculated eigval = 0.033607152813775
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47451831181932
lambda[   6] =  -0.43152102904570
lambda[   7] =  -0.39327046692313
lambda[   8] =  -0.37332226980370
lambda[   9] =  -0.35648154315143
lambda[  10] =  -0.34298173228273
lambda[  11] =  -0.34167970488028
lambda[  12] =  -0.31236773616474
lambda[  13] =  -0.23528918009374
lambda[  14] =  -0.19771459687143
lambda[  15] =  -0.08880596829787
lambda[  16] =  -0.01722341098268
lambda[  17] =   0.01377888453234
lambda[  18] =   0.02607405553992
lambda[  19] =   0.02719083963329
lambda[  20] =   0.03048969171355
lambda[  21] =   0.03360715281377
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.546 ms
rank =  0, subspace rotation using ScaLAPACK took 7.833 ms
rank =  0, Distributing orbital back into band + domain format took 18.591 ms
rank = 0, Subspace_Rotation used 26.440 ms

Total time for subspace rotation: 26.446 ms
rank = 0, Efermi =  -0.117658162320 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.296 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.638 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1603.864 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.817 ms
rank = 0, D2D took 1.918 ms
rank = 0, Transfering density took 1.924 ms
Etot    =   -44.180044498974
Eband   =   -12.651440162176
E1      =    29.286367718668
E2      =   -11.484804563788
E3      =   -16.702282188958
Exc     =   -14.862115599533
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 2.844e-06, dEband = 5.017e-04
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -44.180044499, dEtot = 2.844e-06, dEband = 5.017e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0330608141800, which took 0.058 ms

iter_count = 114, r_2norm = 8.409e-07, tol*||rhs|| = 1.322e-06

Anderson update took 61.646 ms, out of which F'*F took 28.638 ms; b-Ax took 193.661 ms, out of which Lap took 173.582 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.477 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831421, int_b + int_rho = 2.547e-14, checking this took 0.098 ms
2-norm of RHS = 777.1537987160019, which took 0.125 ms

iter_count = 144, r_2norm = 7.740e-04, tol*||rhs|| = 7.772e-04

Anderson update took 76.999 ms, out of which F'*F took 36.238 ms; b-Ax took 245.450 ms, out of which Lap took 219.813 ms
Solving Poisson took 520.686 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.195048 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.712 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.172836 
Total time for convolution: 	 convolve: 5.203351 
Total time for convolution: 	 convolve: 5.177128 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 3.506 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.003 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.543 ms

This SCF took 27290.388 ms, scf error = 1.701e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133607, lowerbound = -0.942184, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1444.010 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 59.713 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.707 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 62.465 ms
rank =  0, finding HY took 24.797 ms
rank =  0, distributing HY into block cyclic form took 18.317 ms
rank =  0, finding Y'*HY took 4.059 ms
Rank 0, Project_Hamiltonian used 109.670 ms
Total time for projection: 109.689 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -0.941963026301331
    last  calculated eigval = 0.033398398504646
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47432112332727
lambda[   6] =  -0.43131650530958
lambda[   7] =  -0.39307779612224
lambda[   8] =  -0.37315211895908
lambda[   9] =  -0.35628691283186
lambda[  10] =  -0.34277299070876
lambda[  11] =  -0.34150076655014
lambda[  12] =  -0.31218142919024
lambda[  13] =  -0.23510003735580
lambda[  14] =  -0.19750967108770
lambda[  15] =  -0.08862618702596
lambda[  16] =  -0.01689186913444
lambda[  17] =   0.01373832953347
lambda[  18] =   0.02600024364327
lambda[  19] =   0.02717337114983
lambda[  20] =   0.03114660913656
lambda[  21] =   0.03339839850465
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 7.790 ms
rank =  0, Distributing orbital back into band + domain format took 18.392 ms
rank = 0, Subspace_Rotation used 26.194 ms

Total time for subspace rotation: 26.198 ms
rank = 0, Efermi =  -0.117478381098 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 5.350 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.633 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.614 ms
rank = 0, Calculating density took 1596.898 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.846 ms
rank = 0, D2D took 1.950 ms
rank = 0, Transfering density took 1.956 ms
Etot    =   -44.180093413774
Eband   =   -12.645990045691
E1      =    29.283732908623
E2      =   -11.481872970000
E3      =   -16.702578263831
Exc     =   -14.862344301858
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 4.447e-06, dEband = 4.955e-04
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -44.180093414, dEtot = 4.447e-06, dEband = 4.955e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0254859621381, which took 0.083 ms

iter_count = 108, r_2norm = 8.142e-07, tol*||rhs|| = 1.019e-06

Anderson update took 58.398 ms, out of which F'*F took 27.481 ms; b-Ax took 183.586 ms, out of which Lap took 165.170 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.790 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831433, int_b + int_rho = 1.382e-13, checking this took 0.109 ms
2-norm of RHS = 777.1528133024493, which took 0.153 ms

iter_count = 144, r_2norm = 7.177e-04, tol*||rhs|| = 7.772e-04

Anderson update took 77.109 ms, out of which F'*F took 36.707 ms; b-Ax took 245.775 ms, out of which Lap took 220.252 ms
Solving Poisson took 520.709 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.174789 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.793 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.194109 
Total time for convolution: 	 convolve: 5.179548 
Total time for convolution: 	 convolve: 5.191491 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 3.518 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.987 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.539 ms

This SCF took 27300.144 ms, scf error = 1.271e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.133398, lowerbound = -0.941963, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1449.637 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 59.855 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.645 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 62.517 ms
rank =  0, finding HY took 24.830 ms
rank =  0, distributing HY into block cyclic form took 18.459 ms
rank =  0, finding Y'*HY took 4.038 ms
Rank 0, Project_Hamiltonian used 109.874 ms
Total time for projection: 109.890 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -0.941887178500016
    last  calculated eigval = 0.033695956541029
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47423096741622
lambda[   6] =  -0.43123532371528
lambda[   7] =  -0.39300089296343
lambda[   8] =  -0.37309417283049
lambda[   9] =  -0.35621086782610
lambda[  10] =  -0.34269003636943
lambda[  11] =  -0.34144058348008
lambda[  12] =  -0.31210410583796
lambda[  13] =  -0.23501230414155
lambda[  14] =  -0.19742717082140
lambda[  15] =  -0.08855232154679
lambda[  16] =  -0.01617603746316
lambda[  17] =   0.01389076152570
lambda[  18] =   0.02672538013771
lambda[  19] =   0.02719152908664
lambda[  20] =   0.03113944074260
lambda[  21] =   0.03369595654103
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.254 ms
rank =  0, subspace rotation using ScaLAPACK took 7.812 ms
rank =  0, Distributing orbital back into band + domain format took 18.381 ms
rank = 0, Subspace_Rotation used 26.206 ms

Total time for subspace rotation: 26.210 ms
rank = 0, Efermi =  -0.117404515572 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.327 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.646 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.621 ms
rank = 0, Calculating density took 1602.750 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.854 ms
rank = 0, D2D took 1.953 ms
rank = 0, Transfering density took 1.955 ms
Etot    =   -44.180119443442
Eband   =   -12.643830501723
E1      =    29.282859082757
E2      =   -11.480630544184
E3      =   -16.702316488564
Exc     =   -14.862151848545
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 2.366e-06, dEband = 1.963e-04
rank = 0, Calculating/Estimating energy took 0.916 ms, Etot = -44.180119443, dEtot = 2.366e-06, dEband = 1.963e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0256004990265, which took 0.059 ms

iter_count = 108, r_2norm = 7.616e-07, tol*||rhs|| = 1.024e-06

Anderson update took 58.227 ms, out of which F'*F took 27.174 ms; b-Ax took 183.570 ms, out of which Lap took 164.416 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.243 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831430, int_b + int_rho = 1.164e-13, checking this took 0.124 ms
2-norm of RHS = 777.1541255169183, which took 0.116 ms

iter_count = 96, r_2norm = 6.424e-04, tol*||rhs|| = 7.772e-04

Anderson update took 51.428 ms, out of which F'*F took 24.193 ms; b-Ax took 163.301 ms, out of which Lap took 146.235 ms
Solving Poisson took 348.027 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.200171 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.352 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.175709 
Total time for convolution: 	 convolve: 5.205923 
Total time for convolution: 	 convolve: 5.214514 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.644 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.029 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.707 ms

This SCF took 27122.667 ms, scf error = 1.004e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.133696, lowerbound = -0.941887, upperbound = 267.571294

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1443.161 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 59.065 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.660 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 61.742 ms
rank =  0, finding HY took 24.736 ms
rank =  0, distributing HY into block cyclic form took 18.390 ms
rank =  0, finding Y'*HY took 4.035 ms
Rank 0, Project_Hamiltonian used 108.930 ms
Total time for projection: 108.945 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.941819182408095
    last  calculated eigval = 0.033918282629309
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47417250260421
lambda[   6] =  -0.43117581836117
lambda[   7] =  -0.39293855887696
lambda[   8] =  -0.37303496480188
lambda[   9] =  -0.35614855088609
lambda[  10] =  -0.34262601151002
lambda[  11] =  -0.34138037268633
lambda[  12] =  -0.31204616362854
lambda[  13] =  -0.23495243101556
lambda[  14] =  -0.19736193562019
lambda[  15] =  -0.08849494784920
lambda[  16] =  -0.01569198683156
lambda[  17] =   0.01397934514323
lambda[  18] =   0.02707923733919
lambda[  19] =   0.02740842079208
lambda[  20] =   0.03155140005289
lambda[  21] =   0.03391828262931
==subpsace eigenproblem: bcast eigvals took 0.043 ms
Total time for solving subspace eigenvalue problem: 0.266 ms
rank =  0, subspace rotation using ScaLAPACK took 7.793 ms
rank =  0, Distributing orbital back into band + domain format took 18.350 ms
rank = 0, Subspace_Rotation used 26.154 ms

Total time for subspace rotation: 26.159 ms
rank = 0, Efermi =  -0.117347141901 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.286 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.114 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.649 ms
rank = 0, Calculating density took 1595.747 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.968 ms
rank = 0, D2D took 2.088 ms
rank = 0, Transfering density took 2.092 ms
Etot    =   -44.180126634691
Eband   =   -12.642120633938
E1      =    29.282046759739
E2      =   -11.479702457035
E3      =   -16.702409840918
Exc     =   -14.862221849767
Esc     =   -74.139943207837
Entropy =    -0.000000000842
dE = 6.537e-07, dEband = 1.554e-04
rank = 0, Calculating/Estimating energy took 0.893 ms, Etot = -44.180126635, dEtot = 6.537e-07, dEband = 1.554e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0225694035289, which took 0.097 ms

iter_count = 108, r_2norm = 7.269e-07, tol*||rhs|| = 9.028e-07

Anderson update took 58.217 ms, out of which F'*F took 27.383 ms; b-Ax took 184.179 ms, out of which Lap took 165.532 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.590 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002831419, int_rho =  28.00000002831416, int_b + int_rho = -2.910e-14, checking this took 0.118 ms
2-norm of RHS = 777.1538802799031, which took 0.129 ms

iter_count = 84, r_2norm = 7.422e-04, tol*||rhs|| = 7.772e-04

Anderson update took 45.030 ms, out of which F'*F took 21.254 ms; b-Ax took 142.952 ms, out of which Lap took 127.964 ms
Solving Poisson took 304.796 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.193440 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.173181 
Total time for convolution: 	 convolve: 5.203269 
Total time for convolution: 	 convolve: 5.182745 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.526 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.192 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.756 ms

This SCF took 27024.578 ms, scf error = 8.923e-05
The last 17 occupations of kpoints #1 are (Nelectron = 28):
lambda[   5] =  -0.47417250260421, occ[   5] =   2.00000000000000
lambda[   6] =  -0.43117581836117, occ[   6] =   2.00000000000000
lambda[   7] =  -0.39293855887696, occ[   7] =   2.00000000000000
lambda[   8] =  -0.37303496480188, occ[   8] =   2.00000000000000
lambda[   9] =  -0.35614855088609, occ[   9] =   2.00000000000000
lambda[  10] =  -0.34262601151002, occ[  10] =   2.00000000000000
lambda[  11] =  -0.34138037268633, occ[  11] =   2.00000000000000
lambda[  12] =  -0.31204616362854, occ[  12] =   2.00000000000000
lambda[  13] =  -0.23495243101556, occ[  13] =   2.00000000000000
lambda[  14] =  -0.19736193562019, occ[  14] =   2.00000000000000
lambda[  15] =  -0.08849494784920, occ[  15] =   0.00000002831424
lambda[  16] =  -0.01569198683156, occ[  16] =   0.00000000000000
lambda[  17] =   0.01397934514323, occ[  17] =   0.00000000000000
lambda[  18] =   0.02707923733919, occ[  18] =   0.00000000000000
lambda[  19] =   0.02740842079208, occ[  19] =   0.00000000000000
lambda[  20] =   0.03155140005289, occ[  20] =   0.00000000000000
lambda[  21] =   0.03391828262931, occ[  21] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 19 (90%) = 0.000000000000000.
Occupation of state 21 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.758 ms, time for Allreduce/Reduce: 12.358 ms 
Time for calculating local force components: 25.235 ms
Start Calculating nonlocal forces
force_nloc = 
  0.60762993579166   1.01254089794285  -0.00000034160865
  0.02474358741951  -0.04111531292209  -0.00000000619869
 -0.01903963063934  -0.04715379961446  -0.00000002595718
  0.02382008433911   0.04619964753126  -0.00000001424788
 -0.01842601236915  -0.04619850034559   0.00000000926279
 -0.01801606204130   0.02317909992216  -0.03891300289762
 -0.01801606644371   0.02317909400964   0.03891299147709
 -0.03791752799888  -0.10364042317213  -0.00000027850500
 -0.01201116662491   0.00122705116010   0.00000060643009
  0.02836280755082  -0.00088340376208  -0.00000022147376
 -0.03196560564649  -0.01333344420234  -0.00000056380707
force_loc = 
 -0.60138563397283  -0.99984852976117  -0.00000104177235
 -0.02659868508604   0.04352677721427  -0.00000035060881
  0.01984489099374   0.04926118526771   0.00000055097392
 -0.02434875352706  -0.04837555802641  -0.00000039013696
  0.01904577876546   0.04701225321926  -0.00000021289164
  0.01854446086601  -0.02406423285638   0.03958998654343
  0.01854463427604  -0.02406438192130  -0.03959014276213
  0.04822229607004   0.11731443798845  -0.00000037760494
  0.00479773513205   0.00699619209567   0.00000164331065
 -0.01590731529302  -0.00730740252349   0.00000025313698
  0.02832189235702   0.01414464988110  -0.00000239754690
Time for calculating nonlocal force components: 40.442 ms
[32mforces_xc: 
[0m[32m -0.01481391314227  -0.02397273266843  -0.00000003159637
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00324503173343  -0.00477267117469   0.00000001712725
[0m[32m  0.00294748121019  -0.00401059455569   0.00000008152959
[0m[32m -0.00491222469245   0.00360390515968   0.00000000783240
[0m[32m  0.00183018634548   0.00037229933351  -0.00000017873187
[0mTime for calculating XC forces components: 37.212 ms
 Cartesian force = 
 -0.00857435149674  -0.01126368296124  -0.00000110309340
 -0.00185983783982   0.00242814581768  -0.00000004492353
  0.00080052018110   0.00212406717875   0.00000083690070
 -0.00053340936125  -0.00215922896964  -0.00000009250087
  0.00061502622302   0.00083043439918   0.00000010825511
  0.00052365865142  -0.00086845140872   0.00067729552978
  0.00052382765903  -0.00086860638615  -0.00067683940108
  0.00705499616445   0.00891802516714  -0.00000032709871
 -0.00427069045597   0.00422933022559   0.00000264315429
  0.00753852739205  -0.00457021960037   0.00000035137958
 -0.00181826711729   0.00120018653778  -0.00000282820188
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Time for printing density: 380.693 ms
The program took 474.424 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:35
Job ID:        2266743
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:37:12,vmem=8444K,walltime=00:08:06,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-008-2-2
---------------------------------------
