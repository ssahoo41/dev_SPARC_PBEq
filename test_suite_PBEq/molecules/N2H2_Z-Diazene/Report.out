---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:39
Job ID:    2266971
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:44
Job ID:    2266971
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.058 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 15.488 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 4.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = N.psp8

Reading ion file took 15.391 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 85.300 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.932 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.108 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   11.904139	   10.910065	
   10.000000	    8.095861	   10.910065	
   10.000000	   11.182122	    9.089935	
   10.000000	    8.817878	    9.089935	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.177 ms
Set up communicators.

--set up spincomm took 2.275 ms

--set up kptcomm took 0.371 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 12, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 12 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 1), actual size (1000000, 1)
rank = 0, mb = nb = 12, mbQ = nbQ = 64
rank = 0, nr_Hp = 12, nc_Hp = 12
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.097 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 1
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.087 ms

Calculate_SplineDerivRadFun took 0.111 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.793 ms.
time spent on vectorized spline interp: 2.714 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.626 ms.
time spent on vectorized spline interp: 1.673 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.518 ms.

Calculating rb for all atom types took 11.332 ms
----------------------
Estimated memory usage
Total: 839.24 MB
orbitals             : 549.32 MB
global sized vectors : 213.62 MB
subspace matrices : 3.38 kB
others : 76.29 MB
----------------------------------------------
Estimated memory usage per processor: 69.94 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.958 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -12.0000000116201, sum_int_rho = 11.8013426521875
PosCharge = 12.000000011620, NegCharge = -11.801342652187, scal_fac = 1.016833454064
After scaling, int_rho = 12.0000000116200, PosCharge + NegCharge - NetCharge = 1.723e-13
--Calculate Vref took 0.228 ms
--Calculate rho_guess took 1.433 ms

 integral of b = -12.0000000116201,
 int{b} + Nelectron + NetCharge = -1.162e-08,
 Esc = -36.0463613797279,
 MPI_Reduce took 2.456 ms

Calculating b & b_ref took 8.627 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.036 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.107 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.042 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.281 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.014 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 21.870 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001162008, int_b + int_rho = -1.783e-13, checking this took 0.872 ms
2-norm of RHS = 504.6313894452766, which took 0.091 ms

iter_count = 420, r_2norm = 4.435e-04, tol*||rhs|| = 5.046e-04

Anderson update took 232.682 ms, out of which F'*F took 105.012 ms; b-Ax took 713.775 ms, out of which Lap took 640.779 ms
Solving Poisson took 1519.441 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.360 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
Total time for convolution: 	 convolve: 5.233052 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
Total time for convolution: 	 convolve: 5.108836 
Total time for convolution: 	 convolve: 5.166187 
Total time for convolution: 	 convolve: 5.124079 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.725 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.594 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.377 ms
rank = 0, XC calculation took 24477.255 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 4.980 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.964 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.078 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.168 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.682 ms
    Lanczos iter 53, eigmin  = -1.017757476, eigmax = 264.919531379, err_eigmin = 3.794e-04, err_eigmax = 9.814e-03
rank =   0, Lanczos took 120.962 ms, eigmin = -1.017757475817, eigmax = 267.568726692674

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.225485, lowerbound = -1.117757, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 801.872 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.794 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.743 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.556 ms
rank =  0, finding HY took 15.313 ms
rank =  0, distributing HY into block cyclic form took 7.982 ms
rank =  0, finding Y'*HY took 2.472 ms
Rank 0, Project_Hamiltonian used 47.354 ms
Total time for projection: 47.371 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.284 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.112 ms
rank = 0, Solve_Generalized_EigenProblem used 0.400 ms
    first calculated eigval = 2.833582005363703
    last  calculated eigval = 3.194934479040249
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =   2.83358200536370
lambda[   2] =   2.86517268118133
lambda[   3] =   2.89175664974492
lambda[   4] =   2.91719684928991
lambda[   5] =   2.97165990426231
lambda[   6] =   2.98117019429366
lambda[   7] =   3.00082084438238
lambda[   8] =   3.04508658106259
lambda[   9] =   3.09264729221021
lambda[  10] =   3.12142383037830
lambda[  11] =   3.14662124104777
lambda[  12] =   3.19493447904025
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.423 ms
rank =  0, subspace rotation using ScaLAPACK took 2.831 ms
rank =  0, Distributing orbital back into band + domain format took 7.860 ms
rank = 0, Subspace_Rotation used 10.707 ms

Total time for subspace rotation: 10.711 ms
rank = 0, Efermi =   2.990999376238 calculate fermi energy took 0.103 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.294934, lowerbound = -1.117757, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 792.280 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 41.239 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.679 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 42.940 ms
rank =  0, finding HY took 13.839 ms
rank =  0, distributing HY into block cyclic form took 11.158 ms
rank =  0, finding Y'*HY took 2.383 ms
Rank 0, Project_Hamiltonian used 70.888 ms
Total time for projection: 70.896 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.856707504577636
    last  calculated eigval = 0.424281414891296
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.85670750457764
lambda[   2] =  -0.41103909695242
lambda[   3] =  -0.16305793440326
lambda[   4] =   0.00129496650840
lambda[   5] =   0.20029064183381
lambda[   6] =   0.28489220852886
lambda[   7] =   0.33623270731471
lambda[   8] =   0.36015641932702
lambda[   9] =   0.37323384413280
lambda[  10] =   0.37989014863723
lambda[  11] =   0.41130872933010
lambda[  12] =   0.42428141489130
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 2.845 ms
rank =  0, Distributing orbital back into band + domain format took 7.797 ms
rank = 0, Subspace_Rotation used 10.655 ms

Total time for subspace rotation: 10.660 ms
rank = 0, Efermi =   0.310569968559 calculate fermi energy took 0.051 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.524281, lowerbound = -1.117757, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 796.613 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 39.380 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.675 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 41.074 ms
rank =  0, finding HY took 13.608 ms
rank =  0, distributing HY into block cyclic form took 8.057 ms
rank =  0, finding Y'*HY took 2.438 ms
Rank 0, Project_Hamiltonian used 65.214 ms
Total time for projection: 65.220 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -1.020067503419712
    last  calculated eigval = 0.156701808135908
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02006750341971
lambda[   2] =  -0.69378196804573
lambda[   3] =  -0.58306021920345
lambda[   4] =  -0.40665720791443
lambda[   5] =  -0.39926563267926
lambda[   6] =  -0.15208342741920
lambda[   7] =  -0.09015805872324
lambda[   8] =   0.08253360943325
lambda[   9] =   0.10357521855334
lambda[  10] =   0.11607560730153
lambda[  11] =   0.13672299482358
lambda[  12] =   0.15670180813591
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 2.806 ms
rank =  0, Distributing orbital back into band + domain format took 7.766 ms
rank = 0, Subspace_Rotation used 10.584 ms

Total time for subspace rotation: 10.590 ms
rank = 0, Efermi =  -0.119771097808 calculate fermi energy took 0.038 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.256702, lowerbound = -1.117757, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 792.448 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 40.684 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.683 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 43.488 ms
rank =  0, finding HY took 13.241 ms
rank =  0, distributing HY into block cyclic form took 7.745 ms
rank =  0, finding Y'*HY took 2.491 ms
Rank 0, Project_Hamiltonian used 66.991 ms
Total time for projection: 66.999 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -1.020214992449862
    last  calculated eigval = 0.096757451789634
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02021499244986
lambda[   2] =  -0.69550998138119
lambda[   3] =  -0.58562878380386
lambda[   4] =  -0.41698961431419
lambda[   5] =  -0.41574968228531
lambda[   6] =  -0.28665124145204
lambda[   7] =  -0.16478383807399
lambda[   8] =   0.01959671881079
lambda[   9] =   0.04554392309531
lambda[  10] =   0.06468195751806
lambda[  11] =   0.08877710057847
lambda[  12] =   0.09675745178963
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 2.818 ms
rank =  0, Distributing orbital back into band + domain format took 7.769 ms
rank = 0, Subspace_Rotation used 10.599 ms

Total time for subspace rotation: 10.604 ms
rank = 0, Efermi =  -0.194434608249 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.712 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.216 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.622 ms
rank = 0, Calculating density took 3615.400 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.855 ms
rank = 0, D2D took 1.958 ms
rank = 0, Transfering density took 1.965 ms
Etot    =   -21.893410255774
Eband   =    -6.841488593288
E1      =    14.272803618337
E2      =    -5.954775235467
E3      =    -7.270728938129
Exc     =    -6.503868074337
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 5.473e+00, dEband = 1.710e+00
rank = 0, Calculating/Estimating energy took 0.935 ms, Etot = -21.893410256, dEtot = 5.473e+00, dEband = 1.710e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 46.2757605326687, which took 0.182 ms

iter_count = 90, r_2norm = 1.648e-03, tol*||rhs|| = 1.851e-03

Anderson update took 48.308 ms, out of which F'*F took 22.416 ms; b-Ax took 152.134 ms, out of which Lap took 136.008 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.122 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161995, int_b + int_rho = -3.056e-13, checking this took 0.106 ms
2-norm of RHS = 502.1862925911648, which took 0.161 ms

iter_count = 282, r_2norm = 4.049e-04, tol*||rhs|| = 5.022e-04

Anderson update took 152.332 ms, out of which F'*F took 70.101 ms; b-Ax took 469.788 ms, out of which Lap took 422.173 ms
Solving Poisson took 1012.421 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.097498 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.081272 
Total time for convolution: 	 convolve: 5.073846 
Total time for convolution: 	 convolve: 5.070659 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 3.550 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.986 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.570 ms

This SCF took 29280.832 ms, scf error = 1.608e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.196757, lowerbound = -1.020215, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 813.187 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.800 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.676 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.494 ms
rank =  0, finding HY took 13.674 ms
rank =  0, distributing HY into block cyclic form took 7.942 ms
rank =  0, finding Y'*HY took 4.467 ms
Rank 0, Project_Hamiltonian used 36.619 ms
Total time for projection: 36.634 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.999274644752950
    last  calculated eigval = 0.071999024756309
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.99927464475295
lambda[   2] =  -0.67407841261694
lambda[   3] =  -0.56427313198340
lambda[   4] =  -0.39919819988053
lambda[   5] =  -0.39068296359018
lambda[   6] =  -0.26645889343605
lambda[   7] =  -0.14926111358204
lambda[   8] =  -0.02255889743843
lambda[   9] =   0.02232894924763
lambda[  10] =   0.03943078607870
lambda[  11] =   0.06495232756348
lambda[  12] =   0.07199902475631
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 2.791 ms
rank =  0, Distributing orbital back into band + domain format took 7.781 ms
rank = 0, Subspace_Rotation used 10.590 ms

Total time for subspace rotation: 10.595 ms
rank = 0, Efermi =  -0.178911883781 calculate fermi energy took 0.076 ms
rank = 0, --- Calculate rho: sum over local bands took 2.697 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.220 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.604 ms
rank = 0, Calculating density took 875.276 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.847 ms
rank = 0, D2D took 1.952 ms
rank = 0, Transfering density took 1.954 ms
Etot    =   -21.882964756604
Eband   =    -6.587932494255
E1      =    14.042454719830
E2      =    -5.926143643502
E3      =    -7.346848116502
Exc     =    -6.564117362101
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 2.611e-03, dEband = 6.339e-02
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -21.882964757, dEtot = 2.611e-03, dEband = 6.339e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 11.8572049010402, which took 0.053 ms

iter_count = 102, r_2norm = 3.698e-04, tol*||rhs|| = 4.743e-04

Anderson update took 54.698 ms, out of which F'*F took 25.316 ms; b-Ax took 173.985 ms, out of which Lap took 156.546 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.963 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161995, int_b + int_rho = -3.092e-13, checking this took 0.103 ms
2-norm of RHS = 498.8492725883196, which took 0.117 ms

iter_count = 300, r_2norm = 4.556e-04, tol*||rhs|| = 4.988e-04

Anderson update took 159.588 ms, out of which F'*F took 74.744 ms; b-Ax took 507.856 ms, out of which Lap took 453.673 ms
Solving Poisson took 1079.328 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.112 ms
Total time for convolution: 	 convolve: 5.073740 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 140.703 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.092409 
Total time for convolution: 	 convolve: 5.077904 
Total time for convolution: 	 convolve: 5.090292 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 3.575 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.961 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.569 ms

This SCF took 26922.059 ms, scf error = 1.130e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.171999, lowerbound = -0.999275, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 814.565 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.892 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.259 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.165 ms
rank =  0, finding HY took 13.804 ms
rank =  0, distributing HY into block cyclic form took 7.993 ms
rank =  0, finding Y'*HY took 2.461 ms
Rank 0, Project_Hamiltonian used 34.448 ms
Total time for projection: 34.460 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -0.958672193183166
    last  calculated eigval = 0.052943961637456
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95867219318317
lambda[   2] =  -0.63105678420189
lambda[   3] =  -0.52125532618721
lambda[   4] =  -0.36758072912585
lambda[   5] =  -0.33866157515287
lambda[   6] =  -0.21745757091941
lambda[   7] =  -0.11439040389150
lambda[   8] =  -0.03755247754494
lambda[   9] =   0.01377623331038
lambda[  10] =   0.02715046220169
lambda[  11] =   0.04854363549906
lambda[  12] =   0.05294396163746
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.188 ms
rank =  0, subspace rotation using ScaLAPACK took 2.845 ms
rank =  0, Distributing orbital back into band + domain format took 7.755 ms
rank = 0, Subspace_Rotation used 10.611 ms

Total time for subspace rotation: 10.616 ms
rank = 0, Efermi =  -0.144041174053 calculate fermi energy took 0.077 ms
rank = 0, --- Calculate rho: sum over local bands took 2.680 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.259 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.560 ms
rank = 0, Calculating density took 874.464 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.816 ms
rank = 0, D2D took 1.913 ms
rank = 0, Transfering density took 1.915 ms
Etot    =   -21.866127604360
Eband   =    -6.069368358870
E1      =    13.611952541832
E2      =    -5.819078753759
E3      =    -7.517775219264
Exc     =    -6.699204380262
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 4.209e-03, dEband = 1.296e-01
rank = 0, Calculating/Estimating energy took 0.972 ms, Etot = -21.866127604, dEtot = 4.209e-03, dEband = 1.296e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.7357324844874, which took 0.070 ms

iter_count = 102, r_2norm = 1.839e-04, tol*||rhs|| = 2.694e-04

Anderson update took 54.682 ms, out of which F'*F took 25.425 ms; b-Ax took 172.297 ms, out of which Lap took 153.658 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.698 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001162000, int_b + int_rho = -2.619e-13, checking this took 0.108 ms
2-norm of RHS = 499.9816143665540, which took 0.161 ms

iter_count = 252, r_2norm = 3.978e-04, tol*||rhs|| = 5.000e-04

Anderson update took 134.184 ms, out of which F'*F took 62.086 ms; b-Ax took 426.124 ms, out of which Lap took 381.060 ms
Solving Poisson took 908.149 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.178177 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.089318 
Total time for convolution: 	 convolve: 5.113474 
Total time for convolution: 	 convolve: 5.085251 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.197 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 3.572 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.962 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.939 ms

This SCF took 26785.371 ms, scf error = 3.193e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.152944, lowerbound = -0.958672, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 817.384 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.731 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.720 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.472 ms
rank =  0, finding HY took 13.828 ms
rank =  0, distributing HY into block cyclic form took 7.758 ms
rank =  0, finding Y'*HY took 2.400 ms
Rank 0, Project_Hamiltonian used 33.499 ms
Total time for projection: 33.513 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -0.963866011808978
    last  calculated eigval = 0.043865940710750
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.96386601180898
lambda[   2] =  -0.63412910043859
lambda[   3] =  -0.52456162162369
lambda[   4] =  -0.37218001723674
lambda[   5] =  -0.34322709706839
lambda[   6] =  -0.22092321310214
lambda[   7] =  -0.11900196197957
lambda[   8] =  -0.04163335781161
lambda[   9] =   0.01118673539242
lambda[  10] =   0.01967518227712
lambda[  11] =   0.03600606572284
lambda[  12] =   0.04386594071075
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 2.779 ms
rank =  0, Distributing orbital back into band + domain format took 7.806 ms
rank = 0, Subspace_Rotation used 10.601 ms

Total time for subspace rotation: 10.607 ms
rank = 0, Efermi =  -0.148652732190 calculate fermi energy took 0.134 ms
rank = 0, --- Calculate rho: sum over local bands took 2.800 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.968 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.688 ms
rank = 0, Calculating density took 877.390 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.956 ms
rank = 0, D2D took 2.059 ms
rank = 0, Transfering density took 2.065 ms
Etot    =   -21.865366124296
Eband   =    -6.117774123940
E1      =    13.670882593939
E2      =    -5.811167471819
E3      =    -7.504217140735
Exc     =    -6.687497826766
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 1.904e-04, dEband = 1.210e-02
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -21.865366124, dEtot = 1.904e-04, dEband = 1.210e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.1489891262477, which took 0.053 ms

iter_count = 114, r_2norm = 3.293e-05, tol*||rhs|| = 4.596e-05

Anderson update took 61.353 ms, out of which F'*F took 28.270 ms; b-Ax took 193.526 ms, out of which Lap took 173.773 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.164 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161994, int_b + int_rho = -3.238e-13, checking this took 0.138 ms
2-norm of RHS = 500.7087570106049, which took 0.067 ms

iter_count = 270, r_2norm = 4.233e-04, tol*||rhs|| = 5.007e-04

Anderson update took 147.470 ms, out of which F'*F took 66.943 ms; b-Ax took 457.888 ms, out of which Lap took 407.834 ms
Solving Poisson took 975.459 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.085279 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 14.443 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.102614 
Total time for convolution: 	 convolve: 5.090544 
Total time for convolution: 	 convolve: 5.100495 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.068 ms
---Transfer Veff_loc: D2D took 4.454 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.483 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.976 ms

This SCF took 26673.302 ms, scf error = 1.748e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.143866, lowerbound = -0.963866, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 812.290 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 7.680 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.778 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.475 ms
rank =  0, finding HY took 13.904 ms
rank =  0, distributing HY into block cyclic form took 7.774 ms
rank =  0, finding Y'*HY took 2.574 ms
Rank 0, Project_Hamiltonian used 33.763 ms
Total time for projection: 33.777 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -0.963102014329434
    last  calculated eigval = 0.038508916080524
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.96310201432943
lambda[   2] =  -0.63148641484311
lambda[   3] =  -0.52205309391564
lambda[   4] =  -0.37206330381661
lambda[   5] =  -0.34051440739504
lambda[   6] =  -0.21770772914620
lambda[   7] =  -0.11853958842595
lambda[   8] =  -0.04340024416049
lambda[   9] =   0.00814914423173
lambda[  10] =   0.01507757215349
lambda[  11] =   0.02727447498369
lambda[  12] =   0.03850891608052
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 2.807 ms
rank =  0, Distributing orbital back into band + domain format took 7.807 ms
rank = 0, Subspace_Rotation used 10.631 ms

Total time for subspace rotation: 10.638 ms
rank = 0, Efermi =  -0.148190358596 calculate fermi energy took 0.971 ms
rank = 0, --- Calculate rho: sum over local bands took 2.904 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.782 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.551 ms
rank = 0, Calculating density took 872.164 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.857 ms
rank = 0, D2D took 1.959 ms
rank = 0, Transfering density took 1.964 ms
Etot    =   -21.864505626304
Eband   =    -6.093853928270
E1      =    13.670937894035
E2      =    -5.784435768609
E3      =    -7.516059897453
Exc     =    -6.695723878049
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 2.151e-04, dEband = 5.980e-03
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -21.864505626, dEtot = 2.151e-04, dEband = 5.980e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6116888045626, which took 0.058 ms

iter_count = 114, r_2norm = 1.864e-05, tol*||rhs|| = 2.447e-05

Anderson update took 60.419 ms, out of which F'*F took 28.550 ms; b-Ax took 193.576 ms, out of which Lap took 173.445 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.535 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161997, int_b + int_rho = -2.947e-13, checking this took 0.106 ms
2-norm of RHS = 500.6725643222367, which took 0.119 ms

iter_count = 240, r_2norm = 4.469e-04, tol*||rhs|| = 5.007e-04

Anderson update took 128.308 ms, out of which F'*F took 60.023 ms; b-Ax took 408.506 ms, out of which Lap took 365.806 ms
Solving Poisson took 863.481 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.111575 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.131075 
Total time for convolution: 	 convolve: 5.094398 
Total time for convolution: 	 convolve: 5.075748 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.589 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.190 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.182 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 3.645 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.242 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.923 ms

This SCF took 26582.886 ms, scf error = 5.793e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.138509, lowerbound = -0.963102, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 814.095 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.798 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.700 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.518 ms
rank =  0, finding HY took 13.825 ms
rank =  0, distributing HY into block cyclic form took 7.675 ms
rank =  0, finding Y'*HY took 2.511 ms
Rank 0, Project_Hamiltonian used 33.555 ms
Total time for projection: 33.568 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.960641864415326
    last  calculated eigval = 0.034827680215415
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.96064186441533
lambda[   2] =  -0.62972241944639
lambda[   3] =  -0.52016352473945
lambda[   4] =  -0.36997252503243
lambda[   5] =  -0.33790919787295
lambda[   6] =  -0.21553716688266
lambda[   7] =  -0.11653818836639
lambda[   8] =  -0.04434294698150
lambda[   9] =   0.00539304576410
lambda[  10] =   0.01252965118359
lambda[  11] =   0.02285787994340
lambda[  12] =   0.03482768021541
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 2.788 ms
rank =  0, Distributing orbital back into band + domain format took 7.763 ms
rank = 0, Subspace_Rotation used 10.567 ms

Total time for subspace rotation: 10.572 ms
rank = 0, Efermi =  -0.146188958577 calculate fermi energy took 0.080 ms
rank = 0, --- Calculate rho: sum over local bands took 2.730 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.191 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.556 ms
rank = 0, Calculating density took 873.063 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.813 ms
rank = 0, D2D took 1.916 ms
rank = 0, Transfering density took 1.919 ms
Etot    =   -21.864434954774
Eband   =    -6.067893398133
E1      =    13.654008517653
E2      =    -5.773829636746
E3      =    -7.522684998880
Exc     =    -6.700703329838
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 1.767e-05, dEband = 6.490e-03
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -21.864434955, dEtot = 1.767e-05, dEband = 6.490e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4664061859533, which took 0.064 ms

iter_count = 108, r_2norm = 1.680e-05, tol*||rhs|| = 1.866e-05

Anderson update took 58.088 ms, out of which F'*F took 26.994 ms; b-Ax took 183.739 ms, out of which Lap took 164.794 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.507 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161996, int_b + int_rho = -2.965e-13, checking this took 0.113 ms
2-norm of RHS = 500.8333694629235, which took 0.134 ms

iter_count = 252, r_2norm = 4.901e-04, tol*||rhs|| = 5.008e-04

Anderson update took 135.442 ms, out of which F'*F took 62.891 ms; b-Ax took 428.483 ms, out of which Lap took 383.104 ms
Solving Poisson took 905.329 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.083878 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 61.522 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.079451 
Total time for convolution: 	 convolve: 5.073562 
Total time for convolution: 	 convolve: 5.075435 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.581 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.131 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.775 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.417 ms
---Transfer Veff_loc: D2D took 3.592 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.000 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.626 ms

This SCF took 26540.633 ms, scf error = 4.138e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.134828, lowerbound = -0.960642, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 814.751 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.874 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.582 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.476 ms
rank =  0, finding HY took 12.915 ms
rank =  0, distributing HY into block cyclic form took 7.724 ms
rank =  0, finding Y'*HY took 2.443 ms
Rank 0, Project_Hamiltonian used 34.595 ms
Total time for projection: 34.607 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.958611140103926
    last  calculated eigval = 0.032401229485285
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95861114010393
lambda[   2] =  -0.62832807568469
lambda[   3] =  -0.51869395790564
lambda[   4] =  -0.36807948023220
lambda[   5] =  -0.33561679501729
lambda[   6] =  -0.21366337223235
lambda[   7] =  -0.11478960816263
lambda[   8] =  -0.04551464961350
lambda[   9] =   0.00366162407398
lambda[  10] =   0.01139441899653
lambda[  11] =   0.02104211983447
lambda[  12] =   0.03240122948528
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.294 ms
rank =  0, subspace rotation using ScaLAPACK took 2.772 ms
rank =  0, Distributing orbital back into band + domain format took 7.669 ms
rank = 0, Subspace_Rotation used 10.458 ms

Total time for subspace rotation: 10.464 ms
rank = 0, Efermi =  -0.144440378331 calculate fermi energy took 0.086 ms
rank = 0, --- Calculate rho: sum over local bands took 2.659 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.267 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.551 ms
rank = 0, Calculating density took 875.741 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.833 ms
rank = 0, D2D took 1.937 ms
rank = 0, Transfering density took 1.939 ms
Etot    =   -21.864300667742
Eband   =    -6.045985643686
E1      =    13.646267932751
E2      =    -5.758392136136
E3      =    -7.526590150399
Exc     =    -6.703203863260
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 3.357e-05, dEband = 5.477e-03
rank = 0, Calculating/Estimating energy took 1.297 ms, Etot = -21.864300668, dEtot = 3.357e-05, dEband = 5.477e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2644942650037, which took 0.052 ms

iter_count = 108, r_2norm = 1.003e-05, tol*||rhs|| = 1.058e-05

Anderson update took 58.654 ms, out of which F'*F took 27.036 ms; b-Ax took 182.099 ms, out of which Lap took 163.703 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.666 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161993, int_b + int_rho = -3.292e-13, checking this took 0.123 ms
2-norm of RHS = 500.7420881067033, which took 0.118 ms

iter_count = 240, r_2norm = 4.368e-04, tol*||rhs|| = 5.007e-04

Anderson update took 128.391 ms, out of which F'*F took 60.036 ms; b-Ax took 419.753 ms, out of which Lap took 377.959 ms
Solving Poisson took 875.435 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.089337 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 88.964 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.085271 
Total time for convolution: 	 convolve: 5.139327 
Total time for convolution: 	 convolve: 5.108765 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.670 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.148 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.423 ms
---Transfer Veff_loc: D2D took 3.575 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.013 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.623 ms

This SCF took 26886.953 ms, scf error = 2.249e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.132401, lowerbound = -0.958611, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 812.330 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.768 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.724 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.511 ms
rank =  0, finding HY took 13.856 ms
rank =  0, distributing HY into block cyclic form took 7.788 ms
rank =  0, finding Y'*HY took 2.435 ms
Rank 0, Project_Hamiltonian used 33.615 ms
Total time for projection: 33.628 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.956690448158878
    last  calculated eigval = 0.030959036211075
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95669044815888
lambda[   2] =  -0.62653241607520
lambda[   3] =  -0.51697905770779
lambda[   4] =  -0.36610601409284
lambda[   5] =  -0.33324020100896
lambda[   6] =  -0.21156210936761
lambda[   7] =  -0.11277977733833
lambda[   8] =  -0.04539210020351
lambda[   9] =   0.00241541566857
lambda[  10] =   0.01113426383262
lambda[  11] =   0.02055654413181
lambda[  12] =   0.03095903621107
==subpsace eigenproblem: bcast eigvals took 0.036 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 2.785 ms
rank =  0, Distributing orbital back into band + domain format took 7.797 ms
rank = 0, Subspace_Rotation used 10.597 ms

Total time for subspace rotation: 10.603 ms
rank = 0, Efermi =  -0.142430547502 calculate fermi energy took 0.073 ms
rank = 0, --- Calculate rho: sum over local bands took 2.697 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.158 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.559 ms
rank = 0, Calculating density took 871.324 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.808 ms
rank = 0, D2D took 2.759 ms
rank = 0, Transfering density took 2.762 ms
Etot    =   -21.864411408505
Eband   =    -6.022220494133
E1      =    13.631593054841
E2      =    -5.748174033333
E3      =    -7.530910476760
Exc     =    -6.706507099224
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 2.769e-05, dEband = 5.941e-03
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -21.864411409, dEtot = 2.769e-05, dEband = 5.941e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1347593615070, which took 0.060 ms

iter_count = 114, r_2norm = 3.772e-06, tol*||rhs|| = 5.390e-06

Anderson update took 61.951 ms, out of which F'*F took 29.068 ms; b-Ax took 192.917 ms, out of which Lap took 173.485 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.979 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161998, int_b + int_rho = -2.838e-13, checking this took 0.099 ms
2-norm of RHS = 500.8123502374200, which took 0.157 ms

iter_count = 216, r_2norm = 4.627e-04, tol*||rhs|| = 5.008e-04

Anderson update took 116.087 ms, out of which F'*F took 54.240 ms; b-Ax took 365.961 ms, out of which Lap took 328.736 ms
Solving Poisson took 775.752 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Total time for convolution: 	 convolve: 5.102125 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.960 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.083235 
Total time for convolution: 	 convolve: 5.084976 
Total time for convolution: 	 convolve: 5.077993 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.498 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.001 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.535 ms

This SCF took 26468.843 ms, scf error = 1.607e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.130959, lowerbound = -0.956690, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 814.108 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.852 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.679 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.550 ms
rank =  0, finding HY took 13.817 ms
rank =  0, distributing HY into block cyclic form took 7.624 ms
rank =  0, finding Y'*HY took 2.429 ms
Rank 0, Project_Hamiltonian used 33.444 ms
Total time for projection: 33.457 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.165 ms
    first calculated eigval = -0.956726163644176
    last  calculated eigval = 0.030681812878783
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95672616364418
lambda[   2] =  -0.62636202552466
lambda[   3] =  -0.51686855467370
lambda[   4] =  -0.36597933055730
lambda[   5] =  -0.33326214980295
lambda[   6] =  -0.21148130850006
lambda[   7] =  -0.11265424169447
lambda[   8] =  -0.04403633756829
lambda[   9] =   0.00264038334920
lambda[  10] =   0.01168071104099
lambda[  11] =   0.02134228182820
lambda[  12] =   0.03068181287878
==subpsace eigenproblem: bcast eigvals took 0.049 ms
Total time for solving subspace eigenvalue problem: 0.225 ms
rank =  0, subspace rotation using ScaLAPACK took 2.780 ms
rank =  0, Distributing orbital back into band + domain format took 7.769 ms
rank = 0, Subspace_Rotation used 10.566 ms

Total time for subspace rotation: 10.573 ms
rank = 0, Efermi =  -0.142305011855 calculate fermi energy took 0.073 ms
rank = 0, --- Calculate rho: sum over local bands took 2.760 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.038 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.585 ms
rank = 0, Calculating density took 872.930 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.852 ms
rank = 0, D2D took 1.943 ms
rank = 0, Transfering density took 1.946 ms
Etot    =   -21.864494714804
Eband   =    -6.021359066715
E1      =    13.634376867316
E2      =    -5.744761777642
E3      =    -7.529286506417
Exc     =    -6.705199419382
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 2.083e-05, dEband = 2.154e-04
rank = 0, Calculating/Estimating energy took 0.939 ms, Etot = -21.864494715, dEtot = 2.083e-05, dEband = 2.154e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1143815114077, which took 0.073 ms

iter_count = 108, r_2norm = 3.465e-06, tol*||rhs|| = 4.575e-06

Anderson update took 58.517 ms, out of which F'*F took 27.587 ms; b-Ax took 183.649 ms, out of which Lap took 165.156 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.754 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161996, int_b + int_rho = -3.001e-13, checking this took 0.113 ms
2-norm of RHS = 500.8132923994625, which took 0.161 ms

iter_count = 216, r_2norm = 4.888e-04, tol*||rhs|| = 5.008e-04

Anderson update took 116.121 ms, out of which F'*F took 53.648 ms; b-Ax took 365.300 ms, out of which Lap took 327.071 ms
Solving Poisson took 777.313 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.084505 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 58.924 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.110317 
Total time for convolution: 	 convolve: 5.082973 
Total time for convolution: 	 convolve: 5.111184 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.572 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.096 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 3.558 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.014 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.607 ms

This SCF took 26484.940 ms, scf error = 1.090e-03
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.130682, lowerbound = -0.956726, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 811.583 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.789 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.686 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.493 ms
rank =  0, finding HY took 13.853 ms
rank =  0, distributing HY into block cyclic form took 7.714 ms
rank =  0, finding Y'*HY took 2.480 ms
Rank 0, Project_Hamiltonian used 33.564 ms
Total time for projection: 33.577 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.954991914016722
    last  calculated eigval = 0.031526501250060
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95499191401672
lambda[   2] =  -0.62484054768073
lambda[   3] =  -0.51529837458911
lambda[   4] =  -0.36441565703789
lambda[   5] =  -0.33173835944410
lambda[   6] =  -0.21001304905437
lambda[   7] =  -0.11113276252353
lambda[   8] =  -0.03969853704517
lambda[   9] =   0.00354540025911
lambda[  10] =   0.01484586344208
lambda[  11] =   0.02532820657468
lambda[  12] =   0.03152650125006
==subpsace eigenproblem: bcast eigvals took 0.069 ms
Total time for solving subspace eigenvalue problem: 0.260 ms
rank =  0, subspace rotation using ScaLAPACK took 2.819 ms
rank =  0, Distributing orbital back into band + domain format took 7.719 ms
rank = 0, Subspace_Rotation used 10.552 ms

Total time for subspace rotation: 10.559 ms
rank = 0, Efermi =  -0.140783532725 calculate fermi energy took 0.080 ms
rank = 0, --- Calculate rho: sum over local bands took 2.712 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.174 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.558 ms
rank = 0, Calculating density took 870.605 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.820 ms
rank = 0, D2D took 1.913 ms
rank = 0, Transfering density took 1.915 ms
Etot    =   -21.864548746759
Eband   =    -6.002595804937
E1      =    13.624237863175
E2      =    -5.735591944169
E3      =    -7.531683888204
Exc     =    -6.707105257287
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 1.351e-05, dEband = 4.691e-03
rank = 0, Calculating/Estimating energy took 0.945 ms, Etot = -21.864548747, dEtot = 1.351e-05, dEband = 4.691e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0802228646111, which took 0.068 ms

iter_count = 108, r_2norm = 2.931e-06, tol*||rhs|| = 3.209e-06

Anderson update took 58.399 ms, out of which F'*F took 27.700 ms; b-Ax took 183.790 ms, out of which Lap took 165.730 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.844 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161993, int_b + int_rho = -3.274e-13, checking this took 0.096 ms
2-norm of RHS = 500.8130735197827, which took 0.154 ms

iter_count = 180, r_2norm = 4.919e-04, tol*||rhs|| = 5.008e-04

Anderson update took 96.776 ms, out of which F'*F took 45.307 ms; b-Ax took 305.454 ms, out of which Lap took 274.519 ms
Solving Poisson took 648.155 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.081460 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 63.825 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.094554 
Total time for convolution: 	 convolve: 5.086724 
Total time for convolution: 	 convolve: 5.080947 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.778 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.507 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.989 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.532 ms

This SCF took 26313.264 ms, scf error = 5.956e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.131527, lowerbound = -0.954992, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 813.997 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.719 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.793 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.531 ms
rank =  0, finding HY took 13.812 ms
rank =  0, distributing HY into block cyclic form took 7.699 ms
rank =  0, finding Y'*HY took 2.456 ms
Rank 0, Project_Hamiltonian used 33.522 ms
Total time for projection: 33.535 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -0.954517056214762
    last  calculated eigval = 0.032229163839373
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95451705621476
lambda[   2] =  -0.62442934377958
lambda[   3] =  -0.51487970034775
lambda[   4] =  -0.36396100559003
lambda[   5] =  -0.33132206216869
lambda[   6] =  -0.20961659868860
lambda[   7] =  -0.11069798515155
lambda[   8] =  -0.03768012148659
lambda[   9] =   0.00374901646421
lambda[  10] =   0.01574174488239
lambda[  11] =   0.02717754728422
lambda[  12] =   0.03222916383937
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 2.792 ms
rank =  0, Distributing orbital back into band + domain format took 8.277 ms
rank = 0, Subspace_Rotation used 11.894 ms

Total time for subspace rotation: 11.900 ms
rank = 0, Efermi =  -0.140348755339 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 2.793 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.023 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.597 ms
rank = 0, Calculating density took 874.187 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.858 ms
rank = 0, D2D took 1.960 ms
rank = 0, Transfering density took 1.966 ms
Etot    =   -21.864571865321
Eband   =    -5.997451534865
E1      =    13.621537572799
E2      =    -5.733029755688
E3      =    -7.532180538167
Exc     =    -6.707506817027
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 5.780e-06, dEband = 1.286e-03
rank = 0, Calculating/Estimating energy took 0.963 ms, Etot = -21.864571865, dEtot = 5.780e-06, dEband = 1.286e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0528370314577, which took 0.059 ms

iter_count = 108, r_2norm = 1.482e-06, tol*||rhs|| = 2.113e-06

Anderson update took 58.100 ms, out of which F'*F took 27.484 ms; b-Ax took 183.756 ms, out of which Lap took 164.942 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.607 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161995, int_b + int_rho = -3.092e-13, checking this took 0.122 ms
2-norm of RHS = 500.8342381952767, which took 0.139 ms

iter_count = 198, r_2norm = 4.473e-04, tol*||rhs|| = 5.008e-04

Anderson update took 105.831 ms, out of which F'*F took 49.472 ms; b-Ax took 337.286 ms, out of which Lap took 301.980 ms
Solving Poisson took 713.050 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.094333 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 78.504 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.082127 
Total time for convolution: 	 convolve: 5.095145 
Total time for convolution: 	 convolve: 5.075596 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
---Transfer Veff_loc: D2D took 3.562 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.245 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.845 ms

This SCF took 26419.296 ms, scf error = 4.669e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132229, lowerbound = -0.954517, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 814.037 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.835 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.684 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.538 ms
rank =  0, finding HY took 13.890 ms
rank =  0, distributing HY into block cyclic form took 7.702 ms
rank =  0, finding Y'*HY took 2.482 ms
Rank 0, Project_Hamiltonian used 33.637 ms
Total time for projection: 33.651 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -0.953942159289646
    last  calculated eigval = 0.035008206161055
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95394215928965
lambda[   2] =  -0.62378876476781
lambda[   3] =  -0.51427341641122
lambda[   4] =  -0.36334118779765
lambda[   5] =  -0.33068400679704
lambda[   6] =  -0.20897079698774
lambda[   7] =  -0.11012255788414
lambda[   8] =  -0.03408065214206
lambda[   9] =   0.00392898233708
lambda[  10] =   0.01808990744942
lambda[  11] =   0.03074678200557
lambda[  12] =   0.03500820616106
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 2.688 ms
rank =  0, Distributing orbital back into band + domain format took 8.095 ms
rank = 0, Subspace_Rotation used 10.799 ms

Total time for subspace rotation: 10.805 ms
rank = 0, Efermi =  -0.139773328100 calculate fermi energy took 0.078 ms
rank = 0, --- Calculate rho: sum over local bands took 2.687 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.164 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 873.285 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.828 ms
rank = 0, D2D took 1.921 ms
rank = 0, Transfering density took 1.923 ms
Etot    =   -21.864649713990
Eband   =    -5.990000665382
E1      =    13.618355263196
E2      =    -5.728583962524
E3      =    -7.532656903327
Exc     =    -6.707883797573
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 1.946e-05, dEband = 1.863e-03
rank = 0, Calculating/Estimating energy took 0.942 ms, Etot = -21.864649714, dEtot = 1.946e-05, dEband = 1.863e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0534239106952, which took 0.052 ms

iter_count = 108, r_2norm = 1.647e-06, tol*||rhs|| = 2.137e-06

Anderson update took 58.790 ms, out of which F'*F took 27.524 ms; b-Ax took 183.051 ms, out of which Lap took 164.517 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.183 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161995, int_b + int_rho = -3.129e-13, checking this took 0.102 ms
2-norm of RHS = 500.8254377564083, which took 0.169 ms

iter_count = 138, r_2norm = 4.702e-04, tol*||rhs|| = 5.008e-04

Anderson update took 73.831 ms, out of which F'*F took 34.940 ms; b-Ax took 233.706 ms, out of which Lap took 210.284 ms
Solving Poisson took 496.583 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.081466 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 258.700 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.080757 
Total time for convolution: 	 convolve: 5.079067 
Total time for convolution: 	 convolve: 5.091205 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.518 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.993 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.545 ms

This SCF took 26373.433 ms, scf error = 3.691e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.135008, lowerbound = -0.953942, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 811.811 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.781 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.770 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.570 ms
rank =  0, finding HY took 13.811 ms
rank =  0, distributing HY into block cyclic form took 7.713 ms
rank =  0, finding Y'*HY took 2.470 ms
Rank 0, Project_Hamiltonian used 33.592 ms
Total time for projection: 33.604 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -0.953791833271880
    last  calculated eigval = 0.035462226556804
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95379183327188
lambda[   2] =  -0.62366061251123
lambda[   3] =  -0.51414212831222
lambda[   4] =  -0.36320108048322
lambda[   5] =  -0.33052951633944
lambda[   6] =  -0.20882947143389
lambda[   7] =  -0.10998459995828
lambda[   8] =  -0.03351629538407
lambda[   9] =   0.00396510600778
lambda[  10] =   0.01829797857651
lambda[  11] =   0.03103613968589
lambda[  12] =   0.03546222655680
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 3.069 ms
rank =  0, Distributing orbital back into band + domain format took 7.600 ms
rank = 0, Subspace_Rotation used 10.681 ms

Total time for subspace rotation: 10.689 ms
rank = 0, Efermi =  -0.139635370167 calculate fermi energy took 0.094 ms
rank = 0, --- Calculate rho: sum over local bands took 2.695 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.158 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 871.355 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.842 ms
rank = 0, D2D took 1.944 ms
rank = 0, Transfering density took 1.946 ms
Etot    =   -21.864653583937
Eband   =    -5.988309285982
E1      =    13.617239019565
E2      =    -5.727958512846
E3      =    -7.532921041447
Exc     =    -6.708101491731
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 9.675e-07, dEband = 4.228e-04
rank = 0, Calculating/Estimating energy took 0.941 ms, Etot = -21.864653584, dEtot = 9.675e-07, dEband = 4.228e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0513784955143, which took 0.051 ms

iter_count = 108, r_2norm = 1.571e-06, tol*||rhs|| = 2.055e-06

Anderson update took 58.193 ms, out of which F'*F took 27.425 ms; b-Ax took 183.551 ms, out of which Lap took 164.773 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.521 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161999, int_b + int_rho = -2.728e-13, checking this took 0.105 ms
2-norm of RHS = 500.8222294587678, which took 0.123 ms

iter_count = 150, r_2norm = 4.270e-04, tol*||rhs|| = 5.008e-04

Anderson update took 80.580 ms, out of which F'*F took 37.471 ms; b-Ax took 254.389 ms, out of which Lap took 227.822 ms
Solving Poisson took 540.590 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.080584 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 86.717 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.086352 
Total time for convolution: 	 convolve: 5.082139 
Total time for convolution: 	 convolve: 5.102964 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.755 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.568 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
---Transfer Veff_loc: D2D took 3.536 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.226 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.797 ms

This SCF took 26251.942 ms, scf error = 2.688e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135462, lowerbound = -0.953792, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 813.545 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.850 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.666 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.532 ms
rank =  0, finding HY took 13.938 ms
rank =  0, distributing HY into block cyclic form took 7.689 ms
rank =  0, finding Y'*HY took 2.487 ms
Rank 0, Project_Hamiltonian used 33.672 ms
Total time for projection: 33.685 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.566 ms
    first calculated eigval = -0.953611511043759
    last  calculated eigval = 0.037074557604637
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95361151104376
lambda[   2] =  -0.62350123731435
lambda[   3] =  -0.51397887385754
lambda[   4] =  -0.36303191658819
lambda[   5] =  -0.33035525415243
lambda[   6] =  -0.20866739313656
lambda[   7] =  -0.10983380440912
lambda[   8] =  -0.03354940206673
lambda[   9] =   0.00421770063852
lambda[  10] =   0.01830824260656
lambda[  11] =   0.03132953007734
lambda[  12] =   0.03707455760464
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.586 ms
rank =  0, subspace rotation using ScaLAPACK took 3.060 ms
rank =  0, Distributing orbital back into band + domain format took 7.659 ms
rank = 0, Subspace_Rotation used 10.733 ms

Total time for subspace rotation: 10.740 ms
rank = 0, Efermi =  -0.139484574600 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 2.769 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.114 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.536 ms
rank = 0, Calculating density took 873.107 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.829 ms
rank = 0, D2D took 1.922 ms
rank = 0, Transfering density took 1.924 ms
Etot    =   -21.864681769309
Eband   =    -5.986292373462
E1      =    13.616169403474
E2      =    -5.726957723323
E3      =    -7.533073224870
Exc     =    -6.708228367432
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 7.046e-06, dEband = 5.042e-04
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -21.864681769, dEtot = 7.046e-06, dEband = 5.042e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0424617160703, which took 0.055 ms

iter_count = 108, r_2norm = 1.389e-06, tol*||rhs|| = 1.698e-06

Anderson update took 58.014 ms, out of which F'*F took 27.421 ms; b-Ax took 183.273 ms, out of which Lap took 164.389 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.414 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161996, int_b + int_rho = -3.038e-13, checking this took 0.101 ms
2-norm of RHS = 500.8205669074172, which took 0.099 ms

iter_count = 144, r_2norm = 4.620e-04, tol*||rhs|| = 5.008e-04

Anderson update took 77.204 ms, out of which F'*F took 36.338 ms; b-Ax took 245.165 ms, out of which Lap took 220.111 ms
Solving Poisson took 520.316 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.076407 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 106.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.082091 
Total time for convolution: 	 convolve: 5.089000 
Total time for convolution: 	 convolve: 5.080820 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.276 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 3.546 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.232 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.813 ms

This SCF took 26232.635 ms, scf error = 2.241e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.137075, lowerbound = -0.953612, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 823.877 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.717 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.761 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.495 ms
rank =  0, finding HY took 13.826 ms
rank =  0, distributing HY into block cyclic form took 7.787 ms
rank =  0, finding Y'*HY took 2.467 ms
Rank 0, Project_Hamiltonian used 33.602 ms
Total time for projection: 34.034 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.597 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.692 ms
    first calculated eigval = -0.953531543791656
    last  calculated eigval = 0.038977237097181
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95353154379166
lambda[   2] =  -0.62342336679702
lambda[   3] =  -0.51390140016976
lambda[   4] =  -0.36295132516191
lambda[   5] =  -0.33027543011182
lambda[   6] =  -0.20859315817299
lambda[   7] =  -0.10976430621302
lambda[   8] =  -0.03370975983562
lambda[   9] =   0.00471252387283
lambda[  10] =   0.01807730900977
lambda[  11] =   0.03179841015233
lambda[  12] =   0.03897723709718
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.721 ms
rank =  0, subspace rotation using ScaLAPACK took 2.819 ms
rank =  0, Distributing orbital back into band + domain format took 7.803 ms
rank = 0, Subspace_Rotation used 10.636 ms

Total time for subspace rotation: 10.643 ms
rank = 0, Efermi =  -0.139415076419 calculate fermi energy took 0.084 ms
rank = 0, --- Calculate rho: sum over local bands took 2.723 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.181 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.572 ms
rank = 0, Calculating density took 883.903 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.815 ms
rank = 0, D2D took 1.917 ms
rank = 0, Transfering density took 1.919 ms
Etot    =   -21.864702579975
Eband   =    -5.985352449686
E1      =    13.615729155138
E2      =    -5.726445140788
E3      =    -7.533059933971
Exc     =    -6.708222980104
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 5.203e-06, dEband = 2.350e-04
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -21.864702580, dEtot = 5.203e-06, dEband = 2.350e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0332058574167, which took 0.079 ms

iter_count = 108, r_2norm = 1.137e-06, tol*||rhs|| = 1.328e-06

Anderson update took 58.273 ms, out of which F'*F took 27.413 ms; b-Ax took 186.830 ms, out of which Lap took 168.029 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.741 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161995, int_b + int_rho = -3.074e-13, checking this took 0.106 ms
2-norm of RHS = 500.8272417877133, which took 0.129 ms

iter_count = 162, r_2norm = 4.329e-04, tol*||rhs|| = 5.008e-04

Anderson update took 86.711 ms, out of which F'*F took 40.364 ms; b-Ax took 274.484 ms, out of which Lap took 245.905 ms
Solving Poisson took 584.449 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.079097 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 62.251 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.221 ms
Total time for convolution: 	 convolve: 5.084546 
Total time for convolution: 	 convolve: 5.076649 
Total time for convolution: 	 convolve: 5.082871 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.548 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.005 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.590 ms

This SCF took 26262.420 ms, scf error = 2.042e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.138977, lowerbound = -0.953532, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 812.469 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.782 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.703 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.502 ms
rank =  0, finding HY took 13.820 ms
rank =  0, distributing HY into block cyclic form took 7.694 ms
rank =  0, finding Y'*HY took 2.495 ms
Rank 0, Project_Hamiltonian used 34.479 ms
Total time for projection: 34.494 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.953765301279226
    last  calculated eigval = 0.040212148802279
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95376530127923
lambda[   2] =  -0.62358936456595
lambda[   3] =  -0.51408114158645
lambda[   4] =  -0.36314288623383
lambda[   5] =  -0.33047759330382
lambda[   6] =  -0.20876994934170
lambda[   7] =  -0.10996087374736
lambda[   8] =  -0.03395971961556
lambda[   9] =   0.00560932345233
lambda[  10] =   0.01746743764080
lambda[  11] =   0.03169856226682
lambda[  12] =   0.04021214880228
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 2.710 ms
rank =  0, Distributing orbital back into band + domain format took 7.945 ms
rank = 0, Subspace_Rotation used 10.672 ms

Total time for subspace rotation: 10.678 ms
rank = 0, Efermi =  -0.139611643919 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 2.728 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.629 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.624 ms
rank = 0, Calculating density took 872.969 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.961 ms
rank = 0, D2D took 2.069 ms
rank = 0, Transfering density took 2.078 ms
Etot    =   -21.864711274197
Eband   =    -5.987652473900
E1      =    13.617365675020
E2      =    -5.727251822294
E3      =    -7.532414199871
Exc     =    -6.707729117400
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 2.174e-06, dEband = 5.750e-04
rank = 0, Calculating/Estimating energy took 0.901 ms, Etot = -21.864711274, dEtot = 2.174e-06, dEband = 5.750e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0287188341135, which took 0.078 ms

iter_count = 108, r_2norm = 9.445e-07, tol*||rhs|| = 1.149e-06

Anderson update took 58.358 ms, out of which F'*F took 27.326 ms; b-Ax took 183.355 ms, out of which Lap took 164.609 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.555 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161994, int_b + int_rho = -3.256e-13, checking this took 0.108 ms
2-norm of RHS = 500.8329149581738, which took 0.128 ms

iter_count = 138, r_2norm = 4.996e-04, tol*||rhs|| = 5.008e-04

Anderson update took 74.248 ms, out of which F'*F took 34.847 ms; b-Ax took 234.890 ms, out of which Lap took 210.940 ms
Solving Poisson took 499.007 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.096413 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 48.883 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.078620 
Total time for convolution: 	 convolve: 5.081384 
Total time for convolution: 	 convolve: 5.078803 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.554 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.236 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.827 ms

This SCF took 26164.018 ms, scf error = 3.476e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.140212, lowerbound = -0.953765, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 813.101 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.141 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.686 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.847 ms
rank =  0, finding HY took 13.819 ms
rank =  0, distributing HY into block cyclic form took 7.709 ms
rank =  0, finding Y'*HY took 2.463 ms
Rank 0, Project_Hamiltonian used 34.276 ms
Total time for projection: 34.288 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.168 ms
    first calculated eigval = -0.953764506962337
    last  calculated eigval = 0.039289103074015
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95376450696234
lambda[   2] =  -0.62357568376956
lambda[   3] =  -0.51407316321254
lambda[   4] =  -0.36313038406886
lambda[   5] =  -0.33045977231718
lambda[   6] =  -0.20874908713687
lambda[   7] =  -0.10994051498653
lambda[   8] =  -0.03398043775981
lambda[   9] =   0.00497179667754
lambda[  10] =   0.01743420567250
lambda[  11] =   0.03139289982447
lambda[  12] =   0.03928910307402
==subpsace eigenproblem: bcast eigvals took 0.036 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 2.805 ms
rank =  0, Distributing orbital back into band + domain format took 7.663 ms
rank = 0, Subspace_Rotation used 10.483 ms

Total time for subspace rotation: 10.489 ms
rank = 0, Efermi =  -0.139591285219 calculate fermi energy took 0.083 ms
rank = 0, --- Calculate rho: sum over local bands took 2.719 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.122 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.555 ms
rank = 0, Calculating density took 872.635 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.813 ms
rank = 0, D2D took 1.905 ms
rank = 0, Transfering density took 1.906 ms
Etot    =   -21.864709081915
Eband   =    -5.987505196212
E1      =    13.617467333912
E2      =    -5.726981188631
E3      =    -7.532451753405
Exc     =    -6.707742781569
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 5.481e-07, dEband = 3.682e-05
rank = 0, Calculating/Estimating energy took 0.936 ms, Etot = -21.864709082, dEtot = 5.481e-07, dEband = 3.682e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0320143775486, which took 0.062 ms

iter_count = 108, r_2norm = 1.012e-06, tol*||rhs|| = 1.281e-06

Anderson update took 58.395 ms, out of which F'*F took 27.597 ms; b-Ax took 183.969 ms, out of which Lap took 165.221 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.335 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161998, int_b + int_rho = -2.819e-13, checking this took 0.108 ms
2-norm of RHS = 500.8225900516746, which took 0.137 ms

iter_count = 144, r_2norm = 4.646e-04, tol*||rhs|| = 5.008e-04

Anderson update took 77.170 ms, out of which F'*F took 35.995 ms; b-Ax took 244.120 ms, out of which Lap took 218.856 ms
Solving Poisson took 520.291 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.153 ms
Total time for convolution: 	 convolve: 5.077436 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 61.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.098367 
Total time for convolution: 	 convolve: 5.095156 
Total time for convolution: 	 convolve: 5.079163 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.503 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.018 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.563 ms

This SCF took 26341.441 ms, scf error = 4.181e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.139289, lowerbound = -0.953765, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 809.185 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.822 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.704 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.542 ms
rank =  0, finding HY took 13.821 ms
rank =  0, distributing HY into block cyclic form took 7.683 ms
rank =  0, finding Y'*HY took 2.503 ms
Rank 0, Project_Hamiltonian used 33.577 ms
Total time for projection: 33.591 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.953572824667192
    last  calculated eigval = 0.038631449423682
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95357282466719
lambda[   2] =  -0.62345048810035
lambda[   3] =  -0.51393333601720
lambda[   4] =  -0.36298578882302
lambda[   5] =  -0.33032099629941
lambda[   6] =  -0.20863633494028
lambda[   7] =  -0.10981657420106
lambda[   8] =  -0.03496781276371
lambda[   9] =   0.00475769922426
lambda[  10] =   0.01640266086949
lambda[  11] =   0.03029852022848
lambda[  12] =   0.03863144942368
==subpsace eigenproblem: bcast eigvals took 0.038 ms
Total time for solving subspace eigenvalue problem: 0.218 ms
rank =  0, subspace rotation using ScaLAPACK took 2.795 ms
rank =  0, Distributing orbital back into band + domain format took 7.745 ms
rank = 0, Subspace_Rotation used 10.556 ms

Total time for subspace rotation: 10.562 ms
rank = 0, Efermi =  -0.139467344360 calculate fermi energy took 0.117 ms
rank = 0, --- Calculate rho: sum over local bands took 2.776 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.033 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 868.142 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.837 ms
rank = 0, D2D took 1.939 ms
rank = 0, Transfering density took 1.940 ms
Etot    =   -21.864714964056
Eband   =    -5.985799538971
E1      =    13.616024109212
E2      =    -5.726606912647
E3      =    -7.532922020681
Exc     =    -6.708107087541
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 1.471e-06, dEband = 4.264e-04
rank = 0, Calculating/Estimating energy took 0.931 ms, Etot = -21.864714964, dEtot = 1.471e-06, dEband = 4.264e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0308831009374, which took 0.056 ms

iter_count = 108, r_2norm = 9.750e-07, tol*||rhs|| = 1.235e-06

Anderson update took 58.167 ms, out of which F'*F took 27.442 ms; b-Ax took 183.337 ms, out of which Lap took 164.476 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.476 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161995, int_b + int_rho = -3.147e-13, checking this took 0.124 ms
2-norm of RHS = 500.8221031464897, which took 0.135 ms

iter_count = 132, r_2norm = 4.643e-04, tol*||rhs|| = 5.008e-04

Anderson update took 70.905 ms, out of which F'*F took 33.200 ms; b-Ax took 224.012 ms, out of which Lap took 201.239 ms
Solving Poisson took 477.071 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.082545 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 65.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.095738 
Total time for convolution: 	 convolve: 5.081030 
Total time for convolution: 	 convolve: 5.077819 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.565 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.669 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.769 ms

This SCF took 26145.069 ms, scf error = 1.909e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.138631, lowerbound = -0.953573, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 813.444 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.790 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.761 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.569 ms
rank =  0, finding HY took 13.832 ms
rank =  0, distributing HY into block cyclic form took 7.818 ms
rank =  0, finding Y'*HY took 2.457 ms
Rank 0, Project_Hamiltonian used 33.704 ms
Total time for projection: 33.715 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.953484229730665
    last  calculated eigval = 0.038629147002901
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95348422973067
lambda[   2] =  -0.62337166975291
lambda[   3] =  -0.51385218479104
lambda[   4] =  -0.36291199824314
lambda[   5] =  -0.33025425498025
lambda[   6] =  -0.20857296833098
lambda[   7] =  -0.10975485354345
lambda[   8] =  -0.03574376598934
lambda[   9] =   0.00496589583905
lambda[  10] =   0.01585881557255
lambda[  11] =   0.02944020385700
lambda[  12] =   0.03862914700290
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 2.759 ms
rank =  0, Distributing orbital back into band + domain format took 7.828 ms
rank = 0, Subspace_Rotation used 10.605 ms

Total time for subspace rotation: 10.612 ms
rank = 0, Efermi =  -0.139405623747 calculate fermi energy took 0.075 ms
rank = 0, --- Calculate rho: sum over local bands took 2.701 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.127 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 872.527 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.836 ms
rank = 0, D2D took 1.939 ms
rank = 0, Transfering density took 1.941 ms
Etot    =   -21.864723957669
Eband   =    -5.984894612933
E1      =    13.615465171595
E2      =    -5.726220853425
E3      =    -7.533054839344
Exc     =    -6.708208829018
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 2.248e-06, dEband = 2.262e-04
rank = 0, Calculating/Estimating energy took 0.986 ms, Etot = -21.864723958, dEtot = 2.248e-06, dEband = 2.262e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0389515560648, which took 0.055 ms

iter_count = 102, r_2norm = 1.323e-06, tol*||rhs|| = 1.558e-06

Anderson update took 55.112 ms, out of which F'*F took 25.915 ms; b-Ax took 174.749 ms, out of which Lap took 157.078 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.317 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161998, int_b + int_rho = -2.747e-13, checking this took 0.116 ms
2-norm of RHS = 500.8274489544346, which took 0.134 ms

iter_count = 150, r_2norm = 4.168e-04, tol*||rhs|| = 5.008e-04

Anderson update took 80.328 ms, out of which F'*F took 37.428 ms; b-Ax took 259.654 ms, out of which Lap took 233.416 ms
Solving Poisson took 546.309 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.851 ms
Total time for convolution: 	 convolve: 5.092248 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 61.438 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.108232 
Total time for convolution: 	 convolve: 5.079965 
Total time for convolution: 	 convolve: 5.076464 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.833 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.044 ms
---Transfer Veff_loc: D2D took 4.292 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.991 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.319 ms

This SCF took 26244.794 ms, scf error = 1.473e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.138629, lowerbound = -0.953484, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 812.085 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.768 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.707 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.496 ms
rank =  0, finding HY took 13.843 ms
rank =  0, distributing HY into block cyclic form took 7.748 ms
rank =  0, finding Y'*HY took 2.504 ms
Rank 0, Project_Hamiltonian used 33.616 ms
Total time for projection: 33.628 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.953512292614265
    last  calculated eigval = 0.037820472538907
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95351229261427
lambda[   2] =  -0.62337238631809
lambda[   3] =  -0.51385735367858
lambda[   4] =  -0.36293794163156
lambda[   5] =  -0.33029205914566
lambda[   6] =  -0.20859772784695
lambda[   7] =  -0.10977949532638
lambda[   8] =  -0.03669455746156
lambda[   9] =   0.00518131130759
lambda[  10] =   0.01509089712128
lambda[  11] =   0.02838217846892
lambda[  12] =   0.03782047253891
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 2.764 ms
rank =  0, Distributing orbital back into band + domain format took 7.694 ms
rank = 0, Subspace_Rotation used 10.473 ms

Total time for subspace rotation: 10.480 ms
rank = 0, Efermi =  -0.139430265486 calculate fermi energy took 0.075 ms
rank = 0, --- Calculate rho: sum over local bands took 2.726 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.137 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 870.977 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.823 ms
rank = 0, D2D took 1.927 ms
rank = 0, Transfering density took 1.929 ms
Etot    =   -21.864726106503
Eband   =    -5.985139523746
E1      =    13.615741878558
E2      =    -5.726206261488
E3      =    -7.532939774425
Exc     =    -6.708113117145
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 5.372e-07, dEband = 6.123e-05
rank = 0, Calculating/Estimating energy took 0.957 ms, Etot = -21.864726107, dEtot = 5.372e-07, dEband = 6.123e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0369535794396, which took 0.065 ms

iter_count = 102, r_2norm = 1.323e-06, tol*||rhs|| = 1.478e-06

Anderson update took 54.699 ms, out of which F'*F took 25.845 ms; b-Ax took 173.180 ms, out of which Lap took 155.365 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.111 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161994, int_b + int_rho = -3.165e-13, checking this took 0.079 ms
2-norm of RHS = 500.8259783029462, which took 0.116 ms

iter_count = 108, r_2norm = 4.384e-04, tol*||rhs|| = 5.008e-04

Anderson update took 58.070 ms, out of which F'*F took 27.207 ms; b-Ax took 183.231 ms, out of which Lap took 164.644 ms
Solving Poisson took 390.846 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.077587 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 123.764 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.086993 
Total time for convolution: 	 convolve: 5.097379 
Total time for convolution: 	 convolve: 5.084853 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.835 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 3.564 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.999 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.599 ms

This SCF took 26112.633 ms, scf error = 1.833e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.137820, lowerbound = -0.953512, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 807.328 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.941 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.786 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.747 ms
rank =  0, finding HY took 13.820 ms
rank =  0, distributing HY into block cyclic form took 7.747 ms
rank =  0, finding Y'*HY took 2.441 ms
Rank 0, Project_Hamiltonian used 33.790 ms
Total time for projection: 33.803 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -0.953418262501988
    last  calculated eigval = 0.037658567929717
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95341826250199
lambda[   2] =  -0.62329646785933
lambda[   3] =  -0.51377712759212
lambda[   4] =  -0.36286003374236
lambda[   5] =  -0.33021798428131
lambda[   6] =  -0.20852913120782
lambda[   7] =  -0.10970581603045
lambda[   8] =  -0.03685330525268
lambda[   9] =   0.00527269513273
lambda[  10] =   0.01497055584763
lambda[  11] =   0.02820306540308
lambda[  12] =   0.03765856792972
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 2.767 ms
rank =  0, Distributing orbital back into band + domain format took 7.682 ms
rank = 0, Subspace_Rotation used 10.465 ms

Total time for subspace rotation: 10.472 ms
rank = 0, Efermi =  -0.139356586247 calculate fermi energy took 0.073 ms
rank = 0, --- Calculate rho: sum over local bands took 2.716 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.100 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.553 ms
rank = 0, Calculating density took 866.295 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.841 ms
rank = 0, D2D took 1.939 ms
rank = 0, Transfering density took 1.941 ms
Etot    =   -21.864726308171
Eband   =    -5.984198015645
E1      =    13.615133940264
E2      =    -5.725829932208
E3      =    -7.533122092647
Exc     =    -6.708252877562
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 5.042e-08, dEband = 2.354e-04
rank = 0, Calculating/Estimating energy took 0.940 ms, Etot = -21.864726308, dEtot = 5.042e-08, dEband = 2.354e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0548728657529, which took 0.080 ms

iter_count = 96, r_2norm = 1.513e-06, tol*||rhs|| = 2.195e-06

Anderson update took 51.733 ms, out of which F'*F took 24.475 ms; b-Ax took 163.126 ms, out of which Lap took 146.234 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 354.290 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161998, int_b + int_rho = -2.801e-13, checking this took 0.110 ms
2-norm of RHS = 500.8304230015752, which took 0.133 ms

iter_count = 150, r_2norm = 4.421e-04, tol*||rhs|| = 5.008e-04

Anderson update took 80.140 ms, out of which F'*F took 37.353 ms; b-Ax took 253.488 ms, out of which Lap took 227.161 ms
Solving Poisson took 539.663 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.087120 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 87.619 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.093237 
Total time for convolution: 	 convolve: 5.092834 
Total time for convolution: 	 convolve: 5.080193 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.821 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.509 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.741 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.511 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.997 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.543 ms

This SCF took 26215.693 ms, scf error = 1.363e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.137659, lowerbound = -0.953418, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 813.076 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.691 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.750 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.461 ms
rank =  0, finding HY took 13.875 ms
rank =  0, distributing HY into block cyclic form took 7.696 ms
rank =  0, finding Y'*HY took 2.537 ms
Rank 0, Project_Hamiltonian used 33.595 ms
Total time for projection: 33.606 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.168 ms
    first calculated eigval = -0.953174819215253
    last  calculated eigval = 0.039840122674884
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95317481921525
lambda[   2] =  -0.62306648092372
lambda[   3] =  -0.51354489217618
lambda[   4] =  -0.36263529087970
lambda[   5] =  -0.33001095998766
lambda[   6] =  -0.20832242090060
lambda[   7] =  -0.10949325093253
lambda[   8] =  -0.03641477853980
lambda[   9] =   0.00690207173316
lambda[  10] =   0.01550193385089
lambda[  11] =   0.02918219881395
lambda[  12] =   0.03984012267488
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 2.776 ms
rank =  0, Distributing orbital back into band + domain format took 7.676 ms
rank = 0, Subspace_Rotation used 10.466 ms

Total time for subspace rotation: 10.472 ms
rank = 0, Efermi =  -0.139144021130 calculate fermi energy took 0.076 ms
rank = 0, --- Calculate rho: sum over local bands took 2.722 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.133 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 871.934 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.825 ms
rank = 0, D2D took 1.917 ms
rank = 0, Transfering density took 1.919 ms
Etot    =   -21.864731242860
Eband   =    -5.981509729439
E1      =    13.613796021589
E2      =    -5.724409519498
E3      =    -7.533420521885
Exc     =    -6.708486196311
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 1.234e-06, dEband = 6.721e-04
rank = 0, Calculating/Estimating energy took 1.846 ms, Etot = -21.864731243, dEtot = 1.234e-06, dEband = 6.721e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0439793689183, which took 0.065 ms

iter_count = 96, r_2norm = 1.242e-06, tol*||rhs|| = 1.759e-06

Anderson update took 51.716 ms, out of which F'*F took 24.314 ms; b-Ax took 163.359 ms, out of which Lap took 146.612 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 354.004 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161997, int_b + int_rho = -2.856e-13, checking this took 0.127 ms
2-norm of RHS = 500.8299436623426, which took 0.128 ms

iter_count = 108, r_2norm = 4.512e-04, tol*||rhs|| = 5.008e-04

Anderson update took 57.923 ms, out of which F'*F took 27.359 ms; b-Ax took 183.381 ms, out of which Lap took 164.984 ms
Solving Poisson took 390.185 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.082260 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 68.197 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.076927 
Total time for convolution: 	 convolve: 5.087701 
Total time for convolution: 	 convolve: 5.077716 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.183 ms
---Transfer Veff_loc: D2D took 3.517 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.992 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.543 ms

This SCF took 26021.357 ms, scf error = 1.131e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.139840, lowerbound = -0.953175, upperbound = 267.568727

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 813.935 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.835 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.724 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.577 ms
rank =  0, finding HY took 13.894 ms
rank =  0, distributing HY into block cyclic form took 7.730 ms
rank =  0, finding Y'*HY took 2.474 ms
Rank 0, Project_Hamiltonian used 33.697 ms
Total time for projection: 33.709 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.168 ms
    first calculated eigval = -0.953073969055755
    last  calculated eigval = 0.040712272403388
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.95307396905576
lambda[   2] =  -0.62297722370005
lambda[   3] =  -0.51345369692528
lambda[   4] =  -0.36254349780725
lambda[   5] =  -0.32992370472363
lambda[   6] =  -0.20823902856736
lambda[   7] =  -0.10940541690779
lambda[   8] =  -0.03621272395773
lambda[   9] =   0.00765128047987
lambda[  10] =   0.01571375846624
lambda[  11] =   0.02961005775563
lambda[  12] =   0.04071227240339
==subpsace eigenproblem: bcast eigvals took 0.046 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 2.769 ms
rank =  0, Distributing orbital back into band + domain format took 7.692 ms
rank = 0, Subspace_Rotation used 10.476 ms

Total time for subspace rotation: 10.484 ms
rank = 0, Efermi =  -0.139056187120 calculate fermi energy took 0.078 ms
rank = 0, --- Calculate rho: sum over local bands took 2.696 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.097 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 872.865 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.824 ms
rank = 0, D2D took 1.917 ms
rank = 0, Transfering density took 1.920 ms
Etot    =   -21.864731462057
Eband   =    -5.980422242830
E1      =    13.613170889623
E2      =    -5.723911400442
E3      =    -7.533582988440
Exc     =    -6.708613117650
Esc     =   -36.046361379728
Entropy =    -0.000000000355
dE = 5.480e-08, dEband = 2.719e-04
rank = 0, Calculating/Estimating energy took 1.638 ms, Etot = -21.864731462, dEtot = 5.480e-08, dEband = 2.719e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0227007020966, which took 0.052 ms

iter_count = 96, r_2norm = 8.333e-07, tol*||rhs|| = 9.080e-07

Anderson update took 51.919 ms, out of which F'*F took 24.549 ms; b-Ax took 163.439 ms, out of which Lap took 146.891 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 354.446 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001162026, int_rho =  12.00000001161997, int_b + int_rho = -2.947e-13, checking this took 0.120 ms
2-norm of RHS = 500.8300928812725, which took 0.135 ms

iter_count = 126, r_2norm = 4.792e-04, tol*||rhs|| = 5.008e-04

Anderson update took 67.402 ms, out of which F'*F took 31.633 ms; b-Ax took 213.153 ms, out of which Lap took 191.185 ms
Solving Poisson took 454.007 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.080421 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 68.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.081848 
Total time for convolution: 	 convolve: 5.079460 
Total time for convolution: 	 convolve: 5.082361 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.763 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 3.504 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.205 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.746 ms

This SCF took 26076.558 ms, scf error = 7.945e-05
The last 12 occupations of kpoints #1 are (Nelectron = 12):
lambda[   1] =  -0.95307396905576, occ[   1] =   2.00000000000000
lambda[   2] =  -0.62297722370005, occ[   2] =   2.00000000000000
lambda[   3] =  -0.51345369692528, occ[   3] =   2.00000000000000
lambda[   4] =  -0.36254349780725, occ[   4] =   2.00000000000000
lambda[   5] =  -0.32992370472363, occ[   5] =   2.00000000000000
lambda[   6] =  -0.20823902856736, occ[   6] =   2.00000000000000
lambda[   7] =  -0.10940541690779, occ[   7] =   0.00000001161996
lambda[   8] =  -0.03621272395773, occ[   8] =   0.00000000000000
lambda[   9] =   0.00765128047987, occ[   9] =   0.00000000000000
lambda[  10] =   0.01571375846624, occ[  10] =   0.00000000000000
lambda[  11] =   0.02961005775563, occ[  11] =   0.00000000000000
lambda[  12] =   0.04071227240339, occ[  12] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 11 (90%) = 0.000000000000000.
Occupation of state 12 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.376 ms, time for Allreduce/Reduce: 4.263 ms 
Time for calculating local force components: 11.497 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000002985909  -0.02496432810138  -0.05515938987991
 -0.00000002389483   0.02496431958608  -0.05515944518535
 -0.00000384634470  -0.67147470936918   0.69321616934139
 -0.00000379251992   0.67147305908743   0.69321616269623
force_loc = 
  0.00000026395473   0.02969699124076   0.06055997347198
 -0.00000069960444  -0.02969636555836   0.06056104832747
  0.00001478458365   0.65166791981846  -0.67887502645541
  0.00001414451828  -0.65166980711893  -0.67887647003913
Time for calculating nonlocal force components: 21.682 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000056520318   0.01477865926793  -0.01965733940956
[0m[32m  0.00000055719116  -0.01477870424594  -0.01965741382813
[0mTime for calculating XC forces components: 14.291 ms
 Cartesian force = 
 -0.00000524671137   0.00473340448767   0.00535851633218
 -0.00000620430627  -0.00473130462400   0.00535953588223
  0.00000602263512  -0.00502738893451  -0.00535826378348
  0.00000542838252   0.00502528907084  -0.00535978843092
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Time for printing density: 380.963 ms
The program took 637.576 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:39:23
Job ID:        2266971
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:09:24,vmem=8308K,walltime=00:10:47,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-14-1
---------------------------------------
