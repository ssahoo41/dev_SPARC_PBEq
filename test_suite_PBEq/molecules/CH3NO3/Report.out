---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:01
Job ID:    2266908
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:06
Job ID:    2266908
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.060 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.012 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 20.720 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 8.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 8.316 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 140.526 ms

Freeing SPARC_INPUT_MPI datatype took 0.007 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.994 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.107 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.176509	   12.007667	   10.000000	
   11.823491	   13.935299	   10.000000	
   11.802687	    9.820220	   10.000000	
   11.516205	    6.064701	   10.000000	
    9.005271	    7.593387	   11.688661	
    9.005271	    7.593387	    8.311339	
   10.190227	    7.642978	   10.000000	
   10.457261	   12.126120	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.183 ms
Set up communicators.

--set up spincomm took 3.179 ms

--set up kptcomm took 0.348 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 23, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 23 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 23, mbQ = nbQ = 64
rank = 0, nr_Hp = 23, nc_Hp = 23
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.097 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.358 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.237 ms

Calculate_SplineDerivRadFun took 0.303 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.795 ms.
time spent on vectorized spline interp: 3.356 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.726 ms.
time spent on vectorized spline interp: 1.604 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.358 ms.
time spent on vectorized spline interp: 1.880 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.436 ms.
time spent on vectorized spline interp: 1.713 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.568 ms.

Calculating rb for all atom types took 21.447 ms
----------------------
Estimated memory usage
Total: 1.36 GB
orbitals             : 1.03 GB
global sized vectors : 213.62 MB
subspace matrices : 12.40 kB
others : 126.65 MB
----------------------------------------------
Estimated memory usage per processor: 116.10 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.061 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.015 ms
Calculating pseudocharge density ... 
the global sum of int_b = -30.0000000265395, sum_int_rho = 29.6971240599555
PosCharge = 30.000000026539, NegCharge = -29.697124059956, scal_fac = 1.010198831576
After scaling, int_rho = 30.0000000265394, PosCharge + NegCharge - NetCharge = 6.395e-14
--Calculate Vref took 0.515 ms
--Calculate rho_guess took 2.730 ms

 integral of b = -30.0000000265395,
 int{b} + Nelectron + NetCharge = -2.654e-08,
 Esc = -103.3279799263338,
 MPI_Reduce took 10.271 ms

Calculating b & b_ref took 20.221 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.075 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.084 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.128 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.770 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.005 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.586 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653923, int_b + int_rho = -2.074e-13, checking this took 0.555 ms
2-norm of RHS = 733.7391786763087, which took 0.085 ms

iter_count = 420, r_2norm = 6.193e-04, tol*||rhs|| = 7.337e-04

Anderson update took 280.409 ms, out of which F'*F took 126.129 ms; b-Ax took 865.533 ms, out of which Lap took 759.320 ms
Solving Poisson took 1966.217 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.206 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
Total time for convolution: 	 convolve: 5.101460 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.805 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.797 ms
Total time for convolution: 	 convolve: 5.092594 
Total time for convolution: 	 convolve: 5.101119 
Total time for convolution: 	 convolve: 5.111703 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.737 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.410 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
rank = 0, XC calculation took 24318.424 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.963 ms
---Transfer Veff_loc: D2D took 5.502 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.296 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.927 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.147 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.902 ms
    Lanczos iter 53, eigmin  = -1.151133180, eigmax = 264.929266528, err_eigmin = 8.656e-04, err_eigmax = 9.690e-03
rank =   0, Lanczos took 134.054 ms, eigmin = -1.151133179878, eigmax = 267.578559193699

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.163713, lowerbound = -1.251133, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1830.558 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 24.238 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.478 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 27.742 ms
rank =  0, finding HY took 29.551 ms
rank =  0, distributing HY into block cyclic form took 24.421 ms
rank =  0, finding Y'*HY took 6.702 ms
Rank 0, Project_Hamiltonian used 88.448 ms
Total time for projection: 88.461 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.809 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.907 ms
    first calculated eigval = 2.698763604742893
    last  calculated eigval = 3.284820809541308
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =   2.85534221179178
lambda[   7] =   2.88778049691189
lambda[   8] =   2.90210927401704
lambda[   9] =   2.95492983552695
lambda[  10] =   2.96331584681693
lambda[  11] =   2.99089303975321
lambda[  12] =   2.99789568536663
lambda[  13] =   3.00205902372485
lambda[  14] =   3.03706139331454
lambda[  15] =   3.04163095740900
lambda[  16] =   3.05070509281411
lambda[  17] =   3.08834700250485
lambda[  18] =   3.13333462433911
lambda[  19] =   3.15229311547534
lambda[  20] =   3.17717665781479
lambda[  21] =   3.18259480769939
lambda[  22] =   3.23361342658263
lambda[  23] =   3.28482080954131
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.928 ms
rank =  0, subspace rotation using ScaLAPACK took 10.828 ms
rank =  0, Distributing orbital back into band + domain format took 23.123 ms
rank = 0, Subspace_Rotation used 33.968 ms

Total time for subspace rotation: 33.973 ms
rank = 0, Efermi =   3.046498872051 calculate fermi energy took 0.059 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.384821, lowerbound = -1.251133, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1818.152 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 45.537 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.772 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 49.335 ms
rank =  0, finding HY took 29.135 ms
rank =  0, distributing HY into block cyclic form took 22.389 ms
rank =  0, finding Y'*HY took 5.861 ms
Rank 0, Project_Hamiltonian used 106.751 ms
Total time for projection: 106.755 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.143 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.614 ms
    first calculated eigval = -0.995352711877717
    last  calculated eigval = 0.451329873817906
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.27099059433716
lambda[   7] =  -0.24357771853233
lambda[   8] =  -0.07651546208331
lambda[   9] =  -0.02665596195601
lambda[  10] =   0.00807991551035
lambda[  11] =   0.04770889320000
lambda[  12] =   0.14696516760571
lambda[  13] =   0.19291641051789
lambda[  14] =   0.21869893882516
lambda[  15] =   0.26212168958633
lambda[  16] =   0.29035320806457
lambda[  17] =   0.31402499039694
lambda[  18] =   0.33419207639301
lambda[  19] =   0.35812105369340
lambda[  20] =   0.40637952916468
lambda[  21] =   0.42001967621134
lambda[  22] =   0.44033281333809
lambda[  23] =   0.45132987381791
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.626 ms
rank =  0, subspace rotation using ScaLAPACK took 11.368 ms
rank =  0, Distributing orbital back into band + domain format took 23.902 ms
rank = 0, Subspace_Rotation used 35.293 ms

Total time for subspace rotation: 35.297 ms
rank = 0, Efermi =   0.276237452281 calculate fermi energy took 0.052 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.551330, lowerbound = -1.251133, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1799.644 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 46.669 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.628 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 50.324 ms
rank =  0, finding HY took 29.508 ms
rank =  0, distributing HY into block cyclic form took 22.447 ms
rank =  0, finding Y'*HY took 5.863 ms
Rank 0, Project_Hamiltonian used 108.179 ms
Total time for projection: 108.196 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.230 ms
    first calculated eigval = -1.160346201658565
    last  calculated eigval = 0.175510480958450
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.55765071583032
lambda[   7] =  -0.53424468394638
lambda[   8] =  -0.51806747458179
lambda[   9] =  -0.49121122395577
lambda[  10] =  -0.46728979951739
lambda[  11] =  -0.42020053854005
lambda[  12] =  -0.31914002444991
lambda[  13] =  -0.30186415260553
lambda[  14] =  -0.29809881840084
lambda[  15] =  -0.26042158081163
lambda[  16] =  -0.02680646777665
lambda[  17] =   0.05053148084820
lambda[  18] =   0.07769355889477
lambda[  19] =   0.09156755742519
lambda[  20] =   0.10497398954556
lambda[  21] =   0.11330166442981
lambda[  22] =   0.15225521064111
lambda[  23] =   0.17551048095845
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 10.685 ms
rank =  0, Distributing orbital back into band + domain format took 22.879 ms
rank = 0, Subspace_Rotation used 33.583 ms

Total time for subspace rotation: 33.588 ms
rank = 0, Efermi =  -0.055717406640 calculate fermi energy took 0.037 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.275510, lowerbound = -1.251133, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1802.528 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 47.596 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.752 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.001 ms
rank =  0, Distribute data + matrix mult took 52.402 ms
rank =  0, finding HY took 28.700 ms
rank =  0, distributing HY into block cyclic form took 22.578 ms
rank =  0, finding Y'*HY took 5.741 ms
Rank 0, Project_Hamiltonian used 109.456 ms
Total time for projection: 109.462 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.242 ms
    first calculated eigval = -1.160468903977623
    last  calculated eigval = 0.100200966273138
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.56129436823364
lambda[   7] =  -0.53610009155345
lambda[   8] =  -0.52765553700071
lambda[   9] =  -0.49655930956367
lambda[  10] =  -0.47591873455265
lambda[  11] =  -0.42846380737215
lambda[  12] =  -0.33412236802900
lambda[  13] =  -0.33272734228107
lambda[  14] =  -0.32232416911401
lambda[  15] =  -0.30564667552545
lambda[  16] =  -0.06960305662644
lambda[  17] =  -0.01363025019721
lambda[  18] =   0.02096067350624
lambda[  19] =   0.04534019149859
lambda[  20] =   0.05917526816058
lambda[  21] =   0.06366600774021
lambda[  22] =   0.09305004451088
lambda[  23] =   0.10020096627314
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 10.805 ms
rank =  0, Distributing orbital back into band + domain format took 23.104 ms
rank = 0, Subspace_Rotation used 33.930 ms

Total time for subspace rotation: 33.936 ms
rank = 0, Efermi =  -0.098513995505 calculate fermi energy took 0.038 ms
rank = 0, --- Calculate rho: sum over local bands took 6.971 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.675 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.637 ms
rank = 0, Calculating density took 7959.527 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.964 ms
rank = 0, D2D took 2.067 ms
rank = 0, Transfering density took 2.074 ms
Etot    =   -67.782335290694
Eband   =   -17.802331096375
E1      =    34.830186308302
E2      =   -16.397355208794
E3      =   -20.394897556014
Exc     =   -18.274463340305
Esc     =  -103.327979926334
Entropy =    -0.000000000791
dE = 8.473e+00, dEband = 2.225e+00
rank = 0, Calculating/Estimating energy took 1.038 ms, Etot = -67.782335291, dEtot = 8.473e+00, dEband = 2.225e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 82.4675367924297, which took 0.437 ms

iter_count = 90, r_2norm = 2.763e-03, tol*||rhs|| = 3.299e-03

Anderson update took 57.646 ms, out of which F'*F took 24.555 ms; b-Ax took 165.861 ms, out of which Lap took 147.437 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 391.688 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653941, int_b + int_rho = -2.910e-14, checking this took 0.101 ms
2-norm of RHS = 730.5953436559104, which took 1.008 ms

iter_count = 282, r_2norm = 7.075e-04, tol*||rhs|| = 7.306e-04

Anderson update took 184.757 ms, out of which F'*F took 79.415 ms; b-Ax took 609.173 ms, out of which Lap took 551.687 ms
Solving Poisson took 1281.186 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.380 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.622 ms
Total time for convolution: 	 convolve: 5.148282 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.142033 
Total time for convolution: 	 convolve: 5.154352 
Total time for convolution: 	 convolve: 5.175479 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.324 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 3.482 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.968 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.487 ms

This SCF took 34223.405 ms, scf error = 1.463e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.200201, lowerbound = -1.160469, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1832.283 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.457 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.587 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.073 ms
rank =  0, finding HY took 29.075 ms
rank =  0, distributing HY into block cyclic form took 23.329 ms
rank =  0, finding Y'*HY took 6.137 ms
Rank 0, Project_Hamiltonian used 84.646 ms
Total time for projection: 84.656 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.194 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.119 ms
rank = 0, Solve_Generalized_EigenProblem used 0.315 ms
    first calculated eigval = -1.177732254251027
    last  calculated eigval = 0.065948068670198
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.54452537686392
lambda[   7] =  -0.52245463179949
lambda[   8] =  -0.50714614686041
lambda[   9] =  -0.47446701956239
lambda[  10] =  -0.47412649212460
lambda[  11] =  -0.41019269201187
lambda[  12] =  -0.32041560694029
lambda[  13] =  -0.31517322163045
lambda[  14] =  -0.30224525660617
lambda[  15] =  -0.28119578080898
lambda[  16] =  -0.09154235019384
lambda[  17] =  -0.03001378774631
lambda[  18] =   0.00789780209116
lambda[  19] =   0.02480840424825
lambda[  20] =   0.03454162049770
lambda[  21] =   0.05280658160513
lambda[  22] =   0.06300682920310
lambda[  23] =   0.06594806867020
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.333 ms
rank =  0, subspace rotation using ScaLAPACK took 10.451 ms
rank =  0, Distributing orbital back into band + domain format took 23.051 ms
rank = 0, Subspace_Rotation used 33.525 ms

Total time for subspace rotation: 33.533 ms
rank = 0, Efermi =  -0.120453289096 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 7.150 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.528 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 1971.227 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.920 ms
rank = 0, D2D took 2.031 ms
rank = 0, Transfering density took 2.036 ms
Etot    =   -67.695108591448
Eband   =   -17.413893799897
E1      =    34.481497219844
E2      =   -16.409268599675
E3      =   -20.561710161747
Exc     =   -18.405710845693
Esc     =  -103.327979926334
Entropy =    -0.000000000791
dE = 1.090e-02, dEband = 4.855e-02
rank = 0, Calculating/Estimating energy took 1.069 ms, Etot = -67.695108591, dEtot = 1.090e-02, dEband = 4.855e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 45.4833301603048, which took 0.109 ms

iter_count = 96, r_2norm = 1.104e-03, tol*||rhs|| = 1.819e-03

Anderson update took 61.049 ms, out of which F'*F took 26.081 ms; b-Ax took 177.252 ms, out of which Lap took 157.731 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.390 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653934, int_b + int_rho = -1.019e-13, checking this took 0.107 ms
2-norm of RHS = 728.7454720274292, which took 0.125 ms

iter_count = 288, r_2norm = 5.726e-04, tol*||rhs|| = 7.287e-04

Anderson update took 182.723 ms, out of which F'*F took 81.234 ms; b-Ax took 546.954 ms, out of which Lap took 489.130 ms
Solving Poisson took 1235.563 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.386 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.155060 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.140193 
Total time for convolution: 	 convolve: 5.146895 
Total time for convolution: 	 convolve: 5.171855 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.964 ms
---Transfer Veff_loc: D2D took 4.235 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.038 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.304 ms

This SCF took 28261.709 ms, scf error = 8.674e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.165948, lowerbound = -1.177732, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1827.696 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 22.538 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.922 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.478 ms
rank =  0, finding HY took 29.413 ms
rank =  0, distributing HY into block cyclic form took 22.831 ms
rank =  0, finding Y'*HY took 5.845 ms
Rank 0, Project_Hamiltonian used 84.599 ms
Total time for projection: 84.609 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.233 ms
    first calculated eigval = -1.190027700193302
    last  calculated eigval = 0.057587408529459
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.53302683512232
lambda[   7] =  -0.52579489213240
lambda[   8] =  -0.49344473698900
lambda[   9] =  -0.44906810600708
lambda[  10] =  -0.44702534972652
lambda[  11] =  -0.38703939073414
lambda[  12] =  -0.30522140117899
lambda[  13] =  -0.30464193710382
lambda[  14] =  -0.29382299013801
lambda[  15] =  -0.26860858817192
lambda[  16] =  -0.09975622120860
lambda[  17] =  -0.03132995522348
lambda[  18] =   0.00296369617891
lambda[  19] =   0.01446146039022
lambda[  20] =   0.02758357678862
lambda[  21] =   0.04671108113389
lambda[  22] =   0.05014308316976
lambda[  23] =   0.05758740852946
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 10.514 ms
rank =  0, Distributing orbital back into band + domain format took 23.111 ms
rank = 0, Subspace_Rotation used 33.642 ms

Total time for subspace rotation: 33.648 ms
rank = 0, Efermi =  -0.128667160106 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 7.020 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.321 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.586 ms
rank = 0, Calculating density took 1966.253 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.966 ms
rank = 0, D2D took 2.063 ms
rank = 0, Transfering density took 2.065 ms
Etot    =   -67.663420365343
Eband   =   -17.054640855721
E1      =    34.151947561706
E2      =   -16.375283250135
E3      =   -20.730845225171
Exc     =   -18.538875619509
Esc     =  -103.327979926334
Entropy =    -0.000000000791
dE = 3.961e-03, dEband = 4.491e-02
rank = 0, Calculating/Estimating energy took 1.061 ms, Etot = -67.663420365, dEtot = 3.961e-03, dEband = 4.491e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 10.0867548458050, which took 0.051 ms

iter_count = 96, r_2norm = 3.797e-04, tol*||rhs|| = 4.035e-04

Anderson update took 61.168 ms, out of which F'*F took 28.750 ms; b-Ax took 183.095 ms, out of which Lap took 165.136 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 425.285 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653942, int_b + int_rho = -1.455e-14, checking this took 0.112 ms
2-norm of RHS = 728.6354668721237, which took 0.155 ms

iter_count = 282, r_2norm = 6.505e-04, tol*||rhs|| = 7.286e-04

Anderson update took 187.246 ms, out of which F'*F took 85.563 ms; b-Ax took 559.261 ms, out of which Lap took 506.383 ms
Solving Poisson took 1259.766 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.193604 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.186112 
Total time for convolution: 	 convolve: 5.193578 
Total time for convolution: 	 convolve: 5.182304 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 8.965 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.161 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 3.479 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.181 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.688 ms

This SCF took 28412.737 ms, scf error = 4.521e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.157587, lowerbound = -1.190028, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1827.086 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 22.596 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.386 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.002 ms
rank =  0, finding HY took 28.839 ms
rank =  0, distributing HY into block cyclic form took 25.965 ms
rank =  0, finding Y'*HY took 5.731 ms
Rank 0, Project_Hamiltonian used 86.569 ms
Total time for projection: 86.578 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.231 ms
    first calculated eigval = -1.190409081157889
    last  calculated eigval = 0.057979334235443
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.52752951964481
lambda[   7] =  -0.52417639502419
lambda[   8] =  -0.48869633063088
lambda[   9] =  -0.42469601059418
lambda[  10] =  -0.42317540365192
lambda[  11] =  -0.36754080316989
lambda[  12] =  -0.30385857879721
lambda[  13] =  -0.30208394304967
lambda[  14] =  -0.28730861773854
lambda[  15] =  -0.26783131358906
lambda[  16] =  -0.09928396498368
lambda[  17] =  -0.03045791625470
lambda[  18] =  -0.00111600733353
lambda[  19] =   0.01456943978960
lambda[  20] =   0.02246816444674
lambda[  21] =   0.03721188920074
lambda[  22] =   0.04518406657855
lambda[  23] =   0.05797933423544
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 10.507 ms
rank =  0, Distributing orbital back into band + domain format took 22.931 ms
rank = 0, Subspace_Rotation used 33.457 ms

Total time for subspace rotation: 33.465 ms
rank = 0, Efermi =  -0.128194903921 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 6.779 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.125 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.336 ms
rank = 0, Calculating density took 1968.753 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.123 ms
rank = 0, D2D took 2.222 ms
rank = 0, Transfering density took 2.225 ms
Etot    =   -67.654134339433
Eband   =   -16.788791210831
E1      =    33.928391880551
E2      =   -16.313543297141
E3      =   -20.862190698482
Exc     =   -18.641489077651
Esc     =  -103.327979926334
Entropy =    -0.000000000791
dE = 1.161e-03, dEband = 3.323e-02
rank = 0, Calculating/Estimating energy took 1.873 ms, Etot = -67.654134339, dEtot = 1.161e-03, dEband = 3.323e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 4.3904099824604, which took 0.064 ms

iter_count = 102, r_2norm = 1.154e-04, tol*||rhs|| = 1.756e-04

Anderson update took 63.614 ms, out of which F'*F took 29.295 ms; b-Ax took 193.938 ms, out of which Lap took 174.283 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 446.052 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653939, int_b + int_rho = -5.093e-14, checking this took 0.118 ms
2-norm of RHS = 728.8038336348213, which took 0.152 ms

iter_count = 246, r_2norm = 6.266e-04, tol*||rhs|| = 7.288e-04

Anderson update took 152.513 ms, out of which F'*F took 70.828 ms; b-Ax took 477.331 ms, out of which Lap took 426.788 ms
Solving Poisson took 1061.909 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.186555 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.184323 
Total time for convolution: 	 convolve: 5.197683 
Total time for convolution: 	 convolve: 5.167504 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.400 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 1.408 ms
======D2D: initiated sending and receiving took 2.787 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.481 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.544 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.061 ms

This SCF took 28259.747 ms, scf error = 1.155e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.157979, lowerbound = -1.190409, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1827.968 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.422 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.668 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.116 ms
rank =  0, finding HY took 28.763 ms
rank =  0, distributing HY into block cyclic form took 22.892 ms
rank =  0, finding Y'*HY took 5.744 ms
Rank 0, Project_Hamiltonian used 83.566 ms
Total time for projection: 83.576 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.141 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.233 ms
    first calculated eigval = -1.189243096686815
    last  calculated eigval = 0.052837840532056
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.52484575482168
lambda[   7] =  -0.52365770614608
lambda[   8] =  -0.48597345897350
lambda[   9] =  -0.42108320274744
lambda[  10] =  -0.41882254413378
lambda[  11] =  -0.36415584785910
lambda[  12] =  -0.30164627860861
lambda[  13] =  -0.29976395992418
lambda[  14] =  -0.28557703367215
lambda[  15] =  -0.26471091694370
lambda[  16] =  -0.09811577450052
lambda[  17] =  -0.03062788136119
lambda[  18] =  -0.00409948262506
lambda[  19] =   0.01441891629385
lambda[  20] =   0.01997937546453
lambda[  21] =   0.03361584452062
lambda[  22] =   0.04024685883222
lambda[  23] =   0.05283784053206
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.245 ms
rank =  0, subspace rotation using ScaLAPACK took 10.498 ms
rank =  0, Distributing orbital back into band + domain format took 23.074 ms
rank = 0, Subspace_Rotation used 33.591 ms

Total time for subspace rotation: 33.596 ms
rank = 0, Efermi =  -0.127026713427 calculate fermi energy took 0.977 ms
rank = 0, --- Calculate rho: sum over local bands took 6.915 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.960 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.637 ms
rank = 0, Calculating density took 1965.945 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 2.993 ms
rank = 0, D2D took 3.096 ms
rank = 0, Transfering density took 3.100 ms
Etot    =   -67.653360271805
Eband   =   -16.715200882964
E1      =    33.879082296531
E2      =   -16.282028512268
E3      =   -20.894759374313
Exc     =   -18.666049644828
Esc     =  -103.327979926334
Entropy =    -0.000000000791
dE = 9.676e-05, dEband = 9.199e-03
rank = 0, Calculating/Estimating energy took 1.189 ms, Etot = -67.653360272, dEtot = 9.676e-05, dEband = 9.199e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 1.2990239259764, which took 0.065 ms

iter_count = 108, r_2norm = 4.007e-05, tol*||rhs|| = 5.196e-05

Anderson update took 66.832 ms, out of which F'*F took 31.086 ms; b-Ax took 210.892 ms, out of which Lap took 188.362 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.899 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653946, int_b + int_rho = 1.819e-14, checking this took 0.116 ms
2-norm of RHS = 729.0764458471782, which took 0.183 ms

iter_count = 234, r_2norm = 6.268e-04, tol*||rhs|| = 7.291e-04

Anderson update took 144.839 ms, out of which F'*F took 64.575 ms; b-Ax took 439.780 ms, out of which Lap took 391.182 ms
Solving Poisson took 987.010 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.166507 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.169838 
Total time for convolution: 	 convolve: 5.170818 
Total time for convolution: 	 convolve: 5.189952 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.420 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.896 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.158 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.510 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.059 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.604 ms

This SCF took 28130.635 ms, scf error = 5.509e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.152838, lowerbound = -1.189243, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1828.255 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.802 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.596 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.427 ms
rank =  0, finding HY took 28.813 ms
rank =  0, distributing HY into block cyclic form took 22.695 ms
rank =  0, finding Y'*HY took 5.756 ms
Rank 0, Project_Hamiltonian used 83.727 ms
Total time for projection: 83.737 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.140 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.229 ms
    first calculated eigval = -1.187740124743675
    last  calculated eigval = 0.047305738193932
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.52380617275312
lambda[   7] =  -0.52256904570772
lambda[   8] =  -0.48496637097917
lambda[   9] =  -0.41956052277607
lambda[  10] =  -0.41714994034922
lambda[  11] =  -0.36269680343934
lambda[  12] =  -0.30090281027406
lambda[  13] =  -0.29869914184356
lambda[  14] =  -0.28447166812988
lambda[  15] =  -0.26371154844246
lambda[  16] =  -0.09708501895964
lambda[  17] =  -0.03049705978283
lambda[  18] =  -0.00479480440048
lambda[  19] =   0.01497317187344
lambda[  20] =   0.01900824422199
lambda[  21] =   0.03205062531817
lambda[  22] =   0.03649511165951
lambda[  23] =   0.04730573819393
==subpsace eigenproblem: bcast eigvals took 0.095 ms
Total time for solving subspace eigenvalue problem: 0.331 ms
rank =  0, subspace rotation using ScaLAPACK took 10.464 ms
rank =  0, Distributing orbital back into band + domain format took 23.026 ms
rank = 0, Subspace_Rotation used 33.508 ms

Total time for subspace rotation: 34.093 ms
rank = 0, Efermi =  -0.125995957889 calculate fermi energy took 0.664 ms
rank = 0, --- Calculate rho: sum over local bands took 4.125 ms
rank = 0, --- Calculate rho: reduce over all band groups took 21.452 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.627 ms
rank = 0, Calculating density took 1973.361 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.942 ms
rank = 0, D2D took 2.037 ms
rank = 0, Transfering density took 2.049 ms
Etot    =   -67.653189433484
Eband   =   -16.677397652421
E1      =    33.862189471398
E2      =   -16.258194329566
E3      =   -20.905090512956
Exc     =   -18.673286167859
Esc     =  -103.327979926334
Entropy =    -0.000000000791
dE = 2.135e-05, dEband = 4.725e-03
rank = 0, Calculating/Estimating energy took 1.042 ms, Etot = -67.653189433, dEtot = 2.135e-05, dEband = 4.725e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5452281175328, which took 0.093 ms

iter_count = 108, r_2norm = 2.018e-05, tol*||rhs|| = 2.181e-05

Anderson update took 66.396 ms, out of which F'*F took 30.500 ms; b-Ax took 207.548 ms, out of which Lap took 184.868 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 471.335 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653934, int_b + int_rho = -9.823e-14, checking this took 0.109 ms
2-norm of RHS = 729.2626673182261, which took 0.188 ms

iter_count = 228, r_2norm = 6.571e-04, tol*||rhs|| = 7.293e-04

Anderson update took 140.585 ms, out of which F'*F took 65.208 ms; b-Ax took 437.861 ms, out of which Lap took 390.676 ms
Solving Poisson took 974.467 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.185935 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.177775 
Total time for convolution: 	 convolve: 5.176353 
Total time for convolution: 	 convolve: 5.172996 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.849 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.456 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.226 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.454 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.067 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.560 ms

This SCF took 28114.512 ms, scf error = 2.483e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.147306, lowerbound = -1.187740, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1832.449 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.114 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.963 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.103 ms
rank =  0, finding HY took 28.471 ms
rank =  0, distributing HY into block cyclic form took 22.475 ms
rank =  0, finding Y'*HY took 5.901 ms
Rank 0, Project_Hamiltonian used 82.985 ms
Total time for projection: 82.995 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -1.187197906938864
    last  calculated eigval = 0.042008697643812
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.52284769269182
lambda[   7] =  -0.52219278180967
lambda[   8] =  -0.48417400631469
lambda[   9] =  -0.41739596139531
lambda[  10] =  -0.41492750560335
lambda[  11] =  -0.36066014289431
lambda[  12] =  -0.30026973601515
lambda[  13] =  -0.29762652147193
lambda[  14] =  -0.28288062961003
lambda[  15] =  -0.26292216955674
lambda[  16] =  -0.09667727564247
lambda[  17] =  -0.02989833651784
lambda[  18] =  -0.00426931391688
lambda[  19] =   0.01621165177225
lambda[  20] =   0.01895979255074
lambda[  21] =   0.03115865498236
lambda[  22] =   0.03446608479026
lambda[  23] =   0.04200869764381
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 10.928 ms
rank =  0, Distributing orbital back into band + domain format took 22.836 ms
rank = 0, Subspace_Rotation used 33.791 ms

Total time for subspace rotation: 33.800 ms
rank = 0, Efermi =  -0.125588214559 calculate fermi energy took 0.079 ms
rank = 0, --- Calculate rho: sum over local bands took 6.744 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.554 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.628 ms
rank = 0, Calculating density took 1969.968 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.943 ms
rank = 0, D2D took 2.045 ms
rank = 0, Transfering density took 2.048 ms
Etot    =   -67.653117096258
Eband   =   -16.638813176033
E1      =    33.842628203465
E2      =   -16.236743483474
E3      =   -20.914002932677
Exc     =   -18.679698612716
Esc     =  -103.327979926334
Entropy =    -0.000000000791
dE = 9.042e-06, dEband = 4.823e-03
rank = 0, Calculating/Estimating energy took 1.051 ms, Etot = -67.653117096, dEtot = 9.042e-06, dEband = 4.823e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3335216585161, which took 0.083 ms

iter_count = 108, r_2norm = 1.122e-05, tol*||rhs|| = 1.334e-05

Anderson update took 64.640 ms, out of which F'*F took 30.093 ms; b-Ax took 204.245 ms, out of which Lap took 182.724 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 465.483 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653927, int_b + int_rho = -1.673e-13, checking this took 0.109 ms
2-norm of RHS = 729.3990120460827, which took 0.116 ms

iter_count = 222, r_2norm = 7.022e-04, tol*||rhs|| = 7.294e-04

Anderson update took 133.516 ms, out of which F'*F took 61.605 ms; b-Ax took 412.449 ms, out of which Lap took 369.271 ms
Solving Poisson took 926.006 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.131 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.169646 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.373 ms
Total time for convolution: 	 convolve: 5.178766 
Total time for convolution: 	 convolve: 5.166260 
Total time for convolution: 	 convolve: 5.184659 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.608 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.200 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.393 ms
---Transfer Veff_loc: D2D took 3.463 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.064 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.561 ms

This SCF took 28043.591 ms, scf error = 1.374e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.142009, lowerbound = -1.187198, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1824.390 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.146 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.794 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.963 ms
rank =  0, finding HY took 28.715 ms
rank =  0, distributing HY into block cyclic form took 22.482 ms
rank =  0, finding Y'*HY took 5.934 ms
Rank 0, Project_Hamiltonian used 83.125 ms
Total time for projection: 83.134 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.231 ms
    first calculated eigval = -1.186494573932241
    last  calculated eigval = 0.037383092429965
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.52178506166496
lambda[   7] =  -0.52161420562802
lambda[   8] =  -0.48323491073497
lambda[   9] =  -0.41565129402378
lambda[  10] =  -0.41307172424747
lambda[  11] =  -0.35901589402835
lambda[  12] =  -0.29954883929911
lambda[  13] =  -0.29670138728717
lambda[  14] =  -0.28183440382209
lambda[  15] =  -0.26201295151996
lambda[  16] =  -0.09603671877485
lambda[  17] =  -0.02869875209297
lambda[  18] =  -0.00282515153143
lambda[  19] =   0.01829937924087
lambda[  20] =   0.01981186565906
lambda[  21] =   0.03060832915532
lambda[  22] =   0.03450852920733
lambda[  23] =   0.03738309242996
==subpsace eigenproblem: bcast eigvals took 0.073 ms
Total time for solving subspace eigenvalue problem: 0.311 ms
rank =  0, subspace rotation using ScaLAPACK took 10.946 ms
rank =  0, Distributing orbital back into band + domain format took 22.535 ms
rank = 0, Subspace_Rotation used 33.504 ms

Total time for subspace rotation: 33.513 ms
rank = 0, Efermi =  -0.124947657650 calculate fermi energy took 0.129 ms
rank = 0, --- Calculate rho: sum over local bands took 6.809 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.594 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.565 ms
rank = 0, Calculating density took 1961.876 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.941 ms
rank = 0, D2D took 2.050 ms
rank = 0, Transfering density took 2.053 ms
Etot    =   -67.653123430441
Eband   =   -16.604477095074
E1      =    33.825890427168
E2      =   -16.217564287595
E3      =   -20.919490789566
Exc     =   -18.683611912572
Esc     =  -103.327979926334
Entropy =    -0.000000000791
dE = 7.918e-07, dEband = 4.292e-03
rank = 0, Calculating/Estimating energy took 1.059 ms, Etot = -67.653123430, dEtot = 7.918e-07, dEband = 4.292e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2050462149190, which took 0.062 ms

iter_count = 108, r_2norm = 7.001e-06, tol*||rhs|| = 8.202e-06

Anderson update took 64.939 ms, out of which F'*F took 30.133 ms; b-Ax took 204.055 ms, out of which Lap took 181.131 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.707 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653934, int_b + int_rho = -1.019e-13, checking this took 0.106 ms
2-norm of RHS = 729.4106635058030, which took 0.144 ms

iter_count = 198, r_2norm = 6.141e-04, tol*||rhs|| = 7.294e-04

Anderson update took 119.640 ms, out of which F'*F took 53.859 ms; b-Ax took 366.530 ms, out of which Lap took 327.817 ms
Solving Poisson took 827.405 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.193971 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.171546 
Total time for convolution: 	 convolve: 5.192175 
Total time for convolution: 	 convolve: 5.164051 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.401 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.495 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.062 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.592 ms

This SCF took 27963.489 ms, scf error = 6.990e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.137383, lowerbound = -1.186495, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1824.776 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 22.745 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.824 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.591 ms
rank =  0, finding HY took 28.609 ms
rank =  0, distributing HY into block cyclic form took 22.698 ms
rank =  0, finding Y'*HY took 5.764 ms
Rank 0, Project_Hamiltonian used 84.283 ms
Total time for projection: 84.296 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.659 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.353 ms
rank = 0, Solve_Generalized_EigenProblem used 1.018 ms
    first calculated eigval = -1.186082554302414
    last  calculated eigval = 0.035688581412378
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.52134446111577
lambda[   7] =  -0.52121219433338
lambda[   8] =  -0.48285501255211
lambda[   9] =  -0.41494471508546
lambda[  10] =  -0.41239362856920
lambda[  11] =  -0.35831038396006
lambda[  12] =  -0.29929786794448
lambda[  13] =  -0.29628177775273
lambda[  14] =  -0.28121415933158
lambda[  15] =  -0.26171028972204
lambda[  16] =  -0.09566264968315
lambda[  17] =  -0.02787213079110
lambda[  18] =  -0.00181119601868
lambda[  19] =   0.01961169253543
lambda[  20] =   0.02048737963420
lambda[  21] =   0.02996464979963
lambda[  22] =   0.03281296142445
lambda[  23] =   0.03568858141238
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 1.045 ms
rank =  0, subspace rotation using ScaLAPACK took 10.491 ms
rank =  0, Distributing orbital back into band + domain format took 22.808 ms
rank = 0, Subspace_Rotation used 33.321 ms

Total time for subspace rotation: 33.328 ms
rank = 0, Efermi =  -0.124573588588 calculate fermi energy took 0.069 ms
rank = 0, --- Calculate rho: sum over local bands took 6.916 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.264 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.626 ms
rank = 0, Calculating density took 1963.449 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.937 ms
rank = 0, D2D took 2.036 ms
rank = 0, Transfering density took 2.041 ms
Etot    =   -67.653146028448
Eband   =   -16.589232283608
E1      =    33.818069922620
E2      =   -16.209686296254
E3      =   -20.921153272352
Exc     =   -18.684843308942
Esc     =  -103.327979926334
Entropy =    -0.000000000791
dE = 2.825e-06, dEband = 1.906e-03
rank = 0, Calculating/Estimating energy took 1.047 ms, Etot = -67.653146028, dEtot = 2.825e-06, dEband = 1.906e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0837114352304, which took 0.124 ms

iter_count = 114, r_2norm = 2.344e-06, tol*||rhs|| = 3.348e-06

Anderson update took 68.628 ms, out of which F'*F took 32.036 ms; b-Ax took 219.327 ms, out of which Lap took 195.852 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 496.079 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653945, int_b + int_rho = 1.091e-14, checking this took 0.111 ms
2-norm of RHS = 729.4044935343908, which took 0.140 ms

iter_count = 198, r_2norm = 7.158e-04, tol*||rhs|| = 7.294e-04

Anderson update took 119.032 ms, out of which F'*F took 53.844 ms; b-Ax took 364.995 ms, out of which Lap took 327.412 ms
Solving Poisson took 828.755 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.178359 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.890 ms
Total time for convolution: 	 convolve: 5.176605 
Total time for convolution: 	 convolve: 5.178564 
Total time for convolution: 	 convolve: 5.199550 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.970 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.495 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.082 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.614 ms

This SCF took 28018.642 ms, scf error = 5.099e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.135689, lowerbound = -1.186083, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1835.862 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.413 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.731 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.168 ms
rank =  0, finding HY took 28.610 ms
rank =  0, distributing HY into block cyclic form took 22.573 ms
rank =  0, finding Y'*HY took 5.893 ms
Rank 0, Project_Hamiltonian used 83.646 ms
Total time for projection: 83.655 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -1.185511107029567
    last  calculated eigval = 0.037370109004493
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.52069830212750
lambda[   7] =  -0.52066843795819
lambda[   8] =  -0.48219346331279
lambda[   9] =  -0.41425694573221
lambda[  10] =  -0.41172293961054
lambda[  11] =  -0.35761260188162
lambda[  12] =  -0.29869272592794
lambda[  13] =  -0.29565592174895
lambda[  14] =  -0.28063903661780
lambda[  15] =  -0.26103488180814
lambda[  16] =  -0.09509691010247
lambda[  17] =  -0.02613162106117
lambda[  18] =   0.00031942737482
lambda[  19] =   0.02201339905321
lambda[  20] =   0.02285600832209
lambda[  21] =   0.03020579940407
lambda[  22] =   0.03101379163474
lambda[  23] =   0.03737010900449
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 10.482 ms
rank =  0, Distributing orbital back into band + domain format took 22.788 ms
rank = 0, Subspace_Rotation used 33.288 ms

Total time for subspace rotation: 33.294 ms
rank = 0, Efermi =  -0.124007849056 calculate fermi energy took 0.081 ms
rank = 0, --- Calculate rho: sum over local bands took 6.772 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.515 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.585 ms
rank = 0, Calculating density took 1973.097 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.915 ms
rank = 0, D2D took 2.017 ms
rank = 0, Transfering density took 2.019 ms
Etot    =   -67.653177005112
Eband   =   -16.570332571134
E1      =    33.808493871074
E2      =   -16.199942046744
E3      =   -20.922757616587
Exc     =   -18.686058041257
Esc     =  -103.327979926334
Entropy =    -0.000000000791
dE = 3.872e-06, dEband = 2.362e-03
rank = 0, Calculating/Estimating energy took 1.048 ms, Etot = -67.653177005, dEtot = 3.872e-06, dEband = 2.362e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0719944769632, which took 0.063 ms

iter_count = 108, r_2norm = 2.272e-06, tol*||rhs|| = 2.880e-06

Anderson update took 64.499 ms, out of which F'*F took 29.976 ms; b-Ax took 204.483 ms, out of which Lap took 181.179 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 465.863 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653937, int_b + int_rho = -7.276e-14, checking this took 0.109 ms
2-norm of RHS = 729.4136430062621, which took 0.158 ms

iter_count = 192, r_2norm = 5.874e-04, tol*||rhs|| = 7.294e-04

Anderson update took 116.330 ms, out of which F'*F took 53.732 ms; b-Ax took 358.215 ms, out of which Lap took 321.446 ms
Solving Poisson took 805.612 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.181798 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
Total time for convolution: 	 convolve: 5.184641 
Total time for convolution: 	 convolve: 5.164883 
Total time for convolution: 	 convolve: 5.196503 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.718 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 3.506 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.052 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.099 ms

This SCF took 27950.649 ms, scf error = 2.837e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.137370, lowerbound = -1.185511, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1826.792 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 22.280 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.911 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.211 ms
rank =  0, finding HY took 28.538 ms
rank =  0, distributing HY into block cyclic form took 22.767 ms
rank =  0, finding Y'*HY took 5.715 ms
Rank 0, Project_Hamiltonian used 83.260 ms
Total time for projection: 83.269 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.223 ms
    first calculated eigval = -1.185077709808612
    last  calculated eigval = 0.038769355208833
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.52028007783248
lambda[   7] =  -0.52019624378789
lambda[   8] =  -0.48176720545169
lambda[   9] =  -0.41359476163438
lambda[  10] =  -0.41104499585468
lambda[  11] =  -0.35697232727749
lambda[  12] =  -0.29826963007686
lambda[  13] =  -0.29518056972525
lambda[  14] =  -0.28007406361139
lambda[  15] =  -0.26059314242089
lambda[  16] =  -0.09468297573020
lambda[  17] =  -0.02410616357561
lambda[  18] =   0.00177004889074
lambda[  19] =   0.02370607887416
lambda[  20] =   0.02621006915887
lambda[  21] =   0.02990919264761
lambda[  22] =   0.03211239567194
lambda[  23] =   0.03876935520883
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.238 ms
rank =  0, subspace rotation using ScaLAPACK took 10.426 ms
rank =  0, Distributing orbital back into band + domain format took 22.722 ms
rank = 0, Subspace_Rotation used 33.170 ms

Total time for subspace rotation: 33.178 ms
rank = 0, Efermi =  -0.123593914696 calculate fermi energy took 0.076 ms
rank = 0, --- Calculate rho: sum over local bands took 6.973 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.386 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.617 ms
rank = 0, Calculating density took 1963.600 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.935 ms
rank = 0, D2D took 2.029 ms
rank = 0, Transfering density took 2.032 ms
Etot    =   -67.653218944149
Eband   =   -16.554579403303
E1      =    33.800773174922
E2      =   -16.191650697840
E3      =   -20.923783807181
Exc     =   -18.686867293664
Esc     =  -103.327979926334
Entropy =    -0.000000000791
dE = 5.242e-06, dEband = 1.969e-03
rank = 0, Calculating/Estimating energy took 1.046 ms, Etot = -67.653218944, dEtot = 5.242e-06, dEband = 1.969e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0460408681442, which took 0.077 ms

iter_count = 114, r_2norm = 1.186e-06, tol*||rhs|| = 1.842e-06

Anderson update took 68.227 ms, out of which F'*F took 31.837 ms; b-Ax took 213.929 ms, out of which Lap took 191.774 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 490.155 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653940, int_b + int_rho = -3.638e-14, checking this took 0.106 ms
2-norm of RHS = 729.4126424694447, which took 0.067 ms

iter_count = 150, r_2norm = 6.278e-04, tol*||rhs|| = 7.294e-04

Anderson update took 90.180 ms, out of which F'*F took 41.230 ms; b-Ax took 276.872 ms, out of which Lap took 248.180 ms
Solving Poisson took 626.810 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.174895 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.377 ms
Total time for convolution: 	 convolve: 5.194549 
Total time for convolution: 	 convolve: 5.178690 
Total time for convolution: 	 convolve: 5.189053 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.236 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.073 ms
---Transfer Veff_loc: D2D took 4.359 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.247 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.639 ms

This SCF took 28076.319 ms, scf error = 1.754e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.138769, lowerbound = -1.185078, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1842.117 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.111 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.802 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.934 ms
rank =  0, finding HY took 28.789 ms
rank =  0, distributing HY into block cyclic form took 26.123 ms
rank =  0, finding Y'*HY took 4.406 ms
Rank 0, Project_Hamiltonian used 85.284 ms
Total time for projection: 85.295 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -1.184920937190000
    last  calculated eigval = 0.039103964922137
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.52013353144847
lambda[   7] =  -0.52005996681527
lambda[   8] =  -0.48162980430329
lambda[   9] =  -0.41348038251454
lambda[  10] =  -0.41093426592233
lambda[  11] =  -0.35685614385779
lambda[  12] =  -0.29813093073722
lambda[  13] =  -0.29504970046346
lambda[  14] =  -0.27996039215168
lambda[  15] =  -0.26045223417017
lambda[  16] =  -0.09453381004552
lambda[  17] =  -0.02349982176177
lambda[  18] =   0.00200199020120
lambda[  19] =   0.02389708472179
lambda[  20] =   0.02713341572788
lambda[  21] =   0.02907697148168
lambda[  22] =   0.03258796376522
lambda[  23] =   0.03910396492214
==subpsace eigenproblem: bcast eigvals took 0.038 ms
Total time for solving subspace eigenvalue problem: 0.262 ms
rank =  0, subspace rotation using ScaLAPACK took 10.508 ms
rank =  0, Distributing orbital back into band + domain format took 22.810 ms
rank = 0, Subspace_Rotation used 33.337 ms

Total time for subspace rotation: 33.342 ms
rank = 0, Efermi =  -0.123444748953 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 6.943 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.298 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.595 ms
rank = 0, Calculating density took 1980.991 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.913 ms
rank = 0, D2D took 2.008 ms
rank = 0, Transfering density took 2.011 ms
Etot    =   -67.653232249169
Eband   =   -16.550653725914
E1      =    33.798825136196
E2      =   -16.189624173745
E3      =   -20.923973290095
Exc     =   -18.687021196168
Esc     =  -103.327979926334
Entropy =    -0.000000000791
dE = 1.663e-06, dEband = 4.907e-04
rank = 0, Calculating/Estimating energy took 1.048 ms, Etot = -67.653232249, dEtot = 1.663e-06, dEband = 4.907e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0343639059018, which took 0.063 ms

iter_count = 108, r_2norm = 1.256e-06, tol*||rhs|| = 1.375e-06

Anderson update took 64.860 ms, out of which F'*F took 30.151 ms; b-Ax took 204.281 ms, out of which Lap took 180.847 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.587 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653944, int_b + int_rho = -3.638e-15, checking this took 0.104 ms
2-norm of RHS = 729.4127028290495, which took 0.199 ms

iter_count = 162, r_2norm = 5.987e-04, tol*||rhs|| = 7.294e-04

Anderson update took 97.511 ms, out of which F'*F took 44.279 ms; b-Ax took 300.629 ms, out of which Lap took 268.658 ms
Solving Poisson took 677.475 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.207493 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.183472 
Total time for convolution: 	 convolve: 5.202894 
Total time for convolution: 	 convolve: 5.173926 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.770 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 3.494 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.057 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.584 ms

This SCF took 27883.104 ms, scf error = 1.414e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.139104, lowerbound = -1.184921, upperbound = 267.578559

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1826.249 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.021 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.973 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.015 ms
rank =  0, finding HY took 28.416 ms
rank =  0, distributing HY into block cyclic form took 22.736 ms
rank =  0, finding Y'*HY took 5.871 ms
Rank 0, Project_Hamiltonian used 83.073 ms
Total time for projection: 83.083 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -1.184632286038134
    last  calculated eigval = 0.039435913915794
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.51985561488835
lambda[   7] =  -0.51979885137002
lambda[   8] =  -0.48137149183730
lambda[   9] =  -0.41323153384362
lambda[  10] =  -0.41069897193092
lambda[  11] =  -0.35660712614526
lambda[  12] =  -0.29786639511895
lambda[  13] =  -0.29478941360257
lambda[  14] =  -0.27970454461946
lambda[  15] =  -0.26019251066324
lambda[  16] =  -0.09425747779380
lambda[  17] =  -0.02292736601160
lambda[  18] =   0.00162576396652
lambda[  19] =   0.02367886478389
lambda[  20] =   0.02788116804756
lambda[  21] =   0.02835505378734
lambda[  22] =   0.03327883020363
lambda[  23] =   0.03943591391579
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 10.438 ms
rank =  0, Distributing orbital back into band + domain format took 22.539 ms
rank = 0, Subspace_Rotation used 32.994 ms

Total time for subspace rotation: 33.000 ms
rank = 0, Efermi =  -0.123168416633 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 6.821 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.681 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.616 ms
rank = 0, Calculating density took 1962.840 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.932 ms
rank = 0, D2D took 2.033 ms
rank = 0, Transfering density took 2.039 ms
Etot    =   -67.653268692805
Eband   =   -16.542767944190
E1      =    33.794768165046
E2      =   -16.185674368060
E3      =   -20.924418677257
Exc     =   -18.687382031854
Esc     =  -103.327979926334
Entropy =    -0.000000000791
dE = 4.555e-06, dEband = 9.857e-04
rank = 0, Calculating/Estimating energy took 1.607 ms, Etot = -67.653268693, dEtot = 4.555e-06, dEband = 9.857e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0350022838172, which took 0.124 ms

iter_count = 108, r_2norm = 1.166e-06, tol*||rhs|| = 1.400e-06

Anderson update took 65.272 ms, out of which F'*F took 30.488 ms; b-Ax took 205.190 ms, out of which Lap took 182.769 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.918 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002653944, int_rho =  30.00000002653960, int_b + int_rho = 1.528e-13, checking this took 0.113 ms
2-norm of RHS = 729.4144036483152, which took 0.173 ms

iter_count = 132, r_2norm = 6.687e-04, tol*||rhs|| = 7.294e-04

Anderson update took 79.550 ms, out of which F'*F took 35.942 ms; b-Ax took 247.160 ms, out of which Lap took 221.155 ms
Solving Poisson took 555.043 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.590 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.184425 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.204879 
Total time for convolution: 	 convolve: 5.185862 
Total time for convolution: 	 convolve: 5.188922 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.822 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.763 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.467 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.093 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.596 ms

This SCF took 27741.707 ms, scf error = 9.757e-05
The last 18 occupations of kpoints #1 are (Nelectron = 30):
lambda[   6] =  -0.51985561488835, occ[   6] =   2.00000000000000
lambda[   7] =  -0.51979885137002, occ[   7] =   2.00000000000000
lambda[   8] =  -0.48137149183730, occ[   8] =   2.00000000000000
lambda[   9] =  -0.41323153384362, occ[   9] =   2.00000000000000
lambda[  10] =  -0.41069897193092, occ[  10] =   2.00000000000000
lambda[  11] =  -0.35660712614526, occ[  11] =   2.00000000000000
lambda[  12] =  -0.29786639511895, occ[  12] =   2.00000000000000
lambda[  13] =  -0.29478941360257, occ[  13] =   2.00000000000000
lambda[  14] =  -0.27970454461946, occ[  14] =   2.00000000000000
lambda[  15] =  -0.26019251066324, occ[  15] =   2.00000000000000
lambda[  16] =  -0.09425747779380, occ[  16] =   0.00000002653940
lambda[  17] =  -0.02292736601160, occ[  17] =   0.00000000000000
lambda[  18] =   0.00162576396652, occ[  18] =   0.00000000000000
lambda[  19] =   0.02367886478389, occ[  19] =   0.00000000000000
lambda[  20] =   0.02788116804756, occ[  20] =   0.00000000000000
lambda[  21] =   0.02835505378734, occ[  21] =   0.00000000000000
lambda[  22] =   0.03327883020363, occ[  22] =   0.00000000000000
lambda[  23] =   0.03943591391579, occ[  23] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 21 (90%) = 0.000000000000000.
Occupation of state 23 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.371 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.515 ms, time for Allreduce/Reduce: 12.697 ms 
Time for calculating local force components: 23.366 ms
Start Calculating nonlocal forces
force_nloc = 
  1.36476523692335   0.03222209837627  -0.00000009382233
 -0.83772548182232  -1.11485970944285   0.00000019840040
 -1.01990669458458   0.05675039737081  -0.00000045008571
 -0.03290452836063   0.04011188298560   0.00000002977829
  0.03006137914462   0.00153987960877  -0.04185920690111
  0.03006139784770   0.00153991762487   0.04185922744982
  0.12954321708862   0.17290192246313   0.00000052187925
 -0.03060038152597   0.06492041222985   0.00000017552676
force_loc = 
 -1.34264096617006  -0.03130114704041  -0.00000024812157
  0.82515434243551   1.09832627662798   0.00000000189553
  0.99873089146171  -0.06780022155056  -0.00000872855789
  0.03354704141809  -0.04129633148614  -0.00000016720259
 -0.03090071972582  -0.00188468015540   0.04341891302162
 -0.03090065651415  -0.00188425772047  -0.04341906718344
 -0.12517967844160  -0.16788277700831  -0.00000038699346
  0.02816567647098  -0.06518649195889   0.00000001278287
Time for calculating nonlocal force components: 50.390 ms
[32mforces_xc: 
[0m[32m -0.03678003124264  -0.00077811779369   0.00000001906802
[0m[32m  0.02243472190487   0.03008721648254   0.00000000256667
[0m[32m  0.03388941056838  -0.00144489163669  -0.00000038067806
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00593426198183  -0.00867409739916   0.00000001135679
[0m[32m -0.00217192891119   0.00474607015368   0.00000000598249
[0mTime for calculating XC forces components: 30.858 ms
 Cartesian force = 
 -0.01474425873723   0.00012366470080   0.00000087835382
  0.00977508427018   0.01353461482631   0.00000140409231
  0.01262510919764  -0.01251388465781  -0.00000835809196
  0.00055401480958  -0.00120361734191   0.00000106380541
 -0.00092783882908  -0.00036396938800   0.00156090735022
 -0.00092775691433  -0.00036350893696  -0.00155863850391
 -0.00165922158269  -0.00367412078571   0.00000134747228
 -0.00469513221406   0.00446082158327   0.00000139552183
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.366 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Time for printing density: 385.115 ms
The program took 399.319 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:34:46
Job ID:        2266908
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:21:48,vmem=8352K,walltime=00:06:49,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-35-1
---------------------------------------
