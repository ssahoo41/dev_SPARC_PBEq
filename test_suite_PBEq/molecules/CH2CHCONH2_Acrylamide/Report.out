---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:57
Job ID:    2266530
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:02
Job ID:    2266530
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.089 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 19.398 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 10.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 41.695 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 29.609 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.011 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.200 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.369819	   12.913468	    9.934547	
    9.002737	    7.086532	    9.886194	
   15.111838	   10.041808	   10.050878	
   13.378394	    7.273463	   10.113806	
    6.605150	   12.363176	    9.980718	
    4.888162	    9.293583	    9.945698	
    8.884780	    9.137839	    9.920572	
   11.294307	   10.613851	    9.931336	
    6.664870	   10.313447	    9.951014	
   13.433003	    9.159569	    9.903738	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.289 ms
Set up communicators.

--set up spincomm took 2.205 ms

--set up kptcomm took 0.352 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 21, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 21 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 21, mbQ = nbQ = 64
rank = 0, nr_Hp = 21, nc_Hp = 21
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.080 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.379 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.448 ms

Calculate_SplineDerivRadFun took 0.303 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.796 ms.
time spent on vectorized spline interp: 3.104 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.773 ms.
time spent on vectorized spline interp: 1.378 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.277 ms.
time spent on vectorized spline interp: 1.638 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.480 ms.
time spent on vectorized spline interp: 1.744 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.500 ms.

Calculating rb for all atom types took 19.720 ms
----------------------
Estimated memory usage
Total: 1.26 GB
orbitals             : 961.30 MB
global sized vectors : 213.62 MB
subspace matrices : 10.34 kB
others : 117.49 MB
----------------------------------------------
Estimated memory usage per processor: 107.70 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.899 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -28.0000000413511, sum_int_rho = 27.4913929902125
PosCharge = 28.000000041351, NegCharge = -27.491392990212, scal_fac = 1.018500592215
After scaling, int_rho = 28.0000000413510, PosCharge + NegCharge - NetCharge = 1.243e-13
--Calculate Vref took 0.577 ms
--Calculate rho_guess took 2.918 ms

 integral of b = -28.0000000413511,
 int{b} + Nelectron + NetCharge = -4.135e-08,
 Esc = -78.9045428401674,
 MPI_Reduce took 11.380 ms

Calculating b & b_ref took 21.980 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.078 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.145 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.088 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.642 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.005 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.977 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135111, int_b + int_rho = 1.892e-13, checking this took 0.274 ms
2-norm of RHS = 764.7189785763071, which took 0.521 ms

iter_count = 420, r_2norm = 6.642e-04, tol*||rhs|| = 7.647e-04

Anderson update took 255.178 ms, out of which F'*F took 105.803 ms; b-Ax took 742.640 ms, out of which Lap took 663.315 ms
Solving Poisson took 1570.148 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
Total time for convolution: 	 convolve: 5.175677 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.738 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
Total time for convolution: 	 convolve: 5.146982 
Total time for convolution: 	 convolve: 5.143784 
Total time for convolution: 	 convolve: 5.149472 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.714 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.437 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.377 ms
rank = 0, XC calculation took 24626.246 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 4.934 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 22.726 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 28.789 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.152 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 2.662 ms
    Lanczos iter 52, eigmin  = -1.002640530, eigmax = 264.922051114, err_eigmin = 2.007e-03, err_eigmax = 9.988e-03
rank =   0, Lanczos took 120.986 ms, eigmin = -1.002640529978, eigmax = 267.571271624957

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.234316, lowerbound = -1.102641, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1503.670 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.335 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.766 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.123 ms
rank =  0, finding HY took 25.835 ms
rank =  0, distributing HY into block cyclic form took 20.042 ms
rank =  0, finding Y'*HY took 4.162 ms
Rank 0, Project_Hamiltonian used 73.192 ms
Total time for projection: 73.202 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.764 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.860 ms
    first calculated eigval = 2.730691321681599
    last  calculated eigval = 3.281071183561338
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =   2.83935305076953
lambda[   6] =   2.86729974286529
lambda[   7] =   2.89692807842976
lambda[   8] =   2.92773534112106
lambda[   9] =   2.95799696678354
lambda[  10] =   2.98654911469933
lambda[  11] =   2.99376694380903
lambda[  12] =   3.00273805179251
lambda[  13] =   3.02432430733670
lambda[  14] =   3.03789553087901
lambda[  15] =   3.08753762334857
lambda[  16] =   3.12724609804139
lambda[  17] =   3.13543815424290
lambda[  18] =   3.14895935122260
lambda[  19] =   3.16001672629367
lambda[  20] =   3.20648885770821
lambda[  21] =   3.28107118356134
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.875 ms
rank =  0, subspace rotation using ScaLAPACK took 7.979 ms
rank =  0, Distributing orbital back into band + domain format took 18.472 ms
rank = 0, Subspace_Rotation used 26.468 ms

Total time for subspace rotation: 26.471 ms
rank = 0, Efermi =   3.062728662050 calculate fermi energy took 0.053 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.381071, lowerbound = -1.102641, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1485.716 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 30.160 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.626 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 32.804 ms
rank =  0, finding HY took 25.140 ms
rank =  0, distributing HY into block cyclic form took 18.742 ms
rank =  0, finding Y'*HY took 3.966 ms
Rank 0, Project_Hamiltonian used 80.685 ms
Total time for projection: 80.690 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.117 ms
rank = 0, Solve_Generalized_EigenProblem used 1.277 ms
    first calculated eigval = -0.862645721522042
    last  calculated eigval = 0.452433131181369
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.26537071791533
lambda[   6] =  -0.20000494353788
lambda[   7] =  -0.15592180636992
lambda[   8] =  -0.04673049013721
lambda[   9] =  -0.00774223875721
lambda[  10] =   0.07517942333331
lambda[  11] =   0.12476320665828
lambda[  12] =   0.17382902704795
lambda[  13] =   0.18448053846007
lambda[  14] =   0.26621431514876
lambda[  15] =   0.31016133067975
lambda[  16] =   0.32460086595569
lambda[  17] =   0.33048442710714
lambda[  18] =   0.38152054497947
lambda[  19] =   0.40112006768924
lambda[  20] =   0.42255330906495
lambda[  21] =   0.45243313118137
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 1.286 ms
rank =  0, subspace rotation using ScaLAPACK took 7.934 ms
rank =  0, Distributing orbital back into band + domain format took 21.003 ms
rank = 0, Subspace_Rotation used 28.952 ms

Total time for subspace rotation: 28.956 ms
rank = 0, Efermi =   0.288188848510 calculate fermi energy took 0.025 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.552433, lowerbound = -1.102641, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1584.936 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 26.353 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 125.549 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 151.919 ms
rank =  0, finding HY took 20.911 ms
rank =  0, distributing HY into block cyclic form took 200.057 ms
rank =  0, finding Y'*HY took 112.531 ms
Rank 0, Project_Hamiltonian used 485.449 ms
Total time for projection: 485.453 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.145 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 10.013 ms
rank = 0, Solve_Generalized_EigenProblem used 10.162 ms
    first calculated eigval = -1.035121885547818
    last  calculated eigval = 0.160219499148674
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.59976180108335
lambda[   6] =  -0.56209489049996
lambda[   7] =  -0.54856495890757
lambda[   8] =  -0.48866347435074
lambda[   9] =  -0.46425720924927
lambda[  10] =  -0.42978182502570
lambda[  11] =  -0.40411194690161
lambda[  12] =  -0.32586938075062
lambda[  13] =  -0.30666488377837
lambda[  14] =  -0.27396967996354
lambda[  15] =  -0.07747221694926
lambda[  16] =   0.03479201601093
lambda[  17] =   0.05398493299602
lambda[  18] =   0.10857839292466
lambda[  19] =   0.11439492791536
lambda[  20] =   0.15013826785611
lambda[  21] =   0.16021949914867
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 10.171 ms
rank =  0, subspace rotation using ScaLAPACK took 7.891 ms
rank =  0, Distributing orbital back into band + domain format took 190.028 ms
rank = 0, Subspace_Rotation used 197.933 ms

Total time for subspace rotation: 197.936 ms
rank = 0, Efermi =  -0.105978434815 calculate fermi energy took 0.025 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.260219, lowerbound = -1.102641, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1445.133 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 272.192 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.704 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 274.932 ms
rank =  0, finding HY took 24.743 ms
rank =  0, distributing HY into block cyclic form took 21.321 ms
rank =  0, finding Y'*HY took 3.978 ms
Rank 0, Project_Hamiltonian used 325.002 ms
Total time for projection: 325.007 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -1.035772127330693
    last  calculated eigval = 0.103781777083364
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.60643940808798
lambda[   6] =  -0.57693631175287
lambda[   7] =  -0.55930859792017
lambda[   8] =  -0.50082520962358
lambda[   9] =  -0.47788545330783
lambda[  10] =  -0.43638537641795
lambda[  11] =  -0.43486755179180
lambda[  12] =  -0.35465109394447
lambda[  13] =  -0.32106541981260
lambda[  14] =  -0.30856341731548
lambda[  15] =  -0.15501145788514
lambda[  16] =  -0.01095749573608
lambda[  17] =  -0.00014746676669
lambda[  18] =   0.04439392015533
lambda[  19] =   0.06332989908167
lambda[  20] =   0.07404235954631
lambda[  21] =   0.10378177708336
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.225 ms
rank =  0, subspace rotation using ScaLAPACK took 7.854 ms
rank =  0, Distributing orbital back into band + domain format took 18.430 ms
rank = 0, Subspace_Rotation used 26.297 ms

Total time for subspace rotation: 26.301 ms
rank = 0, Efermi =  -0.183517675781 calculate fermi energy took 0.022 ms
rank = 0, --- Calculate rho: sum over local bands took 5.468 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.928 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.583 ms
rank = 0, Calculating density took 7417.522 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.795 ms
rank = 0, D2D took 1.890 ms
rank = 0, Transfering density took 1.892 ms
Etot    =   -48.094261706523
Eband   =   -16.123237070983
E1      =    32.162928059077
E2      =   -13.043235277313
E3      =   -16.557002768222
Exc     =   -14.829647898769
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 4.809e+00, dEband = 1.612e+00
rank = 0, Calculating/Estimating energy took 0.946 ms, Etot = -48.094261707, dEtot = 4.809e+00, dEband = 1.612e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 60.1370497374785, which took 1.258 ms

iter_count = 96, r_2norm = 1.794e-03, tol*||rhs|| = 2.405e-03

Anderson update took 51.369 ms, out of which F'*F took 23.982 ms; b-Ax took 163.548 ms, out of which Lap took 146.499 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.121 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135106, int_b + int_rho = 1.382e-13, checking this took 0.109 ms
2-norm of RHS = 759.7733662760562, which took 0.125 ms

iter_count = 288, r_2norm = 6.037e-04, tol*||rhs|| = 7.598e-04

Anderson update took 236.591 ms, out of which F'*F took 97.665 ms; b-Ax took 608.560 ms, out of which Lap took 557.707 ms
Solving Poisson took 1316.826 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.520 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.199507 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 77.252 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.258957 
Total time for convolution: 	 convolve: 5.295521 
Total time for convolution: 	 convolve: 5.289186 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.345 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.563 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.223 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.826 ms

This SCF took 34217.986 ms, scf error = 1.674e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.203782, lowerbound = -1.035772, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1487.260 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.471 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.551 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.039 ms
rank =  0, finding HY took 25.151 ms
rank =  0, distributing HY into block cyclic form took 18.646 ms
rank =  0, finding Y'*HY took 4.085 ms
Rank 0, Project_Hamiltonian used 68.955 ms
Total time for projection: 68.967 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.160 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.267 ms
    first calculated eigval = -1.008621610897175
    last  calculated eigval = 0.068675477014415
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.57544564700659
lambda[   6] =  -0.54560563164606
lambda[   7] =  -0.52666781538243
lambda[   8] =  -0.46492947496738
lambda[   9] =  -0.44499513117206
lambda[  10] =  -0.41736373485788
lambda[  11] =  -0.40593327133063
lambda[  12] =  -0.32266912800073
lambda[  13] =  -0.28639126672169
lambda[  14] =  -0.27507238351340
lambda[  15] =  -0.13407737775597
lambda[  16] =  -0.02225383614702
lambda[  17] =  -0.00737589594391
lambda[  18] =   0.01363074721383
lambda[  19] =   0.03270934704008
lambda[  20] =   0.03651373184583
lambda[  21] =   0.06867547701442
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.297 ms
rank =  0, subspace rotation using ScaLAPACK took 7.746 ms
rank =  0, Distributing orbital back into band + domain format took 18.616 ms
rank = 0, Subspace_Rotation used 26.379 ms

Total time for subspace rotation: 26.383 ms
rank = 0, Efermi =  -0.162583595629 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.379 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.643 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1599.642 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.812 ms
rank = 0, D2D took 1.912 ms
rank = 0, Transfering density took 1.915 ms
Etot    =   -48.014581355105
Eband   =   -15.241133700272
E1      =    31.408545823939
E2      =   -12.949718533945
E3      =   -16.787995506349
Exc     =   -15.015164677683
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 7.968e-03, dEband = 8.821e-02
rank = 0, Calculating/Estimating energy took 0.951 ms, Etot = -48.014581355, dEtot = 7.968e-03, dEband = 8.821e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 24.0759438989384, which took 0.047 ms

iter_count = 102, r_2norm = 7.545e-04, tol*||rhs|| = 9.630e-04

Anderson update took 57.618 ms, out of which F'*F took 26.589 ms; b-Ax took 176.049 ms, out of which Lap took 158.003 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 379.628 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135092, int_b + int_rho = -1.091e-14, checking this took 0.121 ms
2-norm of RHS = 754.8570871842171, which took 0.110 ms

iter_count = 294, r_2norm = 7.238e-04, tol*||rhs|| = 7.549e-04

Anderson update took 159.631 ms, out of which F'*F took 73.047 ms; b-Ax took 501.225 ms, out of which Lap took 448.128 ms
Solving Poisson took 1054.034 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.236773 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.217906 
Total time for convolution: 	 convolve: 5.240254 
Total time for convolution: 	 convolve: 5.294098 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.440 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 3.690 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.229 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.958 ms

This SCF took 28092.862 ms, scf error = 1.089e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.168675, lowerbound = -1.008622, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1475.667 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.995 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.011 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.024 ms
rank =  0, finding HY took 25.778 ms
rank =  0, distributing HY into block cyclic form took 18.612 ms
rank =  0, finding Y'*HY took 4.147 ms
Rank 0, Project_Hamiltonian used 73.599 ms
Total time for projection: 73.617 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.972432024626919
    last  calculated eigval = 0.052250144375505
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.53466896665019
lambda[   6] =  -0.50203642358630
lambda[   7] =  -0.48219751009500
lambda[   8] =  -0.41103388758808
lambda[   9] =  -0.40059060462288
lambda[  10] =  -0.39142635402157
lambda[  11] =  -0.36223535050076
lambda[  12] =  -0.27792441120342
lambda[  13] =  -0.24923959222700
lambda[  14] =  -0.23423792348996
lambda[  15] =  -0.09760813374430
lambda[  16] =  -0.03017318548422
lambda[  17] =   0.00552030398506
lambda[  18] =   0.00853266339436
lambda[  19] =   0.01999057650895
lambda[  20] =   0.03003148072892
lambda[  21] =   0.05225014437551
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 7.889 ms
rank =  0, Distributing orbital back into band + domain format took 18.527 ms
rank = 0, Subspace_Rotation used 26.436 ms

Total time for subspace rotation: 26.441 ms
rank = 0, Efermi =  -0.126114351662 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 5.425 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.583 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.647 ms
rank = 0, Calculating density took 1592.774 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.826 ms
rank = 0, D2D took 1.928 ms
rank = 0, Transfering density took 1.934 ms
Etot    =   -47.965248660442
Eband   =   -14.048453000957
E1      =    30.422027439268
E2      =   -12.726065473165
E3      =   -17.126113231525
Exc     =   -15.286458962060
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 4.933e-03, dEband = 1.193e-01
rank = 0, Calculating/Estimating energy took 0.911 ms, Etot = -47.965248660, dEtot = 4.933e-03, dEband = 1.193e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.0146524564228, which took 0.050 ms

iter_count = 108, r_2norm = 1.531e-04, tol*||rhs|| = 2.406e-04

Anderson update took 57.233 ms, out of which F'*F took 27.140 ms; b-Ax took 185.594 ms, out of which Lap took 165.574 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.455 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135106, int_b + int_rho = 1.310e-13, checking this took 1.122 ms
2-norm of RHS = 755.1250106133602, which took 0.080 ms

iter_count = 282, r_2norm = 6.894e-04, tol*||rhs|| = 7.551e-04

Anderson update took 151.404 ms, out of which F'*F took 71.051 ms; b-Ax took 482.521 ms, out of which Lap took 432.322 ms
Solving Poisson took 1014.880 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.273099 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.266006 
Total time for convolution: 	 convolve: 5.211742 
Total time for convolution: 	 convolve: 5.238886 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.402 ms
---Transfer Veff_loc: D2D took 3.590 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.246 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.868 ms

This SCF took 28768.056 ms, scf error = 4.597e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.152250, lowerbound = -0.972432, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1464.942 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.420 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.718 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.161 ms
rank =  0, finding HY took 25.089 ms
rank =  0, distributing HY into block cyclic form took 18.729 ms
rank =  0, finding Y'*HY took 3.996 ms
Rank 0, Project_Hamiltonian used 69.016 ms
Total time for projection: 69.028 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.139 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -0.958349782166881
    last  calculated eigval = 0.043343577273483
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.52024833780147
lambda[   6] =  -0.48542026872332
lambda[   7] =  -0.46200758643923
lambda[   8] =  -0.38713578568042
lambda[   9] =  -0.38394224559135
lambda[  10] =  -0.37864215219617
lambda[  11] =  -0.34034779710563
lambda[  12] =  -0.26070254131010
lambda[  13] =  -0.24481883739714
lambda[  14] =  -0.22347373685258
lambda[  15] =  -0.08245811470579
lambda[  16] =  -0.03351225103232
lambda[  17] =   0.00356290200166
lambda[  18] =   0.00984742348164
lambda[  19] =   0.01910753234036
lambda[  20] =   0.03439336804411
lambda[  21] =   0.04334357727348
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.244 ms
rank =  0, subspace rotation using ScaLAPACK took 7.874 ms
rank =  0, Distributing orbital back into band + domain format took 18.585 ms
rank = 0, Subspace_Rotation used 26.480 ms

Total time for subspace rotation: 26.485 ms
rank = 0, Efermi =  -0.110964332658 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 5.463 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.669 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.633 ms
rank = 0, Calculating density took 1578.586 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.990 ms
rank = 0, D2D took 2.106 ms
rank = 0, Transfering density took 2.113 ms
Etot    =   -47.957014512301
Eband   =   -13.591697756592
E1      =    30.114800230086
E2      =   -12.555688427859
E3      =   -17.259083661041
Exc     =   -15.390346233313
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 8.234e-04, dEband = 4.568e-02
rank = 0, Calculating/Estimating energy took 0.898 ms, Etot = -47.957014512, dEtot = 8.234e-04, dEband = 4.568e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.0377782427340, which took 0.111 ms

iter_count = 108, r_2norm = 9.169e-05, tol*||rhs|| = 1.215e-04

Anderson update took 62.544 ms, out of which F'*F took 26.869 ms; b-Ax took 183.424 ms, out of which Lap took 164.291 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 401.418 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135094, int_b + int_rho = 1.091e-14, checking this took 0.114 ms
2-norm of RHS = 755.3364931426385, which took 0.119 ms

iter_count = 258, r_2norm = 6.171e-04, tol*||rhs|| = 7.553e-04

Anderson update took 138.352 ms, out of which F'*F took 64.533 ms; b-Ax took 440.043 ms, out of which Lap took 393.411 ms
Solving Poisson took 925.802 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.320511 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 6.479812 
Total time for convolution: 	 convolve: 5.364280 
Total time for convolution: 	 convolve: 5.253546 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.519 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.656 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.210 ms

This SCF took 29375.379 ms, scf error = 1.311e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.143344, lowerbound = -0.958350, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1459.733 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 18.414 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.620 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.049 ms
rank =  0, finding HY took 25.137 ms
rank =  0, distributing HY into block cyclic form took 18.293 ms
rank =  0, finding Y'*HY took 4.150 ms
Rank 0, Project_Hamiltonian used 68.662 ms
Total time for projection: 68.675 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.212 ms
    first calculated eigval = -0.951855809439862
    last  calculated eigval = 0.037175992931891
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.51583819159616
lambda[   6] =  -0.48064440284106
lambda[   7] =  -0.45657677519921
lambda[   8] =  -0.38167836107227
lambda[   9] =  -0.37695288537716
lambda[  10] =  -0.37420877147651
lambda[  11] =  -0.33379776314443
lambda[  12] =  -0.25663316025295
lambda[  13] =  -0.23951170419940
lambda[  14] =  -0.21609788696559
lambda[  15] =  -0.07848934044729
lambda[  16] =  -0.03483253136320
lambda[  17] =   0.00280833536294
lambda[  18] =   0.00865276031664
lambda[  19] =   0.01813504395268
lambda[  20] =   0.03542810571653
lambda[  21] =   0.03717599293189
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 7.768 ms
rank =  0, Distributing orbital back into band + domain format took 18.504 ms
rank = 0, Subspace_Rotation used 26.288 ms

Total time for subspace rotation: 26.292 ms
rank = 0, Efermi =  -0.106995558394 calculate fermi energy took 0.658 ms
rank = 0, --- Calculate rho: sum over local bands took 5.370 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.548 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 1572.162 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.848 ms
rank = 0, D2D took 1.945 ms
rank = 0, Transfering density took 1.948 ms
Etot    =   -47.955790682656
Eband   =   -13.440802926571
E1      =    30.029191840181
E2      =   -12.481119078294
E3      =   -17.300103936694
Exc     =   -15.420859769870
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 1.224e-04, dEband = 1.509e-02
rank = 0, Calculating/Estimating energy took 1.192 ms, Etot = -47.955790683, dEtot = 1.224e-04, dEband = 1.509e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.3547742662668, which took 0.071 ms

iter_count = 108, r_2norm = 5.250e-05, tol*||rhs|| = 5.419e-05

Anderson update took 57.788 ms, out of which F'*F took 27.161 ms; b-Ax took 187.678 ms, out of which Lap took 165.198 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.643 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135105, int_b + int_rho = 1.237e-13, checking this took 0.103 ms
2-norm of RHS = 755.8181116414788, which took 0.110 ms

iter_count = 240, r_2norm = 6.547e-04, tol*||rhs|| = 7.558e-04

Anderson update took 133.450 ms, out of which F'*F took 59.677 ms; b-Ax took 429.016 ms, out of which Lap took 386.453 ms
Solving Poisson took 885.652 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.299691 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.211361 
Total time for convolution: 	 convolve: 5.245321 
Total time for convolution: 	 convolve: 5.214709 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.374 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.158 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 3.558 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.168 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.761 ms

This SCF took 27969.949 ms, scf error = 7.475e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.137176, lowerbound = -0.951856, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1464.760 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.459 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.608 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.083 ms
rank =  0, finding HY took 25.263 ms
rank =  0, distributing HY into block cyclic form took 18.489 ms
rank =  0, finding Y'*HY took 4.335 ms
Rank 0, Project_Hamiltonian used 69.201 ms
Total time for projection: 69.214 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.221 ms
    first calculated eigval = -0.949720115637221
    last  calculated eigval = 0.036025028351621
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.51427699371294
lambda[   6] =  -0.47900713664629
lambda[   7] =  -0.45454051095963
lambda[   8] =  -0.38017294262302
lambda[   9] =  -0.37461124854375
lambda[  10] =  -0.37222242296655
lambda[  11] =  -0.33128831018559
lambda[  12] =  -0.25526669798059
lambda[  13] =  -0.23783625896236
lambda[  14] =  -0.21383495323669
lambda[  15] =  -0.07690405664501
lambda[  16] =  -0.03531436423662
lambda[  17] =   0.00254753986843
lambda[  18] =   0.00807315650444
lambda[  19] =   0.01781964503126
lambda[  20] =   0.03231028587232
lambda[  21] =   0.03602502835162
==subpsace eigenproblem: bcast eigvals took 0.050 ms
Total time for solving subspace eigenvalue problem: 0.279 ms
rank =  0, subspace rotation using ScaLAPACK took 7.848 ms
rank =  0, Distributing orbital back into band + domain format took 18.514 ms
rank = 0, Subspace_Rotation used 26.378 ms

Total time for subspace rotation: 26.382 ms
rank = 0, Efermi =  -0.105410274583 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.481 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.529 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1577.419 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.889 ms
rank = 0, D2D took 1.986 ms
rank = 0, Transfering density took 1.994 ms
Etot    =   -47.955367570188
Eband   =   -13.389415289212
E1      =    30.019759566826
E2      =   -12.436264828904
E3      =   -17.307675965157
Exc     =   -15.425109800481
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 4.231e-05, dEband = 5.139e-03
rank = 0, Calculating/Estimating energy took 1.250 ms, Etot = -47.955367570, dEtot = 4.231e-05, dEband = 5.139e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6831588709460, which took 0.130 ms

iter_count = 108, r_2norm = 2.602e-05, tol*||rhs|| = 2.733e-05

Anderson update took 57.855 ms, out of which F'*F took 26.826 ms; b-Ax took 183.429 ms, out of which Lap took 163.989 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.399 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135102, int_b + int_rho = 9.095e-14, checking this took 0.103 ms
2-norm of RHS = 756.1100381671251, which took 0.122 ms

iter_count = 240, r_2norm = 7.057e-04, tol*||rhs|| = 7.561e-04

Anderson update took 128.013 ms, out of which F'*F took 59.269 ms; b-Ax took 406.690 ms, out of which Lap took 362.951 ms
Solving Poisson took 859.422 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.230128 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.267964 
Total time for convolution: 	 convolve: 5.247490 
Total time for convolution: 	 convolve: 5.249143 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.394 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
---Transfer Veff_loc: D2D took 3.741 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.178 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.960 ms

This SCF took 27991.428 ms, scf error = 4.060e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.136025, lowerbound = -0.949720, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1488.479 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.429 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.650 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.096 ms
rank =  0, finding HY took 25.177 ms
rank =  0, distributing HY into block cyclic form took 18.286 ms
rank =  0, finding Y'*HY took 4.060 ms
Rank 0, Project_Hamiltonian used 68.649 ms
Total time for projection: 68.663 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -0.947631842680335
    last  calculated eigval = 0.037469502625577
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.51220637955989
lambda[   6] =  -0.47677596054515
lambda[   7] =  -0.45189779635601
lambda[   8] =  -0.37749686825142
lambda[   9] =  -0.37221118147655
lambda[  10] =  -0.36995476335174
lambda[  11] =  -0.32854894450156
lambda[  12] =  -0.25252105267296
lambda[  13] =  -0.23588601654655
lambda[  14] =  -0.21167928669587
lambda[  15] =  -0.07439468453957
lambda[  16] =  -0.03532487461038
lambda[  17] =   0.00291977018614
lambda[  18] =   0.00817307630155
lambda[  19] =   0.01816938294345
lambda[  20] =   0.02884574333018
lambda[  21] =   0.03746950262558
==subpsace eigenproblem: bcast eigvals took 0.063 ms
Total time for solving subspace eigenvalue problem: 0.295 ms
rank =  0, subspace rotation using ScaLAPACK took 7.762 ms
rank =  0, Distributing orbital back into band + domain format took 19.654 ms
rank = 0, Subspace_Rotation used 27.435 ms

Total time for subspace rotation: 27.438 ms
rank = 0, Efermi =  -0.102900902443 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.439 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.556 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.571 ms
rank = 0, Calculating density took 1601.638 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.817 ms
rank = 0, D2D took 1.915 ms
rank = 0, Transfering density took 1.922 ms
Etot    =   -47.955100479967
Eband   =   -13.322580888420
E1      =    29.994090987055
E2      =   -12.392623175182
E3      =   -17.315063000034
Exc     =   -15.429753912434
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 2.671e-05, dEband = 6.683e-03
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -47.955100480, dEtot = 2.671e-05, dEband = 6.683e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3035045683738, which took 0.059 ms

iter_count = 114, r_2norm = 8.576e-06, tol*||rhs|| = 1.214e-05

Anderson update took 60.565 ms, out of which F'*F took 28.388 ms; b-Ax took 196.212 ms, out of which Lap took 175.246 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.358 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135100, int_b + int_rho = 7.640e-14, checking this took 0.108 ms
2-norm of RHS = 756.2263932627728, which took 0.130 ms

iter_count = 240, r_2norm = 6.771e-04, tol*||rhs|| = 7.562e-04

Anderson update took 127.181 ms, out of which F'*F took 59.690 ms; b-Ax took 407.110 ms, out of which Lap took 363.850 ms
Solving Poisson took 861.829 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.284887 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.381 ms
Total time for convolution: 	 convolve: 5.330792 
Total time for convolution: 	 convolve: 5.332886 
Total time for convolution: 	 convolve: 5.282920 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.582 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.603 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.417 ms
---Transfer Veff_loc: D2D took 3.614 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.105 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.755 ms

This SCF took 28159.028 ms, scf error = 2.267e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.137470, lowerbound = -0.947632, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1467.918 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.456 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.627 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.099 ms
rank =  0, finding HY took 25.041 ms
rank =  0, distributing HY into block cyclic form took 18.320 ms
rank =  0, finding Y'*HY took 4.071 ms
Rank 0, Project_Hamiltonian used 68.561 ms
Total time for projection: 68.574 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.240 ms
    first calculated eigval = -0.944162661612690
    last  calculated eigval = 0.040392618623239
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50980755105063
lambda[   6] =  -0.47420869167144
lambda[   7] =  -0.44844098647034
lambda[   8] =  -0.37384642650354
lambda[   9] =  -0.36869873111040
lambda[  10] =  -0.36670178370141
lambda[  11] =  -0.32489947669044
lambda[  12] =  -0.24886324907787
lambda[  13] =  -0.23326609692973
lambda[  14] =  -0.20808974468529
lambda[  15] =  -0.07096223800880
lambda[  16] =  -0.03472932661920
lambda[  17] =   0.00429522170769
lambda[  18] =   0.00952239118489
lambda[  19] =   0.01944453127522
lambda[  20] =   0.02723721259486
lambda[  21] =   0.04039261862324
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.278 ms
rank =  0, subspace rotation using ScaLAPACK took 7.807 ms
rank =  0, Distributing orbital back into band + domain format took 19.861 ms
rank = 0, Subspace_Rotation used 27.688 ms

Total time for subspace rotation: 27.693 ms
rank = 0, Efermi =  -0.099468455910 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.146 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.073 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 1581.410 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.832 ms
rank = 0, D2D took 1.932 ms
rank = 0, Transfering density took 1.938 ms
Etot    =   -47.954960423194
Eband   =   -13.232033638295
E1      =    29.949467987599
E2      =   -12.343783232019
E3      =   -17.325565529764
Exc     =   -15.437200692899
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 1.401e-05, dEband = 9.055e-03
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -47.954960423, dEtot = 1.401e-05, dEband = 9.055e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2544363738750, which took 0.116 ms

iter_count = 108, r_2norm = 9.469e-06, tol*||rhs|| = 1.018e-05

Anderson update took 57.412 ms, out of which F'*F took 26.845 ms; b-Ax took 185.056 ms, out of which Lap took 165.312 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.792 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135090, int_b + int_rho = -2.547e-14, checking this took 0.115 ms
2-norm of RHS = 756.1988490869467, which took 0.134 ms

iter_count = 222, r_2norm = 6.497e-04, tol*||rhs|| = 7.562e-04

Anderson update took 117.830 ms, out of which F'*F took 56.388 ms; b-Ax took 379.692 ms, out of which Lap took 339.993 ms
Solving Poisson took 796.630 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.327813 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.265332 
Total time for convolution: 	 convolve: 5.270787 
Total time for convolution: 	 convolve: 5.281661 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 0.837 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.298 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.534 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.142 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.716 ms

This SCF took 27963.290 ms, scf error = 1.228e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.140393, lowerbound = -0.944163, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1465.685 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.314 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.581 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.911 ms
rank =  0, finding HY took 25.202 ms
rank =  0, distributing HY into block cyclic form took 18.309 ms
rank =  0, finding Y'*HY took 4.009 ms
Rank 0, Project_Hamiltonian used 68.461 ms
Total time for projection: 68.474 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.247 ms
    first calculated eigval = -0.942207686250199
    last  calculated eigval = 0.042419421759823
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50839339358495
lambda[   6] =  -0.47275236358097
lambda[   7] =  -0.44658255151318
lambda[   8] =  -0.37196673000946
lambda[   9] =  -0.36680890332410
lambda[  10] =  -0.36485020291081
lambda[  11] =  -0.32290856443864
lambda[  12] =  -0.24704890477500
lambda[  13] =  -0.23178673879348
lambda[  14] =  -0.20617679897484
lambda[  15] =  -0.06913859926235
lambda[  16] =  -0.03339040787308
lambda[  17] =   0.00587045249565
lambda[  18] =   0.01133815070109
lambda[  19] =   0.02114068347888
lambda[  20] =   0.02689915866390
lambda[  21] =   0.04241942175982
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.266 ms
rank =  0, subspace rotation using ScaLAPACK took 7.862 ms
rank =  0, Distributing orbital back into band + domain format took 19.195 ms
rank = 0, Subspace_Rotation used 27.071 ms

Total time for subspace rotation: 27.076 ms
rank = 0, Efermi =  -0.097644817169 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.429 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.544 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.574 ms
rank = 0, Calculating density took 1578.166 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.899 ms
rank = 0, D2D took 1.999 ms
rank = 0, Transfering density took 2.002 ms
Etot    =   -47.954965552897
Eband   =   -13.182892109168
E1      =    29.923576130445
E2      =   -12.319406786588
E3      =   -17.330322664039
Exc     =   -15.440836183418
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 5.130e-07, dEband = 4.914e-03
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -47.954965553, dEtot = 5.130e-07, dEband = 4.914e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1363318543209, which took 0.051 ms

iter_count = 114, r_2norm = 3.384e-06, tol*||rhs|| = 5.453e-06

Anderson update took 60.671 ms, out of which F'*F took 28.321 ms; b-Ax took 195.005 ms, out of which Lap took 173.939 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.640 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135091, int_b + int_rho = -1.455e-14, checking this took 0.105 ms
2-norm of RHS = 756.1848716504469, which took 0.102 ms

iter_count = 210, r_2norm = 6.327e-04, tol*||rhs|| = 7.562e-04

Anderson update took 112.489 ms, out of which F'*F took 53.295 ms; b-Ax took 359.356 ms, out of which Lap took 321.494 ms
Solving Poisson took 755.857 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Total time for convolution: 	 convolve: 5.287119 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.253198 
Total time for convolution: 	 convolve: 5.225458 
Total time for convolution: 	 convolve: 5.225654 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.524 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.104 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.663 ms

This SCF took 27815.000 ms, scf error = 7.905e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.142419, lowerbound = -0.942208, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1468.454 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 18.356 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.666 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.039 ms
rank =  0, finding HY took 25.197 ms
rank =  0, distributing HY into block cyclic form took 18.332 ms
rank =  0, finding Y'*HY took 4.010 ms
Rank 0, Project_Hamiltonian used 68.635 ms
Total time for projection: 68.650 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -0.941324374246771
    last  calculated eigval = 0.043784838986787
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50762977988029
lambda[   6] =  -0.47196448906313
lambda[   7] =  -0.44570561999828
lambda[   8] =  -0.37112299320867
lambda[   9] =  -0.36590122123962
lambda[  10] =  -0.36394314079754
lambda[  11] =  -0.32197404842005
lambda[  12] =  -0.24612424514688
lambda[  13] =  -0.23095535199000
lambda[  14] =  -0.20528803936171
lambda[  15] =  -0.06818896927154
lambda[  16] =  -0.03127600361366
lambda[  17] =   0.00849058663625
lambda[  18] =   0.01341332469892
lambda[  19] =   0.02307869851936
lambda[  20] =   0.02679815323598
lambda[  21] =   0.04378483898679
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.253 ms
rank =  0, subspace rotation using ScaLAPACK took 7.862 ms
rank =  0, Distributing orbital back into band + domain format took 18.813 ms
rank = 0, Subspace_Rotation used 26.691 ms

Total time for subspace rotation: 26.696 ms
rank = 0, Efermi =  -0.096695187234 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.382 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.618 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.677 ms
rank = 0, Calculating density took 1580.855 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.843 ms
rank = 0, D2D took 1.944 ms
rank = 0, Transfering density took 1.951 ms
Etot    =   -47.955007184626
Eband   =   -13.158789966212
E1      =    29.912576390155
E2      =   -12.306233958954
E3      =   -17.330608542081
Exc     =   -15.441093268221
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 4.163e-06, dEband = 2.410e-03
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -47.955007185, dEtot = 4.163e-06, dEband = 2.410e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0642135000189, which took 0.053 ms

iter_count = 114, r_2norm = 1.991e-06, tol*||rhs|| = 2.569e-06

Anderson update took 60.653 ms, out of which F'*F took 28.816 ms; b-Ax took 195.055 ms, out of which Lap took 174.200 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.557 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135082, int_b + int_rho = -1.091e-13, checking this took 0.104 ms
2-norm of RHS = 756.1905074204279, which took 0.072 ms

iter_count = 192, r_2norm = 7.303e-04, tol*||rhs|| = 7.562e-04

Anderson update took 102.281 ms, out of which F'*F took 49.201 ms; b-Ax took 329.627 ms, out of which Lap took 294.960 ms
Solving Poisson took 690.676 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.211814 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.238955 
Total time for convolution: 	 convolve: 5.224167 
Total time for convolution: 	 convolve: 5.236885 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.829 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.531 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.148 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.718 ms

This SCF took 27962.241 ms, scf error = 4.883e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.143785, lowerbound = -0.941324, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1464.634 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.424 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.667 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.107 ms
rank =  0, finding HY took 25.066 ms
rank =  0, distributing HY into block cyclic form took 18.334 ms
rank =  0, finding Y'*HY took 4.038 ms
Rank 0, Project_Hamiltonian used 68.574 ms
Total time for projection: 68.585 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.230 ms
    first calculated eigval = -0.940615389545325
    last  calculated eigval = 0.044330246911853
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50696155412923
lambda[   6] =  -0.47121930118214
lambda[   7] =  -0.44488083691744
lambda[   8] =  -0.37027601115076
lambda[   9] =  -0.36515134550918
lambda[  10] =  -0.36320105170619
lambda[  11] =  -0.32112783356223
lambda[  12] =  -0.24526351160759
lambda[  13] =  -0.23026532232150
lambda[  14] =  -0.20452593887496
lambda[  15] =  -0.06741518566277
lambda[  16] =  -0.02866519017341
lambda[  17] =   0.01100455789988
lambda[  18] =   0.01576865116680
lambda[  19] =   0.02518171983355
lambda[  20] =   0.02698848713905
lambda[  21] =   0.04433024691185
==subpsace eigenproblem: bcast eigvals took 0.041 ms
Total time for solving subspace eigenvalue problem: 0.281 ms
rank =  0, subspace rotation using ScaLAPACK took 7.738 ms
rank =  0, Distributing orbital back into band + domain format took 18.604 ms
rank = 0, Subspace_Rotation used 26.356 ms

Total time for subspace rotation: 26.360 ms
rank = 0, Efermi =  -0.095921403583 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.504 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.563 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 1576.625 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.814 ms
rank = 0, D2D took 1.924 ms
rank = 0, Transfering density took 1.927 ms
Etot    =   -47.955098366821
Eband   =   -13.137270091425
E1      =    29.901931629702
E2      =   -12.295003339092
E3      =   -17.332061542823
Exc     =   -15.442281945630
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 9.118e-06, dEband = 2.152e-03
rank = 0, Calculating/Estimating energy took 0.934 ms, Etot = -47.955098367, dEtot = 9.118e-06, dEband = 2.152e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0536729585934, which took 0.066 ms

iter_count = 114, r_2norm = 1.771e-06, tol*||rhs|| = 2.147e-06

Anderson update took 60.625 ms, out of which F'*F took 28.391 ms; b-Ax took 195.056 ms, out of which Lap took 173.775 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.739 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135097, int_b + int_rho = 4.002e-14, checking this took 0.103 ms
2-norm of RHS = 756.1943177784542, which took 0.138 ms

iter_count = 156, r_2norm = 6.874e-04, tol*||rhs|| = 7.562e-04

Anderson update took 83.224 ms, out of which F'*F took 39.334 ms; b-Ax took 267.204 ms, out of which Lap took 238.451 ms
Solving Poisson took 561.779 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.964 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.232311 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.255923 
Total time for convolution: 	 convolve: 5.243773 
Total time for convolution: 	 convolve: 5.261119 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.533 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.985 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.570 ms

This SCF took 27594.633 ms, scf error = 3.073e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.144330, lowerbound = -0.940615, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1470.560 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 18.389 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.634 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.039 ms
rank =  0, finding HY took 25.074 ms
rank =  0, distributing HY into block cyclic form took 18.258 ms
rank =  0, finding Y'*HY took 4.076 ms
Rank 0, Project_Hamiltonian used 68.475 ms
Total time for projection: 68.486 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.226 ms
    first calculated eigval = -0.940347452162160
    last  calculated eigval = 0.044280723779962
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50672400473301
lambda[   6] =  -0.47098198582172
lambda[   7] =  -0.44462737275777
lambda[   8] =  -0.37002521929305
lambda[   9] =  -0.36489752991125
lambda[  10] =  -0.36294693894225
lambda[  11] =  -0.32087906033179
lambda[  12] =  -0.24500876337582
lambda[  13] =  -0.23002162170445
lambda[  14] =  -0.20426936286660
lambda[  15] =  -0.06718329201239
lambda[  16] =  -0.02773582917680
lambda[  17] =   0.01168268090805
lambda[  18] =   0.01659654439373
lambda[  19] =   0.02581583166701
lambda[  20] =   0.02667846191391
lambda[  21] =   0.04428072377996
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 7.870 ms
rank =  0, Distributing orbital back into band + domain format took 18.447 ms
rank = 0, Subspace_Rotation used 26.333 ms

Total time for subspace rotation: 26.337 ms
rank = 0, Efermi =  -0.095689509930 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.390 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.717 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1582.421 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.821 ms
rank = 0, D2D took 1.915 ms
rank = 0, Transfering density took 1.917 ms
Etot    =   -47.955141873608
Eband   =   -13.130229481315
E1      =    29.898381841855
E2      =   -12.291386909612
E3      =   -17.332522400433
Exc     =   -15.442660702810
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 4.351e-06, dEband = 7.041e-04
rank = 0, Calculating/Estimating energy took 0.916 ms, Etot = -47.955141874, dEtot = 4.351e-06, dEband = 7.041e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0385022937429, which took 0.051 ms

iter_count = 108, r_2norm = 1.460e-06, tol*||rhs|| = 1.540e-06

Anderson update took 58.820 ms, out of which F'*F took 27.126 ms; b-Ax took 184.803 ms, out of which Lap took 164.867 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.280 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135101, int_b + int_rho = 8.731e-14, checking this took 0.107 ms
2-norm of RHS = 756.2119389680414, which took 0.728 ms

iter_count = 180, r_2norm = 6.383e-04, tol*||rhs|| = 7.562e-04

Anderson update took 95.335 ms, out of which F'*F took 48.077 ms; b-Ax took 311.558 ms, out of which Lap took 276.623 ms
Solving Poisson took 673.175 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.260452 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.396073 
Total time for convolution: 	 convolve: 5.239117 
Total time for convolution: 	 convolve: 5.239716 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.090 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.805 ms

This SCF took 27825.029 ms, scf error = 2.467e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.144281, lowerbound = -0.940347, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1464.696 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.323 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.758 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.098 ms
rank =  0, finding HY took 24.992 ms
rank =  0, distributing HY into block cyclic form took 18.234 ms
rank =  0, finding Y'*HY took 3.996 ms
Rank 0, Project_Hamiltonian used 68.352 ms
Total time for projection: 68.364 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.146 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.233 ms
    first calculated eigval = -0.939891524934800
    last  calculated eigval = 0.044988908908969
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50627679115655
lambda[   6] =  -0.47054370590520
lambda[   7] =  -0.44418953347551
lambda[   8] =  -0.36960574657667
lambda[   9] =  -0.36445510441675
lambda[  10] =  -0.36250084069749
lambda[  11] =  -0.32045191545770
lambda[  12] =  -0.24457529544812
lambda[  13] =  -0.22958256203837
lambda[  14] =  -0.20384470075787
lambda[  15] =  -0.06676709807984
lambda[  16] =  -0.02471085975590
lambda[  17] =   0.01348403443723
lambda[  18] =   0.01984217045832
lambda[  19] =   0.02706500551742
lambda[  20] =   0.02838249202573
lambda[  21] =   0.04498890890897
==subpsace eigenproblem: bcast eigvals took 0.049 ms
Total time for solving subspace eigenvalue problem: 0.288 ms
rank =  0, subspace rotation using ScaLAPACK took 7.871 ms
rank =  0, Distributing orbital back into band + domain format took 18.398 ms
rank = 0, Subspace_Rotation used 26.285 ms

Total time for subspace rotation: 26.290 ms
rank = 0, Efermi =  -0.095273315993 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.399 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.587 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.595 ms
rank = 0, Calculating density took 1576.400 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.919 ms
rank = 0, D2D took 2.020 ms
rank = 0, Transfering density took 2.022 ms
Etot    =   -47.955202419886
Eband   =   -13.117910367942
E1      =    29.892686288272
E2      =   -12.284593078355
E3      =   -17.333104664508
Exc     =   -15.443133241696
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 6.055e-06, dEband = 1.232e-03
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -47.955202420, dEtot = 6.055e-06, dEband = 1.232e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0328253468868, which took 0.052 ms

iter_count = 114, r_2norm = 8.540e-07, tol*||rhs|| = 1.313e-06

Anderson update took 60.605 ms, out of which F'*F took 28.152 ms; b-Ax took 194.425 ms, out of which Lap took 172.825 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.344 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135094, int_b + int_rho = 1.455e-14, checking this took 0.110 ms
2-norm of RHS = 756.2097891281090, which took 0.137 ms

iter_count = 126, r_2norm = 6.963e-04, tol*||rhs|| = 7.562e-04

Anderson update took 67.128 ms, out of which F'*F took 31.689 ms; b-Ax took 215.392 ms, out of which Lap took 192.624 ms
Solving Poisson took 453.566 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.256962 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.225718 
Total time for convolution: 	 convolve: 5.243597 
Total time for convolution: 	 convolve: 5.362330 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 3.566 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.096 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.695 ms

This SCF took 27590.105 ms, scf error = 1.666e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.144989, lowerbound = -0.939892, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1465.902 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 18.467 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.624 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.107 ms
rank =  0, finding HY took 25.138 ms
rank =  0, distributing HY into block cyclic form took 18.331 ms
rank =  0, finding Y'*HY took 4.088 ms
Rank 0, Project_Hamiltonian used 68.692 ms
Total time for projection: 68.704 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.229 ms
    first calculated eigval = -0.939736369298128
    last  calculated eigval = 0.044945716222088
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50615786464820
lambda[   6] =  -0.47042971832544
lambda[   7] =  -0.44406237740524
lambda[   8] =  -0.36947754663711
lambda[   9] =  -0.36431663894059
lambda[  10] =  -0.36236305308610
lambda[  11] =  -0.32032611304403
lambda[  12] =  -0.24445281343259
lambda[  13] =  -0.22945356992952
lambda[  14] =  -0.20369635860719
lambda[  15] =  -0.06665285920500
lambda[  16] =  -0.02431754055614
lambda[  17] =   0.01359035464681
lambda[  18] =   0.01985483573546
lambda[  19] =   0.02714296127622
lambda[  20] =   0.02869551437285
lambda[  21] =   0.04494571622209
==subpsace eigenproblem: bcast eigvals took 0.066 ms
Total time for solving subspace eigenvalue problem: 0.302 ms
rank =  0, subspace rotation using ScaLAPACK took 7.799 ms
rank =  0, Distributing orbital back into band + domain format took 18.547 ms
rank = 0, Subspace_Rotation used 26.361 ms

Total time for subspace rotation: 26.366 ms
rank = 0, Efermi =  -0.095159077137 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.472 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.687 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.579 ms
rank = 0, Calculating density took 1578.119 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.822 ms
rank = 0, D2D took 1.916 ms
rank = 0, Transfering density took 1.919 ms
Etot    =   -47.955221016872
Eband   =   -13.114252103646
E1      =    29.890634515560
E2      =   -12.282890598658
E3      =   -17.333473587680
Exc     =   -15.443424773741
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 1.860e-06, dEband = 3.658e-04
rank = 0, Calculating/Estimating energy took 1.347 ms, Etot = -47.955221017, dEtot = 1.860e-06, dEband = 3.658e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0245666913188, which took 0.089 ms

iter_count = 108, r_2norm = 8.856e-07, tol*||rhs|| = 9.827e-07

Anderson update took 57.291 ms, out of which F'*F took 27.168 ms; b-Ax took 184.833 ms, out of which Lap took 165.026 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.632 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135092, int_b + int_rho = -7.276e-15, checking this took 0.103 ms
2-norm of RHS = 756.2102634809008, which took 0.084 ms

iter_count = 144, r_2norm = 7.022e-04, tol*||rhs|| = 7.562e-04

Anderson update took 76.632 ms, out of which F'*F took 36.154 ms; b-Ax took 245.907 ms, out of which Lap took 219.927 ms
Solving Poisson took 517.330 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.273570 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.220285 
Total time for convolution: 	 convolve: 5.322310 
Total time for convolution: 	 convolve: 5.252228 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.573 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.087 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.694 ms

This SCF took 27654.766 ms, scf error = 1.228e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.144946, lowerbound = -0.939736, upperbound = 267.571272

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1461.640 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.302 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.626 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.944 ms
rank =  0, finding HY took 25.152 ms
rank =  0, distributing HY into block cyclic form took 18.275 ms
rank =  0, finding Y'*HY took 3.996 ms
Rank 0, Project_Hamiltonian used 68.394 ms
Total time for projection: 68.405 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.939605493429462
    last  calculated eigval = 0.045267426924314
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50601429152315
lambda[   6] =  -0.47028158779542
lambda[   7] =  -0.44392775092039
lambda[   8] =  -0.36934654447673
lambda[   9] =  -0.36417863221066
lambda[  10] =  -0.36222600613403
lambda[  11] =  -0.32019080475651
lambda[  12] =  -0.24432231063249
lambda[  13] =  -0.22931162114639
lambda[  14] =  -0.20356388818414
lambda[  15] =  -0.06654990605462
lambda[  16] =  -0.02428598560686
lambda[  17] =   0.01300413081535
lambda[  18] =   0.01829044135820
lambda[  19] =   0.02755589263687
lambda[  20] =   0.02895473891074
lambda[  21] =   0.04526742692431
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.252 ms
rank =  0, subspace rotation using ScaLAPACK took 7.901 ms
rank =  0, Distributing orbital back into band + domain format took 18.473 ms
rank = 0, Subspace_Rotation used 26.390 ms

Total time for subspace rotation: 26.394 ms
rank = 0, Efermi =  -0.095056123990 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.340 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.837 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.622 ms
rank = 0, Calculating density took 1573.601 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.981 ms
rank = 0, D2D took 2.927 ms
rank = 0, Transfering density took 2.935 ms
Etot    =   -47.955256087743
Eband   =   -13.110420234630
E1      =    29.888820383375
E2      =   -12.280819601754
E3      =   -17.333566571712
Exc     =   -15.443499568571
Esc     =   -78.904542840167
Entropy =    -0.000000001216
dE = 3.507e-06, dEband = 3.832e-04
rank = 0, Calculating/Estimating energy took 0.902 ms, Etot = -47.955256088, dEtot = 3.507e-06, dEband = 3.832e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0205327100258, which took 0.053 ms

iter_count = 108, r_2norm = 7.669e-07, tol*||rhs|| = 8.213e-07

Anderson update took 57.412 ms, out of which F'*F took 26.712 ms; b-Ax took 183.799 ms, out of which Lap took 163.933 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.106 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000004135093, int_rho =  28.00000004135102, int_b + int_rho = 9.095e-14, checking this took 0.108 ms
2-norm of RHS = 756.2080009537190, which took 0.092 ms

iter_count = 126, r_2norm = 7.233e-04, tol*||rhs|| = 7.562e-04

Anderson update took 67.161 ms, out of which F'*F took 31.493 ms; b-Ax took 215.355 ms, out of which Lap took 192.327 ms
Solving Poisson took 453.480 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 6.516983 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.271291 
Total time for convolution: 	 convolve: 5.253132 
Total time for convolution: 	 convolve: 5.272702 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.012 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.503 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.107 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.643 ms

This SCF took 28834.354 ms, scf error = 8.821e-05
The last 17 occupations of kpoints #1 are (Nelectron = 28):
lambda[   5] =  -0.50601429152315, occ[   5] =   2.00000000000000
lambda[   6] =  -0.47028158779542, occ[   6] =   2.00000000000000
lambda[   7] =  -0.44392775092039, occ[   7] =   2.00000000000000
lambda[   8] =  -0.36934654447673, occ[   8] =   2.00000000000000
lambda[   9] =  -0.36417863221066, occ[   9] =   2.00000000000000
lambda[  10] =  -0.36222600613403, occ[  10] =   2.00000000000000
lambda[  11] =  -0.32019080475651, occ[  11] =   2.00000000000000
lambda[  12] =  -0.24432231063249, occ[  12] =   2.00000000000000
lambda[  13] =  -0.22931162114639, occ[  13] =   2.00000000000000
lambda[  14] =  -0.20356388818414, occ[  14] =   2.00000000000000
lambda[  15] =  -0.06654990605462, occ[  15] =   0.00000004135096
lambda[  16] =  -0.02428598560686, occ[  16] =   0.00000000000000
lambda[  17] =   0.01300413081535, occ[  17] =   0.00000000000000
lambda[  18] =   0.01829044135820, occ[  18] =   0.00000000000000
lambda[  19] =   0.02755589263687, occ[  19] =   0.00000000000000
lambda[  20] =   0.02895473891074, occ[  20] =   0.00000000000000
lambda[  21] =   0.04526742692431, occ[  21] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 19 (90%) = 0.000000000000000.
Occupation of state 21 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.585 ms, time for Allreduce/Reduce: 11.944 ms 
Time for calculating local force components: 23.537 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.01918312140532  -1.19345082561559  -0.00110319057909
 -0.00186093683358   0.05091284590011   0.00091335434372
 -0.05894987887405  -0.03193414116680  -0.00488827616232
  0.00158860540572   0.06686701103303  -0.00712605464619
  0.00053122822912  -0.05223274252054  -0.00068190629783
  0.04502454733492   0.02573150633731   0.00013757477820
  0.03060455410368  -0.00110937370826   0.00126175055073
  0.10798372382369   0.00053843424073  -0.00627757805691
 -0.00693689552324  -0.01823104531831   0.00037964763993
  0.00754505671377  -0.01347602597457   0.11775424294678
force_loc = 
  0.02039176500848   1.17830906223209   0.00091864496820
  0.00148425652832  -0.05292210087033  -0.00094351717297
  0.06149829856691   0.03283558224998   0.00479977714077
 -0.00174938229181  -0.06984546788260   0.00705020955978
 -0.00102947870616   0.05445369891481   0.00072475395115
 -0.04633838664031  -0.02708057937724  -0.00015816130495
 -0.02170113399022  -0.00422173182662  -0.00136444631049
 -0.10847828067801  -0.01737556464046   0.00592239014598
 -0.00344518862017   0.02188396531946  -0.00024782581780
 -0.00242925787886   0.01078666242033  -0.11463471758603
Time for calculating nonlocal force components: 39.724 ms
[32mforces_xc: 
[0m[32m  0.00013454891394   0.02917106004057   0.00012053113869
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00577951499191   0.00243733277707   0.00002427455472
[0m[32m -0.00242869931287   0.00821562136910   0.00028404145976
[0m[32m  0.00504679791086  -0.00166108127592  -0.00007078436589
[0m[32m -0.00150377130728   0.00147506619140  -0.00279653117597
[0mTime for calculating XC forces components: 35.377 ms
 Cartesian force = 
  0.00134124696855   0.01402157977219  -0.00006383484239
 -0.00037862585382  -0.00201697185509  -0.00002998319945
  0.00254647414430   0.00089372419831  -0.00008831939175
 -0.00016272243465  -0.00298617373445  -0.00007566545660
 -0.00050019602560   0.00221323950939   0.00004302728312
 -0.00131578485396  -0.00135678992481  -0.00002040689694
  0.00312195957298  -0.00290148964269  -0.00007824157523
 -0.00292520171575  -0.00862922591551  -0.00007096682137
 -0.00533723178111   0.00198412184036   0.00006121708604
  0.00361008197907  -0.00122201424771   0.00032317381458
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Time for printing density: 396.644 ms
The program took 455.940 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:39
Job ID:        2266530
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:33:48,vmem=8416K,walltime=00:07:49,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-16-1
---------------------------------------
