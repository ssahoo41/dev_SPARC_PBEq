---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:38
Job ID:    2266963
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:44
Job ID:    2266963
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.054 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 11.637 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 6.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 21.755 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 44.981 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.948 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.138 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.119268	    8.536097	   10.000000	
    8.150312	   11.818686	   10.000000	
   11.032979	   12.005708	   11.682108	
   11.032979	   12.005708	    8.317892	
   11.849688	    7.994292	   10.000000	
   10.119268	   11.220642	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.218 ms
Set up communicators.

--set up spincomm took 3.744 ms

--set up kptcomm took 0.348 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {2, 2, 3}
gridsizes = [100, 100, 100], Nstates = 13, dmcomm dims = [2, 2, 3]

--set up dmcomm took 0.011 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 1, ScaLAPACK topology Dims = (1, 1)
nproc = 12, size_blacscomm = 1 = dims[0] * dims[1] = (1, 1)
Nd_blacscomm 85000, Nstates 13 
rank =  0, my blacs rank = 0, BLCYC size (85000, 13), actual size (85000, 13)
rank = 0, mb = nb = 13, mbQ = nbQ = 64
rank = 0, nr_Hp = 13, nc_Hp = 13
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.092 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.509 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 1
# of bands per bandcomm          : 13
npdomain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.381 ms

Calculate_SplineDerivRadFun took 0.206 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.272 ms.
time spent on vectorized spline interp: 3.243 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.011 ms.
time spent on vectorized spline interp: 1.414 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.348 ms.
time spent on vectorized spline interp: 1.733 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.559 ms.

Calculating rb for all atom types took 15.593 ms
----------------------
Estimated memory usage
Total: 562.34 MB
orbitals             : 297.55 MB
global sized vectors : 213.62 MB
subspace matrices : 47.53 kB
others : 51.12 MB
----------------------------------------------
Estimated memory usage per processor: 46.86 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.813 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.016 ms
Calculating pseudocharge density ... 
the global sum of int_b = -14.0000000166971, sum_int_rho = 13.6049103547541
PosCharge = 14.000000016697, NegCharge = -13.604910354754, scal_fac = 1.029040225304
After scaling, int_rho = 14.0000000166971, PosCharge + NegCharge - NetCharge = -1.776e-15
--Calculate Vref took 0.260 ms
--Calculate rho_guess took 1.322 ms

 integral of b = -14.0000000166971,
 int{b} + Nelectron + NetCharge = -1.670e-08,
 Esc = -40.1821122014791,
 MPI_Reduce took 6.392 ms

Calculating b & b_ref took 12.447 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.014 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.078 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 24.771 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669715, int_b + int_rho = -1.819e-14, checking this took 0.088 ms
2-norm of RHS = 590.5598197968468, which took 0.789 ms

iter_count = 414, r_2norm = 5.895e-04, tol*||rhs|| = 5.906e-04

Anderson update took 267.696 ms, out of which F'*F took 122.639 ms; b-Ax took 843.230 ms, out of which Lap took 742.404 ms
Solving Poisson took 1879.313 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.554 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
Total time for convolution: 	 convolve: 5.096838 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.309 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.788 ms
Total time for convolution: 	 convolve: 5.090903 
Total time for convolution: 	 convolve: 5.113053 
Total time for convolution: 	 convolve: 5.094122 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.927 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.329 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
rank = 0, XC calculation took 24282.526 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.576 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 1.682 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.131 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.001 ms
rank =  0, One H*x took 1.949 ms
    Lanczos iter 53, eigmin  = -0.988857781, eigmax = 264.923388312, err_eigmin = 1.307e-03, err_eigmax = 9.705e-03
rank =   0, Lanczos took 139.339 ms, eigmin = -0.988857780692, eigmax = 267.572622194862

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.241882, lowerbound = -1.088858, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1297.565 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.876 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 2.910 ms
rank =  0, finding HY took 20.331 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.746 ms
Rank 0, Project_Hamiltonian used 26.008 ms
Total time for projection: 26.030 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.467 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.642 ms
rank = 0, Solve_Generalized_EigenProblem used 2.063 ms
    first calculated eigval = 2.835533011235604
    last  calculated eigval = 3.232797477528951
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =   2.83553301123560
lambda[   2] =   2.89529863165722
lambda[   3] =   2.92041470766259
lambda[   4] =   2.93702593311046
lambda[   5] =   2.97432897714085
lambda[   6] =   3.00797864939303
lambda[   7] =   3.03510979752360
lambda[   8] =   3.05236360978523
lambda[   9] =   3.08256698274059
lambda[  10] =   3.09639916217374
lambda[  11] =   3.14392288743494
lambda[  12] =   3.21560235905223
lambda[  13] =   3.23279747752895
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 2.161 ms
rank =  0, subspace rotation using ScaLAPACK took 3.955 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.965 ms

Total time for subspace rotation: 3.965 ms
rank = 0, Efermi =   3.043736703870 calculate fermi energy took 0.070 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.332797, lowerbound = -1.088858, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1296.052 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.793 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.060 ms
rank =  0, Distribute data + matrix mult took 2.859 ms
rank =  0, finding HY took 20.196 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.751 ms
Rank 0, Project_Hamiltonian used 25.830 ms
Total time for projection: 25.854 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.100 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.680748730869549
    last  calculated eigval = 0.453825117293600
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.68074873086955
lambda[   2] =  -0.27745461179246
lambda[   3] =  -0.12727890505631
lambda[   4] =   0.02665224560878
lambda[   5] =   0.07089937614458
lambda[   6] =   0.17833143028398
lambda[   7] =   0.27849524782213
lambda[   8] =   0.32359062144160
lambda[   9] =   0.38000637244346
lambda[  10] =   0.38748606540676
lambda[  11] =   0.40529563292932
lambda[  12] =   0.41170335417187
lambda[  13] =   0.45382511729360
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.140 ms
rank =  0, subspace rotation using ScaLAPACK took 4.017 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.023 ms

Total time for subspace rotation: 4.024 ms
rank = 0, Efermi =   0.301043599402 calculate fermi energy took 0.024 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.553825, lowerbound = -1.088858, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1299.450 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.768 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 2.797 ms
rank =  0, finding HY took 20.211 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.728 ms
Rank 0, Project_Hamiltonian used 26.688 ms
Total time for projection: 26.694 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.096 ms
    first calculated eigval = -0.999007867034723
    last  calculated eigval = 0.145854346660633
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.99900786703472
lambda[   2] =  -0.72317295384920
lambda[   3] =  -0.52574744366112
lambda[   4] =  -0.48302543168322
lambda[   5] =  -0.46026407091161
lambda[   6] =  -0.36963426043981
lambda[   7] =  -0.26325265744013
lambda[   8] =   0.07795236257391
lambda[   9] =   0.08748038220463
lambda[  10] =   0.10589781799926
lambda[  11] =   0.12261853887763
lambda[  12] =   0.13768444616258
lambda[  13] =   0.14585434666063
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.110 ms
rank =  0, subspace rotation using ScaLAPACK took 3.985 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.991 ms

Total time for subspace rotation: 3.992 ms
rank = 0, Efermi =   0.048624148809 calculate fermi energy took 0.022 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.245854, lowerbound = -1.088858, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1296.089 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.787 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.055 ms
rank =  0, Distribute data + matrix mult took 2.847 ms
rank =  0, finding HY took 20.328 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.703 ms
Rank 0, Project_Hamiltonian used 25.905 ms
Total time for projection: 25.909 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -1.000084401955588
    last  calculated eigval = 0.102492014262994
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.00008440195559
lambda[   2] =  -0.72715033924527
lambda[   3] =  -0.53711867398058
lambda[   4] =  -0.49100075074599
lambda[   5] =  -0.47177392281689
lambda[   6] =  -0.37881129203424
lambda[   7] =  -0.30610356880803
lambda[   8] =   0.00556178444136
lambda[   9] =   0.02368824082618
lambda[  10] =   0.05536037028958
lambda[  11] =   0.06285942928664
lambda[  12] =   0.07086161821866
lambda[  13] =   0.10249201426299
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.130 ms
rank =  0, subspace rotation using ScaLAPACK took 3.961 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.968 ms

Total time for subspace rotation: 3.968 ms
rank = 0, Efermi =  -0.023766425183 calculate fermi energy took 0.023 ms
rank = 0, --- Calculate rho: sum over local bands took 3.352 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 5457.420 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.302 ms
rank = 0, D2D took 1.392 ms
rank = 0, Transfering density took 1.402 ms
Etot    =   -24.992139076187
Eband   =    -7.824085899080
E1      =    15.632236848793
E2      =    -6.381306557834
E3      =    -8.477863715258
Exc     =    -7.477348097008
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 4.165e+00, dEband = 1.304e+00
rank = 0, Calculating/Estimating energy took 1.029 ms, Etot = -24.992139076, dEtot = 4.165e+00, dEband = 1.304e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 51.2733816250803, which took 0.049 ms

iter_count = 90, r_2norm = 2.011e-03, tol*||rhs|| = 2.051e-03

Anderson update took 56.720 ms, out of which F'*F took 25.773 ms; b-Ax took 171.756 ms, out of which Lap took 152.178 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.846 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669716, int_b + int_rho = -5.457e-15, checking this took 0.115 ms
2-norm of RHS = 587.5321542446676, which took 0.217 ms

iter_count = 282, r_2norm = 5.456e-04, tol*||rhs|| = 5.875e-04

Anderson update took 170.156 ms, out of which F'*F took 77.951 ms; b-Ax took 533.885 ms, out of which Lap took 465.886 ms
Solving Poisson took 1217.822 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.940 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.161035 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.166262 
Total time for convolution: 	 convolve: 5.134073 
Total time for convolution: 	 convolve: 5.125854 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.340 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.894 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.341 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.360 ms

This SCF took 31639.760 ms, scf error = 1.563e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.202492, lowerbound = -1.000084, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1290.640 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.757 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 2.786 ms
rank =  0, finding HY took 20.307 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.732 ms
Rank 0, Project_Hamiltonian used 25.847 ms
Total time for projection: 25.868 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.025 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.979402677901580
    last  calculated eigval = 0.081580987881789
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.97940267790158
lambda[   2] =  -0.69549096448606
lambda[   3] =  -0.51404245305708
lambda[   4] =  -0.46284898315969
lambda[   5] =  -0.44511276679345
lambda[   6] =  -0.35341432370756
lambda[   7] =  -0.28312887239320
lambda[   8] =  -0.02633197490959
lambda[   9] =   0.00156255508460
lambda[  10] =   0.03090416652880
lambda[  11] =   0.03790244233162
lambda[  12] =   0.04894946983236
lambda[  13] =   0.08158098788179
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 3.973 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.978 ms

Total time for subspace rotation: 3.979 ms
rank = 0, Efermi =  -0.055660184502 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.729 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1322.498 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.868 ms
rank = 0, D2D took 0.964 ms
rank = 0, Transfering density took 0.971 ms
Etot    =   -24.966280598125
Eband   =    -7.466882083437
E1      =    15.320585722140
E2      =    -6.341504873084
E3      =    -8.579290757101
Exc     =    -7.558667665030
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 4.310e-03, dEband = 5.953e-02
rank = 0, Calculating/Estimating energy took 0.994 ms, Etot = -24.966280598, dEtot = 4.310e-03, dEband = 5.953e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 14.8890253912349, which took 1.369 ms

iter_count = 102, r_2norm = 4.075e-04, tol*||rhs|| = 5.956e-04

Anderson update took 65.233 ms, out of which F'*F took 28.589 ms; b-Ax took 199.078 ms, out of which Lap took 175.780 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.713 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669710, int_b + int_rho = -6.730e-14, checking this took 0.122 ms
2-norm of RHS = 583.2688018679305, which took 0.217 ms

iter_count = 300, r_2norm = 4.979e-04, tol*||rhs|| = 5.833e-04

Anderson update took 187.521 ms, out of which F'*F took 83.324 ms; b-Ax took 580.142 ms, out of which Lap took 500.959 ms
Solving Poisson took 1326.512 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.758 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.160444 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.800 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.965 ms
======D2D: initiated sending and receiving took 3.119 ms
Total time for convolution: 	 convolve: 5.154301 
Total time for convolution: 	 convolve: 5.160289 
Total time for convolution: 	 convolve: 5.153410 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.578 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.619 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.315 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.321 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.338 ms

This SCF took 27752.005 ms, scf error = 1.083e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.181581, lowerbound = -0.979403, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1300.942 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.787 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 2.822 ms
rank =  0, finding HY took 20.283 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.757 ms
Rank 0, Project_Hamiltonian used 25.882 ms
Total time for projection: 25.916 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.095 ms
    first calculated eigval = -0.946548467779940
    last  calculated eigval = 0.071903244090978
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.94654846777994
lambda[   2] =  -0.63891383886060
lambda[   3] =  -0.47398392873450
lambda[   4] =  -0.41102477242681
lambda[   5] =  -0.39725892737021
lambda[   6] =  -0.30931662930971
lambda[   7] =  -0.24327618964501
lambda[   8] =  -0.03516589129260
lambda[   9] =  -0.00469190151348
lambda[  10] =   0.02135863888274
lambda[  11] =   0.02874129551415
lambda[  12] =   0.03756921404581
lambda[  13] =   0.07190324409098
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 4.005 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.010 ms

Total time for subspace rotation: 4.010 ms
rank = 0, Efermi =  -0.064494100913 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.200 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.035 ms
rank = 0, Calculating density took 1334.308 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
rank = 0, D2D took 0.328 ms
rank = 0, Transfering density took 0.333 ms
Etot    =   -24.942084260475
Eband   =    -6.840645508841
E1      =    14.797625212158
E2      =    -6.220252242467
E3      =    -8.788610356676
Exc     =    -7.725814360952
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 4.033e-03, dEband = 1.044e-01
rank = 0, Calculating/Estimating energy took 0.995 ms, Etot = -24.942084260, dEtot = 4.033e-03, dEband = 1.044e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.0234747155472, which took 0.057 ms

iter_count = 102, r_2norm = 1.610e-04, tol*||rhs|| = 2.009e-04

Anderson update took 63.541 ms, out of which F'*F took 28.546 ms; b-Ax took 195.634 ms, out of which Lap took 173.369 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.232 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669714, int_b + int_rho = -2.910e-14, checking this took 0.118 ms
2-norm of RHS = 583.6714371617602, which took 0.179 ms

iter_count = 270, r_2norm = 5.654e-04, tol*||rhs|| = 5.837e-04

Anderson update took 166.308 ms, out of which F'*F took 74.983 ms; b-Ax took 518.143 ms, out of which Lap took 454.141 ms
Solving Poisson took 1185.851 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.149879 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.542 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.155411 
Total time for convolution: 	 convolve: 5.157759 
Total time for convolution: 	 convolve: 5.152050 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.007 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.602 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.337 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.358 ms

This SCF took 27619.220 ms, scf error = 3.369e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.171903, lowerbound = -0.946548, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1301.422 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.834 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.034 ms
rank =  0, Distribute data + matrix mult took 2.875 ms
rank =  0, finding HY took 20.425 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 2.701 ms
Rank 0, Project_Hamiltonian used 26.027 ms
Total time for projection: 26.062 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.945567944932332
    last  calculated eigval = 0.067897135633468
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.94556794493233
lambda[   2] =  -0.62983489484580
lambda[   3] =  -0.46914150779431
lambda[   4] =  -0.40130675868005
lambda[   5] =  -0.39022574237719
lambda[   6] =  -0.30409778294535
lambda[   7] =  -0.23977729628149
lambda[   8] =  -0.03704161621090
lambda[   9] =  -0.00748261146275
lambda[  10] =   0.01865303356759
lambda[  11] =   0.02352591462274
lambda[  12] =   0.02942656644272
lambda[  13] =   0.06789713563347
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 2.803 ms
rank =  0, Distributing orbital back into band + domain format took 0.005 ms
rank = 0, Subspace_Rotation used 2.817 ms

Total time for subspace rotation: 2.819 ms
rank = 0, Efermi =  -0.066369825770 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 1.754 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1334.185 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.314 ms
rank = 0, D2D took 0.584 ms
rank = 0, Transfering density took 0.592 ms
Etot    =   -24.939598940514
Eband   =    -6.759903856332
E1      =    14.757607694454
E2      =    -6.172506472404
E3      =    -8.825546677618
Exc     =    -7.753243726675
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 4.142e-04, dEband = 1.346e-02
rank = 0, Calculating/Estimating energy took 1.107 ms, Etot = -24.939598941, dEtot = 4.142e-04, dEband = 1.346e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.8320342743255, which took 0.090 ms

iter_count = 108, r_2norm = 5.714e-05, tol*||rhs|| = 7.328e-05

Anderson update took 66.818 ms, out of which F'*F took 32.473 ms; b-Ax took 207.365 ms, out of which Lap took 184.243 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.012 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669715, int_b + int_rho = -1.455e-14, checking this took 0.154 ms
2-norm of RHS = 583.8507844508358, which took 0.201 ms

iter_count = 246, r_2norm = 5.793e-04, tol*||rhs|| = 5.839e-04

Anderson update took 152.183 ms, out of which F'*F took 68.079 ms; b-Ax took 470.184 ms, out of which Lap took 411.132 ms
Solving Poisson took 1076.931 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.148487 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.145651 
Total time for convolution: 	 convolve: 5.174824 
Total time for convolution: 	 convolve: 5.159047 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.398 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.145 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.321 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.339 ms

This SCF took 27538.548 ms, scf error = 1.065e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.167897, lowerbound = -0.945568, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1307.174 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.771 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 2.799 ms
rank =  0, finding HY took 20.587 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.698 ms
Rank 0, Project_Hamiltonian used 26.117 ms
Total time for projection: 26.145 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.943016398948111
    last  calculated eigval = 0.065476089456552
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.94301639894811
lambda[   2] =  -0.62647675599288
lambda[   3] =  -0.46632240265698
lambda[   4] =  -0.39771766569620
lambda[   5] =  -0.38708770765632
lambda[   6] =  -0.30106935695297
lambda[   7] =  -0.23686963185086
lambda[   8] =  -0.03757698213948
lambda[   9] =  -0.00835496023587
lambda[  10] =   0.01772453735614
lambda[  11] =   0.02091263781696
lambda[  12] =   0.02511077648116
lambda[  13] =   0.06547608945655
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.845 ms
rank =  0, Distributing orbital back into band + domain format took 0.006 ms
rank = 0, Subspace_Rotation used 3.864 ms

Total time for subspace rotation: 3.866 ms
rank = 0, Efermi =  -0.066905191745 calculate fermi energy took 0.623 ms
rank = 0, --- Calculate rho: sum over local bands took 1.643 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1340.275 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.013 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
rank = 0, D2D took 0.548 ms
rank = 0, Transfering density took 0.558 ms
Etot    =   -24.939158242738
Eband   =    -6.717119840136
E1      =    14.736721690497
E2      =    -6.147191105181
E3      =    -8.839432875973
Exc     =    -7.763271872269
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 7.345e-05, dEband = 7.131e-03
rank = 0, Calculating/Estimating energy took 1.199 ms, Etot = -24.939158243, dEtot = 7.345e-05, dEband = 7.131e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6847294705367, which took 0.080 ms

iter_count = 114, r_2norm = 1.691e-05, tol*||rhs|| = 2.739e-05

Anderson update took 70.654 ms, out of which F'*F took 31.536 ms; b-Ax took 216.140 ms, out of which Lap took 191.050 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 508.904 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669720, int_b + int_rho = 3.274e-14, checking this took 0.115 ms
2-norm of RHS = 584.0100089990159, which took 0.181 ms

iter_count = 246, r_2norm = 5.670e-04, tol*||rhs|| = 5.840e-04

Anderson update took 152.667 ms, out of which F'*F took 68.247 ms; b-Ax took 471.184 ms, out of which Lap took 413.987 ms
Solving Poisson took 1089.161 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.139325 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 38.961 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.141911 
Total time for convolution: 	 convolve: 5.138844 
Total time for convolution: 	 convolve: 5.135395 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.712 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.586 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.186 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 0.354 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.374 ms

This SCF took 27515.689 ms, scf error = 5.815e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.165476, lowerbound = -0.943016, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1295.625 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.759 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.087 ms
rank =  0, Distribute data + matrix mult took 2.853 ms
rank =  0, finding HY took 20.259 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.708 ms
Rank 0, Project_Hamiltonian used 25.849 ms
Total time for projection: 25.871 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.068 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.019 ms
rank = 0, Solve_Generalized_EigenProblem used 0.091 ms
    first calculated eigval = -0.938806435219885
    last  calculated eigval = 0.063297227032238
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93880643521989
lambda[   2] =  -0.62294342795119
lambda[   3] =  -0.46269391238957
lambda[   4] =  -0.39408615163226
lambda[   5] =  -0.38338423850029
lambda[   6] =  -0.29731781292687
lambda[   7] =  -0.23290646150983
lambda[   8] =  -0.03746833019835
lambda[   9] =  -0.00803194864756
lambda[  10] =   0.01806739172438
lambda[  11] =   0.01959881801430
lambda[  12] =   0.02329381649587
lambda[  13] =   0.06329722703224
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 3.738 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.746 ms

Total time for subspace rotation: 3.747 ms
rank = 0, Efermi =  -0.066796539779 calculate fermi energy took 0.116 ms
rank = 0, --- Calculate rho: sum over local bands took 1.701 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1327.806 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
rank = 0, D2D took 0.529 ms
rank = 0, Transfering density took 0.534 ms
Etot    =   -24.938942668277
Eband   =    -6.664276880885
E1      =    14.709802357128
E2      =    -6.118229450049
E3      =    -8.850715063497
Exc     =    -7.771300456082
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 3.593e-05, dEband = 8.807e-03
rank = 0, Calculating/Estimating energy took 1.206 ms, Etot = -24.938942668, dEtot = 3.593e-05, dEband = 8.807e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2711114397114, which took 0.071 ms

iter_count = 114, r_2norm = 7.551e-06, tol*||rhs|| = 1.084e-05

Anderson update took 70.576 ms, out of which F'*F took 31.623 ms; b-Ax took 216.323 ms, out of which Lap took 191.640 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 507.421 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669720, int_b + int_rho = 3.274e-14, checking this took 0.117 ms
2-norm of RHS = 584.1986834859867, which took 0.210 ms

iter_count = 246, r_2norm = 5.471e-04, tol*||rhs|| = 5.842e-04

Anderson update took 151.622 ms, out of which F'*F took 67.730 ms; b-Ax took 474.218 ms, out of which Lap took 414.371 ms
Solving Poisson took 1076.444 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.139714 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.824 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.138602 
Total time for convolution: 	 convolve: 5.148876 
Total time for convolution: 	 convolve: 5.141057 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.577 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 0.344 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.363 ms

This SCF took 27481.964 ms, scf error = 3.231e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.163297, lowerbound = -0.938806, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1296.139 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.756 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.052 ms
rank =  0, Distribute data + matrix mult took 2.813 ms
rank =  0, finding HY took 20.401 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.731 ms
Rank 0, Project_Hamiltonian used 25.972 ms
Total time for projection: 26.000 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.503 ms
    first calculated eigval = -0.935736089920226
    last  calculated eigval = 0.061808580550286
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93573608992023
lambda[   2] =  -0.61910992177198
lambda[   3] =  -0.45945884048540
lambda[   4] =  -0.39026792387794
lambda[   5] =  -0.37969348329941
lambda[   6] =  -0.29400993332351
lambda[   7] =  -0.22986578355258
lambda[   8] =  -0.03636664974801
lambda[   9] =  -0.00617074656268
lambda[  10] =   0.01902777915129
lambda[  11] =   0.02142769319248
lambda[  12] =   0.02417039848843
lambda[  13] =   0.06180858055029
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.521 ms
rank =  0, subspace rotation using ScaLAPACK took 3.542 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.148 ms

Total time for subspace rotation: 4.148 ms
rank = 0, Efermi =  -0.065694859344 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.688 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1328.671 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.283 ms
rank = 0, D2D took 0.522 ms
rank = 0, Transfering density took 0.527 ms
Etot    =   -24.938849925234
Eband   =    -6.616283953069
E1      =    14.687155764585
E2      =    -6.090841516014
E3      =    -8.857833415697
Exc     =    -7.776284466477
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 1.546e-05, dEband = 7.999e-03
rank = 0, Calculating/Estimating energy took 1.195 ms, Etot = -24.938849925, dEtot = 1.546e-05, dEband = 7.999e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1852530239741, which took 0.062 ms

iter_count = 114, r_2norm = 4.611e-06, tol*||rhs|| = 7.410e-06

Anderson update took 70.394 ms, out of which F'*F took 31.482 ms; b-Ax took 215.211 ms, out of which Lap took 190.454 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 506.421 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669718, int_b + int_rho = 1.091e-14, checking this took 0.115 ms
2-norm of RHS = 584.1788191562822, which took 0.179 ms

iter_count = 228, r_2norm = 5.508e-04, tol*||rhs|| = 5.842e-04

Anderson update took 140.695 ms, out of which F'*F took 63.333 ms; b-Ax took 435.683 ms, out of which Lap took 381.551 ms
Solving Poisson took 1002.864 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.145166 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.736 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.190 ms
Total time for convolution: 	 convolve: 5.139281 
Total time for convolution: 	 convolve: 5.143291 
Total time for convolution: 	 convolve: 5.146308 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.333 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.003 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.352 ms

This SCF took 27446.172 ms, scf error = 1.523e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.161809, lowerbound = -0.935736, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1288.201 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.773 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.062 ms
rank =  0, Distribute data + matrix mult took 2.840 ms
rank =  0, finding HY took 20.293 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.672 ms
Rank 0, Project_Hamiltonian used 26.622 ms
Total time for projection: 26.644 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.933853038314282
    last  calculated eigval = 0.060585727220931
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93385303831428
lambda[   2] =  -0.61713060745974
lambda[   3] =  -0.45761514518549
lambda[   4] =  -0.38834427351730
lambda[   5] =  -0.37769646234438
lambda[   6] =  -0.29195581047464
lambda[   7] =  -0.22784243564204
lambda[   8] =  -0.03458999999466
lambda[   9] =  -0.00297520597860
lambda[  10] =   0.02034104613430
lambda[  11] =   0.02443343117721
lambda[  12] =   0.02591502284375
lambda[  13] =   0.06058572722093
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.140 ms
rank =  0, subspace rotation using ScaLAPACK took 3.989 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.995 ms

Total time for subspace rotation: 3.996 ms
rank = 0, Efermi =  -0.063918209590 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 1.732 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1320.860 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, D2D took 0.487 ms
rank = 0, Transfering density took 0.495 ms
Etot    =   -24.938855720869
Eband   =    -6.588875546453
E1      =    14.672852486728
E2      =    -6.076928469222
E3      =    -8.861193498589
Exc     =    -7.778842426972
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 9.659e-07, dEband = 4.568e-03
rank = 0, Calculating/Estimating energy took 1.245 ms, Etot = -24.938855721, dEtot = 9.659e-07, dEband = 4.568e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1053352331603, which took 0.058 ms

iter_count = 114, r_2norm = 3.209e-06, tol*||rhs|| = 4.213e-06

Anderson update took 69.815 ms, out of which F'*F took 31.390 ms; b-Ax took 215.290 ms, out of which Lap took 190.699 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 501.532 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669713, int_b + int_rho = -3.092e-14, checking this took 0.108 ms
2-norm of RHS = 584.1975501705568, which took 0.183 ms

iter_count = 210, r_2norm = 4.802e-04, tol*||rhs|| = 5.842e-04

Anderson update took 128.847 ms, out of which F'*F took 58.133 ms; b-Ax took 400.021 ms, out of which Lap took 350.617 ms
Solving Poisson took 910.501 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.143644 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.895 ms
Total time for convolution: 	 convolve: 5.146569 
Total time for convolution: 	 convolve: 5.143131 
Total time for convolution: 	 convolve: 5.138697 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.819 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.320 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.340 ms

This SCF took 27320.208 ms, scf error = 9.731e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.160586, lowerbound = -0.933853, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1291.150 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.242 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.044 ms
rank =  0, Distribute data + matrix mult took 3.954 ms
rank =  0, finding HY took 20.351 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.720 ms
Rank 0, Project_Hamiltonian used 27.049 ms
Total time for projection: 27.078 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.933659867137881
    last  calculated eigval = 0.058251012898832
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93365986713788
lambda[   2] =  -0.61659198918549
lambda[   3] =  -0.45723592115591
lambda[   4] =  -0.38777973103358
lambda[   5] =  -0.37721843869099
lambda[   6] =  -0.29155952176233
lambda[   7] =  -0.22754215848875
lambda[   8] =  -0.03287660621101
lambda[   9] =  -0.00040589242466
lambda[  10] =   0.02120122061095
lambda[  11] =   0.02603751419142
lambda[  12] =   0.02731208190218
lambda[  13] =   0.05825101289883
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 3.932 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.939 ms

Total time for subspace rotation: 3.940 ms
rank = 0, Efermi =  -0.062204815832 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 1.705 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1324.165 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.277 ms
rank = 0, D2D took 0.502 ms
rank = 0, Transfering density took 0.510 ms
Etot    =   -24.938890438612
Eband   =    -6.583175255459
E1      =    14.671501785005
E2      =    -6.072654700132
E3      =    -8.860798167041
Exc     =    -7.778557633348
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 5.786e-06, dEband = 9.500e-04
rank = 0, Calculating/Estimating energy took 1.235 ms, Etot = -24.938890439, dEtot = 5.786e-06, dEband = 9.500e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0829537003628, which took 0.078 ms

iter_count = 108, r_2norm = 2.958e-06, tol*||rhs|| = 3.318e-06

Anderson update took 66.576 ms, out of which F'*F took 29.924 ms; b-Ax took 203.835 ms, out of which Lap took 180.918 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 477.449 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669708, int_b + int_rho = -8.367e-14, checking this took 0.115 ms
2-norm of RHS = 584.1862756313130, which took 0.176 ms

iter_count = 210, r_2norm = 4.773e-04, tol*||rhs|| = 5.842e-04

Anderson update took 128.532 ms, out of which F'*F took 57.905 ms; b-Ax took 399.479 ms, out of which Lap took 350.250 ms
Solving Poisson took 916.263 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.110 ms
Total time for convolution: 	 convolve: 5.139032 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 45.978 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.140457 
Total time for convolution: 	 convolve: 5.139128 
Total time for convolution: 	 convolve: 5.146609 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.824 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.320 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.338 ms

This SCF took 27318.339 ms, scf error = 7.331e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.158251, lowerbound = -0.933660, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1289.106 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.782 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 2.812 ms
rank =  0, finding HY took 20.184 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.716 ms
Rank 0, Project_Hamiltonian used 25.739 ms
Total time for projection: 25.762 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.932629831845009
    last  calculated eigval = 0.054915526113836
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93262983184501
lambda[   2] =  -0.61548841982392
lambda[   3] =  -0.45621122910955
lambda[   4] =  -0.38666650824283
lambda[   5] =  -0.37612788896955
lambda[   6] =  -0.29055571941903
lambda[   7] =  -0.22655088782834
lambda[   8] =  -0.02924810878113
lambda[   9] =   0.00327926835119
lambda[  10] =   0.02209091767328
lambda[  11] =   0.02810201075269
lambda[  12] =   0.03031138232179
lambda[  13] =   0.05491552611384
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 3.917 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.922 ms

Total time for subspace rotation: 3.923 ms
rank = 0, Efermi =  -0.058576318387 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.716 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1321.149 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
rank = 0, D2D took 0.510 ms
rank = 0, Transfering density took 0.526 ms
Etot    =   -24.938954253791
Eband   =    -6.568460970965
E1      =    14.663670408909
E2      =    -6.065456551887
E3      =    -8.862288878642
Exc     =    -7.779796920280
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 1.064e-05, dEband = 2.452e-03
rank = 0, Calculating/Estimating energy took 1.172 ms, Etot = -24.938954254, dEtot = 1.064e-05, dEband = 2.452e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0682448194418, which took 0.070 ms

iter_count = 114, r_2norm = 1.684e-06, tol*||rhs|| = 2.730e-06

Anderson update took 70.114 ms, out of which F'*F took 31.412 ms; b-Ax took 214.617 ms, out of which Lap took 190.502 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 501.452 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669711, int_b + int_rho = -6.003e-14, checking this took 0.113 ms
2-norm of RHS = 584.1803840321820, which took 0.201 ms

iter_count = 156, r_2norm = 5.704e-04, tol*||rhs|| = 5.842e-04

Anderson update took 95.482 ms, out of which F'*F took 42.813 ms; b-Ax took 296.394 ms, out of which Lap took 259.156 ms
Solving Poisson took 677.012 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.846 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.148035 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.136708 
Total time for convolution: 	 convolve: 5.140357 
Total time for convolution: 	 convolve: 5.146591 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.832 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 0.342 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.684 ms

This SCF took 27120.866 ms, scf error = 4.621e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.154916, lowerbound = -0.932630, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1298.666 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.778 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 2.815 ms
rank =  0, finding HY took 20.390 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.698 ms
Rank 0, Project_Hamiltonian used 25.928 ms
Total time for projection: 25.947 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.932253771838731
    last  calculated eigval = 0.049891728304454
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93225377183873
lambda[   2] =  -0.61520831376539
lambda[   3] =  -0.45589904264343
lambda[   4] =  -0.38639967094501
lambda[   5] =  -0.37583012549137
lambda[   6] =  -0.29024172539691
lambda[   7] =  -0.22621368263307
lambda[   8] =  -0.02868446345578
lambda[   9] =   0.00351087166115
lambda[  10] =   0.02186335863349
lambda[  11] =   0.02812867479767
lambda[  12] =   0.03049571947735
lambda[  13] =   0.04989172830445
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 3.931 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.937 ms

Total time for subspace rotation: 3.937 ms
rank = 0, Efermi =  -0.058012673100 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.679 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1330.560 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.284 ms
rank = 0, D2D took 0.538 ms
rank = 0, Transfering density took 0.542 ms
Etot    =   -24.938982007271
Eband   =    -6.564092665907
E1      =    14.661057625123
E2      =    -6.063537357124
E3      =    -8.862937540416
Exc     =    -7.780309662044
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 4.626e-06, dEband = 7.281e-04
rank = 0, Calculating/Estimating energy took 1.186 ms, Etot = -24.938982007, dEtot = 4.626e-06, dEband = 7.281e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0424954952138, which took 0.124 ms

iter_count = 108, r_2norm = 1.267e-06, tol*||rhs|| = 1.700e-06

Anderson update took 66.932 ms, out of which F'*F took 29.779 ms; b-Ax took 203.307 ms, out of which Lap took 180.555 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 477.647 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669711, int_b + int_rho = -5.457e-14, checking this took 0.114 ms
2-norm of RHS = 584.1983614029450, which took 0.145 ms

iter_count = 186, r_2norm = 5.446e-04, tol*||rhs|| = 5.842e-04

Anderson update took 114.181 ms, out of which F'*F took 51.083 ms; b-Ax took 352.800 ms, out of which Lap took 309.264 ms
Solving Poisson took 812.201 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Total time for convolution: 	 convolve: 5.257609 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.157124 
Total time for convolution: 	 convolve: 5.148749 
Total time for convolution: 	 convolve: 5.145542 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.375 ms
---Transfer Veff_loc: D2D took 1.472 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.489 ms

This SCF took 27334.124 ms, scf error = 3.259e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.149892, lowerbound = -0.932254, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1289.656 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.774 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.123 ms
rank =  0, Distribute data + matrix mult took 2.902 ms
rank =  0, finding HY took 20.403 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.690 ms
Rank 0, Project_Hamiltonian used 26.025 ms
Total time for projection: 26.051 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.237 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.019 ms
rank = 0, Solve_Generalized_EigenProblem used 0.261 ms
    first calculated eigval = -0.931805162939804
    last  calculated eigval = 0.045596595130501
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93180516293980
lambda[   2] =  -0.61476726166253
lambda[   3] =  -0.45545141834181
lambda[   4] =  -0.38597101998206
lambda[   5] =  -0.37539471705433
lambda[   6] =  -0.28981286427733
lambda[   7] =  -0.22580151773054
lambda[   8] =  -0.02544430587788
lambda[   9] =   0.00489620022243
lambda[  10] =   0.02197563841747
lambda[  11] =   0.02978220019850
lambda[  12] =   0.03309297980028
lambda[  13] =   0.04559659513050
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.277 ms
rank =  0, subspace rotation using ScaLAPACK took 3.968 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.975 ms

Total time for subspace rotation: 3.976 ms
rank = 0, Efermi =  -0.054772515513 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 1.737 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1321.857 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
rank = 0, D2D took 0.514 ms
rank = 0, Transfering density took 0.518 ms
Etot    =   -24.939044938328
Eband   =    -6.558007924402
E1      =    14.658464897875
E2      =    -6.059938453451
E3      =    -8.863181594904
Exc     =    -7.780509758173
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 1.049e-05, dEband = 1.014e-03
rank = 0, Calculating/Estimating energy took 1.219 ms, Etot = -24.939044938, dEtot = 1.049e-05, dEband = 1.014e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0367270049366, which took 0.065 ms

iter_count = 108, r_2norm = 1.234e-06, tol*||rhs|| = 1.469e-06

Anderson update took 66.574 ms, out of which F'*F took 29.947 ms; b-Ax took 203.746 ms, out of which Lap took 180.843 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 476.151 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669718, int_b + int_rho = 1.091e-14, checking this took 0.077 ms
2-norm of RHS = 584.2005366724435, which took 0.194 ms

iter_count = 150, r_2norm = 5.254e-04, tol*||rhs|| = 5.842e-04

Anderson update took 91.921 ms, out of which F'*F took 41.239 ms; b-Ax took 286.160 ms, out of which Lap took 250.121 ms
Solving Poisson took 651.845 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.145319 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.331 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.149600 
Total time for convolution: 	 convolve: 5.153405 
Total time for convolution: 	 convolve: 5.145803 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.824 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.322 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.341 ms

This SCF took 27072.680 ms, scf error = 2.570e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.145597, lowerbound = -0.931805, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1289.505 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.781 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.037 ms
rank =  0, Distribute data + matrix mult took 2.824 ms
rank =  0, finding HY took 20.276 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.694 ms
Rank 0, Project_Hamiltonian used 25.816 ms
Total time for projection: 25.845 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.931667770369412
    last  calculated eigval = 0.041712006992443
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93166777036941
lambda[   2] =  -0.61462109839977
lambda[   3] =  -0.45531286378070
lambda[   4] =  -0.38582891997905
lambda[   5] =  -0.37524981457512
lambda[   6] =  -0.28966366682452
lambda[   7] =  -0.22565644939191
lambda[   8] =  -0.02469386327157
lambda[   9] =   0.00458865794576
lambda[  10] =   0.02170484187343
lambda[  11] =   0.02985175589103
lambda[  12] =   0.03389756135926
lambda[  13] =   0.04171200699244
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 3.908 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.913 ms

Total time for subspace rotation: 3.914 ms
rank = 0, Efermi =  -0.054022072935 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.682 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1321.225 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.272 ms
rank = 0, D2D took 0.481 ms
rank = 0, Transfering density took 0.484 ms
Etot    =   -24.939071756538
Eband   =    -6.556001167053
E1      =    14.657476965472
E2      =    -6.058871419512
E3      =    -8.863306618456
Exc     =    -7.780613390942
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 4.470e-06, dEband = 3.345e-04
rank = 0, Calculating/Estimating energy took 1.257 ms, Etot = -24.939071757, dEtot = 4.470e-06, dEband = 3.345e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0348322414634, which took 0.067 ms

iter_count = 108, r_2norm = 1.246e-06, tol*||rhs|| = 1.393e-06

Anderson update took 65.552 ms, out of which F'*F took 32.173 ms; b-Ax took 205.326 ms, out of which Lap took 182.388 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 475.313 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669712, int_b + int_rho = -4.547e-14, checking this took 0.122 ms
2-norm of RHS = 584.2001163380819, which took 0.190 ms

iter_count = 102, r_2norm = 5.598e-04, tol*||rhs|| = 5.842e-04

Anderson update took 62.600 ms, out of which F'*F took 27.902 ms; b-Ax took 193.662 ms, out of which Lap took 169.916 ms
Solving Poisson took 446.172 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.217406 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.144292 
Total time for convolution: 	 convolve: 5.146873 
Total time for convolution: 	 convolve: 5.140940 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.831 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.755 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.321 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.340 ms

This SCF took 26879.508 ms, scf error = 1.983e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.141712, lowerbound = -0.931668, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1280.976 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.764 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 2.801 ms
rank =  0, finding HY took 20.175 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.697 ms
Rank 0, Project_Hamiltonian used 25.697 ms
Total time for projection: 25.714 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.068 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.092 ms
    first calculated eigval = -0.931631021599445
    last  calculated eigval = 0.039219083684513
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93163102159945
lambda[   2] =  -0.61458819763412
lambda[   3] =  -0.45527883586926
lambda[   4] =  -0.38579528607736
lambda[   5] =  -0.37521669250294
lambda[   6] =  -0.28963064673308
lambda[   7] =  -0.22562112393396
lambda[   8] =  -0.02444026623926
lambda[   9] =   0.00461840284156
lambda[  10] =   0.02155612942554
lambda[  11] =   0.02988638030100
lambda[  12] =   0.03378981856597
lambda[  13] =   0.03921908368451
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 3.869 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.873 ms

Total time for subspace rotation: 3.874 ms
rank = 0, Efermi =  -0.053768475802 calculate fermi energy took 0.088 ms
rank = 0, --- Calculate rho: sum over local bands took 1.731 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 1312.618 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
rank = 0, D2D took 0.511 ms
rank = 0, Transfering density took 0.515 ms
Etot    =   -24.939078996343
Eband   =    -6.555523609108
E1      =    14.657231032313
E2      =    -6.058634272907
E3      =    -8.863316914216
Exc     =    -7.780625404688
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 1.207e-06, dEband = 7.959e-05
rank = 0, Calculating/Estimating energy took 2.041 ms, Etot = -24.939078996, dEtot = 1.207e-06, dEband = 7.959e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0361388200247, which took 0.059 ms

iter_count = 108, r_2norm = 1.112e-06, tol*||rhs|| = 1.446e-06

Anderson update took 65.866 ms, out of which F'*F took 29.392 ms; b-Ax took 202.272 ms, out of which Lap took 179.340 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 471.383 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669716, int_b + int_rho = -7.276e-15, checking this took 0.130 ms
2-norm of RHS = 584.2012987324241, which took 0.170 ms

iter_count = 138, r_2norm = 4.879e-04, tol*||rhs|| = 5.842e-04

Anderson update took 84.559 ms, out of which F'*F took 38.088 ms; b-Ax took 262.562 ms, out of which Lap took 229.671 ms
Solving Poisson took 598.585 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.182259 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.141539 
Total time for convolution: 	 convolve: 5.155488 
Total time for convolution: 	 convolve: 5.145880 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.541 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
---Transfer Veff_loc: D2D took 0.354 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.376 ms

This SCF took 27010.457 ms, scf error = 1.783e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.139219, lowerbound = -0.931631, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1283.570 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.759 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.052 ms
rank =  0, Distribute data + matrix mult took 2.816 ms
rank =  0, finding HY took 20.321 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.675 ms
Rank 0, Project_Hamiltonian used 25.840 ms
Total time for projection: 25.859 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.931500727729482
    last  calculated eigval = 0.037774712813937
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93150072772948
lambda[   2] =  -0.61447709038048
lambda[   3] =  -0.45516148473982
lambda[   4] =  -0.38568707161098
lambda[   5] =  -0.37510362817747
lambda[   6] =  -0.28951945884143
lambda[   7] =  -0.22550444757615
lambda[   8] =  -0.02501265590556
lambda[   9] =   0.00400838439291
lambda[  10] =   0.02163194376850
lambda[  11] =   0.02948196092202
lambda[  12] =   0.03266570634682
lambda[  13] =   0.03777471281394
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.136 ms
rank =  0, subspace rotation using ScaLAPACK took 3.857 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.863 ms

Total time for subspace rotation: 3.863 ms
rank = 0, Efermi =  -0.054340865580 calculate fermi energy took 0.110 ms
rank = 0, --- Calculate rho: sum over local bands took 1.641 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.032 ms
rank = 0, Calculating density took 1315.286 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.662 ms
rank = 0, D2D took 1.761 ms
rank = 0, Transfering density took 1.766 ms
Etot    =   -24.939096944797
Eband   =    -6.553907818529
E1      =    14.656464376344
E2      =    -6.057751195361
E3      =    -8.863367858078
Exc     =    -7.780660354067
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 2.991e-06, dEband = 2.693e-04
rank = 0, Calculating/Estimating energy took 0.979 ms, Etot = -24.939096945, dEtot = 2.991e-06, dEband = 2.693e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0360913133454, which took 0.075 ms

iter_count = 108, r_2norm = 1.031e-06, tol*||rhs|| = 1.444e-06

Anderson update took 65.666 ms, out of which F'*F took 29.533 ms; b-Ax took 202.670 ms, out of which Lap took 179.510 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 473.180 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669709, int_b + int_rho = -7.276e-14, checking this took 0.111 ms
2-norm of RHS = 584.2003357044147, which took 0.152 ms

iter_count = 108, r_2norm = 5.104e-04, tol*||rhs|| = 5.842e-04

Anderson update took 65.972 ms, out of which F'*F took 29.508 ms; b-Ax took 204.530 ms, out of which Lap took 179.538 ms
Solving Poisson took 471.351 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.144974 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.688 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.140512 
Total time for convolution: 	 convolve: 5.147052 
Total time for convolution: 	 convolve: 5.144234 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.582 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.788 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.340 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.359 ms

This SCF took 26869.374 ms, scf error = 1.555e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.137775, lowerbound = -0.931501, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1292.701 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.761 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 2.789 ms
rank =  0, finding HY took 20.210 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.674 ms
Rank 0, Project_Hamiltonian used 25.697 ms
Total time for projection: 25.714 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.094 ms
    first calculated eigval = -0.931378283651770
    last  calculated eigval = 0.037144210298701
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93137828365177
lambda[   2] =  -0.61437357006669
lambda[   3] =  -0.45505289386721
lambda[   4] =  -0.38558769739827
lambda[   5] =  -0.37499872646051
lambda[   6] =  -0.28941491725040
lambda[   7] =  -0.22539526688720
lambda[   8] =  -0.02499208885278
lambda[   9] =   0.00399901634790
lambda[  10] =   0.02171318304638
lambda[  11] =   0.02939869630296
lambda[  12] =   0.03176190077689
lambda[  13] =   0.03714421029870
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.853 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.858 ms

Total time for subspace rotation: 3.859 ms
rank = 0, Efermi =  -0.054320298492 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.705 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1324.267 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.833 ms
rank = 0, D2D took 0.939 ms
rank = 0, Transfering density took 0.947 ms
Etot    =   -24.939100318391
Eband   =    -6.552402711581
E1      =    14.655612294713
E2      =    -6.057046501752
E3      =    -8.863575302051
Exc     =    -7.780819503343
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 5.623e-07, dEband = 2.509e-04
rank = 0, Calculating/Estimating energy took 0.990 ms, Etot = -24.939100318, dEtot = 5.623e-07, dEband = 2.509e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0237550461786, which took 0.060 ms

iter_count = 102, r_2norm = 8.861e-07, tol*||rhs|| = 9.502e-07

Anderson update took 62.145 ms, out of which F'*F took 27.903 ms; b-Ax took 191.072 ms, out of which Lap took 169.253 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 445.792 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669716, int_b + int_rho = -3.638e-15, checking this took 0.106 ms
2-norm of RHS = 584.2034658975648, which took 0.173 ms

iter_count = 144, r_2norm = 5.809e-04, tol*||rhs|| = 5.842e-04

Anderson update took 87.804 ms, out of which F'*F took 40.020 ms; b-Ax took 274.246 ms, out of which Lap took 239.644 ms
Solving Poisson took 624.655 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.142573 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.846 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.145496 
Total time for convolution: 	 convolve: 5.144265 
Total time for convolution: 	 convolve: 5.155263 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.633 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.326 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.345 ms

This SCF took 27018.544 ms, scf error = 1.165e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.137144, lowerbound = -0.931378, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1282.989 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.745 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 2.781 ms
rank =  0, finding HY took 20.382 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.681 ms
Rank 0, Project_Hamiltonian used 25.866 ms
Total time for projection: 25.945 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.931251912570814
    last  calculated eigval = 0.038570986416271
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93125191257081
lambda[   2] =  -0.61423252161750
lambda[   3] =  -0.45492032207998
lambda[   4] =  -0.38544992428808
lambda[   5] =  -0.37486821286949
lambda[   6] =  -0.28929066462052
lambda[   7] =  -0.22527529679431
lambda[   8] =  -0.02533464224099
lambda[   9] =   0.00303302661190
lambda[  10] =   0.02329115473275
lambda[  11] =   0.02967269649337
lambda[  12] =   0.03204540349027
lambda[  13] =   0.03857098641627
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.138 ms
rank =  0, subspace rotation using ScaLAPACK took 3.872 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.878 ms

Total time for subspace rotation: 3.879 ms
rank = 0, Efermi =  -0.054662851912 calculate fermi energy took 0.629 ms
rank = 0, --- Calculate rho: sum over local bands took 1.581 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1315.987 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
rank = 0, D2D took 0.408 ms
rank = 0, Transfering density took 0.416 ms
Etot    =   -24.939119793074
Eband   =    -6.550577710104
E1      =    14.654747841197
E2      =    -6.056030101048
E3      =    -8.863713646299
Exc     =    -7.780921469531
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 3.246e-06, dEband = 3.042e-04
rank = 0, Calculating/Estimating energy took 1.473 ms, Etot = -24.939119793, dEtot = 3.246e-06, dEband = 3.042e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0161672646835, which took 0.059 ms

iter_count = 102, r_2norm = 5.571e-07, tol*||rhs|| = 6.467e-07

Anderson update took 62.319 ms, out of which F'*F took 27.860 ms; b-Ax took 191.571 ms, out of which Lap took 169.510 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 447.732 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669723, int_b + int_rho = 6.185e-14, checking this took 0.104 ms
2-norm of RHS = 584.2042902072624, which took 0.194 ms

iter_count = 108, r_2norm = 5.735e-04, tol*||rhs|| = 5.842e-04

Anderson update took 66.025 ms, out of which F'*F took 29.526 ms; b-Ax took 204.599 ms, out of which Lap took 179.542 ms
Solving Poisson took 471.355 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.149425 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.637 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.147844 
Total time for convolution: 	 convolve: 5.158401 
Total time for convolution: 	 convolve: 5.146353 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.325 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.343 ms

This SCF took 26867.778 ms, scf error = 1.063e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.138571, lowerbound = -0.931252, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1280.456 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.754 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 2.790 ms
rank =  0, finding HY took 20.175 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.657 ms
Rank 0, Project_Hamiltonian used 25.644 ms
Total time for projection: 25.661 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.931250702624000
    last  calculated eigval = 0.038835642517971
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93125070262400
lambda[   2] =  -0.61421912217765
lambda[   3] =  -0.45491105494406
lambda[   4] =  -0.38543467088400
lambda[   5] =  -0.37485832446150
lambda[   6] =  -0.28928084565452
lambda[   7] =  -0.22526757991456
lambda[   8] =  -0.02537610500187
lambda[   9] =   0.00308796109024
lambda[  10] =   0.02456075726856
lambda[  11] =   0.02968389163793
lambda[  12] =   0.03299526788966
lambda[  13] =   0.03883564251797
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.138 ms
rank =  0, subspace rotation using ScaLAPACK took 3.169 ms
rank =  0, Distributing orbital back into band + domain format took 0.005 ms
rank = 0, Subspace_Rotation used 3.181 ms

Total time for subspace rotation: 3.183 ms
rank = 0, Efermi =  -0.054704314587 calculate fermi energy took 138.551 ms
rank = 0, --- Calculate rho: sum over local bands took 1.643 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1450.801 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
rank = 0, D2D took 0.366 ms
rank = 0, Transfering density took 0.372 ms
Etot    =   -24.939120498639
Eband   =    -6.550444601744
E1      =    14.654746338868
E2      =    -6.055904849339
E3      =    -8.863682284490
Exc     =    -7.780897167609
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 1.176e-07, dEband = 2.218e-05
rank = 0, Calculating/Estimating energy took 1.004 ms, Etot = -24.939120499, dEtot = 1.176e-07, dEband = 2.218e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0183187924118, which took 0.062 ms

iter_count = 96, r_2norm = 6.985e-07, tol*||rhs|| = 7.328e-07

Anderson update took 58.419 ms, out of which F'*F took 26.184 ms; b-Ax took 180.117 ms, out of which Lap took 159.545 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.655 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669712, int_b + int_rho = -4.729e-14, checking this took 0.112 ms
2-norm of RHS = 584.2047810923872, which took 0.197 ms

iter_count = 96, r_2norm = 5.391e-04, tol*||rhs|| = 5.842e-04

Anderson update took 58.645 ms, out of which F'*F took 26.461 ms; b-Ax took 182.500 ms, out of which Lap took 159.837 ms
Solving Poisson took 417.352 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.146753 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.267 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.139839 
Total time for convolution: 	 convolve: 6.501271 
Total time for convolution: 	 convolve: 5.137485 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.045 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.338 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.359 ms

This SCF took 28259.120 ms, scf error = 1.222e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.138836, lowerbound = -0.931251, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1299.429 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.745 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 2.778 ms
rank =  0, finding HY took 20.357 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.685 ms
Rank 0, Project_Hamiltonian used 25.842 ms
Total time for projection: 25.934 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.931211369449758
    last  calculated eigval = 0.039453873474626
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93121136944976
lambda[   2] =  -0.61417263839167
lambda[   3] =  -0.45486868367749
lambda[   4] =  -0.38538772631744
lambda[   5] =  -0.37481328415680
lambda[   6] =  -0.28923765001797
lambda[   7] =  -0.22522634906244
lambda[   8] =  -0.02481251134445
lambda[   9] =   0.00351427649850
lambda[  10] =   0.02532878958383
lambda[  11] =   0.02999502201812
lambda[  12] =   0.03370051143876
lambda[  13] =   0.03945387347463
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.744 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.752 ms

Total time for subspace rotation: 3.754 ms
rank = 0, Efermi =  -0.054140720954 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 1.647 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1331.649 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
rank = 0, D2D took 0.505 ms
rank = 0, Transfering density took 0.508 ms
Etot    =   -24.939122807814
Eband   =    -6.549835402561
E1      =    14.654466672669
E2      =    -6.055566026091
E3      =    -8.863719696665
Exc     =    -7.780927598694
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 3.849e-07, dEband = 1.015e-04
rank = 0, Calculating/Estimating energy took 1.204 ms, Etot = -24.939122808, dEtot = 3.849e-07, dEband = 1.015e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0178571334108, which took 0.057 ms

iter_count = 96, r_2norm = 6.927e-07, tol*||rhs|| = 7.143e-07

Anderson update took 58.461 ms, out of which F'*F took 26.352 ms; b-Ax took 180.549 ms, out of which Lap took 160.023 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.878 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669715, int_b + int_rho = -1.637e-14, checking this took 0.122 ms
2-norm of RHS = 584.2046095747111, which took 0.184 ms

iter_count = 24, r_2norm = 5.420e-04, tol*||rhs|| = 5.842e-04

Anderson update took 14.664 ms, out of which F'*F took 6.593 ms; b-Ax took 45.346 ms, out of which Lap took 39.815 ms
Solving Poisson took 107.616 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.140794 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.146886 
Total time for convolution: 	 convolve: 5.148149 
Total time for convolution: 	 convolve: 5.152442 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 2.189 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.322 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.341 ms

This SCF took 26482.649 ms, scf error = 1.297e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.139454, lowerbound = -0.931211, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1280.632 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.746 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.041 ms
rank =  0, Distribute data + matrix mult took 2.791 ms
rank =  0, finding HY took 20.174 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.683 ms
Rank 0, Project_Hamiltonian used 25.670 ms
Total time for projection: 25.691 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.115 ms
    first calculated eigval = -0.931209494012519
    last  calculated eigval = 0.039266372762958
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93120949401252
lambda[   2] =  -0.61417046081719
lambda[   3] =  -0.45486700264503
lambda[   4] =  -0.38538576694753
lambda[   5] =  -0.37481111933967
lambda[   6] =  -0.28923557616414
lambda[   7] =  -0.22522423291411
lambda[   8] =  -0.02484011709729
lambda[   9] =   0.00351766744098
lambda[  10] =   0.02529025011042
lambda[  11] =   0.02976349931525
lambda[  12] =   0.03347821084326
lambda[  13] =   0.03926637276296
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.134 ms
rank =  0, subspace rotation using ScaLAPACK took 2.706 ms
rank =  0, Distributing orbital back into band + domain format took 0.005 ms
rank = 0, Subspace_Rotation used 2.720 ms

Total time for subspace rotation: 2.721 ms
rank = 0, Efermi =  -0.054168326768 calculate fermi energy took 0.112 ms
rank = 0, --- Calculate rho: sum over local bands took 1.702 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1312.833 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
rank = 0, D2D took 0.534 ms
rank = 0, Transfering density took 0.542 ms
Etot    =   -24.939119047107
Eband   =    -6.549807306095
E1      =    14.654446372867
E2      =    -6.055557629095
E3      =    -8.863739297129
Exc     =    -7.780942838119
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 6.268e-07, dEband = 4.683e-06
rank = 0, Calculating/Estimating energy took 1.138 ms, Etot = -24.939119047, dEtot = 6.268e-07, dEband = 4.683e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0177385106123, which took 0.094 ms

iter_count = 96, r_2norm = 7.006e-07, tol*||rhs|| = 7.095e-07

Anderson update took 58.578 ms, out of which F'*F took 26.203 ms; b-Ax took 179.800 ms, out of which Lap took 159.491 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.683 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669714, int_b + int_rho = -2.910e-14, checking this took 0.126 ms
2-norm of RHS = 584.2038800125418, which took 0.184 ms

iter_count = 42, r_2norm = 5.348e-04, tol*||rhs|| = 5.842e-04

Anderson update took 25.861 ms, out of which F'*F took 11.540 ms; b-Ax took 79.934 ms, out of which Lap took 70.031 ms
Solving Poisson took 184.726 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.137223 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.456 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.147536 
Total time for convolution: 	 convolve: 5.144729 
Total time for convolution: 	 convolve: 5.170378 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.666 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.756 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.591 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
---Transfer Veff_loc: D2D took 0.360 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.383 ms

This SCF took 26546.964 ms, scf error = 1.275e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.139266, lowerbound = -0.931209, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1285.056 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.739 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 2.767 ms
rank =  0, finding HY took 20.323 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.668 ms
Rank 0, Project_Hamiltonian used 25.780 ms
Total time for projection: 25.803 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.029 ms
rank = 0, Solve_Generalized_EigenProblem used 0.861 ms
    first calculated eigval = -0.931186511328482
    last  calculated eigval = 0.039152227956096
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93118651132848
lambda[   2] =  -0.61415500012825
lambda[   3] =  -0.45484889033968
lambda[   4] =  -0.38537118925197
lambda[   5] =  -0.37479467642283
lambda[   6] =  -0.28921903080995
lambda[   7] =  -0.22520563009553
lambda[   8] =  -0.02479902335967
lambda[   9] =   0.00354983070417
lambda[  10] =   0.02521311470261
lambda[  11] =   0.02960099537044
lambda[  12] =   0.03324121466123
lambda[  13] =   0.03915222795610
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.880 ms
rank =  0, subspace rotation using ScaLAPACK took 3.560 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.567 ms

Total time for subspace rotation: 3.569 ms
rank = 0, Efermi =  -0.054127233012 calculate fermi energy took 0.105 ms
rank = 0, --- Calculate rho: sum over local bands took 1.673 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1317.779 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
rank = 0, D2D took 0.566 ms
rank = 0, Transfering density took 0.576 ms
Etot    =   -24.939119374387
Eband   =    -6.549561857167
E1      =    14.654282016360
E2      =    -6.055465028212
E3      =    -8.863791041749
Exc     =    -7.780983401557
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 5.455e-08, dEband = 4.091e-05
rank = 0, Calculating/Estimating energy took 1.171 ms, Etot = -24.939119374, dEtot = 5.455e-08, dEband = 4.091e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0175213900488, which took 0.061 ms

iter_count = 102, r_2norm = 4.217e-07, tol*||rhs|| = 7.009e-07

Anderson update took 61.890 ms, out of which F'*F took 28.012 ms; b-Ax took 191.925 ms, out of which Lap took 170.107 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 447.592 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669718, int_b + int_rho = 1.091e-14, checking this took 0.112 ms
2-norm of RHS = 584.2029435931356, which took 0.127 ms

iter_count = 48, r_2norm = 5.590e-04, tol*||rhs|| = 5.842e-04

Anderson update took 29.340 ms, out of which F'*F took 13.297 ms; b-Ax took 91.000 ms, out of which Lap took 79.917 ms
Solving Poisson took 211.665 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.143575 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 41.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.210 ms
Total time for convolution: 	 convolve: 5.159245 
Total time for convolution: 	 convolve: 5.158634 
Total time for convolution: 	 convolve: 5.147456 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.323 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.341 ms

This SCF took 26618.680 ms, scf error = 1.110e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.139152, lowerbound = -0.931187, upperbound = 267.572622

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1281.219 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.756 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.047 ms
rank =  0, Distribute data + matrix mult took 2.808 ms
rank =  0, finding HY took 20.631 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.717 ms
Rank 0, Project_Hamiltonian used 26.195 ms
Total time for projection: 26.241 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.098 ms
    first calculated eigval = -0.931148792563171
    last  calculated eigval = 0.038692047379647
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.93114879256317
lambda[   2] =  -0.61412800748648
lambda[   3] =  -0.45481850668822
lambda[   4] =  -0.38534596374385
lambda[   5] =  -0.37476634484059
lambda[   6] =  -0.28918979336780
lambda[   7] =  -0.22517347110614
lambda[   8] =  -0.02500763144912
lambda[   9] =   0.00346180360966
lambda[  10] =   0.02506035186462
lambda[  11] =   0.02925412180137
lambda[  12] =   0.03286688301373
lambda[  13] =   0.03869204737965
==subpsace eigenproblem: bcast eigvals took 0.035 ms
Total time for solving subspace eigenvalue problem: 0.139 ms
rank =  0, subspace rotation using ScaLAPACK took 3.866 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.871 ms

Total time for subspace rotation: 3.872 ms
rank = 0, Efermi =  -0.054335841102 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.734 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1313.383 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
rank = 0, D2D took 0.552 ms
rank = 0, Transfering density took 0.561 ms
Etot    =   -24.939119086798
Eband   =    -6.549141760010
E1      =    14.654006222416
E2      =    -6.055300398379
E3      =    -8.863878851069
Exc     =    -7.781050596669
Esc     =   -40.182112201479
Entropy =    -0.000000000504
dE = 4.793e-08, dEband = 7.002e-05
rank = 0, Calculating/Estimating energy took 1.146 ms, Etot = -24.939119087, dEtot = 4.793e-08, dEband = 7.002e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0119247857781, which took 0.060 ms

iter_count = 102, r_2norm = 3.825e-07, tol*||rhs|| = 4.770e-07

Anderson update took 62.046 ms, out of which F'*F took 27.787 ms; b-Ax took 191.044 ms, out of which Lap took 169.214 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 445.982 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001669717, int_rho =  14.00000001669716, int_b + int_rho = -3.638e-15, checking this took 0.103 ms
2-norm of RHS = 584.2010975546987, which took 0.128 ms

iter_count = 90, r_2norm = 5.478e-04, tol*||rhs|| = 5.842e-04

Anderson update took 55.057 ms, out of which F'*F took 24.873 ms; b-Ax took 170.951 ms, out of which Lap took 149.554 ms
Solving Poisson took 391.380 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.138758 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 44.978 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.144100 
Total time for convolution: 	 convolve: 5.160050 
Total time for convolution: 	 convolve: 5.156150 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.162 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.340 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.362 ms

This SCF took 26791.763 ms, scf error = 8.381e-05
The last 13 occupations of kpoints #1 are (Nelectron = 14):
lambda[   1] =  -0.93114879256317, occ[   1] =   2.00000000000000
lambda[   2] =  -0.61412800748648, occ[   2] =   2.00000000000000
lambda[   3] =  -0.45481850668822, occ[   3] =   2.00000000000000
lambda[   4] =  -0.38534596374385, occ[   4] =   2.00000000000000
lambda[   5] =  -0.37476634484059, occ[   5] =   2.00000000000000
lambda[   6] =  -0.28918979336780, occ[   6] =   2.00000000000000
lambda[   7] =  -0.22517347110614, occ[   7] =   2.00000000000000
lambda[   8] =  -0.02500763144912, occ[   8] =   0.00000001669715
lambda[   9] =   0.00346180360966, occ[   9] =   0.00000000000000
lambda[  10] =   0.02506035186462, occ[  10] =   0.00000000000000
lambda[  11] =   0.02925412180137, occ[  11] =   0.00000000000000
lambda[  12] =   0.03286688301373, occ[  12] =   0.00000000000000
lambda[  13] =   0.03869204737965, occ[  13] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 12 (90%) = 0.000000000000000.
Occupation of state 13 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.156 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.281 ms, time for Allreduce/Reduce: 7.270 ms 
Time for calculating local force components: 14.199 ms
Start Calculating nonlocal forces
force_nloc = 
  0.89442931493648   0.60311093418026   0.00000007345654
  0.04906881611487  -0.01510658398566   0.00000001726250
 -0.02168205004621  -0.01926810394031  -0.04062164762754
 -0.02168201470373  -0.01926813815155   0.04062158576554
 -0.07075537480425   0.02487091513470   0.00000000086946
  0.00650949063930  -0.16714264364417  -0.00000119030844
force_loc = 
 -0.87025178170792  -0.58635728969603  -0.00000313648026
 -0.05270874407023   0.01628036028327  -0.00000034064590
  0.02348730052016   0.02078060095851   0.04404587217068
  0.02348694786802   0.02078155668455  -0.04404517887595
  0.07440864895021  -0.02794711370235  -0.00000000843255
 -0.00708120021967   0.16060609748625  -0.00000165611621
Time for calculating nonlocal force components: 22.140 ms
[32mforces_xc: 
[0m[32m -0.02678773339639  -0.02043069065082  -0.00000009031356
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00058640953936   0.00893942691666  -0.00000010752677
[0mTime for calculating XC forces components: 18.734 ms
 Cartesian force = 
 -0.00258606859138  -0.00365193414548  -0.00000218553686
 -0.00361579637891   0.00119888831872   0.00000064441701
  0.00182938205040   0.00153760903932   0.00342519234355
  0.00182906474074   0.00153853055412  -0.00342262531001
  0.00367740572242  -0.00305108654653   0.00000096023732
 -0.00113398754328   0.00242799277985  -0.00000198615101
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.359 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.985 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Time for printing density: 384.038 ms
The program took 630.433 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:39:16
Job ID:        2266963
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:08:48,vmem=8344K,walltime=00:10:44,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-24-1
---------------------------------------
