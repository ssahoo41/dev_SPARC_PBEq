---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:05
Job ID:    2266575
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:11
Job ID:    2266575
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 13.664 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 9.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 0.700 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 66.766 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.954 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.088 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    7.566568	    9.460237	   10.000000	
    6.161023	   10.611824	   10.000000	
   13.838977	   10.100937	   10.000000	
   11.977334	    7.863091	   11.674052	
   11.977334	    7.863091	    8.325948	
    9.932461	   12.136909	   11.675342	
    9.932461	   12.136909	    8.324658	
   12.044243	    9.073956	   10.000000	
    9.830879	   10.904231	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.166 ms
Set up communicators.

--set up spincomm took 2.231 ms

--set up kptcomm took 0.351 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {2, 2, 3}
gridsizes = [100, 100, 100], Nstates = 17, dmcomm dims = [2, 2, 3]

--set up dmcomm took 0.011 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 1, ScaLAPACK topology Dims = (1, 1)
nproc = 12, size_blacscomm = 1 = dims[0] * dims[1] = (1, 1)
Nd_blacscomm 85000, Nstates 17 
rank =  0, my blacs rank = 0, BLCYC size (85000, 17), actual size (85000, 17)
rank = 0, mb = nb = 17, mbQ = nbQ = 64
rank = 0, nr_Hp = 17, nc_Hp = 17
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.037 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 1
# of bands per bandcomm          : 17
npdomain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.361 ms

Calculate_SplineDerivRadFun took 0.221 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.289 ms.
time spent on vectorized spline interp: 3.330 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.026 ms.
time spent on vectorized spline interp: 1.455 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.381 ms.
time spent on vectorized spline interp: 1.789 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.432 ms.

Calculating rb for all atom types took 16.725 ms
----------------------
Estimated memory usage
Total: 663.08 MB
orbitals             : 389.10 MB
global sized vectors : 213.62 MB
subspace matrices : 81.28 kB
others : 60.28 MB
----------------------------------------------
Estimated memory usage per processor: 55.26 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.817 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -20.0000000250502, sum_int_rho = 19.4049412366146
PosCharge = 20.000000025050, NegCharge = -19.404941236615, scal_fac = 1.030665322877
After scaling, int_rho = 20.0000000250502, PosCharge + NegCharge - NetCharge = 1.421e-14
--Calculate Vref took 0.403 ms
--Calculate rho_guess took 2.331 ms

 integral of b = -20.0000000250502,
 int{b} + Nelectron + NetCharge = -2.505e-08,
 Esc = -53.4404220978134,
 MPI_Reduce took 7.843 ms

Calculating b & b_ref took 16.330 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.010 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.019 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.037 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 32.783 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505014, int_b + int_rho = -4.002e-14, checking this took 0.088 ms
2-norm of RHS = 714.1772481518491, which took 0.755 ms

iter_count = 420, r_2norm = 5.585e-04, tol*||rhs|| = 7.142e-04

Anderson update took 268.168 ms, out of which F'*F took 117.317 ms; b-Ax took 801.636 ms, out of which Lap took 709.794 ms
Solving Poisson took 1769.465 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.031 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.335 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
Total time for convolution: 	 convolve: 5.135977 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
Total time for convolution: 	 convolve: 5.140001 
Total time for convolution: 	 convolve: 5.130002 
Total time for convolution: 	 convolve: 5.123138 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.655 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
rank = 0, XC calculation took 24380.684 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.574 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 1.648 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.124 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.828 ms
    Lanczos iter 53, eigmin  = -0.956086337, eigmax = 264.928420185, err_eigmin = 2.097e-03, err_eigmax = 9.619e-03
rank =   0, Lanczos took 132.433 ms, eigmin = -0.956086336780, eigmax = 267.577704387064

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.260809, lowerbound = -1.056086, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1663.795 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.075 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.174 ms
rank =  0, Distribute data + matrix mult took 3.261 ms
rank =  0, finding HY took 25.836 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.990 ms
Rank 0, Project_Hamiltonian used 33.115 ms
Total time for projection: 33.154 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.621 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.157 ms
rank = 0, Solve_Generalized_EigenProblem used 0.782 ms
    first calculated eigval = 2.756889156293313
    last  calculated eigval = 3.256974673912705
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =   2.75688915629331
lambda[   2] =   2.84425757890234
lambda[   3] =   2.85246009595184
lambda[   4] =   2.89561566089223
lambda[   5] =   2.92233514072330
lambda[   6] =   2.94511505584284
lambda[   7] =   2.96227824958169
lambda[   8] =   2.97953785615397
lambda[   9] =   3.03479097649722
lambda[  10] =   3.05007879427405
lambda[  11] =   3.06843492760207
lambda[  12] =   3.09965115782488
lambda[  13] =   3.11441451264975
lambda[  14] =   3.14474581763403
lambda[  15] =   3.15313285483714
lambda[  16] =   3.24409457234659
lambda[  17] =   3.25697467391271
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.801 ms
rank =  0, subspace rotation using ScaLAPACK took 4.924 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.934 ms

Total time for subspace rotation: 4.936 ms
rank = 0, Efermi =   3.059256900153 calculate fermi energy took 0.060 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.356975, lowerbound = -1.056086, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1650.224 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.987 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.119 ms
rank =  0, Distribute data + matrix mult took 3.113 ms
rank =  0, finding HY took 25.724 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 3.856 ms
Rank 0, Project_Hamiltonian used 32.720 ms
Total time for projection: 32.725 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.033 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.708362149359479
    last  calculated eigval = 0.465201300095537
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.70836214935948
lambda[   2] =  -0.47273634600408
lambda[   3] =  -0.37251799805503
lambda[   4] =  -0.23295584372012
lambda[   5] =  -0.01157058573695
lambda[   6] =   0.02098910704193
lambda[   7] =   0.08139064651628
lambda[   8] =   0.12371056676088
lambda[   9] =   0.15368431292821
lambda[  10] =   0.25047098834544
lambda[  11] =   0.30376240385524
lambda[  12] =   0.33000059305390
lambda[  13] =   0.36086901743069
lambda[  14] =   0.37832936643388
lambda[  15] =   0.40390090550329
lambda[  16] =   0.44098271009871
lambda[  17] =   0.46520130009554
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 4.604 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.613 ms

Total time for subspace rotation: 4.614 ms
rank = 0, Efermi =   0.277158329069 calculate fermi energy took 0.033 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.565201, lowerbound = -1.056086, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1714.453 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.945 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.909 ms
rank =  0, Distribute data + matrix mult took 3.894 ms
rank =  0, finding HY took 25.779 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.872 ms
Rank 0, Project_Hamiltonian used 33.574 ms
Total time for projection: 33.579 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.036 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -0.982189690639291
    last  calculated eigval = 0.161237955815764
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.98218969063929
lambda[   2] =  -0.79611493692971
lambda[   3] =  -0.65555182602757
lambda[   4] =  -0.52498847745000
lambda[   5] =  -0.50993729138722
lambda[   6] =  -0.45705737131648
lambda[   7] =  -0.43790726960068
lambda[   8] =  -0.42040430072069
lambda[   9] =  -0.35189065082382
lambda[  10] =  -0.25438266698212
lambda[  11] =   0.04025061761735
lambda[  12] =   0.08058919770194
lambda[  13] =   0.09915076638350
lambda[  14] =   0.10616813755117
lambda[  15] =   0.12757190206164
lambda[  16] =   0.13921837678609
lambda[  17] =   0.16123795581576
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 4.640 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.648 ms

Total time for subspace rotation: 4.649 ms
rank = 0, Efermi =   0.011287366609 calculate fermi energy took 0.022 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.261238, lowerbound = -1.056086, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1646.744 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.996 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.157 ms
rank =  0, Distribute data + matrix mult took 3.164 ms
rank =  0, finding HY took 25.839 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.925 ms
Rank 0, Project_Hamiltonian used 32.959 ms
Total time for projection: 32.964 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.034 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -0.982563724463675
    last  calculated eigval = 0.106475335830956
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.98256372446368
lambda[   2] =  -0.79749528611086
lambda[   3] =  -0.65765627265763
lambda[   4] =  -0.53691874368493
lambda[   5] =  -0.51459075749930
lambda[   6] =  -0.46287844041382
lambda[   7] =  -0.44652908433517
lambda[   8] =  -0.42752496796906
lambda[   9] =  -0.36425330641895
lambda[  10] =  -0.28763338423401
lambda[  11] =  -0.00396443770697
lambda[  12] =   0.02078062131904
lambda[  13] =   0.03702813498033
lambda[  14] =   0.05222437543225
lambda[  15] =   0.06147692282808
lambda[  16] =   0.08380498473725
lambda[  17] =   0.10647533583096
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 4.460 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.469 ms

Total time for subspace rotation: 4.470 ms
rank = 0, Efermi =  -0.032927688709 calculate fermi energy took 0.025 ms
rank = 0, --- Calculate rho: sum over local bands took 3.394 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 6966.054 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.332 ms
rank = 0, D2D took 0.488 ms
rank = 0, Transfering density took 0.492 ms
Etot    =   -32.255686245075
Eband   =   -10.956087935674
E1      =    22.207059590980
E2      =    -8.566816966031
E3      =   -11.566605022296
Exc     =   -10.199657790146
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 3.584e+00, dEband = 1.217e+00
rank = 0, Calculating/Estimating energy took 2.671 ms, Etot = -32.255686245, dEtot = 3.584e+00, dEband = 1.217e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 54.6572775165859, which took 0.053 ms

iter_count = 96, r_2norm = 1.591e-03, tol*||rhs|| = 2.186e-03

Anderson update took 57.454 ms, out of which F'*F took 27.302 ms; b-Ax took 186.204 ms, out of which Lap took 163.684 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 411.648 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505016, int_b + int_rho = -1.819e-14, checking this took 0.128 ms
2-norm of RHS = 710.5009681706467, which took 0.170 ms

iter_count = 288, r_2norm = 5.548e-04, tol*||rhs|| = 7.105e-04

Anderson update took 170.123 ms, out of which F'*F took 82.147 ms; b-Ax took 565.615 ms, out of which Lap took 502.154 ms
Solving Poisson took 1233.394 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.900 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.113573 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 58.700 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.101304 
Total time for convolution: 	 convolve: 5.096530 
Total time for convolution: 	 convolve: 5.096619 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.222 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.314 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.331 ms

This SCF took 33248.109 ms, scf error = 1.684e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.206475, lowerbound = -0.982564, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1644.919 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.982 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.153 ms
rank =  0, Distribute data + matrix mult took 3.143 ms
rank =  0, finding HY took 25.679 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 4.000 ms
Rank 0, Project_Hamiltonian used 32.850 ms
Total time for projection: 32.878 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.967338006258815
    last  calculated eigval = 0.079952355667522
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.96733800625882
lambda[   2] =  -0.76187624329741
lambda[   3] =  -0.62743263338079
lambda[   4] =  -0.51622362334756
lambda[   5] =  -0.48612155931988
lambda[   6] =  -0.43034221122717
lambda[   7] =  -0.41737801493883
lambda[   8] =  -0.39908370797008
lambda[   9] =  -0.34222421597646
lambda[  10] =  -0.26954027668847
lambda[  11] =  -0.02954055399343
lambda[  12] =   0.00138327957494
lambda[  13] =   0.01730087210721
lambda[  14] =   0.02494225377094
lambda[  15] =   0.04000590878704
lambda[  16] =   0.06354245581547
lambda[  17] =   0.07995235566752
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 4.729 ms
rank =  0, Distributing orbital back into band + domain format took 0.005 ms
rank = 0, Subspace_Rotation used 4.744 ms

Total time for subspace rotation: 4.745 ms
rank = 0, Efermi =  -0.058503804992 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 2.052 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1685.854 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
rank = 0, D2D took 0.520 ms
rank = 0, Transfering density took 0.530 ms
Etot    =   -32.210336423126
Eband   =   -10.435120985551
E1      =    21.747160019787
E2      =    -8.523722410997
E3      =   -11.711062369347
Exc     =   -10.316738139145
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 5.039e-03, dEband = 5.789e-02
rank = 0, Calculating/Estimating energy took 1.132 ms, Etot = -32.210336423, dEtot = 5.039e-03, dEband = 5.789e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 15.3925968710835, which took 1.192 ms

iter_count = 102, r_2norm = 5.300e-04, tol*||rhs|| = 6.157e-04

Anderson update took 60.173 ms, out of which F'*F took 27.783 ms; b-Ax took 192.181 ms, out of which Lap took 170.711 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.499 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505017, int_b + int_rho = -1.091e-14, checking this took 0.139 ms
2-norm of RHS = 704.8989300477891, which took 0.133 ms

iter_count = 300, r_2norm = 6.516e-04, tol*||rhs|| = 7.049e-04

Anderson update took 181.010 ms, out of which F'*F took 85.962 ms; b-Ax took 580.268 ms, out of which Lap took 518.019 ms
Solving Poisson took 1263.274 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.323 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
Total time for convolution: 	 convolve: 5.176063 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.777 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.224026 
Total time for convolution: 	 convolve: 5.188706 
Total time for convolution: 	 convolve: 5.169994 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.647 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.334 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.352 ms

This SCF took 28169.918 ms, scf error = 1.168e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.179952, lowerbound = -0.967338, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1662.986 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.978 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.165 ms
rank =  0, Distribute data + matrix mult took 3.150 ms
rank =  0, finding HY took 26.099 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.910 ms
Rank 0, Project_Hamiltonian used 33.193 ms
Total time for projection: 33.218 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.163 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.039 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -0.941901241558413
    last  calculated eigval = 0.063508193542960
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.94190124155841
lambda[   2] =  -0.69945701536776
lambda[   3] =  -0.57034379466301
lambda[   4] =  -0.48084105153181
lambda[   5] =  -0.43458930084304
lambda[   6] =  -0.37360236275745
lambda[   7] =  -0.36225121054203
lambda[   8] =  -0.34320181408212
lambda[   9] =  -0.30158262451533
lambda[  10] =  -0.23622661042254
lambda[  11] =  -0.03550101201444
lambda[  12] =  -0.00285652917429
lambda[  13] =   0.01165701174920
lambda[  14] =   0.01566468693662
lambda[  15] =   0.03323028323435
lambda[  16] =   0.05450911836614
lambda[  17] =   0.06350819354296
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 4.659 ms
rank =  0, Distributing orbital back into band + domain format took 0.006 ms
rank = 0, Subspace_Rotation used 4.676 ms

Total time for subspace rotation: 4.677 ms
rank = 0, Efermi =  -0.064464263004 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 2.023 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1704.490 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
rank = 0, D2D took 0.496 ms
rank = 0, Transfering density took 0.509 ms
Etot    =   -32.171203847359
Eband   =    -9.487994053456
E1      =    20.940807920198
E2      =    -8.361986179891
E3      =   -12.022282767879
Exc     =   -10.567864563309
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 4.348e-03, dEband = 1.052e-01
rank = 0, Calculating/Estimating energy took 1.099 ms, Etot = -32.171203847, dEtot = 4.348e-03, dEband = 1.052e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.0214100461720, which took 0.083 ms

iter_count = 108, r_2norm = 1.117e-04, tol*||rhs|| = 1.609e-04

Anderson update took 64.066 ms, out of which F'*F took 30.949 ms; b-Ax took 212.048 ms, out of which Lap took 188.185 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.277 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505019, int_b + int_rho = 1.091e-14, checking this took 0.147 ms
2-norm of RHS = 705.1247578048930, which took 0.127 ms

iter_count = 276, r_2norm = 5.857e-04, tol*||rhs|| = 7.051e-04

Anderson update took 164.849 ms, out of which F'*F took 80.055 ms; b-Ax took 537.053 ms, out of which Lap took 477.767 ms
Solving Poisson took 1172.277 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.812 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.168407 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.168263 
Total time for convolution: 	 convolve: 5.176462 
Total time for convolution: 	 convolve: 5.169136 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.364 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.262 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.316 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.333 ms

This SCF took 28036.738 ms, scf error = 3.772e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.163508, lowerbound = -0.941901, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1656.796 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.988 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.113 ms
rank =  0, Distribute data + matrix mult took 3.109 ms
rank =  0, finding HY took 26.016 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.910 ms
Rank 0, Project_Hamiltonian used 33.063 ms
Total time for projection: 33.088 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.044 ms
rank = 0, Solve_Generalized_EigenProblem used 1.457 ms
    first calculated eigval = -0.940775525385580
    last  calculated eigval = 0.054940363452609
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.94077552538558
lambda[   2] =  -0.68997651920356
lambda[   3] =  -0.55950484587986
lambda[   4] =  -0.47489315428102
lambda[   5] =  -0.42278356356645
lambda[   6] =  -0.36652641942470
lambda[   7] =  -0.35219565450300
lambda[   8] =  -0.33162822945827
lambda[   9] =  -0.29683183477651
lambda[  10] =  -0.23266810600163
lambda[  11] =  -0.03650496649437
lambda[  12] =  -0.00449980821006
lambda[  13] =   0.01018237174318
lambda[  14] =   0.01215834138347
lambda[  15] =   0.02779280560120
lambda[  16] =   0.04215633079947
lambda[  17] =   0.05494036345261
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 1.481 ms
rank =  0, subspace rotation using ScaLAPACK took 4.684 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.691 ms

Total time for subspace rotation: 4.692 ms
rank = 0, Efermi =  -0.065468217483 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.227 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 1698.460 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
rank = 0, D2D took 0.438 ms
rank = 0, Transfering density took 0.445 ms
Etot    =   -32.167039771685
Eband   =    -9.335567705876
E1      =    20.857944172127
E2      =    -8.280243397607
E3      =   -12.087782680070
Exc     =   -10.617020217051
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 4.627e-04, dEband = 1.694e-02
rank = 0, Calculating/Estimating energy took 1.973 ms, Etot = -32.167039772, dEtot = 4.627e-04, dEband = 1.694e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.3511151069534, which took 0.073 ms

iter_count = 108, r_2norm = 7.072e-05, tol*||rhs|| = 9.404e-05

Anderson update took 64.044 ms, out of which F'*F took 30.905 ms; b-Ax took 212.806 ms, out of which Lap took 188.847 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 469.135 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505021, int_b + int_rho = 2.910e-14, checking this took 0.143 ms
2-norm of RHS = 705.1260723174255, which took 0.139 ms

iter_count = 240, r_2norm = 6.628e-04, tol*||rhs|| = 7.051e-04

Anderson update took 142.349 ms, out of which F'*F took 68.252 ms; b-Ax took 462.419 ms, out of which Lap took 410.413 ms
Solving Poisson took 1012.100 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.180213 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.574 ms
Total time for convolution: 	 convolve: 5.196853 
Total time for convolution: 	 convolve: 5.186328 
Total time for convolution: 	 convolve: 5.193141 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.329 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.348 ms

This SCF took 27948.301 ms, scf error = 1.004e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.154940, lowerbound = -0.940776, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1640.575 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.963 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 3.451 ms
rank =  0, finding HY took 25.541 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.934 ms
Rank 0, Project_Hamiltonian used 32.964 ms
Total time for projection: 32.993 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.175 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.041 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -0.938016630845098
    last  calculated eigval = 0.049284176308082
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.93801663084510
lambda[   2] =  -0.68628240180020
lambda[   3] =  -0.55599843088184
lambda[   4] =  -0.47211263102708
lambda[   5] =  -0.41941369158929
lambda[   6] =  -0.36322613975177
lambda[   7] =  -0.34821777447514
lambda[   8] =  -0.32777710506267
lambda[   9] =  -0.29381516918450
lambda[  10] =  -0.22973947328349
lambda[  11] =  -0.03672952270217
lambda[  12] =  -0.00511341171416
lambda[  13] =   0.00946711566678
lambda[  14] =   0.01045986400773
lambda[  15] =   0.02403766252855
lambda[  16] =   0.03190510687027
lambda[  17] =   0.04928417630808
==subpsace eigenproblem: bcast eigvals took 0.057 ms
Total time for solving subspace eigenvalue problem: 0.280 ms
rank =  0, subspace rotation using ScaLAPACK took 4.861 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.870 ms

Total time for subspace rotation: 4.871 ms
rank = 0, Efermi =  -0.065692773697 calculate fermi energy took 1.728 ms
rank = 0, --- Calculate rho: sum over local bands took 2.043 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1682.603 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
rank = 0, D2D took 0.530 ms
rank = 0, Transfering density took 0.540 ms
Etot    =   -32.166469151289
Eband   =    -9.269198896722
E1      =    20.817473380097
E2      =    -8.249962411872
E3      =   -12.107646150021
Exc     =   -10.631930097995
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 6.340e-05, dEband = 7.374e-03
rank = 0, Calculating/Estimating energy took 1.131 ms, Etot = -32.166469151, dEtot = 6.340e-05, dEband = 7.374e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8160307493161, which took 0.134 ms

iter_count = 108, r_2norm = 3.258e-05, tol*||rhs|| = 3.264e-05

Anderson update took 64.191 ms, out of which F'*F took 31.222 ms; b-Ax took 213.365 ms, out of which Lap took 189.615 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 470.777 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505018, int_b + int_rho = 0.000e+00, checking this took 0.139 ms
2-norm of RHS = 705.3779791876545, which took 0.141 ms

iter_count = 252, r_2norm = 7.000e-04, tol*||rhs|| = 7.054e-04

Anderson update took 150.180 ms, out of which F'*F took 71.276 ms; b-Ax took 486.072 ms, out of which Lap took 429.984 ms
Solving Poisson took 1060.373 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.297 ms
Total time for convolution: 	 convolve: 5.178015 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.374 ms
Total time for convolution: 	 convolve: 5.172859 
Total time for convolution: 	 convolve: 5.175711 
Total time for convolution: 	 convolve: 5.188254 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.332 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.350 ms

This SCF took 27913.158 ms, scf error = 6.864e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.149284, lowerbound = -0.938017, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1654.690 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.985 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.168 ms
rank =  0, Distribute data + matrix mult took 3.161 ms
rank =  0, finding HY took 26.089 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.946 ms
Rank 0, Project_Hamiltonian used 33.233 ms
Total time for projection: 33.259 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.157 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.040 ms
rank = 0, Solve_Generalized_EigenProblem used 0.201 ms
    first calculated eigval = -0.933109958429002
    last  calculated eigval = 0.045054295364182
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.93310995842900
lambda[   2] =  -0.68047749354980
lambda[   3] =  -0.55073386492693
lambda[   4] =  -0.46764418958054
lambda[   5] =  -0.41435264041201
lambda[   6] =  -0.35790600952362
lambda[   7] =  -0.34188855267445
lambda[   8] =  -0.32179530869000
lambda[   9] =  -0.28897879619984
lambda[  10] =  -0.22502164908381
lambda[  11] =  -0.03627249684462
lambda[  12] =  -0.00432287736770
lambda[  13] =   0.00979687210343
lambda[  14] =   0.01072997962600
lambda[  15] =   0.02205733279757
lambda[  16] =   0.02635165954675
lambda[  17] =   0.04505429536418
==subpsace eigenproblem: bcast eigvals took 0.053 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 4.759 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.766 ms

Total time for subspace rotation: 4.767 ms
rank = 0, Efermi =  -0.065235747860 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.230 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1695.368 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
rank = 0, D2D took 0.464 ms
rank = 0, Transfering density took 0.471 ms
Etot    =   -32.165903298255
Eband   =    -9.163816927049
E1      =    20.763350307742
E2      =    -8.192578724237
E3      =   -12.131158391178
Exc     =   -10.648751695802
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 6.287e-05, dEband = 1.171e-02
rank = 0, Calculating/Estimating energy took 2.362 ms, Etot = -32.165903298, dEtot = 6.287e-05, dEband = 1.171e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3746978116409, which took 0.142 ms

iter_count = 114, r_2norm = 9.957e-06, tol*||rhs|| = 1.499e-05

Anderson update took 68.086 ms, out of which F'*F took 32.915 ms; b-Ax took 224.681 ms, out of which Lap took 199.631 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 494.153 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505016, int_b + int_rho = -1.455e-14, checking this took 0.141 ms
2-norm of RHS = 705.5806753249383, which took 0.140 ms

iter_count = 240, r_2norm = 6.402e-04, tol*||rhs|| = 7.056e-04

Anderson update took 143.416 ms, out of which F'*F took 68.077 ms; b-Ax took 461.881 ms, out of which Lap took 409.933 ms
Solving Poisson took 1014.028 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.177181 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.164536 
Total time for convolution: 	 convolve: 5.203766 
Total time for convolution: 	 convolve: 5.177763 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 1.122 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.143 ms

This SCF took 27919.453 ms, scf error = 3.502e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.145054, lowerbound = -0.933110, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1641.997 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.977 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.167 ms
rank =  0, Distribute data + matrix mult took 3.153 ms
rank =  0, finding HY took 25.606 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.942 ms
Rank 0, Project_Hamiltonian used 32.734 ms
Total time for projection: 32.762 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.178 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.038 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -0.931689349172783
    last  calculated eigval = 0.042530100492052
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.93168934917278
lambda[   2] =  -0.67660046070551
lambda[   3] =  -0.54739225496508
lambda[   4] =  -0.46549437729494
lambda[   5] =  -0.41110716279720
lambda[   6] =  -0.35476231112269
lambda[   7] =  -0.33803115074943
lambda[   8] =  -0.31822193564443
lambda[   9] =  -0.28652606234772
lambda[  10] =  -0.22345583204529
lambda[  11] =  -0.03527789113326
lambda[  12] =  -0.00288547566940
lambda[  13] =   0.01106091413334
lambda[  14] =   0.01229923451751
lambda[  15] =   0.02184014795437
lambda[  16] =   0.02449433161643
lambda[  17] =   0.04253010049205
==subpsace eigenproblem: bcast eigvals took 0.037 ms
Total time for solving subspace eigenvalue problem: 0.260 ms
rank =  0, subspace rotation using ScaLAPACK took 4.843 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.851 ms

Total time for subspace rotation: 4.852 ms
rank = 0, Efermi =  -0.064241142143 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.192 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1682.223 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
rank = 0, D2D took 0.410 ms
rank = 0, Transfering density took 0.420 ms
Etot    =   -32.165713732758
Eband   =    -9.106561794574
E1      =    20.737076229069
E2      =    -8.159734721505
E3      =   -12.137587849717
Exc     =   -10.653128639914
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 2.106e-05, dEband = 6.362e-03
rank = 0, Calculating/Estimating energy took 1.945 ms, Etot = -32.165713733, dEtot = 2.106e-05, dEband = 6.362e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2554473647054, which took 0.071 ms

iter_count = 114, r_2norm = 7.306e-06, tol*||rhs|| = 1.022e-05

Anderson update took 67.656 ms, out of which F'*F took 32.783 ms; b-Ax took 224.949 ms, out of which Lap took 199.685 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 495.882 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505014, int_b + int_rho = -4.002e-14, checking this took 0.076 ms
2-norm of RHS = 705.6274611147184, which took 0.154 ms

iter_count = 222, r_2norm = 6.631e-04, tol*||rhs|| = 7.056e-04

Anderson update took 131.442 ms, out of which F'*F took 62.724 ms; b-Ax took 432.064 ms, out of which Lap took 383.033 ms
Solving Poisson took 936.374 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.175184 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.883 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.164752 
Total time for convolution: 	 convolve: 5.185554 
Total time for convolution: 	 convolve: 5.168962 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.511 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.321 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.003 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.339 ms

This SCF took 27820.763 ms, scf error = 1.770e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.142530, lowerbound = -0.931689, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1683.959 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.913 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.045 ms
rank =  0, Distribute data + matrix mult took 2.966 ms
rank =  0, finding HY took 26.127 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.885 ms
Rank 0, Project_Hamiltonian used 33.010 ms
Total time for projection: 33.036 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.030 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.930393995578004
    last  calculated eigval = 0.040876373505494
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.93039399557800
lambda[   2] =  -0.67510924769182
lambda[   3] =  -0.54596780650485
lambda[   4] =  -0.46424100905777
lambda[   5] =  -0.40972713842556
lambda[   6] =  -0.35330605241085
lambda[   7] =  -0.33639014851172
lambda[   8] =  -0.31665243125219
lambda[   9] =  -0.28516802823008
lambda[  10] =  -0.22216495475652
lambda[  11] =  -0.03413090562322
lambda[  12] =  -0.00126820713002
lambda[  13] =   0.01266943719200
lambda[  14] =   0.01434361438003
lambda[  15] =   0.02230034731863
lambda[  16] =   0.02440617436596
lambda[  17] =   0.04087637350549
==subpsace eigenproblem: bcast eigvals took 0.060 ms
Total time for solving subspace eigenvalue problem: 0.232 ms
rank =  0, subspace rotation using ScaLAPACK took 4.596 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.603 ms

Total time for subspace rotation: 4.604 ms
rank = 0, Efermi =  -0.063094156630 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.362 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1724.348 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
rank = 0, D2D took 0.434 ms
rank = 0, Transfering density took 0.441 ms
Etot    =   -32.165641641872
Eband   =    -9.078241625694
E1      =    20.724897876428
E2      =    -8.143026685179
E3      =   -12.139384452617
Exc     =   -10.654286931840
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 8.010e-06, dEband = 3.147e-03
rank = 0, Calculating/Estimating energy took 2.127 ms, Etot = -32.165641642, dEtot = 8.010e-06, dEband = 3.147e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1431211141826, which took 0.159 ms

iter_count = 114, r_2norm = 4.143e-06, tol*||rhs|| = 5.725e-06

Anderson update took 68.146 ms, out of which F'*F took 32.983 ms; b-Ax took 224.944 ms, out of which Lap took 199.786 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 494.646 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505013, int_b + int_rho = -5.093e-14, checking this took 0.105 ms
2-norm of RHS = 705.5913544782582, which took 0.112 ms

iter_count = 222, r_2norm = 5.855e-04, tol*||rhs|| = 7.056e-04

Anderson update took 131.877 ms, out of which F'*F took 62.901 ms; b-Ax took 427.563 ms, out of which Lap took 379.018 ms
Solving Poisson took 936.949 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.177614 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.164250 
Total time for convolution: 	 convolve: 5.181356 
Total time for convolution: 	 convolve: 5.191427 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.217 ms
---Transfer Veff_loc: D2D took 0.310 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.327 ms

This SCF took 27841.416 ms, scf error = 1.279e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.140876, lowerbound = -0.930394, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1645.818 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.970 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.090 ms
rank =  0, Distribute data + matrix mult took 3.066 ms
rank =  0, finding HY took 25.669 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.877 ms
Rank 0, Project_Hamiltonian used 32.640 ms
Total time for projection: 32.666 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.106 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.929426011275742
    last  calculated eigval = 0.040288590114834
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.92942601127574
lambda[   2] =  -0.67315299050083
lambda[   3] =  -0.54408740942617
lambda[   4] =  -0.46293719886362
lambda[   5] =  -0.40794580305918
lambda[   6] =  -0.35162050558854
lambda[   7] =  -0.33428528476376
lambda[   8] =  -0.31463704579375
lambda[   9] =  -0.28368474018417
lambda[  10] =  -0.22096779147685
lambda[  11] =  -0.03208198167486
lambda[  12] =   0.00160604946057
lambda[  13] =   0.01542090740973
lambda[  14] =   0.01770115299862
lambda[  15] =   0.02431266505077
lambda[  16] =   0.02544724742440
lambda[  17] =   0.04028859011483
==subpsace eigenproblem: bcast eigvals took 0.049 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 4.822 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.831 ms

Total time for subspace rotation: 4.832 ms
rank = 0, Efermi =  -0.061045232690 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 2.235 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1685.887 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, D2D took 1.547 ms
rank = 0, Transfering density took 1.556 ms
Etot    =   -32.165591929750
Eband   =    -9.045489562669
E1      =    20.706933394097
E2      =    -8.127350121502
E3      =   -12.143708156030
Exc     =   -10.657671940149
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 5.524e-06, dEband = 3.639e-03
rank = 0, Calculating/Estimating energy took 1.423 ms, Etot = -32.165591930, dEtot = 5.524e-06, dEband = 3.639e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0885063391502, which took 0.083 ms

iter_count = 114, r_2norm = 2.714e-06, tol*||rhs|| = 3.540e-06

Anderson update took 67.553 ms, out of which F'*F took 33.031 ms; b-Ax took 225.390 ms, out of which Lap took 200.433 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 494.978 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505012, int_b + int_rho = -6.185e-14, checking this took 0.136 ms
2-norm of RHS = 705.5849609284397, which took 0.146 ms

iter_count = 204, r_2norm = 6.553e-04, tol*||rhs|| = 7.056e-04

Anderson update took 121.044 ms, out of which F'*F took 57.848 ms; b-Ax took 393.218 ms, out of which Lap took 348.161 ms
Solving Poisson took 862.135 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.027 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.169087 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.174169 
Total time for convolution: 	 convolve: 5.189868 
Total time for convolution: 	 convolve: 5.184281 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.743 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.522 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.332 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.354 ms

This SCF took 27750.330 ms, scf error = 7.993e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.140289, lowerbound = -0.929426, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1655.188 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.965 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.122 ms
rank =  0, Distribute data + matrix mult took 3.096 ms
rank =  0, finding HY took 25.920 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.899 ms
Rank 0, Project_Hamiltonian used 32.943 ms
Total time for projection: 32.968 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -0.928876583786250
    last  calculated eigval = 0.037519579701667
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.92887658378625
lambda[   2] =  -0.67241934128829
lambda[   3] =  -0.54338862775977
lambda[   4] =  -0.46239409413336
lambda[   5] =  -0.40729067746692
lambda[   6] =  -0.35095998173413
lambda[   7] =  -0.33337185098264
lambda[   8] =  -0.31377483557809
lambda[   9] =  -0.28309122621776
lambda[  10] =  -0.22039546086400
lambda[  11] =  -0.02972314767419
lambda[  12] =   0.00412332143275
lambda[  13] =   0.01717411203250
lambda[  14] =   0.02028730728219
lambda[  15] =   0.02599812194804
lambda[  16] =   0.02683709709048
lambda[  17] =   0.03751957970167
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 4.676 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.683 ms

Total time for subspace rotation: 4.683 ms
rank = 0, Efermi =  -0.058686398687 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.189 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.652 ms
rank = 0, Calculating density took 1696.471 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
rank = 0, D2D took 0.348 ms
rank = 0, Transfering density took 0.352 ms
Etot    =   -32.165658638836
Eband   =    -9.031925360367
E1      =    20.700823459877
E2      =    -8.119832960294
E3      =   -12.143943943977
Exc     =   -10.657911544056
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 7.412e-06, dEband = 1.507e-03
rank = 0, Calculating/Estimating energy took 2.226 ms, Etot = -32.165658639, dEtot = 7.412e-06, dEband = 1.507e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0903114632867, which took 0.110 ms

iter_count = 108, r_2norm = 3.403e-06, tol*||rhs|| = 3.612e-06

Anderson update took 63.854 ms, out of which F'*F took 31.169 ms; b-Ax took 213.018 ms, out of which Lap took 189.237 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.219 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505020, int_b + int_rho = 2.547e-14, checking this took 0.144 ms
2-norm of RHS = 705.5903697706995, which took 0.146 ms

iter_count = 192, r_2norm = 6.002e-04, tol*||rhs|| = 7.056e-04

Anderson update took 113.962 ms, out of which F'*F took 54.374 ms; b-Ax took 369.056 ms, out of which Lap took 327.359 ms
Solving Poisson took 810.392 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.168569 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.177748 
Total time for convolution: 	 convolve: 5.185387 
Total time for convolution: 	 convolve: 5.169542 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.223 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.327 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.346 ms

This SCF took 27665.122 ms, scf error = 5.175e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.137520, lowerbound = -0.928877, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1639.250 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.965 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.118 ms
rank =  0, Distribute data + matrix mult took 3.088 ms
rank =  0, finding HY took 25.633 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.793 ms
Rank 0, Project_Hamiltonian used 32.541 ms
Total time for projection: 32.566 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.928368773283699
    last  calculated eigval = 0.035340968076379
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.92836877328370
lambda[   2] =  -0.67176938625567
lambda[   3] =  -0.54278640134090
lambda[   4] =  -0.46187985831568
lambda[   5] =  -0.40668234189021
lambda[   6] =  -0.35037834858104
lambda[   7] =  -0.33268110760588
lambda[   8] =  -0.31309988856076
lambda[   9] =  -0.28257634389424
lambda[  10] =  -0.21991450828603
lambda[  11] =  -0.02781107454771
lambda[  12] =   0.00507912094726
lambda[  13] =   0.01867332639028
lambda[  14] =   0.02076728064752
lambda[  15] =   0.02524252106868
lambda[  16] =   0.02763187529385
lambda[  17] =   0.03534096807638
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.166 ms
rank =  0, subspace rotation using ScaLAPACK took 5.022 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 5.031 ms

Total time for subspace rotation: 5.032 ms
rank = 0, Efermi =  -0.056774325555 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.057 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1679.718 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
rank = 0, D2D took 0.514 ms
rank = 0, Transfering density took 0.523 ms
Etot    =   -32.165772241250
Eband   =    -9.020273916725
E1      =    20.694934221704
E2      =    -8.113780564992
E3      =   -12.144946246559
Exc     =   -10.658737259219
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 1.262e-05, dEband = 1.295e-03
rank = 0, Calculating/Estimating energy took 1.125 ms, Etot = -32.165772241, dEtot = 1.262e-05, dEband = 1.295e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0591151265289, which took 0.126 ms

iter_count = 108, r_2norm = 2.243e-06, tol*||rhs|| = 2.365e-06

Anderson update took 64.080 ms, out of which F'*F took 31.213 ms; b-Ax took 214.799 ms, out of which Lap took 191.119 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 470.614 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505023, int_b + int_rho = 5.093e-14, checking this took 0.136 ms
2-norm of RHS = 705.5900152334981, which took 0.116 ms

iter_count = 168, r_2norm = 7.002e-04, tol*||rhs|| = 7.056e-04

Anderson update took 99.776 ms, out of which F'*F took 47.539 ms; b-Ax took 323.980 ms, out of which Lap took 286.469 ms
Solving Poisson took 706.528 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.167846 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.168448 
Total time for convolution: 	 convolve: 5.180858 
Total time for convolution: 	 convolve: 5.175209 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.351 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.338 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.358 ms

This SCF took 27525.060 ms, scf error = 3.726e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.135341, lowerbound = -0.928369, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1657.665 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.979 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.172 ms
rank =  0, Distribute data + matrix mult took 3.157 ms
rank =  0, finding HY took 26.154 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.813 ms
Rank 0, Project_Hamiltonian used 33.149 ms
Total time for projection: 33.170 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.025 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.927987535318470
    last  calculated eigval = 0.035310369715090
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.92798753531847
lambda[   2] =  -0.67128525201122
lambda[   3] =  -0.54234184503145
lambda[   4] =  -0.46147531822627
lambda[   5] =  -0.40623261970915
lambda[   6] =  -0.34992808835074
lambda[   7] =  -0.33224395155469
lambda[   8] =  -0.31266590226709
lambda[   9] =  -0.28216613133415
lambda[  10] =  -0.21955355760688
lambda[  11] =  -0.02605168442021
lambda[  12] =   0.00611355733525
lambda[  13] =   0.02029410126554
lambda[  14] =   0.02147037432951
lambda[  15] =   0.02506147792938
lambda[  16] =   0.02866409631352
lambda[  17] =   0.03531036971509
==subpsace eigenproblem: bcast eigvals took 0.039 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 4.978 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.986 ms

Total time for subspace rotation: 4.987 ms
rank = 0, Efermi =  -0.055014935392 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.099 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1698.720 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, D2D took 0.477 ms
rank = 0, Transfering density took 0.484 ms
Etot    =   -32.165822570949
Eband   =    -9.011760403473
E1      =    20.690176423837
E2      =    -8.109833740054
E3      =   -12.145782133521
Exc     =   -10.659432366327
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 5.592e-06, dEband = 9.459e-04
rank = 0, Calculating/Estimating energy took 1.313 ms, Etot = -32.165822571, dEtot = 5.592e-06, dEband = 9.459e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0477720166176, which took 0.112 ms

iter_count = 114, r_2norm = 1.179e-06, tol*||rhs|| = 1.911e-06

Anderson update took 67.405 ms, out of which F'*F took 32.810 ms; b-Ax took 224.676 ms, out of which Lap took 199.523 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 494.538 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505012, int_b + int_rho = -6.185e-14, checking this took 0.143 ms
2-norm of RHS = 705.5934901810477, which took 0.161 ms

iter_count = 138, r_2norm = 6.771e-04, tol*||rhs|| = 7.056e-04

Anderson update took 81.797 ms, out of which F'*F took 39.113 ms; b-Ax took 265.455 ms, out of which Lap took 235.521 ms
Solving Poisson took 583.392 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.171332 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.165820 
Total time for convolution: 	 convolve: 5.184131 
Total time for convolution: 	 convolve: 5.164491 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.043 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.311 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.329 ms

This SCF took 27427.343 ms, scf error = 2.434e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.135310, lowerbound = -0.927988, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1642.830 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.979 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.139 ms
rank =  0, Distribute data + matrix mult took 3.124 ms
rank =  0, finding HY took 25.758 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.896 ms
Rank 0, Project_Hamiltonian used 32.800 ms
Total time for projection: 32.823 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.927812867910477
    last  calculated eigval = 0.035042991176619
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.92781286791048
lambda[   2] =  -0.67113940889085
lambda[   3] =  -0.54219868004368
lambda[   4] =  -0.46131816519553
lambda[   5] =  -0.40608876057636
lambda[   6] =  -0.34977737702331
lambda[   7] =  -0.33210331925127
lambda[   8] =  -0.31252374186997
lambda[   9] =  -0.28201386175898
lambda[  10] =  -0.21939280886357
lambda[  11] =  -0.02528617600418
lambda[  12] =   0.00653654407254
lambda[  13] =   0.02057597257857
lambda[  14] =   0.02183371208341
lambda[  15] =   0.02515903346718
lambda[  16] =   0.02926362573347
lambda[  17] =   0.03504299117662
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.903 ms
rank =  0, subspace rotation using ScaLAPACK took 4.751 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.759 ms

Total time for subspace rotation: 4.760 ms
rank = 0, Efermi =  -0.054249426962 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.074 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1683.675 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
rank = 0, D2D took 0.431 ms
rank = 0, Transfering density took 0.439 ms
Etot    =   -32.165841892832
Eband   =    -9.008737983401
E1      =    20.688729707202
E2      =    -8.108175974667
E3      =   -12.146036377113
Exc     =   -10.659623869851
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 2.147e-06, dEband = 3.358e-04
rank = 0, Calculating/Estimating energy took 4.110 ms, Etot = -32.165841893, dEtot = 2.147e-06, dEband = 3.358e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0296172924769, which took 0.135 ms

iter_count = 108, r_2norm = 1.178e-06, tol*||rhs|| = 1.185e-06

Anderson update took 64.226 ms, out of which F'*F took 31.245 ms; b-Ax took 213.206 ms, out of which Lap took 189.416 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 469.170 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505014, int_b + int_rho = -3.638e-14, checking this took 0.123 ms
2-norm of RHS = 705.6019511786275, which took 0.131 ms

iter_count = 162, r_2norm = 6.152e-04, tol*||rhs|| = 7.056e-04

Anderson update took 95.640 ms, out of which F'*F took 45.926 ms; b-Ax took 311.640 ms, out of which Lap took 275.501 ms
Solving Poisson took 684.104 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.192498 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.170513 
Total time for convolution: 	 convolve: 5.171643 
Total time for convolution: 	 convolve: 5.192682 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.332 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.350 ms

This SCF took 27535.995 ms, scf error = 2.035e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135043, lowerbound = -0.927813, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1661.062 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.976 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.144 ms
rank =  0, Distribute data + matrix mult took 3.127 ms
rank =  0, finding HY took 25.910 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.795 ms
Rank 0, Project_Hamiltonian used 33.296 ms
Total time for projection: 33.321 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.029 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.927465124300583
    last  calculated eigval = 0.036074167070925
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.92746512430058
lambda[   2] =  -0.67085683686399
lambda[   3] =  -0.54191028068625
lambda[   4] =  -0.46099284210850
lambda[   5] =  -0.40579760453539
lambda[   6] =  -0.34948046318181
lambda[   7] =  -0.33184802437334
lambda[   8] =  -0.31225756559826
lambda[   9] =  -0.28170358472713
lambda[  10] =  -0.21906525547354
lambda[  11] =  -0.02454039555268
lambda[  12] =   0.00653843874590
lambda[  13] =   0.02027354656353
lambda[  14] =   0.02250905766802
lambda[  15] =   0.02572645562340
lambda[  16] =   0.03014255149573
lambda[  17] =   0.03607416707092
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 4.813 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.818 ms

Total time for subspace rotation: 4.819 ms
rank = 0, Efermi =  -0.053503646557 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 2.187 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1701.697 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
rank = 0, D2D took 0.510 ms
rank = 0, Transfering density took 0.512 ms
Etot    =   -32.165877784079
Eband   =    -9.002755164312
E1      =    20.685927742005
E2      =    -8.104829144135
E3      =   -12.146520495976
Exc     =   -10.659977903322
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 3.988e-06, dEband = 6.648e-04
rank = 0, Calculating/Estimating energy took 2.741 ms, Etot = -32.165877784, dEtot = 3.988e-06, dEband = 6.648e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0242780679760, which took 0.057 ms

iter_count = 108, r_2norm = 9.247e-07, tol*||rhs|| = 9.711e-07

Anderson update took 64.636 ms, out of which F'*F took 31.232 ms; b-Ax took 212.789 ms, out of which Lap took 189.194 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.722 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505021, int_b + int_rho = 2.910e-14, checking this took 0.199 ms
2-norm of RHS = 705.6050563135518, which took 0.152 ms

iter_count = 132, r_2norm = 6.310e-04, tol*||rhs|| = 7.056e-04

Anderson update took 77.953 ms, out of which F'*F took 37.473 ms; b-Ax took 253.491 ms, out of which Lap took 224.698 ms
Solving Poisson took 556.947 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.180845 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.601 ms
Total time for convolution: 	 convolve: 5.169089 
Total time for convolution: 	 convolve: 5.163159 
Total time for convolution: 	 convolve: 5.194720 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.327 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.347 ms

This SCF took 27487.871 ms, scf error = 1.288e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136074, lowerbound = -0.927465, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1640.396 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.854 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 3.880 ms
rank =  0, finding HY took 25.717 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.880 ms
Rank 0, Project_Hamiltonian used 33.502 ms
Total time for projection: 33.524 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.025 ms
rank = 0, Solve_Generalized_EigenProblem used 0.132 ms
    first calculated eigval = -0.927417269277342
    last  calculated eigval = 0.037448664573663
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.92741726927734
lambda[   2] =  -0.67081092378849
lambda[   3] =  -0.54185881241094
lambda[   4] =  -0.46093701019722
lambda[   5] =  -0.40574094826722
lambda[   6] =  -0.34943494902564
lambda[   7] =  -0.33180542218719
lambda[   8] =  -0.31220983910203
lambda[   9] =  -0.28165495360274
lambda[  10] =  -0.21901395307197
lambda[  11] =  -0.02342483108301
lambda[  12] =   0.00701136003027
lambda[  13] =   0.02085755424312
lambda[  14] =   0.02339060811333
lambda[  15] =   0.02655520122778
lambda[  16] =   0.03149693148878
lambda[  17] =   0.03744866457366
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 4.685 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.699 ms

Total time for subspace rotation: 4.700 ms
rank = 0, Efermi =  -0.052388082074 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 2.250 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1681.214 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
rank = 0, D2D took 0.393 ms
rank = 0, Transfering density took 0.400 ms
Etot    =   -32.165885335567
Eband   =    -9.001768162448
E1      =    20.685655895161
E2      =    -8.104147786247
E3      =   -12.146370220221
Exc     =   -10.659868976187
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 8.391e-07, dEband = 1.097e-04
rank = 0, Calculating/Estimating energy took 2.675 ms, Etot = -32.165885336, dEtot = 8.391e-07, dEband = 1.097e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0244716124461, which took 0.056 ms

iter_count = 108, r_2norm = 9.320e-07, tol*||rhs|| = 9.789e-07

Anderson update took 64.251 ms, out of which F'*F took 32.830 ms; b-Ax took 213.364 ms, out of which Lap took 189.440 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 470.482 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505022, int_b + int_rho = 4.729e-14, checking this took 0.139 ms
2-norm of RHS = 705.6052556653983, which took 0.189 ms

iter_count = 36, r_2norm = 7.034e-04, tol*||rhs|| = 7.056e-04

Anderson update took 21.260 ms, out of which F'*F took 12.494 ms; b-Ax took 71.403 ms, out of which Lap took 63.532 ms
Solving Poisson took 155.219 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 5.360595 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.204258 
Total time for convolution: 	 convolve: 5.174645 
Total time for convolution: 	 convolve: 5.185186 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.314 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.962 ms

This SCF took 27195.332 ms, scf error = 1.328e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.137449, lowerbound = -0.927417, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1655.075 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.985 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.132 ms
rank =  0, Distribute data + matrix mult took 3.121 ms
rank =  0, finding HY took 25.866 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.973 ms
Rank 0, Project_Hamiltonian used 32.983 ms
Total time for projection: 33.006 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.107 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.025 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.927416922923664
    last  calculated eigval = 0.037458851336412
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.92741692292366
lambda[   2] =  -0.67081266662750
lambda[   3] =  -0.54185943195485
lambda[   4] =  -0.46093715151756
lambda[   5] =  -0.40574175397675
lambda[   6] =  -0.34943564542613
lambda[   7] =  -0.33180610293180
lambda[   8] =  -0.31221047591008
lambda[   9] =  -0.28165510767209
lambda[  10] =  -0.21901310263098
lambda[  11] =  -0.02335353584996
lambda[  12] =   0.00702588737269
lambda[  13] =   0.02088933581300
lambda[  14] =   0.02339883424627
lambda[  15] =   0.02661821526524
lambda[  16] =   0.03154092827628
lambda[  17] =   0.03745885133641
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 4.495 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.500 ms

Total time for subspace rotation: 4.500 ms
rank = 0, Efermi =  -0.052316786845 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.340 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1695.225 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
rank = 0, D2D took 0.443 ms
rank = 0, Transfering density took 0.449 ms
Etot    =   -32.165881420498
Eband   =    -9.001776723728
E1      =    20.685673782916
E2      =    -8.104140557384
E3      =   -12.146378302057
Exc     =   -10.659875240565
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 4.350e-07, dEband = 9.513e-07
rank = 0, Calculating/Estimating energy took 3.716 ms, Etot = -32.165881420, dEtot = 4.350e-07, dEband = 9.513e-07
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0236764148078, which took 0.062 ms

iter_count = 108, r_2norm = 9.370e-07, tol*||rhs|| = 9.471e-07

Anderson update took 64.484 ms, out of which F'*F took 31.192 ms; b-Ax took 212.388 ms, out of which Lap took 188.705 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.484 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505019, int_b + int_rho = 1.091e-14, checking this took 0.130 ms
2-norm of RHS = 705.6052512428074, which took 0.076 ms

iter_count = 66, r_2norm = 7.002e-04, tol*||rhs|| = 7.056e-04

Anderson update took 39.165 ms, out of which F'*F took 18.637 ms; b-Ax took 126.794 ms, out of which Lap took 112.409 ms
Solving Poisson took 279.929 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.181432 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.170608 
Total time for convolution: 	 convolve: 5.166966 
Total time for convolution: 	 convolve: 5.184387 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.833 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.033 ms
---Transfer Veff_loc: D2D took 1.122 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.144 ms

This SCF took 27115.065 ms, scf error = 1.324e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.137459, lowerbound = -0.927417, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1641.770 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.981 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.118 ms
rank =  0, Distribute data + matrix mult took 3.105 ms
rank =  0, finding HY took 25.473 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.908 ms
Rank 0, Project_Hamiltonian used 32.511 ms
Total time for projection: 32.535 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.927391043049519
    last  calculated eigval = 0.037629537870395
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.92739104304952
lambda[   2] =  -0.67077790761453
lambda[   3] =  -0.54182647187649
lambda[   4] =  -0.46090944830074
lambda[   5] =  -0.40570987727128
lambda[   6] =  -0.34940276293957
lambda[   7] =  -0.33176968942879
lambda[   8] =  -0.31217572588151
lambda[   9] =  -0.28162464385972
lambda[  10] =  -0.21898551113351
lambda[  11] =  -0.02319519699811
lambda[  12] =   0.00708865012119
lambda[  13] =   0.02098353810975
lambda[  14] =   0.02348884579557
lambda[  15] =   0.02680445056423
lambda[  16] =   0.03169371550727
lambda[  17] =   0.03762953787040
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 4.746 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.753 ms

Total time for subspace rotation: 4.754 ms
rank = 0, Efermi =  -0.052158447994 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.230 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1681.619 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
rank = 0, D2D took 0.393 ms
rank = 0, Transfering density took 0.399 ms
Etot    =   -32.165882943647
Eband   =    -9.001146163292
E1      =    20.685346059995
E2      =    -8.103824514682
E3      =   -12.146432503209
Exc     =   -10.659917759680
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 1.692e-07, dEband = 7.006e-05
rank = 0, Calculating/Estimating energy took 2.074 ms, Etot = -32.165882944, dEtot = 1.692e-07, dEband = 7.006e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0197088248765, which took 0.077 ms

iter_count = 114, r_2norm = 4.811e-07, tol*||rhs|| = 7.884e-07

Anderson update took 67.944 ms, out of which F'*F took 32.868 ms; b-Ax took 224.763 ms, out of which Lap took 199.656 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 494.392 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505021, int_b + int_rho = 2.910e-14, checking this took 0.160 ms
2-norm of RHS = 705.6054762730134, which took 0.194 ms

iter_count = 126, r_2norm = 6.565e-04, tol*||rhs|| = 7.056e-04

Anderson update took 74.830 ms, out of which F'*F took 35.558 ms; b-Ax took 241.998 ms, out of which Lap took 213.949 ms
Solving Poisson took 529.671 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.170021 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.194284 
Total time for convolution: 	 convolve: 5.202089 
Total time for convolution: 	 convolve: 5.173697 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.130 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.126 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 0.348 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.366 ms

This SCF took 27412.285 ms, scf error = 1.263e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.137630, lowerbound = -0.927391, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1652.362 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.970 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.134 ms
rank =  0, Distribute data + matrix mult took 3.110 ms
rank =  0, finding HY took 26.237 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.917 ms
Rank 0, Project_Hamiltonian used 33.287 ms
Total time for projection: 33.305 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.927238689849584
    last  calculated eigval = 0.038872160761355
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.92723868984958
lambda[   2] =  -0.67061085854809
lambda[   3] =  -0.54166177112676
lambda[   4] =  -0.46075558901537
lambda[   5] =  -0.40554578531896
lambda[   6] =  -0.34924149937229
lambda[   7] =  -0.33160237119137
lambda[   8] =  -0.31200635785889
lambda[   9] =  -0.28146860854343
lambda[  10] =  -0.21883162362535
lambda[  11] =  -0.02251244258048
lambda[  12] =   0.00727904274832
lambda[  13] =   0.02135966810821
lambda[  14] =   0.02402075918356
lambda[  15] =   0.02812185946447
lambda[  16] =   0.03266444137038
lambda[  17] =   0.03887216076135
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 4.735 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.740 ms

Total time for subspace rotation: 4.741 ms
rank = 0, Efermi =  -0.051475693560 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.150 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1692.853 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
rank = 0, D2D took 0.487 ms
rank = 0, Transfering density took 0.501 ms
Etot    =   -32.165899521061
Eband   =    -8.997926309464
E1      =    20.683745033185
E2      =    -8.102135545254
E3      =   -12.146670662898
Exc     =   -10.660102354373
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 1.842e-06, dEband = 3.578e-04
rank = 0, Calculating/Estimating energy took 3.633 ms, Etot = -32.165899521, dEtot = 1.842e-06, dEband = 3.578e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0185999814578, which took 0.060 ms

iter_count = 114, r_2norm = 4.570e-07, tol*||rhs|| = 7.440e-07

Anderson update took 67.311 ms, out of which F'*F took 32.861 ms; b-Ax took 224.194 ms, out of which Lap took 199.370 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 493.129 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505019, int_b + int_rho = 1.819e-14, checking this took 0.169 ms
2-norm of RHS = 705.6049999647122, which took 0.149 ms

iter_count = 96, r_2norm = 6.291e-04, tol*||rhs|| = 7.056e-04

Anderson update took 56.645 ms, out of which F'*F took 27.120 ms; b-Ax took 184.402 ms, out of which Lap took 163.674 ms
Solving Poisson took 406.531 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.163087 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.185776 
Total time for convolution: 	 convolve: 5.172165 
Total time for convolution: 	 convolve: 5.205579 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.729 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.238 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.145 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.158 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.217 ms
---Transfer Veff_loc: D2D took 0.308 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.327 ms

This SCF took 27322.097 ms, scf error = 1.136e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.138872, lowerbound = -0.927239, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1638.681 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.062 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.112 ms
rank =  0, Distribute data + matrix mult took 3.180 ms
rank =  0, finding HY took 25.794 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.863 ms
Rank 0, Project_Hamiltonian used 32.863 ms
Total time for projection: 32.892 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.927167782051155
    last  calculated eigval = 0.039229720508363
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.92716778205116
lambda[   2] =  -0.67053134452779
lambda[   3] =  -0.54158407220818
lambda[   4] =  -0.46068394990336
lambda[   5] =  -0.40546953729289
lambda[   6] =  -0.34916642042245
lambda[   7] =  -0.33152176993142
lambda[   8] =  -0.31192624460273
lambda[   9] =  -0.28139653581990
lambda[  10] =  -0.21876181422119
lambda[  11] =  -0.02233015662979
lambda[  12] =   0.00737499100568
lambda[  13] =   0.02146346032346
lambda[  14] =   0.02411138895289
lambda[  15] =   0.02870677712722
lambda[  16] =   0.03296244487311
lambda[  17] =   0.03922972050836
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 5.021 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 5.026 ms

Total time for subspace rotation: 5.027 ms
rank = 0, Efermi =  -0.051293407633 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.075 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1678.988 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.292 ms
rank = 0, D2D took 1.389 ms
rank = 0, Transfering density took 1.395 ms
Etot    =   -32.165902260091
Eband   =    -8.996418942521
E1      =    20.682973994197
E2      =    -8.101367633977
E3      =   -12.146803738293
Exc     =   -10.660206585475
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 3.043e-07, dEband = 1.675e-04
rank = 0, Calculating/Estimating energy took 0.979 ms, Etot = -32.165902260, dEtot = 3.043e-07, dEband = 1.675e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0227911290947, which took 0.056 ms

iter_count = 108, r_2norm = 7.494e-07, tol*||rhs|| = 9.116e-07

Anderson update took 63.828 ms, out of which F'*F took 31.157 ms; b-Ax took 212.270 ms, out of which Lap took 188.832 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.756 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505013, int_b + int_rho = -4.729e-14, checking this took 0.140 ms
2-norm of RHS = 705.6053486628017, which took 0.143 ms

iter_count = 72, r_2norm = 6.958e-04, tol*||rhs|| = 7.056e-04

Anderson update took 42.378 ms, out of which F'*F took 20.365 ms; b-Ax took 138.394 ms, out of which Lap took 122.402 ms
Solving Poisson took 304.648 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.195334 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.171671 
Total time for convolution: 	 convolve: 5.183201 
Total time for convolution: 	 convolve: 5.198563 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.427 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 0.345 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.362 ms

This SCF took 27172.729 ms, scf error = 1.087e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.139230, lowerbound = -0.927168, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1653.605 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.977 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.144 ms
rank =  0, Distribute data + matrix mult took 3.126 ms
rank =  0, finding HY took 26.240 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.958 ms
Rank 0, Project_Hamiltonian used 33.346 ms
Total time for projection: 33.371 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.106 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.927132562520899
    last  calculated eigval = 0.039345350408762
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.92713256252090
lambda[   2] =  -0.67049076109091
lambda[   3] =  -0.54154595286813
lambda[   4] =  -0.46064704450624
lambda[   5] =  -0.40543040380670
lambda[   6] =  -0.34912858260178
lambda[   7] =  -0.33148463441275
lambda[   8] =  -0.31188927810109
lambda[   9] =  -0.28136051063847
lambda[  10] =  -0.21872880044461
lambda[  11] =  -0.02231247754397
lambda[  12] =   0.00745328707438
lambda[  13] =   0.02147552248636
lambda[  14] =   0.02412936556829
lambda[  15] =   0.02895888742603
lambda[  16] =   0.03304182218283
lambda[  17] =   0.03934535040876
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 4.665 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.671 ms

Total time for subspace rotation: 4.673 ms
rank = 0, Efermi =  -0.051275728505 calculate fermi energy took 0.639 ms
rank = 0, --- Calculate rho: sum over local bands took 2.087 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.032 ms
rank = 0, Calculating density took 1695.069 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.318 ms
rank = 0, D2D took 0.426 ms
rank = 0, Transfering density took 0.431 ms
Etot    =   -32.165902844736
Eband   =    -8.995677062542
E1      =    20.682582440199
E2      =    -8.101002548121
E3      =   -12.146879163358
Exc     =   -10.660267835312
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 6.496e-08, dEband = 8.243e-05
rank = 0, Calculating/Estimating energy took 1.260 ms, Etot = -32.165902845, dEtot = 6.496e-08, dEband = 8.243e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0221859643743, which took 0.115 ms

iter_count = 108, r_2norm = 7.687e-07, tol*||rhs|| = 8.874e-07

Anderson update took 63.826 ms, out of which F'*F took 31.013 ms; b-Ax took 211.967 ms, out of which Lap took 188.215 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.394 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505016, int_b + int_rho = -2.183e-14, checking this took 0.117 ms
2-norm of RHS = 705.6046653490268, which took 0.102 ms

iter_count = 90, r_2norm = 6.348e-04, tol*||rhs|| = 7.056e-04

Anderson update took 54.245 ms, out of which F'*F took 25.564 ms; b-Ax took 184.683 ms, out of which Lap took 165.436 ms
Solving Poisson took 393.150 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.165185 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.181253 
Total time for convolution: 	 convolve: 5.170805 
Total time for convolution: 	 convolve: 5.180744 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.330 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.348 ms

This SCF took 27221.135 ms, scf error = 1.048e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.139345, lowerbound = -0.927133, upperbound = 267.577704

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1641.177 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.972 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.149 ms
rank =  0, Distribute data + matrix mult took 3.127 ms
rank =  0, finding HY took 25.627 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.785 ms
Rank 0, Project_Hamiltonian used 32.573 ms
Total time for projection: 32.592 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.105 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.132 ms
    first calculated eigval = -0.927055738041104
    last  calculated eigval = 0.039165505256881
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.92705573804110
lambda[   2] =  -0.67042890674032
lambda[   3] =  -0.54148779041484
lambda[   4] =  -0.46057937185009
lambda[   5] =  -0.40537040480254
lambda[   6] =  -0.34906366574641
lambda[   7] =  -0.33143426251937
lambda[   8] =  -0.31183651024354
lambda[   9] =  -0.28129482788631
lambda[  10] =  -0.21866141914415
lambda[  11] =  -0.02261355071070
lambda[  12] =   0.00729613634634
lambda[  13] =   0.02125911226193
lambda[  14] =   0.02392352050357
lambda[  15] =   0.02908635589616
lambda[  16] =   0.03279073964692
lambda[  17] =   0.03916550525688
==subpsace eigenproblem: bcast eigvals took 0.037 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 4.755 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.764 ms

Total time for subspace rotation: 4.764 ms
rank = 0, Efermi =  -0.051576801725 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.191 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1681.525 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.271 ms
rank = 0, D2D took 0.464 ms
rank = 0, Transfering density took 0.472 ms
Etot    =   -32.165905356309
Eband   =    -8.994425795344
E1      =    20.681842967278
E2      =    -8.100444283587
E3      =   -12.147069902084
Exc     =   -10.660414615353
Esc     =   -53.440422097813
Entropy =    -0.000000000748
dE = 2.791e-07, dEband = 1.390e-04
rank = 0, Calculating/Estimating energy took 2.331 ms, Etot = -32.165905356, dEtot = 2.791e-07, dEband = 1.390e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0232005048111, which took 0.111 ms

iter_count = 102, r_2norm = 8.079e-07, tol*||rhs|| = 9.280e-07

Anderson update took 60.827 ms, out of which F'*F took 29.305 ms; b-Ax took 200.289 ms, out of which Lap took 177.951 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 442.921 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002505018, int_rho =  20.00000002505019, int_b + int_rho = 1.819e-14, checking this took 0.140 ms
2-norm of RHS = 705.6073840164838, which took 0.108 ms

iter_count = 138, r_2norm = 6.524e-04, tol*||rhs|| = 7.056e-04

Anderson update took 81.589 ms, out of which F'*F took 39.243 ms; b-Ax took 265.490 ms, out of which Lap took 234.849 ms
Solving Poisson took 580.958 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.203713 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.168476 
Total time for convolution: 	 convolve: 5.172515 
Total time for convolution: 	 convolve: 5.186651 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.582 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.315 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.332 ms

This SCF took 27415.756 ms, scf error = 8.340e-05
The last 17 occupations of kpoints #1 are (Nelectron = 20):
lambda[   1] =  -0.92705573804110, occ[   1] =   2.00000000000000
lambda[   2] =  -0.67042890674032, occ[   2] =   2.00000000000000
lambda[   3] =  -0.54148779041484, occ[   3] =   2.00000000000000
lambda[   4] =  -0.46057937185009, occ[   4] =   2.00000000000000
lambda[   5] =  -0.40537040480254, occ[   5] =   2.00000000000000
lambda[   6] =  -0.34906366574641, occ[   6] =   2.00000000000000
lambda[   7] =  -0.33143426251937, occ[   7] =   2.00000000000000
lambda[   8] =  -0.31183651024354, occ[   8] =   2.00000000000000
lambda[   9] =  -0.28129482788631, occ[   9] =   2.00000000000000
lambda[  10] =  -0.21866141914415, occ[  10] =   2.00000000000000
lambda[  11] =  -0.02261355071070, occ[  11] =   0.00000002505015
lambda[  12] =   0.00729613634634, occ[  12] =   0.00000000000000
lambda[  13] =   0.02125911226193, occ[  13] =   0.00000000000000
lambda[  14] =   0.02392352050357, occ[  14] =   0.00000000000000
lambda[  15] =   0.02908635589616, occ[  15] =   0.00000000000000
lambda[  16] =   0.03279073964692, occ[  16] =   0.00000000000000
lambda[  17] =   0.03916550525688, occ[  17] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 15 (90%) = 0.000000000000000.
Occupation of state 17 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.472 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.446 ms, time for Allreduce/Reduce: 9.098 ms 
Time for calculating local force components: 17.917 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00008183995201   1.05226675801989   0.00000090304904
  0.05924661749302  -0.04501429975757   0.00000002067596
 -0.04283980165831  -0.02371690150745   0.00000001957185
  0.00165364999158   0.02911836238830  -0.03979769152856
  0.00165365504704   0.02911837969359   0.03979772624412
 -0.00273732833966  -0.02914990522815  -0.03956061093998
 -0.00273732442931  -0.02914990602691   0.03956065752892
  0.00161817434261   0.01692286526626   0.00000052343285
 -0.13297320917516  -0.09307292340960   0.00000052500136
force_loc = 
 -0.00468904715361  -1.02377674685164  -0.00000174404534
 -0.06173511764647   0.04599241556127  -0.00000002526256
  0.04376733538554   0.02428704191426   0.00000027373790
 -0.00131595858090  -0.02982388118151   0.04081374427307
 -0.00131604361590  -0.02982356243452  -0.04081397622177
  0.00215451456821   0.02950477343222   0.04080356999240
  0.00215442760884   0.02950484788953  -0.04080344204599
 -0.00253095211716  -0.01526681324949   0.00000040388062
  0.13499532959503   0.09056866384094  -0.00000024542645
Time for calculating nonlocal force components: 28.034 ms
[32mforces_xc: 
[0m[32m -0.00133745921855  -0.03266043396125  -0.00000008086276
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00052858938817  -0.00126260643631   0.00000003623841
[0m[32m  0.00627043775668   0.00552782698165  -0.00000002533575
[0mTime for calculating XC forces components: 25.199 ms
 Cartesian force = 
 -0.00608041846747  -0.00418086223117  -0.00000098429877
 -0.00246057229675   0.00096767636553  -0.00000006702630
  0.00095546158392   0.00055970096865   0.00000023087005
  0.00036561926739  -0.00071595823138   0.00101599030481
  0.00036553928784  -0.00071562217910  -0.00101631241735
 -0.00055488591475   0.00034442876590   0.00124289661271
 -0.00055496896377   0.00034450242445  -0.00124284695677
 -0.00035626052967   0.00038300614229   0.00000090111217
  0.00832048603325   0.00301312797482   0.00000019179946
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.358 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.352 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.983 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Time for printing density: 386.157 ms
The program took 613.074 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:26
Job ID:        2266575
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:05:24,vmem=8444K,walltime=00:10:27,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-17-1
---------------------------------------
