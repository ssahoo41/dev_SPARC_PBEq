---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:54
Job ID:    2267005
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:29:00
Job ID:    2267005
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.061 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 15.262 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 9.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 3.937 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 42.864 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.955 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.114 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   11.348468	
   10.000000	   13.819966	   11.163216	
   10.000000	    6.180034	   11.163216	
   11.684899	   12.325675	    8.651532	
    8.315101	   12.325675	    8.651532	
    8.315101	    7.674325	    8.651532	
   11.684899	    7.674325	    8.651532	
   10.000000	   12.209077	    9.870610	
   10.000000	    7.790923	    9.870610	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.192 ms
Set up communicators.

--set up spincomm took 2.225 ms

--set up kptcomm took 0.338 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {2, 2, 3}
gridsizes = [100, 100, 100], Nstates = 17, dmcomm dims = [2, 2, 3]

--set up dmcomm took 0.011 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 1, ScaLAPACK topology Dims = (1, 1)
nproc = 12, size_blacscomm = 1 = dims[0] * dims[1] = (1, 1)
Nd_blacscomm 85000, Nstates 17 
rank =  0, my blacs rank = 0, BLCYC size (85000, 17), actual size (85000, 17)
rank = 0, mb = nb = 17, mbQ = nbQ = 64
rank = 0, nr_Hp = 17, nc_Hp = 17
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.054 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 1
# of bands per bandcomm          : 17
npdomain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.318 ms

Calculate_SplineDerivRadFun took 0.214 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.261 ms.
time spent on vectorized spline interp: 3.216 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.032 ms.
time spent on vectorized spline interp: 1.394 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.343 ms.
time spent on vectorized spline interp: 1.764 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.549 ms.

Calculating rb for all atom types took 15.568 ms
----------------------
Estimated memory usage
Total: 663.08 MB
orbitals             : 389.10 MB
global sized vectors : 213.62 MB
subspace matrices : 81.28 kB
others : 60.28 MB
----------------------------------------------
Estimated memory usage per processor: 55.26 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.065 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -20.0000000224834, sum_int_rho = 19.4043304363606
PosCharge = 20.000000022483, NegCharge = -19.404330436361, scal_fac = 1.030697765536
After scaling, int_rho = 20.0000000224834, PosCharge + NegCharge - NetCharge = 3.553e-15
--Calculate Vref took 0.396 ms
--Calculate rho_guess took 2.105 ms

 integral of b = -20.0000000224834,
 int{b} + Nelectron + NetCharge = -2.248e-08,
 Esc = -53.4403799098621,
 MPI_Reduce took 9.524 ms

Calculating b & b_ref took 17.591 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.011 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.022 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.016 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 32.754 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248341, int_b + int_rho = 4.729e-14, checking this took 0.107 ms
2-norm of RHS = 714.7706343255736, which took 0.460 ms

iter_count = 414, r_2norm = 7.044e-04, tol*||rhs|| = 7.148e-04

Anderson update took 261.634 ms, out of which F'*F took 116.065 ms; b-Ax took 826.188 ms, out of which Lap took 732.033 ms
Solving Poisson took 1816.272 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.391 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
Total time for convolution: 	 convolve: 5.127858 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
Total time for convolution: 	 convolve: 5.126840 
Total time for convolution: 	 convolve: 5.130585 
Total time for convolution: 	 convolve: 5.172175 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 3.178 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.299 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
rank = 0, XC calculation took 24378.425 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.590 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 1.701 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.132 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.853 ms
    Lanczos iter 53, eigmin  = -0.979755727, eigmax = 264.926084479, err_eigmin = 1.713e-03, err_eigmax = 9.779e-03
rank =   0, Lanczos took 133.399 ms, eigmin = -0.979755727166, eigmax = 267.575345323307

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.247795, lowerbound = -1.079756, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1671.962 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.106 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 3.130 ms
rank =  0, finding HY took 26.119 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.833 ms
Rank 0, Project_Hamiltonian used 33.111 ms
Total time for projection: 33.904 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.715 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.788 ms
    first calculated eigval = 2.758919983780535
    last  calculated eigval = 3.271761574466371
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =   2.75891998378054
lambda[   2] =   2.83808824887580
lambda[   3] =   2.86318487440090
lambda[   4] =   2.90821280085037
lambda[   5] =   2.92946643494047
lambda[   6] =   2.94980213097508
lambda[   7] =   2.96647670143657
lambda[   8] =   2.97610276764749
lambda[   9] =   3.02613630535321
lambda[  10] =   3.03568902081527
lambda[  11] =   3.07506774444641
lambda[  12] =   3.09656980798083
lambda[  13] =   3.11628915004418
lambda[  14] =   3.13213720585015
lambda[  15] =   3.16090463969294
lambda[  16] =   3.23225145480915
lambda[  17] =   3.27176157446637
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.810 ms
rank =  0, subspace rotation using ScaLAPACK took 4.965 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.972 ms

Total time for subspace rotation: 4.973 ms
rank = 0, Efermi =   3.055378556721 calculate fermi energy took 0.049 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.371762, lowerbound = -1.079756, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1655.667 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.021 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.944 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 2.986 ms
rank =  0, finding HY took 26.003 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 3.993 ms
Rank 0, Project_Hamiltonian used 33.024 ms
Total time for projection: 33.028 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.759785679669471
    last  calculated eigval = 0.469717128132898
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.75978567966947
lambda[   2] =  -0.36369265876828
lambda[   3] =  -0.21847530686489
lambda[   4] =  -0.15990756181729
lambda[   5] =  -0.10236242774663
lambda[   6] =   0.03332846385518
lambda[   7] =   0.14896293950953
lambda[   8] =   0.20767636468880
lambda[   9] =   0.26035077219035
lambda[  10] =   0.31965506100781
lambda[  11] =   0.33238856193201
lambda[  12] =   0.35681686407810
lambda[  13] =   0.36580094422113
lambda[  14] =   0.38257523548690
lambda[  15] =   0.41637134366794
lambda[  16] =   0.42873311048669
lambda[  17] =   0.46971712813290
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 4.789 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.796 ms

Total time for subspace rotation: 4.797 ms
rank = 0, Efermi =   0.326021811603 calculate fermi energy took 0.027 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.569717, lowerbound = -1.079756, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1653.123 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.711 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.019 ms
rank =  0, Distribute data + matrix mult took 4.184 ms
rank =  0, finding HY took 26.093 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 4.175 ms
Rank 0, Project_Hamiltonian used 34.482 ms
Total time for projection: 34.505 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.018 ms
rank = 0, Solve_Generalized_EigenProblem used 0.109 ms
    first calculated eigval = -0.989683695723759
    last  calculated eigval = 0.160505861811148
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.98968369572376
lambda[   2] =  -0.73878041541361
lambda[   3] =  -0.66801246334487
lambda[   4] =  -0.50033552445492
lambda[   5] =  -0.49162212407388
lambda[   6] =  -0.48135444841224
lambda[   7] =  -0.43062154654943
lambda[   8] =  -0.39882847771450
lambda[   9] =  -0.29803810898255
lambda[  10] =  -0.19003460998803
lambda[  11] =   0.04441916098535
lambda[  12] =   0.07143342068062
lambda[  13] =   0.09622512853278
lambda[  14] =   0.10214315060208
lambda[  15] =   0.12670478100626
lambda[  16] =   0.14955977073645
lambda[  17] =   0.16050586181115
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.125 ms
rank =  0, subspace rotation using ScaLAPACK took 5.012 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 5.018 ms

Total time for subspace rotation: 5.019 ms
rank = 0, Efermi =   0.015358224759 calculate fermi energy took 0.040 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.260506, lowerbound = -1.079756, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1651.954 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.965 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.068 ms
rank =  0, Distribute data + matrix mult took 3.038 ms
rank =  0, finding HY took 26.069 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 4.000 ms
Rank 0, Project_Hamiltonian used 33.131 ms
Total time for projection: 33.136 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.018 ms
rank = 0, Solve_Generalized_EigenProblem used 0.105 ms
    first calculated eigval = -0.990440376868877
    last  calculated eigval = 0.090191440810043
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.99044037686888
lambda[   2] =  -0.74245573206134
lambda[   3] =  -0.67253336107190
lambda[   4] =  -0.50618241906482
lambda[   5] =  -0.49991338736334
lambda[   6] =  -0.49635299169579
lambda[   7] =  -0.44285608217027
lambda[   8] =  -0.41988252513886
lambda[   9] =  -0.34222060200006
lambda[  10] =  -0.26692526969903
lambda[  11] =   0.00546903322007
lambda[  12] =   0.02859939352812
lambda[  13] =   0.03854141200361
lambda[  14] =   0.06180430097396
lambda[  15] =   0.07587437489552
lambda[  16] =   0.08674551660811
lambda[  17] =   0.09019144081004
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.115 ms
rank =  0, subspace rotation using ScaLAPACK took 4.779 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.786 ms

Total time for subspace rotation: 4.786 ms
rank = 0, Efermi =  -0.023591902902 calculate fermi energy took 0.024 ms
rank = 0, --- Calculate rho: sum over local bands took 2.001 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 6926.893 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
rank = 0, D2D took 0.446 ms
rank = 0, Transfering density took 0.453 ms
Etot    =   -32.219725090286
Eband   =   -10.759525494146
E1      =    22.122475031336
E2      =    -8.490447631812
E3      =   -11.561812492750
Exc     =   -10.194554841503
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 3.580e+00, dEband = 1.196e+00
rank = 0, Calculating/Estimating energy took 3.205 ms, Etot = -32.219725090, dEtot = 3.580e+00, dEband = 1.196e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 57.9598757086912, which took 0.050 ms

iter_count = 90, r_2norm = 2.268e-03, tol*||rhs|| = 2.318e-03

Anderson update took 54.142 ms, out of which F'*F took 25.268 ms; b-Ax took 173.054 ms, out of which Lap took 153.056 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 387.498 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248328, int_b + int_rho = -8.731e-14, checking this took 0.124 ms
2-norm of RHS = 711.3625975836359, which took 0.215 ms

iter_count = 282, r_2norm = 5.771e-04, tol*||rhs|| = 7.114e-04

Anderson update took 167.715 ms, out of which F'*F took 78.254 ms; b-Ax took 537.467 ms, out of which Lap took 476.579 ms
Solving Poisson took 1207.789 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.917 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.113588 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 63.251 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.383 ms
Total time for convolution: 	 convolve: 5.128728 
Total time for convolution: 	 convolve: 5.142684 
Total time for convolution: 	 convolve: 5.205842 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 15.116 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.314 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.331 ms

This SCF took 33165.009 ms, scf error = 1.760e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.190191, lowerbound = -0.990440, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1662.707 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.878 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 2.900 ms
rank =  0, finding HY took 26.130 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.942 ms
Rank 0, Project_Hamiltonian used 32.995 ms
Total time for projection: 33.008 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.985205682528309
    last  calculated eigval = 0.070949251277450
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.98520568252831
lambda[   2] =  -0.71736156428046
lambda[   3] =  -0.64437653518267
lambda[   4] =  -0.48796472082174
lambda[   5] =  -0.47860636504616
lambda[   6] =  -0.47512800760789
lambda[   7] =  -0.41628235491023
lambda[   8] =  -0.39628228920231
lambda[   9] =  -0.32824778155081
lambda[  10] =  -0.25923613830490
lambda[  11] =  -0.01790904685202
lambda[  12] =   0.01501847665335
lambda[  13] =   0.01588974038216
lambda[  14] =   0.03471143236032
lambda[  15] =   0.04884205369531
lambda[  16] =   0.05552116144361
lambda[  17] =   0.07094925127745
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 4.955 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.971 ms

Total time for subspace rotation: 4.971 ms
rank = 0, Efermi =  -0.046969983120 calculate fermi energy took 0.071 ms
rank = 0, --- Calculate rho: sum over local bands took 2.132 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 1703.146 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
rank = 0, D2D took 0.412 ms
rank = 0, Transfering density took 0.419 ms
Etot    =   -32.185078211740
Eband   =   -10.377382879274
E1      =    21.749401157453
E2      =    -8.492632308733
E3      =   -11.688890288983
Exc     =   -10.298239177101
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 3.850e-03, dEband = 4.246e-02
rank = 0, Calculating/Estimating energy took 2.047 ms, Etot = -32.185078212, dEtot = 3.850e-03, dEband = 4.246e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 12.6460450662844, which took 1.224 ms

iter_count = 102, r_2norm = 4.253e-04, tol*||rhs|| = 5.058e-04

Anderson update took 59.763 ms, out of which F'*F took 28.869 ms; b-Ax took 200.802 ms, out of which Lap took 177.555 ms
rank = 0, Mixing (+ precond) took 456.527 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248340, int_b + int_rho = 3.274e-14, checking this took 0.120 ms
2-norm of RHS = 705.2822373995772, which took 0.147 ms

iter_count = 294, r_2norm = 6.982e-04, tol*||rhs|| = 7.053e-04

Anderson update took 176.019 ms, out of which F'*F took 83.450 ms; b-Ax took 574.166 ms, out of which Lap took 507.829 ms
Solving Poisson took 1266.653 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.514 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.206900 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.017 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.373 ms
Total time for convolution: 	 convolve: 5.214082 
Total time for convolution: 	 convolve: 5.263158 
Total time for convolution: 	 convolve: 5.222407 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.580 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.551 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.143 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.316 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.333 ms

This SCF took 28329.114 ms, scf error = 1.216e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.170949, lowerbound = -0.985206, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1660.371 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.967 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 3.005 ms
rank =  0, finding HY took 26.256 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.841 ms
Rank 0, Project_Hamiltonian used 33.127 ms
Total time for projection: 33.150 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -0.966553574572064
    last  calculated eigval = 0.064283611835735
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.96655357457206
lambda[   2] =  -0.67040245721715
lambda[   3] =  -0.58867742774600
lambda[   4] =  -0.44827291781971
lambda[   5] =  -0.43610783572489
lambda[   6] =  -0.43304664670934
lambda[   7] =  -0.36438665270748
lambda[   8] =  -0.34808074374758
lambda[   9] =  -0.29196853433778
lambda[  10] =  -0.23013766552411
lambda[  11] =  -0.02784894861568
lambda[  12] =   0.01072018056767
lambda[  13] =   0.01612675722437
lambda[  14] =   0.02216727700305
lambda[  15] =   0.03378144195048
lambda[  16] =   0.04123151767241
lambda[  17] =   0.06428361183573
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 4.352 ms
rank =  0, Distributing orbital back into band + domain format took 0.006 ms
rank = 0, Subspace_Rotation used 4.367 ms

Total time for subspace rotation: 4.368 ms
rank = 0, Efermi =  -0.056909884869 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 1.996 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 1701.672 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.262 ms
rank = 0, D2D took 0.424 ms
rank = 0, Transfering density took 0.432 ms
Etot    =   -32.150129232871
Eband   =    -9.555268912838
E1      =    21.000037910189
E2      =    -8.393876281075
E3      =   -12.008185733173
Exc     =   -10.556580333935
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 3.883e-03, dEband = 9.135e-02
rank = 0, Calculating/Estimating energy took 1.315 ms, Etot = -32.150129233, dEtot = 3.883e-03, dEband = 9.135e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 5.4719842170144, which took 0.068 ms

iter_count = 102, r_2norm = 1.601e-04, tol*||rhs|| = 2.189e-04

Anderson update took 60.327 ms, out of which F'*F took 28.485 ms; b-Ax took 196.833 ms, out of which Lap took 173.798 ms
rank = 0, Mixing (+ precond) took 448.378 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248341, int_b + int_rho = 4.002e-14, checking this took 0.114 ms
2-norm of RHS = 704.9234924536647, which took 0.135 ms

iter_count = 258, r_2norm = 6.346e-04, tol*||rhs|| = 7.049e-04

Anderson update took 152.564 ms, out of which F'*F took 72.927 ms; b-Ax took 494.162 ms, out of which Lap took 439.057 ms
Solving Poisson took 1083.636 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.169124 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.259 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.193744 
Total time for convolution: 	 convolve: 5.181145 
Total time for convolution: 	 convolve: 5.183380 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.302 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.167 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.314 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.332 ms

This SCF took 27955.514 ms, scf error = 3.106e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.164284, lowerbound = -0.966554, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1660.576 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.939 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.071 ms
rank =  0, Distribute data + matrix mult took 3.016 ms
rank =  0, finding HY took 26.333 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.894 ms
Rank 0, Project_Hamiltonian used 33.270 ms
Total time for projection: 33.289 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.779 ms
    first calculated eigval = -0.958481676344569
    last  calculated eigval = 0.060480457615767
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.95848167634457
lambda[   2] =  -0.66367208109060
lambda[   3] =  -0.58070493290119
lambda[   4] =  -0.44085241012679
lambda[   5] =  -0.42867620445994
lambda[   6] =  -0.42547620489570
lambda[   7] =  -0.35681765529958
lambda[   8] =  -0.34057015639681
lambda[   9] =  -0.28364781391919
lambda[  10] =  -0.22085977452369
lambda[  11] =  -0.03168722250524
lambda[  12] =   0.00867711518948
lambda[  13] =   0.01240737549196
lambda[  14] =   0.01718761951103
lambda[  15] =   0.02451400287005
lambda[  16] =   0.03449876964549
lambda[  17] =   0.06048045761577
==subpsace eigenproblem: bcast eigvals took 0.556 ms
Total time for solving subspace eigenvalue problem: 1.347 ms
rank =  0, subspace rotation using ScaLAPACK took 5.066 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 5.074 ms

Total time for subspace rotation: 5.081 ms
rank = 0, Efermi =  -0.060748158680 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.098 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1702.530 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.284 ms
rank = 0, D2D took 0.518 ms
rank = 0, Transfering density took 0.526 ms
Etot    =   -32.147715210332
Eband   =    -9.399517820629
E1      =    20.894317047201
E2      =    -8.330997669138
E3      =   -12.073389415743
Exc     =   -10.606521611250
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 2.682e-04, dEband = 1.731e-02
rank = 0, Calculating/Estimating energy took 1.160 ms, Etot = -32.147715210, dEtot = 2.682e-04, dEband = 1.731e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.7334396745513, which took 0.092 ms

iter_count = 108, r_2norm = 5.065e-05, tol*||rhs|| = 6.934e-05

Anderson update took 63.912 ms, out of which F'*F took 30.138 ms; b-Ax took 208.815 ms, out of which Lap took 184.464 ms
rank = 0, Mixing (+ precond) took 473.062 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248343, int_b + int_rho = 6.548e-14, checking this took 0.121 ms
2-norm of RHS = 705.3115984598213, which took 0.151 ms

iter_count = 252, r_2norm = 6.273e-04, tol*||rhs|| = 7.053e-04

Anderson update took 149.818 ms, out of which F'*F took 70.810 ms; b-Ax took 479.253 ms, out of which Lap took 425.298 ms
Solving Poisson took 1055.147 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.173523 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.734 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.177974 
Total time for convolution: 	 convolve: 5.200468 
Total time for convolution: 	 convolve: 5.169497 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.773 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.167 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.321 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.339 ms

This SCF took 29028.921 ms, scf error = 1.278e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.160480, lowerbound = -0.958482, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1637.205 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.925 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 2.945 ms
rank =  0, finding HY took 25.784 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 3.981 ms
Rank 0, Project_Hamiltonian used 33.409 ms
Total time for projection: 33.432 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.113 ms
    first calculated eigval = -0.954134246170833
    last  calculated eigval = 0.058295329218064
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.95413424617083
lambda[   2] =  -0.65935050779711
lambda[   3] =  -0.57608598971922
lambda[   4] =  -0.43665908365710
lambda[   5] =  -0.42413818670754
lambda[   6] =  -0.42075271527067
lambda[   7] =  -0.35184099555268
lambda[   8] =  -0.33576044132880
lambda[   9] =  -0.27970940560957
lambda[  10] =  -0.21644622008662
lambda[  11] =  -0.03306719292843
lambda[  12] =   0.00809287972454
lambda[  13] =   0.01072925691581
lambda[  14] =   0.01480440587192
lambda[  15] =   0.01919727894541
lambda[  16] =   0.03030263894435
lambda[  17] =   0.05829532921806
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.129 ms
rank =  0, subspace rotation using ScaLAPACK took 4.946 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.952 ms

Total time for subspace rotation: 4.953 ms
rank = 0, Efermi =  -0.062128129100 calculate fermi energy took 1.480 ms
rank = 0, --- Calculate rho: sum over local bands took 2.037 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1679.331 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
rank = 0, D2D took 0.502 ms
rank = 0, Transfering density took 0.512 ms
Etot    =   -32.147040859294
Eband   =    -9.309755584544
E1      =    20.851290927602
E2      =    -8.276334655989
E3      =   -12.104487594206
Exc     =   -10.629018542012
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 7.493e-05, dEband = 9.974e-03
rank = 0, Calculating/Estimating energy took 1.192 ms, Etot = -32.147040859, dEtot = 7.493e-05, dEband = 9.974e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7238423305760, which took 0.077 ms

iter_count = 108, r_2norm = 2.633e-05, tol*||rhs|| = 2.895e-05

Anderson update took 63.843 ms, out of which F'*F took 30.237 ms; b-Ax took 209.286 ms, out of which Lap took 184.887 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 472.740 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248330, int_b + int_rho = -6.912e-14, checking this took 0.136 ms
2-norm of RHS = 705.5868231446296, which took 0.158 ms

iter_count = 228, r_2norm = 6.449e-04, tol*||rhs|| = 7.056e-04

Anderson update took 135.680 ms, out of which F'*F took 64.195 ms; b-Ax took 433.101 ms, out of which Lap took 385.175 ms
Solving Poisson took 961.244 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.172565 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.251 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.374 ms
Total time for convolution: 	 convolve: 5.160125 
Total time for convolution: 	 convolve: 5.186150 
Total time for convolution: 	 convolve: 5.174421 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.125 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.312 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.328 ms

This SCF took 27806.509 ms, scf error = 4.620e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.158295, lowerbound = -0.954134, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1664.374 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.015 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.326 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.018 ms
rank =  0, Distribute data + matrix mult took 3.351 ms
rank =  0, finding HY took 26.174 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.824 ms
Rank 0, Project_Hamiltonian used 33.384 ms
Total time for projection: 33.394 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.952545314888405
    last  calculated eigval = 0.057081506003987
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.95254531488840
lambda[   2] =  -0.65708895331353
lambda[   3] =  -0.57401812196722
lambda[   4] =  -0.43474926393605
lambda[   5] =  -0.42213843331813
lambda[   6] =  -0.41873993226026
lambda[   7] =  -0.34960455128520
lambda[   8] =  -0.33363353421183
lambda[   9] =  -0.27830296571570
lambda[  10] =  -0.21525655463820
lambda[  11] =  -0.03328692529927
lambda[  12] =   0.00817979850560
lambda[  13] =   0.00991845701873
lambda[  14] =   0.01387297534948
lambda[  15] =   0.01661171842081
lambda[  16] =   0.02785729527077
lambda[  17] =   0.05708150600399
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 5.122 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 5.127 ms

Total time for subspace rotation: 5.128 ms
rank = 0, Efermi =  -0.062347861498 calculate fermi energy took 0.085 ms
rank = 0, --- Calculate rho: sum over local bands took 2.180 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 1705.828 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.283 ms
rank = 0, D2D took 0.526 ms
rank = 0, Transfering density took 0.530 ms
Etot    =   -32.146923052060
Eband   =    -9.272155251817
E1      =    20.835526576738
E2      =    -8.252914935599
E3      =   -12.109409829583
Exc     =   -10.632239231627
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 1.309e-05, dEband = 4.178e-03
rank = 0, Calculating/Estimating energy took 1.172 ms, Etot = -32.146923052, dEtot = 1.309e-05, dEband = 4.178e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2636743592694, which took 0.119 ms

iter_count = 114, r_2norm = 7.397e-06, tol*||rhs|| = 1.055e-05

Anderson update took 67.037 ms, out of which F'*F took 32.160 ms; b-Ax took 220.012 ms, out of which Lap took 194.770 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 496.551 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248347, int_b + int_rho = 1.091e-13, checking this took 0.146 ms
2-norm of RHS = 705.8040399778670, which took 0.151 ms

iter_count = 234, r_2norm = 6.890e-04, tol*||rhs|| = 7.058e-04

Anderson update took 139.121 ms, out of which F'*F took 65.482 ms; b-Ax took 443.446 ms, out of which Lap took 393.844 ms
Solving Poisson took 979.340 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.168541 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 37.704 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.381 ms
Total time for convolution: 	 convolve: 5.157972 
Total time for convolution: 	 convolve: 5.180504 
Total time for convolution: 	 convolve: 5.186599 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 2.287 ms
======D2D: initiated sending and receiving took 4.400 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.321 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.648 ms

This SCF took 27884.280 ms, scf error = 2.575e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.157082, lowerbound = -0.952545, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1655.777 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.951 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.057 ms
rank =  0, Distribute data + matrix mult took 3.015 ms
rank =  0, finding HY took 25.651 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 4.078 ms
Rank 0, Project_Hamiltonian used 32.773 ms
Total time for projection: 32.798 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -0.948664764778321
    last  calculated eigval = 0.057174693040477
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.94866476477832
lambda[   2] =  -0.65363367239486
lambda[   3] =  -0.57077661717009
lambda[   4] =  -0.43126854817743
lambda[   5] =  -0.41880589346561
lambda[   6] =  -0.41544764002072
lambda[   7] =  -0.34647283138827
lambda[   8] =  -0.33050454713540
lambda[   9] =  -0.27489057695053
lambda[  10] =  -0.21185917167951
lambda[  11] =  -0.03206660045972
lambda[  12] =   0.00979063664723
lambda[  13] =   0.01108649983710
lambda[  14] =   0.01430275644180
lambda[  15] =   0.01643269211876
lambda[  16] =   0.02739352340999
lambda[  17] =   0.05717469304048
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 5.004 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 5.009 ms

Total time for subspace rotation: 5.010 ms
rank = 0, Efermi =  -0.061127536632 calculate fermi energy took 0.314 ms
rank = 0, --- Calculate rho: sum over local bands took 2.048 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1696.188 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, D2D took 0.502 ms
rank = 0, Transfering density took 0.505 ms
Etot    =   -32.146876816308
Eband   =    -9.204648527042
E1      =    20.802291901979
E2      =    -8.215564198524
E3      =   -12.120131738463
Exc     =   -10.639836217695
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 5.137e-06, dEband = 7.501e-03
rank = 0, Calculating/Estimating energy took 1.476 ms, Etot = -32.146876816, dEtot = 5.137e-06, dEband = 7.501e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1719618239272, which took 0.067 ms

iter_count = 114, r_2norm = 4.278e-06, tol*||rhs|| = 6.878e-06

Anderson update took 67.057 ms, out of which F'*F took 31.885 ms; b-Ax took 219.186 ms, out of which Lap took 193.894 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 495.551 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248336, int_b + int_rho = -3.638e-15, checking this took 0.121 ms
2-norm of RHS = 705.8133164435901, which took 0.069 ms

iter_count = 222, r_2norm = 5.864e-04, tol*||rhs|| = 7.058e-04

Anderson update took 131.882 ms, out of which F'*F took 62.860 ms; b-Ax took 419.875 ms, out of which Lap took 373.991 ms
Solving Poisson took 932.722 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.160558 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.381 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.393 ms
Total time for convolution: 	 convolve: 5.163844 
Total time for convolution: 	 convolve: 5.159887 
Total time for convolution: 	 convolve: 5.157211 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.338 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.966 ms
---Transfer Veff_loc: D2D took 1.060 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.078 ms

This SCF took 28319.861 ms, scf error = 1.312e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.157175, lowerbound = -0.948665, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1663.435 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.958 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 2.996 ms
rank =  0, finding HY took 26.173 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 4.024 ms
Rank 0, Project_Hamiltonian used 33.215 ms
Total time for projection: 33.234 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 2.308 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.019 ms
rank = 0, Solve_Generalized_EigenProblem used 2.333 ms
    first calculated eigval = -0.946604545561254
    last  calculated eigval = 0.058224217660921
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.94660454556125
lambda[   2] =  -0.65144980886765
lambda[   3] =  -0.56853957351355
lambda[   4] =  -0.42909598958031
lambda[   5] =  -0.41667559865653
lambda[   6] =  -0.41334872225682
lambda[   7] =  -0.34435338251528
lambda[   8] =  -0.32841808115787
lambda[   9] =  -0.27268026132018
lambda[  10] =  -0.20976048183924
lambda[  11] =  -0.03001102641472
lambda[  12] =   0.01237265274206
lambda[  13] =   0.01288377962476
lambda[  14] =   0.01552244940450
lambda[  15] =   0.01798727318007
lambda[  16] =   0.02829660578642
lambda[  17] =   0.05822421766092
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 2.351 ms
rank =  0, subspace rotation using ScaLAPACK took 4.986 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.994 ms

Total time for subspace rotation: 4.995 ms
rank = 0, Efermi =  -0.059071962617 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.262 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 1706.427 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
rank = 0, D2D took 0.485 ms
rank = 0, Transfering density took 0.488 ms
Etot    =   -32.146904218590
Eband   =    -9.161852891212
E1      =    20.779516024602
E2      =    -8.194156337353
E3      =   -12.125721114606
Exc     =   -10.644064893403
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 3.045e-06, dEband = 4.755e-03
rank = 0, Calculating/Estimating energy took 2.184 ms, Etot = -32.146904219, dEtot = 3.045e-06, dEband = 4.755e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0879288385041, which took 0.064 ms

iter_count = 114, r_2norm = 2.518e-06, tol*||rhs|| = 3.517e-06

Anderson update took 67.032 ms, out of which F'*F took 31.831 ms; b-Ax took 218.547 ms, out of which Lap took 193.627 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 494.947 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248337, int_b + int_rho = 3.638e-15, checking this took 0.116 ms
2-norm of RHS = 705.8250594827861, which took 0.121 ms

iter_count = 204, r_2norm = 7.002e-04, tol*||rhs|| = 7.058e-04

Anderson update took 120.935 ms, out of which F'*F took 57.672 ms; b-Ax took 387.778 ms, out of which Lap took 344.800 ms
Solving Poisson took 851.340 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.164416 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 49.483 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.394 ms
Total time for convolution: 	 convolve: 5.170187 
Total time for convolution: 	 convolve: 5.160442 
Total time for convolution: 	 convolve: 5.167789 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.704 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.308 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.326 ms

This SCF took 27716.138 ms, scf error = 9.375e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.158224, lowerbound = -0.946605, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1638.844 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.950 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.047 ms
rank =  0, Distribute data + matrix mult took 3.003 ms
rank =  0, finding HY took 25.636 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.770 ms
Rank 0, Project_Hamiltonian used 32.433 ms
Total time for projection: 32.448 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.945733713893815
    last  calculated eigval = 0.059095867390748
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.94573371389382
lambda[   2] =  -0.65069303817215
lambda[   3] =  -0.56775851653888
lambda[   4] =  -0.42830116789797
lambda[   5] =  -0.41586317712120
lambda[   6] =  -0.41251546644685
lambda[   7] =  -0.34356004056415
lambda[   8] =  -0.32762915278013
lambda[   9] =  -0.27180493174690
lambda[  10] =  -0.20882576160319
lambda[  11] =  -0.02775089782680
lambda[  12] =   0.01472539046946
lambda[  13] =   0.01511483633697
lambda[  14] =   0.01730007294857
lambda[  15] =   0.02034900963359
lambda[  16] =   0.02898031906524
lambda[  17] =   0.05909586739075
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 5.016 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 5.022 ms

Total time for subspace rotation: 5.023 ms
rank = 0, Efermi =  -0.056811834048 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.207 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1678.790 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
rank = 0, D2D took 0.479 ms
rank = 0, Transfering density took 0.481 ms
Etot    =   -32.146905497236
Eband   =    -9.145369934154
E1      =    20.773442208121
E2      =    -8.183640703996
E3      =   -12.125960086945
Exc     =   -10.644198651609
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 1.421e-07, dEband = 1.831e-03
rank = 0, Calculating/Estimating energy took 2.506 ms, Etot = -32.146905497, dEtot = 1.421e-07, dEband = 1.831e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0612758736321, which took 0.063 ms

iter_count = 108, r_2norm = 2.229e-06, tol*||rhs|| = 2.451e-06

Anderson update took 63.548 ms, out of which F'*F took 30.205 ms; b-Ax took 206.937 ms, out of which Lap took 183.089 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.748 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248336, int_b + int_rho = -3.638e-15, checking this took 0.131 ms
2-norm of RHS = 705.8156127009689, which took 0.173 ms

iter_count = 198, r_2norm = 6.781e-04, tol*||rhs|| = 7.058e-04

Anderson update took 117.087 ms, out of which F'*F took 55.727 ms; b-Ax took 374.792 ms, out of which Lap took 333.663 ms
Solving Poisson took 829.024 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.161841 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.191 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.381 ms
Total time for convolution: 	 convolve: 5.172579 
Total time for convolution: 	 convolve: 5.172625 
Total time for convolution: 	 convolve: 5.170399 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.333 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.351 ms

This SCF took 27645.076 ms, scf error = 5.294e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.159096, lowerbound = -0.945734, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1664.264 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.920 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.940 ms
rank =  0, finding HY took 26.240 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.839 ms
Rank 0, Project_Hamiltonian used 33.043 ms
Total time for projection: 33.062 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.116 ms
    first calculated eigval = -0.944250947126944
    last  calculated eigval = 0.060877641640630
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.94425094712694
lambda[   2] =  -0.64927798212743
lambda[   3] =  -0.56638974681771
lambda[   4] =  -0.42690275234960
lambda[   5] =  -0.41449843482115
lambda[   6] =  -0.41112813576983
lambda[   7] =  -0.34219557433486
lambda[   8] =  -0.32628119432141
lambda[   9] =  -0.27045679426131
lambda[  10] =  -0.20744674740244
lambda[  11] =  -0.02389874468143
lambda[  12] =   0.01802408850849
lambda[  13] =   0.01904129918518
lambda[  14] =   0.02108917658312
lambda[  15] =   0.02489950760962
lambda[  16] =   0.03034912768097
lambda[  17] =   0.06087764164063
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.140 ms
rank =  0, subspace rotation using ScaLAPACK took 4.897 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.902 ms

Total time for subspace rotation: 4.903 ms
rank = 0, Efermi =  -0.052959680971 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.232 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1704.741 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.372 ms
rank = 0, D2D took 1.480 ms
rank = 0, Transfering density took 1.487 ms
Etot    =   -32.146907976871
Eband   =    -9.117656619203
E1      =    20.758627744803
E2      =    -8.170139926259
E3      =   -12.128970087590
Exc     =   -10.646609205786
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 2.755e-07, dEband = 3.079e-03
rank = 0, Calculating/Estimating energy took 1.567 ms, Etot = -32.146907977, dEtot = 2.755e-07, dEband = 3.079e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0432969719943, which took 0.076 ms

iter_count = 114, r_2norm = 1.125e-06, tol*||rhs|| = 1.732e-06

Anderson update took 66.688 ms, out of which F'*F took 31.735 ms; b-Ax took 219.393 ms, out of which Lap took 194.335 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 494.357 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248338, int_b + int_rho = 1.091e-14, checking this took 0.125 ms
2-norm of RHS = 705.8192369181120, which took 0.132 ms

iter_count = 156, r_2norm = 5.898e-04, tol*||rhs|| = 7.058e-04

Anderson update took 92.740 ms, out of which F'*F took 43.709 ms; b-Ax took 295.326 ms, out of which Lap took 262.246 ms
Solving Poisson took 652.182 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.170614 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 32.197 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.173920 
Total time for convolution: 	 convolve: 5.182725 
Total time for convolution: 	 convolve: 5.170796 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.117 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.327 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.346 ms

This SCF took 27713.365 ms, scf error = 2.726e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.160878, lowerbound = -0.944251, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1636.977 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.944 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.019 ms
rank =  0, Distribute data + matrix mult took 2.971 ms
rank =  0, finding HY took 25.647 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 3.875 ms
Rank 0, Project_Hamiltonian used 32.516 ms
Total time for projection: 32.537 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.115 ms
    first calculated eigval = -0.943979109782958
    last  calculated eigval = 0.059890556391272
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.94397910978296
lambda[   2] =  -0.64899230439806
lambda[   3] =  -0.56611954809380
lambda[   4] =  -0.42662800299440
lambda[   5] =  -0.41423128673817
lambda[   6] =  -0.41085878968382
lambda[   7] =  -0.34192638603163
lambda[   8] =  -0.32601941752017
lambda[   9] =  -0.27019837138540
lambda[  10] =  -0.20720064357982
lambda[  11] =  -0.02315016423903
lambda[  12] =   0.01854327046173
lambda[  13] =   0.01954357602597
lambda[  14] =   0.02147793674304
lambda[  15] =   0.02552703265310
lambda[  16] =   0.03059127560253
lambda[  17] =   0.05989055639127
==subpsace eigenproblem: bcast eigvals took 0.037 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 4.955 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.962 ms

Total time for subspace rotation: 5.795 ms
rank = 0, Efermi =  -0.052211100347 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.103 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1677.736 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
rank = 0, D2D took 0.498 ms
rank = 0, Transfering density took 0.501 ms
Etot    =   -32.146935953193
Eband   =    -9.112307720937
E1      =    20.755829079405
E2      =    -8.167509999918
E3      =   -12.129311740645
Exc     =   -10.646899141688
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 3.108e-06, dEband = 5.943e-04
rank = 0, Calculating/Estimating energy took 1.342 ms, Etot = -32.146935953, dEtot = 3.108e-06, dEband = 5.943e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0272078289287, which took 0.058 ms

iter_count = 108, r_2norm = 9.019e-07, tol*||rhs|| = 1.088e-06

Anderson update took 63.632 ms, out of which F'*F took 30.093 ms; b-Ax took 206.813 ms, out of which Lap took 183.013 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.646 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248330, int_b + int_rho = -6.912e-14, checking this took 0.137 ms
2-norm of RHS = 705.8314009092145, which took 0.129 ms

iter_count = 174, r_2norm = 6.095e-04, tol*||rhs|| = 7.058e-04

Anderson update took 104.964 ms, out of which F'*F took 48.975 ms; b-Ax took 329.448 ms, out of which Lap took 293.538 ms
Solving Poisson took 730.934 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.181231 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.498 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.413 ms
Total time for convolution: 	 convolve: 5.175310 
Total time for convolution: 	 convolve: 5.174469 
Total time for convolution: 	 convolve: 5.167824 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.404 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
---Transfer Veff_loc: D2D took 0.351 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.372 ms

This SCF took 27533.608 ms, scf error = 2.217e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.159891, lowerbound = -0.943979, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1663.397 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.953 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.973 ms
rank =  0, finding HY took 26.108 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.847 ms
Rank 0, Project_Hamiltonian used 32.951 ms
Total time for projection: 32.971 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.943759758230470
    last  calculated eigval = 0.060635490816809
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.94375975823047
lambda[   2] =  -0.64873055249014
lambda[   3] =  -0.56584145285338
lambda[   4] =  -0.42637241459652
lambda[   5] =  -0.41395922939892
lambda[   6] =  -0.41057771946010
lambda[   7] =  -0.34163319620451
lambda[   8] =  -0.32574275611103
lambda[   9] =  -0.26993807397157
lambda[  10] =  -0.20694437415573
lambda[  11] =  -0.02034204121871
lambda[  12] =   0.02047826428968
lambda[  13] =   0.02108211905984
lambda[  14] =   0.02362066024326
lambda[  15] =   0.02814897117914
lambda[  16] =   0.03300882123315
lambda[  17] =   0.06063549081681
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 5.367 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 5.382 ms

Total time for subspace rotation: 5.383 ms
rank = 0, Efermi =  -0.049402977410 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 2.006 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.030 ms
rank = 0, Calculating density took 1704.536 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
rank = 0, D2D took 0.395 ms
rank = 0, Transfering density took 0.403 ms
Etot    =   -32.146994196157
Eband   =    -9.106999055402
E1      =    20.753794840135
E2      =    -8.164216796888
E3      =   -12.129282421442
Exc     =   -10.646909288684
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 6.471e-06, dEband = 5.899e-04
rank = 0, Calculating/Estimating energy took 1.464 ms, Etot = -32.146994196, dEtot = 6.471e-06, dEband = 5.899e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0239540184444, which took 0.053 ms

iter_count = 108, r_2norm = 9.343e-07, tol*||rhs|| = 9.582e-07

Anderson update took 63.473 ms, out of which F'*F took 30.144 ms; b-Ax took 207.062 ms, out of which Lap took 183.214 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 469.071 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248340, int_b + int_rho = 3.274e-14, checking this took 0.104 ms
2-norm of RHS = 705.8304063659908, which took 0.102 ms

iter_count = 108, r_2norm = 6.839e-04, tol*||rhs|| = 7.058e-04

Anderson update took 64.017 ms, out of which F'*F took 30.405 ms; b-Ax took 204.474 ms, out of which Lap took 181.555 ms
Solving Poisson took 452.266 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.176425 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.384 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.180948 
Total time for convolution: 	 convolve: 5.192131 
Total time for convolution: 	 convolve: 5.181899 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.655 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.309 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.325 ms

This SCF took 27413.894 ms, scf error = 1.678e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.160635, lowerbound = -0.943760, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1637.104 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.931 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.951 ms
rank =  0, finding HY took 25.736 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.797 ms
Rank 0, Project_Hamiltonian used 32.505 ms
Total time for projection: 32.525 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.943646158181447
    last  calculated eigval = 0.058799316231851
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.94364615818145
lambda[   2] =  -0.64863277931882
lambda[   3] =  -0.56574588313219
lambda[   4] =  -0.42627012868817
lambda[   5] =  -0.41386451008660
lambda[   6] =  -0.41048339944437
lambda[   7] =  -0.34154487482045
lambda[   8] =  -0.32565429192984
lambda[   9] =  -0.26983564231680
lambda[  10] =  -0.20683977875233
lambda[  11] =  -0.01976472505719
lambda[  12] =   0.02071690008634
lambda[  13] =   0.02149619999736
lambda[  14] =   0.02416282621174
lambda[  15] =   0.02873372321794
lambda[  16] =   0.03347323113194
lambda[  17] =   0.05879931623185
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 4.284 ms
rank =  0, Distributing orbital back into band + domain format took 0.005 ms
rank = 0, Subspace_Rotation used 4.300 ms

Total time for subspace rotation: 4.302 ms
rank = 0, Efermi =  -0.048825661232 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 1.877 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.029 ms
rank = 0, Calculating density took 1677.558 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, D2D took 0.403 ms
rank = 0, Transfering density took 0.412 ms
Etot    =   -32.147000357158
Eband   =    -9.105034893786
E1      =    20.752648108927
E2      =    -8.163340919742
E3      =   -12.129543679328
Exc     =   -10.647118260833
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 6.846e-07, dEband = 2.182e-04
rank = 0, Calculating/Estimating energy took 1.802 ms, Etot = -32.147000357, dEtot = 6.846e-07, dEband = 2.182e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0228472162995, which took 0.108 ms

iter_count = 108, r_2norm = 8.136e-07, tol*||rhs|| = 9.139e-07

Anderson update took 63.319 ms, out of which F'*F took 30.015 ms; b-Ax took 207.369 ms, out of which Lap took 183.717 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.561 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248330, int_b + int_rho = -6.548e-14, checking this took 0.104 ms
2-norm of RHS = 705.8299756511893, which took 0.124 ms

iter_count = 102, r_2norm = 6.423e-04, tol*||rhs|| = 7.058e-04

Anderson update took 60.618 ms, out of which F'*F took 28.641 ms; b-Ax took 192.938 ms, out of which Lap took 171.867 ms
Solving Poisson took 429.037 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.173101 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 56.983 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.380 ms
Total time for convolution: 	 convolve: 5.165858 
Total time for convolution: 	 convolve: 5.183975 
Total time for convolution: 	 convolve: 5.218780 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.155 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.315 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.333 ms

This SCF took 27362.847 ms, scf error = 1.117e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.158799, lowerbound = -0.943646, upperbound = 267.575345

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1659.405 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.944 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.037 ms
rank =  0, Distribute data + matrix mult took 2.988 ms
rank =  0, finding HY took 26.152 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.745 ms
Rank 0, Project_Hamiltonian used 32.911 ms
Total time for projection: 32.935 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.576 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.036 ms
rank = 0, Solve_Generalized_EigenProblem used 0.621 ms
    first calculated eigval = -0.943556447482553
    last  calculated eigval = 0.056053937410780
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.94355644748255
lambda[   2] =  -0.64855286617715
lambda[   3] =  -0.56566769671954
lambda[   4] =  -0.42618791096804
lambda[   5] =  -0.41378701085594
lambda[   6] =  -0.41040538304835
lambda[   7] =  -0.34147063358813
lambda[   8] =  -0.32558060772964
lambda[   9] =  -0.26975573962220
lambda[  10] =  -0.20675771248223
lambda[  11] =  -0.01948294664565
lambda[  12] =   0.02074939060367
lambda[  13] =   0.02159029145904
lambda[  14] =   0.02444519941741
lambda[  15] =   0.02887543811386
lambda[  16] =   0.03393028716031
lambda[  17] =   0.05605393741078
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.308 ms
rank =  0, subspace rotation using ScaLAPACK took 5.173 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 5.444 ms

Total time for subspace rotation: 5.445 ms
rank = 0, Efermi =  -0.048543882851 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.128 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.030 ms
rank = 0, Calculating density took 1701.414 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
rank = 0, D2D took 0.546 ms
rank = 0, Transfering density took 0.557 ms
Etot    =   -32.147009932038
Eband   =    -9.103444017786
E1      =    20.751784371694
E2      =    -8.162572300553
E3      =   -12.129694512563
Exc     =   -10.647237188527
Esc     =   -53.440379909862
Entropy =    -0.000000000673
dE = 1.064e-06, dEband = 1.768e-04
rank = 0, Calculating/Estimating energy took 1.108 ms, Etot = -32.147009932, dEtot = 1.064e-06, dEband = 1.768e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0148479234670, which took 0.097 ms

iter_count = 108, r_2norm = 4.296e-07, tol*||rhs|| = 5.939e-07

Anderson update took 63.550 ms, out of which F'*F took 30.052 ms; b-Ax took 207.087 ms, out of which Lap took 183.577 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.924 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002248337, int_rho =  20.00000002248340, int_b + int_rho = 3.274e-14, checking this took 0.141 ms
2-norm of RHS = 705.8318738352142, which took 0.113 ms

iter_count = 138, r_2norm = 5.590e-04, tol*||rhs|| = 7.058e-04

Anderson update took 82.016 ms, out of which F'*F took 38.960 ms; b-Ax took 260.615 ms, out of which Lap took 231.688 ms
Solving Poisson took 576.867 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.173296 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.578 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.145 ms
Total time for convolution: 	 convolve: 5.174269 
Total time for convolution: 	 convolve: 5.179161 
Total time for convolution: 	 convolve: 5.172290 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.125 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.348 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.323 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.343 ms

This SCF took 27462.420 ms, scf error = 8.631e-05
The last 17 occupations of kpoints #1 are (Nelectron = 20):
lambda[   1] =  -0.94355644748255, occ[   1] =   2.00000000000000
lambda[   2] =  -0.64855286617715, occ[   2] =   2.00000000000000
lambda[   3] =  -0.56566769671954, occ[   3] =   2.00000000000000
lambda[   4] =  -0.42618791096804, occ[   4] =   2.00000000000000
lambda[   5] =  -0.41378701085594, occ[   5] =   2.00000000000000
lambda[   6] =  -0.41040538304835, occ[   6] =   2.00000000000000
lambda[   7] =  -0.34147063358813, occ[   7] =   2.00000000000000
lambda[   8] =  -0.32558060772964, occ[   8] =   2.00000000000000
lambda[   9] =  -0.26975573962220, occ[   9] =   2.00000000000000
lambda[  10] =  -0.20675771248223, occ[  10] =   2.00000000000000
lambda[  11] =  -0.01948294664565, occ[  11] =   0.00000002248336
lambda[  12] =   0.02074939060367, occ[  12] =   0.00000000000000
lambda[  13] =   0.02159029145904, occ[  13] =   0.00000000000000
lambda[  14] =   0.02444519941741, occ[  14] =   0.00000000000000
lambda[  15] =   0.02887543811386, occ[  15] =   0.00000000000000
lambda[  16] =   0.03393028716031, occ[  16] =   0.00000000000000
lambda[  17] =   0.05605393741078, occ[  17] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 15 (90%) = 0.000000000000000.
Occupation of state 17 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.148 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.422 ms, time for Allreduce/Reduce: 9.236 ms 
Time for calculating local force components: 17.920 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000180557984   0.00000056338865  -1.03882116530082
  0.00000004666977  -0.03980320156605  -0.03154506719963
  0.00000000042644   0.03980314281583  -0.03154507472954
 -0.03954717185525  -0.00323637437614   0.02854411471497
  0.03954720673505  -0.00323646604764   0.02854418589269
  0.03954714367228   0.00323639661491   0.02854413944252
 -0.03954723609602   0.00323640478690   0.02854418559067
 -0.00000036812922  -0.13170596742831   0.08435089534588
 -0.00000045244655   0.13170482121886   0.08435032113170
force_loc = 
  0.00000871585212   0.00000423051006   1.01151437395869
  0.00000028566368   0.04065418747208   0.03238522604584
 -0.00000011207751  -0.04065708497777   0.03238712882593
  0.04092241371368   0.00311344116694  -0.02921985780563
 -0.04092210012726   0.00311282636209  -0.02921902349713
 -0.04092520206247  -0.00311325772780  -0.02922081121436
  0.04092444425431  -0.00311295112040  -0.02922106930841
  0.00000046865196   0.13059527895966  -0.08339373256021
  0.00000058329629  -0.13059633617496  -0.08339402551142
Time for calculating nonlocal force components: 28.298 ms
[32mforces_xc: 
[0m[32m  0.00000019834615  -0.00000029809429   0.03426704912687
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000002997755   0.00652487052719  -0.00400363906175
[0m[32m  0.00000000793712  -0.00652489336007  -0.00400358755337
[0mTime for calculating XC forces components: 25.067 ms
 Cartesian force = 
  0.00000953000234   0.00000456992112   0.00697752819214
 -0.00000085744233   0.00085106002272   0.00085742925360
 -0.00000130142684  -0.00085386804524   0.00085932450378
  0.00137405208265  -0.00012285909250  -0.00065847268327
 -0.00137608316798  -0.00012356556886  -0.00065756719706
 -0.00137924816596   0.00012321300380  -0.00065940136444
  0.00137601838251   0.00012352778319  -0.00065961331035
 -0.00000105927548   0.00541425617524  -0.00302920586870
 -0.00000105098891  -0.00541633419947  -0.00303002152569
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.122 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.388 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Time for printing density: 383.658 ms
The program took 423.288 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:36:06
Job ID:        2267005
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:28:00,vmem=8376K,walltime=00:07:20,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-13-2
---------------------------------------
