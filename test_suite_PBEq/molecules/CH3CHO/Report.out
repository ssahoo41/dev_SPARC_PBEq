---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:41
Job ID:    2266461
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:47
Job ID:    2266461
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.058 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 0.729 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 7.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 0.667 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 10.128 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.007 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.081 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   12.631588	   10.938922	   10.000000	
    9.387167	   12.936527	   10.000000	
    9.677593	    7.063473	   10.000000	
    7.368412	    8.906206	   11.661430	
    7.368412	    8.906206	    8.338570	
   10.360253	   11.068077	   10.000000	
    8.605045	    8.824772	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.155 ms
Set up communicators.

--set up spincomm took 3.192 ms

--set up kptcomm took 0.352 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.037 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.046 ms

Calculate_SplineDerivRadFun took 0.215 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.813 ms.
time spent on vectorized spline interp: 3.561 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.714 ms.
time spent on vectorized spline interp: 1.392 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.677 ms.
time spent on vectorized spline interp: 1.642 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.291 ms.

Calculating rb for all atom types took 17.102 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.062 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000191223, sum_int_rho = 17.5979258591707
PosCharge = 18.000000019122, NegCharge = -17.597925859171, scal_fac = 1.022847815315
After scaling, int_rho = 18.0000000191225, PosCharge + NegCharge - NetCharge = -1.030e-13
--Calculate Vref took 0.384 ms
--Calculate rho_guess took 1.967 ms

 integral of b = -18.0000000191223,
 int{b} + Nelectron + NetCharge = -1.912e-08,
 Esc = -50.5318448074970,
 MPI_Reduce took 4.675 ms

Calculating b & b_ref took 12.332 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.029 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.036 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.018 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.115 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 28.174 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912239, int_b + int_rho = 8.004e-14, checking this took 0.090 ms
2-norm of RHS = 635.3016995493447, which took 0.075 ms

iter_count = 420, r_2norm = 5.507e-04, tol*||rhs|| = 6.353e-04

Anderson update took 249.892 ms, out of which F'*F took 106.122 ms; b-Ax took 713.279 ms, out of which Lap took 641.283 ms
Solving Poisson took 1532.786 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.365 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
Total time for convolution: 	 convolve: 5.106790 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 80.523 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
Total time for convolution: 	 convolve: 5.116218 
Total time for convolution: 	 convolve: 5.114118 
Total time for convolution: 	 convolve: 5.146986 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.701 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.521 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.352 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, XC calculation took 24880.553 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 1.583 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.242 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.912 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.137 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.657 ms
    Lanczos iter 53, eigmin  = -1.009095000, eigmax = 264.928162517, err_eigmin = 2.605e-03, err_eigmax = 9.787e-03
rank =   0, Lanczos took 119.732 ms, eigmin = -1.009094999743, eigmax = 267.577444141717

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.234175, lowerbound = -1.109095, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1177.990 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.835 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.018 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.020 ms
rank =  0, Distribute data + matrix mult took 17.890 ms
rank =  0, finding HY took 20.415 ms
rank =  0, distributing HY into block cyclic form took 11.892 ms
rank =  0, finding Y'*HY took 5.667 ms
Rank 0, Project_Hamiltonian used 55.895 ms
Total time for projection: 55.908 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.722 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.795 ms
    first calculated eigval = 2.800700006187292
    last  calculated eigval = 3.213671040301164
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.80070000618729
lambda[   2] =   2.82665461894786
lambda[   3] =   2.88445804999191
lambda[   4] =   2.92831362681815
lambda[   5] =   2.93806927903480
lambda[   6] =   2.95493479483595
lambda[   7] =   3.00287178355633
lambda[   8] =   3.01566610070306
lambda[   9] =   3.04325338482687
lambda[  10] =   3.06710329249277
lambda[  11] =   3.08298888788636
lambda[  12] =   3.11439086498185
lambda[  13] =   3.14190680775022
lambda[  14] =   3.15767190788898
lambda[  15] =   3.21367104030116
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.189 ms
rank =  0, subspace rotation using ScaLAPACK took 3.483 ms
rank =  0, Distributing orbital back into band + domain format took 12.688 ms
rank = 0, Subspace_Rotation used 16.185 ms

Total time for subspace rotation: 16.188 ms
rank = 0, Efermi =   3.055178335567 calculate fermi energy took 0.053 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.313671, lowerbound = -1.109095, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1140.843 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 47.233 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.368 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.074 ms
rank =  0, Distribute data + matrix mult took 50.690 ms
rank =  0, finding HY took 19.308 ms
rank =  0, distributing HY into block cyclic form took 12.064 ms
rank =  0, finding Y'*HY took 4.427 ms
Rank 0, Project_Hamiltonian used 86.512 ms
Total time for projection: 86.516 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -0.767920574720669
    last  calculated eigval = 0.458165892707741
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.76792057472067
lambda[   2] =  -0.49212263460403
lambda[   3] =  -0.25206208679131
lambda[   4] =  -0.02349926580396
lambda[   5] =  -0.01184602266295
lambda[   6] =   0.01943558648741
lambda[   7] =   0.14761676999823
lambda[   8] =   0.19067266350142
lambda[   9] =   0.24834615388698
lambda[  10] =   0.30286637643206
lambda[  11] =   0.35052197914458
lambda[  12] =   0.36341761103741
lambda[  13] =   0.39353027626024
lambda[  14] =   0.41736156843965
lambda[  15] =   0.45816589270774
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.166 ms
rank =  0, subspace rotation using ScaLAPACK took 3.512 ms
rank =  0, Distributing orbital back into band + domain format took 11.911 ms
rank = 0, Subspace_Rotation used 15.437 ms

Total time for subspace rotation: 15.441 ms
rank = 0, Efermi =   0.275664920726 calculate fermi energy took 0.023 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.558166, lowerbound = -1.109095, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1150.495 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 33.998 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.344 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.228 ms
rank =  0, Distribute data + matrix mult took 37.584 ms
rank =  0, finding HY took 18.762 ms
rank =  0, distributing HY into block cyclic form took 12.025 ms
rank =  0, finding Y'*HY took 4.249 ms
Rank 0, Project_Hamiltonian used 73.187 ms
Total time for projection: 73.193 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -1.034955844106421
    last  calculated eigval = 0.142460675761090
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03495584410642
lambda[   2] =  -0.80279870510748
lambda[   3] =  -0.60262686813947
lambda[   4] =  -0.51637904318011
lambda[   5] =  -0.49531625881237
lambda[   6] =  -0.47519736690520
lambda[   7] =  -0.42662079599229
lambda[   8] =  -0.37694778757460
lambda[   9] =  -0.24520702166250
lambda[  10] =  -0.04909808703156
lambda[  11] =   0.06486387790643
lambda[  12] =   0.07838061735391
lambda[  13] =   0.10699881178033
lambda[  14] =   0.12216473495683
lambda[  15] =   0.14246067576109
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 3.492 ms
rank =  0, Distributing orbital back into band + domain format took 11.833 ms
rank = 0, Subspace_Rotation used 15.337 ms

Total time for subspace rotation: 15.341 ms
rank = 0, Efermi =  -0.078304753236 calculate fermi energy took 0.025 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.242461, lowerbound = -1.109095, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1229.157 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 11.981 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.242 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.058 ms
rank =  0, Distribute data + matrix mult took 15.294 ms
rank =  0, finding HY took 19.357 ms
rank =  0, distributing HY into block cyclic form took 12.045 ms
rank =  0, finding Y'*HY took 4.350 ms
Rank 0, Project_Hamiltonian used 51.072 ms
Total time for projection: 51.077 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -1.035426047550631
    last  calculated eigval = 0.084486880394705
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03542604755063
lambda[   2] =  -0.80369460463371
lambda[   3] =  -0.60910649582430
lambda[   4] =  -0.52487310111775
lambda[   5] =  -0.50514783481459
lambda[   6] =  -0.48247694924200
lambda[   7] =  -0.45065416633156
lambda[   8] =  -0.39041814150661
lambda[   9] =  -0.29037644312476
lambda[  10] =  -0.11064856776691
lambda[  11] =   0.00463229183257
lambda[  12] =   0.04011331890700
lambda[  13] =   0.04527768483160
lambda[  14] =   0.05640022257060
lambda[  15] =   0.08448688039471
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 3.514 ms
rank =  0, Distributing orbital back into band + domain format took 11.939 ms
rank = 0, Subspace_Rotation used 15.468 ms

Total time for subspace rotation: 15.471 ms
rank = 0, Efermi =  -0.139855233863 calculate fermi energy took 0.025 ms
rank = 0, --- Calculate rho: sum over local bands took 2.314 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.994 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.150 ms
rank = 0, Calculating density took 5157.946 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.588 ms
rank = 0, D2D took 0.690 ms
rank = 0, Transfering density took 0.696 ms
Etot    =   -31.041291242795
Eband   =   -10.184347570408
E1      =    20.336405598286
E2      =    -8.186955932586
E3      =   -10.628030354991
Exc     =    -9.476490750178
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 4.434e+00, dEband = 1.455e+00
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -31.041291243, dEtot = 4.434e+00, dEband = 1.455e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 51.4716148458050, which took 0.048 ms

iter_count = 96, r_2norm = 1.382e-03, tol*||rhs|| = 2.059e-03

Anderson update took 51.093 ms, out of which F'*F took 23.962 ms; b-Ax took 162.114 ms, out of which Lap took 145.206 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 348.970 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912246, int_b + int_rho = 1.455e-13, checking this took 0.099 ms
2-norm of RHS = 631.8673609428675, which took 0.126 ms

iter_count = 282, r_2norm = 6.098e-04, tol*||rhs|| = 6.319e-04

Anderson update took 150.274 ms, out of which F'*F took 70.711 ms; b-Ax took 476.438 ms, out of which Lap took 426.100 ms
Solving Poisson took 1010.809 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.915 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.137076 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.185440 
Total time for convolution: 	 convolve: 5.117517 
Total time for convolution: 	 convolve: 5.128902 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.348 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.053 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.969 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.820 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.810 ms

This SCF took 31079.796 ms, scf error = 1.646e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.184487, lowerbound = -1.035426, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1170.984 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.885 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.372 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.276 ms
rank =  0, finding HY took 19.442 ms
rank =  0, distributing HY into block cyclic form took 11.743 ms
rank =  0, finding Y'*HY took 5.013 ms
Rank 0, Project_Hamiltonian used 51.506 ms
Total time for projection: 51.779 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -1.014718251515064
    last  calculated eigval = 0.057364682859685
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.01471825151506
lambda[   2] =  -0.76631953968653
lambda[   3] =  -0.58611559504477
lambda[   4] =  -0.49530401577605
lambda[   5] =  -0.47182572624972
lambda[   6] =  -0.45307613509831
lambda[   7] =  -0.42429307819441
lambda[   8] =  -0.37455218477216
lambda[   9] =  -0.26673081117345
lambda[  10] =  -0.10487242739724
lambda[  11] =  -0.02314710897179
lambda[  12] =   0.02254134227624
lambda[  13] =   0.02749175926776
lambda[  14] =   0.03371518504922
lambda[  15] =   0.05736468285968
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 3.556 ms
rank =  0, Distributing orbital back into band + domain format took 11.883 ms
rank = 0, Subspace_Rotation used 15.452 ms

Total time for subspace rotation: 15.897 ms
rank = 0, Efermi =  -0.134079093456 calculate fermi energy took 0.641 ms
rank = 0, --- Calculate rho: sum over local bands took 2.836 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.604 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.183 ms
rank = 0, Calculating density took 1245.157 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.577 ms
rank = 0, D2D took 0.784 ms
rank = 0, Transfering density took 0.793 ms
Etot    =   -30.997546046702
Eband   =    -9.705870677026
E1      =    19.919329640832
E2      =    -8.144145325159
E3      =   -10.758447056483
Exc     =    -9.581752584078
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 6.249e-03, dEband = 6.835e-02
rank = 0, Calculating/Estimating energy took 0.982 ms, Etot = -30.997546047, dEtot = 6.249e-03, dEband = 6.835e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 19.9955053999349, which took 0.089 ms

iter_count = 102, r_2norm = 4.915e-04, tol*||rhs|| = 7.998e-04

Anderson update took 54.034 ms, out of which F'*F took 25.300 ms; b-Ax took 172.729 ms, out of which Lap took 154.108 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.979 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912244, int_b + int_rho = 1.310e-13, checking this took 0.105 ms
2-norm of RHS = 627.6459814910282, which took 0.141 ms

iter_count = 294, r_2norm = 6.130e-04, tol*||rhs|| = 6.276e-04

Anderson update took 155.486 ms, out of which F'*F took 73.533 ms; b-Ax took 501.089 ms, out of which Lap took 448.783 ms
Solving Poisson took 1059.228 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.816 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.185265 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.195582 
Total time for convolution: 	 convolve: 5.211041 
Total time for convolution: 	 convolve: 5.210531 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.142 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.236 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.942 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.814 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.777 ms

This SCF took 27518.503 ms, scf error = 1.122e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.157365, lowerbound = -1.014718, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1172.334 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.047 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.682 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.118 ms
rank =  0, Distribute data + matrix mult took 15.861 ms
rank =  0, finding HY took 20.172 ms
rank =  0, distributing HY into block cyclic form took 12.243 ms
rank =  0, finding Y'*HY took 4.328 ms
Rank 0, Project_Hamiltonian used 52.635 ms
Total time for projection: 52.647 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.984961346029774
    last  calculated eigval = 0.046478631997674
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98496134602977
lambda[   2] =  -0.70879881014392
lambda[   3] =  -0.54568985331234
lambda[   4] =  -0.45058126273257
lambda[   5] =  -0.42291769010843
lambda[   6] =  -0.40940252621917
lambda[   7] =  -0.37866324915501
lambda[   8] =  -0.34892250748578
lambda[   9] =  -0.23265869675620
lambda[  10] =  -0.08527134082394
lambda[  11] =  -0.03043536324735
lambda[  12] =   0.01479465474561
lambda[  13] =   0.01839034981642
lambda[  14] =   0.03012222695944
lambda[  15] =   0.04647863199767
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 4.013 ms
rank =  0, Distributing orbital back into band + domain format took 11.690 ms
rank = 0, Subspace_Rotation used 15.723 ms

Total time for subspace rotation: 15.751 ms
rank = 0, Efermi =  -0.114478006971 calculate fermi energy took 0.081 ms
rank = 0, --- Calculate rho: sum over local bands took 2.949 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.158 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 1247.787 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
rank = 0, D2D took 0.651 ms
rank = 0, Transfering density took 0.656 ms
Etot    =   -30.964705871412
Eband   =    -8.965191885517
E1      =    19.291518665964
E2      =    -8.018481050342
E3      =   -10.992262037702
Exc     =    -9.769930931831
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 4.691e-03, dEband = 1.058e-01
rank = 0, Calculating/Estimating energy took 0.908 ms, Etot = -30.964705871, dEtot = 4.691e-03, dEband = 1.058e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.4544865316081, which took 0.109 ms

iter_count = 102, r_2norm = 1.891e-04, tol*||rhs|| = 2.182e-04

Anderson update took 54.746 ms, out of which F'*F took 25.293 ms; b-Ax took 172.384 ms, out of which Lap took 153.527 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.821 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912244, int_b + int_rho = 1.310e-13, checking this took 0.094 ms
2-norm of RHS = 627.4093605569835, which took 0.099 ms

iter_count = 276, r_2norm = 5.140e-04, tol*||rhs|| = 6.274e-04

Anderson update took 147.633 ms, out of which F'*F took 68.417 ms; b-Ax took 466.296 ms, out of which Lap took 416.102 ms
Solving Poisson took 991.518 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.406 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.098612 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.106289 
Total time for convolution: 	 convolve: 5.097405 
Total time for convolution: 	 convolve: 5.085879 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.561 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.352 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.225 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.949 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.816 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.785 ms

This SCF took 27032.690 ms, scf error = 3.988e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.146479, lowerbound = -0.984961, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1153.947 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.984 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.405 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.106 ms
rank =  0, Distribute data + matrix mult took 15.510 ms
rank =  0, finding HY took 19.400 ms
rank =  0, distributing HY into block cyclic form took 12.040 ms
rank =  0, finding Y'*HY took 5.283 ms
Rank 0, Project_Hamiltonian used 52.263 ms
Total time for projection: 52.277 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.976380790827765
    last  calculated eigval = 0.041377678520538
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97638079082776
lambda[   2] =  -0.69508647711021
lambda[   3] =  -0.53198634412931
lambda[   4] =  -0.43823907518382
lambda[   5] =  -0.41111458512132
lambda[   6] =  -0.39852128893632
lambda[   7] =  -0.36477239736058
lambda[   8] =  -0.34101999443566
lambda[   9] =  -0.22421093274891
lambda[  10] =  -0.07734814500721
lambda[  11] =  -0.03222448316827
lambda[  12] =   0.01161858397328
lambda[  13] =   0.01428795258541
lambda[  14] =   0.02755238951465
lambda[  15] =   0.04137767852054
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 3.989 ms
rank =  0, Distributing orbital back into band + domain format took 11.527 ms
rank = 0, Subspace_Rotation used 15.534 ms

Total time for subspace rotation: 15.543 ms
rank = 0, Efermi =  -0.106554811261 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.412 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.972 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.190 ms
rank = 0, Calculating density took 1229.157 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.715 ms
rank = 0, D2D took 0.821 ms
rank = 0, Transfering density took 0.827 ms
Etot    =   -30.960619058421
Eband   =    -8.762663773187
E1      =    19.148377350521
E2      =    -7.946295973136
E3      =   -11.067644802371
Exc     =    -9.828428603190
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 5.838e-04, dEband = 2.893e-02
rank = 0, Calculating/Estimating energy took 0.904 ms, Etot = -30.960619058, dEtot = 5.838e-04, dEband = 2.893e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.4556091886377, which took 0.054 ms

iter_count = 108, r_2norm = 5.732e-05, tol*||rhs|| = 5.822e-05

Anderson update took 57.574 ms, out of which F'*F took 27.085 ms; b-Ax took 184.221 ms, out of which Lap took 163.948 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.075 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912243, int_b + int_rho = 1.201e-13, checking this took 0.104 ms
2-norm of RHS = 627.7617113884307, which took 0.108 ms

iter_count = 258, r_2norm = 5.441e-04, tol*||rhs|| = 6.278e-04

Anderson update took 138.228 ms, out of which F'*F took 64.157 ms; b-Ax took 433.336 ms, out of which Lap took 388.493 ms
Solving Poisson took 926.063 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Total time for convolution: 	 convolve: 5.085393 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.094097 
Total time for convolution: 	 convolve: 5.094940 
Total time for convolution: 	 convolve: 5.101339 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.345 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.938 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.813 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.773 ms

This SCF took 26935.835 ms, scf error = 1.403e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.141378, lowerbound = -0.976381, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1168.397 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.089 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.357 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 15.489 ms
rank =  0, finding HY took 19.482 ms
rank =  0, distributing HY into block cyclic form took 11.956 ms
rank =  0, finding Y'*HY took 4.417 ms
Rank 0, Project_Hamiltonian used 51.374 ms
Total time for projection: 51.387 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.545 ms
rank = 0, Solve_Generalized_EigenProblem used 1.038 ms
    first calculated eigval = -0.971227242403730
    last  calculated eigval = 0.037545677000911
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97122724240373
lambda[   2] =  -0.69101456990379
lambda[   3] =  -0.52714002681962
lambda[   4] =  -0.43333866791557
lambda[   5] =  -0.40697549844492
lambda[   6] =  -0.39353337738542
lambda[   7] =  -0.35944180198979
lambda[   8] =  -0.33653256556689
lambda[   9] =  -0.21930286140917
lambda[  10] =  -0.07347251945365
lambda[  11] =  -0.03262097585942
lambda[  12] =   0.00985170358716
lambda[  13] =   0.01326833405062
lambda[  14] =   0.02544461118230
lambda[  15] =   0.03754567700091
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.055 ms
rank =  0, subspace rotation using ScaLAPACK took 3.589 ms
rank =  0, Distributing orbital back into band + domain format took 11.886 ms
rank = 0, Subspace_Rotation used 15.489 ms

Total time for subspace rotation: 15.495 ms
rank = 0, Efermi =  -0.102679185674 calculate fermi energy took 2.271 ms
rank = 0, --- Calculate rho: sum over local bands took 3.160 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.792 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.156 ms
rank = 0, Calculating density took 1243.776 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
rank = 0, D2D took 0.921 ms
rank = 0, Transfering density took 0.930 ms
Etot    =   -30.959701301190
Eband   =    -8.677013225083
E1      =    19.105249778173
E2      =    -7.896724685261
E3      =   -11.096816022114
Exc     =    -9.849633753582
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 1.311e-04, dEband = 1.224e-02
rank = 0, Calculating/Estimating energy took 1.056 ms, Etot = -30.959701301, dEtot = 1.311e-04, dEband = 1.224e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0420205373554, which took 0.074 ms

iter_count = 108, r_2norm = 3.351e-05, tol*||rhs|| = 4.168e-05

Anderson update took 57.501 ms, out of which F'*F took 26.605 ms; b-Ax took 181.574 ms, out of which Lap took 161.608 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.331 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912246, int_b + int_rho = 1.528e-13, checking this took 0.096 ms
2-norm of RHS = 628.0058567537696, which took 0.097 ms

iter_count = 234, r_2norm = 5.329e-04, tol*||rhs|| = 6.280e-04

Anderson update took 123.634 ms, out of which F'*F took 57.669 ms; b-Ax took 395.471 ms, out of which Lap took 351.849 ms
Solving Poisson took 841.398 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.099479 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 38.260 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.099619 
Total time for convolution: 	 convolve: 5.094703 
Total time for convolution: 	 convolve: 5.091644 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 0.974 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.345 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.341 ms

This SCF took 26901.338 ms, scf error = 5.161e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.137546, lowerbound = -0.971227, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1180.124 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.973 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.350 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.122 ms
rank =  0, Distribute data + matrix mult took 15.460 ms
rank =  0, finding HY took 19.910 ms
rank =  0, distributing HY into block cyclic form took 11.942 ms
rank =  0, finding Y'*HY took 4.197 ms
Rank 0, Project_Hamiltonian used 51.560 ms
Total time for projection: 51.571 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -0.969731212505547
    last  calculated eigval = 0.034425544643497
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96973121250555
lambda[   2] =  -0.68882645828305
lambda[   3] =  -0.52580720425636
lambda[   4] =  -0.43153725688573
lambda[   5] =  -0.40513823612209
lambda[   6] =  -0.39168143718956
lambda[   7] =  -0.35746718991948
lambda[   8] =  -0.33480425432285
lambda[   9] =  -0.21761365297365
lambda[  10] =  -0.07227702411214
lambda[  11] =  -0.03249619445962
lambda[  12] =   0.00893655666071
lambda[  13] =   0.01321256479600
lambda[  14] =   0.02393959666654
lambda[  15] =   0.03442554464350
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 3.601 ms
rank =  0, Distributing orbital back into band + domain format took 11.865 ms
rank = 0, Subspace_Rotation used 15.481 ms

Total time for subspace rotation: 15.486 ms
rank = 0, Efermi =  -0.101483690354 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 3.035 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.336 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 1254.001 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
rank = 0, D2D took 0.975 ms
rank = 0, Transfering density took 0.981 ms
Etot    =   -30.959551216771
Eband   =    -8.645213806299
E1      =    19.092857029659
E2      =    -7.875743685673
E3      =   -11.101641275611
Exc     =    -9.852734593344
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 2.144e-05, dEband = 4.543e-03
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -30.959551217, dEtot = 2.144e-05, dEband = 4.543e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4660440252126, which took 0.074 ms

iter_count = 108, r_2norm = 1.663e-05, tol*||rhs|| = 1.864e-05

Anderson update took 57.813 ms, out of which F'*F took 26.946 ms; b-Ax took 181.189 ms, out of which Lap took 162.644 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.091 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912248, int_b + int_rho = 1.710e-13, checking this took 0.132 ms
2-norm of RHS = 628.2937722871940, which took 0.104 ms

iter_count = 240, r_2norm = 6.097e-04, tol*||rhs|| = 6.283e-04

Anderson update took 128.819 ms, out of which F'*F took 59.749 ms; b-Ax took 403.991 ms, out of which Lap took 362.524 ms
Solving Poisson took 862.174 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.107964 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.008 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.595 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.096083 
Total time for convolution: 	 convolve: 5.086679 
Total time for convolution: 	 convolve: 5.086746 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 0.979 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.355 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.355 ms

This SCF took 27115.539 ms, scf error = 3.347e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.134426, lowerbound = -0.969731, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1164.165 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 11.704 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.884 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.608 ms
rank =  0, finding HY took 19.561 ms
rank =  0, distributing HY into block cyclic form took 11.879 ms
rank =  0, finding Y'*HY took 4.404 ms
Rank 0, Project_Hamiltonian used 50.487 ms
Total time for projection: 51.067 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.967173040854043
    last  calculated eigval = 0.032376017532679
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96717304085404
lambda[   2] =  -0.68522889382420
lambda[   3] =  -0.52306734449596
lambda[   4] =  -0.42841595292288
lambda[   5] =  -0.40208212972844
lambda[   6] =  -0.38861943093529
lambda[   7] =  -0.35413112193685
lambda[   8] =  -0.33208287897791
lambda[   9] =  -0.21497943998359
lambda[  10] =  -0.07000595156926
lambda[  11] =  -0.03152331326288
lambda[  12] =   0.00947214975544
lambda[  13] =   0.01406316680151
lambda[  14] =   0.02362984393177
lambda[  15] =   0.03237601753268
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.181 ms
rank =  0, subspace rotation using ScaLAPACK took 3.548 ms
rank =  0, Distributing orbital back into band + domain format took 11.799 ms
rank = 0, Subspace_Rotation used 15.360 ms

Total time for subspace rotation: 15.365 ms
rank = 0, Efermi =  -0.099212617730 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.898 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.434 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.148 ms
rank = 0, Calculating density took 1237.911 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
rank = 0, D2D took 1.108 ms
rank = 0, Transfering density took 1.116 ms
Etot    =   -30.959413271839
Eband   =    -8.591560468657
E1      =    19.068560592665
E2      =    -7.843498665921
E3      =   -11.111517059760
Exc     =    -9.859584313456
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 1.971e-05, dEband = 7.665e-03
rank = 0, Calculating/Estimating energy took 0.900 ms, Etot = -30.959413272, dEtot = 1.971e-05, dEband = 7.665e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1734751110387, which took 0.089 ms

iter_count = 114, r_2norm = 4.563e-06, tol*||rhs|| = 6.939e-06

Anderson update took 60.986 ms, out of which F'*F took 28.368 ms; b-Ax took 190.897 ms, out of which Lap took 171.337 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.594 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912241, int_b + int_rho = 9.459e-14, checking this took 0.092 ms
2-norm of RHS = 628.3200581053806, which took 0.065 ms

iter_count = 234, r_2norm = 5.400e-04, tol*||rhs|| = 6.283e-04

Anderson update took 125.365 ms, out of which F'*F took 58.254 ms; b-Ax took 391.809 ms, out of which Lap took 352.189 ms
Solving Poisson took 835.596 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.089164 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.100068 
Total time for convolution: 	 convolve: 5.098681 
Total time for convolution: 	 convolve: 5.098293 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.963 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.693 ms

This SCF took 26864.920 ms, scf error = 1.683e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.132376, lowerbound = -0.967173, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1172.991 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.024 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.380 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.424 ms
rank =  0, finding HY took 19.502 ms
rank =  0, distributing HY into block cyclic form took 11.979 ms
rank =  0, finding Y'*HY took 4.250 ms
Rank 0, Project_Hamiltonian used 51.185 ms
Total time for projection: 51.200 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.964360178557809
    last  calculated eigval = 0.031358594695512
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96436017855781
lambda[   2] =  -0.68262186196052
lambda[   3] =  -0.52062695870498
lambda[   4] =  -0.42579265957992
lambda[   5] =  -0.39967951085426
lambda[   6] =  -0.38583490460904
lambda[   7] =  -0.35159450706000
lambda[   8] =  -0.32960714533682
lambda[   9] =  -0.21243607627540
lambda[  10] =  -0.06763780672876
lambda[  11] =  -0.02948621993563
lambda[  12] =   0.01172102163641
lambda[  13] =   0.01606286714271
lambda[  14] =   0.02484136438578
lambda[  15] =   0.03135859469551
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 3.567 ms
rank =  0, Distributing orbital back into band + domain format took 11.918 ms
rank = 0, Subspace_Rotation used 15.498 ms

Total time for subspace rotation: 15.503 ms
rank = 0, Efermi =  -0.096844472825 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 3.014 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.346 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.165 ms
rank = 0, Calculating density took 1246.526 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.582 ms
rank = 0, D2D took 0.824 ms
rank = 0, Transfering density took 0.832 ms
Etot    =   -30.959442688024
Eband   =    -8.545107607171
E1      =    19.044000621429
E2      =    -7.819946092621
E3      =   -11.117823335612
Exc     =    -9.864260322443
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 4.202e-06, dEband = 6.636e-03
rank = 0, Calculating/Estimating energy took 0.987 ms, Etot = -30.959442688, dEtot = 4.202e-06, dEband = 6.636e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1210456207068, which took 0.096 ms

iter_count = 114, r_2norm = 3.380e-06, tol*||rhs|| = 4.842e-06

Anderson update took 60.867 ms, out of which F'*F took 28.393 ms; b-Ax took 191.357 ms, out of which Lap took 171.621 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.136 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912242, int_b + int_rho = 1.091e-13, checking this took 0.100 ms
2-norm of RHS = 628.3333472185343, which took 0.120 ms

iter_count = 210, r_2norm = 5.745e-04, tol*||rhs|| = 6.283e-04

Anderson update took 112.392 ms, out of which F'*F took 52.617 ms; b-Ax took 352.801 ms, out of which Lap took 316.743 ms
Solving Poisson took 751.977 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.407 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.099028 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 37.742 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.086516 
Total time for convolution: 	 convolve: 5.088177 
Total time for convolution: 	 convolve: 5.114063 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.834 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.039 ms
---Transfer Veff_loc: D2D took 1.762 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.119 ms

This SCF took 26832.870 ms, scf error = 8.725e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.131359, lowerbound = -0.964360, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1161.874 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.994 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.297 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.135 ms
rank =  0, Distribute data + matrix mult took 15.440 ms
rank =  0, finding HY took 19.460 ms
rank =  0, distributing HY into block cyclic form took 11.945 ms
rank =  0, finding Y'*HY took 4.312 ms
Rank 0, Project_Hamiltonian used 51.185 ms
Total time for projection: 51.200 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -0.963473605900464
    last  calculated eigval = 0.031055621538582
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96347360590046
lambda[   2] =  -0.68177657489161
lambda[   3] =  -0.51979518262683
lambda[   4] =  -0.42492099481716
lambda[   5] =  -0.39880621448855
lambda[   6] =  -0.38495567759109
lambda[   7] =  -0.35068417478125
lambda[   8] =  -0.32869409057334
lambda[   9] =  -0.21153190135837
lambda[  10] =  -0.06675432041924
lambda[  11] =  -0.02735990719191
lambda[  12] =   0.01350906752400
lambda[  13] =   0.01844293752001
lambda[  14] =   0.02593697133262
lambda[  15] =   0.03105562153858
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 3.566 ms
rank =  0, Distributing orbital back into band + domain format took 11.846 ms
rank = 0, Subspace_Rotation used 15.425 ms

Total time for subspace rotation: 15.430 ms
rank = 0, Efermi =  -0.095960986512 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.997 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.353 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.159 ms
rank = 0, Calculating density took 1235.327 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
rank = 0, D2D took 1.007 ms
rank = 0, Transfering density took 1.015 ms
Etot    =   -30.959479070578
Eband   =    -8.529276835334
E1      =    19.037463951251
E2      =    -7.810452415725
E3      =   -11.118462855128
Exc     =    -9.864736649276
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 5.198e-06, dEband = 2.262e-03
rank = 0, Calculating/Estimating energy took 0.910 ms, Etot = -30.959479071, dEtot = 5.198e-06, dEband = 2.262e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0781040985551, which took 0.054 ms

iter_count = 114, r_2norm = 1.951e-06, tol*||rhs|| = 3.124e-06

Anderson update took 60.994 ms, out of which F'*F took 28.367 ms; b-Ax took 191.124 ms, out of which Lap took 171.403 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.484 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912252, int_b + int_rho = 2.037e-13, checking this took 0.093 ms
2-norm of RHS = 628.3133695615145, which took 0.094 ms

iter_count = 198, r_2norm = 5.658e-04, tol*||rhs|| = 6.283e-04

Anderson update took 106.295 ms, out of which F'*F took 49.350 ms; b-Ax took 331.340 ms, out of which Lap took 297.930 ms
Solving Poisson took 707.738 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.099283 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.171 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.135780 
Total time for convolution: 	 convolve: 5.090658 
Total time for convolution: 	 convolve: 5.091303 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.618 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.958 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.327 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.304 ms

This SCF took 26785.630 ms, scf error = 5.764e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.131056, lowerbound = -0.963474, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1162.103 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.063 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.333 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.139 ms
rank =  0, Distribute data + matrix mult took 15.550 ms
rank =  0, finding HY took 19.385 ms
rank =  0, distributing HY into block cyclic form took 11.965 ms
rank =  0, finding Y'*HY took 4.299 ms
Rank 0, Project_Hamiltonian used 51.230 ms
Total time for projection: 51.240 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -0.962706509361062
    last  calculated eigval = 0.031762740964249
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96270650936106
lambda[   2] =  -0.68094611026525
lambda[   3] =  -0.51901344820457
lambda[   4] =  -0.42412855401509
lambda[   5] =  -0.39802298702852
lambda[   6] =  -0.38415851648826
lambda[   7] =  -0.34986432906070
lambda[   8] =  -0.32794280313555
lambda[   9] =  -0.21077239560164
lambda[  10] =  -0.06598140165603
lambda[  11] =  -0.02498844377164
lambda[  12] =   0.01542152456331
lambda[  13] =   0.02101842564324
lambda[  14] =   0.02694361790717
lambda[  15] =   0.03176274096425
==subpsace eigenproblem: bcast eigvals took 0.053 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 3.539 ms
rank =  0, Distributing orbital back into band + domain format took 11.788 ms
rank = 0, Subspace_Rotation used 15.342 ms

Total time for subspace rotation: 15.348 ms
rank = 0, Efermi =  -0.095188067818 calculate fermi energy took 0.069 ms
rank = 0, --- Calculate rho: sum over local bands took 2.964 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.432 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.190 ms
rank = 0, Calculating density took 1235.629 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
rank = 0, D2D took 0.839 ms
rank = 0, Transfering density took 0.847 ms
Etot    =   -30.959491236820
Eband   =    -8.515111307583
E1      =    19.029740329519
E2      =    -7.803706686881
E3      =   -11.120042752705
Exc     =    -9.866024890269
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 1.738e-06, dEband = 2.024e-03
rank = 0, Calculating/Estimating energy took 0.967 ms, Etot = -30.959491237, dEtot = 1.738e-06, dEband = 2.024e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0543525341547, which took 0.046 ms

iter_count = 108, r_2norm = 1.920e-06, tol*||rhs|| = 2.174e-06

Anderson update took 57.726 ms, out of which F'*F took 26.960 ms; b-Ax took 180.814 ms, out of which Lap took 162.345 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.538 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912241, int_b + int_rho = 9.459e-14, checking this took 0.132 ms
2-norm of RHS = 628.3203315212377, which took 0.127 ms

iter_count = 192, r_2norm = 5.717e-04, tol*||rhs|| = 6.283e-04

Anderson update took 102.909 ms, out of which F'*F took 47.986 ms; b-Ax took 321.101 ms, out of which Lap took 288.705 ms
Solving Poisson took 686.118 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.149568 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.088002 
Total time for convolution: 	 convolve: 5.088279 
Total time for convolution: 	 convolve: 5.127362 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.944 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.327 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.292 ms

This SCF took 26763.080 ms, scf error = 3.839e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.131763, lowerbound = -0.962707, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1168.703 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.059 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.332 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.076 ms
rank =  0, Distribute data + matrix mult took 15.480 ms
rank =  0, finding HY took 19.455 ms
rank =  0, distributing HY into block cyclic form took 11.938 ms
rank =  0, finding Y'*HY took 4.333 ms
Rank 0, Project_Hamiltonian used 51.237 ms
Total time for projection: 51.250 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.961955511398547
    last  calculated eigval = 0.033754708136839
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96195551139855
lambda[   2] =  -0.68015202808705
lambda[   3] =  -0.51827220398995
lambda[   4] =  -0.42337206161137
lambda[   5] =  -0.39727721758932
lambda[   6] =  -0.38338228622944
lambda[   7] =  -0.34910747799304
lambda[   8] =  -0.32720065139306
lambda[   9] =  -0.21003649554349
lambda[  10] =  -0.06521723359427
lambda[  11] =  -0.02188889359272
lambda[  12] =   0.01722208634291
lambda[  13] =   0.02387228133574
lambda[  14] =   0.02952825413384
lambda[  15] =   0.03375470813684
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 3.562 ms
rank =  0, Distributing orbital back into band + domain format took 11.934 ms
rank = 0, Subspace_Rotation used 15.510 ms

Total time for subspace rotation: 15.514 ms
rank = 0, Efermi =  -0.094423899717 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 3.060 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.286 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.168 ms
rank = 0, Calculating density took 1242.291 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.589 ms
rank = 0, D2D took 0.889 ms
rank = 0, Transfering density took 0.899 ms
Etot    =   -30.959561586726
Eband   =    -8.501511868918
E1      =    19.022691095986
E2      =    -7.796859317636
E3      =   -11.121315162812
Exc     =    -9.867070486170
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 1.005e-05, dEband = 1.943e-03
rank = 0, Calculating/Estimating energy took 1.452 ms, Etot = -30.959561587, dEtot = 1.005e-05, dEband = 1.943e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0474466631777, which took 0.046 ms

iter_count = 108, r_2norm = 1.727e-06, tol*||rhs|| = 1.898e-06

Anderson update took 57.563 ms, out of which F'*F took 27.054 ms; b-Ax took 181.209 ms, out of which Lap took 162.339 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.182 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912252, int_b + int_rho = 2.074e-13, checking this took 0.115 ms
2-norm of RHS = 628.3255392139303, which took 0.130 ms

iter_count = 150, r_2norm = 5.872e-04, tol*||rhs|| = 6.283e-04

Anderson update took 80.134 ms, out of which F'*F took 37.592 ms; b-Ax took 251.768 ms, out of which Lap took 225.928 ms
Solving Poisson took 537.241 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.098682 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.086171 
Total time for convolution: 	 convolve: 5.120420 
Total time for convolution: 	 convolve: 5.129912 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.744 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.957 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.312 ms

This SCF took 26595.746 ms, scf error = 2.142e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.133755, lowerbound = -0.961956, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1173.856 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.317 ms
rank =  0, Distribute orbital to block cyclic format took 11.810 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.266 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.098 ms
rank =  0, finding HY took 19.547 ms
rank =  0, distributing HY into block cyclic form took 12.023 ms
rank =  0, finding Y'*HY took 4.156 ms
Rank 0, Project_Hamiltonian used 51.167 ms
Total time for projection: 51.181 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.961858766163779
    last  calculated eigval = 0.034119335980761
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96185876616378
lambda[   2] =  -0.68004207428685
lambda[   3] =  -0.51815691288015
lambda[   4] =  -0.42326492892542
lambda[   5] =  -0.39716428881277
lambda[   6] =  -0.38328389251128
lambda[   7] =  -0.34899883676717
lambda[   8] =  -0.32709271663782
lambda[   9] =  -0.20994032574546
lambda[  10] =  -0.06510019662354
lambda[  11] =  -0.02093389219540
lambda[  12] =   0.01748750344213
lambda[  13] =   0.02450825930760
lambda[  14] =   0.03053869911442
lambda[  15] =   0.03411933598076
==subpsace eigenproblem: bcast eigvals took 0.065 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 3.542 ms
rank =  0, Distributing orbital back into band + domain format took 11.878 ms
rank = 0, Subspace_Rotation used 15.434 ms

Total time for subspace rotation: 15.440 ms
rank = 0, Efermi =  -0.094306862820 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.993 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.292 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.157 ms
rank = 0, Calculating density took 1247.254 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.588 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.188 ms
rank = 0, D2D took 1.308 ms
rank = 0, Transfering density took 1.314 ms
Etot    =   -30.959586729309
Eband   =    -8.499605486706
E1      =    19.021963014739
E2      =    -7.795672640777
E3      =   -11.121285188752
Exc     =    -9.867057278799
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 3.592e-06, dEband = 2.723e-04
rank = 0, Calculating/Estimating energy took 0.899 ms, Etot = -30.959586729, dEtot = 3.592e-06, dEband = 2.723e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0337835868318, which took 0.107 ms

iter_count = 114, r_2norm = 8.595e-07, tol*||rhs|| = 1.351e-06

Anderson update took 60.853 ms, out of which F'*F took 28.296 ms; b-Ax took 190.893 ms, out of which Lap took 171.118 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.465 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912253, int_b + int_rho = 2.183e-13, checking this took 0.106 ms
2-norm of RHS = 628.3275964475569, which took 0.111 ms

iter_count = 150, r_2norm = 6.058e-04, tol*||rhs|| = 6.283e-04

Anderson update took 80.343 ms, out of which F'*F took 37.551 ms; b-Ax took 251.503 ms, out of which Lap took 225.995 ms
Solving Poisson took 537.089 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.104326 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.636 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.094436 
Total time for convolution: 	 convolve: 5.102573 
Total time for convolution: 	 convolve: 5.107646 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.405 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.363 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
---Transfer Veff_loc: D2D took 0.967 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.344 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.333 ms

This SCF took 26628.884 ms, scf error = 1.854e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134119, lowerbound = -0.961859, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1164.450 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.990 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.380 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.108 ms
rank =  0, Distribute data + matrix mult took 15.491 ms
rank =  0, finding HY took 19.606 ms
rank =  0, distributing HY into block cyclic form took 11.947 ms
rank =  0, finding Y'*HY took 4.335 ms
Rank 0, Project_Hamiltonian used 51.409 ms
Total time for projection: 51.421 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.961696948457240
    last  calculated eigval = 0.033489276175603
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96169694845724
lambda[   2] =  -0.67989908414213
lambda[   3] =  -0.51800858074373
lambda[   4] =  -0.42311824288156
lambda[   5] =  -0.39702067225046
lambda[   6] =  -0.38313682672827
lambda[   7] =  -0.34886091470759
lambda[   8] =  -0.32694317580421
lambda[   9] =  -0.20979800111422
lambda[  10] =  -0.06497803021671
lambda[  11] =  -0.02079142226897
lambda[  12] =   0.01716135716307
lambda[  13] =   0.02434256311019
lambda[  14] =   0.03116554311968
lambda[  15] =   0.03348927617560
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 3.566 ms
rank =  0, Distributing orbital back into band + domain format took 11.903 ms
rank = 0, Subspace_Rotation used 15.483 ms

Total time for subspace rotation: 15.899 ms
rank = 0, Efermi =  -0.094184696423 calculate fermi energy took 0.622 ms
rank = 0, --- Calculate rho: sum over local bands took 3.141 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.439 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.158 ms
rank = 0, Calculating density took 1238.379 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
rank = 0, D2D took 0.966 ms
rank = 0, Transfering density took 0.973 ms
Etot    =   -30.959623154347
Eband   =    -8.496964894901
E1      =    19.020724840494
E2      =    -7.794228895578
E3      =   -11.121333296505
Exc     =    -9.867100483949
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 5.204e-06, dEband = 3.772e-04
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -30.959623154, dEtot = 5.204e-06, dEband = 3.772e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0248133758484, which took 0.074 ms

iter_count = 114, r_2norm = 6.776e-07, tol*||rhs|| = 9.925e-07

Anderson update took 60.871 ms, out of which F'*F took 28.343 ms; b-Ax took 190.984 ms, out of which Lap took 171.344 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.200 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912245, int_b + int_rho = 1.382e-13, checking this took 0.110 ms
2-norm of RHS = 628.3286533734048, which took 0.118 ms

iter_count = 138, r_2norm = 6.154e-04, tol*||rhs|| = 6.283e-04

Anderson update took 73.838 ms, out of which F'*F took 34.450 ms; b-Ax took 231.393 ms, out of which Lap took 207.741 ms
Solving Poisson took 494.524 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.105538 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.095910 
Total time for convolution: 	 convolve: 5.089142 
Total time for convolution: 	 convolve: 5.090262 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.320 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.473 ms
---Transfer Veff_loc: D2D took 0.928 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.325 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.273 ms

This SCF took 26521.026 ms, scf error = 1.452e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133489, lowerbound = -0.961697, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1161.348 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 11.999 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.376 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.396 ms
rank =  0, finding HY took 19.373 ms
rank =  0, distributing HY into block cyclic form took 11.877 ms
rank =  0, finding Y'*HY took 4.271 ms
Rank 0, Project_Hamiltonian used 50.941 ms
Total time for projection: 50.956 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.961583165530161
    last  calculated eigval = 0.033529036721148
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96158316553016
lambda[   2] =  -0.67979419047240
lambda[   3] =  -0.51789982234728
lambda[   4] =  -0.42301150958160
lambda[   5] =  -0.39691496921399
lambda[   6] =  -0.38303194556661
lambda[   7] =  -0.34875770629545
lambda[   8] =  -0.32683647453874
lambda[   9] =  -0.20969663391066
lambda[  10] =  -0.06489378682888
lambda[  11] =  -0.02024293271791
lambda[  12] =   0.01723495003562
lambda[  13] =   0.02450689554023
lambda[  14] =   0.03238620773588
lambda[  15] =   0.03352903672115
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 3.350 ms
rank =  0, Distributing orbital back into band + domain format took 12.532 ms
rank = 0, Subspace_Rotation used 15.896 ms

Total time for subspace rotation: 15.902 ms
rank = 0, Efermi =  -0.094100452880 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 3.122 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.217 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.166 ms
rank = 0, Calculating density took 1235.015 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.678 ms
rank = 0, D2D took 0.794 ms
rank = 0, Transfering density took 0.796 ms
Etot    =   -30.959643236550
Eband   =    -8.495052836155
E1      =    19.019829458490
E2      =    -7.793181037839
E3      =   -11.121382117783
Exc     =    -9.867138206435
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 2.869e-06, dEband = 2.732e-04
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -30.959643237, dEtot = 2.869e-06, dEband = 2.732e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0226377702089, which took 0.048 ms

iter_count = 114, r_2norm = 5.532e-07, tol*||rhs|| = 9.055e-07

Anderson update took 60.998 ms, out of which F'*F took 28.303 ms; b-Ax took 191.067 ms, out of which Lap took 171.359 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.979 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912253, int_b + int_rho = 2.219e-13, checking this took 0.101 ms
2-norm of RHS = 628.3314189991559, which took 0.093 ms

iter_count = 126, r_2norm = 5.440e-04, tol*||rhs|| = 6.283e-04

Anderson update took 67.445 ms, out of which F'*F took 31.390 ms; b-Ax took 210.798 ms, out of which Lap took 189.464 ms
Solving Poisson took 451.293 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.099012 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.095968 
Total time for convolution: 	 convolve: 5.089632 
Total time for convolution: 	 convolve: 5.096619 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.959 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.339 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.321 ms

This SCF took 26553.566 ms, scf error = 1.231e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.133529, lowerbound = -0.961583, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1193.953 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.971 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.342 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.018 ms
rank =  0, Distribute data + matrix mult took 15.345 ms
rank =  0, finding HY took 19.520 ms
rank =  0, distributing HY into block cyclic form took 11.882 ms
rank =  0, finding Y'*HY took 4.399 ms
Rank 0, Project_Hamiltonian used 51.174 ms
Total time for projection: 51.191 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -0.961527150399492
    last  calculated eigval = 0.033974835639544
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96152715039949
lambda[   2] =  -0.67971775441034
lambda[   3] =  -0.51782790797662
lambda[   4] =  -0.42294003938097
lambda[   5] =  -0.39684112196252
lambda[   6] =  -0.38296143570132
lambda[   7] =  -0.34867816032809
lambda[   8] =  -0.32676857852868
lambda[   9] =  -0.20963187191945
lambda[  10] =  -0.06483903502989
lambda[  11] =  -0.01987420512541
lambda[  12] =   0.01709153703522
lambda[  13] =   0.02491978312013
lambda[  14] =   0.03293367400467
lambda[  15] =   0.03397483563954
==subpsace eigenproblem: bcast eigvals took 0.035 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 4.049 ms
rank =  0, Distributing orbital back into band + domain format took 11.548 ms
rank = 0, Subspace_Rotation used 15.616 ms

Total time for subspace rotation: 15.625 ms
rank = 0, Efermi =  -0.094045701183 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.125 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.077 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.197 ms
rank = 0, Calculating density took 1267.935 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.610 ms
rank = 0, D2D took 0.715 ms
rank = 0, Transfering density took 0.720 ms
Etot    =   -30.959650925074
Eband   =    -8.493788042455
E1      =    19.019306517970
E2      =    -7.792416480079
E3      =   -11.121431181450
Exc     =    -9.867172254046
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 1.098e-06, dEband = 1.807e-04
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -30.959650925, dEtot = 1.098e-06, dEband = 1.807e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0226134076321, which took 0.068 ms

iter_count = 108, r_2norm = 9.024e-07, tol*||rhs|| = 9.045e-07

Anderson update took 57.808 ms, out of which F'*F took 26.787 ms; b-Ax took 180.430 ms, out of which Lap took 162.063 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.157 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912244, int_b + int_rho = 1.237e-13, checking this took 0.100 ms
2-norm of RHS = 628.3314798046956, which took 0.073 ms

iter_count = 6, r_2norm = 4.968e-04, tol*||rhs|| = 6.283e-04

Anderson update took 3.257 ms, out of which F'*F took 1.501 ms; b-Ax took 10.035 ms, out of which Lap took 9.029 ms
Solving Poisson took 24.677 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.097792 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.092444 
Total time for convolution: 	 convolve: 5.127976 
Total time for convolution: 	 convolve: 5.086647 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.971 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.343 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.343 ms

This SCF took 26084.534 ms, scf error = 1.195e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.133975, lowerbound = -0.961527, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1172.369 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.048 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.329 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.397 ms
rank =  0, finding HY took 19.496 ms
rank =  0, distributing HY into block cyclic form took 11.962 ms
rank =  0, finding Y'*HY took 4.303 ms
Rank 0, Project_Hamiltonian used 51.189 ms
Total time for projection: 51.205 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.872 ms
    first calculated eigval = -0.961527208392777
    last  calculated eigval = 0.033901593418354
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96152720839278
lambda[   2] =  -0.67971775132266
lambda[   3] =  -0.51782791254812
lambda[   4] =  -0.42294003964790
lambda[   5] =  -0.39684107511065
lambda[   6] =  -0.38296145515048
lambda[   7] =  -0.34867812110679
lambda[   8] =  -0.32676855300703
lambda[   9] =  -0.20963185519056
lambda[  10] =  -0.06483884919618
lambda[  11] =  -0.01990471215317
lambda[  12] =   0.01699694828457
lambda[  13] =   0.02484056471990
lambda[  14] =   0.03214082298483
lambda[  15] =   0.03390159341835
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.906 ms
rank =  0, subspace rotation using ScaLAPACK took 3.596 ms
rank =  0, Distributing orbital back into band + domain format took 11.705 ms
rank = 0, Subspace_Rotation used 15.318 ms

Total time for subspace rotation: 15.328 ms
rank = 0, Efermi =  -0.094045515239 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.141 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.277 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.192 ms
rank = 0, Calculating density took 1247.063 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.661 ms
rank = 0, D2D took 0.792 ms
rank = 0, Transfering density took 0.798 ms
Etot    =   -30.959652447686
Eband   =    -8.493787944194
E1      =    19.019307993437
E2      =    -7.792414173321
E3      =   -11.121427126096
Exc     =    -9.867168988275
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 2.175e-07, dEband = 1.404e-08
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -30.959652448, dEtot = 2.175e-07, dEband = 1.404e-08
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0251470795300, which took 0.092 ms

iter_count = 108, r_2norm = 8.755e-07, tol*||rhs|| = 1.006e-06

Anderson update took 57.683 ms, out of which F'*F took 26.769 ms; b-Ax took 180.392 ms, out of which Lap took 161.963 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.996 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912244, int_b + int_rho = 1.310e-13, checking this took 0.110 ms
2-norm of RHS = 628.3339829181531, which took 0.139 ms

iter_count = 48, r_2norm = 6.237e-04, tol*||rhs|| = 6.283e-04

Anderson update took 25.676 ms, out of which F'*F took 11.974 ms; b-Ax took 80.402 ms, out of which Lap took 72.246 ms
Solving Poisson took 174.109 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.093666 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.618 ms
Total time for convolution: 	 convolve: 5.092245 
Total time for convolution: 	 convolve: 6.177265 
Total time for convolution: 	 convolve: 5.092523 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.167 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.934 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.329 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.299 ms

This SCF took 27271.495 ms, scf error = 1.189e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.133902, lowerbound = -0.961527, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1164.224 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.056 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.363 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 15.464 ms
rank =  0, finding HY took 19.454 ms
rank =  0, distributing HY into block cyclic form took 12.460 ms
rank =  0, finding Y'*HY took 3.474 ms
Rank 0, Project_Hamiltonian used 51.434 ms
Total time for projection: 51.446 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -0.961575043047164
    last  calculated eigval = 0.034170624716129
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96157504304716
lambda[   2] =  -0.67974779708645
lambda[   3] =  -0.51785387085878
lambda[   4] =  -0.42297208665100
lambda[   5] =  -0.39686766252623
lambda[   6] =  -0.38299980125367
lambda[   7] =  -0.34870550604451
lambda[   8] =  -0.32680238611550
lambda[   9] =  -0.20967100023140
lambda[  10] =  -0.06486660871612
lambda[  11] =  -0.01972514523507
lambda[  12] =   0.01707404559188
lambda[  13] =   0.02491874224986
lambda[  14] =   0.03167267241114
lambda[  15] =   0.03417062471613
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 3.575 ms
rank =  0, Distributing orbital back into band + domain format took 11.818 ms
rank = 0, Subspace_Rotation used 15.407 ms

Total time for subspace rotation: 15.413 ms
rank = 0, Efermi =  -0.094073274768 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.904 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.444 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.157 ms
rank = 0, Calculating density took 1237.890 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
rank = 0, D2D took 1.048 ms
rank = 0, Transfering density took 1.057 ms
Etot    =   -30.959655985527
Eband   =    -8.494390308870
E1      =    19.019767494936
E2      =    -7.792590517788
E3      =   -11.121256740565
Exc     =    -9.867035621874
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 5.054e-07, dEband = 8.605e-05
rank = 0, Calculating/Estimating energy took 0.903 ms, Etot = -30.959655986, dEtot = 5.054e-07, dEband = 8.605e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0179600324087, which took 0.053 ms

iter_count = 108, r_2norm = 6.297e-07, tol*||rhs|| = 7.184e-07

Anderson update took 57.870 ms, out of which F'*F took 26.826 ms; b-Ax took 181.118 ms, out of which Lap took 162.387 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.667 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912245, int_b + int_rho = 1.382e-13, checking this took 0.108 ms
2-norm of RHS = 628.3266176768050, which took 0.360 ms

iter_count = 132, r_2norm = 5.857e-04, tol*||rhs|| = 6.283e-04

Anderson update took 70.378 ms, out of which F'*F took 32.897 ms; b-Ax took 222.449 ms, out of which Lap took 199.587 ms
Solving Poisson took 473.941 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.111542 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.091596 
Total time for convolution: 	 convolve: 5.091063 
Total time for convolution: 	 convolve: 5.093605 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.947 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.307 ms

This SCF took 26491.229 ms, scf error = 1.601e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.134171, lowerbound = -0.961575, upperbound = 267.577444

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1165.010 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.304 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.914 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.241 ms
rank =  0, finding HY took 19.610 ms
rank =  0, distributing HY into block cyclic form took 11.854 ms
rank =  0, finding Y'*HY took 4.417 ms
Rank 0, Project_Hamiltonian used 51.677 ms
Total time for projection: 51.688 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -0.961424465150733
    last  calculated eigval = 0.033875089485048
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96142446515073
lambda[   2] =  -0.67965696412840
lambda[   3] =  -0.51775746861949
lambda[   4] =  -0.42287114245238
lambda[   5] =  -0.39677854932596
lambda[   6] =  -0.38289294015770
lambda[   7] =  -0.34862377049371
lambda[   8] =  -0.32669445382281
lambda[   9] =  -0.20955446959962
lambda[  10] =  -0.06477991878980
lambda[  11] =  -0.02007949635198
lambda[  12] =   0.01654825016793
lambda[  13] =   0.02490325871046
lambda[  14] =   0.03079793567732
lambda[  15] =   0.03387508948505
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 3.559 ms
rank =  0, Distributing orbital back into band + domain format took 11.909 ms
rank = 0, Subspace_Rotation used 15.482 ms

Total time for subspace rotation: 15.488 ms
rank = 0, Efermi =  -0.093986584986 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.012 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.346 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.167 ms
rank = 0, Calculating density took 1239.004 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.582 ms
rank = 0, D2D took 0.888 ms
rank = 0, Transfering density took 0.897 ms
Etot    =   -30.959658206064
Eband   =    -8.492508448740
E1      =    19.018462499852
E2      =    -7.791942866903
E3      =   -11.121592866301
Exc     =    -9.867303182308
Esc     =   -50.531844807497
Entropy =    -0.000000000575
dE = 3.172e-07, dEband = 2.688e-04
rank = 0, Calculating/Estimating energy took 0.961 ms, Etot = -30.959658206, dEtot = 3.172e-07, dEband = 2.688e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0195504663783, which took 0.072 ms

iter_count = 108, r_2norm = 5.614e-07, tol*||rhs|| = 7.820e-07

Anderson update took 57.853 ms, out of which F'*F took 26.886 ms; b-Ax took 180.916 ms, out of which Lap took 162.003 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.674 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001912231, int_rho =  18.00000001912241, int_b + int_rho = 1.019e-13, checking this took 0.104 ms
2-norm of RHS = 628.3265992974984, which took 0.091 ms

iter_count = 96, r_2norm = 5.232e-04, tol*||rhs|| = 6.283e-04

Anderson update took 51.407 ms, out of which F'*F took 23.987 ms; b-Ax took 160.967 ms, out of which Lap took 144.679 ms
Solving Poisson took 344.921 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.117 ms
Total time for convolution: 	 convolve: 5.098567 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.089339 
Total time for convolution: 	 convolve: 5.090903 
Total time for convolution: 	 convolve: 5.091841 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 0.957 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.338 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.316 ms

This SCF took 26337.992 ms, scf error = 7.775e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.96142446515073, occ[   1] =   2.00000000000000
lambda[   2] =  -0.67965696412840, occ[   2] =   2.00000000000000
lambda[   3] =  -0.51775746861949, occ[   3] =   2.00000000000000
lambda[   4] =  -0.42287114245238, occ[   4] =   2.00000000000000
lambda[   5] =  -0.39677854932596, occ[   5] =   2.00000000000000
lambda[   6] =  -0.38289294015770, occ[   6] =   2.00000000000000
lambda[   7] =  -0.34862377049371, occ[   7] =   2.00000000000000
lambda[   8] =  -0.32669445382281, occ[   8] =   2.00000000000000
lambda[   9] =  -0.20955446959962, occ[   9] =   2.00000000000000
lambda[  10] =  -0.06477991878980, occ[  10] =   0.00000001912245
lambda[  11] =  -0.02007949635198, occ[  11] =   0.00000000000000
lambda[  12] =   0.01654825016793, occ[  12] =   0.00000000000000
lambda[  13] =   0.02490325871046, occ[  13] =   0.00000000000000
lambda[  14] =   0.03079793567732, occ[  14] =   0.00000000000000
lambda[  15] =   0.03387508948505, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.426 ms, time for Allreduce/Reduce: 7.726 ms 
Time for calculating local force components: 15.995 ms
Start Calculating nonlocal forces
force_nloc = 
 -1.19370988330630   0.05918682642818  -0.00000040508679
  0.02152768931242  -0.04267350875055  -0.00000012086970
 -0.02646699220853   0.04286940935601  -0.00000019278099
  0.02923497932914  -0.00122853813090  -0.03895307256011
  0.02923506068721  -0.00122842258679   0.03895262032721
  0.11594653088115  -0.01939106267735   0.00000266310146
 -0.02071110643018   0.02059451185537  -0.00000513050187
force_loc = 
  1.17831710264984  -0.05780639028908  -0.00000004808605
 -0.02205834936047   0.04590022687976   0.00000427107553
  0.02648807450192  -0.04426635331681   0.00000184874565
 -0.03010357949164   0.00162069208571   0.03972969741007
 -0.03009597454768   0.00161719773669  -0.03970040016024
 -0.13446047059328   0.01672062390137   0.00000291985664
  0.02187508819746  -0.02045894558474   0.00000165772913
Time for calculating nonlocal force components: 27.188 ms
[32mforces_xc: 
[0m[32m  0.02771170246346  -0.00135926941439   0.00000015202254
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00671557076108   0.00047617791106  -0.00000035492782
[0m[32m  0.00066185384588  -0.00069448286002  -0.00000054663491
[0mTime for calculating XC forces components: 22.064 ms
 Cartesian force = 
  0.01230359370822   0.00003849636135  -0.00000538095883
 -0.00054598814684   0.00324404776585  -0.00000092960271
  0.00000575419461  -0.00137961432415  -0.00000342384387
 -0.00088392826128   0.00040948359144   0.00077154504143
 -0.00087624195926   0.00040610478653  -0.00075285964156
 -0.01181369704983  -0.00217693122828   0.00000014822174
  0.00181050751438  -0.00054158695275  -0.00000909921619
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.096 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Time for printing density: 1094.295 ms
The program took 515.190 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:25
Job ID:        2266461
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:46:00,vmem=8316K,walltime=00:08:50,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-12-1
---------------------------------------
