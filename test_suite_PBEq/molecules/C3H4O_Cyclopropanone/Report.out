---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:26
Job ID:    2266716
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:32
Job ID:    2266716
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.092 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 12.803 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 8.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 33.348 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 60.398 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.966 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.087 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   12.591554	
   11.725433	   12.438319	    7.408446	
    8.274567	   12.438319	    7.408446	
    8.274567	    7.561681	    7.408446	
   11.725433	    7.561681	    7.408446	
   10.000000	   10.000000	   10.334089	
   10.000000	   11.483650	    7.980940	
   10.000000	    8.516350	    7.980940	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.165 ms
Set up communicators.

--set up spincomm took 3.790 ms

--set up kptcomm took 0.357 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 2}
gridsizes = [100, 100, 100], Nstates = 18, dmcomm dims = [1, 1, 2]

--set up dmcomm took 0.005 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 6, ScaLAPACK topology Dims = (6, 1)
nproc = 12, size_blacscomm = 6 = dims[0] * dims[1] = (6, 1)
Nd_blacscomm 500000, Nstates 18 
rank =  0, my blacs rank = 0, BLCYC size (500000, 3), actual size (500000, 3)
rank = 0, mb = nb = 18, mbQ = nbQ = 64
rank = 0, nr_Hp = 18, nc_Hp = 18
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.086 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 6
# of bands per bandcomm          : 3
npdomain: 2
Embeded Cartesian topology dims: (1,1,2)
# of FD-grid points per processor: 500000 = (100,100,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.678 ms

Calculate_SplineDerivRadFun took 0.212 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.786 ms.
time spent on vectorized spline interp: 3.641 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.763 ms.
time spent on vectorized spline interp: 1.590 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.302 ms.
time spent on vectorized spline interp: 1.761 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.533 ms.

Calculating rb for all atom types took 16.384 ms
----------------------
Estimated memory usage
Total: 1.11 GB
orbitals             : 823.97 MB
global sized vectors : 213.62 MB
subspace matrices : 15.19 kB
others : 103.76 MB
----------------------------------------------
Estimated memory usage per processor: 95.11 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.053 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -22.0000000202157, sum_int_rho = 21.5910632948438
PosCharge = 22.000000020216, NegCharge = -21.591063294844, scal_fac = 1.018940092009
After scaling, int_rho = 22.0000000202158, PosCharge + NegCharge - NetCharge = -2.842e-14
--Calculate Vref took 0.602 ms
--Calculate rho_guess took 3.425 ms

 integral of b = -22.0000000202157,
 int{b} + Nelectron + NetCharge = -2.022e-08,
 Esc = -60.8825461634912,
 MPI_Reduce took 4.483 ms

Calculating b & b_ref took 16.060 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.075 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.085 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.036 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.313 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.005 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.006 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.006 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 34.171 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021572, int_b + int_rho = -3.129e-13, checking this took 0.326 ms
2-norm of RHS = 677.2987369866407, which took 0.072 ms

iter_count = 420, r_2norm = 6.197e-04, tol*||rhs|| = 6.773e-04

Anderson update took 257.170 ms, out of which F'*F took 115.625 ms; b-Ax took 785.044 ms, out of which Lap took 699.900 ms
Solving Poisson took 1730.580 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.410 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.832 ms
Total time for convolution: 	 convolve: 5.138896 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
Total time for convolution: 	 convolve: 5.148240 
Total time for convolution: 	 convolve: 5.301338 
Total time for convolution: 	 convolve: 5.159909 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 258.162 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.939 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.469 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
rank = 0, XC calculation took 24924.484 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 2.723 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 5.592 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 9.430 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.140 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 2.121 ms
    Lanczos iter 55, eigmin  = -1.009970304, eigmax = 264.940647015, err_eigmin = 1.491e-03, err_eigmax = 9.851e-03
rank =   0, Lanczos took 164.737 ms, eigmin = -1.009970303775, eigmax = 267.590053485445

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.240042, lowerbound = -1.109970, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1713.281 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.243 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.427 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 25.698 ms
rank =  0, finding HY took 30.229 ms
rank =  0, distributing HY into block cyclic form took 18.657 ms
rank =  0, finding Y'*HY took 5.703 ms
Rank 0, Project_Hamiltonian used 80.325 ms
Total time for projection: 80.341 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.398 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.627 ms
rank = 0, Solve_Generalized_EigenProblem used 1.028 ms
    first calculated eigval = 2.749007205131274
    last  calculated eigval = 3.219689987586602
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =   2.78679522408928
lambda[   3] =   2.82077492366253
lambda[   4] =   2.83232859923578
lambda[   5] =   2.87178331844377
lambda[   6] =   2.89112246982575
lambda[   7] =   2.92684650797895
lambda[   8] =   2.94009002337921
lambda[   9] =   2.94503783403628
lambda[  10] =   2.98462571531317
lambda[  11] =   3.03703337492826
lambda[  12] =   3.07352449785074
lambda[  13] =   3.09091351921234
lambda[  14] =   3.11442819735775
lambda[  15] =   3.12149181060530
lambda[  16] =   3.15231645874342
lambda[  17] =   3.19395353866243
lambda[  18] =   3.21968998758660
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 1.041 ms
rank =  0, subspace rotation using ScaLAPACK took 7.608 ms
rank =  0, Distributing orbital back into band + domain format took 17.398 ms
rank = 0, Subspace_Rotation used 25.023 ms

Total time for subspace rotation: 25.027 ms
rank = 0, Efermi =   3.055278967626 calculate fermi energy took 0.076 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.319690, lowerbound = -1.109970, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1698.195 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.042 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.813 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 21.888 ms
rank =  0, finding HY took 28.307 ms
rank =  0, distributing HY into block cyclic form took 18.044 ms
rank =  0, finding Y'*HY took 5.218 ms
Rank 0, Project_Hamiltonian used 73.492 ms
Total time for projection: 73.496 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.848071162131590
    last  calculated eigval = 0.443648123807352
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.76232642833788
lambda[   3] =  -0.41528972712132
lambda[   4] =  -0.23752968608816
lambda[   5] =  -0.16562664188519
lambda[   6] =  -0.09712202588154
lambda[   7] =   0.01323493156684
lambda[   8] =   0.09596772759305
lambda[   9] =   0.12335048426067
lambda[  10] =   0.23975523326196
lambda[  11] =   0.28747098746217
lambda[  12] =   0.30858385079195
lambda[  13] =   0.31957505265291
lambda[  14] =   0.32970123022544
lambda[  15] =   0.37030736776747
lambda[  16] =   0.40931661231002
lambda[  17] =   0.41951080499435
lambda[  18] =   0.44364812380735
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.194 ms
rank =  0, subspace rotation using ScaLAPACK took 7.699 ms
rank =  0, Distributing orbital back into band + domain format took 18.014 ms
rank = 0, Subspace_Rotation used 25.729 ms

Total time for subspace rotation: 25.733 ms
rank = 0, Efermi =   0.298026553419 calculate fermi energy took 0.025 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.543648, lowerbound = -1.109970, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1696.635 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 20.424 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.931 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 24.411 ms
rank =  0, finding HY took 31.652 ms
rank =  0, distributing HY into block cyclic form took 17.972 ms
rank =  0, finding Y'*HY took 5.721 ms
Rank 0, Project_Hamiltonian used 79.794 ms
Total time for projection: 79.798 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.203 ms
    first calculated eigval = -1.040829234311467
    last  calculated eigval = 0.152179332254492
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.91138032774745
lambda[   3] =  -0.68761232795476
lambda[   4] =  -0.60617479068468
lambda[   5] =  -0.55325487991097
lambda[   6] =  -0.49016788958545
lambda[   7] =  -0.45648891749997
lambda[   8] =  -0.42395411460616
lambda[   9] =  -0.39307341508189
lambda[  10] =  -0.36485079796945
lambda[  11] =  -0.22835342174767
lambda[  12] =  -0.04115286715016
lambda[  13] =   0.06598772463874
lambda[  14] =   0.07677948253249
lambda[  15] =   0.08513899217618
lambda[  16] =   0.10729200189662
lambda[  17] =   0.12371150783954
lambda[  18] =   0.15217933225449
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.211 ms
rank =  0, subspace rotation using ScaLAPACK took 7.957 ms
rank =  0, Distributing orbital back into band + domain format took 17.633 ms
rank = 0, Subspace_Rotation used 25.609 ms

Total time for subspace rotation: 25.613 ms
rank = 0, Efermi =  -0.070309568958 calculate fermi energy took 0.039 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.252179, lowerbound = -1.109970, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1709.633 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.101 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.845 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 21.971 ms
rank =  0, finding HY took 32.974 ms
rank =  0, distributing HY into block cyclic form took 18.032 ms
rank =  0, finding Y'*HY took 5.241 ms
Rank 0, Project_Hamiltonian used 78.263 ms
Total time for projection: 78.277 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.195 ms
    first calculated eigval = -1.041015315824408
    last  calculated eigval = 0.096853764378262
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.91172185396164
lambda[   3] =  -0.68995224038157
lambda[   4] =  -0.61317360227346
lambda[   5] =  -0.55752611673420
lambda[   6] =  -0.49846723897448
lambda[   7] =  -0.46203077736431
lambda[   8] =  -0.45323941729829
lambda[   9] =  -0.40839120513442
lambda[  10] =  -0.39334994822980
lambda[  11] =  -0.28849698172427
lambda[  12] =  -0.11263186685475
lambda[  13] =  -0.01084860115961
lambda[  14] =   0.00595798189617
lambda[  15] =   0.04072008321261
lambda[  16] =   0.04900801298560
lambda[  17] =   0.06692066125798
lambda[  18] =   0.09685376437826
==subpsace eigenproblem: bcast eigvals took 0.039 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 7.474 ms
rank =  0, Distributing orbital back into band + domain format took 15.965 ms
rank = 0, Subspace_Rotation used 23.453 ms

Total time for subspace rotation: 23.459 ms
rank = 0, Efermi =  -0.141788568518 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 3.599 ms
rank = 0, --- Calculate rho: reduce over all band groups took 8.193 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.538 ms
rank = 0, Calculating density took 7410.805 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.244 ms
rank = 0, D2D took 5.466 ms
rank = 0, Transfering density took 5.474 ms
Etot    =   -37.029969480362
Eband   =   -12.634729398079
E1      =    25.067397060588
E2      =   -10.094032558159
E3      =   -12.862211827778
Exc     =   -11.536335364710
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 4.629e+00, dEband = 1.579e+00
rank = 0, Calculating/Estimating energy took 1.339 ms, Etot = -37.029969480, dEtot = 4.629e+00, dEband = 1.579e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 52.4235774821212, which took 0.051 ms

iter_count = 96, r_2norm = 1.566e-03, tol*||rhs|| = 2.097e-03

Anderson update took 66.510 ms, out of which F'*F took 30.740 ms; b-Ax took 187.998 ms, out of which Lap took 169.730 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.857 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021570, int_b + int_rho = -3.274e-13, checking this took 0.140 ms
2-norm of RHS = 673.6424541447954, which took 0.329 ms

iter_count = 288, r_2norm = 5.436e-04, tol*||rhs|| = 6.736e-04

Anderson update took 193.470 ms, out of which F'*F took 78.293 ms; b-Ax took 578.704 ms, out of which Lap took 517.509 ms
Solving Poisson took 1255.295 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.470 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.617 ms
Total time for convolution: 	 convolve: 5.266767 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.575 ms
Total time for convolution: 	 convolve: 5.227760 
Total time for convolution: 	 convolve: 5.318438 
Total time for convolution: 	 convolve: 5.278133 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.750 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.017 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.380 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.840 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 3.190 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.059 ms

This SCF took 34222.001 ms, scf error = 1.641e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.196854, lowerbound = -1.041015, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1683.977 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 18.056 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.681 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 22.762 ms
rank =  0, finding HY took 27.404 ms
rank =  0, distributing HY into block cyclic form took 22.933 ms
rank =  0, finding Y'*HY took 7.989 ms
Rank 0, Project_Hamiltonian used 81.123 ms
Total time for projection: 81.136 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.196 ms
    first calculated eigval = -1.023897578185739
    last  calculated eigval = 0.067778943504475
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.87764117514035
lambda[   3] =  -0.65491058746973
lambda[   4] =  -0.58089547762280
lambda[   5] =  -0.52793276894409
lambda[   6] =  -0.47532450054972
lambda[   7] =  -0.43320377702126
lambda[   8] =  -0.42995346032503
lambda[   9] =  -0.38098051679136
lambda[  10] =  -0.37383999175206
lambda[  11] =  -0.26385063660687
lambda[  12] =  -0.11485276565620
lambda[  13] =  -0.03007456540932
lambda[  14] =  -0.00217406685702
lambda[  15] =   0.01892504400967
lambda[  16] =   0.03000692777474
lambda[  17] =   0.04432674131222
lambda[  18] =   0.06777894350448
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 7.550 ms
rank =  0, Distributing orbital back into band + domain format took 18.856 ms
rank = 0, Subspace_Rotation used 26.425 ms

Total time for subspace rotation: 26.429 ms
rank = 0, Efermi =  -0.144009467339 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.496 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.885 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.366 ms
rank = 0, Calculating density took 1802.851 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.230 ms
rank = 0, D2D took 1.402 ms
rank = 0, Transfering density took 1.409 ms
Etot    =   -36.977442069885
Eband   =   -12.044860943140
E1      =    24.556137204847
E2      =   -10.039221758318
E3      =   -13.014803113602
Exc     =   -11.660197039414
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 6.566e-03, dEband = 7.373e-02
rank = 0, Calculating/Estimating energy took 1.258 ms, Etot = -36.977442070, dEtot = 6.566e-03, dEband = 7.373e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 19.5365544796455, which took 1.505 ms

iter_count = 102, r_2norm = 5.657e-04, tol*||rhs|| = 7.815e-04

Anderson update took 72.436 ms, out of which F'*F took 28.107 ms; b-Ax took 213.902 ms, out of which Lap took 196.140 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.794 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021579, int_b + int_rho = -2.401e-13, checking this took 0.771 ms
2-norm of RHS = 668.8933245145602, which took 0.178 ms

iter_count = 300, r_2norm = 6.304e-04, tol*||rhs|| = 6.689e-04

Anderson update took 206.496 ms, out of which F'*F took 94.836 ms; b-Ax took 598.228 ms, out of which Lap took 535.490 ms
Solving Poisson took 1300.426 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.215783 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.668 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.219272 
Total time for convolution: 	 convolve: 5.240219 
Total time for convolution: 	 convolve: 5.241322 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.656 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.839 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.847 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.714 ms

This SCF took 29132.908 ms, scf error = 1.115e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.167779, lowerbound = -1.023898, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1689.272 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.138 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 8.047 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.004 ms
rank =  0, Distribute data + matrix mult took 26.208 ms
rank =  0, finding HY took 29.146 ms
rank =  0, distributing HY into block cyclic form took 21.169 ms
rank =  0, finding Y'*HY took 4.782 ms
Rank 0, Project_Hamiltonian used 81.338 ms
Total time for projection: 81.350 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.995708112923651
    last  calculated eigval = 0.059753283787127
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81886318155449
lambda[   3] =  -0.59456726419762
lambda[   4] =  -0.52463061377657
lambda[   5] =  -0.47779433857420
lambda[   6] =  -0.43973787411248
lambda[   7] =  -0.39661719251096
lambda[   8] =  -0.37361591430519
lambda[   9] =  -0.35901811811023
lambda[  10] =  -0.31614168738382
lambda[  11] =  -0.22137923350127
lambda[  12] =  -0.09532900377333
lambda[  13] =  -0.03322823807931
lambda[  14] =   0.00540280718445
lambda[  15] =   0.01392726918812
lambda[  16] =   0.02418593917424
lambda[  17] =   0.04348960637846
lambda[  18] =   0.05975328378713
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.194 ms
rank =  0, subspace rotation using ScaLAPACK took 7.689 ms
rank =  0, Distributing orbital back into band + domain format took 17.716 ms
rank = 0, Subspace_Rotation used 25.426 ms

Total time for subspace rotation: 25.432 ms
rank = 0, Efermi =  -0.124485705502 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 4.372 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.959 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.359 ms
rank = 0, Calculating density took 1808.101 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.203 ms
rank = 0, D2D took 1.339 ms
rank = 0, Transfering density took 1.346 ms
Etot    =   -36.932539886461
Eband   =   -11.036147063828
E1      =    23.718154163283
E2      =    -9.857009947268
E3      =   -13.308101202669
Exc     =   -11.897111971755
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 5.613e-03, dEband = 1.261e-01
rank = 0, Calculating/Estimating energy took 1.002 ms, Etot = -36.932539886, dEtot = 5.613e-03, dEband = 1.261e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 8.4627265705992, which took 0.142 ms

iter_count = 102, r_2norm = 2.240e-04, tol*||rhs|| = 3.385e-04

Anderson update took 65.733 ms, out of which F'*F took 32.584 ms; b-Ax took 198.806 ms, out of which Lap took 180.319 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.035 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021582, int_b + int_rho = -2.110e-13, checking this took 0.118 ms
2-norm of RHS = 668.9685774202651, which took 0.140 ms

iter_count = 276, r_2norm = 5.419e-04, tol*||rhs|| = 6.690e-04

Anderson update took 217.964 ms, out of which F'*F took 119.704 ms; b-Ax took 623.349 ms, out of which Lap took 569.140 ms
Solving Poisson took 1279.735 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Total time for convolution: 	 convolve: 5.228128 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.473977 
Total time for convolution: 	 convolve: 5.282854 
Total time for convolution: 	 convolve: 5.223269 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.304 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.177 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 1.851 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.839 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.714 ms

This SCF took 28830.728 ms, scf error = 3.855e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.159753, lowerbound = -0.995708, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1703.006 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.535 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.465 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 22.028 ms
rank =  0, finding HY took 29.513 ms
rank =  0, distributing HY into block cyclic form took 18.178 ms
rank =  0, finding Y'*HY took 5.189 ms
Rank 0, Project_Hamiltonian used 74.951 ms
Total time for projection: 74.966 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.455 ms
rank = 0, Solve_Generalized_EigenProblem used 1.565 ms
    first calculated eigval = -0.985631484504982
    last  calculated eigval = 0.055904660507313
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.80603316211835
lambda[   3] =  -0.58179782755676
lambda[   4] =  -0.51134984488707
lambda[   5] =  -0.46599224320827
lambda[   6] =  -0.43083874430258
lambda[   7] =  -0.38461666384877
lambda[   8] =  -0.36053034593872
lambda[   9] =  -0.35156288819535
lambda[  10] =  -0.30626020446473
lambda[  11] =  -0.21218480591641
lambda[  12] =  -0.08549864945299
lambda[  13] =  -0.03401169481767
lambda[  14] =   0.00505039285023
lambda[  15] =   0.01278777472065
lambda[  16] =   0.01841902488323
lambda[  17] =   0.03799691526421
lambda[  18] =   0.05590466050731
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.610 ms
rank =  0, subspace rotation using ScaLAPACK took 7.680 ms
rank =  0, Distributing orbital back into band + domain format took 17.398 ms
rank = 0, Subspace_Rotation used 25.098 ms

Total time for subspace rotation: 25.103 ms
rank = 0, Efermi =  -0.114655351074 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 3.325 ms
rank = 0, --- Calculate rho: reduce over all band groups took 14.139 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.566 ms
rank = 0, Calculating density took 1822.855 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.171 ms
rank = 0, D2D took 1.284 ms
rank = 0, Transfering density took 1.291 ms
Etot    =   -36.928047826466
Eband   =   -10.793596431612
E1      =    23.561047675719
E2      =    -9.758593530794
E3      =   -13.383297216832
Exc     =   -11.954843654101
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 5.615e-04, dEband = 3.032e-02
rank = 0, Calculating/Estimating energy took 1.220 ms, Etot = -36.928047826, dEtot = 5.615e-04, dEband = 3.032e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.8596434422945, which took 0.065 ms

iter_count = 108, r_2norm = 8.195e-05, tol*||rhs|| = 1.144e-04

Anderson update took 67.089 ms, out of which F'*F took 30.744 ms; b-Ax took 210.305 ms, out of which Lap took 187.275 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.318 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021574, int_b + int_rho = -2.910e-13, checking this took 0.097 ms
2-norm of RHS = 669.2048961605690, which took 0.211 ms

iter_count = 252, r_2norm = 6.657e-04, tol*||rhs|| = 6.692e-04

Anderson update took 150.273 ms, out of which F'*F took 70.696 ms; b-Ax took 486.718 ms, out of which Lap took 429.815 ms
Solving Poisson took 1054.812 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.245694 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.218 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.279682 
Total time for convolution: 	 convolve: 5.327177 
Total time for convolution: 	 convolve: 5.233316 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.731 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 1.861 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.813 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.705 ms

This SCF took 28597.404 ms, scf error = 1.496e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.155905, lowerbound = -0.985631, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1671.662 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 30.057 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.984 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.089 ms
rank =  0, Distribute data + matrix mult took 36.164 ms
rank =  0, finding HY took 27.098 ms
rank =  0, distributing HY into block cyclic form took 18.057 ms
rank =  0, finding Y'*HY took 5.363 ms
Rank 0, Project_Hamiltonian used 86.720 ms
Total time for projection: 86.736 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.212 ms
rank = 0, Solve_Generalized_EigenProblem used 0.351 ms
    first calculated eigval = -0.978698684636775
    last  calculated eigval = 0.052872988313468
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.80064245746661
lambda[   3] =  -0.57588979061543
lambda[   4] =  -0.50522609332671
lambda[   5] =  -0.46048430012550
lambda[   6] =  -0.42404344086433
lambda[   7] =  -0.37832087029891
lambda[   8] =  -0.35435333813935
lambda[   9] =  -0.34583678417548
lambda[  10] =  -0.30133678832347
lambda[  11] =  -0.20612273581566
lambda[  12] =  -0.08031243824439
lambda[  13] =  -0.03399390482526
lambda[  14] =   0.00485187109846
lambda[  15] =   0.01221711192281
lambda[  16] =   0.01557593705132
lambda[  17] =   0.03522327473185
lambda[  18] =   0.05287298831347
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.386 ms
rank =  0, subspace rotation using ScaLAPACK took 7.607 ms
rank =  0, Distributing orbital back into band + domain format took 17.107 ms
rank = 0, Subspace_Rotation used 24.729 ms

Total time for subspace rotation: 24.734 ms
rank = 0, Efermi =  -0.109469139900 calculate fermi energy took 6.428 ms
rank = 0, --- Calculate rho: sum over local bands took 4.887 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.221 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.350 ms
rank = 0, Calculating density took 1800.491 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.220 ms
rank = 0, D2D took 1.398 ms
rank = 0, Transfering density took 1.405 ms
Etot    =   -36.926800743838
Eband   =   -10.661910569200
E1      =    23.486128795819
E2      =    -9.693166349785
E3      =   -13.421515271464
Exc     =   -11.983154427608
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 1.559e-04, dEband = 1.646e-02
rank = 0, Calculating/Estimating energy took 1.185 ms, Etot = -36.926800744, dEtot = 1.559e-04, dEband = 1.646e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.2588778214871, which took 0.420 ms

iter_count = 108, r_2norm = 4.598e-05, tol*||rhs|| = 5.036e-05

Anderson update took 76.855 ms, out of which F'*F took 32.162 ms; b-Ax took 208.813 ms, out of which Lap took 189.439 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 471.544 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021573, int_b + int_rho = -2.983e-13, checking this took 0.555 ms
2-norm of RHS = 669.5791172271863, which took 4.132 ms

iter_count = 240, r_2norm = 5.810e-04, tol*||rhs|| = 6.696e-04

Anderson update took 145.087 ms, out of which F'*F took 65.467 ms; b-Ax took 454.970 ms, out of which Lap took 404.637 ms
Solving Poisson took 1002.657 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.244671 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.256715 
Total time for convolution: 	 convolve: 5.232729 
Total time for convolution: 	 convolve: 5.321434 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.398 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.904 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 2.073 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.816 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 11.274 ms

This SCF took 28706.966 ms, scf error = 7.033e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.152873, lowerbound = -0.978699, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1538.064 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 347.013 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 14.123 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 361.173 ms
rank =  0, finding HY took 26.464 ms
rank =  0, distributing HY into block cyclic form took 69.826 ms
rank =  0, finding Y'*HY took 21.501 ms
Rank 0, Project_Hamiltonian used 479.002 ms
Total time for projection: 479.017 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.197 ms
    first calculated eigval = -0.975725851720286
    last  calculated eigval = 0.050645783773571
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.79825321046053
lambda[   3] =  -0.57324406099541
lambda[   4] =  -0.50255463347491
lambda[   5] =  -0.45797174704230
lambda[   6] =  -0.42093037672340
lambda[   7] =  -0.37552553598625
lambda[   8] =  -0.35163331684790
lambda[   9] =  -0.34301872210610
lambda[  10] =  -0.29886659566355
lambda[  11] =  -0.20331141415564
lambda[  12] =  -0.07789649995781
lambda[  13] =  -0.03372472655840
lambda[  14] =   0.00471053409899
lambda[  15] =   0.01173623734953
lambda[  16] =   0.01471201730338
lambda[  17] =   0.03396415168439
lambda[  18] =   0.05064578377357
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 28.642 ms
rank =  0, Distributing orbital back into band + domain format took 12.693 ms
rank = 0, Subspace_Rotation used 41.353 ms

Total time for subspace rotation: 41.358 ms
rank = 0, Efermi =  -0.107053201660 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 4.505 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.443 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.368 ms
rank = 0, Calculating density took 2070.105 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.016 ms
rank = 0, D2D took 1.153 ms
rank = 0, Transfering density took 1.155 ms
Etot    =   -36.926396592616
Eband   =   -10.602070931927
E1      =    23.463184849170
E2      =    -9.652592530043
E3      =   -13.433780016225
Exc     =   -11.991336892029
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 5.052e-05, dEband = 7.480e-03
rank = 0, Calculating/Estimating energy took 14.057 ms, Etot = -36.926396593, dEtot = 5.052e-05, dEband = 7.480e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5323901887064, which took 12.609 ms

iter_count = 108, r_2norm = 1.886e-05, tol*||rhs|| = 2.130e-05

Anderson update took 324.162 ms, out of which F'*F took 149.497 ms; b-Ax took 668.689 ms, out of which Lap took 653.104 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 1381.268 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021579, int_b + int_rho = -2.365e-13, checking this took 0.417 ms
2-norm of RHS = 669.9853207216003, which took 0.151 ms

iter_count = 246, r_2norm = 6.310e-04, tol*||rhs|| = 6.700e-04

Anderson update took 819.277 ms, out of which F'*F took 314.366 ms; b-Ax took 1532.650 ms, out of which Lap took 1482.538 ms
Solving Poisson took 2962.754 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.733038 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.356619 
Total time for convolution: 	 convolve: 5.362635 
Total time for convolution: 	 convolve: 5.319094 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.773 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.504 ms
---Transfer Veff_loc: D2D took 2.259 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.236 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.528 ms

This SCF took 32397.943 ms, scf error = 4.163e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.150646, lowerbound = -0.975726, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1676.136 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.306 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.602 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 21.936 ms
rank =  0, finding HY took 28.081 ms
rank =  0, distributing HY into block cyclic form took 17.992 ms
rank =  0, finding Y'*HY took 5.198 ms
Rank 0, Project_Hamiltonian used 73.244 ms
Total time for projection: 73.256 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.106 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.972386148171368
    last  calculated eigval = 0.050160860360728
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.79366728159700
lambda[   3] =  -0.56866401360928
lambda[   4] =  -0.49817089007944
lambda[   5] =  -0.45385647873368
lambda[   6] =  -0.41709969711117
lambda[   7] =  -0.37168963068651
lambda[   8] =  -0.34730850666118
lambda[   9] =  -0.33958255437510
lambda[  10] =  -0.29416987039096
lambda[  11] =  -0.19930756055932
lambda[  12] =  -0.07468147898305
lambda[  13] =  -0.03262765115153
lambda[  14] =   0.00591238562407
lambda[  15] =   0.01202931846294
lambda[  16] =   0.01546392694409
lambda[  17] =   0.03441873085791
lambda[  18] =   0.05016086036073
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 7.622 ms
rank =  0, Distributing orbital back into band + domain format took 17.696 ms
rank = 0, Subspace_Rotation used 25.334 ms

Total time for subspace rotation: 25.339 ms
rank = 0, Efermi =  -0.103838180613 calculate fermi energy took 0.095 ms
rank = 0, --- Calculate rho: sum over local bands took 4.731 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.341 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.372 ms
rank = 0, Calculating density took 1786.546 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.167 ms
rank = 0, D2D took 1.351 ms
rank = 0, Transfering density took 1.354 ms
Etot    =   -36.926090584467
Eband   =   -10.511805265460
E1      =    23.423188987477
E2      =    -9.597924568602
E3      =   -13.448621463555
Exc     =   -12.001474174542
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 3.825e-05, dEband = 1.128e-02
rank = 0, Calculating/Estimating energy took 1.031 ms, Etot = -36.926090584, dEtot = 3.825e-05, dEband = 1.128e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1919669575926, which took 0.147 ms

iter_count = 114, r_2norm = 5.769e-06, tol*||rhs|| = 7.679e-06

Anderson update took 67.770 ms, out of which F'*F took 30.824 ms; b-Ax took 217.115 ms, out of which Lap took 195.282 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.935 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021578, int_b + int_rho = -2.474e-13, checking this took 0.106 ms
2-norm of RHS = 670.0333786626885, which took 0.178 ms

iter_count = 234, r_2norm = 6.646e-04, tol*||rhs|| = 6.700e-04

Anderson update took 162.733 ms, out of which F'*F took 66.076 ms; b-Ax took 473.472 ms, out of which Lap took 421.413 ms
Solving Poisson took 1017.296 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.270052 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.270144 
Total time for convolution: 	 convolve: 5.247325 
Total time for convolution: 	 convolve: 5.255550 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.381 ms
---Transfer Veff_loc: D2D took 2.033 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.210 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.276 ms

This SCF took 28464.703 ms, scf error = 1.929e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.150161, lowerbound = -0.972386, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1702.744 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 76.020 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 18.126 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 94.167 ms
rank =  0, finding HY took 27.237 ms
rank =  0, distributing HY into block cyclic form took 18.035 ms
rank =  0, finding Y'*HY took 5.163 ms
Rank 0, Project_Hamiltonian used 144.643 ms
Total time for projection: 144.656 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -0.968751018803705
    last  calculated eigval = 0.050865960500273
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.79032691450577
lambda[   3] =  -0.56573663757806
lambda[   4] =  -0.49512756615435
lambda[   5] =  -0.45100814649420
lambda[   6] =  -0.41359262447755
lambda[   7] =  -0.36828412195570
lambda[   8] =  -0.34467495008006
lambda[   9] =  -0.33637591466742
lambda[  10] =  -0.29102511858137
lambda[  11] =  -0.19595503523213
lambda[  12] =  -0.07151250878031
lambda[  13] =  -0.03040489952107
lambda[  14] =   0.00909696679507
lambda[  15] =   0.01398859296286
lambda[  16] =   0.01727872176091
lambda[  17] =   0.03571258645617
lambda[  18] =   0.05086596050027
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 7.842 ms
rank =  0, Distributing orbital back into band + domain format took 18.701 ms
rank = 0, Subspace_Rotation used 26.563 ms

Total time for subspace rotation: 26.568 ms
rank = 0, Efermi =  -0.100669210598 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.812 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.669 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.365 ms
rank = 0, Calculating density took 1885.144 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.189 ms
rank = 0, D2D took 1.302 ms
rank = 0, Transfering density took 1.306 ms
Etot    =   -36.926042291526
Eband   =   -10.441716098506
E1      =    23.387420934208
E2      =    -9.561522869473
E3      =   -13.456455438872
Exc     =   -12.007179271475
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 6.037e-06, dEband = 8.761e-03
rank = 0, Calculating/Estimating energy took 1.051 ms, Etot = -36.926042292, dEtot = 6.037e-06, dEband = 8.761e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1939255884846, which took 0.057 ms

iter_count = 114, r_2norm = 4.767e-06, tol*||rhs|| = 7.757e-06

Anderson update took 67.848 ms, out of which F'*F took 37.802 ms; b-Ax took 224.149 ms, out of which Lap took 202.365 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.323 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021575, int_b + int_rho = -2.765e-13, checking this took 0.156 ms
2-norm of RHS = 670.0260563061285, which took 0.222 ms

iter_count = 204, r_2norm = 6.666e-04, tol*||rhs|| = 6.700e-04

Anderson update took 122.875 ms, out of which F'*F took 58.151 ms; b-Ax took 401.771 ms, out of which Lap took 358.832 ms
Solving Poisson took 850.764 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.780 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.532 ms
Total time for convolution: 	 convolve: 5.242796 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.377 ms
Total time for convolution: 	 convolve: 5.235735 
Total time for convolution: 	 convolve: 5.234083 
Total time for convolution: 	 convolve: 5.282171 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.749 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.582 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.009 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 2.050 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.803 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.888 ms

This SCF took 28384.508 ms, scf error = 1.006e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.150866, lowerbound = -0.968751, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1685.606 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.364 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.672 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 23.065 ms
rank =  0, finding HY took 27.642 ms
rank =  0, distributing HY into block cyclic form took 19.216 ms
rank =  0, finding Y'*HY took 4.159 ms
Rank 0, Project_Hamiltonian used 74.126 ms
Total time for projection: 74.137 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.967597557369705
    last  calculated eigval = 0.049640282337479
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78918106679001
lambda[   3] =  -0.56453233899641
lambda[   4] =  -0.49393169150337
lambda[   5] =  -0.44986827330611
lambda[   6] =  -0.41244252396373
lambda[   7] =  -0.36711397386930
lambda[   8] =  -0.34348372576162
lambda[   9] =  -0.33529035024126
lambda[  10] =  -0.28989624594304
lambda[  11] =  -0.19481473178771
lambda[  12] =  -0.07040524472790
lambda[  13] =  -0.02879607119489
lambda[  14] =   0.01091260171484
lambda[  15] =   0.01597421676249
lambda[  16] =   0.01861861872714
lambda[  17] =   0.03557265667356
lambda[  18] =   0.04964028233748
==subpsace eigenproblem: bcast eigvals took 0.088 ms
Total time for solving subspace eigenvalue problem: 0.273 ms
rank =  0, subspace rotation using ScaLAPACK took 7.611 ms
rank =  0, Distributing orbital back into band + domain format took 18.887 ms
rank = 0, Subspace_Rotation used 26.514 ms

Total time for subspace rotation: 26.518 ms
rank = 0, Efermi =  -0.099561946434 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 5.980 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.163 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.397 ms
rank = 0, Calculating density took 1798.207 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.019 ms
rank = 0, D2D took 1.143 ms
rank = 0, Transfering density took 1.146 ms
Etot    =   -36.926069856410
Eband   =   -10.416304960488
E1      =    23.374012916044
E2      =    -9.548746527450
E3      =   -13.459768419394
Exc     =   -12.009746594713
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 3.446e-06, dEband = 3.176e-03
rank = 0, Calculating/Estimating energy took 3.201 ms, Etot = -36.926069856, dEtot = 3.446e-06, dEband = 3.176e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0969094575958, which took 10.456 ms

iter_count = 108, r_2norm = 3.850e-06, tol*||rhs|| = 3.876e-06

Anderson update took 65.486 ms, out of which F'*F took 32.523 ms; b-Ax took 212.482 ms, out of which Lap took 191.643 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 473.443 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021564, int_b + int_rho = -3.856e-13, checking this took 0.112 ms
2-norm of RHS = 670.0123858266138, which took 0.165 ms

iter_count = 210, r_2norm = 5.609e-04, tol*||rhs|| = 6.700e-04

Anderson update took 133.826 ms, out of which F'*F took 59.654 ms; b-Ax took 397.208 ms, out of which Lap took 350.709 ms
Solving Poisson took 875.950 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.230156 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.271558 
Total time for convolution: 	 convolve: 5.248965 
Total time for convolution: 	 convolve: 5.245166 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.746 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.012 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.572 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.405 ms
---Transfer Veff_loc: D2D took 2.091 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.520 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.647 ms

This SCF took 28230.937 ms, scf error = 7.380e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.149640, lowerbound = -0.967598, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1692.554 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.491 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.042 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 22.565 ms
rank =  0, finding HY took 28.672 ms
rank =  0, distributing HY into block cyclic form took 18.475 ms
rank =  0, finding Y'*HY took 4.791 ms
Rank 0, Project_Hamiltonian used 74.545 ms
Total time for projection: 74.556 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.196 ms
    first calculated eigval = -0.966620741525100
    last  calculated eigval = 0.049009657831937
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78830601478962
lambda[   3] =  -0.56362227278232
lambda[   4] =  -0.49302817119520
lambda[   5] =  -0.44896240830118
lambda[   6] =  -0.41146037279295
lambda[   7] =  -0.36616113884466
lambda[   8] =  -0.34259403871945
lambda[   9] =  -0.33429438368185
lambda[  10] =  -0.28896718883800
lambda[  11] =  -0.19384832319086
lambda[  12] =  -0.06936199034581
lambda[  13] =  -0.02525231784816
lambda[  14] =   0.01457747921980
lambda[  15] =   0.02056188391963
lambda[  16] =   0.02184458376002
lambda[  17] =   0.03547739276495
lambda[  18] =   0.04900965783194
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 7.624 ms
rank =  0, Distributing orbital back into band + domain format took 17.903 ms
rank = 0, Subspace_Rotation used 25.544 ms

Total time for subspace rotation: 25.549 ms
rank = 0, Efermi =  -0.098518692109 calculate fermi energy took 0.068 ms
rank = 0, --- Calculate rho: sum over local bands took 4.664 ms
rank = 0, --- Calculate rho: reduce over all band groups took 7.240 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.386 ms
rank = 0, Calculating density took 1805.337 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.990 ms
rank = 0, D2D took 1.118 ms
rank = 0, Transfering density took 1.126 ms
Etot    =   -36.926097626061
Eband   =   -10.395730110725
E1      =    23.364559914729
E2      =    -9.537592028779
E3      =   -13.460223209768
Exc     =   -12.010196504514
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 3.471e-06, dEband = 2.572e-03
rank = 0, Calculating/Estimating energy took 2.099 ms, Etot = -36.926097626, dEtot = 3.471e-06, dEband = 2.572e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0834973685270, which took 0.825 ms

iter_count = 108, r_2norm = 2.770e-06, tol*||rhs|| = 3.340e-06

Anderson update took 68.380 ms, out of which F'*F took 30.459 ms; b-Ax took 204.155 ms, out of which Lap took 182.503 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.621 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021576, int_b + int_rho = -2.692e-13, checking this took 0.122 ms
2-norm of RHS = 670.0217384462281, which took 0.113 ms

iter_count = 192, r_2norm = 5.359e-04, tol*||rhs|| = 6.700e-04

Anderson update took 113.585 ms, out of which F'*F took 52.046 ms; b-Ax took 372.412 ms, out of which Lap took 329.096 ms
Solving Poisson took 795.413 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.252378 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.246346 
Total time for convolution: 	 convolve: 5.247490 
Total time for convolution: 	 convolve: 5.254829 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.773 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.754 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.408 ms
---Transfer Veff_loc: D2D took 1.907 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.190 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.131 ms

This SCF took 28229.370 ms, scf error = 4.446e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.149010, lowerbound = -0.966621, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1686.427 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.950 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.715 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.698 ms
rank =  0, finding HY took 28.437 ms
rank =  0, distributing HY into block cyclic form took 17.934 ms
rank =  0, finding Y'*HY took 5.189 ms
Rank 0, Project_Hamiltonian used 73.298 ms
Total time for projection: 73.312 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.100 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.965807002421738
    last  calculated eigval = 0.046504892961081
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78746117279414
lambda[   3] =  -0.56283661426716
lambda[   4] =  -0.49222870958110
lambda[   5] =  -0.44818333483803
lambda[   6] =  -0.41063954792568
lambda[   7] =  -0.36534777716240
lambda[   8] =  -0.34183896627972
lambda[   9] =  -0.33349961004373
lambda[  10] =  -0.28815786692775
lambda[  11] =  -0.19304185994048
lambda[  12] =  -0.06858713727179
lambda[  13] =  -0.02259437252803
lambda[  14] =   0.01620268817056
lambda[  15] =   0.02322225966903
lambda[  16] =   0.02494862697684
lambda[  17] =   0.03442224289321
lambda[  18] =   0.04650489296108
==subpsace eigenproblem: bcast eigvals took 0.035 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 7.705 ms
rank =  0, Distributing orbital back into band + domain format took 17.779 ms
rank = 0, Subspace_Rotation used 25.508 ms

Total time for subspace rotation: 25.513 ms
rank = 0, Efermi =  -0.097743838986 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 4.692 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.617 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.368 ms
rank = 0, Calculating density took 1797.292 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.158 ms
rank = 0, D2D took 1.290 ms
rank = 0, Transfering density took 1.292 ms
Etot    =   -36.926181427395
Eband   =   -10.378084925750
E1      =    23.355512801161
E2      =    -9.528590906845
E3      =   -13.461854868855
Exc     =   -12.011508914407
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 1.048e-05, dEband = 2.206e-03
rank = 0, Calculating/Estimating energy took 1.122 ms, Etot = -36.926181427, dEtot = 1.048e-05, dEband = 2.206e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0786121623156, which took 0.071 ms

iter_count = 108, r_2norm = 2.386e-06, tol*||rhs|| = 3.144e-06

Anderson update took 63.858 ms, out of which F'*F took 32.079 ms; b-Ax took 205.581 ms, out of which Lap took 183.018 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.267 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021575, int_b + int_rho = -2.728e-13, checking this took 0.124 ms
2-norm of RHS = 670.0299136906766, which took 0.366 ms

iter_count = 168, r_2norm = 5.724e-04, tol*||rhs|| = 6.700e-04

Anderson update took 98.969 ms, out of which F'*F took 49.588 ms; b-Ax took 318.903 ms, out of which Lap took 282.676 ms
Solving Poisson took 698.019 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.159 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.249638 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.250297 
Total time for convolution: 	 convolve: 5.199545 
Total time for convolution: 	 convolve: 5.228778 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.723 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.580 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.389 ms
---Transfer Veff_loc: D2D took 2.067 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.229 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.328 ms

This SCF took 27977.005 ms, scf error = 2.821e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.146505, lowerbound = -0.965807, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1677.924 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.083 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.067 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 22.181 ms
rank =  0, finding HY took 27.720 ms
rank =  0, distributing HY into block cyclic form took 18.559 ms
rank =  0, finding Y'*HY took 4.828 ms
Rank 0, Project_Hamiltonian used 73.328 ms
Total time for projection: 73.340 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.200 ms
    first calculated eigval = -0.965700612489867
    last  calculated eigval = 0.044045897133048
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78729725818406
lambda[   3] =  -0.56266839740629
lambda[   4] =  -0.49206583192146
lambda[   5] =  -0.44801188449760
lambda[   6] =  -0.41052080750958
lambda[   7] =  -0.36520203394589
lambda[   8] =  -0.34167063892888
lambda[   9] =  -0.33335679869995
lambda[  10] =  -0.28799248364842
lambda[  11] =  -0.19291044466929
lambda[  12] =  -0.06842266985547
lambda[  13] =  -0.02083378025604
lambda[  14] =   0.01707862295386
lambda[  15] =   0.02452350498671
lambda[  16] =   0.02702140917813
lambda[  17] =   0.03488795273469
lambda[  18] =   0.04404589713305
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.225 ms
rank =  0, subspace rotation using ScaLAPACK took 7.590 ms
rank =  0, Distributing orbital back into band + domain format took 18.303 ms
rank = 0, Subspace_Rotation used 25.911 ms

Total time for subspace rotation: 25.915 ms
rank = 0, Efermi =  -0.097579371599 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 4.644 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.434 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.359 ms
rank = 0, Calculating density took 1788.986 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.157 ms
rank = 0, D2D took 1.397 ms
rank = 0, Transfering density took 1.400 ms
Etot    =   -36.926228276487
Eband   =   -10.374794385186
E1      =    23.354333570918
E2      =    -9.526534409555
E3      =   -13.461554622420
Exc     =   -12.011310330095
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 5.856e-06, dEband = 4.113e-04
rank = 0, Calculating/Estimating energy took 1.023 ms, Etot = -36.926228276, dEtot = 5.856e-06, dEband = 4.113e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0740123944436, which took 0.107 ms

iter_count = 108, r_2norm = 2.266e-06, tol*||rhs|| = 2.960e-06

Anderson update took 64.990 ms, out of which F'*F took 30.058 ms; b-Ax took 200.683 ms, out of which Lap took 179.457 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 453.338 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021577, int_b + int_rho = -2.619e-13, checking this took 0.108 ms
2-norm of RHS = 670.0290395139250, which took 0.149 ms

iter_count = 114, r_2norm = 6.395e-04, tol*||rhs|| = 6.700e-04

Anderson update took 69.526 ms, out of which F'*F took 31.841 ms; b-Ax took 216.019 ms, out of which Lap took 190.357 ms
Solving Poisson took 475.718 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.298 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.231581 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.219225 
Total time for convolution: 	 convolve: 5.250428 
Total time for convolution: 	 convolve: 5.221476 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.726 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.658 ms
---Transfer Veff_loc: D2D took 1.996 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.234 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.263 ms

This SCF took 27773.027 ms, scf error = 2.534e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.144046, lowerbound = -0.965701, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1696.098 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.983 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.785 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 21.794 ms
rank =  0, finding HY took 28.023 ms
rank =  0, distributing HY into block cyclic form took 18.901 ms
rank =  0, finding Y'*HY took 6.164 ms
Rank 0, Project_Hamiltonian used 74.918 ms
Total time for projection: 74.933 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -0.965577458594987
    last  calculated eigval = 0.041495633261777
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78718751263451
lambda[   3] =  -0.56257251243725
lambda[   4] =  -0.49196826475753
lambda[   5] =  -0.44791600303890
lambda[   6] =  -0.41040925431955
lambda[   7] =  -0.36509265228346
lambda[   8] =  -0.34158193248299
lambda[   9] =  -0.33324921777998
lambda[  10] =  -0.28789313515083
lambda[  11] =  -0.19280270559334
lambda[  12] =  -0.06832326471582
lambda[  13] =  -0.02058176619853
lambda[  14] =   0.01714879472182
lambda[  15] =   0.02438945656465
lambda[  16] =   0.02730586072622
lambda[  17] =   0.03449366737303
lambda[  18] =   0.04149563326178
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 7.670 ms
rank =  0, Distributing orbital back into band + domain format took 18.001 ms
rank = 0, Subspace_Rotation used 25.684 ms

Total time for subspace rotation: 25.689 ms
rank = 0, Efermi =  -0.097479966418 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.642 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.227 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.362 ms
rank = 0, Calculating density took 1808.291 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.117 ms
rank = 0, D2D took 1.233 ms
rank = 0, Transfering density took 1.235 ms
Etot    =   -36.926244343458
Eband   =   -10.372501299528
E1      =    23.353050102076
E2      =    -9.525454446791
E3      =   -13.461805705410
Exc     =   -12.011507134110
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 2.008e-06, dEband = 2.866e-04
rank = 0, Calculating/Estimating energy took 0.981 ms, Etot = -36.926244343, dEtot = 2.008e-06, dEband = 2.866e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0393207885695, which took 0.242 ms

iter_count = 108, r_2norm = 1.229e-06, tol*||rhs|| = 1.573e-06

Anderson update took 64.528 ms, out of which F'*F took 32.247 ms; b-Ax took 204.611 ms, out of which Lap took 182.293 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.665 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021574, int_b + int_rho = -2.910e-13, checking this took 0.871 ms
2-norm of RHS = 670.0347539333487, which took 0.124 ms

iter_count = 168, r_2norm = 6.438e-04, tol*||rhs|| = 6.700e-04

Anderson update took 99.439 ms, out of which F'*F took 51.588 ms; b-Ax took 328.639 ms, out of which Lap took 290.115 ms
Solving Poisson took 700.684 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.202 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.235185 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.252769 
Total time for convolution: 	 convolve: 5.258332 
Total time for convolution: 	 convolve: 5.245476 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 2.075 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.339 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.446 ms

This SCF took 28040.547 ms, scf error = 2.221e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.141496, lowerbound = -0.965577, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1684.699 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.050 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.827 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 21.913 ms
rank =  0, finding HY took 28.100 ms
rank =  0, distributing HY into block cyclic form took 18.232 ms
rank =  0, finding Y'*HY took 5.279 ms
Rank 0, Project_Hamiltonian used 73.580 ms
Total time for projection: 73.600 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.080 ms
rank = 0, Solve_Generalized_EigenProblem used 0.200 ms
    first calculated eigval = -0.965333875547622
    last  calculated eigval = 0.040778760131111
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78695616807100
lambda[   3] =  -0.56230760559436
lambda[   4] =  -0.49172051284210
lambda[   5] =  -0.44766022539102
lambda[   6] =  -0.41018003464012
lambda[   7] =  -0.36484722031983
lambda[   8] =  -0.34132066520179
lambda[   9] =  -0.33300322105058
lambda[  10] =  -0.28766038447454
lambda[  11] =  -0.19257489067819
lambda[  12] =  -0.06812817762356
lambda[  13] =  -0.02016937341483
lambda[  14] =   0.01674344714367
lambda[  15] =   0.02466966992320
lambda[  16] =   0.02655477165180
lambda[  17] =   0.03533085876115
lambda[  18] =   0.04077876013111
==subpsace eigenproblem: bcast eigvals took 0.048 ms
Total time for solving subspace eigenvalue problem: 0.252 ms
rank =  0, subspace rotation using ScaLAPACK took 7.665 ms
rank =  0, Distributing orbital back into band + domain format took 17.848 ms
rank = 0, Subspace_Rotation used 25.530 ms

Total time for subspace rotation: 25.534 ms
rank = 0, Efermi =  -0.097284879402 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 4.649 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.529 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.349 ms
rank = 0, Calculating density took 1795.748 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.182 ms
rank = 0, D2D took 1.328 ms
rank = 0, Transfering density took 1.335 ms
Etot    =   -36.926314523337
Eband   =   -10.367129609000
E1      =    23.350722200058
E2      =    -9.522331303520
E3      =   -13.461837439029
Exc     =   -12.011529692847
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 8.772e-06, dEband = 6.715e-04
rank = 0, Calculating/Estimating energy took 0.985 ms, Etot = -36.926314523, dEtot = 8.772e-06, dEband = 6.715e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0392316753351, which took 0.128 ms

iter_count = 108, r_2norm = 1.115e-06, tol*||rhs|| = 1.569e-06

Anderson update took 69.450 ms, out of which F'*F took 29.627 ms; b-Ax took 204.059 ms, out of which Lap took 182.750 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.584 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021572, int_b + int_rho = -3.129e-13, checking this took 0.128 ms
2-norm of RHS = 670.0339651138598, which took 0.112 ms

iter_count = 114, r_2norm = 5.596e-04, tol*||rhs|| = 6.700e-04

Anderson update took 68.801 ms, out of which F'*F took 33.062 ms; b-Ax took 222.326 ms, out of which Lap took 196.699 ms
Solving Poisson took 491.377 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.260810 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.244242 
Total time for convolution: 	 convolve: 5.282293 
Total time for convolution: 	 convolve: 5.236366 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.762 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.168 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.414 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.617 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 2.050 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.210 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.294 ms

This SCF took 28058.182 ms, scf error = 2.045e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.140779, lowerbound = -0.965334, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1686.630 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.295 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.732 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.771 ms
rank =  0, Distribute data + matrix mult took 22.814 ms
rank =  0, finding HY took 28.702 ms
rank =  0, distributing HY into block cyclic form took 17.819 ms
rank =  0, finding Y'*HY took 5.476 ms
Rank 0, Project_Hamiltonian used 74.844 ms
Total time for projection: 74.856 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.965265922965485
    last  calculated eigval = 0.041199079808067
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78690814755699
lambda[   3] =  -0.56226310599048
lambda[   4] =  -0.49167369398955
lambda[   5] =  -0.44761335395137
lambda[   6] =  -0.41011864531927
lambda[   7] =  -0.36478972528032
lambda[   8] =  -0.34127806589551
lambda[   9] =  -0.33294404628301
lambda[  10] =  -0.28761788463042
lambda[  11] =  -0.19252053581257
lambda[  12] =  -0.06808079548892
lambda[  13] =  -0.01981321743367
lambda[  14] =   0.01672860472898
lambda[  15] =   0.02502946574557
lambda[  16] =   0.02652491452994
lambda[  17] =   0.03425966929095
lambda[  18] =   0.04119907980807
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 7.664 ms
rank =  0, Distributing orbital back into band + domain format took 17.290 ms
rank = 0, Subspace_Rotation used 24.969 ms

Total time for subspace rotation: 24.975 ms
rank = 0, Efermi =  -0.097237497199 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 4.466 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.491 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.425 ms
rank = 0, Calculating density took 1798.216 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.183 ms
rank = 0, D2D took 1.753 ms
rank = 0, Transfering density took 1.756 ms
Etot    =   -36.926320173575
Eband   =   -10.365986256726
E1      =    23.350130045431
E2      =    -9.521761499642
E3      =   -13.461898824311
Exc     =   -12.011578122135
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 7.063e-07, dEband = 1.429e-04
rank = 0, Calculating/Estimating energy took 1.276 ms, Etot = -36.926320174, dEtot = 7.063e-07, dEband = 1.429e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0411631415821, which took 0.264 ms

iter_count = 108, r_2norm = 1.126e-06, tol*||rhs|| = 1.647e-06

Anderson update took 67.513 ms, out of which F'*F took 29.647 ms; b-Ax took 199.683 ms, out of which Lap took 181.100 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.424 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021580, int_b + int_rho = -2.292e-13, checking this took 0.110 ms
2-norm of RHS = 670.0340089776586, which took 0.068 ms

iter_count = 78, r_2norm = 6.526e-04, tol*||rhs|| = 6.700e-04

Anderson update took 47.000 ms, out of which F'*F took 21.712 ms; b-Ax took 146.965 ms, out of which Lap took 130.380 ms
Solving Poisson took 326.353 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.973 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.177282 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.380467 
Total time for convolution: 	 convolve: 5.296318 
Total time for convolution: 	 convolve: 5.236528 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.326 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 2.044 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.566 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.658 ms

This SCF took 27821.246 ms, scf error = 1.807e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.141199, lowerbound = -0.965266, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1684.460 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.775 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.938 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 21.740 ms
rank =  0, finding HY took 27.865 ms
rank =  0, distributing HY into block cyclic form took 18.799 ms
rank =  0, finding Y'*HY took 5.145 ms
Rank 0, Project_Hamiltonian used 73.585 ms
Total time for projection: 73.599 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.965215826051269
    last  calculated eigval = 0.041274241859889
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78686474529540
lambda[   3] =  -0.56222517463720
lambda[   4] =  -0.49163380884073
lambda[   5] =  -0.44757492935481
lambda[   6] =  -0.41007106376694
lambda[   7] =  -0.36474447143086
lambda[   8] =  -0.34124267240795
lambda[   9] =  -0.33289948571103
lambda[  10] =  -0.28757799552638
lambda[  11] =  -0.19247606468872
lambda[  12] =  -0.06803860821007
lambda[  13] =  -0.01960556201647
lambda[  14] =   0.01677089071684
lambda[  15] =   0.02515070154837
lambda[  16] =   0.02663469884097
lambda[  17] =   0.03318715917934
lambda[  18] =   0.04127424185989
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 7.722 ms
rank =  0, Distributing orbital back into band + domain format took 18.106 ms
rank = 0, Subspace_Rotation used 25.850 ms

Total time for subspace rotation: 25.855 ms
rank = 0, Efermi =  -0.097195309829 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 4.755 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.981 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.910 ms
rank = 0, Calculating density took 1795.910 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.248 ms
rank = 0, D2D took 1.418 ms
rank = 0, Transfering density took 1.420 ms
Etot    =   -36.926322578574
Eband   =   -10.365052476798
E1      =    23.349641955618
E2      =    -9.521292339404
E3      =   -13.461986682721
Exc     =   -12.011644915421
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 3.006e-07, dEband = 1.167e-04
rank = 0, Calculating/Estimating energy took 1.064 ms, Etot = -36.926322579, dEtot = 3.006e-07, dEband = 1.167e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0410977740966, which took 0.209 ms

iter_count = 108, r_2norm = 1.134e-06, tol*||rhs|| = 1.644e-06

Anderson update took 67.069 ms, out of which F'*F took 29.635 ms; b-Ax took 205.756 ms, out of which Lap took 185.903 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.968 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021574, int_b + int_rho = -2.838e-13, checking this took 0.877 ms
2-norm of RHS = 670.0349704612943, which took 1.974 ms

iter_count = 96, r_2norm = 5.607e-04, tol*||rhs|| = 6.700e-04

Anderson update took 61.559 ms, out of which F'*F took 26.722 ms; b-Ax took 182.847 ms, out of which Lap took 160.246 ms
Solving Poisson took 404.120 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.282249 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.214015 
Total time for convolution: 	 convolve: 5.217195 
Total time for convolution: 	 convolve: 5.308799 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.718 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.407 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 2.177 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.268 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.488 ms

This SCF took 27876.137 ms, scf error = 1.705e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.141274, lowerbound = -0.965216, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1657.708 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 86.660 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.826 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 90.509 ms
rank =  0, finding HY took 27.907 ms
rank =  0, distributing HY into block cyclic form took 17.849 ms
rank =  0, finding Y'*HY took 5.256 ms
Rank 0, Project_Hamiltonian used 141.552 ms
Total time for projection: 141.573 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.965145788954466
    last  calculated eigval = 0.041171377747285
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78679633858432
lambda[   3] =  -0.56216561173929
lambda[   4] =  -0.49157318694970
lambda[   5] =  -0.44751531953136
lambda[   6] =  -0.41000638021500
lambda[   7] =  -0.36467830714230
lambda[   8] =  -0.34118712411054
lambda[   9] =  -0.33283663898253
lambda[  10] =  -0.28751499813346
lambda[  11] =  -0.19241138705888
lambda[  12] =  -0.06797715103143
lambda[  13] =  -0.01954646925084
lambda[  14] =   0.01675877799894
lambda[  15] =   0.02516417626229
lambda[  16] =   0.02666850975748
lambda[  17] =   0.03232428856160
lambda[  18] =   0.04117137774728
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 7.652 ms
rank =  0, Distributing orbital back into band + domain format took 17.622 ms
rank = 0, Subspace_Rotation used 25.288 ms

Total time for subspace rotation: 25.294 ms
rank = 0, Efermi =  -0.097133852877 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 4.619 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.408 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.365 ms
rank = 0, Calculating density took 1836.305 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.185 ms
rank = 0, D2D took 1.352 ms
rank = 0, Transfering density took 1.356 ms
Etot    =   -36.926326306239
Eband   =   -10.363662164178
E1      =    23.348921829010
E2      =    -9.520579142788
E3      =   -13.462141133260
Exc     =   -12.011760083020
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 4.660e-07, dEband = 1.738e-04
rank = 0, Calculating/Estimating energy took 1.109 ms, Etot = -36.926326306, dEtot = 4.660e-07, dEband = 1.738e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0392601942835, which took 0.065 ms

iter_count = 108, r_2norm = 1.124e-06, tol*||rhs|| = 1.570e-06

Anderson update took 63.817 ms, out of which F'*F took 29.676 ms; b-Ax took 198.775 ms, out of which Lap took 177.840 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 448.620 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021573, int_b + int_rho = -2.983e-13, checking this took 0.127 ms
2-norm of RHS = 670.0361345855687, which took 0.193 ms

iter_count = 78, r_2norm = 5.935e-04, tol*||rhs|| = 6.700e-04

Anderson update took 45.556 ms, out of which F'*F took 21.442 ms; b-Ax took 144.847 ms, out of which Lap took 128.618 ms
Solving Poisson took 321.523 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.141541 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 122.316 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.423 ms
Total time for convolution: 	 convolve: 5.466754 
Total time for convolution: 	 convolve: 5.941888 
Total time for convolution: 	 convolve: 5.243764 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.777 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.136 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.723 ms
---Transfer Veff_loc: D2D took 2.074 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.228 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.331 ms

This SCF took 28688.746 ms, scf error = 1.627e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.141171, lowerbound = -0.965146, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1684.010 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 24.416 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.901 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 28.343 ms
rank =  0, finding HY took 28.100 ms
rank =  0, distributing HY into block cyclic form took 17.856 ms
rank =  0, finding Y'*HY took 5.273 ms
Rank 0, Project_Hamiltonian used 79.602 ms
Total time for projection: 79.616 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.106 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.965123552482868
    last  calculated eigval = 0.041168890912062
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78677517052484
lambda[   3] =  -0.56214772116657
lambda[   4] =  -0.49155515033366
lambda[   5] =  -0.44749710931741
lambda[   6] =  -0.40998579401481
lambda[   7] =  -0.36465873460715
lambda[   8] =  -0.34116987412969
lambda[   9] =  -0.33281651989822
lambda[  10] =  -0.28749610602106
lambda[  11] =  -0.19239140416395
lambda[  12] =  -0.06796428888942
lambda[  13] =  -0.01967521084990
lambda[  14] =   0.01660306477476
lambda[  15] =   0.02508186137027
lambda[  16] =   0.02639581025764
lambda[  17] =   0.03153216498977
lambda[  18] =   0.04116889091206
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 0.247 ms
rank =  0, subspace rotation using ScaLAPACK took 7.635 ms
rank =  0, Distributing orbital back into band + domain format took 17.916 ms
rank = 0, Subspace_Rotation used 25.566 ms

Total time for subspace rotation: 25.571 ms
rank = 0, Efermi =  -0.097120990662 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 4.720 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.595 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.348 ms
rank = 0, Calculating density took 1801.224 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.185 ms
rank = 0, D2D took 1.299 ms
rank = 0, Transfering density took 1.301 ms
Etot    =   -36.926325437549
Eband   =   -10.363234274694
E1      =    23.348692249026
E2      =    -9.520356917630
E3      =   -13.462229292167
Exc     =   -12.011823457579
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 1.086e-07, dEband = 5.349e-05
rank = 0, Calculating/Estimating energy took 1.916 ms, Etot = -36.926325438, dEtot = 1.086e-07, dEband = 5.349e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0285894051875, which took 0.062 ms

iter_count = 108, r_2norm = 1.013e-06, tol*||rhs|| = 1.144e-06

Anderson update took 64.358 ms, out of which F'*F took 29.624 ms; b-Ax took 202.788 ms, out of which Lap took 182.075 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.025 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021574, int_b + int_rho = -2.838e-13, checking this took 0.124 ms
2-norm of RHS = 670.0402453362473, which took 0.178 ms

iter_count = 108, r_2norm = 6.017e-04, tol*||rhs|| = 6.700e-04

Anderson update took 122.204 ms, out of which F'*F took 72.829 ms; b-Ax took 606.136 ms, out of which Lap took 539.503 ms
Solving Poisson took 1113.747 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.373253 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 802.199 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.850673 
Total time for convolution: 	 convolve: 5.752369 
Total time for convolution: 	 convolve: 5.465796 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.170 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.064 ms
---Transfer Veff_loc: D2D took 2.132 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.801 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 14.867 ms

This SCF took 30925.815 ms, scf error = 1.534e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.141169, lowerbound = -0.965124, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1573.537 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 305.362 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.917 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 309.303 ms
rank =  0, finding HY took 23.520 ms
rank =  0, distributing HY into block cyclic form took 15.127 ms
rank =  0, finding Y'*HY took 56.442 ms
Rank 0, Project_Hamiltonian used 404.423 ms
Total time for projection: 404.438 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 20.934 ms
rank = 0, Solve_Generalized_EigenProblem used 21.060 ms
    first calculated eigval = -0.965090019987045
    last  calculated eigval = 0.042341575140289
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78672876546272
lambda[   3] =  -0.56209852326939
lambda[   4] =  -0.49150783424761
lambda[   5] =  -0.44744801796423
lambda[   6] =  -0.40995095390996
lambda[   7] =  -0.36461620945406
lambda[   8] =  -0.34111938377639
lambda[   9] =  -0.33277648046236
lambda[  10] =  -0.28744975312174
lambda[  11] =  -0.19235260506391
lambda[  12] =  -0.06792807434417
lambda[  13] =  -0.01949879597427
lambda[  14] =   0.01652349570664
lambda[  15] =   0.02567982621336
lambda[  16] =   0.02632519393333
lambda[  17] =   0.03124243560746
lambda[  18] =   0.04234157514029
==subpsace eigenproblem: bcast eigvals took 10.926 ms
Total time for solving subspace eigenvalue problem: 31.994 ms
rank =  0, subspace rotation using ScaLAPACK took 7.242 ms
rank =  0, Distributing orbital back into band + domain format took 12.743 ms
rank = 0, Subspace_Rotation used 19.997 ms

Total time for subspace rotation: 20.002 ms
rank = 0, Efermi =  -0.097084776048 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 2.776 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.999 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.254 ms
rank = 0, Calculating density took 2038.128 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 0.931 ms
rank = 0, D2D took 49.404 ms
rank = 0, Transfering density took 49.412 ms
Etot    =   -36.926331804531
Eband   =   -10.362277094812
E1      =    23.348339833910
E2      =    -9.519735232520
E3      =   -13.462248004682
Exc     =   -12.011831616732
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 7.959e-07, dEband = 1.196e-04
rank = 0, Calculating/Estimating energy took 23.144 ms, Etot = -36.926331805, dEtot = 7.959e-07, dEband = 1.196e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0288646814483, which took 21.595 ms

iter_count = 108, r_2norm = 1.016e-06, tol*||rhs|| = 1.155e-06

Anderson update took 665.677 ms, out of which F'*F took 335.443 ms; b-Ax took 1377.164 ms, out of which Lap took 1334.131 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 2545.499 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021565, int_b + int_rho = -3.747e-13, checking this took 0.112 ms
2-norm of RHS = 670.0389917348690, which took 20.683 ms

iter_count = 48, r_2norm = 5.946e-04, tol*||rhs|| = 6.700e-04

Anderson update took 207.383 ms, out of which F'*F took 101.419 ms; b-Ax took 398.502 ms, out of which Lap took 391.785 ms
Solving Poisson took 760.156 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.159426 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 583.525 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.394250 
Total time for convolution: 	 convolve: 5.422306 
Total time for convolution: 	 convolve: 5.179980 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.840 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 2.080 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.277 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.393 ms

This SCF took 31223.738 ms, scf error = 1.698e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.142342, lowerbound = -0.965090, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1681.111 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 17.971 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.734 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 21.729 ms
rank =  0, finding HY took 28.254 ms
rank =  0, distributing HY into block cyclic form took 17.910 ms
rank =  0, finding Y'*HY took 5.117 ms
Rank 0, Project_Hamiltonian used 73.049 ms
Total time for projection: 73.065 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.965054201939604
    last  calculated eigval = 0.041948269001569
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78670139613939
lambda[   3] =  -0.56207978464777
lambda[   4] =  -0.49148726208483
lambda[   5] =  -0.44742855568083
lambda[   6] =  -0.40992084121601
lambda[   7] =  -0.36458949718321
lambda[   8] =  -0.34110351048291
lambda[   9] =  -0.33274921785297
lambda[  10] =  -0.28742697275241
lambda[  11] =  -0.19232456650396
lambda[  12] =  -0.06790505319505
lambda[  13] =  -0.01961041995748
lambda[  14] =   0.01647693666616
lambda[  15] =   0.02541740375847
lambda[  16] =   0.02620213560013
lambda[  17] =   0.03079895395773
lambda[  18] =   0.04194826900157
==subpsace eigenproblem: bcast eigvals took 0.067 ms
Total time for solving subspace eigenvalue problem: 0.262 ms
rank =  0, subspace rotation using ScaLAPACK took 7.775 ms
rank =  0, Distributing orbital back into band + domain format took 17.785 ms
rank = 0, Subspace_Rotation used 25.591 ms

Total time for subspace rotation: 25.598 ms
rank = 0, Efermi =  -0.097061755034 calculate fermi energy took 0.075 ms
rank = 0, --- Calculate rho: sum over local bands took 4.697 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.216 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.345 ms
rank = 0, Calculating density took 1791.457 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.353 ms
rank = 0, D2D took 1.481 ms
rank = 0, Transfering density took 1.489 ms
Etot    =   -36.926329634528
Eband   =   -10.361731614341
E1      =    23.347967124050
E2      =    -9.519537100785
E3      =   -13.462362474133
Exc     =   -12.011918555057
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 2.713e-07, dEband = 6.819e-05
rank = 0, Calculating/Estimating energy took 0.983 ms, Etot = -36.926329635, dEtot = 2.713e-07, dEband = 6.819e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0275896999099, which took 0.062 ms

iter_count = 102, r_2norm = 1.042e-06, tol*||rhs|| = 1.104e-06

Anderson update took 60.236 ms, out of which F'*F took 27.996 ms; b-Ax took 187.934 ms, out of which Lap took 168.292 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 425.909 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021572, int_b + int_rho = -3.129e-13, checking this took 0.084 ms
2-norm of RHS = 670.0349041447943, which took 0.209 ms

iter_count = 144, r_2norm = 6.070e-04, tol*||rhs|| = 6.700e-04

Anderson update took 83.859 ms, out of which F'*F took 39.083 ms; b-Ax took 269.582 ms, out of which Lap took 236.871 ms
Solving Poisson took 592.647 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.187622 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.165365 
Total time for convolution: 	 convolve: 5.193152 
Total time for convolution: 	 convolve: 5.165920 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.577 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 2.048 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.249 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.330 ms

This SCF took 27598.336 ms, scf error = 1.490e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.141948, lowerbound = -0.965054, upperbound = 267.590053

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1676.394 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.108 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.669 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 21.803 ms
rank =  0, finding HY took 28.331 ms
rank =  0, distributing HY into block cyclic form took 18.005 ms
rank =  0, finding Y'*HY took 5.141 ms
Rank 0, Project_Hamiltonian used 73.314 ms
Total time for projection: 73.326 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.964884400450378
    last  calculated eigval = 0.042799728365841
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78656030302957
lambda[   3] =  -0.56199945539984
lambda[   4] =  -0.49140075266338
lambda[   5] =  -0.44732665932234
lambda[   6] =  -0.40980468532839
lambda[   7] =  -0.36446019194199
lambda[   8] =  -0.34103261343253
lambda[   9] =  -0.33261467450696
lambda[  10] =  -0.28732704857113
lambda[  11] =  -0.19220248508715
lambda[  12] =  -0.06779794790398
lambda[  13] =  -0.02017164326359
lambda[  14] =   0.01583727312049
lambda[  15] =   0.02507183097402
lambda[  16] =   0.02545476949488
lambda[  17] =   0.03056161614625
lambda[  18] =   0.04279972836584
==subpsace eigenproblem: bcast eigvals took 0.069 ms
Total time for solving subspace eigenvalue problem: 0.267 ms
rank =  0, subspace rotation using ScaLAPACK took 6.314 ms
rank =  0, Distributing orbital back into band + domain format took 18.165 ms
rank = 0, Subspace_Rotation used 24.500 ms

Total time for subspace rotation: 24.507 ms
rank = 0, Efermi =  -0.096954649566 calculate fermi energy took 0.288 ms
rank = 0, --- Calculate rho: sum over local bands took 4.530 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.152 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.438 ms
rank = 0, Calculating density took 1786.006 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.169 ms
rank = 0, D2D took 1.796 ms
rank = 0, Transfering density took 1.803 ms
Etot    =   -36.926338809113
Eband   =   -10.359226540838
E1      =    23.346396830773
E2      =    -9.518516025242
E3      =   -13.462675430744
Exc     =   -12.012154390936
Esc     =   -60.882546163491
Entropy =    -0.000000000607
dE = 1.147e-06, dEband = 3.131e-04
rank = 0, Calculating/Estimating energy took 0.980 ms, Etot = -36.926338809, dEtot = 1.147e-06, dEband = 3.131e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0162249494513, which took 0.138 ms

iter_count = 108, r_2norm = 5.582e-07, tol*||rhs|| = 6.490e-07

Anderson update took 63.990 ms, out of which F'*F took 29.766 ms; b-Ax took 199.024 ms, out of which Lap took 178.219 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 450.713 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002021603, int_rho =  22.00000002021573, int_b + int_rho = -2.947e-13, checking this took 0.122 ms
2-norm of RHS = 670.0328612277328, which took 0.166 ms

iter_count = 102, r_2norm = 5.765e-04, tol*||rhs|| = 6.700e-04

Anderson update took 59.430 ms, out of which F'*F took 27.591 ms; b-Ax took 189.888 ms, out of which Lap took 167.585 ms
Solving Poisson took 419.728 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.168881 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.187417 
Total time for convolution: 	 convolve: 5.158103 
Total time for convolution: 	 convolve: 5.162288 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.826 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.334 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 2.166 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.791 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.984 ms

This SCF took 27359.371 ms, scf error = 7.899e-05
The last 17 occupations of kpoints #1 are (Nelectron = 22):
lambda[   2] =  -0.78656030302957, occ[   2] =   2.00000000000000
lambda[   3] =  -0.56199945539984, occ[   3] =   2.00000000000000
lambda[   4] =  -0.49140075266338, occ[   4] =   2.00000000000000
lambda[   5] =  -0.44732665932234, occ[   5] =   2.00000000000000
lambda[   6] =  -0.40980468532839, occ[   6] =   2.00000000000000
lambda[   7] =  -0.36446019194199, occ[   7] =   2.00000000000000
lambda[   8] =  -0.34103261343253, occ[   8] =   2.00000000000000
lambda[   9] =  -0.33261467450696, occ[   9] =   2.00000000000000
lambda[  10] =  -0.28732704857113, occ[  10] =   2.00000000000000
lambda[  11] =  -0.19220248508715, occ[  11] =   2.00000000000000
lambda[  12] =  -0.06779794790398, occ[  12] =   0.00000002021575
lambda[  13] =  -0.02017164326359, occ[  13] =   0.00000000000000
lambda[  14] =   0.01583727312049, occ[  14] =   0.00000000000000
lambda[  15] =   0.02507183097402, occ[  15] =   0.00000000000000
lambda[  16] =   0.02545476949488, occ[  16] =   0.00000000000000
lambda[  17] =   0.03056161614625, occ[  17] =   0.00000000000000
lambda[  18] =   0.04279972836584, occ[  18] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 16 (90%) = 0.000000000000000.
Occupation of state 18 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.818 ms, time for Allreduce/Reduce: 6.771 ms 
Time for calculating local force components: 18.719 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000031070916   0.00000290476531  -1.23734910409782
 -0.04214283907093  -0.02408903108997   0.01422401771242
  0.04214284201784  -0.02408903925127   0.01422405585241
  0.04214246880823   0.02408895461887   0.01422396061215
 -0.04214247683236   0.02408896122926   0.01422397542140
 -0.00000000525259   0.00000706229363   0.00425747593890
  0.00000091785478  -0.13989954661139   0.04075496556526
 -0.00000030786418   0.13990680473034   0.04075333593636
force_loc = 
  0.00000095442596   0.00000424466700   1.22184166468777
  0.04364679065765   0.02483979135626  -0.01483400661278
 -0.04364691064706   0.02484002901456  -0.01483446454022
 -0.04364380838657  -0.02483815304871  -0.01483354706630
  0.04364393351224  -0.02483839023505  -0.01483356764395
  0.00000018798223   0.00000116920504  -0.02320582597363
 -0.00000156959324   0.13706739521973  -0.04155702285835
  0.00000022463022  -0.13706969402312  -0.04155743464152
Time for calculating nonlocal force components: 42.645 ms
[32mforces_xc: 
[0m[32m  0.00000003462583   0.00000021198664   0.02906495206044
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000001309565   0.00000020861966   0.00803638717329
[0m[32m -0.00000008650537   0.00429210787772   0.00068395718903
[0m[32m  0.00000000921304  -0.00429209878768   0.00068392553935
[0mTime for calculating XC forces components: 25.660 ms
 Cartesian force = 
  0.00000121433838   0.00000437485185   0.01356155011860
  0.00150386616415   0.00074777369918  -0.00060595143213
 -0.00150415405178   0.00074800319619  -0.00060637121959
 -0.00150142500090  -0.00075218499694  -0.00060554898593
  0.00150137125731  -0.00075241557289  -0.00060555475432
  0.00000011040272   0.00000545355122  -0.01090792539322
 -0.00000082366640   0.00145696991896  -0.00011406263583
 -0.00000015944348  -0.00145797464756  -0.00011613569759
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.357 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Time for printing density: 397.025 ms
The program took 637.063 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:31:10
Job ID:        2266716
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:10:00,vmem=8468K,walltime=00:10:50,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-23-1
---------------------------------------
