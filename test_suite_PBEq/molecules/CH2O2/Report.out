---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:47
Job ID:    2266491
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:53
Job ID:    2266491
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.052 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 6.517 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 18.004 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 101.383 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.943 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.094 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   11.411074	    8.350196	
   10.000000	    8.588926	    8.350196	
   11.752470	   10.000000	   11.649804	
    8.247530	   10.000000	   11.649804	
   10.000000	   10.000000	   10.557249	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.170 ms
Set up communicators.

--set up spincomm took 2.251 ms

--set up kptcomm took 0.345 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.048 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.968 ms

Calculate_SplineDerivRadFun took 0.206 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.808 ms.
time spent on vectorized spline interp: 3.458 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.686 ms.
time spent on vectorized spline interp: 1.372 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.298 ms.
time spent on vectorized spline interp: 1.640 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.492 ms.

Calculating rb for all atom types took 16.530 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.065 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000126305, sum_int_rho = 17.7972442204687
PosCharge = 18.000000012631, NegCharge = -17.797244220469, scal_fac = 1.011392538623
After scaling, int_rho = 18.0000000126304, PosCharge + NegCharge - NetCharge = 7.816e-14
--Calculate Vref took 0.339 ms
--Calculate rho_guess took 2.161 ms

 integral of b = -18.0000000126305,
 int{b} + Nelectron + NetCharge = -1.263e-08,
 Esc = -61.2890024112201,
 MPI_Reduce took 2.476 ms

Calculating b & b_ref took 10.609 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.026 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.036 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.035 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.198 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 28.025 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263043, int_b + int_rho = -2.510e-13, checking this took 0.104 ms
2-norm of RHS = 573.1541826449655, which took 0.505 ms

iter_count = 420, r_2norm = 5.048e-04, tol*||rhs|| = 5.732e-04

Anderson update took 237.791 ms, out of which F'*F took 106.074 ms; b-Ax took 713.876 ms, out of which Lap took 641.255 ms
Solving Poisson took 1518.294 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.839 ms
Total time for convolution: 	 convolve: 5.125541 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.784 ms
Total time for convolution: 	 convolve: 5.119779 
Total time for convolution: 	 convolve: 5.121048 
Total time for convolution: 	 convolve: 5.132211 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.723 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.516 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.441 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
rank = 0, XC calculation took 24353.104 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 1.525 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.063 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.708 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.135 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.670 ms
    Lanczos iter 54, eigmin  = -1.131295440, eigmax = 264.930136016, err_eigmin = 3.301e-04, err_eigmax = 9.594e-03
rank =   0, Lanczos took 121.649 ms, eigmin = -1.131295440098, eigmax = 267.579437376514

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.174071, lowerbound = -1.231295, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1149.561 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 25.068 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.002 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.246 ms
rank =  0, Distribute data + matrix mult took 30.341 ms
rank =  0, finding HY took 20.451 ms
rank =  0, distributing HY into block cyclic form took 12.047 ms
rank =  0, finding Y'*HY took 5.362 ms
Rank 0, Project_Hamiltonian used 68.233 ms
Total time for projection: 68.429 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.432 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.201 ms
rank = 0, Solve_Generalized_EigenProblem used 0.973 ms
    first calculated eigval = 2.779037520270925
    last  calculated eigval = 3.208884835787493
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.77903752027093
lambda[   2] =   2.85932196572053
lambda[   3] =   2.88750508766286
lambda[   4] =   2.92695208520478
lambda[   5] =   2.93938712408634
lambda[   6] =   2.96539480022569
lambda[   7] =   2.99739083199285
lambda[   8] =   3.01570871611886
lambda[   9] =   3.05346867247602
lambda[  10] =   3.07712276641433
lambda[  11] =   3.09598213433982
lambda[  12] =   3.11418600104200
lambda[  13] =   3.13029243016939
lambda[  14] =   3.14789279677877
lambda[  15] =   3.20888483578749
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.993 ms
rank =  0, subspace rotation using ScaLAPACK took 3.719 ms
rank =  0, Distributing orbital back into band + domain format took 24.868 ms
rank = 0, Subspace_Rotation used 28.602 ms

Total time for subspace rotation: 28.606 ms
rank = 0, Efermi =   3.065295719840 calculate fermi energy took 0.059 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.308885, lowerbound = -1.231295, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1167.199 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.078 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.280 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.087 ms
rank =  0, Distribute data + matrix mult took 15.461 ms
rank =  0, finding HY took 19.563 ms
rank =  0, distributing HY into block cyclic form took 11.990 ms
rank =  0, finding Y'*HY took 4.163 ms
Rank 0, Project_Hamiltonian used 51.211 ms
Total time for projection: 51.215 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -0.890780213070744
    last  calculated eigval = 0.433264832860959
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89078021307074
lambda[   2] =  -0.56038484004736
lambda[   3] =  -0.32188732661645
lambda[   4] =  -0.22529512034616
lambda[   5] =  -0.02069761933801
lambda[   6] =   0.08064627698729
lambda[   7] =   0.12982570409263
lambda[   8] =   0.20740814065089
lambda[   9] =   0.24124753160937
lambda[  10] =   0.32343157633894
lambda[  11] =   0.35853374372768
lambda[  12] =   0.36338180945193
lambda[  13] =   0.38080422661122
lambda[  14] =   0.41317353070210
lambda[  15] =   0.43326483286096
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 3.554 ms
rank =  0, Distributing orbital back into band + domain format took 11.887 ms
rank = 0, Subspace_Rotation used 15.456 ms

Total time for subspace rotation: 15.461 ms
rank = 0, Efermi =   0.293854705857 calculate fermi energy took 0.021 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.533265, lowerbound = -1.231295, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1166.158 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.000 ms
rank =  0, Distribute orbital to block cyclic format took 12.128 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.309 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.466 ms
rank =  0, finding HY took 19.465 ms
rank =  0, distributing HY into block cyclic form took 11.844 ms
rank =  0, finding Y'*HY took 3.573 ms
Rank 0, Project_Hamiltonian used 51.433 ms
Total time for projection: 51.438 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -1.133166110232757
    last  calculated eigval = 0.134537202363087
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.13316611023276
lambda[   2] =  -0.84143097304555
lambda[   3] =  -0.69133828289037
lambda[   4] =  -0.54176663568312
lambda[   5] =  -0.51663351321020
lambda[   6] =  -0.42063383939003
lambda[   7] =  -0.39824352126304
lambda[   8] =  -0.32175823537041
lambda[   9] =  -0.24947353107117
lambda[  10] =  -0.04099025118334
lambda[  11] =   0.04247456155336
lambda[  12] =   0.09134319172636
lambda[  13] =   0.10144286416763
lambda[  14] =   0.13061279741539
lambda[  15] =   0.13453720236309
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.194 ms
rank =  0, subspace rotation using ScaLAPACK took 3.566 ms
rank =  0, Distributing orbital back into band + domain format took 11.878 ms
rank = 0, Subspace_Rotation used 15.465 ms

Total time for subspace rotation: 15.470 ms
rank = 0, Efermi =  -0.070567121631 calculate fermi energy took 0.033 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.234537, lowerbound = -1.231295, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1181.588 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.044 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.284 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.086 ms
rank =  0, Distribute data + matrix mult took 15.435 ms
rank =  0, finding HY took 19.484 ms
rank =  0, distributing HY into block cyclic form took 12.059 ms
rank =  0, finding Y'*HY took 4.161 ms
Rank 0, Project_Hamiltonian used 51.185 ms
Total time for projection: 51.191 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -1.133311677797127
    last  calculated eigval = 0.082394526578337
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.13331167779713
lambda[   2] =  -0.84323708365734
lambda[   3] =  -0.69363187065746
lambda[   4] =  -0.54670361014763
lambda[   5] =  -0.51984873281067
lambda[   6] =  -0.43477647827249
lambda[   7] =  -0.41813603540879
lambda[   8] =  -0.35414962567549
lambda[   9] =  -0.27904739092028
lambda[  10] =  -0.10303198799774
lambda[  11] =  -0.02626228926437
lambda[  12] =   0.02784298723176
lambda[  13] =   0.04964412581363
lambda[  14] =   0.06451852219122
lambda[  15] =   0.08239452657834
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 3.526 ms
rank =  0, Distributing orbital back into band + domain format took 11.983 ms
rank = 0, Subspace_Rotation used 15.528 ms

Total time for subspace rotation: 15.532 ms
rank = 0, Efermi =  -0.132608858510 calculate fermi energy took 0.024 ms
rank = 0, --- Calculate rho: sum over local bands took 2.174 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.062 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.163 ms
rank = 0, Calculating density took 5093.928 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.579 ms
rank = 0, D2D took 1.686 ms
rank = 0, Transfering density took 1.693 ms
Etot    =   -40.193136749172
Eband   =   -10.445685011996
E1      =    20.673049128490
E2      =    -9.628183536858
E3      =   -12.073731126474
Exc     =   -10.833413117393
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 8.039e+00, dEband = 2.089e+00
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -40.193136749, dEtot = 8.039e+00, dEband = 2.089e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 85.6388048053661, which took 0.098 ms

iter_count = 84, r_2norm = 2.545e-03, tol*||rhs|| = 3.426e-03

Anderson update took 45.246 ms, out of which F'*F took 20.974 ms; b-Ax took 141.041 ms, out of which Lap took 126.357 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 305.953 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263043, int_b + int_rho = -2.474e-13, checking this took 0.109 ms
2-norm of RHS = 571.3278152422508, which took 0.132 ms

iter_count = 270, r_2norm = 5.192e-04, tol*||rhs|| = 5.713e-04

Anderson update took 148.298 ms, out of which F'*F took 68.096 ms; b-Ax took 455.099 ms, out of which Lap took 409.406 ms
Solving Poisson took 973.762 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.783 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.152096 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.139893 
Total time for convolution: 	 convolve: 5.156036 
Total time for convolution: 	 convolve: 5.143894 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.334 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.109 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.183 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.952 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.810 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.785 ms

This SCF took 30973.332 ms, scf error = 1.513e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.182395, lowerbound = -1.133312, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1137.311 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.477 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.401 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 18.928 ms
rank =  0, finding HY took 19.366 ms
rank =  0, distributing HY into block cyclic form took 12.009 ms
rank =  0, finding Y'*HY took 4.248 ms
Rank 0, Project_Hamiltonian used 54.592 ms
Total time for projection: 54.608 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -1.131666054362022
    last  calculated eigval = 0.061458747392155
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.13166605436202
lambda[   2] =  -0.83344775758023
lambda[   3] =  -0.67279439476418
lambda[   4] =  -0.52863441674564
lambda[   5] =  -0.50616307562115
lambda[   6] =  -0.42909760117496
lambda[   7] =  -0.40509306913737
lambda[   8] =  -0.34077645268048
lambda[   9] =  -0.26792025826442
lambda[  10] =  -0.10821940644002
lambda[  11] =  -0.03129269972268
lambda[  12] =  -0.00677179684515
lambda[  13] =   0.02852785135111
lambda[  14] =   0.04570291446536
lambda[  15] =   0.06145874739215
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 3.540 ms
rank =  0, Distributing orbital back into band + domain format took 11.986 ms
rank = 0, Subspace_Rotation used 15.545 ms

Total time for subspace rotation: 15.549 ms
rank = 0, Efermi =  -0.137796276918 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 3.449 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.314 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.168 ms
rank = 0, Calculating density took 1214.198 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.512 ms
rank = 0, D2D took 0.735 ms
rank = 0, Transfering density took 0.746 ms
Etot    =   -40.173669380667
Eband   =   -10.231186162028
E1      =    20.476437988626
E2      =    -9.614254366038
E3      =   -12.150962041424
Exc     =   -10.895135203123
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 3.893e-03, dEband = 4.290e-02
rank = 0, Calculating/Estimating energy took 1.188 ms, Etot = -40.173669381, dEtot = 3.893e-03, dEband = 4.290e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 11.0616552094263, which took 0.138 ms

iter_count = 102, r_2norm = 3.086e-04, tol*||rhs|| = 4.425e-04

Anderson update took 53.950 ms, out of which F'*F took 25.079 ms; b-Ax took 172.003 ms, out of which Lap took 153.677 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.431 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263044, int_b + int_rho = -2.401e-13, checking this took 0.110 ms
2-norm of RHS = 568.8919318091949, which took 0.162 ms

iter_count = 294, r_2norm = 4.940e-04, tol*||rhs|| = 5.689e-04

Anderson update took 157.099 ms, out of which F'*F took 73.143 ms; b-Ax took 498.806 ms, out of which Lap took 446.544 ms
Solving Poisson took 1054.860 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.844 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.215157 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.130 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.235491 
Total time for convolution: 	 convolve: 5.243852 
Total time for convolution: 	 convolve: 5.252498 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.947 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.808 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.776 ms

This SCF took 27717.494 ms, scf error = 1.052e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.161459, lowerbound = -1.131666, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1168.075 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.099 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.708 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.088 ms
rank =  0, Distribute data + matrix mult took 15.913 ms
rank =  0, finding HY took 20.223 ms
rank =  0, distributing HY into block cyclic form took 12.226 ms
rank =  0, finding Y'*HY took 4.585 ms
Rank 0, Project_Hamiltonian used 52.988 ms
Total time for projection: 53.003 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -1.122793700499023
    last  calculated eigval = 0.049120951025773
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.12279370049902
lambda[   2] =  -0.80842768025625
lambda[   3] =  -0.62657011949824
lambda[   4] =  -0.48672296632954
lambda[   5] =  -0.47335654051442
lambda[   6] =  -0.40987760062851
lambda[   7] =  -0.37408700434520
lambda[   8] =  -0.30388049746616
lambda[   9] =  -0.23716958437503
lambda[  10] =  -0.09927362312392
lambda[  11] =  -0.02301862358699
lambda[  12] =  -0.00848083405556
lambda[  13] =   0.02041054271319
lambda[  14] =   0.03710440844787
lambda[  15] =   0.04912095102577
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 4.015 ms
rank =  0, Distributing orbital back into band + domain format took 11.574 ms
rank = 0, Subspace_Rotation used 15.616 ms

Total time for subspace rotation: 15.624 ms
rank = 0, Efermi =  -0.128850493614 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 2.510 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.488 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.253 ms
rank = 0, Calculating density took 1243.744 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.595 ms
rank = 0, D2D took 0.708 ms
rank = 0, Transfering density took 0.711 ms
Etot    =   -40.151848485543
Eband   =    -9.685771389079
E1      =    20.025918138315
E2      =    -9.497254768236
E3      =   -12.367880319096
Exc     =   -11.068127910507
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 4.364e-03, dEband = 1.091e-01
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -40.151848486, dEtot = 4.364e-03, dEband = 1.091e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.0393521270144, which took 0.108 ms

iter_count = 96, r_2norm = 2.230e-04, tol*||rhs|| = 2.416e-04

Anderson update took 51.275 ms, out of which F'*F took 23.689 ms; b-Ax took 161.985 ms, out of which Lap took 143.989 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 352.400 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263042, int_b + int_rho = -2.619e-13, checking this took 0.134 ms
2-norm of RHS = 569.6331558616715, which took 0.085 ms

iter_count = 246, r_2norm = 5.486e-04, tol*||rhs|| = 5.696e-04

Anderson update took 131.801 ms, out of which F'*F took 61.531 ms; b-Ax took 414.488 ms, out of which Lap took 372.565 ms
Solving Poisson took 880.649 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.130515 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.137176 
Total time for convolution: 	 convolve: 5.123618 
Total time for convolution: 	 convolve: 5.143262 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.553 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.944 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.810 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.774 ms

This SCF took 27017.489 ms, scf error = 1.679e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.149121, lowerbound = -1.122794, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1145.211 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.015 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.352 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 15.391 ms
rank =  0, finding HY took 19.413 ms
rank =  0, distributing HY into block cyclic form took 12.429 ms
rank =  0, finding Y'*HY took 5.279 ms
Rank 0, Project_Hamiltonian used 52.545 ms
Total time for projection: 52.559 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -1.118570155565507
    last  calculated eigval = 0.040780837517498
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.11857015556551
lambda[   2] =  -0.80617717437921
lambda[   3] =  -0.62468888642763
lambda[   4] =  -0.48405732758902
lambda[   5] =  -0.47176703087921
lambda[   6] =  -0.40748060188424
lambda[   7] =  -0.37238652176642
lambda[   8] =  -0.30077034005159
lambda[   9] =  -0.23434157484438
lambda[  10] =  -0.09667644079361
lambda[  11] =  -0.02649837943187
lambda[  12] =  -0.01199617706201
lambda[  13] =   0.01613473364314
lambda[  14] =   0.03122450426467
lambda[  15] =   0.04078083751750
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.168 ms
rank =  0, subspace rotation using ScaLAPACK took 3.906 ms
rank =  0, Distributing orbital back into band + domain format took 11.609 ms
rank = 0, Subspace_Rotation used 15.536 ms

Total time for subspace rotation: 15.546 ms
rank = 0, Efermi =  -0.126253311286 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 2.867 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.621 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.192 ms
rank = 0, Calculating density took 1221.263 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.517 ms
rank = 0, D2D took 0.617 ms
rank = 0, Transfering density took 0.622 ms
Etot    =   -40.151163703147
Eband   =    -9.640479227995
E1      =    20.015827007901
E2      =    -9.459648807275
E3      =   -12.375889675308
Exc     =   -11.073047554030
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 1.370e-04, dEband = 9.058e-03
rank = 0, Calculating/Estimating energy took 0.891 ms, Etot = -40.151163703, dEtot = 1.370e-04, dEband = 9.058e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 1.2309063329796, which took 0.050 ms

iter_count = 108, r_2norm = 4.035e-05, tol*||rhs|| = 4.924e-05

Anderson update took 56.562 ms, out of which F'*F took 26.375 ms; b-Ax took 180.711 ms, out of which Lap took 161.361 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.053 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263043, int_b + int_rho = -2.510e-13, checking this took 0.124 ms
2-norm of RHS = 570.3299131768962, which took 0.112 ms

iter_count = 252, r_2norm = 5.050e-04, tol*||rhs|| = 5.703e-04

Anderson update took 132.750 ms, out of which F'*F took 61.343 ms; b-Ax took 426.534 ms, out of which Lap took 377.575 ms
Solving Poisson took 902.078 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.090781 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.459 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.083616 
Total time for convolution: 	 convolve: 5.107612 
Total time for convolution: 	 convolve: 5.100450 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.964 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.794 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.781 ms

This SCF took 26919.906 ms, scf error = 8.425e-03
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.140781, lowerbound = -1.118570, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1168.024 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.068 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.237 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.091 ms
rank =  0, Distribute data + matrix mult took 15.410 ms
rank =  0, finding HY took 19.323 ms
rank =  0, distributing HY into block cyclic form took 11.858 ms
rank =  0, finding Y'*HY took 4.463 ms
Rank 0, Project_Hamiltonian used 51.087 ms
Total time for projection: 51.100 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.982 ms
    first calculated eigval = -1.114450127290699
    last  calculated eigval = 0.036053430505056
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.11445012729070
lambda[   2] =  -0.80318672076588
lambda[   3] =  -0.62104987361189
lambda[   4] =  -0.47993512546092
lambda[   5] =  -0.46894882637257
lambda[   6] =  -0.40445389357505
lambda[   7] =  -0.36952605088646
lambda[   8] =  -0.29667597503754
lambda[   9] =  -0.23086242858463
lambda[  10] =  -0.09388203168682
lambda[  11] =  -0.02818725435058
lambda[  12] =  -0.01214221969474
lambda[  13] =   0.01437063131925
lambda[  14] =   0.02702341058586
lambda[  15] =   0.03605343050506
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 1.015 ms
rank =  0, subspace rotation using ScaLAPACK took 4.105 ms
rank =  0, Distributing orbital back into band + domain format took 11.841 ms
rank = 0, Subspace_Rotation used 15.968 ms

Total time for subspace rotation: 15.976 ms
rank = 0, Efermi =  -0.123458902198 calculate fermi energy took 2.192 ms
rank = 0, --- Calculate rho: sum over local bands took 3.176 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.865 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.171 ms
rank = 0, Calculating density took 1243.589 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
rank = 0, D2D took 0.790 ms
rank = 0, Transfering density took 0.799 ms
Etot    =   -40.150717000898
Eband   =    -9.578178044357
E1      =    19.992339519086
E2      =    -9.416949596194
E3      =   -12.390043786233
Exc     =   -11.082869446450
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 8.934e-05, dEband = 1.246e-02
rank = 0, Calculating/Estimating energy took 1.055 ms, Etot = -40.150717001, dEtot = 8.934e-05, dEband = 1.246e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5133232107366, which took 0.062 ms

iter_count = 108, r_2norm = 1.904e-05, tol*||rhs|| = 2.053e-05

Anderson update took 57.139 ms, out of which F'*F took 26.717 ms; b-Ax took 186.552 ms, out of which Lap took 167.666 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.347 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263037, int_b + int_rho = -3.165e-13, checking this took 0.106 ms
2-norm of RHS = 570.6027011658916, which took 0.117 ms

iter_count = 234, r_2norm = 5.485e-04, tol*||rhs|| = 5.706e-04

Anderson update took 126.019 ms, out of which F'*F took 58.039 ms; b-Ax took 396.839 ms, out of which Lap took 354.207 ms
Solving Poisson took 840.547 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.121747 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.079427 
Total time for convolution: 	 convolve: 5.082835 
Total time for convolution: 	 convolve: 5.082301 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.604 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.943 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.327 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.291 ms

This SCF took 26858.892 ms, scf error = 3.075e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.136053, lowerbound = -1.114450, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1159.394 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.019 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.422 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.039 ms
rank =  0, Distribute data + matrix mult took 15.499 ms
rank =  0, finding HY took 19.397 ms
rank =  0, distributing HY into block cyclic form took 11.969 ms
rank =  0, finding Y'*HY took 3.946 ms
Rank 0, Project_Hamiltonian used 51.309 ms
Total time for projection: 51.324 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -1.112460703841112
    last  calculated eigval = 0.033612422938612
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.11246070384111
lambda[   2] =  -0.80129906938247
lambda[   3] =  -0.61902864199731
lambda[   4] =  -0.47785086729544
lambda[   5] =  -0.46700419556803
lambda[   6] =  -0.40264662345062
lambda[   7] =  -0.36756358583232
lambda[   8] =  -0.29485200633776
lambda[   9] =  -0.22909488293479
lambda[  10] =  -0.09233471734629
lambda[  11] =  -0.02876733203494
lambda[  12] =  -0.01192736618175
lambda[  13] =   0.01372877340273
lambda[  14] =   0.02379334719693
lambda[  15] =   0.03361242293861
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 3.618 ms
rank =  0, Distributing orbital back into band + domain format took 11.925 ms
rank = 0, Subspace_Rotation used 15.562 ms

Total time for subspace rotation: 15.568 ms
rank = 0, Efermi =  -0.121911587811 calculate fermi energy took 0.108 ms
rank = 0, --- Calculate rho: sum over local bands took 3.091 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.258 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.167 ms
rank = 0, Calculating density took 1233.185 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.586 ms
rank = 0, D2D took 0.822 ms
rank = 0, Transfering density took 0.825 ms
Etot    =   -40.150554068446
Eband   =    -9.543601154446
E1      =    19.978587664720
E2      =    -9.394802124717
E3      =   -12.394281429781
Exc     =   -11.085621721613
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 3.259e-05, dEband = 6.915e-03
rank = 0, Calculating/Estimating energy took 1.109 ms, Etot = -40.150554068, dEtot = 3.259e-05, dEband = 6.915e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3122019660368, which took 0.076 ms

iter_count = 108, r_2norm = 1.084e-05, tol*||rhs|| = 1.249e-05

Anderson update took 57.863 ms, out of which F'*F took 26.875 ms; b-Ax took 183.521 ms, out of which Lap took 164.038 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.918 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263039, int_b + int_rho = -2.874e-13, checking this took 0.128 ms
2-norm of RHS = 570.7254262306197, which took 0.082 ms

iter_count = 234, r_2norm = 5.060e-04, tol*||rhs|| = 5.707e-04

Anderson update took 125.083 ms, out of which F'*F took 63.231 ms; b-Ax took 397.222 ms, out of which Lap took 356.205 ms
Solving Poisson took 841.686 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.087425 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.090815 
Total time for convolution: 	 convolve: 5.087013 
Total time for convolution: 	 convolve: 5.093486 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.921 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.333 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.274 ms

This SCF took 26829.233 ms, scf error = 1.631e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.133612, lowerbound = -1.112461, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1162.830 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.363 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.936 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 15.347 ms
rank =  0, finding HY took 19.429 ms
rank =  0, distributing HY into block cyclic form took 11.988 ms
rank =  0, finding Y'*HY took 4.281 ms
Rank 0, Project_Hamiltonian used 51.609 ms
Total time for projection: 51.623 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -1.110249113917454
    last  calculated eigval = 0.032730895743285
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.11024911391745
lambda[   2] =  -0.79906568602289
lambda[   3] =  -0.61734096617459
lambda[   4] =  -0.47605706158344
lambda[   5] =  -0.46487929814003
lambda[   6] =  -0.40056142146270
lambda[   7] =  -0.36541617060974
lambda[   8] =  -0.29295480229496
lambda[   9] =  -0.22684542043111
lambda[  10] =  -0.09021475734804
lambda[  11] =  -0.02830534482681
lambda[  12] =  -0.01122117457916
lambda[  13] =   0.01431142228853
lambda[  14] =   0.02146523363885
lambda[  15] =   0.03273089574329
==subpsace eigenproblem: bcast eigvals took 0.103 ms
Total time for solving subspace eigenvalue problem: 0.289 ms
rank =  0, subspace rotation using ScaLAPACK took 3.598 ms
rank =  0, Distributing orbital back into band + domain format took 11.983 ms
rank = 0, Subspace_Rotation used 15.600 ms

Total time for subspace rotation: 15.604 ms
rank = 0, Efermi =  -0.119791627888 calculate fermi energy took 0.106 ms
rank = 0, --- Calculate rho: sum over local bands took 3.089 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.264 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.184 ms
rank = 0, Calculating density took 1237.063 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.587 ms
rank = 0, D2D took 0.863 ms
rank = 0, Transfering density took 0.867 ms
Etot    =   -40.150509302562
Eband   =    -9.506739882413
E1      =    19.961412888162
E2      =    -9.373763287659
E3      =   -12.398894191325
Exc     =   -11.088837375690
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 8.953e-06, dEband = 7.372e-03
rank = 0, Calculating/Estimating energy took 1.003 ms, Etot = -40.150509303, dEtot = 8.953e-06, dEband = 7.372e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2317066723241, which took 0.057 ms

iter_count = 108, r_2norm = 7.262e-06, tol*||rhs|| = 9.268e-06

Anderson update took 57.237 ms, out of which F'*F took 27.042 ms; b-Ax took 183.535 ms, out of which Lap took 164.520 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.681 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263038, int_b + int_rho = -3.056e-13, checking this took 0.123 ms
2-norm of RHS = 570.7030614383058, which took 0.130 ms

iter_count = 210, r_2norm = 4.733e-04, tol*||rhs|| = 5.707e-04

Anderson update took 111.740 ms, out of which F'*F took 52.655 ms; b-Ax took 355.700 ms, out of which Lap took 318.247 ms
Solving Poisson took 751.202 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.089 ms
Total time for convolution: 	 convolve: 5.107902 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.093685 
Total time for convolution: 	 convolve: 5.088401 
Total time for convolution: 	 convolve: 5.101020 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
---Transfer Veff_loc: D2D took 0.953 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.315 ms

This SCF took 26770.724 ms, scf error = 9.553e-04
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.132731, lowerbound = -1.110249, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1166.523 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.905 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.427 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 15.364 ms
rank =  0, finding HY took 19.513 ms
rank =  0, distributing HY into block cyclic form took 11.937 ms
rank =  0, finding Y'*HY took 4.371 ms
Rank 0, Project_Hamiltonian used 51.219 ms
Total time for projection: 51.231 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -1.109311196722461
    last  calculated eigval = 0.032621543352692
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.10931119672246
lambda[   2] =  -0.79805395655819
lambda[   3] =  -0.61657679377877
lambda[   4] =  -0.47528282154021
lambda[   5] =  -0.46389982326539
lambda[   6] =  -0.39962213547681
lambda[   7] =  -0.36441581856230
lambda[   8] =  -0.29211921557408
lambda[   9] =  -0.22580770520323
lambda[  10] =  -0.08921243081637
lambda[  11] =  -0.02761553229261
lambda[  12] =  -0.01059358079201
lambda[  13] =   0.01502740280458
lambda[  14] =   0.01953439682491
lambda[  15] =   0.03262154335269
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 3.603 ms
rank =  0, Distributing orbital back into band + domain format took 11.986 ms
rank = 0, Subspace_Rotation used 15.604 ms

Total time for subspace rotation: 15.610 ms
rank = 0, Efermi =  -0.118789301318 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 3.139 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.260 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.170 ms
rank = 0, Calculating density took 1240.252 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.577 ms
rank = 0, D2D took 0.879 ms
rank = 0, Transfering density took 0.882 ms
Etot    =   -40.150558152855
Eband   =    -9.490178934490
E1      =    19.952487082935
E2      =    -9.365711332247
E3      =   -12.400538260917
Exc     =   -11.090113482859
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 9.770e-06, dEband = 3.312e-03
rank = 0, Calculating/Estimating energy took 0.975 ms, Etot = -40.150558153, dEtot = 9.770e-06, dEband = 3.312e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1453472760893, which took 0.061 ms

iter_count = 108, r_2norm = 5.001e-06, tol*||rhs|| = 5.814e-06

Anderson update took 57.200 ms, out of which F'*F took 26.956 ms; b-Ax took 183.371 ms, out of which Lap took 164.238 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.834 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263051, int_b + int_rho = -1.746e-13, checking this took 0.114 ms
2-norm of RHS = 570.7227568999105, which took 0.180 ms

iter_count = 216, r_2norm = 4.713e-04, tol*||rhs|| = 5.707e-04

Anderson update took 115.030 ms, out of which F'*F took 54.042 ms; b-Ax took 365.663 ms, out of which Lap took 327.009 ms
Solving Poisson took 773.850 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.101984 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.098748 
Total time for convolution: 	 convolve: 5.084193 
Total time for convolution: 	 convolve: 5.087762 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.009 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 1.731 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.327 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.083 ms

This SCF took 26761.686 ms, scf error = 6.965e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.132622, lowerbound = -1.109311, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1159.132 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.092 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.237 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.106 ms
rank =  0, Distribute data + matrix mult took 15.450 ms
rank =  0, finding HY took 19.315 ms
rank =  0, distributing HY into block cyclic form took 11.894 ms
rank =  0, finding Y'*HY took 4.418 ms
Rank 0, Project_Hamiltonian used 51.106 ms
Total time for projection: 51.118 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -1.108077561160027
    last  calculated eigval = 0.033503304150755
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.10807756116003
lambda[   2] =  -0.79691786650385
lambda[   3] =  -0.61559446112309
lambda[   4] =  -0.47425168635795
lambda[   5] =  -0.46280918452043
lambda[   6] =  -0.39851854116920
lambda[   7] =  -0.36328569372783
lambda[   8] =  -0.29106604670496
lambda[   9] =  -0.22462926569109
lambda[  10] =  -0.08795038776371
lambda[  11] =  -0.02561878605020
lambda[  12] =  -0.00879198140975
lambda[  13] =   0.01726959626639
lambda[  14] =   0.01927245232292
lambda[  15] =   0.03350330415076
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 3.638 ms
rank =  0, Distributing orbital back into band + domain format took 11.993 ms
rank = 0, Subspace_Rotation used 15.647 ms

Total time for subspace rotation: 15.652 ms
rank = 0, Efermi =  -0.117527258245 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 3.106 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.211 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 1232.715 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.607 ms
rank = 0, D2D took 0.815 ms
rank = 0, Transfering density took 0.818 ms
Etot    =   -40.150604932411
Eband   =    -9.470300615028
E1      =    19.943154779501
E2      =    -9.354815254095
E3      =   -12.401839942207
Exc     =   -11.091111881582
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 9.356e-06, dEband = 3.976e-03
rank = 0, Calculating/Estimating energy took 0.952 ms, Etot = -40.150604932, dEtot = 9.356e-06, dEband = 3.976e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0949047497132, which took 0.106 ms

iter_count = 108, r_2norm = 3.464e-06, tol*||rhs|| = 3.796e-06

Anderson update took 57.289 ms, out of which F'*F took 26.978 ms; b-Ax took 183.682 ms, out of which Lap took 164.346 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.622 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263041, int_b + int_rho = -2.728e-13, checking this took 0.077 ms
2-norm of RHS = 570.7159155772473, which took 0.102 ms

iter_count = 192, r_2norm = 5.430e-04, tol*||rhs|| = 5.707e-04

Anderson update took 101.811 ms, out of which F'*F took 47.977 ms; b-Ax took 326.800 ms, out of which Lap took 292.295 ms
Solving Poisson took 688.677 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.093551 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.293 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.110746 
Total time for convolution: 	 convolve: 5.092167 
Total time for convolution: 	 convolve: 5.110442 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.771 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.943 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.326 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.292 ms

This SCF took 26719.952 ms, scf error = 4.286e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.133503, lowerbound = -1.108078, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1166.593 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.007 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.327 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.106 ms
rank =  0, Distribute data + matrix mult took 15.454 ms
rank =  0, finding HY took 19.456 ms
rank =  0, distributing HY into block cyclic form took 11.962 ms
rank =  0, finding Y'*HY took 4.234 ms
Rank 0, Project_Hamiltonian used 51.135 ms
Total time for projection: 51.147 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -1.107395826932040
    last  calculated eigval = 0.034123497885351
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.10739582693204
lambda[   2] =  -0.79624785153543
lambda[   3] =  -0.61503164888110
lambda[   4] =  -0.47366669020593
lambda[   5] =  -0.46217473367711
lambda[   6] =  -0.39787873302175
lambda[   7] =  -0.36263581013850
lambda[   8] =  -0.29046562015343
lambda[   9] =  -0.22395157955088
lambda[  10] =  -0.08722929072317
lambda[  11] =  -0.02384813220552
lambda[  12] =  -0.00730483727629
lambda[  13] =   0.01887313727850
lambda[  14] =   0.01957215957378
lambda[  15] =   0.03412349788535
==subpsace eigenproblem: bcast eigvals took 0.052 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 3.604 ms
rank =  0, Distributing orbital back into band + domain format took 11.956 ms
rank = 0, Subspace_Rotation used 15.574 ms

Total time for subspace rotation: 15.580 ms
rank = 0, Efermi =  -0.116806161176 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.046 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.308 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.179 ms
rank = 0, Calculating density took 1240.176 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.578 ms
rank = 0, D2D took 0.870 ms
rank = 0, Transfering density took 0.874 ms
Etot    =   -40.150635434321
Eband   =    -9.458896989294
E1      =    19.937303073143
E2      =    -9.349063111812
E3      =   -12.402735968586
Exc     =   -11.091838186963
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 6.100e-06, dEband = 2.281e-03
rank = 0, Calculating/Estimating energy took 0.987 ms, Etot = -40.150635434, dEtot = 6.100e-06, dEband = 2.281e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0600434953711, which took 0.087 ms

iter_count = 108, r_2norm = 1.860e-06, tol*||rhs|| = 2.402e-06

Anderson update took 57.264 ms, out of which F'*F took 27.084 ms; b-Ax took 183.452 ms, out of which Lap took 164.446 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.578 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263047, int_b + int_rho = -2.110e-13, checking this took 0.127 ms
2-norm of RHS = 570.7273245693351, which took 0.089 ms

iter_count = 198, r_2norm = 4.802e-04, tol*||rhs|| = 5.707e-04

Anderson update took 105.259 ms, out of which F'*F took 49.487 ms; b-Ax took 335.521 ms, out of which Lap took 299.968 ms
Solving Poisson took 709.380 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.089821 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.086418 
Total time for convolution: 	 convolve: 5.104284 
Total time for convolution: 	 convolve: 5.089643 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.745 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
---Transfer Veff_loc: D2D took 0.921 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.344 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.285 ms

This SCF took 26699.073 ms, scf error = 3.207e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.134123, lowerbound = -1.107396, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1165.317 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.980 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.330 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.088 ms
rank =  0, Distribute data + matrix mult took 15.413 ms
rank =  0, finding HY took 19.470 ms
rank =  0, distributing HY into block cyclic form took 11.966 ms
rank =  0, finding Y'*HY took 4.287 ms
Rank 0, Project_Hamiltonian used 51.171 ms
Total time for projection: 51.183 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.095 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -1.106570585708668
    last  calculated eigval = 0.036488435671768
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.10657058570867
lambda[   2] =  -0.79544500644686
lambda[   3] =  -0.61430419210888
lambda[   4] =  -0.47291079890544
lambda[   5] =  -0.46142048690221
lambda[   6] =  -0.39710262803326
lambda[   7] =  -0.36187107099143
lambda[   8] =  -0.28973318224171
lambda[   9] =  -0.22318540132320
lambda[  10] =  -0.08641629850181
lambda[  11] =  -0.02040469208358
lambda[  12] =  -0.00508460294709
lambda[  13] =   0.02000698732135
lambda[  14] =   0.02248655879108
lambda[  15] =   0.03648843567177
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 3.634 ms
rank =  0, Distributing orbital back into band + domain format took 11.941 ms
rank = 0, Subspace_Rotation used 15.590 ms

Total time for subspace rotation: 15.595 ms
rank = 0, Efermi =  -0.115993168992 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 3.042 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.326 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.165 ms
rank = 0, Calculating density took 1238.936 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.568 ms
rank = 0, D2D took 0.858 ms
rank = 0, Transfering density took 0.861 ms
Etot    =   -40.150680673282
Eband   =    -9.445086706415
E1      =    19.930516865169
E2      =    -9.341808678218
E3      =   -12.403682445901
Exc     =   -11.092599544551
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 9.048e-06, dEband = 2.762e-03
rank = 0, Calculating/Estimating energy took 1.805 ms, Etot = -40.150680673, dEtot = 9.048e-06, dEband = 2.762e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0363645690603, which took 0.052 ms

iter_count = 114, r_2norm = 9.514e-07, tol*||rhs|| = 1.455e-06

Anderson update took 60.577 ms, out of which F'*F took 28.502 ms; b-Ax took 193.413 ms, out of which Lap took 173.253 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 414.911 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263036, int_b + int_rho = -3.238e-13, checking this took 0.148 ms
2-norm of RHS = 570.7236961543899, which took 0.119 ms

iter_count = 150, r_2norm = 5.361e-04, tol*||rhs|| = 5.707e-04

Anderson update took 79.809 ms, out of which F'*F took 37.655 ms; b-Ax took 253.692 ms, out of which Lap took 226.975 ms
Solving Poisson took 537.650 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.088359 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 14.672 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.088444 
Total time for convolution: 	 convolve: 5.125115 
Total time for convolution: 	 convolve: 5.109136 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.674 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.948 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.304 ms

This SCF took 26608.550 ms, scf error = 2.005e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.136488, lowerbound = -1.106571, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1156.225 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.015 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.366 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.114 ms
rank =  0, Distribute data + matrix mult took 15.512 ms
rank =  0, finding HY took 19.374 ms
rank =  0, distributing HY into block cyclic form took 12.009 ms
rank =  0, finding Y'*HY took 4.325 ms
Rank 0, Project_Hamiltonian used 51.250 ms
Total time for projection: 51.268 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -1.106369226562074
    last  calculated eigval = 0.037024515504985
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.10636922656207
lambda[   2] =  -0.79522992196352
lambda[   3] =  -0.61411997429676
lambda[   4] =  -0.47272726243429
lambda[   5] =  -0.46121483067857
lambda[   6] =  -0.39689510203426
lambda[   7] =  -0.36166193176396
lambda[   8] =  -0.28954125832172
lambda[   9] =  -0.22297303792050
lambda[  10] =  -0.08624189265920
lambda[  11] =  -0.01937658726724
lambda[  12] =  -0.00467261079994
lambda[  13] =   0.01988449084264
lambda[  14] =   0.02322106134340
lambda[  15] =   0.03702451550499
==subpsace eigenproblem: bcast eigvals took 0.082 ms
Total time for solving subspace eigenvalue problem: 0.238 ms
rank =  0, subspace rotation using ScaLAPACK took 3.599 ms
rank =  0, Distributing orbital back into band + domain format took 12.019 ms
rank = 0, Subspace_Rotation used 15.632 ms

Total time for subspace rotation: 15.637 ms
rank = 0, Efermi =  -0.115818763198 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 3.088 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.271 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.176 ms
rank = 0, Calculating density took 1230.029 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.930 ms
rank = 0, D2D took 2.033 ms
rank = 0, Transfering density took 2.038 ms
Etot    =   -40.150703550316
Eband   =    -9.441465093041
E1      =    19.928590469917
E2      =    -9.340039250339
E3      =   -12.403969455010
Exc     =   -11.092835220938
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 4.575e-06, dEband = 7.243e-04
rank = 0, Calculating/Estimating energy took 0.898 ms, Etot = -40.150703550, dEtot = 4.575e-06, dEband = 7.243e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0291979600812, which took 0.063 ms

iter_count = 108, r_2norm = 1.072e-06, tol*||rhs|| = 1.168e-06

Anderson update took 57.335 ms, out of which F'*F took 27.047 ms; b-Ax took 187.475 ms, out of which Lap took 168.633 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.877 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263043, int_b + int_rho = -2.510e-13, checking this took 0.106 ms
2-norm of RHS = 570.7347227093068, which took 0.087 ms

iter_count = 168, r_2norm = 4.961e-04, tol*||rhs|| = 5.707e-04

Anderson update took 89.452 ms, out of which F'*F took 42.212 ms; b-Ax took 284.439 ms, out of which Lap took 254.681 ms
Solving Poisson took 602.657 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.091662 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.100433 
Total time for convolution: 	 convolve: 5.091397 
Total time for convolution: 	 convolve: 5.108698 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.585 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 0.939 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.343 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.307 ms

This SCF took 26606.822 ms, scf error = 1.516e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.137025, lowerbound = -1.106369, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1020.686 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.000 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.392 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 15.436 ms
rank =  0, finding HY took 19.593 ms
rank =  0, distributing HY into block cyclic form took 11.975 ms
rank =  0, finding Y'*HY took 4.297 ms
Rank 0, Project_Hamiltonian used 51.336 ms
Total time for projection: 51.349 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -1.106198943953243
    last  calculated eigval = 0.038232229847992
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.10619894395324
lambda[   2] =  -0.79504822800882
lambda[   3] =  -0.61387882204924
lambda[   4] =  -0.47249949616209
lambda[   5] =  -0.46101378341466
lambda[   6] =  -0.39669912973745
lambda[   7] =  -0.36145756826988
lambda[   8] =  -0.28932783885740
lambda[   9] =  -0.22279209298365
lambda[  10] =  -0.08618232858750
lambda[  11] =  -0.01727036156779
lambda[  12] =  -0.00480416460189
lambda[  13] =   0.01996629792620
lambda[  14] =   0.02476659422227
lambda[  15] =   0.03823222984799
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 3.645 ms
rank =  0, Distributing orbital back into band + domain format took 11.986 ms
rank = 0, Subspace_Rotation used 15.645 ms

Total time for subspace rotation: 15.650 ms
rank = 0, Efermi =  -0.115759199026 calculate fermi energy took 0.100 ms
rank = 0, --- Calculate rho: sum over local bands took 3.174 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.248 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.158 ms
rank = 0, Calculating density took 1094.511 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
rank = 0, D2D took 1.026 ms
rank = 0, Transfering density took 1.034 ms
Etot    =   -40.150745283360
Eband   =    -9.437831807961
E1      =    19.927105628356
E2      =    -9.337851557159
E3      =   -12.403990083754
Exc     =   -11.092858333063
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 8.347e-06, dEband = 7.267e-04
rank = 0, Calculating/Estimating energy took 0.906 ms, Etot = -40.150745283, dEtot = 8.347e-06, dEband = 7.267e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0246706784608, which took 0.047 ms

iter_count = 114, r_2norm = 6.533e-07, tol*||rhs|| = 9.868e-07

Anderson update took 60.626 ms, out of which F'*F took 28.471 ms; b-Ax took 193.640 ms, out of which Lap took 173.429 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.334 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263041, int_b + int_rho = -2.692e-13, checking this took 0.123 ms
2-norm of RHS = 570.7303908857107, which took 0.134 ms

iter_count = 78, r_2norm = 4.941e-04, tol*||rhs|| = 5.707e-04

Anderson update took 41.419 ms, out of which F'*F took 19.613 ms; b-Ax took 132.245 ms, out of which Lap took 118.267 ms
Solving Poisson took 281.501 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.090575 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.089354 
Total time for convolution: 	 convolve: 5.086353 
Total time for convolution: 	 convolve: 5.092518 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.520 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.729 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.473 ms
---Transfer Veff_loc: D2D took 0.927 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.278 ms

This SCF took 26151.996 ms, scf error = 1.412e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.138232, lowerbound = -1.106199, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1146.665 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.001 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.354 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.376 ms
rank =  0, finding HY took 19.384 ms
rank =  0, distributing HY into block cyclic form took 12.021 ms
rank =  0, finding Y'*HY took 4.223 ms
Rank 0, Project_Hamiltonian used 51.033 ms
Total time for projection: 51.045 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -1.106165540001271
    last  calculated eigval = 0.038208123980543
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.10616554000127
lambda[   2] =  -0.79501341618130
lambda[   3] =  -0.61386549902802
lambda[   4] =  -0.47248456621043
lambda[   5] =  -0.46098631505970
lambda[   6] =  -0.39666867231350
lambda[   7] =  -0.36142939180963
lambda[   8] =  -0.28930667060214
lambda[   9] =  -0.22275865681150
lambda[  10] =  -0.08614726368257
lambda[  11] =  -0.01711422389880
lambda[  12] =  -0.00474458832675
lambda[  13] =   0.01974909861889
lambda[  14] =   0.02479884805401
lambda[  15] =   0.03820812398054
==subpsace eigenproblem: bcast eigvals took 0.037 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 3.355 ms
rank =  0, Distributing orbital back into band + domain format took 11.939 ms
rank = 0, Subspace_Rotation used 15.308 ms

Total time for subspace rotation: 15.314 ms
rank = 0, Efermi =  -0.115724134154 calculate fermi energy took 0.173 ms
rank = 0, --- Calculate rho: sum over local bands took 3.042 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.216 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.158 ms
rank = 0, Calculating density took 1219.879 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.523 ms
rank = 0, D2D took 0.754 ms
rank = 0, Transfering density took 0.756 ms
Etot    =   -40.150743656916
Eband   =    -9.437357457123
E1      =    19.926771925314
E2      =    -9.337704339871
E3      =   -12.404047000636
Exc     =   -11.092907054010
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 3.253e-07, dEband = 9.487e-05
rank = 0, Calculating/Estimating energy took 1.447 ms, Etot = -40.150743657, dEtot = 3.253e-07, dEband = 9.487e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0210269630426, which took 0.047 ms

iter_count = 114, r_2norm = 5.299e-07, tol*||rhs|| = 8.411e-07

Anderson update took 60.944 ms, out of which F'*F took 28.505 ms; b-Ax took 193.761 ms, out of which Lap took 173.810 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.679 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263041, int_b + int_rho = -2.692e-13, checking this took 0.162 ms
2-norm of RHS = 570.7303479120136, which took 0.122 ms

iter_count = 138, r_2norm = 5.545e-04, tol*||rhs|| = 5.707e-04

Anderson update took 73.383 ms, out of which F'*F took 34.622 ms; b-Ax took 233.379 ms, out of which Lap took 208.784 ms
Solving Poisson took 495.250 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.099712 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.086736 
Total time for convolution: 	 convolve: 5.091974 
Total time for convolution: 	 convolve: 5.090816 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.048 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.935 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.295 ms

This SCF took 26497.658 ms, scf error = 1.151e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.138208, lowerbound = -1.106166, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1163.052 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.143 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.310 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 15.474 ms
rank =  0, finding HY took 19.354 ms
rank =  0, distributing HY into block cyclic form took 11.905 ms
rank =  0, finding Y'*HY took 4.349 ms
Rank 0, Project_Hamiltonian used 51.112 ms
Total time for projection: 51.124 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -1.106103673801460
    last  calculated eigval = 0.039356466839273
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.10610367380146
lambda[   2] =  -0.79495510322368
lambda[   3] =  -0.61380525729069
lambda[   4] =  -0.47242448047704
lambda[   5] =  -0.46093004372499
lambda[   6] =  -0.39660850761671
lambda[   7] =  -0.36137192384096
lambda[   8] =  -0.28925051169916
lambda[   9] =  -0.22270502008850
lambda[  10] =  -0.08611450592651
lambda[  11] =  -0.01628618910176
lambda[  12] =  -0.00476572717230
lambda[  13] =   0.01921473862471
lambda[  14] =   0.02515196843277
lambda[  15] =   0.03935646683927
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 3.308 ms
rank =  0, Distributing orbital back into band + domain format took 11.843 ms
rank = 0, Subspace_Rotation used 15.167 ms

Total time for subspace rotation: 15.173 ms
rank = 0, Efermi =  -0.115691376385 calculate fermi energy took 0.085 ms
rank = 0, --- Calculate rho: sum over local bands took 2.906 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.393 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.170 ms
rank = 0, Calculating density took 1236.161 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.512 ms
rank = 0, D2D took 0.694 ms
rank = 0, Transfering density took 0.697 ms
Etot    =   -40.150761489743
Eband   =    -9.436309044614
E1      =    19.926345418079
E2      =    -9.337098882000
E3      =   -12.403922695721
Exc     =   -11.092817029324
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 3.567e-06, dEband = 2.097e-04
rank = 0, Calculating/Estimating energy took 1.583 ms, Etot = -40.150761490, dEtot = 3.567e-06, dEband = 2.097e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0283011329107, which took 0.099 ms

iter_count = 108, r_2norm = 8.714e-07, tol*||rhs|| = 1.132e-06

Anderson update took 57.451 ms, out of which F'*F took 26.966 ms; b-Ax took 183.440 ms, out of which Lap took 164.228 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.994 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263043, int_b + int_rho = -2.547e-13, checking this took 0.132 ms
2-norm of RHS = 570.7362622446229, which took 0.104 ms

iter_count = 108, r_2norm = 5.576e-04, tol*||rhs|| = 5.707e-04

Anderson update took 57.384 ms, out of which F'*F took 27.004 ms; b-Ax took 182.879 ms, out of which Lap took 163.710 ms
Solving Poisson took 388.974 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.096793 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.539 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.086933 
Total time for convolution: 	 convolve: 5.085245 
Total time for convolution: 	 convolve: 5.093796 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.714 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.149 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.960 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.333 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.318 ms

This SCF took 26380.837 ms, scf error = 1.158e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.139356, lowerbound = -1.106104, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1154.302 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.036 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.310 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.367 ms
rank =  0, finding HY took 19.421 ms
rank =  0, distributing HY into block cyclic form took 12.131 ms
rank =  0, finding Y'*HY took 4.115 ms
Rank 0, Project_Hamiltonian used 51.066 ms
Total time for projection: 51.079 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.834 ms
    first calculated eigval = -1.106237141521847
    last  calculated eigval = 0.038515376553610
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.10623714152185
lambda[   2] =  -0.79508343386240
lambda[   3] =  -0.61389893556439
lambda[   4] =  -0.47252155993591
lambda[   5] =  -0.46104375027857
lambda[   6] =  -0.39672520303648
lambda[   7] =  -0.36148947333546
lambda[   8] =  -0.28935178249442
lambda[   9] =  -0.22282899051168
lambda[  10] =  -0.08624188103675
lambda[  11] =  -0.01680384720232
lambda[  12] =  -0.00502252090341
lambda[  13] =   0.01906426781735
lambda[  14] =   0.02480553242613
lambda[  15] =   0.03851537655361
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.859 ms
rank =  0, subspace rotation using ScaLAPACK took 4.077 ms
rank =  0, Distributing orbital back into band + domain format took 11.848 ms
rank = 0, Subspace_Rotation used 15.942 ms

Total time for subspace rotation: 15.949 ms
rank = 0, Efermi =  -0.115818751453 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.209 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.155 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.194 ms
rank = 0, Calculating density took 1228.873 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.658 ms
rank = 0, D2D took 0.847 ms
rank = 0, Transfering density took 0.854 ms
Etot    =   -40.150758611783
Eband   =    -9.438360542172
E1      =    19.927623787770
E2      =    -9.337936295156
E3      =   -12.403628837114
Exc     =   -11.092584578048
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 5.756e-07, dEband = 4.103e-04
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -40.150758612, dEtot = 5.756e-07, dEband = 4.103e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0180323373568, which took 0.099 ms

iter_count = 108, r_2norm = 6.060e-07, tol*||rhs|| = 7.213e-07

Anderson update took 57.474 ms, out of which F'*F took 26.954 ms; b-Ax took 183.746 ms, out of which Lap took 164.631 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.977 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263044, int_b + int_rho = -2.365e-13, checking this took 0.123 ms
2-norm of RHS = 570.7334861104798, which took 0.155 ms

iter_count = 138, r_2norm = 5.006e-04, tol*||rhs|| = 5.707e-04

Anderson update took 73.446 ms, out of which F'*F took 34.465 ms; b-Ax took 233.719 ms, out of which Lap took 209.113 ms
Solving Poisson took 495.588 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.118023 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 6.546957 
Total time for convolution: 	 convolve: 5.088809 
Total time for convolution: 	 convolve: 5.092582 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.939 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.297 ms

This SCF took 27955.659 ms, scf error = 1.700e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.138515, lowerbound = -1.106237, upperbound = 267.579437

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1163.217 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.130 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.389 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.539 ms
rank =  0, finding HY took 19.297 ms
rank =  0, distributing HY into block cyclic form took 12.065 ms
rank =  0, finding Y'*HY took 3.557 ms
Rank 0, Project_Hamiltonian used 51.301 ms
Total time for projection: 51.316 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -1.106013066161703
    last  calculated eigval = 0.039327421931892
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.10601306616170
lambda[   2] =  -0.79486962995221
lambda[   3] =  -0.61371044659128
lambda[   4] =  -0.47233040782462
lambda[   5] =  -0.46084564557464
lambda[   6] =  -0.39652524796000
lambda[   7] =  -0.36128578008600
lambda[   8] =  -0.28916568758754
lambda[   9] =  -0.22262448946854
lambda[  10] =  -0.08607384534146
lambda[  11] =  -0.01601943748597
lambda[  12] =  -0.00495022258019
lambda[  13] =   0.01883704372499
lambda[  14] =   0.02498127084968
lambda[  15] =   0.03932742193189
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 3.589 ms
rank =  0, Distributing orbital back into band + domain format took 11.895 ms
rank = 0, Subspace_Rotation used 15.498 ms

Total time for subspace rotation: 15.504 ms
rank = 0, Efermi =  -0.115650715872 calculate fermi energy took 0.074 ms
rank = 0, --- Calculate rho: sum over local bands took 3.090 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.197 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.168 ms
rank = 0, Calculating density took 1236.861 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
rank = 0, D2D took 1.096 ms
rank = 0, Transfering density took 1.104 ms
Etot    =   -40.150770055707
Eband   =    -9.434740803500
E1      =    19.925535273992
E2      =    -9.336294896977
E3      =   -12.404071077302
Exc     =   -11.092928088874
Esc     =   -61.289002411220
Entropy =    -0.000000000384
dE = 2.289e-06, dEband = 7.239e-04
rank = 0, Calculating/Estimating energy took 0.908 ms, Etot = -40.150770056, dEtot = 2.289e-06, dEband = 7.239e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0235137511711, which took 0.048 ms

iter_count = 102, r_2norm = 9.236e-07, tol*||rhs|| = 9.406e-07

Anderson update took 54.405 ms, out of which F'*F took 25.439 ms; b-Ax took 173.360 ms, out of which Lap took 155.480 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 372.759 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001263068, int_rho =  18.00000001263045, int_b + int_rho = -2.256e-13, checking this took 0.111 ms
2-norm of RHS = 570.7344076694457, which took 0.096 ms

iter_count = 126, r_2norm = 5.068e-04, tol*||rhs|| = 5.707e-04

Anderson update took 67.039 ms, out of which F'*F took 31.483 ms; b-Ax took 213.236 ms, out of which Lap took 190.802 ms
Solving Poisson took 452.395 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.112729 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.085233 
Total time for convolution: 	 convolve: 5.105609 
Total time for convolution: 	 convolve: 5.091796 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.937 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.323 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.281 ms

This SCF took 26457.391 ms, scf error = 9.586e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -1.10601306616170, occ[   1] =   2.00000000000000
lambda[   2] =  -0.79486962995221, occ[   2] =   2.00000000000000
lambda[   3] =  -0.61371044659128, occ[   3] =   2.00000000000000
lambda[   4] =  -0.47233040782462, occ[   4] =   2.00000000000000
lambda[   5] =  -0.46084564557464, occ[   5] =   2.00000000000000
lambda[   6] =  -0.39652524796000, occ[   6] =   2.00000000000000
lambda[   7] =  -0.36128578008600, occ[   7] =   2.00000000000000
lambda[   8] =  -0.28916568758754, occ[   8] =   2.00000000000000
lambda[   9] =  -0.22262448946854, occ[   9] =   2.00000000000000
lambda[  10] =  -0.08607384534146, occ[  10] =   0.00000001263043
lambda[  11] =  -0.01601943748597, occ[  11] =   0.00000000000000
lambda[  12] =  -0.00495022258019, occ[  12] =   0.00000000000000
lambda[  13] =   0.01883704372499, occ[  13] =   0.00000000000000
lambda[  14] =   0.02498127084968, occ[  14] =   0.00000000000000
lambda[  15] =   0.03932742193189, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.552 ms, time for Allreduce/Reduce: 5.388 ms 
Time for calculating local force components: 14.340 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000004335030  -0.92376201615078   0.68155512683943
  0.00000034447160   0.92376208529492   0.68155510071549
 -0.04445341329309  -0.00000000233359  -0.02781195059810
  0.04445341028876   0.00000000628350  -0.02781196351942
  0.00000002372343   0.00000029392547  -0.30258876058532
force_loc = 
  0.00000074167663   0.90432164724714  -0.66846717556953
  0.00000179781524  -0.90432012344410  -0.66846711120348
  0.04691875764979   0.00000031573909   0.02858853978193
 -0.04691868449272  -0.00000029366647   0.02858903935290
  0.00000049675305   0.00000066109495   0.30425867463846
Time for calculating nonlocal force components: 26.788 ms
[32mforces_xc: 
[0m[32m  0.00000009814005   0.03171624588282  -0.01980312178500
[0m[32m  0.00000008643464  -0.03171620883474  -0.01980308428928
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000834514   0.00000001308492   0.00981615869039
[0mTime for calculating XC forces components: 18.008 ms
 Cartesian force = 
  0.00000014099441   0.01227535215455  -0.00663706500879
  0.00000148654892  -0.01227477180854  -0.00663698927097
  0.00246460218414  -0.00000021141913   0.00085469469014
 -0.00246601637652  -0.00000081220760   0.00085518133979
 -0.00000021335095   0.00000044328072   0.01156417824984
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Time for printing density: 383.910 ms
The program took 487.951 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:02
Job ID:        2266491
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:40:12,vmem=8460K,walltime=00:08:21,mem=8168K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-2-1
---------------------------------------
