---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:02
Job ID:    2266560
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:07
Job ID:    2266560
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 20.660 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 18.888 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 58.813 ms

Freeing SPARC_INPUT_MPI datatype took 0.007 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.934 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.227 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    7.251751	   12.986680	   10.000000	
   12.748249	    7.013320	   10.000000	
    9.852248	   14.396255	   11.665094	
    9.852248	   14.396255	    8.334906	
   10.147752	    5.603745	   11.665094	
   10.147752	    5.603745	    8.334906	
    9.287335	   13.318280	   10.000000	
   10.712665	    6.681720	   10.000000	
   10.712665	   10.937678	   10.000000	
    9.287335	    9.062322	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.309 ms
Set up communicators.

--set up spincomm took 2.094 ms

--set up kptcomm took 0.345 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 19, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 19 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 19, mbQ = nbQ = 64
rank = 0, nr_Hp = 19, nc_Hp = 19
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.039 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.041 ms

Calculate_SplineDerivRadFun took 0.197 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.811 ms.
time spent on vectorized spline interp: 2.983 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.652 ms.
time spent on vectorized spline interp: 1.937 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.512 ms.
time spent on vectorized spline interp: 1.854 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.356 ms.

Calculating rb for all atom types took 17.117 ms
----------------------
Estimated memory usage
Total: 1.16 GB
orbitals             : 869.75 MB
global sized vectors : 213.62 MB
subspace matrices : 8.46 kB
others : 108.34 MB
----------------------------------------------
Estimated memory usage per processor: 99.31 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.062 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -24.0000000299205, sum_int_rho = 23.3995680049966
PosCharge = 24.000000029921, NegCharge = -23.399568004997, scal_fac = 1.025659961962
After scaling, int_rho = 24.0000000299204, PosCharge + NegCharge - NetCharge = 1.243e-13
--Calculate Vref took 0.496 ms
--Calculate rho_guess took 2.603 ms

 integral of b = -24.0000000299205,
 int{b} + Nelectron + NetCharge = -2.992e-08,
 Esc = -62.5636121392074,
 MPI_Reduce took 9.216 ms

Calculating b & b_ref took 18.901 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.072 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.083 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.063 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.558 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.269 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992057, int_b + int_rho = 2.401e-13, checking this took 0.659 ms
2-norm of RHS = 759.7323462532042, which took 0.819 ms

iter_count = 420, r_2norm = 6.010e-04, tol*||rhs|| = 7.597e-04

Anderson update took 266.026 ms, out of which F'*F took 122.495 ms; b-Ax took 807.133 ms, out of which Lap took 721.209 ms
Solving Poisson took 1773.609 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.405 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.848 ms
Total time for convolution: 	 convolve: 5.123861 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.865 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
Total time for convolution: 	 convolve: 5.121085 
Total time for convolution: 	 convolve: 5.130761 
Total time for convolution: 	 convolve: 5.120692 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.603 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.463 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
rank = 0, XC calculation took 24380.509 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 4.849 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.381 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.360 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.236 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.906 ms
    Lanczos iter 53, eigmin  = -0.960761931, eigmax = 264.930145546, err_eigmin = 2.218e-03, err_eigmax = 9.566e-03
rank =   0, Lanczos took 134.608 ms, eigmin = -0.960761930636, eigmax = 267.579447001827

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.259343, lowerbound = -1.060762, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1607.256 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 21.955 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.856 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.831 ms
rank =  0, finding HY took 26.396 ms
rank =  0, distributing HY into block cyclic form took 22.503 ms
rank =  0, finding Y'*HY took 4.123 ms
Rank 0, Project_Hamiltonian used 77.888 ms
Total time for projection: 78.312 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.431 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.108 ms
rank = 0, Solve_Generalized_EigenProblem used 1.544 ms
    first calculated eigval = 2.744914396765236
    last  calculated eigval = 3.251779424168979
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =   2.80873389202312
lambda[   4] =   2.83440187665956
lambda[   5] =   2.86244349259075
lambda[   6] =   2.90651373747444
lambda[   7] =   2.91852139698997
lambda[   8] =   2.95653843989590
lambda[   9] =   2.99780011929037
lambda[  10] =   3.00387434649857
lambda[  11] =   3.03102826150344
lambda[  12] =   3.03794040996454
lambda[  13] =   3.08950258903715
lambda[  14] =   3.12114316927308
lambda[  15] =   3.12819667273447
lambda[  16] =   3.13842446983116
lambda[  17] =   3.16409787286580
lambda[  18] =   3.22246167627877
lambda[  19] =   3.25177942416898
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 1.566 ms
rank =  0, subspace rotation using ScaLAPACK took 8.183 ms
rank =  0, Distributing orbital back into band + domain format took 19.603 ms
rank = 0, Subspace_Rotation used 27.803 ms

Total time for subspace rotation: 27.808 ms
rank = 0, Efermi =   3.063743211804 calculate fermi energy took 0.124 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.351779, lowerbound = -1.060762, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1592.740 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 19.711 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.817 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.549 ms
rank =  0, finding HY took 25.396 ms
rank =  0, distributing HY into block cyclic form took 19.926 ms
rank =  0, finding Y'*HY took 3.730 ms
Rank 0, Project_Hamiltonian used 71.626 ms
Total time for projection: 71.630 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.163 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.109 ms
rank = 0, Solve_Generalized_EigenProblem used 0.275 ms
    first calculated eigval = -0.803026906871783
    last  calculated eigval = 0.449472008016568
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.51234575230327
lambda[   4] =  -0.30197287824413
lambda[   5] =  -0.21394880021689
lambda[   6] =  -0.10660969595994
lambda[   7] =  -0.01870217645339
lambda[   8] =   0.07258734495544
lambda[   9] =   0.10545651927351
lambda[  10] =   0.23164309968249
lambda[  11] =   0.27186459374860
lambda[  12] =   0.27298350598811
lambda[  13] =   0.28545057808547
lambda[  14] =   0.33247553362208
lambda[  15] =   0.34827916158507
lambda[  16] =   0.36096446734802
lambda[  17] =   0.38437361116811
lambda[  18] =   0.41059645750682
lambda[  19] =   0.44947200801657
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.284 ms
rank =  0, subspace rotation using ScaLAPACK took 8.081 ms
rank =  0, Distributing orbital back into band + domain format took 19.420 ms
rank = 0, Subspace_Rotation used 27.516 ms

Total time for subspace rotation: 27.520 ms
rank = 0, Efermi =   0.280001052977 calculate fermi energy took 0.023 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.549472, lowerbound = -1.060762, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1590.639 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.596 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.692 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.284 ms
rank =  0, finding HY took 25.331 ms
rank =  0, distributing HY into block cyclic form took 19.651 ms
rank =  0, finding Y'*HY took 3.808 ms
Rank 0, Project_Hamiltonian used 72.098 ms
Total time for projection: 72.102 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.242 ms
    first calculated eigval = -0.977969500060096
    last  calculated eigval = 0.132478018123631
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.72590848592087
lambda[   4] =  -0.58690777075537
lambda[   5] =  -0.49514569200042
lambda[   6] =  -0.49229913854759
lambda[   7] =  -0.47795781313895
lambda[   8] =  -0.46707360631542
lambda[   9] =  -0.41508314704798
lambda[  10] =  -0.35178274945129
lambda[  11] =  -0.30428670102029
lambda[  12] =  -0.18117726733079
lambda[  13] =   0.01995001842260
lambda[  14] =   0.07252091771104
lambda[  15] =   0.07599881687211
lambda[  16] =   0.09942697465923
lambda[  17] =   0.11321085196536
lambda[  18] =   0.12106698655465
lambda[  19] =   0.13247801812363
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 8.088 ms
rank =  0, Distributing orbital back into band + domain format took 19.394 ms
rank = 0, Subspace_Rotation used 27.496 ms

Total time for subspace rotation: 27.500 ms
rank = 0, Efermi =  -0.008852015757 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.232478, lowerbound = -1.060762, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1591.016 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 19.523 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.795 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.338 ms
rank =  0, finding HY took 25.563 ms
rank =  0, distributing HY into block cyclic form took 19.562 ms
rank =  0, finding Y'*HY took 3.789 ms
Rank 0, Project_Hamiltonian used 71.277 ms
Total time for projection: 71.281 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.167 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.265 ms
    first calculated eigval = -0.978313782017116
    last  calculated eigval = 0.072748578724107
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.72688774552659
lambda[   4] =  -0.59014996347733
lambda[   5] =  -0.50547437320371
lambda[   6] =  -0.50016180678115
lambda[   7] =  -0.49134038345861
lambda[   8] =  -0.47424343068200
lambda[   9] =  -0.43346125691951
lambda[  10] =  -0.38134373631382
lambda[  11] =  -0.33494154668026
lambda[  12] =  -0.24360719691639
lambda[  13] =  -0.07776113850149
lambda[  14] =   0.01013688813955
lambda[  15] =   0.03211592569225
lambda[  16] =   0.05395374974552
lambda[  17] =   0.05839945115137
lambda[  18] =   0.06927686124129
lambda[  19] =   0.07274857872411
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.273 ms
rank =  0, subspace rotation using ScaLAPACK took 8.111 ms
rank =  0, Distributing orbital back into band + domain format took 19.377 ms
rank = 0, Subspace_Rotation used 27.503 ms

Total time for subspace rotation: 28.431 ms
rank = 0, Efermi =  -0.106563172682 calculate fermi energy took 0.026 ms
rank = 0, --- Calculate rho: sum over local bands took 6.120 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.671 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 6944.221 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.928 ms
rank = 0, D2D took 2.035 ms
rank = 0, Transfering density took 2.042 ms
Etot    =   -36.421955209450
Eband   =   -12.923080937146
E1      =    27.321907875050
E2      =   -10.239298604386
E3      =   -13.461801493270
Exc     =   -11.958270104914
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 3.642e+00, dEband = 1.292e+00
rank = 0, Calculating/Estimating energy took 1.016 ms, Etot = -36.421955209, dEtot = 3.642e+00, dEband = 1.292e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 53.8539174261580, which took 0.691 ms

iter_count = 96, r_2norm = 1.472e-03, tol*||rhs|| = 2.154e-03

Anderson update took 57.675 ms, out of which F'*F took 27.599 ms; b-Ax took 185.302 ms, out of which Lap took 165.148 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 410.996 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992040, int_b + int_rho = 7.276e-14, checking this took 0.111 ms
2-norm of RHS = 756.0306360992901, which took 0.205 ms

iter_count = 276, r_2norm = 7.072e-04, tol*||rhs|| = 7.560e-04

Anderson update took 163.149 ms, out of which F'*F took 75.177 ms; b-Ax took 513.990 ms, out of which Lap took 453.958 ms
Solving Poisson took 1152.764 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.411 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.192238 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 103.772 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.192487 
Total time for convolution: 	 convolve: 5.158471 
Total time for convolution: 	 convolve: 5.180002 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.456 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.165 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.451 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.199 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 3.521 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.138 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.692 ms

This SCF took 33328.437 ms, scf error = 1.915e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.172749, lowerbound = -0.978314, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1586.917 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.797 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.760 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.571 ms
rank =  0, finding HY took 25.555 ms
rank =  0, distributing HY into block cyclic form took 21.805 ms
rank =  0, finding Y'*HY took 3.639 ms
Rank 0, Project_Hamiltonian used 73.598 ms
Total time for projection: 73.613 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.214 ms
    first calculated eigval = -0.975788265849268
    last  calculated eigval = 0.056759684639986
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.69610501881224
lambda[   4] =  -0.56689675378982
lambda[   5] =  -0.48109698305653
lambda[   6] =  -0.47569283819813
lambda[   7] =  -0.46745215257929
lambda[   8] =  -0.44390851522339
lambda[   9] =  -0.40867881301750
lambda[  10] =  -0.36321758720926
lambda[  11] =  -0.32905016350563
lambda[  12] =  -0.23182773236286
lambda[  13] =  -0.09854562343927
lambda[  14] =  -0.01663618464246
lambda[  15] =   0.01570566682581
lambda[  16] =   0.02868154751367
lambda[  17] =   0.03811276047677
lambda[  18] =   0.05265772149071
lambda[  19] =   0.05675968463999
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 8.785 ms
rank =  0, Distributing orbital back into band + domain format took 19.044 ms
rank = 0, Subspace_Rotation used 27.843 ms

Total time for subspace rotation: 27.848 ms
rank = 0, Efermi =  -0.127347657574 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 6.330 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.546 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 1707.523 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.919 ms
rank = 0, D2D took 2.022 ms
rank = 0, Transfering density took 2.027 ms
Etot    =   -36.368603463651
Eband   =   -12.433274001363
E1      =    26.854156281828
E2      =   -10.242684108127
E3      =   -13.614713773515
Exc     =   -12.083271485662
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 5.335e-03, dEband = 4.898e-02
rank = 0, Calculating/Estimating energy took 0.998 ms, Etot = -36.368603464, dEtot = 5.335e-03, dEband = 4.898e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 18.8984357975336, which took 0.118 ms

iter_count = 102, r_2norm = 5.060e-04, tol*||rhs|| = 7.559e-04

Anderson update took 60.519 ms, out of which F'*F took 28.199 ms; b-Ax took 193.179 ms, out of which Lap took 170.816 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.648 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992047, int_b + int_rho = 1.382e-13, checking this took 0.114 ms
2-norm of RHS = 750.1174329555706, which took 0.166 ms

iter_count = 294, r_2norm = 6.857e-04, tol*||rhs|| = 7.501e-04

Anderson update took 172.913 ms, out of which F'*F took 79.946 ms; b-Ax took 544.981 ms, out of which Lap took 481.629 ms
Solving Poisson took 1220.011 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.174201 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 92.554 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.180472 
Total time for convolution: 	 convolve: 5.240375 
Total time for convolution: 	 convolve: 5.189680 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.399 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.154 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.497 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.061 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.591 ms

This SCF took 28268.074 ms, scf error = 1.311e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.156760, lowerbound = -0.975788, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1593.897 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.663 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.036 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.714 ms
rank =  0, finding HY took 26.866 ms
rank =  0, distributing HY into block cyclic form took 19.927 ms
rank =  0, finding Y'*HY took 3.939 ms
Rank 0, Project_Hamiltonian used 73.470 ms
Total time for projection: 73.484 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.214 ms
    first calculated eigval = -0.964126112638459
    last  calculated eigval = 0.057691872132158
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.64255584816458
lambda[   4] =  -0.52203568964040
lambda[   5] =  -0.43828807046795
lambda[   6] =  -0.43351947143226
lambda[   7] =  -0.43097270441036
lambda[   8] =  -0.39171804652978
lambda[   9] =  -0.36071284196382
lambda[  10] =  -0.32248729823708
lambda[  11] =  -0.30613244088131
lambda[  12] =  -0.20303851631819
lambda[  13] =  -0.09036988267460
lambda[  14] =  -0.02627043160669
lambda[  15] =   0.01246143338757
lambda[  16] =   0.01871119380394
lambda[  17] =   0.02815285451316
lambda[  18] =   0.04572597503606
lambda[  19] =   0.05769187213216
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 8.348 ms
rank =  0, Distributing orbital back into band + domain format took 19.092 ms
rank = 0, Subspace_Rotation used 27.452 ms

Total time for subspace rotation: 27.457 ms
rank = 0, Efermi =  -0.119171916814 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 6.305 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.631 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.545 ms
rank = 0, Calculating density took 1714.007 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.916 ms
rank = 0, D2D took 2.020 ms
rank = 0, Transfering density took 2.025 ms
Etot    =   -36.323507919086
Eband   =   -11.503985180030
E1      =    26.006872062906
E2      =   -10.140976180221
E3      =   -13.956669700545
Exc     =   -12.360428542633
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 4.510e-03, dEband = 9.293e-02
rank = 0, Calculating/Estimating energy took 0.995 ms, Etot = -36.323507919, dEtot = 4.510e-03, dEband = 9.293e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 7.8517991746448, which took 0.596 ms

iter_count = 102, r_2norm = 2.162e-04, tol*||rhs|| = 3.141e-04

Anderson update took 60.060 ms, out of which F'*F took 27.710 ms; b-Ax took 190.152 ms, out of which Lap took 167.403 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 431.184 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992038, int_b + int_rho = 5.457e-14, checking this took 0.133 ms
2-norm of RHS = 749.6433707487045, which took 0.138 ms

iter_count = 258, r_2norm = 6.884e-04, tol*||rhs|| = 7.496e-04

Anderson update took 155.380 ms, out of which F'*F took 74.891 ms; b-Ax took 502.967 ms, out of which Lap took 447.801 ms
Solving Poisson took 1083.750 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.187340 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 130.779 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.185293 
Total time for convolution: 	 convolve: 5.166629 
Total time for convolution: 	 convolve: 5.191094 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.389 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.189 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 3.476 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.089 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.594 ms

This SCF took 28085.404 ms, scf error = 4.034e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.157692, lowerbound = -0.964126, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1594.725 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.987 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.799 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.806 ms
rank =  0, finding HY took 25.273 ms
rank =  0, distributing HY into block cyclic form took 19.562 ms
rank =  0, finding Y'*HY took 3.769 ms
Rank 0, Project_Hamiltonian used 71.437 ms
Total time for projection: 71.451 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.692 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.798 ms
    first calculated eigval = -0.955372332888424
    last  calculated eigval = 0.053301253322698
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.63502432021677
lambda[   4] =  -0.51390012309904
lambda[   5] =  -0.43025592948997
lambda[   6] =  -0.42534429951287
lambda[   7] =  -0.42436359259007
lambda[   8] =  -0.38451285898475
lambda[   9] =  -0.35263722182691
lambda[  10] =  -0.31342385306844
lambda[  11] =  -0.29866314602034
lambda[  12] =  -0.19505118854121
lambda[  13] =  -0.08391552666615
lambda[  14] =  -0.02871635100333
lambda[  15] =   0.01021663248755
lambda[  16] =   0.01605252390230
lambda[  17] =   0.02343459540706
lambda[  18] =   0.03948225355675
lambda[  19] =   0.05330125332270
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.195 ms
rank =  0, subspace rotation using ScaLAPACK took 7.775 ms
rank =  0, Distributing orbital back into band + domain format took 21.035 ms
rank = 0, Subspace_Rotation used 28.821 ms

Total time for subspace rotation: 28.827 ms
rank = 0, Efermi =  -0.112717560803 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 6.685 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.027 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.260 ms
rank = 0, Calculating density took 1716.349 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.154 ms
rank = 0, D2D took 2.268 ms
rank = 0, Transfering density took 2.275 ms
Etot    =   -36.319919774018
Eband   =   -11.317068341365
E1      =    25.873262895302
E2      =   -10.073507456165
E3      =   -14.033866531179
Exc     =   -12.419876175203
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 3.588e-04, dEband = 1.869e-02
rank = 0, Calculating/Estimating energy took 0.995 ms, Etot = -36.319919774, dEtot = 3.588e-04, dEband = 1.869e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.5163484118072, which took 0.093 ms

iter_count = 108, r_2norm = 7.119e-05, tol*||rhs|| = 1.007e-04

Anderson update took 64.592 ms, out of which F'*F took 30.049 ms; b-Ax took 205.949 ms, out of which Lap took 183.325 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.537 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992040, int_b + int_rho = 7.276e-14, checking this took 0.108 ms
2-norm of RHS = 749.7764505628718, which took 0.188 ms

iter_count = 246, r_2norm = 7.326e-04, tol*||rhs|| = 7.498e-04

Anderson update took 149.829 ms, out of which F'*F took 70.807 ms; b-Ax took 469.464 ms, out of which Lap took 420.641 ms
Solving Poisson took 1028.600 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.199136 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 83.941 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.811 ms
Total time for convolution: 	 convolve: 5.214071 
Total time for convolution: 	 convolve: 5.185449 
Total time for convolution: 	 convolve: 5.176339 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.399 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.239 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.404 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.489 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.403 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.927 ms

This SCF took 28159.672 ms, scf error = 1.686e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.153301, lowerbound = -0.955372, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1599.256 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.958 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.723 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.709 ms
rank =  0, finding HY took 25.584 ms
rank =  0, distributing HY into block cyclic form took 19.562 ms
rank =  0, finding Y'*HY took 4.087 ms
Rank 0, Project_Hamiltonian used 72.984 ms
Total time for projection: 72.995 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.201 ms
    first calculated eigval = -0.950564300766314
    last  calculated eigval = 0.047834545787796
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.63069990489909
lambda[   4] =  -0.50940839434097
lambda[   5] =  -0.42573892562120
lambda[   6] =  -0.42074260562932
lambda[   7] =  -0.42051828096737
lambda[   8] =  -0.38027097389250
lambda[   9] =  -0.34795424074230
lambda[  10] =  -0.30860578095148
lambda[  11] =  -0.29451214232132
lambda[  12] =  -0.19103763131563
lambda[  13] =  -0.08032158263042
lambda[  14] =  -0.02931507558404
lambda[  15] =   0.00916714379970
lambda[  16] =   0.01505211879399
lambda[  17] =   0.02117471295775
lambda[  18] =   0.03442488802171
lambda[  19] =   0.04783454578780
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 8.364 ms
rank =  0, Distributing orbital back into band + domain format took 19.155 ms
rank = 0, Subspace_Rotation used 27.530 ms

Total time for subspace rotation: 27.534 ms
rank = 0, Efermi =  -0.109123616809 calculate fermi energy took 0.592 ms
rank = 0, --- Calculate rho: sum over local bands took 6.657 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.484 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.578 ms
rank = 0, Calculating density took 1719.388 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.948 ms
rank = 0, D2D took 2.053 ms
rank = 0, Transfering density took 2.059 ms
Etot    =   -36.318964044936
Eband   =   -11.212222173187
E1      =    25.812251602072
E2      =   -10.020612998515
E3      =   -14.073025136235
Exc     =   -12.449019468476
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 9.557e-05, dEband = 1.048e-02
rank = 0, Calculating/Estimating energy took 0.997 ms, Etot = -36.318964045, dEtot = 9.557e-05, dEband = 1.048e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0027921469519, which took 0.155 ms

iter_count = 108, r_2norm = 3.480e-05, tol*||rhs|| = 4.011e-05

Anderson update took 64.631 ms, out of which F'*F took 30.002 ms; b-Ax took 203.284 ms, out of which Lap took 180.897 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.690 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992034, int_b + int_rho = 7.276e-15, checking this took 0.117 ms
2-norm of RHS = 750.2488209861929, which took 0.200 ms

iter_count = 240, r_2norm = 7.419e-04, tol*||rhs|| = 7.502e-04

Anderson update took 141.751 ms, out of which F'*F took 66.524 ms; b-Ax took 451.300 ms, out of which Lap took 400.524 ms
Solving Poisson took 989.081 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.117 ms
Total time for convolution: 	 convolve: 5.176579 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 82.381 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.196322 
Total time for convolution: 	 convolve: 5.177433 
Total time for convolution: 	 convolve: 5.171508 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.404 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.364 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.217 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.479 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.902 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.413 ms

This SCF took 27956.798 ms, scf error = 7.096e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.147835, lowerbound = -0.950564, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1592.309 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.636 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.744 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.398 ms
rank =  0, finding HY took 25.326 ms
rank =  0, distributing HY into block cyclic form took 19.806 ms
rank =  0, finding Y'*HY took 3.767 ms
Rank 0, Project_Hamiltonian used 71.324 ms
Total time for projection: 71.335 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.210 ms
    first calculated eigval = -0.948161109147046
    last  calculated eigval = 0.041351473572764
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.62674943719522
lambda[   4] =  -0.50590263096648
lambda[   5] =  -0.42220986856120
lambda[   6] =  -0.41744237050904
lambda[   7] =  -0.41728702011900
lambda[   8] =  -0.37632898116480
lambda[   9] =  -0.34396471499451
lambda[  10] =  -0.30540631070211
lambda[  11] =  -0.29174955923902
lambda[  12] =  -0.18884424669649
lambda[  13] =  -0.07850678836529
lambda[  14] =  -0.02900515110504
lambda[  15] =   0.00907521807383
lambda[  16] =   0.01494120055606
lambda[  17] =   0.02050417293475
lambda[  18] =   0.03096574166033
lambda[  19] =   0.04135147357276
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 8.933 ms
rank =  0, Distributing orbital back into band + domain format took 18.970 ms
rank = 0, Subspace_Rotation used 27.920 ms

Total time for subspace rotation: 27.925 ms
rank = 0, Efermi =  -0.107308822555 calculate fermi energy took 0.120 ms
rank = 0, --- Calculate rho: sum over local bands took 6.823 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.240 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.599 ms
rank = 0, Calculating density took 1710.671 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.997 ms
rank = 0, D2D took 2.096 ms
rank = 0, Transfering density took 2.101 ms
Etot    =   -36.318620011467
Eband   =   -11.132704446024
E1      =    25.777527333274
E2      =    -9.970670925323
E3      =   -14.091176181651
Exc     =   -12.461677865595
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 3.440e-05, dEband = 7.952e-03
rank = 0, Calculating/Estimating energy took 0.989 ms, Etot = -36.318620011, dEtot = 3.440e-05, dEband = 7.952e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4783727555870, which took 0.058 ms

iter_count = 108, r_2norm = 1.764e-05, tol*||rhs|| = 1.913e-05

Anderson update took 65.923 ms, out of which F'*F took 31.271 ms; b-Ax took 208.138 ms, out of which Lap took 185.902 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.161 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992040, int_b + int_rho = 7.276e-14, checking this took 0.116 ms
2-norm of RHS = 750.4499145449945, which took 0.149 ms

iter_count = 228, r_2norm = 6.069e-04, tol*||rhs|| = 7.504e-04

Anderson update took 135.644 ms, out of which F'*F took 65.672 ms; b-Ax took 447.585 ms, out of which Lap took 399.235 ms
Solving Poisson took 958.771 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.183852 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 90.223 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.179947 
Total time for convolution: 	 convolve: 5.168750 
Total time for convolution: 	 convolve: 5.175055 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.394 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.160 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.290 ms
---Transfer Veff_loc: D2D took 4.532 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.046 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.611 ms

This SCF took 27915.796 ms, scf error = 3.065e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.141351, lowerbound = -0.948161, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1594.945 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.170 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.756 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.944 ms
rank =  0, finding HY took 25.504 ms
rank =  0, distributing HY into block cyclic form took 19.498 ms
rank =  0, finding Y'*HY took 3.769 ms
Rank 0, Project_Hamiltonian used 71.745 ms
Total time for projection: 71.759 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.946218869318209
    last  calculated eigval = 0.034545201623552
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.62485988050184
lambda[   4] =  -0.50404691977875
lambda[   5] =  -0.42026986038000
lambda[   6] =  -0.41570290854633
lambda[   7] =  -0.41541234319587
lambda[   8] =  -0.37460832858077
lambda[   9] =  -0.34209145901157
lambda[  10] =  -0.30356983092597
lambda[  11] =  -0.29005620825579
lambda[  12] =  -0.18710632167007
lambda[  13] =  -0.07685873374857
lambda[  14] =  -0.02827031031763
lambda[  15] =   0.00943977649422
lambda[  16] =   0.01519952432079
lambda[  17] =   0.02054056684460
lambda[  18] =   0.02872623845797
lambda[  19] =   0.03454520162355
==subpsace eigenproblem: bcast eigvals took 0.064 ms
Total time for solving subspace eigenvalue problem: 0.287 ms
rank =  0, subspace rotation using ScaLAPACK took 8.297 ms
rank =  0, Distributing orbital back into band + domain format took 18.958 ms
rank = 0, Subspace_Rotation used 27.267 ms

Total time for subspace rotation: 27.272 ms
rank = 0, Efermi =  -0.105660767982 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 7.048 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.319 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.593 ms
rank = 0, Calculating density took 1713.338 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.942 ms
rank = 0, D2D took 2.048 ms
rank = 0, Transfering density took 2.053 ms
Etot    =   -36.318552182912
Eband   =   -11.088460522957
E1      =    25.758390009791
E2      =    -9.943621291218
E3      =   -14.097167036283
Exc     =   -12.465657857151
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 6.783e-06, dEband = 4.424e-03
rank = 0, Calculating/Estimating energy took 0.983 ms, Etot = -36.318552183, dEtot = 6.783e-06, dEband = 4.424e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2067011755430, which took 0.097 ms

iter_count = 114, r_2norm = 5.688e-06, tol*||rhs|| = 8.268e-06

Anderson update took 68.232 ms, out of which F'*F took 31.626 ms; b-Ax took 214.024 ms, out of which Lap took 190.404 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.584 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992032, int_b + int_rho = -7.276e-15, checking this took 0.075 ms
2-norm of RHS = 750.5161073975515, which took 0.165 ms

iter_count = 222, r_2norm = 7.347e-04, tol*||rhs|| = 7.505e-04

Anderson update took 132.293 ms, out of which F'*F took 62.176 ms; b-Ax took 418.492 ms, out of which Lap took 373.019 ms
Solving Poisson took 920.639 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.185382 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 105.411 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.186 ms
======D2D: initiated sending and receiving took 0.960 ms
Total time for convolution: 	 convolve: 5.168368 
Total time for convolution: 	 convolve: 5.177724 
Total time for convolution: 	 convolve: 5.165469 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.393 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.164 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.245 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.471 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.914 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.419 ms

This SCF took 27904.989 ms, scf error = 1.796e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.134545, lowerbound = -0.946219, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1588.929 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.011 ms
rank =  0, Distribute orbital to block cyclic format took 20.087 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.712 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.813 ms
rank =  0, finding HY took 25.364 ms
rank =  0, distributing HY into block cyclic form took 19.444 ms
rank =  0, finding Y'*HY took 3.806 ms
Rank 0, Project_Hamiltonian used 71.460 ms
Total time for projection: 71.472 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.203 ms
    first calculated eigval = -0.943671186496331
    last  calculated eigval = 0.030942779935208
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.62238984177189
lambda[   4] =  -0.50154075552677
lambda[   5] =  -0.41770604330124
lambda[   6] =  -0.41343390441709
lambda[   7] =  -0.41291893762684
lambda[   8] =  -0.37239042327559
lambda[   9] =  -0.33967810109889
lambda[  10] =  -0.30099583851178
lambda[  11] =  -0.28777262286421
lambda[  12] =  -0.18454408294408
lambda[  13] =  -0.07452830334637
lambda[  14] =  -0.02652918941087
lambda[  15] =   0.01113979204333
lambda[  16] =   0.01635751856608
lambda[  17] =   0.02189006282705
lambda[  18] =   0.02745697331650
lambda[  19] =   0.03094277993521
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 8.354 ms
rank =  0, Distributing orbital back into band + domain format took 18.985 ms
rank = 0, Subspace_Rotation used 27.351 ms

Total time for subspace rotation: 27.356 ms
rank = 0, Efermi =  -0.103330337552 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 6.762 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.403 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.567 ms
rank = 0, Calculating density took 1706.893 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.936 ms
rank = 0, D2D took 2.040 ms
rank = 0, Transfering density took 2.046 ms
Etot    =   -36.318537072800
Eband   =   -11.029631149183
E1      =    25.727374911542
E2      =    -9.913506070698
E3      =   -14.105798870386
Exc     =   -12.471973636146
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 1.511e-06, dEband = 5.883e-03
rank = 0, Calculating/Estimating energy took 1.367 ms, Etot = -36.318537073, dEtot = 1.511e-06, dEband = 5.883e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1450663252388, which took 0.067 ms

iter_count = 114, r_2norm = 3.974e-06, tol*||rhs|| = 5.803e-06

Anderson update took 71.019 ms, out of which F'*F took 37.989 ms; b-Ax took 223.997 ms, out of which Lap took 201.365 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 520.925 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992039, int_b + int_rho = 5.821e-14, checking this took 0.120 ms
2-norm of RHS = 750.5271828477739, which took 0.098 ms

iter_count = 204, r_2norm = 6.528e-04, tol*||rhs|| = 7.505e-04

Anderson update took 119.360 ms, out of which F'*F took 55.985 ms; b-Ax took 382.997 ms, out of which Lap took 339.352 ms
Solving Poisson took 850.977 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.195503 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 122.281 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.214800 
Total time for convolution: 	 convolve: 5.176132 
Total time for convolution: 	 convolve: 5.171038 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 424.442 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.396 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.154 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.017 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.720 ms
---Transfer Veff_loc: D2D took 3.510 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.899 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.444 ms

This SCF took 28363.081 ms, scf error = 1.030e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.130943, lowerbound = -0.943671, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1594.126 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.770 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.800 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.585 ms
rank =  0, finding HY took 25.284 ms
rank =  0, distributing HY into block cyclic form took 19.766 ms
rank =  0, finding Y'*HY took 3.763 ms
Rank 0, Project_Hamiltonian used 71.429 ms
Total time for projection: 71.444 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.214 ms
    first calculated eigval = -0.942680291213007
    last  calculated eigval = 0.030649666703611
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.62157888140249
lambda[   4] =  -0.50067067695528
lambda[   5] =  -0.41681688344841
lambda[   6] =  -0.41257031404970
lambda[   7] =  -0.41201179652283
lambda[   8] =  -0.37161743777026
lambda[   9] =  -0.33884114887095
lambda[  10] =  -0.30004530449548
lambda[  11] =  -0.28687168505035
lambda[  12] =  -0.18354917145003
lambda[  13] =  -0.07354357257733
lambda[  14] =  -0.02501309952438
lambda[  15] =   0.01271874958000
lambda[  16] =   0.01744676002762
lambda[  17] =   0.02305566894194
lambda[  18] =   0.02519677484610
lambda[  19] =   0.03064966670361
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 8.317 ms
rank =  0, Distributing orbital back into band + domain format took 19.055 ms
rank = 0, Subspace_Rotation used 27.384 ms

Total time for subspace rotation: 27.388 ms
rank = 0, Efermi =  -0.102345606741 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 6.662 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.357 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.599 ms
rank = 0, Calculating density took 1711.991 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.901 ms
rank = 0, D2D took 3.012 ms
rank = 0, Transfering density took 3.019 ms
Etot    =   -36.318552793611
Eband   =   -11.008379690115
E1      =    25.718371857663
E2      =    -9.900932632213
E3      =   -14.106802009165
Exc     =   -12.472667462441
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 1.572e-06, dEband = 2.125e-03
rank = 0, Calculating/Estimating energy took 0.988 ms, Etot = -36.318552794, dEtot = 1.572e-06, dEband = 2.125e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0700995107095, which took 0.324 ms

iter_count = 114, r_2norm = 2.123e-06, tol*||rhs|| = 2.804e-06

Anderson update took 68.083 ms, out of which F'*F took 32.414 ms; b-Ax took 219.133 ms, out of which Lap took 196.293 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 491.872 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992046, int_b + int_rho = 1.310e-13, checking this took 0.111 ms
2-norm of RHS = 750.5113879698127, which took 0.127 ms

iter_count = 198, r_2norm = 7.007e-04, tol*||rhs|| = 7.505e-04

Anderson update took 117.668 ms, out of which F'*F took 55.835 ms; b-Ax took 377.510 ms, out of which Lap took 335.415 ms
Solving Poisson took 827.419 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.162172 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 143.429 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.169629 
Total time for convolution: 	 convolve: 5.171446 
Total time for convolution: 	 convolve: 5.185135 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 3.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.702 ms
---Transfer Veff_loc: D2D took 3.501 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.929 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.465 ms

This SCF took 27841.292 ms, scf error = 7.011e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.130650, lowerbound = -0.942680, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1597.538 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.063 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.794 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.873 ms
rank =  0, finding HY took 26.234 ms
rank =  0, distributing HY into block cyclic form took 19.725 ms
rank =  0, finding Y'*HY took 3.758 ms
Rank 0, Project_Hamiltonian used 72.623 ms
Total time for projection: 72.635 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.212 ms
    first calculated eigval = -0.941752378341050
    last  calculated eigval = 0.031861099989637
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.62052115409121
lambda[   4] =  -0.49962520773165
lambda[   5] =  -0.41577163463030
lambda[   6] =  -0.41159609405628
lambda[   7] =  -0.41097095521377
lambda[   8] =  -0.37060082837260
lambda[   9] =  -0.33779321330630
lambda[  10] =  -0.29897414229869
lambda[  11] =  -0.28590991864720
lambda[  12] =  -0.18251385504856
lambda[  13] =  -0.07259468396714
lambda[  14] =  -0.02277806211480
lambda[  15] =   0.01528678628613
lambda[  16] =   0.01950682938614
lambda[  17] =   0.02472468549782
lambda[  18] =   0.02578404179251
lambda[  19] =   0.03186109998964
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.238 ms
rank =  0, subspace rotation using ScaLAPACK took 8.313 ms
rank =  0, Distributing orbital back into band + domain format took 18.988 ms
rank = 0, Subspace_Rotation used 27.313 ms

Total time for subspace rotation: 27.318 ms
rank = 0, Efermi =  -0.101396718134 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 6.870 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.714 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.561 ms
rank = 0, Calculating density took 1716.469 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.931 ms
rank = 0, D2D took 2.036 ms
rank = 0, Transfering density took 2.041 ms
Etot    =   -36.318548031249
Eband   =   -10.983884609646
E1      =    25.705598216982
E2      =    -9.888727301613
E3      =   -14.109186762887
Exc     =   -12.474563562989
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 4.762e-07, dEband = 2.450e-03
rank = 0, Calculating/Estimating energy took 1.003 ms, Etot = -36.318548031, dEtot = 4.762e-07, dEband = 2.450e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0526579227352, which took 0.115 ms

iter_count = 114, r_2norm = 1.418e-06, tol*||rhs|| = 2.106e-06

Anderson update took 68.402 ms, out of which F'*F took 31.714 ms; b-Ax took 218.169 ms, out of which Lap took 194.991 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 490.138 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992050, int_b + int_rho = 1.673e-13, checking this took 0.125 ms
2-norm of RHS = 750.5088360268510, which took 0.132 ms

iter_count = 180, r_2norm = 7.047e-04, tol*||rhs|| = 7.505e-04

Anderson update took 106.894 ms, out of which F'*F took 51.354 ms; b-Ax took 346.434 ms, out of which Lap took 308.100 ms
Solving Poisson took 753.917 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.168965 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 145.637 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.164349 
Total time for convolution: 	 convolve: 5.166200 
Total time for convolution: 	 convolve: 5.190298 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.761 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.560 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 11.735 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.534 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.932 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.500 ms

This SCF took 27772.942 ms, scf error = 4.034e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.131861, lowerbound = -0.941752, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1594.271 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.134 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.770 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.921 ms
rank =  0, finding HY took 25.344 ms
rank =  0, distributing HY into block cyclic form took 19.619 ms
rank =  0, finding Y'*HY took 3.941 ms
Rank 0, Project_Hamiltonian used 71.848 ms
Total time for projection: 71.860 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.940901983112279
    last  calculated eigval = 0.032351758469651
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.61977922729281
lambda[   4] =  -0.49887531296509
lambda[   5] =  -0.41499093123363
lambda[   6] =  -0.41085084663283
lambda[   7] =  -0.41020836113937
lambda[   8] =  -0.36991541849633
lambda[   9] =  -0.33706081279181
lambda[  10] =  -0.29820698668371
lambda[  11] =  -0.28516881168338
lambda[  12] =  -0.18171536518517
lambda[  13] =  -0.07179855995766
lambda[  14] =  -0.02049051322288
lambda[  15] =   0.01691935422696
lambda[  16] =   0.02203764638877
lambda[  17] =   0.02648884083834
lambda[  18] =   0.02722286568044
lambda[  19] =   0.03235175846965
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.240 ms
rank =  0, subspace rotation using ScaLAPACK took 8.315 ms
rank =  0, Distributing orbital back into band + domain format took 18.939 ms
rank = 0, Subspace_Rotation used 27.264 ms

Total time for subspace rotation: 27.269 ms
rank = 0, Efermi =  -0.100600594062 calculate fermi energy took 0.119 ms
rank = 0, --- Calculate rho: sum over local bands took 6.896 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.279 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1712.878 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.941 ms
rank = 0, D2D took 2.044 ms
rank = 0, Transfering density took 2.049 ms
Etot    =   -36.318585540434
Eband   =   -10.965575518692
E1      =    25.695900424562
E2      =    -9.879773481350
E3      =   -14.110834987926
Exc     =   -12.475906775484
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 3.751e-06, dEband = 1.831e-03
rank = 0, Calculating/Estimating energy took 1.017 ms, Etot = -36.318585540, dEtot = 3.751e-06, dEband = 1.831e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0325609292285, which took 0.153 ms

iter_count = 114, r_2norm = 9.498e-07, tol*||rhs|| = 1.302e-06

Anderson update took 67.522 ms, out of which F'*F took 31.938 ms; b-Ax took 216.779 ms, out of which Lap took 191.965 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.082 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992047, int_b + int_rho = 1.455e-13, checking this took 0.119 ms
2-norm of RHS = 750.5158057812041, which took 0.147 ms

iter_count = 162, r_2norm = 6.449e-04, tol*||rhs|| = 7.505e-04

Anderson update took 95.959 ms, out of which F'*F took 45.923 ms; b-Ax took 306.996 ms, out of which Lap took 273.508 ms
Solving Poisson took 679.034 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.178185 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 121.407 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.180678 
Total time for convolution: 	 convolve: 5.184468 
Total time for convolution: 	 convolve: 5.167852 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.529 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.598 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.209 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 3.504 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.877 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.416 ms

This SCF took 28101.674 ms, scf error = 2.800e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132352, lowerbound = -0.940902, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1597.892 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.807 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.795 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.621 ms
rank =  0, finding HY took 25.329 ms
rank =  0, distributing HY into block cyclic form took 19.633 ms
rank =  0, finding Y'*HY took 3.762 ms
Rank 0, Project_Hamiltonian used 71.374 ms
Total time for projection: 71.384 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.214 ms
    first calculated eigval = -0.940599177023072
    last  calculated eigval = 0.032858792774746
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.61953939260326
lambda[   4] =  -0.49863134372270
lambda[   5] =  -0.41473470686115
lambda[   6] =  -0.41058607192310
lambda[   7] =  -0.40995047106040
lambda[   8] =  -0.36968104883272
lambda[   9] =  -0.33681535119889
lambda[  10] =  -0.29795482099939
lambda[  11] =  -0.28490462847017
lambda[  12] =  -0.18145485081554
lambda[  13] =  -0.07151577841719
lambda[  14] =  -0.01902615090130
lambda[  15] =   0.01766970365283
lambda[  16] =   0.02403329202300
lambda[  17] =   0.02731613182637
lambda[  18] =   0.02838202837532
lambda[  19] =   0.03285879277475
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.238 ms
rank =  0, subspace rotation using ScaLAPACK took 8.947 ms
rank =  0, Distributing orbital back into band + domain format took 19.111 ms
rank = 0, Subspace_Rotation used 28.073 ms

Total time for subspace rotation: 28.079 ms
rank = 0, Efermi =  -0.100317812522 calculate fermi energy took 0.096 ms
rank = 0, --- Calculate rho: sum over local bands took 6.857 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.250 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1716.833 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.932 ms
rank = 0, D2D took 2.036 ms
rank = 0, Transfering density took 2.042 ms
Etot    =   -36.318617117430
Eband   =   -10.959396242576
E1      =    25.693169680812
E2      =    -9.876262328394
E3      =   -14.111070440123
Exc     =   -12.476111184088
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 3.158e-06, dEband = 6.179e-04
rank = 0, Calculating/Estimating energy took 1.003 ms, Etot = -36.318617117, dEtot = 3.158e-06, dEband = 6.179e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0214372592109, which took 0.110 ms

iter_count = 114, r_2norm = 5.159e-07, tol*||rhs|| = 8.575e-07

Anderson update took 67.251 ms, out of which F'*F took 31.805 ms; b-Ax took 215.551 ms, out of which Lap took 190.997 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 490.457 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992038, int_b + int_rho = 5.457e-14, checking this took 0.119 ms
2-norm of RHS = 750.5251893125478, which took 0.131 ms

iter_count = 162, r_2norm = 6.906e-04, tol*||rhs|| = 7.505e-04

Anderson update took 95.768 ms, out of which F'*F took 46.440 ms; b-Ax took 313.405 ms, out of which Lap took 278.264 ms
Solving Poisson took 682.195 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.189995 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 80.888 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.163653 
Total time for convolution: 	 convolve: 5.178123 
Total time for convolution: 	 convolve: 5.177096 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 3.537 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.085 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.656 ms

This SCF took 27653.248 ms, scf error = 1.860e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132859, lowerbound = -0.940599, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1592.421 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.718 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.771 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.508 ms
rank =  0, finding HY took 25.314 ms
rank =  0, distributing HY into block cyclic form took 19.643 ms
rank =  0, finding Y'*HY took 3.787 ms
Rank 0, Project_Hamiltonian used 71.278 ms
Total time for projection: 71.289 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.625 ms
rank = 0, Solve_Generalized_EigenProblem used 1.094 ms
    first calculated eigval = -0.940359827037535
    last  calculated eigval = 0.033603247919638
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.61928252540596
lambda[   4] =  -0.49837383993657
lambda[   5] =  -0.41448094166120
lambda[   6] =  -0.41032787611568
lambda[   7] =  -0.40969019045653
lambda[   8] =  -0.36942264257278
lambda[   9] =  -0.33656184156877
lambda[  10] =  -0.29769317095653
lambda[  11] =  -0.28464846434472
lambda[  12] =  -0.18121070349200
lambda[  13] =  -0.07126865378613
lambda[  14] =  -0.01738473736699
lambda[  15] =   0.01802342553105
lambda[  16] =   0.02599544895680
lambda[  17] =   0.02880603045138
lambda[  18] =   0.02931548125240
lambda[  19] =   0.03360324791964
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 1.112 ms
rank =  0, subspace rotation using ScaLAPACK took 8.325 ms
rank =  0, Distributing orbital back into band + domain format took 19.225 ms
rank = 0, Subspace_Rotation used 27.562 ms

Total time for subspace rotation: 27.568 ms
rank = 0, Efermi =  -0.100070687943 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 6.903 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.299 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.579 ms
rank = 0, Calculating density took 1711.298 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.958 ms
rank = 0, D2D took 2.051 ms
rank = 0, Transfering density took 2.053 ms
Etot    =   -36.318671850875
Eband   =   -10.953300874384
E1      =    25.690419617640
E2      =    -9.872800912521
E3      =   -14.111389793329
Exc     =   -12.476369159886
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 5.473e-06, dEband = 6.095e-04
rank = 0, Calculating/Estimating energy took 1.000 ms, Etot = -36.318671851, dEtot = 5.473e-06, dEband = 6.095e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0179354685849, which took 0.058 ms

iter_count = 114, r_2norm = 4.686e-07, tol*||rhs|| = 7.174e-07

Anderson update took 67.929 ms, out of which F'*F took 32.157 ms; b-Ax took 220.391 ms, out of which Lap took 192.345 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.600 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992037, int_b + int_rho = 4.366e-14, checking this took 0.115 ms
2-norm of RHS = 750.5255513882063, which took 0.124 ms

iter_count = 114, r_2norm = 6.892e-04, tol*||rhs|| = 7.505e-04

Anderson update took 67.667 ms, out of which F'*F took 31.013 ms; b-Ax took 213.539 ms, out of which Lap took 188.047 ms
Solving Poisson took 479.574 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.170790 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 69.205 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.796 ms
Total time for convolution: 	 convolve: 5.174853 
Total time for convolution: 	 convolve: 5.169167 
Total time for convolution: 	 convolve: 5.194651 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.014 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 3.507 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.149 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.689 ms

This SCF took 27430.432 ms, scf error = 1.066e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133603, lowerbound = -0.940360, upperbound = 267.579447

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1588.127 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.775 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.826 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.618 ms
rank =  0, finding HY took 25.542 ms
rank =  0, distributing HY into block cyclic form took 19.555 ms
rank =  0, finding Y'*HY took 3.940 ms
Rank 0, Project_Hamiltonian used 72.154 ms
Total time for projection: 72.165 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.210 ms
    first calculated eigval = -0.940290712764479
    last  calculated eigval = 0.033991771434924
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.61921428964780
lambda[   4] =  -0.49830475182708
lambda[   5] =  -0.41441161220946
lambda[   6] =  -0.41025945598361
lambda[   7] =  -0.40962211113656
lambda[   8] =  -0.36935709665041
lambda[   9] =  -0.33649605330831
lambda[  10] =  -0.29762444084719
lambda[  11] =  -0.28458039245542
lambda[  12] =  -0.18114397854282
lambda[  13] =  -0.07120037938453
lambda[  14] =  -0.01677367095275
lambda[  15] =   0.01823220661493
lambda[  16] =   0.02641941755357
lambda[  17] =   0.02917140523189
lambda[  18] =   0.02964553062910
lambda[  19] =   0.03399177143492
==subpsace eigenproblem: bcast eigvals took 0.079 ms
Total time for solving subspace eigenvalue problem: 0.296 ms
rank =  0, subspace rotation using ScaLAPACK took 8.476 ms
rank =  0, Distributing orbital back into band + domain format took 19.445 ms
rank = 0, Subspace_Rotation used 27.936 ms

Total time for subspace rotation: 27.941 ms
rank = 0, Efermi =  -0.100002413572 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 6.723 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.573 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1707.527 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.917 ms
rank = 0, D2D took 2.013 ms
rank = 0, Transfering density took 2.015 ms
Etot    =   -36.318683900300
Eband   =   -10.951669896626
E1      =    25.689601265609
E2      =    -9.871970544752
E3      =   -14.111445203680
Exc     =   -12.476418877620
Esc     =   -62.563612139207
Entropy =    -0.000000000888
dE = 1.205e-06, dEband = 1.631e-04
rank = 0, Calculating/Estimating energy took 1.000 ms, Etot = -36.318683900, dEtot = 1.205e-06, dEband = 1.631e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0130990192487, which took 0.143 ms

iter_count = 114, r_2norm = 3.294e-07, tol*||rhs|| = 5.240e-07

Anderson update took 67.279 ms, out of which F'*F took 31.658 ms; b-Ax took 214.249 ms, out of which Lap took 190.109 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.907 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002992033, int_rho =  24.00000002992043, int_b + int_rho = 9.459e-14, checking this took 0.116 ms
2-norm of RHS = 750.5268034491055, which took 0.128 ms

iter_count = 120, r_2norm = 6.537e-04, tol*||rhs|| = 7.505e-04

Anderson update took 71.436 ms, out of which F'*F took 33.530 ms; b-Ax took 228.543 ms, out of which Lap took 202.651 ms
Solving Poisson took 504.639 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.115 ms
Total time for convolution: 	 convolve: 5.174745 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 115.264 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.181457 
Total time for convolution: 	 convolve: 5.162573 
Total time for convolution: 	 convolve: 5.201273 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 3.504 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.897 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.436 ms

This SCF took 27520.046 ms, scf error = 8.085e-05
The last 17 occupations of kpoints #1 are (Nelectron = 24):
lambda[   3] =  -0.61921428964780, occ[   3] =   2.00000000000000
lambda[   4] =  -0.49830475182708, occ[   4] =   2.00000000000000
lambda[   5] =  -0.41441161220946, occ[   5] =   2.00000000000000
lambda[   6] =  -0.41025945598361, occ[   6] =   2.00000000000000
lambda[   7] =  -0.40962211113656, occ[   7] =   2.00000000000000
lambda[   8] =  -0.36935709665041, occ[   8] =   2.00000000000000
lambda[   9] =  -0.33649605330831, occ[   9] =   2.00000000000000
lambda[  10] =  -0.29762444084719, occ[  10] =   2.00000000000000
lambda[  11] =  -0.28458039245542, occ[  11] =   2.00000000000000
lambda[  12] =  -0.18114397854282, occ[  12] =   2.00000000000000
lambda[  13] =  -0.07120037938453, occ[  13] =   0.00000002992040
lambda[  14] =  -0.01677367095275, occ[  14] =   0.00000000000000
lambda[  15] =   0.01823220661493, occ[  15] =   0.00000000000000
lambda[  16] =   0.02641941755357, occ[  16] =   0.00000000000000
lambda[  17] =   0.02917140523189, occ[  17] =   0.00000000000000
lambda[  18] =   0.02964553062910, occ[  18] =   0.00000000000000
lambda[  19] =   0.03399177143492, occ[  19] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 17 (90%) = 0.000000000000000.
Occupation of state 19 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.547 ms, time for Allreduce/Reduce: 11.084 ms 
Time for calculating local force components: 21.988 ms
Start Calculating nonlocal forces
force_nloc = 
  0.04986669551747   0.00862684841745   0.00000001465393
 -0.04986672215362  -0.00862688458733   0.00000000691080
 -0.01359219872918  -0.02636579342669  -0.04051864562212
 -0.01359218555624  -0.02636580601211   0.04051862847102
  0.01359214629094   0.02636583305827  -0.04051865542155
  0.01359213722213   0.02636579110508   0.04051860115753
  0.07236977485638  -0.05094640146802   0.00000175722725
 -0.07237220323304   0.05094544293606   0.00000188942406
 -0.90239371601529  -0.13634549661946   0.00000149494996
  0.90239273189344   0.13634536155017  -0.00000522059825
force_loc = 
 -0.05359044527407  -0.00830431544214  -0.00000018096216
  0.05359077279667   0.00830486708722  -0.00000005712190
  0.01494689063929   0.02871786853408   0.04300379942613
  0.01494711202703   0.02871837411244  -0.04300462265547
 -0.01494671858769  -0.02871801049202   0.04300371673031
 -0.01494685698452  -0.02871798503214  -0.04300423335366
 -0.06793002724471   0.04706405391754  -0.00000069854637
  0.06793389387193  -0.04706312323310  -0.00000218286524
  0.87456536841347   0.14107753609370  -0.00000359330316
 -0.87456220993516  -0.14108137689324   0.00000882402346
Time for calculating nonlocal force components: 44.200 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00297342868997   0.00251002904317  -0.00000002329848
[0m[32m  0.00297367828162  -0.00251012900171  -0.00000009650506
[0m[32m  0.02378358654725  -0.00130248746139  -0.00000011929725
[0m[32m -0.02378339037448   0.00130252333285   0.00000039023449
[0mTime for calculating XC forces components: 29.814 ms
 Cartesian force = 
 -0.00372421831456   0.00032286102344  -0.00000024567406
  0.00372358208509  -0.00032168945198  -0.00000012957692
  0.00135422335214   0.00235240315552   0.00248507443818
  0.00135445791283   0.00235289614846  -0.00248607355027
 -0.00135504085472  -0.00235184938563   0.00248498194293
 -0.00135518832036  -0.00235186587892  -0.00248571156196
  0.00146585036374  -0.00137199045918   0.00000095601657
 -0.00146509963746   0.00137251874939  -0.00000046931207
 -0.00404522961254   0.00342988006099  -0.00000229701628
  0.00404666302584  -0.00343316396209   0.00000391429388
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.391 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Time for printing density: 392.900 ms
The program took 424.311 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:14
Job ID:        2266560
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:28:24,vmem=8400K,walltime=00:07:22,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-9-1
---------------------------------------
