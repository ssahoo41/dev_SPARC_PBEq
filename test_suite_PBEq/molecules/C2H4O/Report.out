---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:12
Job ID:    2266595
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:18
Job ID:    2266595
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.016 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 14.139 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 7.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 20.161 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 60.628 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.985 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.203 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   11.366537	
   11.737580	   12.405427	    8.633463	
    8.262420	   12.405427	    8.633463	
    8.262420	    7.594573	    8.633463	
   11.737580	    7.594573	    8.633463	
   10.000000	   11.386324	    9.057474	
   10.000000	    8.613676	    9.057474	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.006 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.285 ms
Set up communicators.

--set up spincomm took 2.212 ms

--set up kptcomm took 0.335 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.011 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.119 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.329 ms

Calculate_SplineDerivRadFun took 0.213 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.784 ms.
time spent on vectorized spline interp: 3.440 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.648 ms.
time spent on vectorized spline interp: 1.355 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.268 ms.
time spent on vectorized spline interp: 1.616 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.222 ms.

Calculating rb for all atom types took 16.343 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.059 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000192114, sum_int_rho = 17.5973883075729
PosCharge = 18.000000019211, NegCharge = -17.597388307573, scal_fac = 1.022879060495
After scaling, int_rho = 18.0000000192114, PosCharge + NegCharge - NetCharge = 6.395e-14
--Calculate Vref took 0.406 ms
--Calculate rho_guess took 2.236 ms

 integral of b = -18.0000000192114,
 int{b} + Nelectron + NetCharge = -1.921e-08,
 Esc = -50.5325410649016,
 MPI_Reduce took 3.893 ms

Calculating b & b_ref took 12.248 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.035 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.045 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.017 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.175 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 27.895 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921147, int_b + int_rho = -7.276e-14, checking this took 0.557 ms
2-norm of RHS = 636.5310880374693, which took 0.516 ms

iter_count = 420, r_2norm = 5.501e-04, tol*||rhs|| = 6.365e-04

Anderson update took 198.531 ms, out of which F'*F took 101.154 ms; b-Ax took 668.154 ms, out of which Lap took 609.059 ms
Solving Poisson took 1325.522 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.453 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
Total time for convolution: 	 convolve: 5.098835 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.203 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
Total time for convolution: 	 convolve: 5.145626 
Total time for convolution: 	 convolve: 5.128075 
Total time for convolution: 	 convolve: 5.095897 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.597 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.512 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.302 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.447 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
rank = 0, XC calculation took 24311.656 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
---Transfer Veff_loc: D2D took 1.546 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.182 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.837 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.135 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.598 ms
    Lanczos iter 54, eigmin  = -1.052535668, eigmax = 264.932319100, err_eigmin = 7.597e-04, err_eigmax = 9.620e-03
rank =   0, Lanczos took 106.680 ms, eigmin = -1.052535668344, eigmax = 267.581642290993

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.214553, lowerbound = -1.152536, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1089.265 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.089 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.914 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.555 ms
rank =  0, Distribute data + matrix mult took 17.574 ms
rank =  0, finding HY took 19.612 ms
rank =  0, distributing HY into block cyclic form took 11.579 ms
rank =  0, finding Y'*HY took 5.521 ms
Rank 0, Project_Hamiltonian used 54.316 ms
Total time for projection: 54.328 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.912 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.988 ms
    first calculated eigval = 2.795715501871508
    last  calculated eigval = 3.201650662305688
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.79571550187151
lambda[   2] =   2.85776861709443
lambda[   3] =   2.87599888035514
lambda[   4] =   2.94354612302920
lambda[   5] =   2.94629580988860
lambda[   6] =   2.95540783163662
lambda[   7] =   2.99425342298006
lambda[   8] =   3.02453411228051
lambda[   9] =   3.04776919333134
lambda[  10] =   3.08102313440698
lambda[  11] =   3.09851321461669
lambda[  12] =   3.10573330351792
lambda[  13] =   3.13946537704205
lambda[  14] =   3.16133781212245
lambda[  15] =   3.20165066230569
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.353 ms
rank =  0, subspace rotation using ScaLAPACK took 3.034 ms
rank =  0, Distributing orbital back into band + domain format took 12.228 ms
rank = 0, Subspace_Rotation used 15.272 ms

Total time for subspace rotation: 15.276 ms
rank = 0, Efermi =   3.064396174286 calculate fermi energy took 0.048 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.301651, lowerbound = -1.152536, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1080.380 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.360 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.221 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.387 ms
rank =  0, Distribute data + matrix mult took 14.984 ms
rank =  0, finding HY took 18.568 ms
rank =  0, distributing HY into block cyclic form took 11.329 ms
rank =  0, finding Y'*HY took 4.296 ms
Rank 0, Project_Hamiltonian used 49.208 ms
Total time for projection: 49.221 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.106 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.770279271737117
    last  calculated eigval = 0.429544887308428
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.77027927173712
lambda[   2] =  -0.45143197031356
lambda[   3] =  -0.28499243908964
lambda[   4] =  -0.17556623058343
lambda[   5] =   0.00303732906702
lambda[   6] =   0.12237485231329
lambda[   7] =   0.19971464582475
lambda[   8] =   0.25513793024527
lambda[   9] =   0.32146646782296
lambda[  10] =   0.32208194338301
lambda[  11] =   0.35897998290771
lambda[  12] =   0.38653061204786
lambda[  13] =   0.39338709150612
lambda[  14] =   0.40129487246445
lambda[  15] =   0.42954488730843
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.191 ms
rank =  0, subspace rotation using ScaLAPACK took 2.965 ms
rank =  0, Distributing orbital back into band + domain format took 11.320 ms
rank = 0, Subspace_Rotation used 14.298 ms

Total time for subspace rotation: 14.302 ms
rank = 0, Efermi =   0.321774205666 calculate fermi energy took 0.085 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.529545, lowerbound = -1.152536, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1068.412 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 26.059 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.383 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.250 ms
rank =  0, Distribute data + matrix mult took 29.706 ms
rank =  0, finding HY took 18.213 ms
rank =  0, distributing HY into block cyclic form took 11.269 ms
rank =  0, finding Y'*HY took 4.253 ms
Rank 0, Project_Hamiltonian used 63.901 ms
Total time for projection: 63.915 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.100 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.165 ms
    first calculated eigval = -1.057481944575597
    last  calculated eigval = 0.145876904682050
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.05748194457560
lambda[   2] =  -0.70408656323175
lambda[   3] =  -0.66523494990918
lambda[   4] =  -0.54689185284560
lambda[   5] =  -0.51985598302173
lambda[   6] =  -0.42583177274195
lambda[   7] =  -0.38602096468268
lambda[   8] =  -0.35152582340098
lambda[   9] =  -0.22363236630652
lambda[  10] =   0.03985094408674
lambda[  11] =   0.05047076126621
lambda[  12] =   0.09684842854477
lambda[  13] =   0.12421113378708
lambda[  14] =   0.12941260933900
lambda[  15] =   0.14587690468205
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 2.956 ms
rank =  0, Distributing orbital back into band + domain format took 11.304 ms
rank = 0, Subspace_Rotation used 14.273 ms

Total time for subspace rotation: 14.277 ms
rank = 0, Efermi =   0.010648443346 calculate fermi energy took 0.045 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.245877, lowerbound = -1.152536, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1045.930 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 23.921 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.193 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.337 ms
rank =  0, Distribute data + matrix mult took 27.465 ms
rank =  0, finding HY took 18.640 ms
rank =  0, distributing HY into block cyclic form took 11.363 ms
rank =  0, finding Y'*HY took 4.084 ms
Rank 0, Project_Hamiltonian used 61.579 ms
Total time for projection: 61.584 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -1.057802586489954
    last  calculated eigval = 0.089567369449176
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.05780258648995
lambda[   2] =  -0.70671195082306
lambda[   3] =  -0.67052936684150
lambda[   4] =  -0.55219000322733
lambda[   5] =  -0.52642139659749
lambda[   6] =  -0.43832498380895
lambda[   7] =  -0.42829856317009
lambda[   8] =  -0.36639725988039
lambda[   9] =  -0.29600051680452
lambda[  10] =  -0.01005637755365
lambda[  11] =   0.01191503983192
lambda[  12] =   0.02665424844938
lambda[  13] =   0.06111668118425
lambda[  14] =   0.07519572392699
lambda[  15] =   0.08956736944918
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 2.981 ms
rank =  0, Distributing orbital back into band + domain format took 11.294 ms
rank = 0, Subspace_Rotation used 14.290 ms

Total time for subspace rotation: 14.297 ms
rank = 0, Efermi =  -0.039258877434 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 1.683 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.921 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.145 ms
rank = 0, Calculating density took 4688.054 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.081 ms
rank = 0, D2D took 1.190 ms
rank = 0, Transfering density took 1.196 ms
Etot    =   -30.977537056200
Eband   =   -10.085353255480
E1      =    20.273984617013
E2      =    -8.197260857054
E3      =   -10.683921227888
Exc     =    -9.514809437196
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 4.425e+00, dEband = 1.441e+00
rank = 0, Calculating/Estimating energy took 0.837 ms, Etot = -30.977537056, dEtot = 4.425e+00, dEband = 1.441e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 55.2235981771297, which took 0.146 ms

iter_count = 90, r_2norm = 2.112e-03, tol*||rhs|| = 2.209e-03

Anderson update took 43.165 ms, out of which F'*F took 21.841 ms; b-Ax took 140.550 ms, out of which Lap took 129.328 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 289.593 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921139, int_b + int_rho = -1.528e-13, checking this took 0.095 ms
2-norm of RHS = 633.6048918416735, which took 0.128 ms

iter_count = 282, r_2norm = 5.631e-04, tol*||rhs|| = 6.336e-04

Anderson update took 126.746 ms, out of which F'*F took 67.929 ms; b-Ax took 453.184 ms, out of which Lap took 410.491 ms
Solving Poisson took 887.072 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.772 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
Total time for convolution: 	 convolve: 5.082978 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 39.266 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.090172 
Total time for convolution: 	 convolve: 5.104239 
Total time for convolution: 	 convolve: 5.119269 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.011 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.161 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.966 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.844 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.829 ms

This SCF took 30694.683 ms, scf error = 1.611e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.189567, lowerbound = -1.057803, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1052.429 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 24.558 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.282 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.731 ms
rank =  0, Distribute data + matrix mult took 28.583 ms
rank =  0, finding HY took 18.460 ms
rank =  0, distributing HY into block cyclic form took 11.472 ms
rank =  0, finding Y'*HY took 4.362 ms
Rank 0, Project_Hamiltonian used 62.906 ms
Total time for projection: 62.922 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -1.045147358262197
    last  calculated eigval = 0.068827849634060
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.04514735826220
lambda[   2] =  -0.68185605706088
lambda[   3] =  -0.64484035469043
lambda[   4] =  -0.52878703488132
lambda[   5] =  -0.50344098157614
lambda[   6] =  -0.41419704508085
lambda[   7] =  -0.41313878056387
lambda[   8] =  -0.34436471028676
lambda[   9] =  -0.28439876087839
lambda[  10] =  -0.01965597663446
lambda[  11] =  -0.00197097581684
lambda[  12] =   0.00256092767359
lambda[  13] =   0.03094561002913
lambda[  14] =   0.04082709671107
lambda[  15] =   0.06882784963406
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 3.000 ms
rank =  0, Distributing orbital back into band + domain format took 11.258 ms
rank = 0, Subspace_Rotation used 14.270 ms

Total time for subspace rotation: 14.653 ms
rank = 0, Efermi =  -0.048858476498 calculate fermi energy took 0.605 ms
rank = 0, --- Calculate rho: sum over local bands took 2.101 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.568 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.124 ms
rank = 0, Calculating density took 1135.686 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.429 ms
rank = 0, D2D took 0.977 ms
rank = 0, Transfering density took 0.986 ms
Etot    =   -30.951407005663
Eband   =    -9.720342166939
E1      =    19.939029248818
E2      =    -8.173687221099
E3      =   -10.790087829521
Exc     =    -9.601328072683
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 3.733e-03, dEband = 5.214e-02
rank = 0, Calculating/Estimating energy took 0.833 ms, Etot = -30.951407006, dEtot = 3.733e-03, dEband = 5.214e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 9.7394938339825, which took 0.072 ms

iter_count = 108, r_2norm = 2.508e-04, tol*||rhs|| = 3.896e-04

Anderson update took 50.353 ms, out of which F'*F took 26.279 ms; b-Ax took 171.281 ms, out of which Lap took 157.547 ms
rank = 0, Mixing (+ precond) took 349.357 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921139, int_b + int_rho = -1.564e-13, checking this took 0.084 ms
2-norm of RHS = 628.2689269564418, which took 0.137 ms

iter_count = 300, r_2norm = 5.840e-04, tol*||rhs|| = 6.283e-04

Anderson update took 133.986 ms, out of which F'*F took 71.575 ms; b-Ax took 470.557 ms, out of which Lap took 426.558 ms
Solving Poisson took 935.120 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.900 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.140814 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 62.439 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.144511 
Total time for convolution: 	 convolve: 5.197568 
Total time for convolution: 	 convolve: 5.215979 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.143 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.161 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.256 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.931 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.841 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.790 ms

This SCF took 27400.461 ms, scf error = 1.127e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.168828, lowerbound = -1.045147, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1057.558 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.853 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.767 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.400 ms
rank =  0, Distribute data + matrix mult took 22.035 ms
rank =  0, finding HY took 19.042 ms
rank =  0, distributing HY into block cyclic form took 11.506 ms
rank =  0, finding Y'*HY took 4.575 ms
Rank 0, Project_Hamiltonian used 57.191 ms
Total time for projection: 57.207 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.166 ms
    first calculated eigval = -1.011364900269130
    last  calculated eigval = 0.058697645483686
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.01136490026913
lambda[   2] =  -0.62580825868194
lambda[   3] =  -0.58969331430272
lambda[   4] =  -0.47693173039155
lambda[   5] =  -0.45189747150118
lambda[   6] =  -0.37564410562036
lambda[   7] =  -0.35705841448851
lambda[   8] =  -0.29417063827725
lambda[   9] =  -0.24590170332556
lambda[  10] =  -0.02819100118334
lambda[  11] =   0.00402604306527
lambda[  12] =   0.01623683960997
lambda[  13] =   0.01989591775796
lambda[  14] =   0.03603326993098
lambda[  15] =   0.05869764548369
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 3.378 ms
rank =  0, Distributing orbital back into band + domain format took 10.981 ms
rank = 0, Subspace_Rotation used 14.375 ms

Total time for subspace rotation: 14.381 ms
rank = 0, Efermi =  -0.057393501071 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 1.884 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.578 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.122 ms
rank = 0, Calculating density took 1135.413 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.421 ms
rank = 0, D2D took 0.554 ms
rank = 0, Transfering density took 0.560 ms
Etot    =   -30.920728606263
Eband   =    -8.856941074258
E1      =    19.202732165772
E2      =    -8.021832909079
E3      =   -11.077668122122
Exc     =    -9.833479663499
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 4.383e-03, dEband = 1.233e-01
rank = 0, Calculating/Estimating energy took 0.862 ms, Etot = -30.920728606, dEtot = 4.383e-03, dEband = 1.233e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.4559620772242, which took 0.148 ms

iter_count = 102, r_2norm = 1.722e-04, tol*||rhs|| = 2.182e-04

Anderson update took 47.807 ms, out of which F'*F took 24.949 ms; b-Ax took 162.248 ms, out of which Lap took 148.580 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 327.276 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921132, int_b + int_rho = -2.292e-13, checking this took 0.085 ms
2-norm of RHS = 628.6482726080553, which took 0.132 ms

iter_count = 252, r_2norm = 5.736e-04, tol*||rhs|| = 6.286e-04

Anderson update took 118.214 ms, out of which F'*F took 61.193 ms; b-Ax took 396.505 ms, out of which Lap took 362.894 ms
Solving Poisson took 791.467 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Total time for convolution: 	 convolve: 5.079721 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.835 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.148793 
Total time for convolution: 	 convolve: 5.142646 
Total time for convolution: 	 convolve: 5.079306 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.270 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.546 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.168 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.011 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.951 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.847 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.816 ms

This SCF took 26677.287 ms, scf error = 2.521e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.158698, lowerbound = -1.011365, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1098.369 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 11.866 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.221 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.189 ms
rank =  0, Distribute data + matrix mult took 15.289 ms
rank =  0, finding HY took 18.410 ms
rank =  0, distributing HY into block cyclic form took 11.334 ms
rank =  0, finding Y'*HY took 5.991 ms
Rank 0, Project_Hamiltonian used 51.059 ms
Total time for projection: 51.080 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -1.006412442779135
    last  calculated eigval = 0.052153823802603
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.00641244277914
lambda[   2] =  -0.62182713014074
lambda[   3] =  -0.58574377641725
lambda[   4] =  -0.47255734490341
lambda[   5] =  -0.44781076251601
lambda[   6] =  -0.37083692092353
lambda[   7] =  -0.35235068603781
lambda[   8] =  -0.29102304755241
lambda[   9] =  -0.24011843405633
lambda[  10] =  -0.03091090494776
lambda[  11] =   0.00241370646339
lambda[  12] =   0.00921131588695
lambda[  13] =   0.01600302099458
lambda[  14] =   0.03479215029135
lambda[  15] =   0.05215382380260
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 3.370 ms
rank =  0, Distributing orbital back into band + domain format took 10.989 ms
rank = 0, Subspace_Rotation used 14.376 ms

Total time for subspace rotation: 14.383 ms
rank = 0, Efermi =  -0.060113404867 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 1.910 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.679 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.149 ms
rank = 0, Calculating density took 1170.252 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.504 ms
rank = 0, D2D took 0.631 ms
rank = 0, Transfering density took 0.637 ms
Etot    =   -30.919364198082
Eband   =    -8.777361091247
E1      =    19.167574499916
E2      =    -7.971554463191
E3      =   -11.102661416041
Exc     =    -9.851252420504
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 1.949e-04, dEband = 1.137e-02
rank = 0, Calculating/Estimating energy took 0.861 ms, Etot = -30.919364198, dEtot = 1.949e-04, dEband = 1.137e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.2816573328046, which took 0.149 ms

iter_count = 108, r_2norm = 4.919e-05, tol*||rhs|| = 5.127e-05

Anderson update took 49.648 ms, out of which F'*F took 25.303 ms; b-Ax took 167.336 ms, out of which Lap took 152.163 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 345.807 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921135, int_b + int_rho = -1.928e-13, checking this took 0.089 ms
2-norm of RHS = 629.2238551613675, which took 0.112 ms

iter_count = 264, r_2norm = 5.359e-04, tol*||rhs|| = 6.292e-04

Anderson update took 128.675 ms, out of which F'*F took 64.802 ms; b-Ax took 414.972 ms, out of which Lap took 382.228 ms
Solving Poisson took 833.351 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Total time for convolution: 	 convolve: 5.079690 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.730 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.069344 
Total time for convolution: 	 convolve: 5.127030 
Total time for convolution: 	 convolve: 5.089188 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.149 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.914 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.845 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.775 ms

This SCF took 26697.889 ms, scf error = 1.397e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.152154, lowerbound = -1.006412, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1057.297 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 29.276 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.218 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.219 ms
rank =  0, Distribute data + matrix mult took 32.727 ms
rank =  0, finding HY took 18.319 ms
rank =  0, distributing HY into block cyclic form took 11.345 ms
rank =  0, finding Y'*HY took 4.340 ms
Rank 0, Project_Hamiltonian used 66.762 ms
Total time for projection: 66.775 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.896 ms
    first calculated eigval = -1.000085925375277
    last  calculated eigval = 0.045283219964640
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.00008592537528
lambda[   2] =  -0.61522875404197
lambda[   3] =  -0.57879740735267
lambda[   4] =  -0.46537491056986
lambda[   5] =  -0.44146364030857
lambda[   6] =  -0.36448146335519
lambda[   7] =  -0.34454211418815
lambda[   8] =  -0.28538115904996
lambda[   9] =  -0.23344152987784
lambda[  10] =  -0.03158550664066
lambda[  11] =   0.00301545995158
lambda[  12] =   0.00655374258667
lambda[  13] =   0.01415945638933
lambda[  14] =   0.03539980880878
lambda[  15] =   0.04528321996464
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.919 ms
rank =  0, subspace rotation using ScaLAPACK took 3.431 ms
rank =  0, Distributing orbital back into band + domain format took 11.165 ms
rank = 0, Subspace_Rotation used 14.611 ms

Total time for subspace rotation: 14.619 ms
rank = 0, Efermi =  -0.060788006527 calculate fermi energy took 1.811 ms
rank = 0, --- Calculate rho: sum over local bands took 2.322 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.617 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.108 ms
rank = 0, Calculating density took 1145.546 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.418 ms
rank = 0, D2D took 1.105 ms
rank = 0, Transfering density took 1.113 ms
Etot    =   -30.918263965859
Eband   =    -8.657593808846
E1      =    19.111099421853
E2      =    -7.899450510974
E3      =   -11.137314051708
Exc     =    -9.875993076069
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 1.572e-04, dEband = 1.711e-02
rank = 0, Calculating/Estimating energy took 0.869 ms, Etot = -30.918263966, dEtot = 1.572e-04, dEband = 1.711e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6777052843423, which took 0.138 ms

iter_count = 108, r_2norm = 2.410e-05, tol*||rhs|| = 2.711e-05

Anderson update took 53.067 ms, out of which F'*F took 26.754 ms; b-Ax took 170.441 ms, out of which Lap took 157.516 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 347.694 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921139, int_b + int_rho = -1.528e-13, checking this took 0.087 ms
2-norm of RHS = 629.5066822142840, which took 0.121 ms

iter_count = 234, r_2norm = 5.959e-04, tol*||rhs|| = 6.295e-04

Anderson update took 113.262 ms, out of which F'*F took 57.220 ms; b-Ax took 364.570 ms, out of which Lap took 337.194 ms
Solving Poisson took 736.362 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Total time for convolution: 	 convolve: 5.072751 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.665 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.146 ms
Total time for convolution: 	 convolve: 5.071461 
Total time for convolution: 	 convolve: 5.069590 
Total time for convolution: 	 convolve: 5.071679 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.508 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.306 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.917 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.835 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.768 ms

This SCF took 26634.234 ms, scf error = 4.492e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.145283, lowerbound = -1.000086, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1058.058 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 24.772 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.242 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.173 ms
rank =  0, Distribute data + matrix mult took 28.200 ms
rank =  0, finding HY took 18.531 ms
rank =  0, distributing HY into block cyclic form took 11.684 ms
rank =  0, finding Y'*HY took 4.093 ms
Rank 0, Project_Hamiltonian used 62.941 ms
Total time for projection: 62.955 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -0.997741187020200
    last  calculated eigval = 0.040593570157876
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99774118702020
lambda[   2] =  -0.61289525295047
lambda[   3] =  -0.57636599758339
lambda[   4] =  -0.46300359683031
lambda[   5] =  -0.43925551280305
lambda[   6] =  -0.36236276950895
lambda[   7] =  -0.34229487691292
lambda[   8] =  -0.28293283751897
lambda[   9] =  -0.23175348947982
lambda[  10] =  -0.03155391970383
lambda[  11] =   0.00291582132795
lambda[  12] =   0.00560313464742
lambda[  13] =   0.01297924150257
lambda[  14] =   0.03205981956152
lambda[  15] =   0.04059357015788
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 2.988 ms
rank =  0, Distributing orbital back into band + domain format took 11.318 ms
rank = 0, Subspace_Rotation used 14.319 ms

Total time for subspace rotation: 14.323 ms
rank = 0, Efermi =  -0.060756419578 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.752 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.623 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.127 ms
rank = 0, Calculating density took 1141.125 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.447 ms
rank = 0, D2D took 1.354 ms
rank = 0, Transfering density took 1.368 ms
Etot    =   -30.918103271851
Eband   =    -8.617211041822
E1      =    19.095464969610
E2      =    -7.873339055302
E3      =   -11.140980029488
Exc     =    -9.878135218950
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 2.296e-05, dEband = 5.769e-03
rank = 0, Calculating/Estimating energy took 0.890 ms, Etot = -30.918103272, dEtot = 2.296e-05, dEband = 5.769e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3364170568674, which took 0.120 ms

iter_count = 114, r_2norm = 8.347e-06, tol*||rhs|| = 1.346e-05

Anderson update took 57.613 ms, out of which F'*F took 28.698 ms; b-Ax took 178.391 ms, out of which Lap took 165.933 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 367.734 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921134, int_b + int_rho = -2.037e-13, checking this took 0.089 ms
2-norm of RHS = 629.7002689535307, which took 0.124 ms

iter_count = 240, r_2norm = 5.300e-04, tol*||rhs|| = 6.297e-04

Anderson update took 118.252 ms, out of which F'*F took 58.643 ms; b-Ax took 378.141 ms, out of which Lap took 349.440 ms
Solving Poisson took 759.784 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 5.077317 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 42.680 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.074273 
Total time for convolution: 	 convolve: 5.075100 
Total time for convolution: 	 convolve: 5.074390 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.757 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.202 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 0.947 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.846 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.810 ms

This SCF took 26617.246 ms, scf error = 2.626e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.140594, lowerbound = -0.997741, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1060.419 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.003 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.231 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.140 ms
rank =  0, Distribute data + matrix mult took 21.391 ms
rank =  0, finding HY took 18.398 ms
rank =  0, distributing HY into block cyclic form took 11.350 ms
rank =  0, finding Y'*HY took 4.379 ms
Rank 0, Project_Hamiltonian used 56.015 ms
Total time for projection: 56.030 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.993606215837151
    last  calculated eigval = 0.041129566026256
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99360621583715
lambda[   2] =  -0.60915211363210
lambda[   3] =  -0.57282883588330
lambda[   4] =  -0.45947390324285
lambda[   5] =  -0.43555773571536
lambda[   6] =  -0.35849436366270
lambda[   7] =  -0.33901490298664
lambda[   8] =  -0.27916008090331
lambda[   9] =  -0.22791141601799
lambda[  10] =  -0.03029103559315
lambda[  11] =   0.00466250542339
lambda[  12] =   0.00678533828637
lambda[  13] =   0.01289194872404
lambda[  14] =   0.02694013498400
lambda[  15] =   0.04112956602626
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 2.995 ms
rank =  0, Distributing orbital back into band + domain format took 11.229 ms
rank = 0, Subspace_Rotation used 14.236 ms

Total time for subspace rotation: 14.241 ms
rank = 0, Efermi =  -0.059493535475 calculate fermi energy took 0.082 ms
rank = 0, --- Calculate rho: sum over local bands took 1.843 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.411 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.123 ms
rank = 0, Calculating density took 1136.401 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.458 ms
rank = 0, D2D took 1.921 ms
rank = 0, Transfering density took 1.929 ms
Etot    =   -30.918020531987
Eband   =    -8.550399136345
E1      =    19.063164270945
E2      =    -7.835985809533
E3      =   -11.150823438418
Exc     =    -9.885053849059
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 1.182e-05, dEband = 9.545e-03
rank = 0, Calculating/Estimating energy took 0.856 ms, Etot = -30.918020532, dEtot = 1.182e-05, dEband = 9.545e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2142001593554, which took 0.129 ms

iter_count = 108, r_2norm = 8.320e-06, tol*||rhs|| = 8.568e-06

Anderson update took 54.391 ms, out of which F'*F took 27.018 ms; b-Ax took 170.266 ms, out of which Lap took 158.786 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.139 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921140, int_b + int_rho = -1.419e-13, checking this took 0.095 ms
2-norm of RHS = 629.6829017048507, which took 0.122 ms

iter_count = 222, r_2norm = 6.197e-04, tol*||rhs|| = 6.297e-04

Anderson update took 111.411 ms, out of which F'*F took 56.981 ms; b-Ax took 356.501 ms, out of which Lap took 332.927 ms
Solving Poisson took 707.522 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.194 ms
Total time for convolution: 	 convolve: 5.082701 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.738 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.083947 
Total time for convolution: 	 convolve: 5.087948 
Total time for convolution: 	 convolve: 5.095287 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.769 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.932 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.855 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.807 ms

This SCF took 26657.352 ms, scf error = 1.471e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.141130, lowerbound = -0.993606, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1041.840 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 24.548 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.193 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.294 ms
rank =  0, Distribute data + matrix mult took 28.049 ms
rank =  0, finding HY took 18.305 ms
rank =  0, distributing HY into block cyclic form took 11.368 ms
rank =  0, finding Y'*HY took 4.340 ms
Rank 0, Project_Hamiltonian used 62.092 ms
Total time for projection: 62.104 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -0.991204331396635
    last  calculated eigval = 0.043138413175406
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99120433139664
lambda[   2] =  -0.60666878703384
lambda[   3] =  -0.57050201451209
lambda[   4] =  -0.45719977928777
lambda[   5] =  -0.43312525284478
lambda[   6] =  -0.35608921611423
lambda[   7] =  -0.33685598401151
lambda[   8] =  -0.27666190467680
lambda[   9] =  -0.22550021977402
lambda[  10] =  -0.02844084916371
lambda[  11] =   0.00673447007800
lambda[  12] =   0.00936047810600
lambda[  13] =   0.01348122340917
lambda[  14] =   0.02347165516959
lambda[  15] =   0.04313841317541
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.176 ms
rank =  0, subspace rotation using ScaLAPACK took 3.014 ms
rank =  0, Distributing orbital back into band + domain format took 11.323 ms
rank = 0, Subspace_Rotation used 14.351 ms

Total time for subspace rotation: 14.355 ms
rank = 0, Efermi =  -0.057643348981 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.740 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.660 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.122 ms
rank = 0, Calculating density took 1124.111 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.466 ms
rank = 0, D2D took 1.240 ms
rank = 0, Transfering density took 1.247 ms
Etot    =   -30.918034195262
Eband   =    -8.507614979850
E1      =    19.039787443270
E2      =    -7.815323437439
E3      =   -11.156164275512
Exc     =    -9.889153306154
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 1.952e-06, dEband = 6.112e-03
rank = 0, Calculating/Estimating energy took 0.855 ms, Etot = -30.918034195, dEtot = 1.952e-06, dEband = 6.112e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1050604287236, which took 0.141 ms

iter_count = 114, r_2norm = 2.883e-06, tol*||rhs|| = 4.202e-06

Anderson update took 56.585 ms, out of which F'*F took 28.508 ms; b-Ax took 180.024 ms, out of which Lap took 167.618 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 367.406 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921135, int_b + int_rho = -2.001e-13, checking this took 0.092 ms
2-norm of RHS = 629.6924164579033, which took 0.135 ms

iter_count = 216, r_2norm = 5.913e-04, tol*||rhs|| = 6.297e-04

Anderson update took 107.021 ms, out of which F'*F took 55.417 ms; b-Ax took 347.044 ms, out of which Lap took 323.661 ms
Solving Poisson took 688.272 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.071840 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.072781 
Total time for convolution: 	 convolve: 5.073564 
Total time for convolution: 	 convolve: 5.072995 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.218 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.968 ms
---Transfer Veff_loc: D2D took 1.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.830 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.511 ms

This SCF took 26470.437 ms, scf error = 1.048e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.143138, lowerbound = -0.991204, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1047.191 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 27.009 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.195 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.292 ms
rank =  0, Distribute data + matrix mult took 30.511 ms
rank =  0, finding HY took 18.390 ms
rank =  0, distributing HY into block cyclic form took 11.374 ms
rank =  0, finding Y'*HY took 4.221 ms
Rank 0, Project_Hamiltonian used 64.529 ms
Total time for projection: 64.542 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -0.990219862020014
    last  calculated eigval = 0.045461581627537
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.99021986202001
lambda[   2] =  -0.60564794457533
lambda[   3] =  -0.56943712817461
lambda[   4] =  -0.45611784033933
lambda[   5] =  -0.43210317467365
lambda[   6] =  -0.35502443738053
lambda[   7] =  -0.33572106603124
lambda[   8] =  -0.27568469843821
lambda[   9] =  -0.22437078485310
lambda[  10] =  -0.02514859260803
lambda[  11] =   0.00988381868547
lambda[  12] =   0.01346990714831
lambda[  13] =   0.01629843872407
lambda[  14] =   0.02371209721326
lambda[  15] =   0.04546158162754
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 3.027 ms
rank =  0, Distributing orbital back into band + domain format took 11.277 ms
rank = 0, Subspace_Rotation used 14.317 ms

Total time for subspace rotation: 14.322 ms
rank = 0, Efermi =  -0.054351092537 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 1.748 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.654 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.112 ms
rank = 0, Calculating density took 1131.851 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.463 ms
rank = 0, D2D took 1.111 ms
rank = 0, Transfering density took 1.120 ms
Etot    =   -30.918042741076
Eband   =    -8.488653873455
E1      =    19.032716629171
E2      =    -7.803376297916
E3      =   -11.156417007895
Exc     =    -9.889357737122
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 1.221e-06, dEband = 2.709e-03
rank = 0, Calculating/Estimating energy took 0.854 ms, Etot = -30.918042741, dEtot = 1.221e-06, dEband = 2.709e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0759047521899, which took 0.055 ms

iter_count = 108, r_2norm = 2.829e-06, tol*||rhs|| = 3.036e-06

Anderson update took 53.414 ms, out of which F'*F took 27.367 ms; b-Ax took 171.318 ms, out of which Lap took 159.544 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.370 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921136, int_b + int_rho = -1.892e-13, checking this took 0.076 ms
2-norm of RHS = 629.6816074233600, which took 0.126 ms

iter_count = 198, r_2norm = 5.741e-04, tol*||rhs|| = 6.297e-04

Anderson update took 97.020 ms, out of which F'*F took 50.532 ms; b-Ax took 318.830 ms, out of which Lap took 296.782 ms
Solving Poisson took 630.412 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
Total time for convolution: 	 convolve: 5.078966 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.158 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.072663 
Total time for convolution: 	 convolve: 5.074332 
Total time for convolution: 	 convolve: 5.077429 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.226 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.096 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.910 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.838 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.764 ms

This SCF took 26421.547 ms, scf error = 6.352e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.145462, lowerbound = -0.990220, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1066.883 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 27.142 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.174 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.147 ms
rank =  0, Distribute data + matrix mult took 30.476 ms
rank =  0, finding HY took 18.356 ms
rank =  0, distributing HY into block cyclic form took 11.320 ms
rank =  0, finding Y'*HY took 4.237 ms
Rank 0, Project_Hamiltonian used 64.424 ms
Total time for projection: 64.440 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.257 ms
rank = 0, Solve_Generalized_EigenProblem used 0.355 ms
    first calculated eigval = -0.988840194606391
    last  calculated eigval = 0.047437405159761
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98884019460639
lambda[   2] =  -0.60440593063489
lambda[   3] =  -0.56822381336936
lambda[   4] =  -0.45489462410396
lambda[   5] =  -0.43087383326650
lambda[   6] =  -0.35375875481450
lambda[   7] =  -0.33456319361678
lambda[   8] =  -0.27443676335557
lambda[   9] =  -0.22310919540417
lambda[  10] =  -0.02179224263831
lambda[  11] =   0.01221546532672
lambda[  12] =   0.01668132295331
lambda[  13] =   0.01937559819278
lambda[  14] =   0.02555800640852
lambda[  15] =   0.04743740515976
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.369 ms
rank =  0, subspace rotation using ScaLAPACK took 2.995 ms
rank =  0, Distributing orbital back into band + domain format took 11.234 ms
rank = 0, Subspace_Rotation used 14.243 ms

Total time for subspace rotation: 14.248 ms
rank = 0, Efermi =  -0.050994742599 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 1.747 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.663 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.119 ms
rank = 0, Calculating density took 1151.585 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.455 ms
rank = 0, D2D took 1.256 ms
rank = 0, Transfering density took 1.264 ms
Etot    =   -30.918080390173
Eband   =    -8.466212606763
E1      =    19.020464388589
E2      =    -7.792657777019
E3      =   -11.158945540545
Exc     =    -9.891394424085
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 5.378e-06, dEband = 3.206e-03
rank = 0, Calculating/Estimating energy took 0.834 ms, Etot = -30.918080390, dEtot = 5.378e-06, dEband = 3.206e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0572287718748, which took 0.144 ms

iter_count = 114, r_2norm = 1.451e-06, tol*||rhs|| = 2.289e-06

Anderson update took 56.448 ms, out of which F'*F took 28.625 ms; b-Ax took 179.950 ms, out of which Lap took 167.741 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 367.980 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921141, int_b + int_rho = -1.382e-13, checking this took 0.099 ms
2-norm of RHS = 629.6867702916438, which took 0.125 ms

iter_count = 168, r_2norm = 5.528e-04, tol*||rhs|| = 6.297e-04

Anderson update took 81.441 ms, out of which F'*F took 42.848 ms; b-Ax took 270.602 ms, out of which Lap took 251.953 ms
Solving Poisson took 534.927 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.069889 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.373 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.092003 
Total time for convolution: 	 convolve: 5.076246 
Total time for convolution: 	 convolve: 5.078756 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.755 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.526 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.317 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.687 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.920 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.845 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.782 ms

This SCF took 26358.470 ms, scf error = 3.571e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.147437, lowerbound = -0.988840, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1084.184 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.119 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.350 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.258 ms
rank =  0, Distribute data + matrix mult took 15.740 ms
rank =  0, finding HY took 18.293 ms
rank =  0, distributing HY into block cyclic form took 11.436 ms
rank =  0, finding Y'*HY took 4.290 ms
Rank 0, Project_Hamiltonian used 49.791 ms
Total time for projection: 49.804 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -0.988453963578388
    last  calculated eigval = 0.048000554324834
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98845396357839
lambda[   2] =  -0.60403669451507
lambda[   3] =  -0.56785355267413
lambda[   4] =  -0.45452614187502
lambda[   5] =  -0.43051431738595
lambda[   6] =  -0.35340022186534
lambda[   7] =  -0.33421367108812
lambda[   8] =  -0.27405774855245
lambda[   9] =  -0.22277695815720
lambda[  10] =  -0.02036231998388
lambda[  11] =   0.01283680874162
lambda[  12] =   0.01769812167980
lambda[  13] =   0.02023070100582
lambda[  14] =   0.02652503218410
lambda[  15] =   0.04800055432483
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 3.019 ms
rank =  0, Distributing orbital back into band + domain format took 11.211 ms
rank = 0, Subspace_Rotation used 14.241 ms

Total time for subspace rotation: 14.246 ms
rank = 0, Efermi =  -0.049564819978 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.747 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.771 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.117 ms
rank = 0, Calculating density took 1154.161 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.475 ms
rank = 0, D2D took 1.032 ms
rank = 0, Transfering density took 1.047 ms
Etot    =   -30.918110255389
Eband   =    -8.459666539775
E1      =    19.017151238196
E2      =    -7.789329087488
E3      =   -11.159360148355
Exc     =    -9.891743124175
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 4.266e-06, dEband = 9.352e-04
rank = 0, Calculating/Estimating energy took 1.229 ms, Etot = -30.918110255, dEtot = 4.266e-06, dEband = 9.352e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0387547889511, which took 0.057 ms

iter_count = 108, r_2norm = 1.284e-06, tol*||rhs|| = 1.550e-06

Anderson update took 54.316 ms, out of which F'*F took 27.343 ms; b-Ax took 170.848 ms, out of which Lap took 159.348 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.273 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921135, int_b + int_rho = -1.928e-13, checking this took 0.090 ms
2-norm of RHS = 629.7038436811621, which took 0.119 ms

iter_count = 180, r_2norm = 5.735e-04, tol*||rhs|| = 6.297e-04

Anderson update took 88.035 ms, out of which F'*F took 46.151 ms; b-Ax took 289.936 ms, out of which Lap took 269.946 ms
Solving Poisson took 573.279 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.073946 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.497 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.072620 
Total time for convolution: 	 convolve: 5.081058 
Total time for convolution: 	 convolve: 5.082824 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.772 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.300 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.130 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.918 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.837 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.771 ms

This SCF took 26360.652 ms, scf error = 2.661e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.148001, lowerbound = -0.988454, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1044.446 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 26.439 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.235 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.219 ms
rank =  0, Distribute data + matrix mult took 29.905 ms
rank =  0, finding HY took 18.324 ms
rank =  0, distributing HY into block cyclic form took 11.936 ms
rank =  0, finding Y'*HY took 4.220 ms
Rank 0, Project_Hamiltonian used 64.415 ms
Total time for projection: 64.428 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.988290437109262
    last  calculated eigval = 0.048401256321383
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98829043710926
lambda[   2] =  -0.60374566156224
lambda[   3] =  -0.56754510149895
lambda[   4] =  -0.45422607321075
lambda[   5] =  -0.43024667121784
lambda[   6] =  -0.35316182439625
lambda[   7] =  -0.33388215133167
lambda[   8] =  -0.27378399248475
lambda[   9] =  -0.22255512561709
lambda[  10] =  -0.01705673102228
lambda[  11] =   0.01238519690456
lambda[  12] =   0.01931159261103
lambda[  13] =   0.02235989630239
lambda[  14] =   0.03084641332664
lambda[  15] =   0.04840125632138
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 2.996 ms
rank =  0, Distributing orbital back into band + domain format took 11.321 ms
rank = 0, Subspace_Rotation used 14.330 ms

Total time for subspace rotation: 14.335 ms
rank = 0, Efermi =  -0.046259230976 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.722 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.674 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.115 ms
rank = 0, Calculating density took 1129.008 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.458 ms
rank = 0, D2D took 1.571 ms
rank = 0, Transfering density took 1.578 ms
Etot    =   -30.918194285905
Eband   =    -8.454874077185
E1      =    19.015476104136
E2      =    -7.786212477360
E3      =   -11.159137762657
Exc     =    -9.891605487393
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 1.200e-05, dEband = 6.846e-04
rank = 0, Calculating/Estimating energy took 0.852 ms, Etot = -30.918194286, dEtot = 1.200e-05, dEband = 6.846e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0426963450183, which took 0.138 ms

iter_count = 108, r_2norm = 1.328e-06, tol*||rhs|| = 1.708e-06

Anderson update took 53.436 ms, out of which F'*F took 27.185 ms; b-Ax took 170.442 ms, out of which Lap took 158.838 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 348.530 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921137, int_b + int_rho = -1.783e-13, checking this took 0.089 ms
2-norm of RHS = 629.6987841118430, which took 0.111 ms

iter_count = 114, r_2norm = 5.857e-04, tol*||rhs|| = 6.297e-04

Anderson update took 56.450 ms, out of which F'*F took 29.097 ms; b-Ax took 183.351 ms, out of which Lap took 171.054 ms
Solving Poisson took 364.302 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.076043 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.392 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.071864 
Total time for convolution: 	 convolve: 5.072377 
Total time for convolution: 	 convolve: 5.078654 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.771 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.214 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.555 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.903 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.835 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.759 ms

This SCF took 26127.464 ms, scf error = 3.045e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.148401, lowerbound = -0.988290, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1072.605 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.176 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.259 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.233 ms
rank =  0, Distribute data + matrix mult took 21.682 ms
rank =  0, finding HY took 18.435 ms
rank =  0, distributing HY into block cyclic form took 11.424 ms
rank =  0, finding Y'*HY took 4.239 ms
Rank 0, Project_Hamiltonian used 55.811 ms
Total time for projection: 55.825 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -0.988105544244477
    last  calculated eigval = 0.048383734738266
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98810554424448
lambda[   2] =  -0.60361518359394
lambda[   3] =  -0.56743210215681
lambda[   4] =  -0.45411060133742
lambda[   5] =  -0.43011186178114
lambda[   6] =  -0.35300996386218
lambda[   7] =  -0.33378998702037
lambda[   8] =  -0.27364746196518
lambda[   9] =  -0.22239666512435
lambda[  10] =  -0.01697769334442
lambda[  11] =   0.01224798214913
lambda[  12] =   0.01930546299439
lambda[  13] =   0.02221453154332
lambda[  14] =   0.03033603348957
lambda[  15] =   0.04838373473827
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 3.012 ms
rank =  0, Distributing orbital back into band + domain format took 11.289 ms
rank = 0, Subspace_Rotation used 14.312 ms

Total time for subspace rotation: 14.317 ms
rank = 0, Efermi =  -0.046180193218 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.717 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.634 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.106 ms
rank = 0, Calculating density took 1148.799 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.461 ms
rank = 0, D2D took 1.258 ms
rank = 0, Transfering density took 1.266 ms
Etot    =   -30.918195706895
Eband   =    -8.452438742498
E1      =    19.013895074266
E2      =    -7.785264026651
E3      =   -11.159565963304
Exc     =    -9.891940963139
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 2.030e-07, dEband = 3.479e-04
rank = 0, Calculating/Estimating energy took 0.867 ms, Etot = -30.918195707, dEtot = 2.030e-07, dEband = 3.479e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0401560645578, which took 0.059 ms

iter_count = 108, r_2norm = 1.282e-06, tol*||rhs|| = 1.606e-06

Anderson update took 54.271 ms, out of which F'*F took 26.979 ms; b-Ax took 170.499 ms, out of which Lap took 158.960 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.522 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921137, int_b + int_rho = -1.746e-13, checking this took 0.085 ms
2-norm of RHS = 629.6977852574066, which took 0.114 ms

iter_count = 120, r_2norm = 6.130e-04, tol*||rhs|| = 6.297e-04

Anderson update took 59.102 ms, out of which F'*F took 31.065 ms; b-Ax took 193.112 ms, out of which Lap took 180.331 ms
Solving Poisson took 382.710 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.072985 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 50.303 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.076492 
Total time for convolution: 	 convolve: 5.079657 
Total time for convolution: 	 convolve: 5.074918 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.223 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.482 ms
---Transfer Veff_loc: D2D took 0.922 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.845 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.782 ms

This SCF took 26218.321 ms, scf error = 1.876e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.148384, lowerbound = -0.988106, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1056.834 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 28.471 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.172 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.226 ms
rank =  0, Distribute data + matrix mult took 31.884 ms
rank =  0, finding HY took 18.322 ms
rank =  0, distributing HY into block cyclic form took 11.278 ms
rank =  0, finding Y'*HY took 4.359 ms
Rank 0, Project_Hamiltonian used 65.874 ms
Total time for projection: 65.888 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.987945404758953
    last  calculated eigval = 0.048432267477758
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98794540475895
lambda[   2] =  -0.60348815846782
lambda[   3] =  -0.56731239100009
lambda[   4] =  -0.45398890501724
lambda[   5] =  -0.42998286500405
lambda[   6] =  -0.35286946954110
lambda[   7] =  -0.33368218298652
lambda[   8] =  -0.27351807347151
lambda[   9] =  -0.22225523948654
lambda[  10] =  -0.01657820955358
lambda[  11] =   0.01219179858404
lambda[  12] =   0.01928358145442
lambda[  13] =   0.02215536520027
lambda[  14] =   0.03049043032637
lambda[  15] =   0.04843226747776
==subpsace eigenproblem: bcast eigvals took 0.036 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 3.444 ms
rank =  0, Distributing orbital back into band + domain format took 11.092 ms
rank = 0, Subspace_Rotation used 14.550 ms

Total time for subspace rotation: 14.556 ms
rank = 0, Efermi =  -0.045780709477 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 1.917 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.526 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.105 ms
rank = 0, Calculating density took 1143.556 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.433 ms
rank = 0, D2D took 0.965 ms
rank = 0, Transfering density took 0.972 ms
Etot    =   -30.918214880089
Eband   =    -8.450085379786
E1      =    19.012614220329
E2      =    -7.784123924899
E3      =   -11.159780847381
Exc     =    -9.892107427432
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 2.739e-06, dEband = 3.362e-04
rank = 0, Calculating/Estimating energy took 0.858 ms, Etot = -30.918214880, dEtot = 2.739e-06, dEband = 3.362e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0292645968097, which took 0.161 ms

iter_count = 102, r_2norm = 1.170e-06, tol*||rhs|| = 1.171e-06

Anderson update took 50.673 ms, out of which F'*F took 25.486 ms; b-Ax took 160.616 ms, out of which Lap took 149.752 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 329.526 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921135, int_b + int_rho = -1.928e-13, checking this took 0.093 ms
2-norm of RHS = 629.7046044699154, which took 0.101 ms

iter_count = 150, r_2norm = 5.656e-04, tol*||rhs|| = 6.297e-04

Anderson update took 71.920 ms, out of which F'*F took 38.143 ms; b-Ax took 242.114 ms, out of which Lap took 224.721 ms
Solving Poisson took 477.976 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Total time for convolution: 	 convolve: 5.071342 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 47.553 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.070824 
Total time for convolution: 	 convolve: 5.088246 
Total time for convolution: 	 convolve: 5.075382 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.496 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.366 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.912 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.845 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.777 ms

This SCF took 26296.169 ms, scf error = 1.443e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.148432, lowerbound = -0.987945, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1073.431 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 25.951 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.299 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.168 ms
rank =  0, Distribute data + matrix mult took 29.431 ms
rank =  0, finding HY took 18.487 ms
rank =  0, distributing HY into block cyclic form took 11.356 ms
rank =  0, finding Y'*HY took 4.129 ms
Rank 0, Project_Hamiltonian used 63.428 ms
Total time for projection: 63.439 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -0.987936848191906
    last  calculated eigval = 0.048525628278286
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98793684819191
lambda[   2] =  -0.60344092844118
lambda[   3] =  -0.56724425315708
lambda[   4] =  -0.45392470285666
lambda[   5] =  -0.42993971023294
lambda[   6] =  -0.35283718255004
lambda[   7] =  -0.33360145408896
lambda[   8] =  -0.27348017333142
lambda[   9] =  -0.22223542990004
lambda[  10] =  -0.01644894157018
lambda[  11] =   0.01184770704949
lambda[  12] =   0.01843189342760
lambda[  13] =   0.02100553554511
lambda[  14] =   0.03059071652513
lambda[  15] =   0.04852562827829
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 6.703 ms
rank =  0, Distributing orbital back into band + domain format took 10.007 ms
rank = 0, Subspace_Rotation used 16.729 ms

Total time for subspace rotation: 16.739 ms
rank = 0, Efermi =  -0.045651441447 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.074 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.420 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.102 ms
rank = 0, Calculating density took 1162.133 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.417 ms
rank = 0, D2D took 0.540 ms
rank = 0, Transfering density took 0.546 ms
Etot    =   -30.918242917553
Eband   =    -8.449281365816
E1      =    19.012673951653
E2      =    -7.783288810541
E3      =   -11.159461367497
Exc     =    -9.891844615947
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 4.005e-06, dEband = 1.149e-04
rank = 0, Calculating/Estimating energy took 0.893 ms, Etot = -30.918242918, dEtot = 4.005e-06, dEband = 1.149e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0274032025893, which took 0.073 ms

iter_count = 108, r_2norm = 7.038e-07, tol*||rhs|| = 1.096e-06

Anderson update took 52.967 ms, out of which F'*F took 26.899 ms; b-Ax took 170.561 ms, out of which Lap took 158.805 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 347.738 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921135, int_b + int_rho = -1.928e-13, checking this took 0.103 ms
2-norm of RHS = 629.7028174203808, which took 0.104 ms

iter_count = 78, r_2norm = 6.288e-04, tol*||rhs|| = 6.297e-04

Anderson update took 37.242 ms, out of which F'*F took 19.905 ms; b-Ax took 125.799 ms, out of which Lap took 116.899 ms
Solving Poisson took 249.891 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.072560 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.174 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.072401 
Total time for convolution: 	 convolve: 5.112000 
Total time for convolution: 	 convolve: 5.078073 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.045 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.906 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.833 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.765 ms

This SCF took 26085.960 ms, scf error = 2.175e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.148526, lowerbound = -0.987937, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1062.141 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.441 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.259 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.217 ms
rank =  0, Distribute data + matrix mult took 23.932 ms
rank =  0, finding HY took 18.328 ms
rank =  0, distributing HY into block cyclic form took 11.296 ms
rank =  0, finding Y'*HY took 4.390 ms
Rank 0, Project_Hamiltonian used 57.984 ms
Total time for projection: 57.997 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.693 ms
    first calculated eigval = -0.987914645233092
    last  calculated eigval = 0.048542627336371
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98791464523309
lambda[   2] =  -0.60343882778678
lambda[   3] =  -0.56724448623887
lambda[   4] =  -0.45392286614617
lambda[   5] =  -0.42993523019680
lambda[   6] =  -0.35282664536093
lambda[   7] =  -0.33360547883581
lambda[   8] =  -0.27347637760945
lambda[   9] =  -0.22222330537352
lambda[  10] =  -0.01626047670250
lambda[  11] =   0.01179038513654
lambda[  12] =   0.01839895714903
lambda[  13] =   0.02095420525920
lambda[  14] =   0.03059941430417
lambda[  15] =   0.04854262733637
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.756 ms
rank =  0, subspace rotation using ScaLAPACK took 3.367 ms
rank =  0, Distributing orbital back into band + domain format took 11.188 ms
rank = 0, Subspace_Rotation used 14.572 ms

Total time for subspace rotation: 14.578 ms
rank = 0, Efermi =  -0.045462976611 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 1.745 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.719 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.122 ms
rank = 0, Calculating density took 1141.190 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.469 ms
rank = 0, D2D took 1.005 ms
rank = 0, Transfering density took 1.012 ms
Etot    =   -30.918241494949
Eband   =    -8.449175725875
E1      =    19.012528379155
E2      =    -7.783326734494
E3      =   -11.159498395376
Exc     =    -9.891878212620
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 2.032e-07, dEband = 1.509e-05
rank = 0, Calculating/Estimating energy took 0.869 ms, Etot = -30.918241495, dEtot = 2.032e-07, dEband = 1.509e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0282865486529, which took 0.115 ms

iter_count = 108, r_2norm = 7.664e-07, tol*||rhs|| = 1.131e-06

Anderson update took 52.845 ms, out of which F'*F took 27.000 ms; b-Ax took 170.757 ms, out of which Lap took 159.143 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 347.989 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921137, int_b + int_rho = -1.746e-13, checking this took 0.086 ms
2-norm of RHS = 629.7027889264153, which took 0.117 ms

iter_count = 102, r_2norm = 5.736e-04, tol*||rhs|| = 6.297e-04

Anderson update took 48.784 ms, out of which F'*F took 26.040 ms; b-Ax took 164.629 ms, out of which Lap took 152.970 ms
Solving Poisson took 325.535 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.072609 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.742 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.071631 
Total time for convolution: 	 convolve: 5.072161 
Total time for convolution: 	 convolve: 5.074844 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.751 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.212 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.909 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.835 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.765 ms

This SCF took 26168.524 ms, scf error = 1.756e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.148543, lowerbound = -0.987915, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1063.867 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.043 ms
rank =  0, Distribute orbital to block cyclic format took 16.898 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.455 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.251 ms
rank =  0, Distribute data + matrix mult took 20.618 ms
rank =  0, finding HY took 18.427 ms
rank =  0, distributing HY into block cyclic form took 11.580 ms
rank =  0, finding Y'*HY took 4.511 ms
Rank 0, Project_Hamiltonian used 55.625 ms
Total time for projection: 55.640 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -0.987856607871067
    last  calculated eigval = 0.048760551921358
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98785660787107
lambda[   2] =  -0.60338144427514
lambda[   3] =  -0.56718927263810
lambda[   4] =  -0.45386775498873
lambda[   5] =  -0.42987832463353
lambda[   6] =  -0.35276815298716
lambda[   7] =  -0.33355199346929
lambda[   8] =  -0.27341855147445
lambda[   9] =  -0.22216270708050
lambda[  10] =  -0.01570191224909
lambda[  11] =   0.01211592051577
lambda[  12] =   0.01889585633145
lambda[  13] =   0.02147726076646
lambda[  14] =   0.03085182553102
lambda[  15] =   0.04876055192136
==subpsace eigenproblem: bcast eigvals took 0.056 ms
Total time for solving subspace eigenvalue problem: 0.218 ms
rank =  0, subspace rotation using ScaLAPACK took 3.008 ms
rank =  0, Distributing orbital back into band + domain format took 11.172 ms
rank = 0, Subspace_Rotation used 14.195 ms

Total time for subspace rotation: 14.200 ms
rank = 0, Efermi =  -0.044904412187 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 1.822 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.511 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.142 ms
rank = 0, Calculating density took 1139.519 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.480 ms
rank = 0, D2D took 1.968 ms
rank = 0, Transfering density took 1.975 ms
Etot    =   -30.918243701263
Eband   =    -8.448149619138
E1      =    19.012044875496
E2      =    -7.782768348385
E3      =   -11.159562899618
Exc     =    -9.891929140145
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 3.152e-07, dEband = 1.466e-04
rank = 0, Calculating/Estimating energy took 0.852 ms, Etot = -30.918243701, dEtot = 3.152e-07, dEband = 1.466e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0322656688215, which took 0.091 ms

iter_count = 102, r_2norm = 1.215e-06, tol*||rhs|| = 1.291e-06

Anderson update took 51.821 ms, out of which F'*F took 25.737 ms; b-Ax took 161.454 ms, out of which Lap took 150.340 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 331.608 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921139, int_b + int_rho = -1.528e-13, checking this took 0.097 ms
2-norm of RHS = 629.7036244592945, which took 0.119 ms

iter_count = 120, r_2norm = 6.064e-04, tol*||rhs|| = 6.297e-04

Anderson update took 56.860 ms, out of which F'*F took 30.250 ms; b-Ax took 194.111 ms, out of which Lap took 179.836 ms
Solving Poisson took 383.165 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.070914 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.073163 
Total time for convolution: 	 convolve: 5.073356 
Total time for convolution: 	 convolve: 5.077457 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.526 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.322 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.914 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.845 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.781 ms

This SCF took 26191.616 ms, scf error = 1.803e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.148761, lowerbound = -0.987857, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1064.864 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.719 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.285 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.202 ms
rank =  0, Distribute data + matrix mult took 16.226 ms
rank =  0, finding HY took 18.480 ms
rank =  0, distributing HY into block cyclic form took 11.272 ms
rank =  0, finding Y'*HY took 4.376 ms
Rank 0, Project_Hamiltonian used 55.224 ms
Total time for projection: 55.238 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -0.987942539262357
    last  calculated eigval = 0.048150940939238
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98794253926236
lambda[   2] =  -0.60346630979224
lambda[   3] =  -0.56727271838508
lambda[   4] =  -0.45395142193583
lambda[   5] =  -0.42996243021394
lambda[   6] =  -0.35285412932834
lambda[   7] =  -0.33363439040804
lambda[   8] =  -0.27350255575193
lambda[   9] =  -0.22225164578697
lambda[  10] =  -0.01680496129487
lambda[  11] =   0.01160605782386
lambda[  12] =   0.01816557644374
lambda[  13] =   0.02059992595807
lambda[  14] =   0.02935703302977
lambda[  15] =   0.04815094093924
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 3.020 ms
rank =  0, Distributing orbital back into band + domain format took 11.272 ms
rank = 0, Subspace_Rotation used 14.305 ms

Total time for subspace rotation: 14.311 ms
rank = 0, Efermi =  -0.046007461284 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 1.767 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.558 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.140 ms
rank = 0, Calculating density took 1140.178 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.433 ms
rank = 0, D2D took 1.320 ms
rank = 0, Transfering density took 1.327 ms
Etot    =   -30.918241188504
Eband   =    -8.449676282052
E1      =    19.012789673086
E2      =    -7.783570124598
E3      =   -11.159453541716
Exc     =    -9.891837180373
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 3.590e-07, dEband = 2.181e-04
rank = 0, Calculating/Estimating energy took 0.838 ms, Etot = -30.918241189, dEtot = 3.590e-07, dEband = 2.181e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0332925481103, which took 0.056 ms

iter_count = 102, r_2norm = 1.217e-06, tol*||rhs|| = 1.332e-06

Anderson update took 50.753 ms, out of which F'*F took 25.719 ms; b-Ax took 161.222 ms, out of which Lap took 150.094 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 330.413 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921136, int_b + int_rho = -1.855e-13, checking this took 0.090 ms
2-norm of RHS = 629.7032093780346, which took 0.125 ms

iter_count = 42, r_2norm = 5.992e-04, tol*||rhs|| = 6.297e-04

Anderson update took 20.351 ms, out of which F'*F took 10.624 ms; b-Ax took 67.514 ms, out of which Lap took 62.693 ms
Solving Poisson took 135.769 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.115 ms
Total time for convolution: 	 convolve: 5.072438 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.732 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.072958 
Total time for convolution: 	 convolve: 5.080255 
Total time for convolution: 	 convolve: 5.072572 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.729 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.517 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.326 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.924 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.840 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.784 ms

This SCF took 26040.794 ms, scf error = 1.795e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.148151, lowerbound = -0.987943, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1058.632 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 27.352 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.230 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.434 ms
rank =  0, Distribute data + matrix mult took 31.029 ms
rank =  0, finding HY took 18.425 ms
rank =  0, distributing HY into block cyclic form took 11.257 ms
rank =  0, finding Y'*HY took 4.354 ms
Rank 0, Project_Hamiltonian used 65.096 ms
Total time for projection: 65.109 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -0.987945934760742
    last  calculated eigval = 0.048053947847321
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98794593476074
lambda[   2] =  -0.60346302950631
lambda[   3] =  -0.56726914963539
lambda[   4] =  -0.45394840804667
lambda[   5] =  -0.42995987367267
lambda[   6] =  -0.35285356765170
lambda[   7] =  -0.33362900332196
lambda[   8] =  -0.27350144104088
lambda[   9] =  -0.22224964277047
lambda[  10] =  -0.01684439103474
lambda[  11] =   0.01152201992424
lambda[  12] =   0.01809907706088
lambda[  13] =   0.02050435559040
lambda[  14] =   0.02919073843724
lambda[  15] =   0.04805394784732
==subpsace eigenproblem: bcast eigvals took 0.089 ms
Total time for solving subspace eigenvalue problem: 0.256 ms
rank =  0, subspace rotation using ScaLAPACK took 3.014 ms
rank =  0, Distributing orbital back into band + domain format took 11.288 ms
rank = 0, Subspace_Rotation used 14.316 ms

Total time for subspace rotation: 14.321 ms
rank = 0, Efermi =  -0.046046890921 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.697 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.816 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.115 ms
rank = 0, Calculating density took 1144.056 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.477 ms
rank = 0, D2D took 1.028 ms
rank = 0, Transfering density took 1.034 ms
Etot    =   -30.918240624216
Eband   =    -8.449640101137
E1      =    19.012758347715
E2      =    -7.783556461253
E3      =   -11.159499636194
Exc     =    -9.891873902762
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 8.061e-08, dEband = 5.169e-06
rank = 0, Calculating/Estimating energy took 0.855 ms, Etot = -30.918240624, dEtot = 8.061e-08, dEband = 5.169e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0301264088552, which took 0.126 ms

iter_count = 108, r_2norm = 7.261e-07, tol*||rhs|| = 1.205e-06

Anderson update took 54.040 ms, out of which F'*F took 27.003 ms; b-Ax took 170.318 ms, out of which Lap took 158.759 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 348.923 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921138, int_b + int_rho = -1.673e-13, checking this took 0.087 ms
2-norm of RHS = 629.7046933096436, which took 0.103 ms

iter_count = 72, r_2norm = 5.813e-04, tol*||rhs|| = 6.297e-04

Anderson update took 35.560 ms, out of which F'*F took 18.452 ms; b-Ax took 115.238 ms, out of which Lap took 107.644 ms
Solving Poisson took 231.266 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.075477 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 39.502 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.071001 
Total time for convolution: 	 convolve: 5.079535 
Total time for convolution: 	 convolve: 5.077436 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.526 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.190 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.728 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.843 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.593 ms

This SCF took 26060.398 ms, scf error = 1.783e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.148054, lowerbound = -0.987946, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1061.885 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.575 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.254 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.205 ms
rank =  0, Distribute data + matrix mult took 24.053 ms
rank =  0, finding HY took 18.324 ms
rank =  0, distributing HY into block cyclic form took 11.433 ms
rank =  0, finding Y'*HY took 4.244 ms
Rank 0, Project_Hamiltonian used 58.086 ms
Total time for projection: 58.100 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -0.987996879343021
    last  calculated eigval = 0.048078720634562
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98799687934302
lambda[   2] =  -0.60349652378296
lambda[   3] =  -0.56729900157673
lambda[   4] =  -0.45397924913177
lambda[   5] =  -0.42999444489591
lambda[   6] =  -0.35289235716363
lambda[   7] =  -0.33365344873828
lambda[   8] =  -0.27353652379476
lambda[   9] =  -0.22228844379010
lambda[  10] =  -0.01652285283075
lambda[  11] =   0.01155705127450
lambda[  12] =   0.01824343370430
lambda[  13] =   0.02065663138495
lambda[  14] =   0.02940064179921
lambda[  15] =   0.04807872063456
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 2.987 ms
rank =  0, Distributing orbital back into band + domain format took 11.269 ms
rank = 0, Subspace_Rotation used 14.269 ms

Total time for subspace rotation: 14.275 ms
rank = 0, Efermi =  -0.045725352751 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.769 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.506 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.118 ms
rank = 0, Calculating density took 1139.946 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.440 ms
rank = 0, D2D took 1.248 ms
rank = 0, Transfering density took 1.255 ms
Etot    =   -30.918242586005
Eband   =    -8.450273744752
E1      =    19.013193461970
E2      =    -7.783790592906
E3      =   -11.159347613852
Exc     =    -9.891759444502
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 2.803e-07, dEband = 9.052e-05
rank = 0, Calculating/Estimating energy took 0.849 ms, Etot = -30.918242586, dEtot = 2.803e-07, dEband = 9.052e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0302534896559, which took 0.152 ms

iter_count = 102, r_2norm = 1.045e-06, tol*||rhs|| = 1.210e-06

Anderson update took 50.058 ms, out of which F'*F took 25.492 ms; b-Ax took 161.044 ms, out of which Lap took 149.952 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 329.055 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921141, int_b + int_rho = -1.346e-13, checking this took 0.075 ms
2-norm of RHS = 629.7021986737655, which took 0.067 ms

iter_count = 102, r_2norm = 5.733e-04, tol*||rhs|| = 6.297e-04

Anderson update took 49.613 ms, out of which F'*F took 26.079 ms; b-Ax took 164.341 ms, out of which Lap took 152.940 ms
Solving Poisson took 326.287 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.143 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.071582 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 44.921 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.073468 
Total time for convolution: 	 convolve: 5.078310 
Total time for convolution: 	 convolve: 5.071708 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.168 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.940 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.849 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.814 ms

This SCF took 26133.484 ms, scf error = 2.101e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.148079, lowerbound = -0.987997, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1059.679 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.035 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.268 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.144 ms
rank =  0, Distribute data + matrix mult took 22.461 ms
rank =  0, finding HY took 18.382 ms
rank =  0, distributing HY into block cyclic form took 11.315 ms
rank =  0, finding Y'*HY took 4.498 ms
Rank 0, Project_Hamiltonian used 56.688 ms
Total time for projection: 56.703 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.166 ms
    first calculated eigval = -0.987832582611798
    last  calculated eigval = 0.048133787649346
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98783258261180
lambda[   2] =  -0.60336957503928
lambda[   3] =  -0.56717867334382
lambda[   4] =  -0.45385680072638
lambda[   5] =  -0.42986618693653
lambda[   6] =  -0.35275487748869
lambda[   7] =  -0.33354506626140
lambda[   8] =  -0.27340608323887
lambda[   9] =  -0.22215298370368
lambda[  10] =  -0.01649533915967
lambda[  11] =   0.01176943129802
lambda[  12] =   0.01838579671197
lambda[  13] =   0.02080409388595
lambda[  14] =   0.02911067338746
lambda[  15] =   0.04813378764935
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 2.928 ms
rank =  0, Distributing orbital back into band + domain format took 11.189 ms
rank = 0, Subspace_Rotation used 14.129 ms

Total time for subspace rotation: 14.135 ms
rank = 0, Efermi =  -0.045697839024 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 1.849 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.391 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.140 ms
rank = 0, Calculating density took 1136.203 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.440 ms
rank = 0, D2D took 1.705 ms
rank = 0, Transfering density took 1.714 ms
Etot    =   -30.918240360700
Eband   =    -8.447925659018
E1      =    19.011797823440
E2      =    -7.782750417588
E3      =   -11.159726989897
Exc     =    -9.892048867128
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 3.179e-07, dEband = 3.354e-04
rank = 0, Calculating/Estimating energy took 0.854 ms, Etot = -30.918240361, dEtot = 3.179e-07, dEband = 3.354e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0231559301942, which took 0.069 ms

iter_count = 102, r_2norm = 7.244e-07, tol*||rhs|| = 9.262e-07

Anderson update took 50.482 ms, out of which F'*F took 25.604 ms; b-Ax took 161.119 ms, out of which Lap took 150.201 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 330.238 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921141, int_b + int_rho = -1.346e-13, checking this took 0.088 ms
2-norm of RHS = 629.7028402422002, which took 0.105 ms

iter_count = 132, r_2norm = 5.610e-04, tol*||rhs|| = 6.297e-04

Anderson update took 64.469 ms, out of which F'*F took 33.361 ms; b-Ax took 212.168 ms, out of which Lap took 197.699 ms
Solving Poisson took 420.858 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.073636 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.650 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.075421 
Total time for convolution: 	 convolve: 5.079926 
Total time for convolution: 	 convolve: 5.074758 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.161 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.497 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.921 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.853 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.795 ms

This SCF took 26171.178 ms, scf error = 1.524e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.148134, lowerbound = -0.987833, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1041.791 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.910 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.211 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.371 ms
rank =  0, Distribute data + matrix mult took 26.506 ms
rank =  0, finding HY took 18.340 ms
rank =  0, distributing HY into block cyclic form took 11.394 ms
rank =  0, finding Y'*HY took 4.178 ms
Rank 0, Project_Hamiltonian used 60.452 ms
Total time for projection: 60.470 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -0.987662913867266
    last  calculated eigval = 0.048659347498070
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98766291386727
lambda[   2] =  -0.60322374573618
lambda[   3] =  -0.56703671820305
lambda[   4] =  -0.45371189063641
lambda[   5] =  -0.42972246665600
lambda[   6] =  -0.35260030680594
lambda[   7] =  -0.33340845569434
lambda[   8] =  -0.27325943158406
lambda[   9] =  -0.22200181952236
lambda[  10] =  -0.01525409997057
lambda[  11] =   0.01218973020021
lambda[  12] =   0.01903890389638
lambda[  13] =   0.02169169795025
lambda[  14] =   0.03024832318740
lambda[  15] =   0.04865934749807
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 3.023 ms
rank =  0, Distributing orbital back into band + domain format took 11.268 ms
rank = 0, Subspace_Rotation used 14.304 ms

Total time for subspace rotation: 14.309 ms
rank = 0, Efermi =  -0.044456599872 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.756 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.702 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.122 ms
rank = 0, Calculating density took 1122.439 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.469 ms
rank = 0, D2D took 1.087 ms
rank = 0, Transfering density took 1.094 ms
Etot    =   -30.918244695635
Eband   =    -8.445255497704
E1      =    19.010415062910
E2      =    -7.781401896960
E3      =   -11.159984327775
Exc     =    -9.892249420096
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 6.193e-07, dEband = 3.815e-04
rank = 0, Calculating/Estimating energy took 1.238 ms, Etot = -30.918244696, dEtot = 6.193e-07, dEband = 3.815e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0145103788958, which took 0.065 ms

iter_count = 108, r_2norm = 4.007e-07, tol*||rhs|| = 5.804e-07

Anderson update took 53.135 ms, out of which F'*F took 27.184 ms; b-Ax took 170.490 ms, out of which Lap took 158.960 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 348.013 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921140, int_b + int_rho = -1.455e-13, checking this took 0.092 ms
2-norm of RHS = 629.7002814864776, which took 0.119 ms

iter_count = 78, r_2norm = 5.751e-04, tol*||rhs|| = 6.297e-04

Anderson update took 38.075 ms, out of which F'*F took 20.112 ms; b-Ax took 125.610 ms, out of which Lap took 117.160 ms
Solving Poisson took 250.174 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.085491 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 67.579 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.142074 
Total time for convolution: 	 convolve: 5.085666 
Total time for convolution: 	 convolve: 5.077429 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.766 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.515 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.171 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.059 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.916 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.844 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.780 ms

This SCF took 26172.571 ms, scf error = 1.244e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.148659, lowerbound = -0.987663, upperbound = 267.581642

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1067.549 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.547 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.249 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.300 ms
rank =  0, Distribute data + matrix mult took 23.111 ms
rank =  0, finding HY took 18.321 ms
rank =  0, distributing HY into block cyclic form took 11.463 ms
rank =  0, finding Y'*HY took 4.218 ms
Rank 0, Project_Hamiltonian used 57.144 ms
Total time for projection: 57.155 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -0.987551696489774
    last  calculated eigval = 0.048302742229586
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98755169648977
lambda[   2] =  -0.60314575533048
lambda[   3] =  -0.56696785639448
lambda[   4] =  -0.45364096504447
lambda[   5] =  -0.42964257726112
lambda[   6] =  -0.35251087233660
lambda[   7] =  -0.33335075783275
lambda[   8] =  -0.27317832746820
lambda[   9] =  -0.22191151847515
lambda[  10] =  -0.01595082481425
lambda[  11] =   0.01196782448664
lambda[  12] =   0.01861950352476
lambda[  13] =   0.02115351784939
lambda[  14] =   0.02940643970518
lambda[  15] =   0.04830274222959
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.174 ms
rank =  0, subspace rotation using ScaLAPACK took 2.989 ms
rank =  0, Distributing orbital back into band + domain format took 11.271 ms
rank = 0, Subspace_Rotation used 14.272 ms

Total time for subspace rotation: 14.278 ms
rank = 0, Efermi =  -0.045153324764 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.765 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.662 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.118 ms
rank = 0, Calculating density took 1144.827 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.724 ms
rank = 0, D2D took 1.834 ms
rank = 0, Transfering density took 1.841 ms
Etot    =   -30.918243673222
Eband   =    -8.443800653572
E1      =    19.009455333490
E2      =    -7.780836635435
E3      =   -11.160291102021
Exc     =    -9.892485025117
Esc     =   -50.532541064902
Entropy =    -0.000000000578
dE = 1.461e-07, dEband = 2.078e-04
rank = 0, Calculating/Estimating energy took 0.837 ms, Etot = -30.918243673, dEtot = 1.461e-07, dEband = 2.078e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0125633420258, which took 0.057 ms

iter_count = 102, r_2norm = 4.838e-07, tol*||rhs|| = 5.025e-07

Anderson update took 49.999 ms, out of which F'*F took 25.584 ms; b-Ax took 161.109 ms, out of which Lap took 150.158 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 329.138 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001921154, int_rho =  18.00000001921136, int_b + int_rho = -1.892e-13, checking this took 0.092 ms
2-norm of RHS = 629.7004073163987, which took 0.111 ms

iter_count = 72, r_2norm = 6.026e-04, tol*||rhs|| = 6.297e-04

Anderson update took 34.397 ms, out of which F'*F took 18.293 ms; b-Ax took 115.874 ms, out of which Lap took 107.869 ms
Solving Poisson took 230.537 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.077803 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.283 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.076409 
Total time for convolution: 	 convolve: 5.078639 
Total time for convolution: 	 convolve: 5.076817 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.734 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.524 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.843 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 0.953 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.856 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.829 ms

This SCF took 26014.313 ms, scf error = 5.653e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.98755169648977, occ[   1] =   2.00000000000000
lambda[   2] =  -0.60314575533048, occ[   2] =   2.00000000000000
lambda[   3] =  -0.56696785639448, occ[   3] =   2.00000000000000
lambda[   4] =  -0.45364096504447, occ[   4] =   2.00000000000000
lambda[   5] =  -0.42964257726112, occ[   5] =   2.00000000000000
lambda[   6] =  -0.35251087233660, occ[   6] =   2.00000000000000
lambda[   7] =  -0.33335075783275, occ[   7] =   2.00000000000000
lambda[   8] =  -0.27317832746820, occ[   8] =   2.00000000000000
lambda[   9] =  -0.22191151847515, occ[   9] =   2.00000000000000
lambda[  10] =  -0.01595082481425, occ[  10] =   0.00000001921138
lambda[  11] =   0.01196782448664, occ[  11] =   0.00000000000000
lambda[  12] =   0.01861950352476, occ[  12] =   0.00000000000000
lambda[  13] =   0.02115351784939, occ[  13] =   0.00000000000000
lambda[  14] =   0.02940643970518, occ[  14] =   0.00000000000000
lambda[  15] =   0.04830274222959, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.507 ms, time for Allreduce/Reduce: 6.796 ms 
Time for calculating local force components: 15.562 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000047061329  -0.00000039007445  -1.19784276607000
 -0.04324824732728  -0.02572767253138   0.01062014655156
  0.04324825590124  -0.02572769596568   0.01062018446543
  0.04324822338824   0.02572763797254   0.01062018782084
 -0.04324823870792   0.02572762607959   0.01062016788367
  0.00000044726672  -0.15972449123737   0.18069935243516
 -0.00000028993816   0.15972340063402   0.18069853623599
force_loc = 
  0.00000233774889   0.00000014125092   1.17185726757520
  0.04507895617747   0.02613899398740  -0.01067875312156
 -0.04507932216462   0.02613930782403  -0.01067942482326
 -0.04507844221142  -0.02613859801170  -0.01067936874046
  0.04507890806055  -0.02613877523036  -0.01067924314300
  0.00000239639116   0.15948422728560  -0.17970866072390
  0.00000109642690  -0.15948181983036  -0.17971087223421
Time for calculating nonlocal force components: 24.507 ms
[32mforces_xc: 
[0m[32m  0.00000009193093   0.00000002538231   0.03726040864063
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000011209158   0.00397439238687  -0.00645340670651
[0m[32m  0.00000002587136  -0.00397428041204  -0.00645351239165
[0mTime for calculating XC forces components: 19.340 ms
 Cartesian force = 
  0.00000112473905  -0.00000051337122   0.01125916105241
  0.00182987452271   0.00041103152603  -0.00007435566341
 -0.00183190059085   0.00041132192837  -0.00007498945124
 -0.00183105315066  -0.00041124996915  -0.00007493001304
  0.00182983502515  -0.00041143908076  -0.00007482435275
  0.00000212142198   0.00373383850510  -0.00547846408868
 -0.00000000196738  -0.00373298953837  -0.00548159748329
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Time for printing density: 378.703 ms
The program took 638.074 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:57
Job ID:        2266595
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:10:36,vmem=8424K,walltime=00:10:53,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-26-1
---------------------------------------
