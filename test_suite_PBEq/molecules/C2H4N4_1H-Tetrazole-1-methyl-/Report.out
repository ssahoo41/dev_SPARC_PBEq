---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:43
Job ID:    2266788
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:46
Job ID:    2266788
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 10.881 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 33.053 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 83.291 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.939 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.110 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    7.026669	    9.306471	   10.000000	
    9.326511	   13.678559	   10.000000	
   12.205960	   13.464377	   11.668844	
   12.205960	   13.464377	    8.331156	
    8.935300	    8.649425	   10.000000	
   11.196811	   12.861241	   10.000000	
   10.957732	   10.137456	   10.000000	
   12.973331	    8.651957	   10.000000	
   12.194858	    6.411254	   10.000000	
    9.671571	    6.321441	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.192 ms
Set up communicators.

--set up spincomm took 2.348 ms

--set up kptcomm took 0.351 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 24, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 24 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 24, mbQ = nbQ = 64
rank = 0, nr_Hp = 24, nc_Hp = 24
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.080 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.397 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.601 ms

Calculate_SplineDerivRadFun took 0.185 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.811 ms.
time spent on vectorized spline interp: 2.881 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.605 ms.
time spent on vectorized spline interp: 1.709 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.517 ms.
time spent on vectorized spline interp: 1.666 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.648 ms.

Calculating rb for all atom types took 15.848 ms
----------------------
Estimated memory usage
Total: 1.41 GB
orbitals             : 1.07 GB
global sized vectors : 213.62 MB
subspace matrices : 13.50 kB
others : 131.23 MB
----------------------------------------------
Estimated memory usage per processor: 120.29 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.019 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -32.0000000320114, sum_int_rho = 31.5883889945315
PosCharge = 32.000000032011, NegCharge = -31.588388994531, scal_fac = 1.013030453612
After scaling, int_rho = 32.0000000320116, PosCharge + NegCharge - NetCharge = -1.847e-13
--Calculate Vref took 0.638 ms
--Calculate rho_guess took 3.564 ms

 integral of b = -32.0000000320114,
 int{b} + Nelectron + NetCharge = -3.201e-08,
 Esc = -92.7929197810859,
 MPI_Reduce took 14.240 ms

Calculating b & b_ref took 26.625 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.082 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.094 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.080 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.670 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 46.194 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201165, int_b + int_rho = 1.928e-13, checking this took 0.089 ms
2-norm of RHS = 787.4526876980365, which took 0.503 ms

iter_count = 420, r_2norm = 7.331e-04, tol*||rhs|| = 7.875e-04

Anderson update took 238.152 ms, out of which F'*F took 105.238 ms; b-Ax took 724.334 ms, out of which Lap took 638.899 ms
Solving Poisson took 1528.359 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.816 ms
Total time for convolution: 	 convolve: 5.151620 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.228 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.816 ms
Total time for convolution: 	 convolve: 5.142020 
Total time for convolution: 	 convolve: 5.186402 
Total time for convolution: 	 convolve: 5.170160 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.760 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.392 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
rank = 0, XC calculation took 24613.682 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 5.008 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.315 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.469 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.148 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.691 ms
    Lanczos iter 53, eigmin  = -1.105280091, eigmax = 264.937800370, err_eigmin = 9.808e-04, err_eigmax = 9.608e-03
rank =   0, Lanczos took 128.328 ms, eigmin = -1.105280091090, eigmax = 267.587178374062

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.190949, lowerbound = -1.205280, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1631.203 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 22.293 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.941 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.255 ms
rank =  0, finding HY took 27.565 ms
rank =  0, distributing HY into block cyclic form took 21.916 ms
rank =  0, finding Y'*HY took 6.679 ms
Rank 0, Project_Hamiltonian used 82.454 ms
Total time for projection: 82.485 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.374 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.465 ms
    first calculated eigval = 2.694567970512113
    last  calculated eigval = 3.283473156327220
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =   2.86971074154782
lambda[   8] =   2.87110400216116
lambda[   9] =   2.88665836679552
lambda[  10] =   2.95281332115948
lambda[  11] =   2.97762808476671
lambda[  12] =   2.98617695892995
lambda[  13] =   3.00411294920236
lambda[  14] =   3.01415136895380
lambda[  15] =   3.03494858992672
lambda[  16] =   3.05133050794294
lambda[  17] =   3.07701897963232
lambda[  18] =   3.11512187323075
lambda[  19] =   3.13155749745109
lambda[  20] =   3.14309138076340
lambda[  21] =   3.16730402592761
lambda[  22] =   3.17222999535310
lambda[  23] =   3.23718462894431
lambda[  24] =   3.28347315632722
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.489 ms
rank =  0, subspace rotation using ScaLAPACK took 8.859 ms
rank =  0, Distributing orbital back into band + domain format took 21.016 ms
rank = 0, Subspace_Rotation used 29.895 ms

Total time for subspace rotation: 29.899 ms
rank = 0, Efermi =   3.064174747290 calculate fermi energy took 0.050 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.383473, lowerbound = -1.205280, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1607.166 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 20.582 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 5.163 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.762 ms
rank =  0, finding HY took 27.265 ms
rank =  0, distributing HY into block cyclic form took 20.499 ms
rank =  0, finding Y'*HY took 5.739 ms
Rank 0, Project_Hamiltonian used 79.303 ms
Total time for projection: 79.307 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.158 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.262 ms
    first calculated eigval = -0.964158316060263
    last  calculated eigval = 0.438141933336848
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.21493212158799
lambda[   8] =  -0.18348841263721
lambda[   9] =  -0.11026024471784
lambda[  10] =  -0.06003817048106
lambda[  11] =  -0.03201566020349
lambda[  12] =   0.06517020725951
lambda[  13] =   0.12693639716430
lambda[  14] =   0.16222551587364
lambda[  15] =   0.20074097115160
lambda[  16] =   0.27729734115968
lambda[  17] =   0.29489829611836
lambda[  18] =   0.32001396707561
lambda[  19] =   0.32249571973692
lambda[  20] =   0.34297070749424
lambda[  21] =   0.37214077952886
lambda[  22] =   0.39349510079336
lambda[  23] =   0.40279290337879
lambda[  24] =   0.43814193333685
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.271 ms
rank =  0, subspace rotation using ScaLAPACK took 8.795 ms
rank =  0, Distributing orbital back into band + domain format took 21.068 ms
rank = 0, Subspace_Rotation used 29.879 ms

Total time for subspace rotation: 29.883 ms
rank = 0, Efermi =   0.286097819075 calculate fermi energy took 0.026 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.538142, lowerbound = -1.205280, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1702.915 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 32.254 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.802 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 36.078 ms
rank =  0, finding HY took 27.615 ms
rank =  0, distributing HY into block cyclic form took 20.499 ms
rank =  0, finding Y'*HY took 5.708 ms
Rank 0, Project_Hamiltonian used 89.947 ms
Total time for projection: 89.951 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.149 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.243 ms
    first calculated eigval = -1.114099436639247
    last  calculated eigval = 0.155579436894853
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.57977707489055
lambda[   8] =  -0.53381684242692
lambda[   9] =  -0.50999836278608
lambda[  10] =  -0.49611928566936
lambda[  11] =  -0.46969381225185
lambda[  12] =  -0.37744583554670
lambda[  13] =  -0.31924503244425
lambda[  14] =  -0.30813236902873
lambda[  15] =  -0.29352767765443
lambda[  16] =  -0.27692890405289
lambda[  17] =  -0.01368487061843
lambda[  18] =   0.00531064747490
lambda[  19] =   0.06164911732291
lambda[  20] =   0.08007312210229
lambda[  21] =   0.09118286240763
lambda[  22] =   0.10282354948717
lambda[  23] =   0.12827088697735
lambda[  24] =   0.15557943689485
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 8.698 ms
rank =  0, Distributing orbital back into band + domain format took 21.263 ms
rank = 0, Subspace_Rotation used 29.977 ms

Total time for subspace rotation: 29.981 ms
rank = 0, Efermi =  -0.042425375224 calculate fermi energy took 0.030 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.255579, lowerbound = -1.205280, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1600.949 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 20.527 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.662 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.213 ms
rank =  0, finding HY took 27.735 ms
rank =  0, distributing HY into block cyclic form took 20.451 ms
rank =  0, finding Y'*HY took 5.643 ms
Rank 0, Project_Hamiltonian used 78.069 ms
Total time for projection: 78.072 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.153 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.258 ms
    first calculated eigval = -1.114328342235004
    last  calculated eigval = 0.084083970333792
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.58325287594559
lambda[   8] =  -0.54034758115965
lambda[   9] =  -0.51958762281233
lambda[  10] =  -0.50178167637415
lambda[  11] =  -0.47201115757658
lambda[  12] =  -0.39543692903715
lambda[  13] =  -0.32932390670562
lambda[  14] =  -0.32436277686040
lambda[  15] =  -0.31984699442622
lambda[  16] =  -0.31100563084991
lambda[  17] =  -0.07626772296338
lambda[  18] =  -0.04974115205678
lambda[  19] =   0.00475817912858
lambda[  20] =   0.03224204449685
lambda[  21] =   0.04558168430481
lambda[  22] =   0.05190058196640
lambda[  23] =   0.06959519184847
lambda[  24] =   0.08408397033379
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.265 ms
rank =  0, subspace rotation using ScaLAPACK took 8.744 ms
rank =  0, Distributing orbital back into band + domain format took 21.471 ms
rank = 0, Subspace_Rotation used 30.250 ms

Total time for subspace rotation: 30.254 ms
rank = 0, Efermi =  -0.105008227712 calculate fermi energy took 0.029 ms
rank = 0, --- Calculate rho: sum over local bands took 5.080 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.090 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.633 ms
rank = 0, Calculating density took 7142.952 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.857 ms
rank = 0, D2D took 1.958 ms
rank = 0, Transfering density took 1.964 ms
Etot    =   -55.962445518252
Eband   =   -18.729268596376
E1      =    37.831417845710
E2      =   -15.758824133844
E3      =   -19.291648098149
Exc     =   -17.322147217545
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 5.596e+00, dEband = 1.873e+00
rank = 0, Calculating/Estimating energy took 0.931 ms, Etot = -55.962445518, dEtot = 5.596e+00, dEband = 1.873e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 63.1090842425236, which took 0.146 ms

iter_count = 96, r_2norm = 1.539e-03, tol*||rhs|| = 2.524e-03

Anderson update took 57.874 ms, out of which F'*F took 23.888 ms; b-Ax took 165.927 ms, out of which Lap took 148.474 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 357.206 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201148, int_b + int_rho = 2.547e-14, checking this took 0.106 ms
2-norm of RHS = 783.1059247577751, which took 0.132 ms

iter_count = 276, r_2norm = 7.114e-04, tol*||rhs|| = 7.831e-04

Anderson update took 154.389 ms, out of which F'*F took 71.567 ms; b-Ax took 475.802 ms, out of which Lap took 426.497 ms
Solving Poisson took 1005.531 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.398 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.213011 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1104.267 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.204104 
Total time for convolution: 	 convolve: 5.195946 
Total time for convolution: 	 convolve: 5.276850 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.378 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.629 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.881 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.543 ms

This SCF took 34561.992 ms, scf error = 1.630e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.184084, lowerbound = -1.114328, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1596.346 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 20.488 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.835 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.342 ms
rank =  0, finding HY took 27.471 ms
rank =  0, distributing HY into block cyclic form took 23.290 ms
rank =  0, finding Y'*HY took 4.930 ms
Rank 0, Project_Hamiltonian used 80.070 ms
Total time for projection: 80.083 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.141 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.236 ms
    first calculated eigval = -1.105149697492455
    last  calculated eigval = 0.051899043801020
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.55900887573717
lambda[   8] =  -0.51667955059285
lambda[   9] =  -0.49444515357443
lambda[  10] =  -0.47183066591106
lambda[  11] =  -0.45405540574400
lambda[  12] =  -0.37496798468866
lambda[  13] =  -0.31506379836149
lambda[  14] =  -0.30817751186067
lambda[  15] =  -0.30014811566273
lambda[  16] =  -0.28824343733799
lambda[  17] =  -0.07499016098902
lambda[  18] =  -0.04489457965348
lambda[  19] =  -0.02259751085789
lambda[  20] =   0.01811800602405
lambda[  21] =   0.02194577986408
lambda[  22] =   0.03208037512350
lambda[  23] =   0.04437904885081
lambda[  24] =   0.05189904380102
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.248 ms
rank =  0, subspace rotation using ScaLAPACK took 8.552 ms
rank =  0, Distributing orbital back into band + domain format took 21.779 ms
rank = 0, Subspace_Rotation used 30.356 ms

Total time for subspace rotation: 30.362 ms
rank = 0, Efermi =  -0.103730665606 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 5.523 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.353 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.612 ms
rank = 0, Calculating density took 1724.700 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.858 ms
rank = 0, D2D took 1.959 ms
rank = 0, Transfering density took 1.966 ms
Etot    =   -55.898066619435
Eband   =   -18.072399959961
E1      =    37.210431586385
E2      =   -15.748556737804
E3      =   -19.492900255169
Exc     =   -17.484635456798
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 6.438e-03, dEband = 6.569e-02
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -55.898066619, dEtot = 6.438e-03, dEband = 6.569e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 17.4218165946371, which took 0.105 ms

iter_count = 102, r_2norm = 5.257e-04, tol*||rhs|| = 6.969e-04

Anderson update took 53.972 ms, out of which F'*F took 25.660 ms; b-Ax took 174.079 ms, out of which Lap took 155.239 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.487 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201156, int_b + int_rho = 1.019e-13, checking this took 0.097 ms
2-norm of RHS = 776.7922172410499, which took 0.149 ms

iter_count = 294, r_2norm = 7.085e-04, tol*||rhs|| = 7.768e-04

Anderson update took 157.305 ms, out of which F'*F took 73.649 ms; b-Ax took 504.544 ms, out of which Lap took 449.868 ms
Solving Poisson took 1061.789 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.232358 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.230826 
Total time for convolution: 	 convolve: 5.208247 
Total time for convolution: 	 convolve: 5.269496 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.608 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.134 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.781 ms

This SCF took 28184.942 ms, scf error = 1.109e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.151899, lowerbound = -1.105150, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1604.111 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.526 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.324 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.867 ms
rank =  0, finding HY took 63.316 ms
rank =  0, distributing HY into block cyclic form took 19.778 ms
rank =  0, finding Y'*HY took 6.604 ms
Rank 0, Project_Hamiltonian used 114.604 ms
Total time for projection: 114.618 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.146 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.234 ms
    first calculated eigval = -1.085129310080530
    last  calculated eigval = 0.047794253472119
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.51143363120963
lambda[   8] =  -0.48305239439651
lambda[   9] =  -0.45023737003741
lambda[  10] =  -0.41328979473329
lambda[  11] =  -0.41201002181938
lambda[  12] =  -0.33700329009472
lambda[  13] =  -0.28966880217625
lambda[  14] =  -0.28163688648515
lambda[  15] =  -0.25876225448064
lambda[  16] =  -0.24179457655283
lambda[  17] =  -0.05322690529404
lambda[  18] =  -0.02853408091799
lambda[  19] =  -0.01826842716298
lambda[  20] =   0.01348223920464
lambda[  21] =   0.01921145822087
lambda[  22] =   0.02863565454319
lambda[  23] =   0.03438691121986
lambda[  24] =   0.04779425347212
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.266 ms
rank =  0, subspace rotation using ScaLAPACK took 8.545 ms
rank =  0, Distributing orbital back into band + domain format took 21.002 ms
rank = 0, Subspace_Rotation used 29.563 ms

Total time for subspace rotation: 29.568 ms
rank = 0, Efermi =  -0.081967410087 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.031 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.144 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.599 ms
rank = 0, Calculating density took 1766.466 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.812 ms
rank = 0, D2D took 1.915 ms
rank = 0, Transfering density took 1.917 ms
Etot    =   -55.844272241162
Eband   =   -16.833214973299
E1      =    36.091004116023
E2      =   -15.598598345756
E3      =   -19.920449807431
Exc     =   -17.828189755039
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 5.379e-03, dEband = 1.239e-01
rank = 0, Calculating/Estimating energy took 0.940 ms, Etot = -55.844272241, dEtot = 5.379e-03, dEband = 1.239e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.8417777435607, which took 0.113 ms

iter_count = 102, r_2norm = 2.139e-04, tol*||rhs|| = 2.337e-04

Anderson update took 54.470 ms, out of which F'*F took 25.301 ms; b-Ax took 171.283 ms, out of which Lap took 153.431 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.173 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201166, int_b + int_rho = 2.037e-13, checking this took 0.110 ms
2-norm of RHS = 777.4102376517246, which took 0.113 ms

iter_count = 264, r_2norm = 7.388e-04, tol*||rhs|| = 7.774e-04

Anderson update took 141.674 ms, out of which F'*F took 66.640 ms; b-Ax took 447.989 ms, out of which Lap took 400.463 ms
Solving Poisson took 952.342 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.181806 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 65.505 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.280420 
Total time for convolution: 	 convolve: 5.165541 
Total time for convolution: 	 convolve: 5.210154 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.427 ms
---Transfer Veff_loc: D2D took 3.595 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.028 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.658 ms

This SCF took 28062.522 ms, scf error = 3.107e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.147794, lowerbound = -1.085129, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1608.358 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 34.056 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.810 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 37.883 ms
rank =  0, finding HY took 27.622 ms
rank =  0, distributing HY into block cyclic form took 20.357 ms
rank =  0, finding Y'*HY took 5.793 ms
Rank 0, Project_Hamiltonian used 91.709 ms
Total time for projection: 91.725 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.147 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.104 ms
rank = 0, Solve_Generalized_EigenProblem used 0.254 ms
    first calculated eigval = -1.077989828710278
    last  calculated eigval = 0.039439628846252
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.50286140821934
lambda[   8] =  -0.47636834954309
lambda[   9] =  -0.44357602011659
lambda[  10] =  -0.40504329864127
lambda[  11] =  -0.40435242418152
lambda[  12] =  -0.32964149552300
lambda[  13] =  -0.28313234892989
lambda[  14] =  -0.27889209219391
lambda[  15] =  -0.25303581202543
lambda[  16] =  -0.23630012653476
lambda[  17] =  -0.04679741072882
lambda[  18] =  -0.02983110140162
lambda[  19] =  -0.01705266771613
lambda[  20] =   0.01033216843958
lambda[  21] =   0.01708255932158
lambda[  22] =   0.02502905186106
lambda[  23] =   0.03253530883906
lambda[  24] =   0.03943962884625
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.267 ms
rank =  0, subspace rotation using ScaLAPACK took 8.641 ms
rank =  0, Distributing orbital back into band + domain format took 20.877 ms
rank = 0, Subspace_Rotation used 29.535 ms

Total time for subspace rotation: 29.541 ms
rank = 0, Efermi =  -0.075537915502 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.075 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.104 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.559 ms
rank = 0, Calculating density took 1748.763 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.034 ms
rank = 0, D2D took 2.144 ms
rank = 0, Transfering density took 2.151 ms
Etot    =   -55.840598900208
Eband   =   -16.621966527453
E1      =    35.964148460770
E2      =   -15.498857153992
E3      =   -19.997177920325
Exc     =   -17.885896125809
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 3.673e-04, dEband = 2.112e-02
rank = 0, Calculating/Estimating energy took 0.982 ms, Etot = -55.840598900, dEtot = 3.673e-04, dEband = 2.112e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.0327015302897, which took 4.853 ms

iter_count = 108, r_2norm = 8.873e-05, tol*||rhs|| = 1.213e-04

Anderson update took 58.423 ms, out of which F'*F took 27.668 ms; b-Ax took 190.109 ms, out of which Lap took 170.271 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 410.030 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201155, int_b + int_rho = 9.823e-14, checking this took 0.122 ms
2-norm of RHS = 777.8903380708612, which took 0.078 ms

iter_count = 246, r_2norm = 6.442e-04, tol*||rhs|| = 7.779e-04

Anderson update took 130.932 ms, out of which F'*F took 61.924 ms; b-Ax took 418.269 ms, out of which Lap took 375.216 ms
Solving Poisson took 882.200 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.234079 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.276866 
Total time for convolution: 	 convolve: 5.280982 
Total time for convolution: 	 convolve: 5.312716 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.580 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.508 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.129 ms

This SCF took 28215.473 ms, scf error = 1.123e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.139440, lowerbound = -1.077990, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1607.567 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.509 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.886 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.415 ms
rank =  0, finding HY took 27.296 ms
rank =  0, distributing HY into block cyclic form took 20.166 ms
rank =  0, finding Y'*HY took 7.034 ms
Rank 0, Project_Hamiltonian used 78.946 ms
Total time for projection: 78.960 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.148 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.220 ms
rank = 0, Solve_Generalized_EigenProblem used 0.371 ms
    first calculated eigval = -1.075974164653896
    last  calculated eigval = 0.035583004929913
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.50020568370093
lambda[   8] =  -0.47460884054176
lambda[   9] =  -0.44110240846701
lambda[  10] =  -0.40177434750406
lambda[  11] =  -0.40055157534615
lambda[  12] =  -0.32693038380472
lambda[  13] =  -0.28119193733874
lambda[  14] =  -0.27715641320061
lambda[  15] =  -0.25009858265318
lambda[  16] =  -0.23298975685245
lambda[  17] =  -0.04548908231402
lambda[  18] =  -0.03026631349264
lambda[  19] =  -0.01532255671182
lambda[  20] =   0.00859474927281
lambda[  21] =   0.01552211686016
lambda[  22] =   0.02337551900777
lambda[  23] =   0.02904292807367
lambda[  24] =   0.03558300492991
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.385 ms
rank =  0, subspace rotation using ScaLAPACK took 8.677 ms
rank =  0, Distributing orbital back into band + domain format took 20.825 ms
rank = 0, Subspace_Rotation used 29.518 ms

Total time for subspace rotation: 29.523 ms
rank = 0, Efermi =  -0.074229586876 calculate fermi energy took 1.576 ms
rank = 0, --- Calculate rho: sum over local bands took 5.684 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.795 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.592 ms
rank = 0, Calculating density took 1735.160 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.812 ms
rank = 0, D2D took 1.912 ms
rank = 0, Transfering density took 1.918 ms
Etot    =   -55.839770630501
Eband   =   -16.540455660996
E1      =    35.924550888006
E2      =   -15.450596409511
E3      =   -20.023459684556
Exc     =   -17.905002169544
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 8.283e-05, dEband = 8.151e-03
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -55.839770631, dEtot = 8.283e-05, dEband = 8.151e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9083695611821, which took 0.074 ms

iter_count = 114, r_2norm = 2.641e-05, tol*||rhs|| = 3.633e-05

Anderson update took 61.169 ms, out of which F'*F took 28.617 ms; b-Ax took 199.199 ms, out of which Lap took 178.406 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 424.647 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201161, int_b + int_rho = 1.528e-13, checking this took 0.127 ms
2-norm of RHS = 778.4688947337530, which took 0.139 ms

iter_count = 240, r_2norm = 7.467e-04, tol*||rhs|| = 7.785e-04

Anderson update took 128.356 ms, out of which F'*F took 59.821 ms; b-Ax took 409.889 ms, out of which Lap took 363.965 ms
Solving Poisson took 876.124 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.196016 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.170778 
Total time for convolution: 	 convolve: 5.205444 
Total time for convolution: 	 convolve: 5.168252 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.188 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.603 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.661 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.309 ms

This SCF took 27868.764 ms, scf error = 6.244e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.135583, lowerbound = -1.075974, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1601.865 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 20.553 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.744 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.314 ms
rank =  0, finding HY took 27.508 ms
rank =  0, distributing HY into block cyclic form took 20.475 ms
rank =  0, finding Y'*HY took 5.715 ms
Rank 0, Project_Hamiltonian used 78.048 ms
Total time for projection: 78.134 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.151 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.252 ms
    first calculated eigval = -1.074262354185559
    last  calculated eigval = 0.034678447664658
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.49835514500024
lambda[   8] =  -0.47320327459177
lambda[   9] =  -0.43947860796339
lambda[  10] =  -0.39927796351891
lambda[  11] =  -0.39780820476814
lambda[  12] =  -0.32488309804700
lambda[  13] =  -0.27968318892304
lambda[  14] =  -0.27564049054263
lambda[  15] =  -0.24787093474643
lambda[  16] =  -0.23040576198138
lambda[  17] =  -0.04448511745017
lambda[  18] =  -0.03037523089339
lambda[  19] =  -0.01389244823060
lambda[  20] =   0.00784867321781
lambda[  21] =   0.01475759377487
lambda[  22] =   0.02277227359567
lambda[  23] =   0.02653925726587
lambda[  24] =   0.03467844766466
==subpsace eigenproblem: bcast eigvals took 0.067 ms
Total time for solving subspace eigenvalue problem: 0.326 ms
rank =  0, subspace rotation using ScaLAPACK took 8.646 ms
rank =  0, Distributing orbital back into band + domain format took 20.771 ms
rank = 0, Subspace_Rotation used 29.434 ms

Total time for subspace rotation: 29.439 ms
rank = 0, Efermi =  -0.073225622175 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 5.261 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.968 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.570 ms
rank = 0, Calculating density took 1727.695 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.817 ms
rank = 0, D2D took 1.918 ms
rank = 0, Transfering density took 1.921 ms
Etot    =   -55.839323164075
Eband   =   -16.478436656098
E1      =    35.905142840109
E2      =   -15.403720364803
E3      =   -20.037515232554
Exc     =   -17.914345163409
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 4.475e-05, dEband = 6.202e-03
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -55.839323164, dEtot = 4.475e-05, dEband = 6.202e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4785136376159, which took 0.097 ms

iter_count = 114, r_2norm = 1.233e-05, tol*||rhs|| = 1.914e-05

Anderson update took 59.986 ms, out of which F'*F took 27.946 ms; b-Ax took 192.411 ms, out of which Lap took 170.726 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.747 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201169, int_b + int_rho = 2.365e-13, checking this took 1.030 ms
2-norm of RHS = 778.7431713027715, which took 0.132 ms

iter_count = 240, r_2norm = 7.315e-04, tol*||rhs|| = 7.787e-04

Anderson update took 128.001 ms, out of which F'*F took 61.793 ms; b-Ax took 402.051 ms, out of which Lap took 361.569 ms
Solving Poisson took 869.064 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.296913 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.238232 
Total time for convolution: 	 convolve: 5.288636 
Total time for convolution: 	 convolve: 5.209397 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.630 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.572 ms
---Transfer Veff_loc: D2D took 3.528 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.053 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.616 ms

This SCF took 28145.691 ms, scf error = 3.274e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.134678, lowerbound = -1.074262, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1611.740 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.556 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.873 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.450 ms
rank =  0, finding HY took 27.321 ms
rank =  0, distributing HY into block cyclic form took 20.484 ms
rank =  0, finding Y'*HY took 5.679 ms
Rank 0, Project_Hamiltonian used 77.967 ms
Total time for projection: 77.981 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.151 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.247 ms
    first calculated eigval = -1.071747608844013
    last  calculated eigval = 0.034690437683622
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.49566072744831
lambda[   8] =  -0.47084544133478
lambda[   9] =  -0.43737653294644
lambda[  10] =  -0.39654031229941
lambda[  11] =  -0.39486616044631
lambda[  12] =  -0.32214670358535
lambda[  13] =  -0.27729970885398
lambda[  14] =  -0.27353463658337
lambda[  15] =  -0.24513721292807
lambda[  16] =  -0.22739551978759
lambda[  17] =  -0.04245474389910
lambda[  18] =  -0.03015997508810
lambda[  19] =  -0.01225289755713
lambda[  20] =   0.00800619611143
lambda[  21] =   0.01500438375793
lambda[  22] =   0.02291229081317
lambda[  23] =   0.02547714734466
lambda[  24] =   0.03469043768362
==subpsace eigenproblem: bcast eigvals took 0.049 ms
Total time for solving subspace eigenvalue problem: 0.303 ms
rank =  0, subspace rotation using ScaLAPACK took 8.568 ms
rank =  0, Distributing orbital back into band + domain format took 20.956 ms
rank = 0, Subspace_Rotation used 29.539 ms

Total time for subspace rotation: 29.544 ms
rank = 0, Efermi =  -0.071195248687 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.293 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.887 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.600 ms
rank = 0, Calculating density took 1737.473 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.824 ms
rank = 0, D2D took 1.923 ms
rank = 0, Transfering density took 1.925 ms
Etot    =   -55.839130773971
Eband   =   -16.395182597883
E1      =    35.865394156504
E2      =   -15.356495704300
E3      =   -20.050630649748
Exc     =   -17.923548904605
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 1.924e-05, dEband = 8.325e-03
rank = 0, Calculating/Estimating energy took 1.007 ms, Etot = -55.839130774, dEtot = 1.924e-05, dEband = 8.325e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2885075368348, which took 0.118 ms

iter_count = 114, r_2norm = 7.424e-06, tol*||rhs|| = 1.154e-05

Anderson update took 60.271 ms, out of which F'*F took 27.894 ms; b-Ax took 192.041 ms, out of which Lap took 170.177 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.737 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201153, int_b + int_rho = 7.640e-14, checking this took 0.125 ms
2-norm of RHS = 778.7741461599926, which took 0.112 ms

iter_count = 222, r_2norm = 7.636e-04, tol*||rhs|| = 7.788e-04

Anderson update took 117.055 ms, out of which F'*F took 55.526 ms; b-Ax took 369.899 ms, out of which Lap took 332.062 ms
Solving Poisson took 800.530 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.195001 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.231702 
Total time for convolution: 	 convolve: 5.226662 
Total time for convolution: 	 convolve: 5.199038 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
---Transfer Veff_loc: D2D took 3.585 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.008 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.629 ms

This SCF took 27869.014 ms, scf error = 1.636e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.134690, lowerbound = -1.071748, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1615.756 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.531 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.753 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.303 ms
rank =  0, finding HY took 27.406 ms
rank =  0, distributing HY into block cyclic form took 20.403 ms
rank =  0, finding Y'*HY took 5.640 ms
Rank 0, Project_Hamiltonian used 77.784 ms
Total time for projection: 77.795 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.150 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.244 ms
    first calculated eigval = -1.069889796408380
    last  calculated eigval = 0.035473044953442
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.49425654194467
lambda[   8] =  -0.46933226003756
lambda[   9] =  -0.43607920116996
lambda[  10] =  -0.39520481301390
lambda[  11] =  -0.39372717259363
lambda[  12] =  -0.32022167300441
lambda[  13] =  -0.27565187374150
lambda[  14] =  -0.27190591511502
lambda[  15] =  -0.24313951385539
lambda[  16] =  -0.22530097657737
lambda[  17] =  -0.04089414434881
lambda[  18] =  -0.02943748536403
lambda[  19] =  -0.01093110477474
lambda[  20] =   0.00883563936231
lambda[  21] =   0.01616242766840
lambda[  22] =   0.02374027776114
lambda[  23] =   0.02558757972799
lambda[  24] =   0.03547304495344
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.269 ms
rank =  0, subspace rotation using ScaLAPACK took 8.613 ms
rank =  0, Distributing orbital back into band + domain format took 20.764 ms
rank = 0, Subspace_Rotation used 29.395 ms

Total time for subspace rotation: 29.399 ms
rank = 0, Efermi =  -0.069634649454 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.283 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.600 ms
rank = 0, Calculating density took 1741.229 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.831 ms
rank = 0, D2D took 1.922 ms
rank = 0, Transfering density took 1.924 ms
Etot    =   -55.839185223098
Eband   =   -16.342644238667
E1      =    35.839231489494
E2      =   -15.328517937509
E3      =   -20.055976864431
Exc     =   -17.927347493831
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 5.445e-06, dEband = 5.254e-03
rank = 0, Calculating/Estimating energy took 1.107 ms, Etot = -55.839185223, dEtot = 5.445e-06, dEband = 5.254e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2161232606587, which took 0.129 ms

iter_count = 114, r_2norm = 5.352e-06, tol*||rhs|| = 8.645e-06

Anderson update took 59.798 ms, out of which F'*F took 27.797 ms; b-Ax took 192.546 ms, out of which Lap took 170.847 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.453 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201154, int_b + int_rho = 9.095e-14, checking this took 0.113 ms
2-norm of RHS = 778.7474489401858, which took 0.107 ms

iter_count = 210, r_2norm = 6.614e-04, tol*||rhs|| = 7.787e-04

Anderson update took 111.991 ms, out of which F'*F took 51.671 ms; b-Ax took 350.045 ms, out of which Lap took 313.479 ms
Solving Poisson took 758.087 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.278071 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.255380 
Total time for convolution: 	 convolve: 5.310445 
Total time for convolution: 	 convolve: 5.213631 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.583 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.619 ms

This SCF took 28063.717 ms, scf error = 1.012e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.135473, lowerbound = -1.069890, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1610.573 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.544 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.761 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.324 ms
rank =  0, finding HY took 27.413 ms
rank =  0, distributing HY into block cyclic form took 20.522 ms
rank =  0, finding Y'*HY took 5.724 ms
Rank 0, Project_Hamiltonian used 78.014 ms
Total time for projection: 78.026 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.150 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.248 ms
    first calculated eigval = -1.068667707618333
    last  calculated eigval = 0.036403065193346
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.49325539185791
lambda[   8] =  -0.46830730782883
lambda[   9] =  -0.43504374964292
lambda[  10] =  -0.39422598267830
lambda[  11] =  -0.39288166821080
lambda[  12] =  -0.31890981998872
lambda[  13] =  -0.27453013832907
lambda[  14] =  -0.27072734393804
lambda[  15] =  -0.24177486122813
lambda[  16] =  -0.22384964762765
lambda[  17] =  -0.03973582640042
lambda[  18] =  -0.02814133737139
lambda[  19] =  -0.00976659291183
lambda[  20] =   0.01020739353290
lambda[  21] =   0.01786008240024
lambda[  22] =   0.02538368203468
lambda[  23] =   0.02647396237162
lambda[  24] =   0.03640306519335
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.287 ms
rank =  0, subspace rotation using ScaLAPACK took 8.621 ms
rank =  0, Distributing orbital back into band + domain format took 20.805 ms
rank = 0, Subspace_Rotation used 29.443 ms

Total time for subspace rotation: 29.448 ms
rank = 0, Efermi =  -0.068476331109 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 5.264 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.068 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.611 ms
rank = 0, Calculating density took 1736.433 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.904 ms
rank = 0, D2D took 1.996 ms
rank = 0, Transfering density took 1.999 ms
Etot    =   -55.839244796755
Eband   =   -16.305964795020
E1      =    35.819805709619
E2      =   -15.310338544419
E3      =   -20.059620132684
Exc     =   -17.930124606423
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 5.957e-06, dEband = 3.668e-03
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -55.839244797, dEtot = 5.957e-06, dEband = 3.668e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1258575247688, which took 0.050 ms

iter_count = 108, r_2norm = 4.946e-06, tol*||rhs|| = 5.034e-06

Anderson update took 56.790 ms, out of which F'*F took 26.626 ms; b-Ax took 181.889 ms, out of which Lap took 161.327 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.004 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201167, int_b + int_rho = 2.183e-13, checking this took 0.147 ms
2-norm of RHS = 778.7493314760203, which took 0.108 ms

iter_count = 204, r_2norm = 6.921e-04, tol*||rhs|| = 7.787e-04

Anderson update took 109.678 ms, out of which F'*F took 50.221 ms; b-Ax took 338.984 ms, out of which Lap took 304.545 ms
Solving Poisson took 738.992 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.252294 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.256494 
Total time for convolution: 	 convolve: 5.201580 
Total time for convolution: 	 convolve: 5.265370 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.883 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.542 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.879 ms

This SCF took 27895.364 ms, scf error = 6.840e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.136403, lowerbound = -1.068668, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1609.814 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.531 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.886 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.438 ms
rank =  0, finding HY took 27.306 ms
rank =  0, distributing HY into block cyclic form took 20.492 ms
rank =  0, finding Y'*HY took 5.706 ms
Rank 0, Project_Hamiltonian used 77.972 ms
Total time for projection: 77.985 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.155 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.106 ms
rank = 0, Solve_Generalized_EigenProblem used 0.264 ms
    first calculated eigval = -1.067751770287424
    last  calculated eigval = 0.036917653586150
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.49247764193629
lambda[   8] =  -0.46745899416200
lambda[   9] =  -0.43426010630760
lambda[  10] =  -0.39346360533538
lambda[  11] =  -0.39220531423292
lambda[  12] =  -0.31803455011780
lambda[  13] =  -0.27366219215299
lambda[  14] =  -0.26985999041105
lambda[  15] =  -0.24092240353946
lambda[  16] =  -0.22296559609601
lambda[  17] =  -0.03872451441317
lambda[  18] =  -0.02581050154917
lambda[  19] =  -0.00868120763853
lambda[  20] =   0.01297668996008
lambda[  21] =   0.01995293406983
lambda[  22] =   0.02803370742655
lambda[  23] =   0.02832752785393
lambda[  24] =   0.03691765358615
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.287 ms
rank =  0, subspace rotation using ScaLAPACK took 8.614 ms
rank =  0, Distributing orbital back into band + domain format took 20.967 ms
rank = 0, Subspace_Rotation used 29.598 ms

Total time for subspace rotation: 29.603 ms
rank = 0, Efermi =  -0.067465019058 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 5.305 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.274 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 1736.021 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.787 ms
rank = 0, D2D took 1.890 ms
rank = 0, Transfering density took 1.892 ms
Etot    =   -55.839348378026
Eband   =   -16.279257024331
E1      =    35.807662507571
E2      =   -15.295603547436
E3      =   -20.060053129774
Exc     =   -17.930490756441
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 1.036e-05, dEband = 2.671e-03
rank = 0, Calculating/Estimating energy took 0.934 ms, Etot = -55.839348378, dEtot = 1.036e-05, dEband = 2.671e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0808051017728, which took 0.124 ms

iter_count = 114, r_2norm = 2.095e-06, tol*||rhs|| = 3.232e-06

Anderson update took 60.197 ms, out of which F'*F took 28.967 ms; b-Ax took 193.007 ms, out of which Lap took 171.335 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.953 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201173, int_b + int_rho = 2.801e-13, checking this took 0.122 ms
2-norm of RHS = 778.7556298699218, which took 0.128 ms

iter_count = 186, r_2norm = 6.441e-04, tol*||rhs|| = 7.788e-04

Anderson update took 98.119 ms, out of which F'*F took 45.990 ms; b-Ax took 309.241 ms, out of which Lap took 277.697 ms
Solving Poisson took 671.204 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.233514 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.210831 
Total time for convolution: 	 convolve: 5.205419 
Total time for convolution: 	 convolve: 5.230242 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.870 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.042 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.501 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.023 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.559 ms

This SCF took 27752.715 ms, scf error = 4.135e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.136918, lowerbound = -1.067752, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1614.876 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.407 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.912 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.340 ms
rank =  0, finding HY took 27.327 ms
rank =  0, distributing HY into block cyclic form took 20.467 ms
rank =  0, finding Y'*HY took 5.687 ms
Rank 0, Project_Hamiltonian used 77.853 ms
Total time for projection: 77.867 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.146 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.105 ms
rank = 0, Solve_Generalized_EigenProblem used 0.255 ms
    first calculated eigval = -1.067118755073715
    last  calculated eigval = 0.036762681318010
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.49193080533270
lambda[   8] =  -0.46686961931509
lambda[   9] =  -0.43371843343229
lambda[  10] =  -0.39292131333666
lambda[  11] =  -0.39170183100618
lambda[  12] =  -0.31743910616224
lambda[  13] =  -0.27307250790236
lambda[  14] =  -0.26927415045777
lambda[  15] =  -0.24032984461739
lambda[  16] =  -0.22238074762649
lambda[  17] =  -0.03805754113350
lambda[  18] =  -0.02391318079075
lambda[  19] =  -0.00788320753671
lambda[  20] =   0.01527145985611
lambda[  21] =   0.02125413732495
lambda[  22] =   0.02908510840442
lambda[  23] =   0.03060073961275
lambda[  24] =   0.03676268131801
==subpsace eigenproblem: bcast eigvals took 0.079 ms
Total time for solving subspace eigenvalue problem: 0.341 ms
rank =  0, subspace rotation using ScaLAPACK took 8.945 ms
rank =  0, Distributing orbital back into band + domain format took 20.667 ms
rank = 0, Subspace_Rotation used 29.635 ms

Total time for subspace rotation: 29.640 ms
rank = 0, Efermi =  -0.066798045722 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 5.304 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.931 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.595 ms
rank = 0, Calculating density took 1740.714 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.820 ms
rank = 0, D2D took 1.918 ms
rank = 0, Transfering density took 1.924 ms
Etot    =   -55.839419833149
Eband   =   -16.260750882464
E1      =    35.798534379662
E2      =   -15.285922547315
E3      =   -20.061183392946
Exc     =   -17.931389488575
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 7.146e-06, dEband = 1.851e-03
rank = 0, Calculating/Estimating energy took 0.931 ms, Etot = -55.839419833, dEtot = 7.146e-06, dEband = 1.851e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0527576127559, which took 0.061 ms

iter_count = 114, r_2norm = 1.562e-06, tol*||rhs|| = 2.110e-06

Anderson update took 59.749 ms, out of which F'*F took 27.936 ms; b-Ax took 192.248 ms, out of which Lap took 170.449 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.182 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201171, int_b + int_rho = 2.583e-13, checking this took 0.132 ms
2-norm of RHS = 778.7603558079614, which took 0.133 ms

iter_count = 162, r_2norm = 7.478e-04, tol*||rhs|| = 7.788e-04

Anderson update took 85.662 ms, out of which F'*F took 39.734 ms; b-Ax took 268.843 ms, out of which Lap took 241.167 ms
Solving Poisson took 590.225 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.200642 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 60.903 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.211356 
Total time for convolution: 	 convolve: 5.306843 
Total time for convolution: 	 convolve: 5.229702 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.824 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.232 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.519 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.102 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.655 ms

This SCF took 27816.989 ms, scf error = 2.944e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.136763, lowerbound = -1.067119, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1616.508 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.529 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.837 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.386 ms
rank =  0, finding HY took 27.327 ms
rank =  0, distributing HY into block cyclic form took 20.499 ms
rank =  0, finding Y'*HY took 5.689 ms
Rank 0, Project_Hamiltonian used 77.935 ms
Total time for projection: 77.947 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.149 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.502 ms
rank = 0, Solve_Generalized_EigenProblem used 1.672 ms
    first calculated eigval = -1.066690557186774
    last  calculated eigval = 0.036543072828214
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.49157140470574
lambda[   8] =  -0.46647796158748
lambda[   9] =  -0.43334949346024
lambda[  10] =  -0.39256899800445
lambda[  11] =  -0.39138553162810
lambda[  12] =  -0.31704166527343
lambda[  13] =  -0.27267576648645
lambda[  14] =  -0.26886966786486
lambda[  15] =  -0.23993293862606
lambda[  16] =  -0.22197970034958
lambda[  17] =  -0.03762960682828
lambda[  18] =  -0.02266903871839
lambda[  19] =  -0.00737158982422
lambda[  20] =   0.01697808566368
lambda[  21] =   0.02208619911404
lambda[  22] =   0.02958341740609
lambda[  23] =   0.03189723057442
lambda[  24] =   0.03654307282821
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 1.696 ms
rank =  0, subspace rotation using ScaLAPACK took 8.657 ms
rank =  0, Distributing orbital back into band + domain format took 20.737 ms
rank = 0, Subspace_Rotation used 29.412 ms

Total time for subspace rotation: 29.417 ms
rank = 0, Efermi =  -0.066370111630 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.327 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.110 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.585 ms
rank = 0, Calculating density took 1743.728 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.795 ms
rank = 0, D2D took 1.893 ms
rank = 0, Transfering density took 1.899 ms
Etot    =   -55.839474404339
Eband   =   -16.248332344347
E1      =    35.792217052254
E2      =   -15.279598533953
E3      =   -20.061996450909
Exc     =   -17.932034315072
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 5.457e-06, dEband = 1.242e-03
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -55.839474404, dEtot = 5.457e-06, dEband = 1.242e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0413202826612, which took 0.093 ms

iter_count = 108, r_2norm = 1.477e-06, tol*||rhs|| = 1.653e-06

Anderson update took 56.666 ms, out of which F'*F took 26.738 ms; b-Ax took 182.278 ms, out of which Lap took 161.464 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.742 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201159, int_b + int_rho = 1.419e-13, checking this took 0.103 ms
2-norm of RHS = 778.7699963262775, which took 0.065 ms

iter_count = 168, r_2norm = 6.877e-04, tol*||rhs|| = 7.788e-04

Anderson update took 88.914 ms, out of which F'*F took 41.291 ms; b-Ax took 278.791 ms, out of which Lap took 250.350 ms
Solving Poisson took 606.165 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.237496 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.258450 
Total time for convolution: 	 convolve: 5.213014 
Total time for convolution: 	 convolve: 5.237657 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.832 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 3.599 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.017 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.652 ms

This SCF took 27747.071 ms, scf error = 2.164e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136543, lowerbound = -1.066691, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1610.323 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.478 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.855 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.380 ms
rank =  0, finding HY took 27.257 ms
rank =  0, distributing HY into block cyclic form took 20.710 ms
rank =  0, finding Y'*HY took 5.663 ms
Rank 0, Project_Hamiltonian used 78.047 ms
Total time for projection: 78.062 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.146 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.251 ms
    first calculated eigval = -1.066257261849979
    last  calculated eigval = 0.037142255658048
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.49119807441073
lambda[   8] =  -0.46607235501198
lambda[   9] =  -0.43295079690344
lambda[  10] =  -0.39220877606020
lambda[  11] =  -0.39106649590107
lambda[  12] =  -0.31663474210467
lambda[  13] =  -0.27226449411189
lambda[  14] =  -0.26843729537520
lambda[  15] =  -0.23952993608479
lambda[  16] =  -0.22156763287680
lambda[  17] =  -0.03718029121212
lambda[  18] =  -0.02067325573910
lambda[  19] =  -0.00678260863727
lambda[  20] =   0.01920916651932
lambda[  21] =   0.02335976346332
lambda[  22] =   0.03051324428065
lambda[  23] =   0.03381174227774
lambda[  24] =   0.03714225565805
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.278 ms
rank =  0, subspace rotation using ScaLAPACK took 8.546 ms
rank =  0, Distributing orbital back into band + domain format took 21.044 ms
rank = 0, Subspace_Rotation used 29.607 ms

Total time for subspace rotation: 29.613 ms
rank = 0, Efermi =  -0.065920795834 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.377 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.865 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.592 ms
rank = 0, Calculating density took 1736.244 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.821 ms
rank = 0, D2D took 1.920 ms
rank = 0, Transfering density took 1.927 ms
Etot    =   -55.839535915939
Eband   =   -16.235517743862
E1      =    35.786041627171
E2      =   -15.272779538193
E3      =   -20.062571638985
Exc     =   -17.932491194392
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 6.151e-06, dEband = 1.281e-03
rank = 0, Calculating/Estimating energy took 0.941 ms, Etot = -55.839535916, dEtot = 6.151e-06, dEband = 1.281e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0351275332486, which took 0.056 ms

iter_count = 108, r_2norm = 1.351e-06, tol*||rhs|| = 1.405e-06

Anderson update took 71.355 ms, out of which F'*F took 27.980 ms; b-Ax took 183.571 ms, out of which Lap took 163.209 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 413.254 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201161, int_b + int_rho = 1.637e-13, checking this took 0.100 ms
2-norm of RHS = 778.7744627303333, which took 0.101 ms

iter_count = 144, r_2norm = 6.380e-04, tol*||rhs|| = 7.788e-04

Anderson update took 76.010 ms, out of which F'*F took 35.506 ms; b-Ax took 239.617 ms, out of which Lap took 215.041 ms
Solving Poisson took 519.501 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.199154 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.207109 
Total time for convolution: 	 convolve: 5.228173 
Total time for convolution: 	 convolve: 5.229840 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.760 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.597 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.514 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.014 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.562 ms

This SCF took 28359.273 ms, scf error = 1.381e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.137142, lowerbound = -1.066257, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1594.882 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.600 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.795 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.414 ms
rank =  0, finding HY took 27.400 ms
rank =  0, distributing HY into block cyclic form took 20.404 ms
rank =  0, finding Y'*HY took 5.682 ms
Rank 0, Project_Hamiltonian used 77.931 ms
Total time for projection: 77.943 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.234 ms
    first calculated eigval = -1.066108371971768
    last  calculated eigval = 0.037494696821656
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.49105159931689
lambda[   8] =  -0.46592247791677
lambda[   9] =  -0.43279591947234
lambda[  10] =  -0.39207165328508
lambda[  11] =  -0.39093648191174
lambda[  12] =  -0.31648498168382
lambda[  13] =  -0.27211471923005
lambda[  14] =  -0.26828066902707
lambda[  15] =  -0.23938146963589
lambda[  16] =  -0.22141899380002
lambda[  17] =  -0.03702711536287
lambda[  18] =  -0.01968458478719
lambda[  19] =  -0.00655571096229
lambda[  20] =   0.01995477009602
lambda[  21] =   0.02398438998868
lambda[  22] =   0.03055914647950
lambda[  23] =   0.03451052450750
lambda[  24] =   0.03749469682166
==subpsace eigenproblem: bcast eigvals took 0.074 ms
Total time for solving subspace eigenvalue problem: 0.315 ms
rank =  0, subspace rotation using ScaLAPACK took 8.656 ms
rank =  0, Distributing orbital back into band + domain format took 21.616 ms
rank = 0, Subspace_Rotation used 30.290 ms

Total time for subspace rotation: 30.296 ms
rank = 0, Efermi =  -0.065767619931 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.648 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.930 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 1720.723 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.822 ms
rank = 0, D2D took 1.914 ms
rank = 0, Transfering density took 1.916 ms
Etot    =   -55.839566459924
Eband   =   -16.230780291733
E1      =    35.783832213873
E2      =   -15.270176333307
E3      =   -20.062768995529
Exc     =   -17.932643928866
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 3.054e-06, dEband = 4.737e-04
rank = 0, Calculating/Estimating energy took 0.933 ms, Etot = -55.839566460, dEtot = 3.054e-06, dEband = 4.737e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0223447639179, which took 0.118 ms

iter_count = 114, r_2norm = 5.405e-07, tol*||rhs|| = 8.938e-07

Anderson update took 60.010 ms, out of which F'*F took 27.722 ms; b-Ax took 191.860 ms, out of which Lap took 170.009 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.279 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201166, int_b + int_rho = 2.074e-13, checking this took 0.113 ms
2-norm of RHS = 778.7754021079089, which took 0.126 ms

iter_count = 138, r_2norm = 7.774e-04, tol*||rhs|| = 7.788e-04

Anderson update took 74.217 ms, out of which F'*F took 33.746 ms; b-Ax took 229.363 ms, out of which Lap took 205.712 ms
Solving Poisson took 499.184 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.250242 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.278132 
Total time for convolution: 	 convolve: 5.227749 
Total time for convolution: 	 convolve: 5.300494 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.609 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.998 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.642 ms

This SCF took 27772.931 ms, scf error = 1.103e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.137495, lowerbound = -1.066108, upperbound = 267.587178

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1602.881 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.551 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.819 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.388 ms
rank =  0, finding HY took 27.350 ms
rank =  0, distributing HY into block cyclic form took 20.509 ms
rank =  0, finding Y'*HY took 5.691 ms
Rank 0, Project_Hamiltonian used 77.970 ms
Total time for projection: 77.981 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.157 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.260 ms
    first calculated eigval = -1.066045037621693
    last  calculated eigval = 0.038122126326141
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 32):
lambda[   7] =  -0.49095177752750
lambda[   8] =  -0.46583305926095
lambda[   9] =  -0.43269650866499
lambda[  10] =  -0.39197743518068
lambda[  11] =  -0.39083181744520
lambda[  12] =  -0.31640268561747
lambda[  13] =  -0.27202983091955
lambda[  14] =  -0.26819724873668
lambda[  15] =  -0.23930195567942
lambda[  16] =  -0.22134101431521
lambda[  17] =  -0.03698266040907
lambda[  18] =  -0.01923138712455
lambda[  19] =  -0.00656878368458
lambda[  20] =   0.01943346875484
lambda[  21] =   0.02460203963711
lambda[  22] =   0.03086444289784
lambda[  23] =   0.03467080064063
lambda[  24] =   0.03812212632614
==subpsace eigenproblem: bcast eigvals took 0.084 ms
Total time for solving subspace eigenvalue problem: 0.350 ms
rank =  0, subspace rotation using ScaLAPACK took 8.610 ms
rank =  0, Distributing orbital back into band + domain format took 20.792 ms
rank = 0, Subspace_Rotation used 29.420 ms

Total time for subspace rotation: 29.426 ms
rank = 0, Efermi =  -0.065723164940 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.222 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.070 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.593 ms
rank = 0, Calculating density took 1728.652 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.814 ms
rank = 0, D2D took 1.907 ms
rank = 0, Transfering density took 1.910 ms
Etot    =   -55.839593776117
Eband   =   -16.228044836329
E1      =    35.782705873419
E2      =   -15.268572794845
E3      =   -20.062658693668
Exc     =   -17.932566519684
Esc     =   -92.792919781086
Entropy =    -0.000000000948
dE = 2.732e-06, dEband = 2.735e-04
rank = 0, Calculating/Estimating energy took 0.933 ms, Etot = -55.839593776, dEtot = 2.732e-06, dEband = 2.735e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0222289645282, which took 0.062 ms

iter_count = 108, r_2norm = 8.745e-07, tol*||rhs|| = 8.892e-07

Anderson update took 56.438 ms, out of which F'*F took 26.448 ms; b-Ax took 182.091 ms, out of which Lap took 161.365 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.952 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -32.00000003201145, int_rho =  32.00000003201173, int_b + int_rho = 2.728e-13, checking this took 0.142 ms
2-norm of RHS = 778.7741903477090, which took 0.084 ms

iter_count = 84, r_2norm = 7.729e-04, tol*||rhs|| = 7.788e-04

Anderson update took 44.387 ms, out of which F'*F took 20.662 ms; b-Ax took 139.853 ms, out of which Lap took 125.383 ms
Solving Poisson took 305.652 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.211540 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.693 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.238358 
Total time for convolution: 	 convolve: 5.253580 
Total time for convolution: 	 convolve: 5.212138 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.278 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.584 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.022 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.641 ms

This SCF took 27430.141 ms, scf error = 9.594e-05
The last 18 occupations of kpoints #1 are (Nelectron = 32):
lambda[   7] =  -0.49095177752750, occ[   7] =   2.00000000000000
lambda[   8] =  -0.46583305926095, occ[   8] =   2.00000000000000
lambda[   9] =  -0.43269650866499, occ[   9] =   2.00000000000000
lambda[  10] =  -0.39197743518068, occ[  10] =   2.00000000000000
lambda[  11] =  -0.39083181744520, occ[  11] =   2.00000000000000
lambda[  12] =  -0.31640268561747, occ[  12] =   2.00000000000000
lambda[  13] =  -0.27202983091955, occ[  13] =   2.00000000000000
lambda[  14] =  -0.26819724873668, occ[  14] =   2.00000000000000
lambda[  15] =  -0.23930195567942, occ[  15] =   2.00000000000000
lambda[  16] =  -0.22134101431521, occ[  16] =   2.00000000000000
lambda[  17] =  -0.03698266040907, occ[  17] =   0.00000003201163
lambda[  18] =  -0.01923138712455, occ[  18] =   0.00000000000000
lambda[  19] =  -0.00656878368458, occ[  19] =   0.00000000000000
lambda[  20] =   0.01943346875484, occ[  20] =   0.00000000000000
lambda[  21] =   0.02460203963711, occ[  21] =   0.00000000000000
lambda[  22] =   0.03086444289784, occ[  22] =   0.00000000000000
lambda[  23] =   0.03467080064063, occ[  23] =   0.00000000000000
lambda[  24] =   0.03812212632614, occ[  24] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 22 (90%) = 0.000000000000000.
Occupation of state 24 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.746 ms, time for Allreduce/Reduce: 14.100 ms 
Time for calculating local force components: 27.264 ms
Start Calculating nonlocal forces
force_nloc = 
  0.05303364155808  -0.01697532750596  -0.00000000618944
  0.04783782699903  -0.02240371981184  -0.00000001407920
 -0.02632762363393  -0.01623007499464  -0.04304566604637
 -0.02632762526215  -0.01623007406662   0.04304564874154
  0.13013081006618   0.05941376976755  -0.00000000527159
 -0.03344092423977  -0.18828442080973  -0.00000016841086
  0.05939803717021  -0.09071487659245  -0.00000003215115
 -0.97924000893773  -0.24971244306463  -0.00000027968924
 -0.55193376821853   0.86424343026311  -0.00000026324931
  0.51120928789738   0.79934893871088   0.00000049569352
force_loc = 
 -0.06208050605185   0.02031260095200  -0.00000000272201
 -0.05493431456598   0.02635356683761   0.00000049177693
  0.03088344824517   0.01928744750960   0.04989907172645
  0.03088261883389   0.01928697479639  -0.04989790986406
 -0.15535412519526  -0.03719848310017  -0.00000032686359
  0.02976760631735   0.17782541315677  -0.00000054798195
 -0.06120656907913   0.12091192896271   0.00000014882133
  0.99922567656804   0.28030550653721  -0.00000096073766
  0.54905817736200  -0.89671125161778   0.00000034665017
 -0.51767708615849  -0.81838003615535   0.00000259092017
Time for calculating nonlocal force components: 43.362 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00069444805703  -0.00572472719386  -0.00000005689199
[0m[32m  0.00123084451674   0.00861915737335  -0.00000003340187
[0m[32m -0.00312784209691  -0.00154395252184   0.00000000372655
[0m[32m  0.02612623013831   0.00284760080140  -0.00000002880336
[0m[32m  0.01693080871976  -0.02097921369816   0.00000003696801
[0m[32m -0.01426023511997  -0.01756932901290   0.00000011365088
[0mTime for calculating XC forces components: 41.258 ms
 Cartesian force = 
 -0.00909674788271   0.00332743289377  -0.00000027354364
 -0.00714637095590   0.00394000647351   0.00000021306554
  0.00450594122230   0.00304753196270   0.00685314104789
  0.00450511018279   0.00304706017750  -0.00685252575471
 -0.02457875046100   0.01648071892125  -0.00000065365937
 -0.00249235679463  -0.00184969083187  -0.00000101442687
 -0.00498625739478   0.02864325929616  -0.00000014423546
  0.04606201437967   0.03343082372171  -0.00000153386245
  0.01400533447428  -0.05345687560510  -0.00000014426332
 -0.02077791677002  -0.03661026700964   0.00000293563238
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Time for printing density: 392.299 ms
The program took 453.829 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:21
Job ID:        2266788
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:32:12,vmem=8284K,walltime=00:07:41,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-004-13-1
---------------------------------------
