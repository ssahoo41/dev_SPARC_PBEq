---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:36
Job ID:    2266673
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:40
Job ID:    2266673
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.052 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.016 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 42.523 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 8.
[32m
Time for finding element is 0.009 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 17.232 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 108.331 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.966 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.097 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    7.162246	   10.461434	   11.531249	
    7.162246	   10.461434	    8.468751	
   11.081074	   12.738794	   11.657339	
   11.081074	   12.738794	    8.342661	
   10.480228	   11.671556	   10.000000	
   11.846645	    9.223501	   10.000000	
    7.727811	   11.464724	   10.000000	
   12.837754	    7.261206	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.196 ms
Set up communicators.

--set up spincomm took 2.247 ms

--set up kptcomm took 0.366 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 2}
gridsizes = [100, 100, 100], Nstates = 18, dmcomm dims = [1, 1, 2]

--set up dmcomm took 0.006 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 6, ScaLAPACK topology Dims = (6, 1)
nproc = 12, size_blacscomm = 6 = dims[0] * dims[1] = (6, 1)
Nd_blacscomm 500000, Nstates 18 
rank =  0, my blacs rank = 0, BLCYC size (500000, 3), actual size (500000, 3)
rank = 0, mb = nb = 18, mbQ = nbQ = 64
rank = 0, nr_Hp = 18, nc_Hp = 18
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.879 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.149 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 6
# of bands per bandcomm          : 3
npdomain: 2
Embeded Cartesian topology dims: (1,1,2)
# of FD-grid points per processor: 500000 = (100,100,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.334 ms

Calculate_SplineDerivRadFun took 0.201 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.858 ms.
time spent on vectorized spline interp: 3.385 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.595 ms.
time spent on vectorized spline interp: 2.039 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.499 ms.
time spent on vectorized spline interp: 1.949 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.655 ms.

Calculating rb for all atom types took 17.992 ms
----------------------
Estimated memory usage
Total: 1.11 GB
orbitals             : 823.97 MB
global sized vectors : 213.62 MB
subspace matrices : 15.19 kB
others : 103.76 MB
----------------------------------------------
Estimated memory usage per processor: 95.11 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.916 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -22.0000000254966, sum_int_rho = 21.5940586688212
PosCharge = 22.000000025497, NegCharge = -21.594058668821, scal_fac = 1.018798752143
After scaling, int_rho = 22.0000000254967, PosCharge + NegCharge - NetCharge = -4.263e-14
--Calculate Vref took 0.406 ms
--Calculate rho_guess took 2.202 ms

 integral of b = -22.0000000254966,
 int{b} + Nelectron + NetCharge = -2.550e-08,
 Esc = -59.6546605208589,
 MPI_Reduce took 9.120 ms

Calculating b & b_ref took 17.614 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.045 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.056 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.029 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.261 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 33.938 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549653, int_b + int_rho = -9.823e-14, checking this took 0.400 ms
2-norm of RHS = 684.7962656143513, which took 0.421 ms

iter_count = 420, r_2norm = 6.200e-04, tol*||rhs|| = 6.848e-04

Anderson update took 270.433 ms, out of which F'*F took 131.489 ms; b-Ax took 885.676 ms, out of which Lap took 783.437 ms
Solving Poisson took 2041.847 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.823 ms
Total time for convolution: 	 convolve: 5.118818 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.816 ms
Total time for convolution: 	 convolve: 5.105571 
Total time for convolution: 	 convolve: 5.098077 
Total time for convolution: 	 convolve: 5.100909 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.713 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.324 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
rank = 0, XC calculation took 24344.812 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 2.751 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 5.286 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 9.154 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.162 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.971 ms
    Lanczos iter 53, eigmin  = -0.954087706, eigmax = 264.930230037, err_eigmin = 3.968e-04, err_eigmax = 9.642e-03
rank =   0, Lanczos took 137.122 ms, eigmin = -0.954087706359, eigmax = 267.579532337064

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.262722, lowerbound = -1.054088, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1765.757 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.061 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.921 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 24.037 ms
rank =  0, finding HY took 29.805 ms
rank =  0, distributing HY into block cyclic form took 19.337 ms
rank =  0, finding Y'*HY took 5.910 ms
Rank 0, Project_Hamiltonian used 79.154 ms
Total time for projection: 79.173 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.508 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.132 ms
rank = 0, Solve_Generalized_EigenProblem used 0.654 ms
    first calculated eigval = 2.759124368909831
    last  calculated eigval = 3.219289699933148
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =   2.79235232291701
lambda[   3] =   2.83191505499513
lambda[   4] =   2.83320306304421
lambda[   5] =   2.87165865933550
lambda[   6] =   2.90151593159731
lambda[   7] =   2.93169248925712
lambda[   8] =   2.94780032476220
lambda[   9] =   2.96059516168431
lambda[  10] =   2.98132158137662
lambda[  11] =   3.02884932345374
lambda[  12] =   3.04958123718729
lambda[  13] =   3.08944811616221
lambda[  14] =   3.10272631890021
lambda[  15] =   3.11622697412735
lambda[  16] =   3.15421181639878
lambda[  17] =   3.20852094173764
lambda[  18] =   3.21928969993315
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.655 ms
rank =  0, subspace rotation using ScaLAPACK took 7.974 ms
rank =  0, Distributing orbital back into band + domain format took 19.979 ms
rank = 0, Subspace_Rotation used 27.982 ms

Total time for subspace rotation: 27.987 ms
rank = 0, Efermi =   3.039215280927 calculate fermi energy took 0.053 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.319290, lowerbound = -1.054088, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1760.532 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.713 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.967 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 22.724 ms
rank =  0, finding HY took 29.053 ms
rank =  0, distributing HY into block cyclic form took 18.769 ms
rank =  0, finding Y'*HY took 5.385 ms
Rank 0, Project_Hamiltonian used 75.991 ms
Total time for projection: 76.006 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -0.724776145680810
    last  calculated eigval = 0.421752628795267
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.63265234311814
lambda[   3] =  -0.53195766683449
lambda[   4] =  -0.22403045879250
lambda[   5] =  -0.12957328420205
lambda[   6] =  -0.04561467648992
lambda[   7] =   0.01923188475657
lambda[   8] =   0.09909457105453
lambda[   9] =   0.13784801669839
lambda[  10] =   0.19420268424028
lambda[  11] =   0.23794695431499
lambda[  12] =   0.29804462277179
lambda[  13] =   0.34176046700666
lambda[  14] =   0.35404758181846
lambda[  15] =   0.36214613777122
lambda[  16] =   0.37938705182183
lambda[  17] =   0.40056164289150
lambda[  18] =   0.42175262879527
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 7.937 ms
rank =  0, Distributing orbital back into band + domain format took 18.788 ms
rank = 0, Subspace_Rotation used 26.760 ms

Total time for subspace rotation: 26.765 ms
rank = 0, Efermi =   0.269162460139 calculate fermi energy took 0.047 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.521753, lowerbound = -1.054088, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1765.440 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 27.053 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.881 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.040 ms
rank =  0, Distribute data + matrix mult took 32.094 ms
rank =  0, finding HY took 27.260 ms
rank =  0, distributing HY into block cyclic form took 18.717 ms
rank =  0, finding Y'*HY took 5.585 ms
Rank 0, Project_Hamiltonian used 84.412 ms
Total time for projection: 84.421 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -0.958186368958558
    last  calculated eigval = 0.131256429767717
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.94261430304583
lambda[   3] =  -0.76098542532926
lambda[   4] =  -0.57193581745179
lambda[   5] =  -0.56850569492155
lambda[   6] =  -0.51111380417552
lambda[   7] =  -0.45011620360505
lambda[   8] =  -0.40895429678026
lambda[   9] =  -0.37984187493146
lambda[  10] =  -0.35892670228179
lambda[  11] =  -0.32408710312289
lambda[  12] =  -0.00956309271576
lambda[  13] =   0.02477347804525
lambda[  14] =   0.06359873297834
lambda[  15] =   0.08989767952932
lambda[  16] =   0.10562156945189
lambda[  17] =   0.11026275025823
lambda[  18] =   0.13125642976772
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 7.774 ms
rank =  0, Distributing orbital back into band + domain format took 18.944 ms
rank = 0, Subspace_Rotation used 26.737 ms

Total time for subspace rotation: 26.741 ms
rank = 0, Efermi =  -0.038510348798 calculate fermi energy took 0.046 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.231256, lowerbound = -1.054088, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1764.311 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.012 ms
rank =  0, Distribute orbital to block cyclic format took 26.913 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.884 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 30.829 ms
rank =  0, finding HY took 28.664 ms
rank =  0, distributing HY into block cyclic form took 18.585 ms
rank =  0, finding Y'*HY took 5.423 ms
Rank 0, Project_Hamiltonian used 83.552 ms
Total time for projection: 83.559 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.958557298231334
    last  calculated eigval = 0.075681647909253
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.94297120614570
lambda[   3] =  -0.76197511737508
lambda[   4] =  -0.57785988303795
lambda[   5] =  -0.57624357724835
lambda[   6] =  -0.51759911647575
lambda[   7] =  -0.47057581026723
lambda[   8] =  -0.41799994503302
lambda[   9] =  -0.38668170480953
lambda[  10] =  -0.37740120681743
lambda[  11] =  -0.35344111768903
lambda[  12] =  -0.07679694267995
lambda[  13] =  -0.05244203325537
lambda[  14] =  -0.00011702176222
lambda[  15] =   0.03833935375608
lambda[  16] =   0.04676404618164
lambda[  17] =   0.05820884563929
lambda[  18] =   0.07568164790925
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 7.782 ms
rank =  0, Distributing orbital back into band + domain format took 18.864 ms
rank = 0, Subspace_Rotation used 26.664 ms

Total time for subspace rotation: 26.669 ms
rank = 0, Efermi =  -0.105744198757 calculate fermi energy took 0.027 ms
rank = 0, --- Calculate rho: sum over local bands took 5.958 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.628 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.459 ms
rank = 0, Calculating density took 7642.376 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.248 ms
rank = 0, D2D took 1.438 ms
rank = 0, Transfering density took 1.446 ms
Etot    =   -35.264191387852
Eband   =   -12.682611968219
E1      =    25.711293293942
E2      =   -10.074856299981
E3      =   -12.525938804196
Exc     =   -11.239007296132
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 4.408e+00, dEband = 1.585e+00
rank = 0, Calculating/Estimating energy took 1.076 ms, Etot = -35.264191388, dEtot = 4.408e+00, dEband = 1.585e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 52.6486258617223, which took 0.106 ms

iter_count = 96, r_2norm = 1.601e-03, tol*||rhs|| = 2.106e-03

Anderson update took 59.009 ms, out of which F'*F took 28.998 ms; b-Ax took 195.295 ms, out of which Lap took 172.018 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.481 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549666, int_b + int_rho = 3.274e-14, checking this took 0.130 ms
2-norm of RHS = 680.3389416978446, which took 0.177 ms

iter_count = 288, r_2norm = 5.486e-04, tol*||rhs|| = 6.803e-04

Anderson update took 178.606 ms, out of which F'*F took 101.559 ms; b-Ax took 592.862 ms, out of which Lap took 533.287 ms
Solving Poisson took 1344.039 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.443 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.608 ms
Total time for convolution: 	 convolve: 5.139284 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.578 ms
Total time for convolution: 	 convolve: 5.159509 
Total time for convolution: 	 convolve: 5.265471 
Total time for convolution: 	 convolve: 5.122425 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.596 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.343 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
---Transfer Veff_loc: D2D took 1.867 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.755 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.650 ms

This SCF took 34463.211 ms, scf error = 1.853e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.175682, lowerbound = -0.958557, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1752.444 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 24.525 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.838 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 28.396 ms
rank =  0, finding HY took 29.305 ms
rank =  0, distributing HY into block cyclic form took 19.249 ms
rank =  0, finding Y'*HY took 5.824 ms
Rank 0, Project_Hamiltonian used 82.820 ms
Total time for projection: 82.845 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.920268066129463
    last  calculated eigval = 0.047340704992266
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.90033241933629
lambda[   3] =  -0.73430761026048
lambda[   4] =  -0.55081126952064
lambda[   5] =  -0.54559749501728
lambda[   6] =  -0.48674846425001
lambda[   7] =  -0.44444689602474
lambda[   8] =  -0.38119299535198
lambda[   9] =  -0.35985100754395
lambda[  10] =  -0.35101634001559
lambda[  11] =  -0.30976914281809
lambda[  12] =  -0.06807401497504
lambda[  13] =  -0.05110070890061
lambda[  14] =  -0.02420329489467
lambda[  15] =   0.01702180079470
lambda[  16] =   0.02539500231539
lambda[  17] =   0.03862243881866
lambda[  18] =   0.04734070499227
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 8.650 ms
rank =  0, Distributing orbital back into band + domain format took 17.965 ms
rank = 0, Subspace_Rotation used 26.642 ms

Total time for subspace rotation: 26.649 ms
rank = 0, Efermi =  -0.097021271095 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 5.525 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.190 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.382 ms
rank = 0, Calculating density took 1875.377 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.272 ms
rank = 0, D2D took 1.441 ms
rank = 0, Transfering density took 1.447 ms
Etot    =   -35.197987572236
Eband   =   -11.968683414273
E1      =    25.096209279079
E2      =   -10.005151930359
E3      =   -12.713629716192
Exc     =   -11.389634561975
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 8.275e-03, dEband = 8.924e-02
rank = 0, Calculating/Estimating energy took 1.073 ms, Etot = -35.197987572, dEtot = 8.275e-03, dEband = 8.924e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 23.6434414978845, which took 0.150 ms

iter_count = 102, r_2norm = 6.473e-04, tol*||rhs|| = 9.457e-04

Anderson update took 62.426 ms, out of which F'*F took 30.393 ms; b-Ax took 206.410 ms, out of which Lap took 181.626 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 487.785 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549674, int_b + int_rho = 1.201e-13, checking this took 0.129 ms
2-norm of RHS = 676.1022411831748, which took 0.219 ms

iter_count = 294, r_2norm = 6.057e-04, tol*||rhs|| = 6.761e-04

Anderson update took 190.277 ms, out of which F'*F took 88.464 ms; b-Ax took 595.591 ms, out of which Lap took 533.169 ms
Solving Poisson took 1362.559 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.143598 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.130490 
Total time for convolution: 	 convolve: 5.133140 
Total time for convolution: 	 convolve: 5.120709 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.731 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.562 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 1.863 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.832 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.725 ms

This SCF took 28248.532 ms, scf error = 1.232e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.147341, lowerbound = -0.920268, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1756.138 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 23.766 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.164 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.004 ms
rank =  0, Distribute data + matrix mult took 27.953 ms
rank =  0, finding HY took 29.875 ms
rank =  0, distributing HY into block cyclic form took 18.953 ms
rank =  0, finding Y'*HY took 5.518 ms
Rank 0, Project_Hamiltonian used 82.337 ms
Total time for projection: 82.353 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.873250841590077
    last  calculated eigval = 0.033447112763502
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.84858411146521
lambda[   3] =  -0.69196889876987
lambda[   4] =  -0.51177925651844
lambda[   5] =  -0.50439898306688
lambda[   6] =  -0.44399671601414
lambda[   7] =  -0.40559240459017
lambda[   8] =  -0.34422250936021
lambda[   9] =  -0.32731951502646
lambda[  10] =  -0.31883880452597
lambda[  11] =  -0.25756718913531
lambda[  12] =  -0.04878113792671
lambda[  13] =  -0.03033267549841
lambda[  14] =  -0.02613585058247
lambda[  15] =   0.00956236877633
lambda[  16] =   0.01770807064921
lambda[  17] =   0.03158116881947
lambda[  18] =   0.03344711276350
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 8.659 ms
rank =  0, Distributing orbital back into band + domain format took 18.129 ms
rank = 0, Subspace_Rotation used 26.808 ms

Total time for subspace rotation: 26.815 ms
rank = 0, Efermi =  -0.077728394045 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.343 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.572 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.389 ms
rank = 0, Calculating density took 1878.325 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.233 ms
rank = 0, D2D took 1.427 ms
rank = 0, Transfering density took 1.433 ms
Etot    =   -35.156377617036
Eband   =   -11.055038461369
E1      =    24.335692502633
E2      =    -9.841887694988
E3      =   -12.975363246338
Exc     =   -11.599622078006
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 5.201e-03, dEband = 1.142e-01
rank = 0, Calculating/Estimating energy took 1.092 ms, Etot = -35.156377617, dEtot = 5.201e-03, dEband = 1.142e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.9429425432275, which took 0.065 ms

iter_count = 102, r_2norm = 2.846e-04, tol*||rhs|| = 3.177e-04

Anderson update took 62.813 ms, out of which F'*F took 30.220 ms; b-Ax took 205.762 ms, out of which Lap took 181.111 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.719 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549666, int_b + int_rho = 3.638e-14, checking this took 0.118 ms
2-norm of RHS = 675.8008129355898, which took 0.180 ms

iter_count = 282, r_2norm = 5.057e-04, tol*||rhs|| = 6.758e-04

Anderson update took 173.452 ms, out of which F'*F took 81.964 ms; b-Ax took 551.641 ms, out of which Lap took 494.092 ms
Solving Poisson took 1274.870 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.145833 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.133796 
Total time for convolution: 	 convolve: 5.130596 
Total time for convolution: 	 convolve: 5.131656 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.367 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.360 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.861 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.773 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.659 ms

This SCF took 28177.408 ms, scf error = 5.203e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.133447, lowerbound = -0.873251, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1773.816 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.868 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.886 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 22.783 ms
rank =  0, finding HY took 28.837 ms
rank =  0, distributing HY into block cyclic form took 18.671 ms
rank =  0, finding Y'*HY took 5.358 ms
Rank 0, Project_Hamiltonian used 75.693 ms
Total time for projection: 75.713 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.654 ms
rank = 0, Solve_Generalized_EigenProblem used 1.105 ms
    first calculated eigval = -0.858124626858572
    last  calculated eigval = 0.030282804980872
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.83040430191171
lambda[   3] =  -0.67441775488505
lambda[   4] =  -0.49526326935129
lambda[   5] =  -0.48984479090398
lambda[   6] =  -0.42889574502325
lambda[   7] =  -0.38979965071987
lambda[   8] =  -0.33006744616230
lambda[   9] =  -0.31404381107118
lambda[  10] =  -0.30525175722797
lambda[  11] =  -0.24459015655982
lambda[  12] =  -0.04436943859726
lambda[  13] =  -0.02343572189242
lambda[  14] =  -0.02005555544970
lambda[  15] =   0.00625760140334
lambda[  16] =   0.01285767674925
lambda[  17] =   0.02673166548076
lambda[  18] =   0.03028280498087
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 1.122 ms
rank =  0, subspace rotation using ScaLAPACK took 8.130 ms
rank =  0, Distributing orbital back into band + domain format took 18.409 ms
rank = 0, Subspace_Rotation used 26.559 ms

Total time for subspace rotation: 26.564 ms
rank = 0, Efermi =  -0.073316694758 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 5.019 ms
rank = 0, --- Calculate rho: reduce over all band groups took 7.228 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.137 ms
rank = 0, Calculating density took 1890.743 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.341 ms
rank = 0, D2D took 1.516 ms
rank = 0, Transfering density took 1.523 ms
Etot    =   -35.149764938403
Eband   =   -10.721406622481
E1      =    24.095615750711
E2      =    -9.732235933706
E3      =   -13.081205637252
Exc     =   -11.682755115972
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 8.266e-04, dEband = 4.170e-02
rank = 0, Calculating/Estimating energy took 1.061 ms, Etot = -35.149764938, dEtot = 8.266e-04, dEband = 4.170e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.1762114045475, which took 0.064 ms

iter_count = 108, r_2norm = 8.554e-05, tol*||rhs|| = 8.705e-05

Anderson update took 65.990 ms, out of which F'*F took 31.718 ms; b-Ax took 216.472 ms, out of which Lap took 190.528 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 510.310 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549669, int_b + int_rho = 6.185e-14, checking this took 0.148 ms
2-norm of RHS = 676.4189022986960, which took 0.142 ms

iter_count = 270, r_2norm = 5.498e-04, tol*||rhs|| = 6.764e-04

Anderson update took 165.434 ms, out of which F'*F took 78.988 ms; b-Ax took 530.577 ms, out of which Lap took 474.977 ms
Solving Poisson took 1219.908 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.135439 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.266 ms
Total time for convolution: 	 convolve: 5.136201 
Total time for convolution: 	 convolve: 5.118856 
Total time for convolution: 	 convolve: 5.133304 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.820 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 1.878 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.764 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.684 ms

This SCF took 28137.095 ms, scf error = 2.113e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.130283, lowerbound = -0.858125, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1750.964 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.728 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.872 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.632 ms
rank =  0, finding HY took 28.588 ms
rank =  0, distributing HY into block cyclic form took 18.644 ms
rank =  0, finding Y'*HY took 5.444 ms
Rank 0, Project_Hamiltonian used 75.939 ms
Total time for projection: 75.951 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -0.853450176350573
    last  calculated eigval = 0.029579366370761
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82390223165265
lambda[   3] =  -0.66825971929172
lambda[   4] =  -0.48950204655832
lambda[   5] =  -0.48460284089574
lambda[   6] =  -0.42381731085349
lambda[   7] =  -0.38373515033484
lambda[   8] =  -0.32282536177092
lambda[   9] =  -0.30827193370246
lambda[  10] =  -0.29930749014947
lambda[  11] =  -0.24110048200276
lambda[  12] =  -0.04333040738299
lambda[  13] =  -0.02155993783325
lambda[  14] =  -0.01537439000908
lambda[  15] =   0.00442335682548
lambda[  16] =   0.01038077619648
lambda[  17] =   0.02386214693385
lambda[  18] =   0.02957936637076
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 7.992 ms
rank =  0, Distributing orbital back into band + domain format took 18.655 ms
rank = 0, Subspace_Rotation used 26.666 ms

Total time for subspace rotation: 26.671 ms
rank = 0, Efermi =  -0.072277663412 calculate fermi energy took 1.637 ms
rank = 0, --- Calculate rho: sum over local bands took 5.699 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.655 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.417 ms
rank = 0, Calculating density took 1867.266 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.232 ms
rank = 0, D2D took 1.439 ms
rank = 0, Transfering density took 1.443 ms
Etot    =   -35.148133525191
Eband   =   -10.597549488231
E1      =    24.034159852166
E2      =    -9.660798480876
E3      =   -13.122054216071
Exc     =   -11.712936064454
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 2.039e-04, dEband = 1.548e-02
rank = 0, Calculating/Estimating energy took 1.121 ms, Etot = -35.148133525, dEtot = 2.039e-04, dEband = 1.548e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8476157633756, which took 0.060 ms

iter_count = 114, r_2norm = 2.080e-05, tol*||rhs|| = 3.390e-05

Anderson update took 70.033 ms, out of which F'*F took 33.911 ms; b-Ax took 228.705 ms, out of which Lap took 201.506 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 536.169 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549660, int_b + int_rho = -2.547e-14, checking this took 0.132 ms
2-norm of RHS = 676.9450297111800, which took 0.213 ms

iter_count = 258, r_2norm = 5.722e-04, tol*||rhs|| = 6.769e-04

Anderson update took 158.366 ms, out of which F'*F took 74.826 ms; b-Ax took 501.791 ms, out of which Lap took 449.494 ms
Solving Poisson took 1160.886 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.194 ms
Total time for convolution: 	 convolve: 5.126690 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.145582 
Total time for convolution: 	 convolve: 5.162014 
Total time for convolution: 	 convolve: 5.130951 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 2.118 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.323 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.475 ms

This SCF took 28128.301 ms, scf error = 8.107e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.129579, lowerbound = -0.853450, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1732.280 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.595 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.816 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 22.445 ms
rank =  0, finding HY took 28.974 ms
rank =  0, distributing HY into block cyclic form took 18.849 ms
rank =  0, finding Y'*HY took 6.002 ms
Rank 0, Project_Hamiltonian used 76.313 ms
Total time for projection: 76.328 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.850159356503172
    last  calculated eigval = 0.029561327757136
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82166854383916
lambda[   3] =  -0.66588138498953
lambda[   4] =  -0.48697206206313
lambda[   5] =  -0.48142910995515
lambda[   6] =  -0.42103473399382
lambda[   7] =  -0.38110701624804
lambda[   8] =  -0.31927750512625
lambda[   9] =  -0.30578287513432
lambda[  10] =  -0.29695934947274
lambda[  11] =  -0.23699423594059
lambda[  12] =  -0.04304536102293
lambda[  13] =  -0.02058704129310
lambda[  14] =  -0.01331586143322
lambda[  15] =   0.00321741073374
lambda[  16] =   0.00890645615726
lambda[  17] =   0.02176281166870
lambda[  18] =   0.02956132775714
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 7.983 ms
rank =  0, Distributing orbital back into band + domain format took 18.700 ms
rank = 0, Subspace_Rotation used 26.702 ms

Total time for subspace rotation: 26.707 ms
rank = 0, Efermi =  -0.071992617151 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 5.269 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.515 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.369 ms
rank = 0, Calculating density took 1848.251 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.227 ms
rank = 0, D2D took 1.416 ms
rank = 0, Transfering density took 1.420 ms
Etot    =   -35.147603796072
Eband   =   -10.534532347629
E1      =    24.016012046236
E2      =    -9.611507172054
E3      =   -13.136030474609
Exc     =   -11.721960619722
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 6.622e-05, dEband = 7.877e-03
rank = 0, Calculating/Estimating energy took 1.112 ms, Etot = -35.147603796, dEtot = 6.622e-05, dEband = 7.877e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6008207095402, which took 0.084 ms

iter_count = 108, r_2norm = 2.122e-05, tol*||rhs|| = 2.403e-05

Anderson update took 65.293 ms, out of which F'*F took 31.233 ms; b-Ax took 214.647 ms, out of which Lap took 189.015 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 501.694 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549669, int_b + int_rho = 6.185e-14, checking this took 0.134 ms
2-norm of RHS = 677.0721062686721, which took 0.174 ms

iter_count = 246, r_2norm = 5.557e-04, tol*||rhs|| = 6.771e-04

Anderson update took 149.462 ms, out of which F'*F took 72.198 ms; b-Ax took 482.565 ms, out of which Lap took 430.262 ms
Solving Poisson took 1103.817 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.127733 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.735 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.377 ms
Total time for convolution: 	 convolve: 5.142572 
Total time for convolution: 	 convolve: 5.133143 
Total time for convolution: 	 convolve: 5.115110 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.227 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.357 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 2.122 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.959 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.883 ms

This SCF took 28008.707 ms, scf error = 3.882e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.129561, lowerbound = -0.850159, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1743.937 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.637 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.881 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 22.549 ms
rank =  0, finding HY took 28.951 ms
rank =  0, distributing HY into block cyclic form took 18.631 ms
rank =  0, finding Y'*HY took 5.335 ms
Rank 0, Project_Hamiltonian used 75.510 ms
Total time for projection: 75.523 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.847106331159264
    last  calculated eigval = 0.029924348302182
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81871858903872
lambda[   3] =  -0.66290393286267
lambda[   4] =  -0.48380473057354
lambda[   5] =  -0.47884497705195
lambda[   6] =  -0.41819042364954
lambda[   7] =  -0.37859845584128
lambda[   8] =  -0.31644146512092
lambda[   9] =  -0.30306522671303
lambda[  10] =  -0.29435674150204
lambda[  11] =  -0.23384519029723
lambda[  12] =  -0.04258436195355
lambda[  13] =  -0.01932481396910
lambda[  14] =  -0.01106236668054
lambda[  15] =   0.00288604614672
lambda[  16] =   0.00812537292733
lambda[  17] =   0.02072636665247
lambda[  18] =   0.02992434830218
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 7.959 ms
rank =  0, Distributing orbital back into band + domain format took 18.643 ms
rank = 0, Subspace_Rotation used 26.622 ms

Total time for subspace rotation: 26.627 ms
rank = 0, Efermi =  -0.071531618042 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.256 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.630 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.352 ms
rank = 0, Calculating density took 1858.653 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.266 ms
rank = 0, D2D took 1.452 ms
rank = 0, Transfering density took 1.455 ms
Etot    =   -35.147457036633
Eband   =   -10.471752128706
E1      =    23.983694974005
E2      =    -9.577901565746
E3      =   -13.147596273883
Exc     =   -11.730237199941
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 1.834e-05, dEband = 7.848e-03
rank = 0, Calculating/Estimating energy took 1.090 ms, Etot = -35.147457037, dEtot = 1.834e-05, dEband = 7.848e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2714494831040, which took 0.057 ms

iter_count = 114, r_2norm = 7.617e-06, tol*||rhs|| = 1.086e-05

Anderson update took 69.543 ms, out of which F'*F took 32.350 ms; b-Ax took 221.820 ms, out of which Lap took 193.973 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 515.158 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549669, int_b + int_rho = 6.185e-14, checking this took 0.079 ms
2-norm of RHS = 677.1245005349226, which took 0.170 ms

iter_count = 234, r_2norm = 6.764e-04, tol*||rhs|| = 6.771e-04

Anderson update took 138.687 ms, out of which F'*F took 65.830 ms; b-Ax took 448.859 ms, out of which Lap took 397.446 ms
Solving Poisson took 1016.253 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.138853 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.385 ms
Total time for convolution: 	 convolve: 5.131247 
Total time for convolution: 	 convolve: 6.200977 
Total time for convolution: 	 convolve: 5.137611 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.838 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.616 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 2.138 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.316 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.510 ms

This SCF took 29006.436 ms, scf error = 2.397e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.129924, lowerbound = -0.847106, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1766.665 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.939 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.721 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 22.692 ms
rank =  0, finding HY took 28.980 ms
rank =  0, distributing HY into block cyclic form took 18.826 ms
rank =  0, finding Y'*HY took 5.210 ms
Rank 0, Project_Hamiltonian used 75.753 ms
Total time for projection: 75.779 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.845302021456285
    last  calculated eigval = 0.030948705953030
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81632908795570
lambda[   3] =  -0.66119916015043
lambda[   4] =  -0.48194923320691
lambda[   5] =  -0.47746071762925
lambda[   6] =  -0.41659303731476
lambda[   7] =  -0.37714736348802
lambda[   8] =  -0.31369012790046
lambda[   9] =  -0.30065658580977
lambda[  10] =  -0.29207369236998
lambda[  11] =  -0.23212332331929
lambda[  12] =  -0.04164353899849
lambda[  13] =  -0.01799054820974
lambda[  14] =  -0.00908971535423
lambda[  15] =   0.00347628496474
lambda[  16] =   0.00822549154101
lambda[  17] =   0.02039000463395
lambda[  18] =   0.03094870595303
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 7.934 ms
rank =  0, Distributing orbital back into band + domain format took 18.737 ms
rank = 0, Subspace_Rotation used 26.689 ms

Total time for subspace rotation: 26.694 ms
rank = 0, Efermi =  -0.070590795126 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 5.358 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.404 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.391 ms
rank = 0, Calculating density took 1881.656 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.246 ms
rank = 0, D2D took 1.424 ms
rank = 0, Transfering density took 1.428 ms
Etot    =   -35.147468472816
Eband   =   -10.429048702263
E1      =    23.963146721828
E2      =    -9.554094517561
E3      =   -13.152966930082
Exc     =   -11.733967418404
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 1.430e-06, dEband = 5.338e-03
rank = 0, Calculating/Estimating energy took 1.178 ms, Etot = -35.147468473, dEtot = 1.430e-06, dEband = 5.338e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1731023751538, which took 0.058 ms

iter_count = 114, r_2norm = 4.798e-06, tol*||rhs|| = 6.924e-06

Anderson update took 70.505 ms, out of which F'*F took 32.245 ms; b-Ax took 222.565 ms, out of which Lap took 194.762 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 523.620 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549666, int_b + int_rho = 3.274e-14, checking this took 0.124 ms
2-norm of RHS = 677.1054952857037, which took 0.145 ms

iter_count = 222, r_2norm = 6.268e-04, tol*||rhs|| = 6.771e-04

Anderson update took 131.178 ms, out of which F'*F took 63.905 ms; b-Ax took 432.947 ms, out of which Lap took 383.723 ms
Solving Poisson took 979.292 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.126285 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.127715 
Total time for convolution: 	 convolve: 5.139328 
Total time for convolution: 	 convolve: 5.146225 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.757 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.613 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.540 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.520 ms
---Transfer Veff_loc: D2D took 2.415 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.347 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.800 ms

This SCF took 27938.718 ms, scf error = 1.373e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.130949, lowerbound = -0.845302, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1745.723 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.844 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.882 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 22.771 ms
rank =  0, finding HY took 29.060 ms
rank =  0, distributing HY into block cyclic form took 18.731 ms
rank =  0, finding Y'*HY took 5.389 ms
Rank 0, Project_Hamiltonian used 75.994 ms
Total time for projection: 76.009 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.107 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.844139409951641
    last  calculated eigval = 0.031690121649503
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81476032131682
lambda[   3] =  -0.66007810565510
lambda[   4] =  -0.48078274250575
lambda[   5] =  -0.47645318400725
lambda[   6] =  -0.41554984933767
lambda[   7] =  -0.37606501699103
lambda[   8] =  -0.31210444162337
lambda[   9] =  -0.29909064913979
lambda[  10] =  -0.29056050382514
lambda[  11] =  -0.23098536231968
lambda[  12] =  -0.03977318689509
lambda[  13] =  -0.01642875871432
lambda[  14] =  -0.00760314439219
lambda[  15] =   0.00544603872139
lambda[  16] =   0.01039252186419
lambda[  17] =   0.02059457792691
lambda[  18] =   0.03169012164950
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 7.961 ms
rank =  0, Distributing orbital back into band + domain format took 18.671 ms
rank = 0, Subspace_Rotation used 26.649 ms

Total time for subspace rotation: 26.654 ms
rank = 0, Efermi =  -0.068720443084 calculate fermi energy took 0.115 ms
rank = 0, --- Calculate rho: sum over local bands took 5.348 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.544 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.404 ms
rank = 0, Calculating density took 1861.091 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.251 ms
rank = 0, D2D took 2.278 ms
rank = 0, Transfering density took 2.281 ms
Etot    =   -35.147595424284
Eband   =   -10.401139174361
E1      =    23.949734170461
E2      =    -9.539032515785
E3      =   -13.154855204093
Exc     =   -11.735417618643
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 1.587e-05, dEband = 3.489e-03
rank = 0, Calculating/Estimating energy took 1.046 ms, Etot = -35.147595424, dEtot = 1.587e-05, dEband = 3.489e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1253100812806, which took 0.057 ms

iter_count = 114, r_2norm = 3.286e-06, tol*||rhs|| = 5.012e-06

Anderson update took 68.419 ms, out of which F'*F took 32.288 ms; b-Ax took 224.726 ms, out of which Lap took 193.745 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 513.326 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549661, int_b + int_rho = -1.091e-14, checking this took 0.135 ms
2-norm of RHS = 677.0908447406779, which took 0.177 ms

iter_count = 204, r_2norm = 5.979e-04, tol*||rhs|| = 6.771e-04

Anderson update took 121.713 ms, out of which F'*F took 57.450 ms; b-Ax took 395.630 ms, out of which Lap took 346.601 ms
Solving Poisson took 906.770 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.125027 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.625 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.209533 
Total time for convolution: 	 convolve: 5.151977 
Total time for convolution: 	 convolve: 5.126565 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.795 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.401 ms
---Transfer Veff_loc: D2D took 2.031 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.353 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.422 ms

This SCF took 27900.279 ms, scf error = 8.012e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.131690, lowerbound = -0.844139, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1741.430 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.741 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.757 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.072 ms
rank =  0, Distribute data + matrix mult took 22.589 ms
rank =  0, finding HY took 29.153 ms
rank =  0, distributing HY into block cyclic form took 18.656 ms
rank =  0, finding Y'*HY took 5.429 ms
Rank 0, Project_Hamiltonian used 75.868 ms
Total time for projection: 75.883 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.843197301864958
    last  calculated eigval = 0.032177216530112
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81376179171597
lambda[   3] =  -0.65912866934405
lambda[   4] =  -0.47982502317890
lambda[   5] =  -0.47558374663134
lambda[   6] =  -0.41463356252020
lambda[   7] =  -0.37518019739948
lambda[   8] =  -0.31115725403176
lambda[   9] =  -0.29814163030239
lambda[  10] =  -0.28962472793489
lambda[  11] =  -0.23009037874945
lambda[  12] =  -0.03798321141454
lambda[  13] =  -0.01511474235793
lambda[  14] =  -0.00666295943740
lambda[  15] =   0.00750515079121
lambda[  16] =   0.01292595939399
lambda[  17] =   0.02073110968440
lambda[  18] =   0.03217721653011
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 7.946 ms
rank =  0, Distributing orbital back into band + domain format took 18.772 ms
rank = 0, Subspace_Rotation used 26.736 ms

Total time for subspace rotation: 26.741 ms
rank = 0, Efermi =  -0.066930467499 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 5.178 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.282 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.981 ms
rank = 0, Calculating density took 1857.642 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.070 ms
rank = 0, D2D took 1.203 ms
rank = 0, Transfering density took 1.210 ms
Etot    =   -35.147678727711
Eband   =   -10.380648568315
E1      =    23.938643295248
E2      =    -9.529097798208
E3      =   -13.157133740394
Exc     =   -11.737244471626
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 1.041e-05, dEband = 2.561e-03
rank = 0, Calculating/Estimating energy took 1.248 ms, Etot = -35.147678728, dEtot = 1.041e-05, dEband = 2.561e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0820256458544, which took 0.061 ms

iter_count = 108, r_2norm = 3.193e-06, tol*||rhs|| = 3.281e-06

Anderson update took 64.217 ms, out of which F'*F took 30.180 ms; b-Ax took 208.147 ms, out of which Lap took 183.319 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 480.608 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549677, int_b + int_rho = 1.528e-13, checking this took 0.141 ms
2-norm of RHS = 677.1017566831903, which took 0.202 ms

iter_count = 198, r_2norm = 5.984e-04, tol*||rhs|| = 6.771e-04

Anderson update took 116.665 ms, out of which F'*F took 54.880 ms; b-Ax took 379.181 ms, out of which Lap took 332.500 ms
Solving Poisson took 861.504 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.126885 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.435 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.139187 
Total time for convolution: 	 convolve: 5.121359 
Total time for convolution: 	 convolve: 5.124207 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.654 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.474 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
---Transfer Veff_loc: D2D took 2.052 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.386 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.474 ms

This SCF took 27734.520 ms, scf error = 5.728e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.132177, lowerbound = -0.843197, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1747.095 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.756 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.787 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 22.580 ms
rank =  0, finding HY took 29.014 ms
rank =  0, distributing HY into block cyclic form took 18.692 ms
rank =  0, finding Y'*HY took 5.307 ms
Rank 0, Project_Hamiltonian used 75.635 ms
Total time for projection: 75.647 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.842485168519812
    last  calculated eigval = 0.033137505677708
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81314387153847
lambda[   3] =  -0.65840644966824
lambda[   4] =  -0.47909817189650
lambda[   5] =  -0.47487829695079
lambda[   6] =  -0.41391234666877
lambda[   7] =  -0.37447596466335
lambda[   8] =  -0.31050622993052
lambda[   9] =  -0.29747576517842
lambda[  10] =  -0.28895423241712
lambda[  11] =  -0.22945861843518
lambda[  12] =  -0.03597266357316
lambda[  13] =  -0.01359956111145
lambda[  14] =  -0.00590616346234
lambda[  15] =   0.01042782719593
lambda[  16] =   0.01601767668367
lambda[  17] =   0.02095035901124
lambda[  18] =   0.03313750567771
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 8.551 ms
rank =  0, Distributing orbital back into band + domain format took 18.153 ms
rank = 0, Subspace_Rotation used 26.729 ms

Total time for subspace rotation: 26.736 ms
rank = 0, Efermi =  -0.064919919731 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.214 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.189 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.375 ms
rank = 0, Calculating density took 1862.004 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.230 ms
rank = 0, D2D took 1.348 ms
rank = 0, Transfering density took 1.351 ms
Etot    =   -35.147763227825
Eband   =   -10.365590232652
E1      =    23.931704960387
E2      =    -9.520754042148
E3      =   -13.157959049048
Exc     =   -11.737930525138
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 1.056e-05, dEband = 1.882e-03
rank = 0, Calculating/Estimating energy took 1.075 ms, Etot = -35.147763228, dEtot = 1.056e-05, dEband = 1.882e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0615251745212, which took 0.059 ms

iter_count = 114, r_2norm = 1.623e-06, tol*||rhs|| = 2.461e-06

Anderson update took 68.934 ms, out of which F'*F took 32.959 ms; b-Ax took 223.483 ms, out of which Lap took 196.460 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 516.834 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549676, int_b + int_rho = 1.382e-13, checking this took 0.118 ms
2-norm of RHS = 677.1057628585338, which took 0.165 ms

iter_count = 156, r_2norm = 5.964e-04, tol*||rhs|| = 6.771e-04

Anderson update took 93.664 ms, out of which F'*F took 45.139 ms; b-Ax took 305.626 ms, out of which Lap took 272.073 ms
Solving Poisson took 708.602 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.125 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.123946 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.748 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.390 ms
Total time for convolution: 	 convolve: 5.130300 
Total time for convolution: 	 convolve: 5.145782 
Total time for convolution: 	 convolve: 5.145249 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.815 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.497 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 2.161 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.328 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.527 ms

This SCF took 27642.614 ms, scf error = 3.653e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.133138, lowerbound = -0.842485, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1737.390 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 18.687 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.835 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.554 ms
rank =  0, finding HY took 28.928 ms
rank =  0, distributing HY into block cyclic form took 18.685 ms
rank =  0, finding Y'*HY took 5.309 ms
Rank 0, Project_Hamiltonian used 75.517 ms
Total time for projection: 75.533 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.192 ms
    first calculated eigval = -0.842250309178855
    last  calculated eigval = 0.033536545258367
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81290958607214
lambda[   3] =  -0.65816842934371
lambda[   4] =  -0.47885725969077
lambda[   5] =  -0.47465068443484
lambda[   6] =  -0.41368299723364
lambda[   7] =  -0.37424572508917
lambda[   8] =  -0.31028642981596
lambda[   9] =  -0.29723958340356
lambda[  10] =  -0.28871631962044
lambda[  11] =  -0.22925509167085
lambda[  12] =  -0.03533032748851
lambda[  13] =  -0.01302497326124
lambda[  14] =  -0.00568591887149
lambda[  15] =   0.01124112050952
lambda[  16] =   0.01695558105336
lambda[  17] =   0.02106327637209
lambda[  18] =   0.03353654525837
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 7.756 ms
rank =  0, Distributing orbital back into band + domain format took 18.587 ms
rank = 0, Subspace_Rotation used 26.362 ms

Total time for subspace rotation: 26.368 ms
rank = 0, Efermi =  -0.064277583677 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.146 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.345 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.370 ms
rank = 0, Calculating density took 1852.351 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.262 ms
rank = 0, D2D took 1.376 ms
rank = 0, Transfering density took 1.379 ms
Etot    =   -35.147796335672
Eband   =   -10.360524832009
E1      =    23.929256413285
E2      =    -9.518047717023
E3      =   -13.158269884590
Exc     =   -11.738184996943
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 4.138e-06, dEband = 6.332e-04
rank = 0, Calculating/Estimating energy took 1.095 ms, Etot = -35.147796336, dEtot = 4.138e-06, dEband = 6.332e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0354439719201, which took 0.065 ms

iter_count = 108, r_2norm = 1.391e-06, tol*||rhs|| = 1.418e-06

Anderson update took 64.757 ms, out of which F'*F took 30.500 ms; b-Ax took 210.127 ms, out of which Lap took 185.038 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.757 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549673, int_b + int_rho = 1.055e-13, checking this took 0.153 ms
2-norm of RHS = 677.1210928645195, which took 0.127 ms

iter_count = 174, r_2norm = 6.200e-04, tol*||rhs|| = 6.771e-04

Anderson update took 104.563 ms, out of which F'*F took 50.268 ms; b-Ax took 341.349 ms, out of which Lap took 302.994 ms
Solving Poisson took 786.076 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.121163 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.907 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.140714 
Total time for convolution: 	 convolve: 5.123940 
Total time for convolution: 	 convolve: 5.139962 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.093 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.575 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.666 ms
---Transfer Veff_loc: D2D took 2.027 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.379 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.441 ms

This SCF took 27656.765 ms, scf error = 3.009e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.133537, lowerbound = -0.842250, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1745.679 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.802 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.770 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 22.606 ms
rank =  0, finding HY took 29.094 ms
rank =  0, distributing HY into block cyclic form took 18.697 ms
rank =  0, finding Y'*HY took 5.261 ms
Rank 0, Project_Hamiltonian used 75.698 ms
Total time for projection: 75.762 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.192 ms
    first calculated eigval = -0.841816763555840
    last  calculated eigval = 0.036039228294553
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81245198201163
lambda[   3] =  -0.65771725488600
lambda[   4] =  -0.47840658400290
lambda[   5] =  -0.47421547065550
lambda[   6] =  -0.41325484782251
lambda[   7] =  -0.37379828279119
lambda[   8] =  -0.30985538703996
lambda[   9] =  -0.29677759585389
lambda[  10] =  -0.28824961511152
lambda[  11] =  -0.22886235144302
lambda[  12] =  -0.03371843433110
lambda[  13] =  -0.01155053547123
lambda[  14] =  -0.00521206758298
lambda[  15] =   0.01436844180607
lambda[  16] =   0.01964350343019
lambda[  17] =   0.02180094163613
lambda[  18] =   0.03603922829455
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.603 ms
rank =  0, subspace rotation using ScaLAPACK took 8.622 ms
rank =  0, Distributing orbital back into band + domain format took 18.208 ms
rank = 0, Subspace_Rotation used 26.855 ms

Total time for subspace rotation: 26.862 ms
rank = 0, Efermi =  -0.062665690499 calculate fermi energy took 0.066 ms
rank = 0, --- Calculate rho: sum over local bands took 5.281 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.122 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.365 ms
rank = 0, Calculating density took 1860.823 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.295 ms
rank = 0, D2D took 1.443 ms
rank = 0, Transfering density took 1.446 ms
Etot    =   -35.147872463209
Eband   =   -10.350812271208
E1      =    23.924882027497
E2      =    -9.512556196329
E3      =   -13.158697590795
Exc     =   -11.738535485002
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 9.516e-06, dEband = 1.214e-03
rank = 0, Calculating/Estimating energy took 1.119 ms, Etot = -35.147872463, dEtot = 9.516e-06, dEband = 1.214e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0367909215127, which took 0.074 ms

iter_count = 114, r_2norm = 8.845e-07, tol*||rhs|| = 1.472e-06

Anderson update took 67.430 ms, out of which F'*F took 33.105 ms; b-Ax took 224.131 ms, out of which Lap took 197.001 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 512.599 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549671, int_b + int_rho = 9.095e-14, checking this took 0.112 ms
2-norm of RHS = 677.1189330645597, which took 0.197 ms

iter_count = 108, r_2norm = 6.274e-04, tol*||rhs|| = 6.771e-04

Anderson update took 64.573 ms, out of which F'*F took 30.898 ms; b-Ax took 210.990 ms, out of which Lap took 186.934 ms
Solving Poisson took 485.522 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.122951 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.136 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.140000 
Total time for convolution: 	 convolve: 5.125230 
Total time for convolution: 	 convolve: 5.128205 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.760 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.578 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 2.043 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.409 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.486 ms

This SCF took 27640.145 ms, scf error = 2.189e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136039, lowerbound = -0.841817, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1735.733 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.925 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.826 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.788 ms
rank =  0, finding HY took 28.959 ms
rank =  0, distributing HY into block cyclic form took 18.709 ms
rank =  0, finding Y'*HY took 4.467 ms
Rank 0, Project_Hamiltonian used 75.902 ms
Total time for projection: 75.920 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.105 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.841751505625693
    last  calculated eigval = 0.036239724690030
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81237973205208
lambda[   3] =  -0.65765224093638
lambda[   4] =  -0.47834231529893
lambda[   5] =  -0.47415510822827
lambda[   6] =  -0.41319172649407
lambda[   7] =  -0.37373815580876
lambda[   8] =  -0.30979300298141
lambda[   9] =  -0.29671525703945
lambda[  10] =  -0.28818759922004
lambda[  11] =  -0.22879788497066
lambda[  12] =  -0.03359780294609
lambda[  13] =  -0.01139899360682
lambda[  14] =  -0.00515570619463
lambda[  15] =   0.01446172917626
lambda[  16] =   0.01972396771479
lambda[  17] =   0.02182757112234
lambda[  18] =   0.03623972469003
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 7.933 ms
rank =  0, Distributing orbital back into band + domain format took 18.785 ms
rank = 0, Subspace_Rotation used 26.736 ms

Total time for subspace rotation: 26.741 ms
rank = 0, Efermi =  -0.062545059136 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 5.246 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.175 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.390 ms
rank = 0, Calculating density took 1850.545 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.241 ms
rank = 0, D2D took 1.436 ms
rank = 0, Transfering density took 1.444 ms
Etot    =   -35.147884888758
Eband   =   -10.349409058168
E1      =    23.924045698636
E2      =    -9.511954766635
E3      =   -13.158833078423
Exc     =   -11.738648852664
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 1.553e-06, dEband = 1.754e-04
rank = 0, Calculating/Estimating energy took 1.102 ms, Etot = -35.147884889, dEtot = 1.553e-06, dEband = 1.754e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0311281794916, which took 0.064 ms

iter_count = 108, r_2norm = 1.180e-06, tol*||rhs|| = 1.245e-06

Anderson update took 64.396 ms, out of which F'*F took 30.608 ms; b-Ax took 210.876 ms, out of which Lap took 185.471 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.549 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549671, int_b + int_rho = 8.367e-14, checking this took 0.142 ms
2-norm of RHS = 677.1160909148579, which took 0.216 ms

iter_count = 144, r_2norm = 6.338e-04, tol*||rhs|| = 6.771e-04

Anderson update took 86.446 ms, out of which F'*F took 41.634 ms; b-Ax took 282.468 ms, out of which Lap took 250.225 ms
Solving Poisson took 647.439 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.128024 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.210 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.124052 
Total time for convolution: 	 convolve: 5.131207 
Total time for convolution: 	 convolve: 5.142272 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 2.122 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.489 ms

This SCF took 27519.621 ms, scf error = 1.819e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136240, lowerbound = -0.841752, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1744.797 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.797 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.161 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.990 ms
rank =  0, finding HY took 29.001 ms
rank =  0, distributing HY into block cyclic form took 18.714 ms
rank =  0, finding Y'*HY took 5.323 ms
Rank 0, Project_Hamiltonian used 75.072 ms
Total time for projection: 75.081 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.197 ms
    first calculated eigval = -0.841621966973442
    last  calculated eigval = 0.037060336764508
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81224951818970
lambda[   3] =  -0.65752347986263
lambda[   4] =  -0.47821741821157
lambda[   5] =  -0.47402765737329
lambda[   6] =  -0.41306268673590
lambda[   7] =  -0.37361215581140
lambda[   8] =  -0.30967510042759
lambda[   9] =  -0.29659458700840
lambda[  10] =  -0.28806708067715
lambda[  11] =  -0.22866853441920
lambda[  12] =  -0.03354116300037
lambda[  13] =  -0.01107194154813
lambda[  14] =  -0.00507683621099
lambda[  15] =   0.01450405786615
lambda[  16] =   0.01946047844938
lambda[  17] =   0.02229661501837
lambda[  18] =   0.03706033676451
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 7.937 ms
rank =  0, Distributing orbital back into band + domain format took 18.762 ms
rank = 0, Subspace_Rotation used 26.718 ms

Total time for subspace rotation: 26.723 ms
rank = 0, Efermi =  -0.062488419064 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.209 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.337 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.385 ms
rank = 0, Calculating density took 1859.725 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.223 ms
rank = 0, D2D took 1.529 ms
rank = 0, Transfering density took 1.537 ms
Etot    =   -35.147916850852
Eband   =   -10.346640372236
E1      =    23.922591288243
E2      =    -9.510610673892
E3      =   -13.158898460401
Exc     =   -11.738716379533
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 3.995e-06, dEband = 3.461e-04
rank = 0, Calculating/Estimating energy took 1.084 ms, Etot = -35.147916851, dEtot = 3.995e-06, dEband = 3.461e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0191678891808, which took 0.058 ms

iter_count = 114, r_2norm = 5.508e-07, tol*||rhs|| = 7.667e-07

Anderson update took 67.967 ms, out of which F'*F took 33.048 ms; b-Ax took 222.644 ms, out of which Lap took 195.816 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 510.935 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549671, int_b + int_rho = 8.367e-14, checking this took 0.135 ms
2-norm of RHS = 677.1143317671588, which took 0.203 ms

iter_count = 126, r_2norm = 6.698e-04, tol*||rhs|| = 6.771e-04

Anderson update took 75.502 ms, out of which F'*F took 36.083 ms; b-Ax took 245.674 ms, out of which Lap took 218.540 ms
Solving Poisson took 565.616 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.125131 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.815 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.113304 
Total time for convolution: 	 convolve: 5.124814 
Total time for convolution: 	 convolve: 5.158100 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.739 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.254 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 2.115 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.321 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.003 ms

This SCF took 27483.757 ms, scf error = 1.348e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.137060, lowerbound = -0.841622, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1747.025 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.958 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.835 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.823 ms
rank =  0, finding HY took 28.932 ms
rank =  0, distributing HY into block cyclic form took 18.751 ms
rank =  0, finding Y'*HY took 5.277 ms
Rank 0, Project_Hamiltonian used 75.826 ms
Total time for projection: 75.847 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.841567374253661
    last  calculated eigval = 0.037537358954107
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81220614234311
lambda[   3] =  -0.65747323872675
lambda[   4] =  -0.47816774925268
lambda[   5] =  -0.47397307282687
lambda[   6] =  -0.41300970523409
lambda[   7] =  -0.37356107084182
lambda[   8] =  -0.30964434403165
lambda[   9] =  -0.29655555681344
lambda[  10] =  -0.28802691204458
lambda[  11] =  -0.22862001581807
lambda[  12] =  -0.03368422806475
lambda[  13] =  -0.01107407667624
lambda[  14] =  -0.00509808189921
lambda[  15] =   0.01403655736351
lambda[  16] =   0.01875377358504
lambda[  17] =   0.02268614250197
lambda[  18] =   0.03753735895411
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.218 ms
rank =  0, subspace rotation using ScaLAPACK took 7.905 ms
rank =  0, Distributing orbital back into band + domain format took 18.751 ms
rank = 0, Subspace_Rotation used 26.676 ms

Total time for subspace rotation: 26.681 ms
rank = 0, Efermi =  -0.062631484253 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 5.264 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.015 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.887 ms
rank = 0, Calculating density took 1862.075 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.357 ms
rank = 0, D2D took 1.521 ms
rank = 0, Transfering density took 1.524 ms
Etot    =   -35.147930930312
Eband   =   -10.345610365232
E1      =    23.922036024752
E2      =    -9.510133218092
E3      =   -13.158873828750
Exc     =   -11.738703115053
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 1.760e-06, dEband = 1.288e-04
rank = 0, Calculating/Estimating energy took 1.080 ms, Etot = -35.147930930, dEtot = 1.760e-06, dEband = 1.288e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0187005781497, which took 0.066 ms

iter_count = 114, r_2norm = 4.460e-07, tol*||rhs|| = 7.480e-07

Anderson update took 69.125 ms, out of which F'*F took 32.770 ms; b-Ax took 221.506 ms, out of which Lap took 195.204 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 514.295 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549666, int_b + int_rho = 3.638e-14, checking this took 0.139 ms
2-norm of RHS = 677.1172371041453, which took 0.070 ms

iter_count = 126, r_2norm = 5.879e-04, tol*||rhs|| = 6.771e-04

Anderson update took 76.235 ms, out of which F'*F took 36.571 ms; b-Ax took 247.037 ms, out of which Lap took 218.919 ms
Solving Poisson took 566.741 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.153135 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.793 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.128807 
Total time for convolution: 	 convolve: 5.123777 
Total time for convolution: 	 convolve: 5.120427 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.060 ms
---Transfer Veff_loc: D2D took 2.969 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.357 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.362 ms

This SCF took 27592.444 ms, scf error = 1.121e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.137537, lowerbound = -0.841567, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1743.340 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 18.840 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.829 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.704 ms
rank =  0, finding HY took 29.013 ms
rank =  0, distributing HY into block cyclic form took 18.607 ms
rank =  0, finding Y'*HY took 5.268 ms
Rank 0, Project_Hamiltonian used 75.632 ms
Total time for projection: 75.648 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -0.841504973603901
    last  calculated eigval = 0.037748513986778
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81215801670696
lambda[   3] =  -0.65740561451471
lambda[   4] =  -0.47810309360116
lambda[   5] =  -0.47390318132935
lambda[   6] =  -0.41294231330992
lambda[   7] =  -0.37349112604193
lambda[   8] =  -0.30959188009083
lambda[   9] =  -0.29650280032339
lambda[  10] =  -0.28797227484046
lambda[  11] =  -0.22856462597134
lambda[  12] =  -0.03386225548812
lambda[  13] =  -0.01112710248521
lambda[  14] =  -0.00507456701433
lambda[  15] =   0.01359169857036
lambda[  16] =   0.01824809122084
lambda[  17] =   0.02361132774844
lambda[  18] =   0.03774851398678
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 6.274 ms
rank =  0, Distributing orbital back into band + domain format took 20.504 ms
rank = 0, Subspace_Rotation used 26.797 ms

Total time for subspace rotation: 26.801 ms
rank = 0, Efermi =  -0.062809511617 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.346 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.168 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.384 ms
rank = 0, Calculating density took 1858.037 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.211 ms
rank = 0, D2D took 1.495 ms
rank = 0, Transfering density took 1.500 ms
Etot    =   -35.147944707136
Eband   =   -10.344279801531
E1      =    23.921496063505
E2      =    -9.509322150791
E3      =   -13.158888266601
Exc     =   -11.738710864882
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 1.722e-06, dEband = 1.663e-04
rank = 0, Calculating/Estimating energy took 1.094 ms, Etot = -35.147944707, dEtot = 1.722e-06, dEband = 1.663e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0192141782996, which took 0.068 ms

iter_count = 108, r_2norm = 7.192e-07, tol*||rhs|| = 7.686e-07

Anderson update took 65.041 ms, out of which F'*F took 30.872 ms; b-Ax took 209.479 ms, out of which Lap took 184.117 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 487.949 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549671, int_b + int_rho = 9.095e-14, checking this took 0.154 ms
2-norm of RHS = 677.1159467772849, which took 0.225 ms

iter_count = 108, r_2norm = 5.748e-04, tol*||rhs|| = 6.771e-04

Anderson update took 64.496 ms, out of which F'*F took 31.262 ms; b-Ax took 211.206 ms, out of which Lap took 187.646 ms
Solving Poisson took 485.761 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.143456 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.372 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.118953 
Total time for convolution: 	 convolve: 5.127444 
Total time for convolution: 	 convolve: 5.130354 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.735 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 2.151 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.258 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.446 ms

This SCF took 27372.473 ms, scf error = 1.041e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.137749, lowerbound = -0.841505, upperbound = 267.579532

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1745.153 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.960 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.812 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.807 ms
rank =  0, finding HY took 28.840 ms
rank =  0, distributing HY into block cyclic form took 18.546 ms
rank =  0, finding Y'*HY took 5.262 ms
Rank 0, Project_Hamiltonian used 75.508 ms
Total time for projection: 75.526 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.841421683945606
    last  calculated eigval = 0.037549495524797
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.81207648778925
lambda[   3] =  -0.65732415182768
lambda[   4] =  -0.47802113114379
lambda[   5] =  -0.47382694056685
lambda[   6] =  -0.41286283159252
lambda[   7] =  -0.37341657704424
lambda[   8] =  -0.30952742082091
lambda[   9] =  -0.29643188127505
lambda[  10] =  -0.28790111607145
lambda[  11] =  -0.22849209802784
lambda[  12] =  -0.03412511895083
lambda[  13] =  -0.01122645474482
lambda[  14] =  -0.00505276827570
lambda[  15] =   0.01312089965936
lambda[  16] =   0.01756828274452
lambda[  17] =   0.02440956622043
lambda[  18] =   0.03754949552480
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 7.943 ms
rank =  0, Distributing orbital back into band + domain format took 18.706 ms
rank = 0, Subspace_Rotation used 26.668 ms

Total time for subspace rotation: 26.673 ms
rank = 0, Efermi =  -0.063072375079 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 5.243 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.255 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.396 ms
rank = 0, Calculating density took 1859.580 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 1.240 ms
rank = 0, D2D took 1.416 ms
rank = 0, Transfering density took 1.419 ms
Etot    =   -35.147948364557
Eband   =   -10.342604641080
E1      =    23.920508611838
E2      =    -9.508585485100
E3      =   -13.159088085567
Exc     =   -11.738865384362
Esc     =   -59.654660520859
Entropy =    -0.000000000761
dE = 4.572e-07, dEband = 2.094e-04
rank = 0, Calculating/Estimating energy took 1.989 ms, Etot = -35.147948365, dEtot = 4.572e-07, dEband = 2.094e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0185680417292, which took 0.072 ms

iter_count = 108, r_2norm = 5.402e-07, tol*||rhs|| = 7.427e-07

Anderson update took 64.500 ms, out of which F'*F took 33.531 ms; b-Ax took 215.352 ms, out of which Lap took 190.419 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.114 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002549662, int_rho =  22.00000002549657, int_b + int_rho = -5.457e-14, checking this took 0.122 ms
2-norm of RHS = 677.1185267974880, which took 0.175 ms

iter_count = 108, r_2norm = 6.595e-04, tol*||rhs|| = 6.771e-04

Anderson update took 64.886 ms, out of which F'*F took 31.183 ms; b-Ax took 211.943 ms, out of which Lap took 187.549 ms
Solving Poisson took 485.926 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.139681 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.282 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.140423 
Total time for convolution: 	 convolve: 5.118464 
Total time for convolution: 	 convolve: 5.139603 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.588 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 2.118 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.852 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.002 ms

This SCF took 27379.067 ms, scf error = 7.881e-05
The last 17 occupations of kpoints #1 are (Nelectron = 22):
lambda[   2] =  -0.81207648778925, occ[   2] =   2.00000000000000
lambda[   3] =  -0.65732415182768, occ[   3] =   2.00000000000000
lambda[   4] =  -0.47802113114379, occ[   4] =   2.00000000000000
lambda[   5] =  -0.47382694056685, occ[   5] =   2.00000000000000
lambda[   6] =  -0.41286283159252, occ[   6] =   2.00000000000000
lambda[   7] =  -0.37341657704424, occ[   7] =   2.00000000000000
lambda[   8] =  -0.30952742082091, occ[   8] =   2.00000000000000
lambda[   9] =  -0.29643188127505, occ[   9] =   2.00000000000000
lambda[  10] =  -0.28790111607145, occ[  10] =   2.00000000000000
lambda[  11] =  -0.22849209802784, occ[  11] =   2.00000000000000
lambda[  12] =  -0.03412511895083, occ[  12] =   0.00000002549667
lambda[  13] =  -0.01122645474482, occ[  13] =   0.00000000000000
lambda[  14] =  -0.00505276827570, occ[  14] =   0.00000000000000
lambda[  15] =   0.01312089965936, occ[  15] =   0.00000000000000
lambda[  16] =   0.01756828274452, occ[  16] =   0.00000000000000
lambda[  17] =   0.02440956622043, occ[  17] =   0.00000000000000
lambda[  18] =   0.03754949552480, occ[  18] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 16 (90%) = 0.000000000000000.
Occupation of state 18 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.350 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.485 ms, time for Allreduce/Reduce: 11.437 ms 
Time for calculating local force components: 20.923 ms
Start Calculating nonlocal forces
force_nloc = 
  0.02083346800700   0.03249584976470  -0.05216684862584
  0.02083346717954   0.03249585139375   0.05216684973596
 -0.01497567897211  -0.02737301665086  -0.04123147180685
 -0.01497568378288  -0.02737300842571   0.04123147097688
 -0.02975095528301  -0.13272508124960  -0.00000001607742
 -0.00475229291572  -0.00913977621767  -0.00000006920731
  0.32084825128298  -0.64016960547845  -0.00000023882691
 -0.41897240050764   0.82609634304252   0.00000045828408
force_loc = 
 -0.02327939935226  -0.03292537742737   0.05523920355326
 -0.02327966591972  -0.03292546485527  -0.05523941663802
  0.01650836519043   0.02999903208282   0.04405097376845
  0.01650838993149   0.02999898082234  -0.04405104808378
  0.02924050366790   0.11990999379430   0.00000036179102
 -0.00338509764015   0.02812433104983  -0.00000010865515
 -0.31028464190007   0.62301574589249   0.00000088145252
  0.41263490515441  -0.81453037604353   0.00000028088329
Time for calculating nonlocal force components: 44.881 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00263947812591   0.00630596597675   0.00000001560355
[0m[32m  0.00798033482579  -0.01566961226082   0.00000000249582
[0m[32m -0.01056845999840   0.01649958452717   0.00000003342609
[0m[32m  0.00614334565764  -0.01207535473747   0.00000001527659
[0mTime for calculating XC forces components: 27.777 ms
 Cartesian force = 
 -0.00243921043914  -0.00043390328766   0.00307218876164
 -0.00243947783407  -0.00043398908650  -0.00307273306784
  0.00153940712443   0.00262163980697   0.00281933579582
  0.00153942705472   0.00262159677164  -0.00281974327268
  0.00213574741690  -0.00651349710354   0.00000019515137
 -0.00015033482397   0.00331056694635  -0.00000034153242
  0.00000187029061  -0.00065865068378   0.00000050988593
 -0.00018742878948  -0.00051376336347   0.00000058827818
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.372 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Time for printing density: 381.475 ms
The program took 536.324 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:39
Job ID:        2266673
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:52:48,vmem=8464K,walltime=00:09:24,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-18-1
---------------------------------------
