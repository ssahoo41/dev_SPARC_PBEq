---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:03
Job ID:    2266757
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:07
Job ID:    2266757
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.101 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.018 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 8.934 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 11.
[32m
Time for finding element is 0.012 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 8.422 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 110.724 ms

Freeing SPARC_INPUT_MPI datatype took 0.023 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.044 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.126 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.267530	   13.384391	   10.000000	
   12.306463	   12.056408	   10.000000	
    7.693537	    8.826309	   11.649349	
    7.693537	    8.826309	    8.350651	
   10.036153	    5.025817	   10.000000	
   12.136593	    7.033957	    8.338088	
   12.136593	    7.033957	   11.661912	
    9.171025	   14.974183	   10.000000	
   10.076835	   11.567771	   10.000000	
    8.930526	    8.956647	   10.000000	
   10.928312	    6.883958	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.007 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.258 ms
Set up communicators.

--set up spincomm took 3.330 ms

--set up kptcomm took 0.347 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 23, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.004 ms

--set up blacscomm took 0.013 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 23 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 23, mbQ = nbQ = 64
rank = 0, nr_Hp = 23, nc_Hp = 23
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.054 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.007 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.394 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.975 ms

Calculate_SplineDerivRadFun took 0.237 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.878 ms.
time spent on vectorized spline interp: 3.820 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.829 ms.
time spent on vectorized spline interp: 1.703 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.415 ms.
time spent on vectorized spline interp: 1.744 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.631 ms.

Calculating rb for all atom types took 17.034 ms
----------------------
Estimated memory usage
Total: 1.36 GB
orbitals             : 1.03 GB
global sized vectors : 213.62 MB
subspace matrices : 12.40 kB
others : 126.65 MB
----------------------------------------------
Estimated memory usage per processor: 116.10 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.829 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.019 ms
Calculating pseudocharge density ... 
the global sum of int_b = -30.0000000314946, sum_int_rho = 29.3963683539959
PosCharge = 30.000000031495, NegCharge = -29.396368353996, scal_fac = 1.020534226209
After scaling, int_rho = 30.0000000314948, PosCharge + NegCharge - NetCharge = -1.918e-13
--Calculate Vref took 0.608 ms
--Calculate rho_guess took 3.505 ms

 integral of b = -30.0000000314946,
 int{b} + Nelectron + NetCharge = -3.149e-08,
 Esc = -87.8054310079871,
 MPI_Reduce took 9.440 ms

Calculating b & b_ref took 21.225 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.085 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.147 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.108 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.734 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 47.679 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149475, int_b + int_rho = 4.511e-13, checking this took 0.701 ms
2-norm of RHS = 804.3344551694412, which took 0.466 ms

iter_count = 420, r_2norm = 6.627e-04, tol*||rhs|| = 8.043e-04

Anderson update took 209.052 ms, out of which F'*F took 121.889 ms; b-Ax took 715.798 ms, out of which Lap took 675.631 ms
Solving Poisson took 1212.765 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.780 ms
Total time for convolution: 	 convolve: 5.215808 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 142.173 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.773 ms
Total time for convolution: 	 convolve: 5.118066 
Total time for convolution: 	 convolve: 5.307520 
Total time for convolution: 	 convolve: 5.108438 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1227.204 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.716 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.523 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.431 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
rank = 0, XC calculation took 26098.627 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
---Transfer Veff_loc: D2D took 6.183 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 11.390 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 18.793 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.207 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.659 ms
    Lanczos iter 53, eigmin  = -1.025497917, eigmax = 264.931879262, err_eigmin = 2.338e-03, err_eigmax = 9.616e-03
rank =   0, Lanczos took 136.926 ms, eigmin = -1.025497916638, eigmax = 267.581198054992

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.227850, lowerbound = -1.125498, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1587.268 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 27.324 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.644 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 30.996 ms
rank =  0, finding HY took 28.260 ms
rank =  0, distributing HY into block cyclic form took 33.030 ms
rank =  0, finding Y'*HY took 6.124 ms
Rank 0, Project_Hamiltonian used 98.481 ms
Total time for projection: 98.499 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.878 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.141 ms
rank = 0, Solve_Generalized_EigenProblem used 1.024 ms
    first calculated eigval = 2.695652239986427
    last  calculated eigval = 3.286802158343312
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =   2.85548797059664
lambda[   7] =   2.89757209540518
lambda[   8] =   2.89873800571825
lambda[   9] =   2.91972927836916
lambda[  10] =   2.96803810382204
lambda[  11] =   2.98006253243578
lambda[  12] =   2.99235756502704
lambda[  13] =   3.01715392751186
lambda[  14] =   3.02690244392367
lambda[  15] =   3.05754137601476
lambda[  16] =   3.06492854821533
lambda[  17] =   3.10679153701969
lambda[  18] =   3.12292442814530
lambda[  19] =   3.15059977565359
lambda[  20] =   3.15965674025106
lambda[  21] =   3.17697557058132
lambda[  22] =   3.22215551506610
lambda[  23] =   3.28680215834331
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 1.045 ms
rank =  0, subspace rotation using ScaLAPACK took 11.209 ms
rank =  0, Distributing orbital back into band + domain format took 23.056 ms
rank = 0, Subspace_Rotation used 34.290 ms

Total time for subspace rotation: 34.294 ms
rank = 0, Efermi =   3.061234962247 calculate fermi energy took 0.121 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.386802, lowerbound = -1.125498, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1359.543 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 73.798 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.200 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 78.019 ms
rank =  0, finding HY took 21.271 ms
rank =  0, distributing HY into block cyclic form took 17.611 ms
rank =  0, finding Y'*HY took 5.759 ms
Rank 0, Project_Hamiltonian used 122.696 ms
Total time for projection: 122.701 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.156 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.253 ms
    first calculated eigval = -0.849798694235925
    last  calculated eigval = 0.440825081771530
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.21874816961760
lambda[   7] =  -0.18763039399999
lambda[   8] =  -0.07966394111119
lambda[   9] =  -0.05104809028334
lambda[  10] =   0.02356097757751
lambda[  11] =   0.14313284181699
lambda[  12] =   0.16023713238453
lambda[  13] =   0.19061670356454
lambda[  14] =   0.23972507547220
lambda[  15] =   0.30153093107545
lambda[  16] =   0.33590956263411
lambda[  17] =   0.33967341218060
lambda[  18] =   0.35012671429436
lambda[  19] =   0.36634130853218
lambda[  20] =   0.39450212877496
lambda[  21] =   0.41699867540611
lambda[  22] =   0.42414839179520
lambda[  23] =   0.44082508177153
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.262 ms
rank =  0, subspace rotation using ScaLAPACK took 8.163 ms
rank =  0, Distributing orbital back into band + domain format took 15.679 ms
rank = 0, Subspace_Rotation used 23.858 ms

Total time for subspace rotation: 23.862 ms
rank = 0, Efermi =   0.318678887064 calculate fermi energy took 0.037 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.540825, lowerbound = -1.125498, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1157.384 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 183.243 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.185 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 187.447 ms
rank =  0, finding HY took 21.412 ms
rank =  0, distributing HY into block cyclic form took 17.403 ms
rank =  0, finding Y'*HY took 5.686 ms
Rank 0, Project_Hamiltonian used 231.977 ms
Total time for projection: 231.982 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.235 ms
    first calculated eigval = -1.048879266987473
    last  calculated eigval = 0.159243899221794
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.53533201039577
lambda[   7] =  -0.53176875917207
lambda[   8] =  -0.48414611281767
lambda[   9] =  -0.45829494643633
lambda[  10] =  -0.45415973388381
lambda[  11] =  -0.44537990555098
lambda[  12] =  -0.39202778708967
lambda[  13] =  -0.36580718330159
lambda[  14] =  -0.28007660171402
lambda[  15] =  -0.22521340551018
lambda[  16] =   0.03006746161767
lambda[  17] =   0.06072688191905
lambda[  18] =   0.08423662148445
lambda[  19] =   0.10423159438449
lambda[  20] =   0.11421169817330
lambda[  21] =   0.11990816819168
lambda[  22] =   0.13829154160824
lambda[  23] =   0.15924389922179
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 8.187 ms
rank =  0, Distributing orbital back into band + domain format took 15.523 ms
rank = 0, Subspace_Rotation used 23.732 ms

Total time for subspace rotation: 23.736 ms
rank = 0, Efermi =   0.001312121014 calculate fermi energy took 0.031 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.259244, lowerbound = -1.125498, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1157.291 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 200.787 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.201 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 205.007 ms
rank =  0, finding HY took 21.325 ms
rank =  0, distributing HY into block cyclic form took 17.433 ms
rank =  0, finding Y'*HY took 5.662 ms
Rank 0, Project_Hamiltonian used 249.455 ms
Total time for projection: 249.460 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.155 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.257 ms
    first calculated eigval = -1.049184181720488
    last  calculated eigval = 0.105637864397789
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.53915229172017
lambda[   7] =  -0.53900439457231
lambda[   8] =  -0.49365017859063
lambda[   9] =  -0.46877773398857
lambda[  10] =  -0.45964922111640
lambda[  11] =  -0.45509486638773
lambda[  12] =  -0.39920761483100
lambda[  13] =  -0.39875822383481
lambda[  14] =  -0.31774193554229
lambda[  15] =  -0.29858390200144
lambda[  16] =  -0.04090117995451
lambda[  17] =  -0.01234508286258
lambda[  18] =   0.04003896808940
lambda[  19] =   0.04569586347099
lambda[  20] =   0.06105187218314
lambda[  21] =   0.07026805886246
lambda[  22] =   0.07829436861945
lambda[  23] =   0.10563786439779
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.265 ms
rank =  0, subspace rotation using ScaLAPACK took 8.203 ms
rank =  0, Distributing orbital back into band + domain format took 16.717 ms
rank = 0, Subspace_Rotation used 24.937 ms

Total time for subspace rotation: 24.941 ms
rank = 0, Efermi =  -0.069656520472 calculate fermi energy took 0.031 ms
rank = 0, --- Calculate rho: sum over local bands took 2.683 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.944 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.729 ms
rank = 0, Calculating density took 6228.717 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.694 ms
rank = 0, D2D took 1.815 ms
rank = 0, Transfering density took 1.823 ms
Etot    =   -54.891255908809
Eband   =   -17.123717051501
E1      =    33.910399280534
E2      =   -14.134228209478
E3      =   -18.345358898027
Exc     =   -16.352094236427
Esc     =   -87.805431007987
Entropy =    -0.000000000934
dE = 4.990e+00, dEband = 1.557e+00
rank = 0, Calculating/Estimating energy took 0.821 ms, Etot = -54.891255909, dEtot = 4.990e+00, dEband = 1.557e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 61.6718037189032, which took 0.580 ms

iter_count = 96, r_2norm = 1.965e-03, tol*||rhs|| = 2.467e-03

Anderson update took 46.793 ms, out of which F'*F took 27.093 ms; b-Ax took 162.292 ms, out of which Lap took 153.479 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 278.315 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149472, int_b + int_rho = 4.220e-13, checking this took 0.190 ms
2-norm of RHS = 799.7404295200716, which took 0.822 ms

iter_count = 288, r_2norm = 6.737e-04, tol*||rhs|| = 7.997e-04

Anderson update took 170.760 ms, out of which F'*F took 82.452 ms; b-Ax took 489.661 ms, out of which Lap took 463.840 ms
Solving Poisson took 849.281 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.470 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Total time for convolution: 	 convolve: 5.169677 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.203 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.197236 
Total time for convolution: 	 convolve: 5.163701 
Total time for convolution: 	 convolve: 5.270076 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.144 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.138 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.162 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
---Transfer Veff_loc: D2D took 3.630 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.369 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.037 ms

This SCF took 32285.381 ms, scf error = 1.529e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.205638, lowerbound = -1.049184, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1182.733 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 167.405 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.119 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 171.544 ms
rank =  0, finding HY took 21.243 ms
rank =  0, distributing HY into block cyclic form took 17.899 ms
rank =  0, finding Y'*HY took 6.328 ms
Rank 0, Project_Hamiltonian used 217.048 ms
Total time for projection: 217.061 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.163 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.254 ms
    first calculated eigval = -1.034039563122549
    last  calculated eigval = 0.076012036684315
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.51047648726851
lambda[   7] =  -0.50519611935385
lambda[   8] =  -0.46104270974945
lambda[   9] =  -0.43410844403688
lambda[  10] =  -0.42952010803583
lambda[  11] =  -0.42627722012491
lambda[  12] =  -0.38054799930722
lambda[  13] =  -0.37574788289374
lambda[  14] =  -0.29862019015320
lambda[  15] =  -0.26781778104089
lambda[  16] =  -0.05050766406651
lambda[  17] =  -0.03055196328358
lambda[  18] =   0.01791667412525
lambda[  19] =   0.02067752678254
lambda[  20] =   0.03708692856461
lambda[  21] =   0.05015857565213
lambda[  22] =   0.06230896113030
lambda[  23] =   0.07601203668431
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.269 ms
rank =  0, subspace rotation using ScaLAPACK took 8.354 ms
rank =  0, Distributing orbital back into band + domain format took 15.889 ms
rank = 0, Subspace_Rotation used 24.267 ms

Total time for subspace rotation: 24.271 ms
rank = 0, Efermi =  -0.079263004626 calculate fermi energy took 0.077 ms
rank = 0, --- Calculate rho: sum over local bands took 2.793 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.681 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 1440.571 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.817 ms
rank = 0, D2D took 1.951 ms
rank = 0, Transfering density took 1.957 ms
Etot    =   -54.813043506399
Eband   =   -16.305834960042
E1      =    33.208873633585
E2      =   -14.050666478213
E3      =   -18.573547867812
Exc     =   -16.534865517046
Esc     =   -87.805431007987
Entropy =    -0.000000000934
dE = 7.110e-03, dEband = 7.435e-02
rank = 0, Calculating/Estimating energy took 0.813 ms, Etot = -54.813043506, dEtot = 7.110e-03, dEband = 7.435e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 31.5078316203995, which took 0.219 ms

iter_count = 102, r_2norm = 8.502e-04, tol*||rhs|| = 1.260e-03

Anderson update took 49.870 ms, out of which F'*F took 28.943 ms; b-Ax took 172.858 ms, out of which Lap took 163.536 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 297.352 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149487, int_b + int_rho = 5.748e-13, checking this took 0.166 ms
2-norm of RHS = 795.5334184456196, which took 0.215 ms

iter_count = 294, r_2norm = 7.218e-04, tol*||rhs|| = 7.955e-04

Anderson update took 146.682 ms, out of which F'*F took 82.639 ms; b-Ax took 499.642 ms, out of which Lap took 473.108 ms
Solving Poisson took 837.479 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.139 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 5.193203 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1246.842 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Total time for convolution: 	 convolve: 5.172002 
Total time for convolution: 	 convolve: 5.273704 
Total time for convolution: 	 convolve: 5.255521 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.147 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.144 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 3.706 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.378 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.115 ms

This SCF took 28787.985 ms, scf error = 1.010e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.176012, lowerbound = -1.034040, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1175.545 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 178.731 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.831 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 183.582 ms
rank =  0, finding HY took 21.086 ms
rank =  0, distributing HY into block cyclic form took 17.517 ms
rank =  0, finding Y'*HY took 5.752 ms
Rank 0, Project_Hamiltonian used 227.973 ms
Total time for projection: 227.988 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.152 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.553 ms
rank = 0, Solve_Generalized_EigenProblem used 1.724 ms
    first calculated eigval = -1.019415789758027
    last  calculated eigval = 0.063130730669891
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47365072822894
lambda[   7] =  -0.46179049872211
lambda[   8] =  -0.43317047401836
lambda[   9] =  -0.39289972192678
lambda[  10] =  -0.39006261014035
lambda[  11] =  -0.37845786581398
lambda[  12] =  -0.34838348656247
lambda[  13] =  -0.34793769217093
lambda[  14] =  -0.28071254759944
lambda[  15] =  -0.24235170044764
lambda[  16] =  -0.04307453844851
lambda[  17] =  -0.03324842162325
lambda[  18] =   0.01090608432079
lambda[  19] =   0.01681343966160
lambda[  20] =   0.02811364299431
lambda[  21] =   0.03755812258122
lambda[  22] =   0.05040862043152
lambda[  23] =   0.06313073066989
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.739 ms
rank =  0, subspace rotation using ScaLAPACK took 8.265 ms
rank =  0, Distributing orbital back into band + domain format took 15.372 ms
rank = 0, Subspace_Rotation used 23.655 ms

Total time for subspace rotation: 23.660 ms
rank = 0, Efermi =  -0.071829882361 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 2.724 ms
rank = 0, --- Calculate rho: reduce over all band groups took 15.577 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.612 ms
rank = 0, Calculating density took 1447.992 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.709 ms
rank = 0, D2D took 1.834 ms
rank = 0, Transfering density took 1.840 ms
Etot    =   -54.762074067805
Eband   =   -15.305647645237
E1      =    32.374973468455
E2      =   -13.874329535794
E3      =   -18.881232671278
Exc     =   -16.781531089175
Esc     =   -87.805431007987
Entropy =    -0.000000000934
dE = 4.634e-03, dEband = 9.093e-02
rank = 0, Calculating/Estimating energy took 0.814 ms, Etot = -54.762074068, dEtot = 4.634e-03, dEband = 9.093e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 9.1628293832695, which took 0.240 ms

iter_count = 102, r_2norm = 3.508e-04, tol*||rhs|| = 3.665e-04

Anderson update took 49.363 ms, out of which F'*F took 28.931 ms; b-Ax took 172.005 ms, out of which Lap took 162.691 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 295.496 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149493, int_b + int_rho = 6.330e-13, checking this took 0.185 ms
2-norm of RHS = 795.0771979807586, which took 0.231 ms

iter_count = 282, r_2norm = 7.015e-04, tol*||rhs|| = 7.951e-04

Anderson update took 138.295 ms, out of which F'*F took 79.961 ms; b-Ax took 478.372 ms, out of which Lap took 452.818 ms
Solving Poisson took 797.135 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 5.227445 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 78.326 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.223338 
Total time for convolution: 	 convolve: 5.225229 
Total time for convolution: 	 convolve: 5.269007 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.166 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.207 ms
---Transfer Veff_loc: D2D took 3.556 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.289 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.879 ms

This SCF took 27598.912 ms, scf error = 4.589e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.163131, lowerbound = -1.019416, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1175.253 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 155.484 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.176 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 159.681 ms
rank =  0, finding HY took 21.124 ms
rank =  0, distributing HY into block cyclic form took 17.791 ms
rank =  0, finding Y'*HY took 5.621 ms
Rank 0, Project_Hamiltonian used 204.272 ms
Total time for projection: 204.286 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.156 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.247 ms
    first calculated eigval = -1.015918987486106
    last  calculated eigval = 0.056797519780146
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45521857389319
lambda[   7] =  -0.44135768404889
lambda[   8] =  -0.42659843568781
lambda[   9] =  -0.37899034327580
lambda[  10] =  -0.37023368576679
lambda[  11] =  -0.35325491108168
lambda[  12] =  -0.33445360751379
lambda[  13] =  -0.32652243590969
lambda[  14] =  -0.28020437112356
lambda[  15] =  -0.23687853755633
lambda[  16] =  -0.03659607258564
lambda[  17] =  -0.03369921803123
lambda[  18] =   0.00792562890019
lambda[  19] =   0.01539739161744
lambda[  20] =   0.02326544461389
lambda[  21] =   0.03019680523638
lambda[  22] =   0.04001610625838
lambda[  23] =   0.05679751978015
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.262 ms
rank =  0, subspace rotation using ScaLAPACK took 8.264 ms
rank =  0, Distributing orbital back into band + domain format took 15.341 ms
rank = 0, Subspace_Rotation used 23.624 ms

Total time for subspace rotation: 23.628 ms
rank = 0, Efermi =  -0.065383326617 calculate fermi energy took 0.069 ms
rank = 0, --- Calculate rho: sum over local bands took 2.764 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.594 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.672 ms
rank = 0, Calculating density took 1420.599 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.776 ms
rank = 0, D2D took 1.917 ms
rank = 0, Transfering density took 1.919 ms
Etot    =   -54.751010144413
Eband   =   -14.878066973808
E1      =    32.059590683916
E2      =   -13.741511284745
E3      =   -19.030440879936
Exc     =   -16.899055010278
Esc     =   -87.805431007987
Entropy =    -0.000000000938
dE = 1.006e-03, dEband = 3.887e-02
rank = 0, Calculating/Estimating energy took 0.794 ms, Etot = -54.751010144, dEtot = 1.006e-03, dEband = 3.887e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.8057201513075, which took 0.240 ms

iter_count = 108, r_2norm = 1.095e-04, tol*||rhs|| = 1.522e-04

Anderson update took 52.198 ms, out of which F'*F took 30.446 ms; b-Ax took 186.387 ms, out of which Lap took 176.564 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 316.669 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149484, int_b + int_rho = 5.457e-13, checking this took 0.191 ms
2-norm of RHS = 795.3797060984498, which took 0.225 ms

iter_count = 264, r_2norm = 7.001e-04, tol*||rhs|| = 7.954e-04

Anderson update took 129.496 ms, out of which F'*F took 74.834 ms; b-Ax took 463.173 ms, out of which Lap took 439.352 ms
Solving Poisson took 763.566 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Total time for convolution: 	 convolve: 5.229275 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 65.995 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Total time for convolution: 	 convolve: 5.233086 
Total time for convolution: 	 convolve: 5.322529 
Total time for convolution: 	 convolve: 5.250291 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.147 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.143 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.643 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.744 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.422 ms

This SCF took 27612.722 ms, scf error = 1.663e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.156798, lowerbound = -1.015919, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1179.704 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 158.705 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.056 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 162.782 ms
rank =  0, finding HY took 21.255 ms
rank =  0, distributing HY into block cyclic form took 17.199 ms
rank =  0, finding Y'*HY took 5.694 ms
Rank 0, Project_Hamiltonian used 206.960 ms
Total time for projection: 206.970 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.156 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.245 ms
    first calculated eigval = -1.014367615020250
    last  calculated eigval = 0.050387746987798
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44929082034353
lambda[   7] =  -0.43549111363563
lambda[   8] =  -0.42357691990717
lambda[   9] =  -0.37412683096674
lambda[  10] =  -0.36436728363139
lambda[  11] =  -0.34661026717210
lambda[  12] =  -0.32846294043376
lambda[  13] =  -0.31862547184342
lambda[  14] =  -0.27905458233310
lambda[  15] =  -0.23312091892864
lambda[  16] =  -0.03436503016364
lambda[  17] =  -0.03313851217641
lambda[  18] =   0.00568204187497
lambda[  19] =   0.01425115432936
lambda[  20] =   0.01907318789483
lambda[  21] =   0.02739724180592
lambda[  22] =   0.03578738518767
lambda[  23] =   0.05038774698780
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 8.272 ms
rank =  0, Distributing orbital back into band + domain format took 15.433 ms
rank = 0, Subspace_Rotation used 23.727 ms

Total time for subspace rotation: 23.732 ms
rank = 0, Efermi =  -0.063323795226 calculate fermi energy took 2.395 ms
rank = 0, --- Calculate rho: sum over local bands took 2.837 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.449 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.585 ms
rank = 0, Calculating density took 1428.014 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.683 ms
rank = 0, D2D took 1.818 ms
rank = 0, Transfering density took 1.820 ms
Etot    =   -54.748814397295
Eband   =   -14.733335516318
E1      =    31.978193204948
E2      =   -13.667814183020
E3      =   -19.080050613512
Exc     =   -16.936105873524
Esc     =   -87.805431007987
Entropy =    -0.000000000947
dE = 1.996e-04, dEband = 1.316e-02
rank = 0, Calculating/Estimating energy took 0.816 ms, Etot = -54.748814397, dEtot = 1.996e-04, dEband = 1.316e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.3297993689424, which took 0.201 ms

iter_count = 114, r_2norm = 3.204e-05, tol*||rhs|| = 5.319e-05

Anderson update took 85.386 ms, out of which F'*F took 32.236 ms; b-Ax took 191.985 ms, out of which Lap took 181.191 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 359.029 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149486, int_b + int_rho = 5.675e-13, checking this took 0.183 ms
2-norm of RHS = 795.6980861091625, which took 0.160 ms

iter_count = 252, r_2norm = 6.254e-04, tol*||rhs|| = 7.957e-04

Anderson update took 125.598 ms, out of which F'*F took 72.765 ms; b-Ax took 429.096 ms, out of which Lap took 406.523 ms
Solving Poisson took 719.773 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Total time for convolution: 	 convolve: 5.208485 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 73.125 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.244805 
Total time for convolution: 	 convolve: 5.294907 
Total time for convolution: 	 convolve: 5.271758 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.134 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.141 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.037 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.435 ms
---Transfer Veff_loc: D2D took 3.704 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.875 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.611 ms

This SCF took 27606.817 ms, scf error = 7.314e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.150388, lowerbound = -1.014368, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1176.540 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 156.831 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.193 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 161.045 ms
rank =  0, finding HY took 21.054 ms
rank =  0, distributing HY into block cyclic form took 17.246 ms
rank =  0, finding Y'*HY took 5.685 ms
Rank 0, Project_Hamiltonian used 205.059 ms
Total time for projection: 205.072 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.113 ms
rank = 0, Solve_Generalized_EigenProblem used 0.271 ms
    first calculated eigval = -1.013081126454291
    last  calculated eigval = 0.042673362269487
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44667909090677
lambda[   7] =  -0.43294625292425
lambda[   8] =  -0.42173240908663
lambda[   9] =  -0.37150236712379
lambda[  10] =  -0.36135995899555
lambda[  11] =  -0.34342636900002
lambda[  12] =  -0.32532089226315
lambda[  13] =  -0.31494244421782
lambda[  14] =  -0.27750740782899
lambda[  15] =  -0.23089691657986
lambda[  16] =  -0.03399751732984
lambda[  17] =  -0.03193086108777
lambda[  18] =   0.00402741593700
lambda[  19] =   0.01411635976110
lambda[  20] =   0.01767589152271
lambda[  21] =   0.02611488443674
lambda[  22] =   0.03499851004741
lambda[  23] =   0.04267336226949
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.308 ms
rank =  0, subspace rotation using ScaLAPACK took 8.288 ms
rank =  0, Distributing orbital back into band + domain format took 15.323 ms
rank = 0, Subspace_Rotation used 23.631 ms

Total time for subspace rotation: 23.635 ms
rank = 0, Efermi =  -0.062835662322 calculate fermi energy took 0.086 ms
rank = 0, --- Calculate rho: sum over local bands took 2.713 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.829 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.566 ms
rank = 0, Calculating density took 1421.820 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.672 ms
rank = 0, D2D took 1.797 ms
rank = 0, Transfering density took 1.799 ms
Etot    =   -54.748113203676
Eband   =   -14.658231961409
E1      =    31.947167664700
E2      =   -13.619023652557
E3      =   -19.097505883648
Exc     =   -16.948147434244
Esc     =   -87.805431007987
Entropy =    -0.000000000942
dE = 6.374e-05, dEband = 6.828e-03
rank = 0, Calculating/Estimating energy took 0.821 ms, Etot = -54.748113204, dEtot = 6.374e-05, dEband = 6.828e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9058483430003, which took 0.272 ms

iter_count = 108, r_2norm = 2.547e-05, tol*||rhs|| = 3.623e-05

Anderson update took 51.891 ms, out of which F'*F took 30.347 ms; b-Ax took 181.625 ms, out of which Lap took 171.603 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 312.402 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149479, int_b + int_rho = 4.948e-13, checking this took 0.180 ms
2-norm of RHS = 795.9802653871546, which took 0.239 ms

iter_count = 252, r_2norm = 6.747e-04, tol*||rhs|| = 7.960e-04

Anderson update took 123.543 ms, out of which F'*F took 71.182 ms; b-Ax took 420.862 ms, out of which Lap took 397.750 ms
Solving Poisson took 712.256 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 5.248683 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 51.952 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.229709 
Total time for convolution: 	 convolve: 5.329050 
Total time for convolution: 	 convolve: 5.234857 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.737 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.523 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
---Transfer Veff_loc: D2D took 3.590 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.881 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.517 ms

This SCF took 27569.065 ms, scf error = 3.851e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.142673, lowerbound = -1.013081, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1176.787 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 186.953 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.115 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 191.091 ms
rank =  0, finding HY took 21.020 ms
rank =  0, distributing HY into block cyclic form took 17.378 ms
rank =  0, finding Y'*HY took 5.669 ms
Rank 0, Project_Hamiltonian used 235.187 ms
Total time for projection: 235.198 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.155 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.106 ms
rank = 0, Solve_Generalized_EigenProblem used 0.264 ms
    first calculated eigval = -1.011962949278713
    last  calculated eigval = 0.038078794793627
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44287080177114
lambda[   7] =  -0.42917006610804
lambda[   8] =  -0.41995515306953
lambda[   9] =  -0.36790733343099
lambda[  10] =  -0.35756307107961
lambda[  11] =  -0.33745323435024
lambda[  12] =  -0.32064358468788
lambda[  13] =  -0.30950441106214
lambda[  14] =  -0.27633505406085
lambda[  15] =  -0.22894376994809
lambda[  16] =  -0.03276642938083
lambda[  17] =  -0.03029608324455
lambda[  18] =   0.00332763006221
lambda[  19] =   0.01686750488429
lambda[  20] =   0.01904969841574
lambda[  21] =   0.02627183009760
lambda[  22] =   0.03505907486542
lambda[  23] =   0.03807879479363
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.295 ms
rank =  0, subspace rotation using ScaLAPACK took 8.187 ms
rank =  0, Distributing orbital back into band + domain format took 15.412 ms
rank = 0, Subspace_Rotation used 23.617 ms

Total time for subspace rotation: 23.621 ms
rank = 0, Efermi =  -0.061574193152 calculate fermi energy took 0.085 ms
rank = 0, --- Calculate rho: sum over local bands took 2.721 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.817 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.563 ms
rank = 0, Calculating density took 1452.152 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.666 ms
rank = 0, D2D took 1.797 ms
rank = 0, Transfering density took 1.799 ms
Etot    =   -54.747464760824
Eband   =   -14.554541831332
E1      =    31.895824778282
E2      =   -13.561885618197
E3      =   -19.116526090328
Exc     =   -16.961728407373
Esc     =   -87.805431007987
Entropy =    -0.000000000939
dE = 5.895e-05, dEband = 9.426e-03
rank = 0, Calculating/Estimating energy took 0.848 ms, Etot = -54.747464761, dEtot = 5.895e-05, dEband = 9.426e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4037967996375, which took 0.284 ms

iter_count = 108, r_2norm = 1.594e-05, tol*||rhs|| = 1.615e-05

Anderson update took 52.373 ms, out of which F'*F took 30.614 ms; b-Ax took 182.107 ms, out of which Lap took 172.136 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 312.514 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149476, int_b + int_rho = 4.620e-13, checking this took 0.207 ms
2-norm of RHS = 796.0698552277864, which took 0.068 ms

iter_count = 228, r_2norm = 7.876e-04, tol*||rhs|| = 7.961e-04

Anderson update took 112.054 ms, out of which F'*F took 65.405 ms; b-Ax took 385.018 ms, out of which Lap took 364.177 ms
Solving Poisson took 649.314 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Total time for convolution: 	 convolve: 5.255826 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 66.515 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.245853 
Total time for convolution: 	 convolve: 5.266221 
Total time for convolution: 	 convolve: 5.227893 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.715 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.504 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.174 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.141 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
---Transfer Veff_loc: D2D took 3.582 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.903 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.517 ms

This SCF took 27516.376 ms, scf error = 1.957e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.138079, lowerbound = -1.011963, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1176.310 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 166.173 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.205 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 170.396 ms
rank =  0, finding HY took 21.020 ms
rank =  0, distributing HY into block cyclic form took 17.182 ms
rank =  0, finding Y'*HY took 5.742 ms
Rank 0, Project_Hamiltonian used 214.371 ms
Total time for projection: 214.381 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.121 ms
rank = 0, Solve_Generalized_EigenProblem used 0.278 ms
    first calculated eigval = -1.011828783318703
    last  calculated eigval = 0.038723790755395
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44126578609730
lambda[   7] =  -0.42765884167609
lambda[   8] =  -0.41934999444725
lambda[   9] =  -0.36649028673385
lambda[  10] =  -0.35620250793315
lambda[  11] =  -0.33506753074780
lambda[  12] =  -0.31860375049071
lambda[  13] =  -0.30721181675941
lambda[  14] =  -0.27611472243046
lambda[  15] =  -0.22794907648810
lambda[  16] =  -0.03167866882300
lambda[  17] =  -0.02937658208897
lambda[  18] =   0.00346502036245
lambda[  19] =   0.01913258611530
lambda[  20] =   0.02079374751589
lambda[  21] =   0.02688898678458
lambda[  22] =   0.03027456513041
lambda[  23] =   0.03872379075540
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.313 ms
rank =  0, subspace rotation using ScaLAPACK took 8.218 ms
rank =  0, Distributing orbital back into band + domain format took 15.273 ms
rank = 0, Subspace_Rotation used 23.509 ms

Total time for subspace rotation: 23.513 ms
rank = 0, Efermi =  -0.060497540111 calculate fermi energy took 0.100 ms
rank = 0, --- Calculate rho: sum over local bands took 2.696 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.756 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.576 ms
rank = 0, Calculating density took 1430.713 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.759 ms
rank = 0, D2D took 1.906 ms
rank = 0, Transfering density took 1.910 ms
Etot    =   -54.747273478243
Eband   =   -14.514176398933
E1      =    31.877749785988
E2      =   -13.538599517540
E3      =   -19.120074094547
Exc     =   -16.964089468458
Esc     =   -87.805431007987
Entropy =    -0.000000000940
dE = 1.739e-05, dEband = 3.670e-03
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -54.747273478, dEtot = 1.739e-05, dEband = 3.670e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2301274269060, which took 0.237 ms

iter_count = 108, r_2norm = 8.662e-06, tol*||rhs|| = 9.205e-06

Anderson update took 52.970 ms, out of which F'*F took 30.082 ms; b-Ax took 179.947 ms, out of which Lap took 170.128 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.213 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149491, int_b + int_rho = 6.185e-13, checking this took 0.191 ms
2-norm of RHS = 796.0255351843223, which took 0.222 ms

iter_count = 228, r_2norm = 7.455e-04, tol*||rhs|| = 7.960e-04

Anderson update took 115.005 ms, out of which F'*F took 63.793 ms; b-Ax took 379.366 ms, out of which Lap took 358.524 ms
Solving Poisson took 646.479 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Total time for convolution: 	 convolve: 5.225109 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 77.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.294753 
Total time for convolution: 	 convolve: 5.207265 
Total time for convolution: 	 convolve: 5.233522 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.507 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.189 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
---Transfer Veff_loc: D2D took 3.592 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.882 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.506 ms

This SCF took 27440.404 ms, scf error = 1.271e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.138724, lowerbound = -1.011829, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1175.277 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 163.787 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.134 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 167.940 ms
rank =  0, finding HY took 21.005 ms
rank =  0, distributing HY into block cyclic form took 17.372 ms
rank =  0, finding Y'*HY took 5.546 ms
Rank 0, Project_Hamiltonian used 211.892 ms
Total time for projection: 211.904 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.155 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.117 ms
rank = 0, Solve_Generalized_EigenProblem used 0.275 ms
    first calculated eigval = -1.011407293872961
    last  calculated eigval = 0.038705900915579
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43969844312459
lambda[   7] =  -0.42613783876240
lambda[   8] =  -0.41858063265001
lambda[   9] =  -0.36495728579106
lambda[  10] =  -0.35473566166751
lambda[  11] =  -0.33282298452688
lambda[  12] =  -0.31642001321269
lambda[  13] =  -0.30480810792202
lambda[  14] =  -0.27564845278365
lambda[  15] =  -0.22702143510861
lambda[  16] =  -0.02968773639844
lambda[  17] =  -0.02834475802074
lambda[  18] =   0.00544908964738
lambda[  19] =   0.02085957492365
lambda[  20] =   0.02410742687926
lambda[  21] =   0.02817851775149
lambda[  22] =   0.02879501884648
lambda[  23] =   0.03870590091558
==subpsace eigenproblem: bcast eigvals took 0.057 ms
Total time for solving subspace eigenvalue problem: 0.339 ms
rank =  0, subspace rotation using ScaLAPACK took 8.231 ms
rank =  0, Distributing orbital back into band + domain format took 15.421 ms
rank = 0, Subspace_Rotation used 23.670 ms

Total time for subspace rotation: 23.698 ms
rank = 0, Efermi =  -0.058623593167 calculate fermi energy took 0.081 ms
rank = 0, --- Calculate rho: sum over local bands took 2.820 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.867 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.558 ms
rank = 0, Calculating density took 1428.617 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.658 ms
rank = 0, D2D took 1.789 ms
rank = 0, Transfering density took 1.797 ms
Etot    =   -54.747280417802
Eband   =   -14.471377658819
E1      =    31.854712969924
E2      =   -13.517711170841
E3      =   -19.124767203963
Exc     =   -16.967663094777
Esc     =   -87.805431007987
Entropy =    -0.000000000947
dE = 6.309e-07, dEband = 3.891e-03
rank = 0, Calculating/Estimating energy took 0.999 ms, Etot = -54.747280418, dEtot = 6.309e-07, dEband = 3.891e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1302375213256, which took 0.128 ms

iter_count = 114, r_2norm = 3.542e-06, tol*||rhs|| = 5.210e-06

Anderson update took 57.895 ms, out of which F'*F took 31.875 ms; b-Ax took 188.183 ms, out of which Lap took 177.870 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 327.600 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149477, int_b + int_rho = 4.802e-13, checking this took 0.205 ms
2-norm of RHS = 796.0101781475090, which took 0.224 ms

iter_count = 204, r_2norm = 6.410e-04, tol*||rhs|| = 7.960e-04

Anderson update took 103.891 ms, out of which F'*F took 83.683 ms; b-Ax took 364.844 ms, out of which Lap took 346.118 ms
Solving Poisson took 605.400 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.217416 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 61.633 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.309819 
Total time for convolution: 	 convolve: 5.212321 
Total time for convolution: 	 convolve: 5.260766 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.136 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.174 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
---Transfer Veff_loc: D2D took 3.597 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.878 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.509 ms

This SCF took 27477.670 ms, scf error = 6.639e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.138706, lowerbound = -1.011407, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1178.250 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 166.151 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.039 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 170.210 ms
rank =  0, finding HY took 21.191 ms
rank =  0, distributing HY into block cyclic form took 17.224 ms
rank =  0, finding Y'*HY took 5.627 ms
Rank 0, Project_Hamiltonian used 214.278 ms
Total time for projection: 214.289 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.152 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.113 ms
rank = 0, Solve_Generalized_EigenProblem used 0.269 ms
    first calculated eigval = -1.011156997910795
    last  calculated eigval = 0.038391071550810
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43922770179089
lambda[   7] =  -0.42564858697803
lambda[   8] =  -0.41830374499987
lambda[   9] =  -0.36446119312396
lambda[  10] =  -0.35430383081499
lambda[  11] =  -0.33218537058381
lambda[  12] =  -0.31579617077436
lambda[  13] =  -0.30412164761239
lambda[  14] =  -0.27539135022149
lambda[  15] =  -0.22667480601119
lambda[  16] =  -0.02848255889412
lambda[  17] =  -0.02794995065240
lambda[  18] =   0.00712462970944
lambda[  19] =   0.02046640651951
lambda[  20] =   0.02568310356567
lambda[  21] =   0.02693529101125
lambda[  22] =   0.02860709346999
lambda[  23] =   0.03839107155081
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.304 ms
rank =  0, subspace rotation using ScaLAPACK took 8.281 ms
rank =  0, Distributing orbital back into band + domain format took 15.712 ms
rank = 0, Subspace_Rotation used 24.015 ms

Total time for subspace rotation: 24.020 ms
rank = 0, Efermi =  -0.057634866690 calculate fermi energy took 0.091 ms
rank = 0, --- Calculate rho: sum over local bands took 2.736 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.575 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.566 ms
rank = 0, Calculating density took 1432.935 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.681 ms
rank = 0, D2D took 1.814 ms
rank = 0, Transfering density took 1.820 ms
Etot    =   -54.747377063579
Eband   =   -14.457735607542
E1      =    31.848095919874
E2      =   -13.510634404587
E3      =   -19.124795023057
Exc     =   -16.967735794617
Esc     =   -87.805431007987
Entropy =    -0.000000000952
dE = 8.786e-06, dEband = 1.240e-03
rank = 0, Calculating/Estimating energy took 0.822 ms, Etot = -54.747377064, dEtot = 8.786e-06, dEband = 1.240e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0763102329172, which took 0.252 ms

iter_count = 114, r_2norm = 2.085e-06, tol*||rhs|| = 3.052e-06

Anderson update took 55.442 ms, out of which F'*F took 31.849 ms; b-Ax took 189.172 ms, out of which Lap took 178.793 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 326.845 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149471, int_b + int_rho = 4.184e-13, checking this took 0.192 ms
2-norm of RHS = 796.0261992240125, which took 0.219 ms

iter_count = 198, r_2norm = 6.851e-04, tol*||rhs|| = 7.960e-04

Anderson update took 102.001 ms, out of which F'*F took 55.097 ms; b-Ax took 326.521 ms, out of which Lap took 308.428 ms
Solving Poisson took 561.288 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.198 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Total time for convolution: 	 convolve: 5.235779 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 53.707 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.278472 
Total time for convolution: 	 convolve: 5.244387 
Total time for convolution: 	 convolve: 5.232961 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.143 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 3.567 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.095 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.693 ms

This SCF took 27400.796 ms, scf error = 4.823e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.138391, lowerbound = -1.011157, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1176.381 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 164.760 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.237 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 169.015 ms
rank =  0, finding HY took 21.019 ms
rank =  0, distributing HY into block cyclic form took 17.096 ms
rank =  0, finding Y'*HY took 5.812 ms
Rank 0, Project_Hamiltonian used 212.975 ms
Total time for projection: 212.990 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.126 ms
rank = 0, Solve_Generalized_EigenProblem used 0.283 ms
    first calculated eigval = -1.010709483017272
    last  calculated eigval = 0.038545050479780
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43850961115542
lambda[   7] =  -0.42491742819218
lambda[   8] =  -0.41787219961753
lambda[   9] =  -0.36377190808468
lambda[  10] =  -0.35371662568010
lambda[  11] =  -0.33127983274256
lambda[  12] =  -0.31498243623517
lambda[  13] =  -0.30321594559407
lambda[  14] =  -0.27497725655250
lambda[  15] =  -0.22613722526324
lambda[  16] =  -0.02738440363849
lambda[  17] =  -0.02661369721201
lambda[  18] =   0.00960383951863
lambda[  19] =   0.02121752361155
lambda[  20] =   0.02649221167617
lambda[  21] =   0.02683113417745
lambda[  22] =   0.02936818561654
lambda[  23] =   0.03854505047978
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.319 ms
rank =  0, subspace rotation using ScaLAPACK took 8.264 ms
rank =  0, Distributing orbital back into band + domain format took 15.296 ms
rank = 0, Subspace_Rotation used 23.577 ms

Total time for subspace rotation: 23.582 ms
rank = 0, Efermi =  -0.056458197250 calculate fermi energy took 0.093 ms
rank = 0, --- Calculate rho: sum over local bands took 2.701 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.908 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.596 ms
rank = 0, Calculating density took 1429.652 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.656 ms
rank = 0, D2D took 1.779 ms
rank = 0, Transfering density took 1.781 ms
Etot    =   -54.747475501071
Eband   =   -14.437841710540
E1      =    31.838051585615
E2      =   -13.500343356820
E3      =   -19.126491083495
Exc     =   -16.969088807524
Esc     =   -87.805431007987
Entropy =    -0.000000000950
dE = 8.949e-06, dEband = 1.809e-03
rank = 0, Calculating/Estimating energy took 0.898 ms, Etot = -54.747475501, dEtot = 8.949e-06, dEband = 1.809e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0622450550890, which took 0.146 ms

iter_count = 114, r_2norm = 1.588e-06, tol*||rhs|| = 2.490e-06

Anderson update took 57.242 ms, out of which F'*F took 32.079 ms; b-Ax took 190.119 ms, out of which Lap took 179.894 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.922 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149473, int_b + int_rho = 4.366e-13, checking this took 0.188 ms
2-norm of RHS = 796.0316179242269, which took 0.208 ms

iter_count = 168, r_2norm = 6.708e-04, tol*||rhs|| = 7.960e-04

Anderson update took 84.091 ms, out of which F'*F took 47.259 ms; b-Ax took 279.411 ms, out of which Lap took 264.153 ms
Solving Poisson took 477.190 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.158 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 5.242071 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 47.892 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.410 ms
Total time for convolution: 	 convolve: 5.241543 
Total time for convolution: 	 convolve: 5.208698 
Total time for convolution: 	 convolve: 5.199010 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.510 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.147 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.147 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 3.603 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.883 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.517 ms

This SCF took 27196.435 ms, scf error = 3.024e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.138545, lowerbound = -1.010709, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1175.340 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 194.807 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.094 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 198.922 ms
rank =  0, finding HY took 21.086 ms
rank =  0, distributing HY into block cyclic form took 17.134 ms
rank =  0, finding Y'*HY took 5.744 ms
Rank 0, Project_Hamiltonian used 242.917 ms
Total time for projection: 242.952 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.151 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.867 ms
rank = 0, Solve_Generalized_EigenProblem used 1.021 ms
    first calculated eigval = -1.010307609738001
    last  calculated eigval = 0.037310958598142
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43807356541325
lambda[   7] =  -0.42449604079373
lambda[   8] =  -0.41747658521253
lambda[   9] =  -0.36337014736109
lambda[  10] =  -0.35332827505227
lambda[  11] =  -0.33084027262198
lambda[  12] =  -0.31457670653634
lambda[  13] =  -0.30280509341830
lambda[  14] =  -0.27458992546119
lambda[  15] =  -0.22571448544658
lambda[  16] =  -0.02700540203812
lambda[  17] =  -0.02611103051958
lambda[  18] =   0.01004485902110
lambda[  19] =   0.02088298941020
lambda[  20] =   0.02606766493509
lambda[  21] =   0.02626722869046
lambda[  22] =   0.02910694004797
lambda[  23] =   0.03731095859814
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 1.052 ms
rank =  0, subspace rotation using ScaLAPACK took 8.269 ms
rank =  0, Distributing orbital back into band + domain format took 15.284 ms
rank = 0, Subspace_Rotation used 23.568 ms

Total time for subspace rotation: 23.572 ms
rank = 0, Efermi =  -0.056043655744 calculate fermi energy took 0.091 ms
rank = 0, --- Calculate rho: sum over local bands took 2.705 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.754 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.583 ms
rank = 0, Calculating density took 1459.118 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.667 ms
rank = 0, D2D took 1.803 ms
rank = 0, Transfering density took 1.805 ms
Etot    =   -54.747543749214
Eband   =   -14.425431746400
E1      =    31.831388088978
E2      =   -13.494261115524
E3      =   -19.127715413087
Exc     =   -16.970045611466
Esc     =   -87.805431007987
Entropy =    -0.000000000950
dE = 6.204e-06, dEband = 1.128e-03
rank = 0, Calculating/Estimating energy took 0.831 ms, Etot = -54.747543749, dEtot = 6.204e-06, dEband = 1.128e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0522687217127, which took 0.245 ms

iter_count = 108, r_2norm = 2.023e-06, tol*||rhs|| = 2.091e-06

Anderson update took 52.974 ms, out of which F'*F took 30.222 ms; b-Ax took 180.010 ms, out of which Lap took 170.145 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 310.801 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149474, int_b + int_rho = 4.475e-13, checking this took 0.194 ms
2-norm of RHS = 796.0372895623233, which took 0.202 ms

iter_count = 150, r_2norm = 7.383e-04, tol*||rhs|| = 7.960e-04

Anderson update took 76.645 ms, out of which F'*F took 42.008 ms; b-Ax took 247.904 ms, out of which Lap took 234.463 ms
Solving Poisson took 423.390 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Total time for convolution: 	 convolve: 5.251288 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 73.662 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.225618 
Total time for convolution: 	 convolve: 5.203536 
Total time for convolution: 	 convolve: 5.229259 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.507 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.142 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.193 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.605 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.866 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.503 ms

This SCF took 27173.644 ms, scf error = 2.223e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.137311, lowerbound = -1.010308, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1173.797 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 174.139 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.055 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 178.208 ms
rank =  0, finding HY took 20.997 ms
rank =  0, distributing HY into block cyclic form took 17.162 ms
rank =  0, finding Y'*HY took 5.761 ms
Rank 0, Project_Hamiltonian used 222.174 ms
Total time for projection: 222.193 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.153 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.106 ms
rank = 0, Solve_Generalized_EigenProblem used 0.262 ms
    first calculated eigval = -1.010020590813201
    last  calculated eigval = 0.037613625229448
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43783050326183
lambda[   7] =  -0.42425584633078
lambda[   8] =  -0.41721736774284
lambda[   9] =  -0.36314028896215
lambda[  10] =  -0.35310371913448
lambda[  11] =  -0.33064409726834
lambda[  12] =  -0.31437432087627
lambda[  13] =  -0.30261103681889
lambda[  14] =  -0.27432475500554
lambda[  15] =  -0.22545362712579
lambda[  16] =  -0.02673511024293
lambda[  17] =  -0.02527699999680
lambda[  18] =   0.01078300075949
lambda[  19] =   0.02144570122570
lambda[  20] =   0.02649173008471
lambda[  21] =   0.02662953977010
lambda[  22] =   0.02942606386556
lambda[  23] =   0.03761362522945
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.288 ms
rank =  0, subspace rotation using ScaLAPACK took 8.113 ms
rank =  0, Distributing orbital back into band + domain format took 15.324 ms
rank = 0, Subspace_Rotation used 23.447 ms

Total time for subspace rotation: 23.451 ms
rank = 0, Efermi =  -0.055650570791 calculate fermi energy took 0.069 ms
rank = 0, --- Calculate rho: sum over local bands took 2.740 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.549 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 1435.757 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.648 ms
rank = 0, D2D took 1.787 ms
rank = 0, Transfering density took 1.792 ms
Etot    =   -54.747569198206
Eband   =   -14.418314227348
E1      =    31.827880964976
E2      =   -13.490511033589
E3      =   -19.128191708085
Exc     =   -16.970407668575
Esc     =   -87.805431007987
Entropy =    -0.000000000946
dE = 2.314e-06, dEband = 6.470e-04
rank = 0, Calculating/Estimating energy took 0.811 ms, Etot = -54.747569198, dEtot = 2.314e-06, dEband = 6.470e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0355793979674, which took 0.224 ms

iter_count = 114, r_2norm = 9.510e-07, tol*||rhs|| = 1.423e-06

Anderson update took 55.579 ms, out of which F'*F took 31.672 ms; b-Ax took 189.613 ms, out of which Lap took 179.177 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 325.321 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149476, int_b + int_rho = 4.657e-13, checking this took 0.196 ms
2-norm of RHS = 796.0452729089136, which took 0.221 ms

iter_count = 156, r_2norm = 7.314e-04, tol*||rhs|| = 7.960e-04

Anderson update took 78.297 ms, out of which F'*F took 43.807 ms; b-Ax took 259.687 ms, out of which Lap took 245.664 ms
Solving Poisson took 441.285 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 6.523707 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.232960 
Total time for convolution: 	 convolve: 5.222404 
Total time for convolution: 	 convolve: 5.200049 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.526 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.137 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.155 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.630 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.919 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.593 ms

This SCF took 28378.752 ms, scf error = 1.737e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.137614, lowerbound = -1.010021, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1176.595 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 154.598 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.838 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 158.454 ms
rank =  0, finding HY took 21.023 ms
rank =  0, distributing HY into block cyclic form took 17.114 ms
rank =  0, finding Y'*HY took 5.678 ms
Rank 0, Project_Hamiltonian used 202.300 ms
Total time for projection: 202.312 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.151 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.112 ms
rank = 0, Solve_Generalized_EigenProblem used 0.266 ms
    first calculated eigval = -1.009679181103756
    last  calculated eigval = 0.038409546071219
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43754553041270
lambda[   7] =  -0.42397243676774
lambda[   8] =  -0.41690641186198
lambda[   9] =  -0.36286844712259
lambda[  10] =  -0.35283671029947
lambda[  11] =  -0.33042077146301
lambda[  12] =  -0.31413818481388
lambda[  13] =  -0.30238499565793
lambda[  14] =  -0.27400704394482
lambda[  15] =  -0.22514268853832
lambda[  16] =  -0.02640863462759
lambda[  17] =  -0.02425884667374
lambda[  18] =   0.01151597339913
lambda[  19] =   0.02211045603241
lambda[  20] =   0.02707766222043
lambda[  21] =   0.02735488891804
lambda[  22] =   0.03026869787015
lambda[  23] =   0.03840954607122
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.290 ms
rank =  0, subspace rotation using ScaLAPACK took 8.069 ms
rank =  0, Distributing orbital back into band + domain format took 15.164 ms
rank = 0, Subspace_Rotation used 23.242 ms

Total time for subspace rotation: 23.247 ms
rank = 0, Efermi =  -0.055239425749 calculate fermi energy took 0.083 ms
rank = 0, --- Calculate rho: sum over local bands took 2.701 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.699 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 1418.573 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.636 ms
rank = 0, D2D took 1.777 ms
rank = 0, Transfering density took 1.779 ms
Etot    =   -54.747593637362
Eband   =   -14.409924428879
E1      =    31.823917194091
E2      =   -13.485948070886
E3      =   -19.128631417895
Exc     =   -16.970734882426
Esc     =   -87.805431007987
Entropy =    -0.000000000941
dE = 2.222e-06, dEband = 7.627e-04
rank = 0, Calculating/Estimating energy took 0.806 ms, Etot = -54.747593637, dEtot = 2.222e-06, dEband = 7.627e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0229124508410, which took 0.213 ms

iter_count = 108, r_2norm = 9.058e-07, tol*||rhs|| = 9.165e-07

Anderson update took 52.396 ms, out of which F'*F took 30.043 ms; b-Ax took 179.653 ms, out of which Lap took 169.730 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 308.963 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149473, int_b + int_rho = 4.366e-13, checking this took 0.193 ms
2-norm of RHS = 796.0464567804079, which took 1.035 ms

iter_count = 156, r_2norm = 6.971e-04, tol*||rhs|| = 7.960e-04

Anderson update took 77.770 ms, out of which F'*F took 45.060 ms; b-Ax took 258.889 ms, out of which Lap took 244.772 ms
Solving Poisson took 441.860 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.195 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Total time for convolution: 	 convolve: 5.248158 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 60.910 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.225533 
Total time for convolution: 	 convolve: 5.199390 
Total time for convolution: 	 convolve: 5.228027 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.511 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.136 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.136 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 3.723 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.036 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.788 ms

This SCF took 27147.224 ms, scf error = 1.265e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.138410, lowerbound = -1.009679, upperbound = 267.581198

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1179.838 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 167.102 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.143 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 171.257 ms
rank =  0, finding HY took 20.993 ms
rank =  0, distributing HY into block cyclic form took 17.234 ms
rank =  0, finding Y'*HY took 5.766 ms
Rank 0, Project_Hamiltonian used 215.272 ms
Total time for projection: 215.283 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.153 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.114 ms
rank = 0, Solve_Generalized_EigenProblem used 0.270 ms
    first calculated eigval = -1.009412581937865
    last  calculated eigval = 0.039925646544199
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.43731927827734
lambda[   7] =  -0.42374286470342
lambda[   8] =  -0.41664924766051
lambda[   9] =  -0.36264405848234
lambda[  10] =  -0.35261093685460
lambda[  11] =  -0.33022982394757
lambda[  12] =  -0.31394078086828
lambda[  13] =  -0.30219007310125
lambda[  14] =  -0.27374595852442
lambda[  15] =  -0.22489519054762
lambda[  16] =  -0.02616489307603
lambda[  17] =  -0.02365929689355
lambda[  18] =   0.01169686779173
lambda[  19] =   0.02233986816370
lambda[  20] =   0.02782117297743
lambda[  21] =   0.02784244823001
lambda[  22] =   0.03145228952560
lambda[  23] =   0.03992564654420
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.303 ms
rank =  0, subspace rotation using ScaLAPACK took 8.128 ms
rank =  0, Distributing orbital back into band + domain format took 15.211 ms
rank = 0, Subspace_Rotation used 23.347 ms

Total time for subspace rotation: 23.351 ms
rank = 0, Efermi =  -0.054970574301 calculate fermi energy took 0.080 ms
rank = 0, --- Calculate rho: sum over local bands took 2.708 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.606 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1434.805 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.631 ms
rank = 0, D2D took 1.779 ms
rank = 0, Transfering density took 1.781 ms
Etot    =   -54.747617130137
Eband   =   -14.403061160437
E1      =    31.820645975431
E2      =   -13.482288602248
E3      =   -19.128844491528
Exc     =   -16.970904029981
Esc     =   -87.805431007987
Entropy =    -0.000000000939
dE = 2.136e-06, dEband = 6.239e-04
rank = 0, Calculating/Estimating energy took 0.803 ms, Etot = -54.747617130, dEtot = 2.136e-06, dEband = 6.239e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0196116278695, which took 0.249 ms

iter_count = 114, r_2norm = 5.140e-07, tol*||rhs|| = 7.845e-07

Anderson update took 66.550 ms, out of which F'*F took 32.153 ms; b-Ax took 206.152 ms, out of which Lap took 188.273 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 407.973 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003149430, int_rho =  30.00000003149479, int_b + int_rho = 4.948e-13, checking this took 0.245 ms
2-norm of RHS = 796.0461920558996, which took 0.288 ms

iter_count = 102, r_2norm = 7.473e-04, tol*||rhs|| = 7.960e-04

Anderson update took 59.089 ms, out of which F'*F took 27.773 ms; b-Ax took 186.080 ms, out of which Lap took 169.060 ms
Solving Poisson took 366.558 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.220304 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 83.144 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.241883 
Total time for convolution: 	 convolve: 5.214636 
Total time for convolution: 	 convolve: 5.223073 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.520 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.136 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.157 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.108 ms
---Transfer Veff_loc: D2D took 3.651 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.943 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.623 ms

This SCF took 27220.453 ms, scf error = 8.668e-05
The last 18 occupations of kpoints #1 are (Nelectron = 30):
lambda[   6] =  -0.43731927827734, occ[   6] =   2.00000000000000
lambda[   7] =  -0.42374286470342, occ[   7] =   2.00000000000000
lambda[   8] =  -0.41664924766051, occ[   8] =   2.00000000000000
lambda[   9] =  -0.36264405848234, occ[   9] =   2.00000000000000
lambda[  10] =  -0.35261093685460, occ[  10] =   2.00000000000000
lambda[  11] =  -0.33022982394757, occ[  11] =   2.00000000000000
lambda[  12] =  -0.31394078086828, occ[  12] =   2.00000000000000
lambda[  13] =  -0.30219007310125, occ[  13] =   2.00000000000000
lambda[  14] =  -0.27374595852442, occ[  14] =   2.00000000000000
lambda[  15] =  -0.22489519054762, occ[  15] =   2.00000000000000
lambda[  16] =  -0.02616489307603, occ[  16] =   0.00000002980070
lambda[  17] =  -0.02365929689355, occ[  17] =   0.00000000169409
lambda[  18] =   0.01169686779173, occ[  18] =   0.00000000000000
lambda[  19] =   0.02233986816370, occ[  19] =   0.00000000000000
lambda[  20] =   0.02782117297743, occ[  20] =   0.00000000000000
lambda[  21] =   0.02784244823001, occ[  21] =   0.00000000000000
lambda[  22] =   0.03145228952560, occ[  22] =   0.00000000000000
lambda[  23] =   0.03992564654420, occ[  23] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 21 (90%) = 0.000000000000000.
Occupation of state 23 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.639 ms, time for Allreduce/Reduce: 12.668 ms 
Time for calculating local force components: 25.556 ms
Start Calculating nonlocal forces
force_nloc = 
  1.03372760007939   0.14429399742265   0.00000059954882
 -1.19043584652664  -0.21896743051627  -0.00000000566363
  0.02999983728115   0.00337621414568  -0.03954391783118
  0.02999984254419   0.00337621214828   0.03954392915370
  0.02084116247808   0.04484397584110   0.00000000050908
 -0.02981853994827  -0.00366302712300   0.04007222038036
 -0.02981855759265  -0.00366301618561  -0.04007223674652
 -0.03523515408309  -0.06519030781674  -0.00000000158588
 -0.01494362043662   0.18003098288199  -0.00000009086939
  0.01484005989529   0.04714603908016   0.00000021756457
 -0.03660809540876   0.02030241074118  -0.00000045768696
force_loc = 
 -1.01088371131829  -0.13609490067484   0.00000185444072
  1.16966461159716   0.21732476185045  -0.00000365099905
 -0.03272245214033  -0.00402625783114   0.04158454428626
 -0.03272238091507  -0.00402623008504  -0.04158480200231
 -0.02173544463654  -0.04759739276677   0.00000003849323
  0.03167873787281   0.00311400523070  -0.04204005258863
  0.03167891791846   0.00311341363293   0.04204018673435
  0.03625782022474   0.06966054381775  -0.00000000133663
  0.00264992561955  -0.17972764800641  -0.00000056168778
 -0.00916992595696  -0.04723839230790   0.00000102827581
  0.03236193282790  -0.01854900103509  -0.00000168271799
Time for calculating nonlocal force components: 44.544 ms
[32mforces_xc: 
[0m[32m -0.02893960235234  -0.00506425262273   0.00000018006584
[0m[32m  0.02814783012026   0.00462728156112  -0.00000009508064
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.01102268847496  -0.00508408010083   0.00000000930867
[0m[32m -0.00209637687406  -0.00071383967895   0.00000009694959
[0m[32m  0.00244044625886  -0.00174644224270  -0.00000011595637
[0mTime for calculating XC forces components: 37.428 ms
 Cartesian force = 
 -0.00611223222790   0.00314778781963   0.00000288560465
  0.00736007655412   0.00299755658984  -0.00000350019405
 -0.00273913349584  -0.00063709999091   0.00204087800436
 -0.00273905700753  -0.00063707424221  -0.00204062129934
 -0.00091080079510  -0.00274047323112   0.00000029055158
  0.00184367928789  -0.00053607819775  -0.00196758065900
  0.00184384168915  -0.00053665885814   0.00196820153710
  0.00100614750500   0.00448317969556   0.00000024862676
 -0.00128752497876  -0.00476780153070  -0.00000039169923
  0.00355723842762  -0.00079324921214   0.00000159433924
 -0.00182223495865   0.00001991115794  -0.00000200481204
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.407 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Time for printing density: 412.018 ms
The program took 447.681 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:37
Job ID:        2266757
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:31:24,vmem=8288K,walltime=00:07:37,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-008-22-2
---------------------------------------
