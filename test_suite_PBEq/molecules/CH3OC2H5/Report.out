---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:38
Job ID:    2266725
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:43
Job ID:    2266725
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.016 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 29.479 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 12.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 8.783 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 110.651 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.981 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.086 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.087474	   11.309953	   10.000000	
   12.454514	   14.320950	   10.000000	
   13.623682	   11.651627	   11.682242	
   13.623682	   11.651627	    8.317758	
   11.083410	    7.923583	    8.325659	
   11.083410	    7.923583	   11.674341	
    7.275999	    5.679050	   10.000000	
    6.376318	    8.440327	   11.672578	
    6.376318	    8.440327	    8.327422	
   12.577071	   12.266391	   10.000000	
   10.078707	    8.634339	   10.000000	
    7.357377	    7.740762	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.170 ms
Set up communicators.

--set up spincomm took 3.785 ms

--set up kptcomm took 0.365 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.007 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.051 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.446 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.967 ms

Calculate_SplineDerivRadFun took 0.217 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.270 ms.
time spent on vectorized spline interp: 3.230 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.017 ms.
time spent on vectorized spline interp: 1.423 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.336 ms.
time spent on vectorized spline interp: 1.810 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.336 ms.

Calculating rb for all atom types took 16.433 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.058 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000338395, sum_int_rho = 25.2042138289308
PosCharge = 26.000000033839, NegCharge = -25.204213828931, scal_fac = 1.031573538072
After scaling, int_rho = 26.0000000338396, PosCharge + NegCharge - NetCharge = -1.030e-13
--Calculate Vref took 0.557 ms
--Calculate rho_guess took 3.089 ms

 integral of b = -26.0000000338395,
 int{b} + Nelectron + NetCharge = -3.384e-08,
 Esc = -66.6979173508425,
 MPI_Reduce took 11.688 ms

Calculating b & b_ref took 22.524 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.010 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.020 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.914 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383973, int_b + int_rho = 2.474e-13, checking this took 0.088 ms
2-norm of RHS = 819.4969300255765, which took 0.743 ms

iter_count = 414, r_2norm = 7.887e-04, tol*||rhs|| = 8.195e-04

Anderson update took 260.972 ms, out of which F'*F took 116.719 ms; b-Ax took 786.656 ms, out of which Lap took 701.128 ms
Solving Poisson took 1751.838 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.411 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
Total time for convolution: 	 convolve: 5.120404 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.896 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
Total time for convolution: 	 convolve: 5.121135 
Total time for convolution: 	 convolve: 5.113642 
Total time for convolution: 	 convolve: 5.134228 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.713 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.271 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
rank = 0, XC calculation took 24399.578 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 2.152 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.068 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.302 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.137 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.876 ms
    Lanczos iter 53, eigmin  = -0.951829368, eigmax = 264.934518463, err_eigmin = 2.390e-03, err_eigmax = 9.650e-03
rank =   0, Lanczos took 133.786 ms, eigmin = -0.951829368088, eigmax = 267.583863647898

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.266017, lowerbound = -1.051829, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2071.727 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 23.799 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.042 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 27.896 ms
rank =  0, finding HY took 34.412 ms
rank =  0, distributing HY into block cyclic form took 22.532 ms
rank =  0, finding Y'*HY took 5.878 ms
Rank 0, Project_Hamiltonian used 91.943 ms
Total time for projection: 91.962 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.650 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.736 ms
    first calculated eigval = 2.711315544164594
    last  calculated eigval = 3.223845108437035
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.81935062367035
lambda[   5] =   2.86132940654057
lambda[   6] =   2.89053554476259
lambda[   7] =   2.91869963741881
lambda[   8] =   2.93889430035929
lambda[   9] =   2.95289329631069
lambda[  10] =   2.99130160680623
lambda[  11] =   2.99789685754692
lambda[  12] =   3.03351445148793
lambda[  13] =   3.07264332624565
lambda[  14] =   3.09224670749892
lambda[  15] =   3.10224735693282
lambda[  16] =   3.13565857506501
lambda[  17] =   3.15796079231349
lambda[  18] =   3.17118873086110
lambda[  19] =   3.18944508236290
lambda[  20] =   3.22384510843703
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.755 ms
rank =  0, subspace rotation using ScaLAPACK took 7.297 ms
rank =  0, Distributing orbital back into band + domain format took 20.185 ms
rank = 0, Subspace_Rotation used 27.502 ms

Total time for subspace rotation: 27.508 ms
rank = 0, Efermi =   3.082442346013 calculate fermi energy took 0.076 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.323845, lowerbound = -1.051829, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2035.980 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.014 ms
rank =  0, Distribute orbital to block cyclic format took 28.651 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.153 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 32.847 ms
rank =  0, finding HY took 34.352 ms
rank =  0, distributing HY into block cyclic form took 20.739 ms
rank =  0, finding Y'*HY took 6.007 ms
Rank 0, Project_Hamiltonian used 93.996 ms
Total time for projection: 94.010 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.226 ms
    first calculated eigval = -0.704211029796877
    last  calculated eigval = 0.415107107735064
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.26760815145078
lambda[   5] =  -0.22787531244611
lambda[   6] =  -0.11511388951846
lambda[   7] =  -0.06526818344872
lambda[   8] =   0.03751037261150
lambda[   9] =   0.06017367050989
lambda[  10] =   0.12497913182277
lambda[  11] =   0.20352149335258
lambda[  12] =   0.23820240546008
lambda[  13] =   0.27873576019152
lambda[  14] =   0.33817127274633
lambda[  15] =   0.36576339564433
lambda[  16] =   0.38105550706753
lambda[  17] =   0.39393988483204
lambda[  18] =   0.40138472414381
lambda[  19] =   0.40583626913663
lambda[  20] =   0.41510710773506
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 7.211 ms
rank =  0, Distributing orbital back into band + domain format took 20.062 ms
rank = 0, Subspace_Rotation used 27.292 ms

Total time for subspace rotation: 27.298 ms
rank = 0, Efermi =   0.309559426246 calculate fermi energy took 0.040 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.515107, lowerbound = -1.051829, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2092.539 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 30.126 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.846 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 34.027 ms
rank =  0, finding HY took 34.357 ms
rank =  0, distributing HY into block cyclic form took 20.691 ms
rank =  0, finding Y'*HY took 6.166 ms
Rank 0, Project_Hamiltonian used 95.267 ms
Total time for projection: 95.272 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.166 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.235 ms
    first calculated eigval = -0.973798192852739
    last  calculated eigval = 0.150361913827383
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.63689282904532
lambda[   5] =  -0.50598557185915
lambda[   6] =  -0.50411592784687
lambda[   7] =  -0.47796545960691
lambda[   8] =  -0.45232227928689
lambda[   9] =  -0.43509000153199
lambda[  10] =  -0.39815197019127
lambda[  11] =  -0.39229115471275
lambda[  12] =  -0.31908531470669
lambda[  13] =  -0.17674117023121
lambda[  14] =   0.06971705793573
lambda[  15] =   0.08608067989095
lambda[  16] =   0.09067088975744
lambda[  17] =   0.10434243242159
lambda[  18] =   0.12004118167478
lambda[  19] =   0.12944638940583
lambda[  20] =   0.15036191382738
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 7.205 ms
rank =  0, Distributing orbital back into band + domain format took 20.044 ms
rank = 0, Subspace_Rotation used 27.266 ms

Total time for subspace rotation: 27.271 ms
rank = 0, Efermi =   0.041027222177 calculate fermi energy took 0.037 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.250362, lowerbound = -1.051829, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2101.624 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 20.939 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.216 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 25.198 ms
rank =  0, finding HY took 34.355 ms
rank =  0, distributing HY into block cyclic form took 20.718 ms
rank =  0, finding Y'*HY took 6.023 ms
Rank 0, Project_Hamiltonian used 86.324 ms
Total time for projection: 86.329 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.177 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.259 ms
    first calculated eigval = -0.974174058360522
    last  calculated eigval = 0.098234024938607
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.63900695107573
lambda[   5] =  -0.51066319945403
lambda[   6] =  -0.50977024039933
lambda[   7] =  -0.48335588759650
lambda[   8] =  -0.46355671223943
lambda[   9] =  -0.44533461599424
lambda[  10] =  -0.40998801162194
lambda[  11] =  -0.40576762444460
lambda[  12] =  -0.33141400939395
lambda[  13] =  -0.25027296857475
lambda[  14] =   0.00096677060481
lambda[  15] =   0.03994201288110
lambda[  16] =   0.04790857593114
lambda[  17] =   0.06144367163986
lambda[  18] =   0.07007928700066
lambda[  19] =   0.07496507117120
lambda[  20] =   0.09823402493861
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.268 ms
rank =  0, subspace rotation using ScaLAPACK took 7.229 ms
rank =  0, Distributing orbital back into band + domain format took 20.098 ms
rank = 0, Subspace_Rotation used 28.328 ms

Total time for subspace rotation: 28.335 ms
rank = 0, Efermi =  -0.027723065143 calculate fermi energy took 0.036 ms
rank = 0, --- Calculate rho: sum over local bands took 5.085 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.182 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.420 ms
rank = 0, Calculating density took 8928.408 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.973 ms
rank = 0, D2D took 1.192 ms
rank = 0, Transfering density took 1.205 ms
Etot    =   -39.481955673639
Eband   =   -13.833085189195
E1      =    28.669243747543
E2      =   -10.644361169739
E3      =   -14.657503352759
Exc     =   -12.922061402641
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 3.290e+00, dEband = 1.153e+00
rank = 0, Calculating/Estimating energy took 1.455 ms, Etot = -39.481955674, dEtot = 3.290e+00, dEband = 1.153e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 62.1088510261478, which took 0.052 ms

iter_count = 96, r_2norm = 1.688e-03, tol*||rhs|| = 2.484e-03

Anderson update took 59.949 ms, out of which F'*F took 27.114 ms; b-Ax took 182.083 ms, out of which Lap took 162.536 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 411.554 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383955, int_b + int_rho = 6.548e-14, checking this took 0.138 ms
2-norm of RHS = 815.4080946340730, which took 0.189 ms

iter_count = 282, r_2norm = 7.462e-04, tol*||rhs|| = 8.154e-04

Anderson update took 178.129 ms, out of which F'*F took 81.567 ms; b-Ax took 541.956 ms, out of which Lap took 488.754 ms
Solving Poisson took 1192.331 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.763 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.104428 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.121537 
Total time for convolution: 	 convolve: 5.101174 
Total time for convolution: 	 convolve: 5.167325 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.014 ms
======D2D: initiated sending and receiving took 1.209 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.394 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.267 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.467 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.757 ms

This SCF took 35151.875 ms, scf error = 1.851e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.198234, lowerbound = -0.974174, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2000.266 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.844 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.311 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 25.198 ms
rank =  0, finding HY took 33.673 ms
rank =  0, distributing HY into block cyclic form took 20.710 ms
rank =  0, finding Y'*HY took 6.273 ms
Rank 0, Project_Hamiltonian used 85.881 ms
Total time for projection: 85.895 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.166 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.239 ms
    first calculated eigval = -0.973398812430142
    last  calculated eigval = 0.069256385739969
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61271378571279
lambda[   5] =  -0.49118128560924
lambda[   6] =  -0.48626880140384
lambda[   7] =  -0.45988820496414
lambda[   8] =  -0.43720446401003
lambda[   9] =  -0.41595459928497
lambda[  10] =  -0.38407689598772
lambda[  11] =  -0.37991853553614
lambda[  12] =  -0.32100827202628
lambda[  13] =  -0.24864904852844
lambda[  14] =  -0.02134365495979
lambda[  15] =   0.01623205808299
lambda[  16] =   0.02633940537119
lambda[  17] =   0.03666012752896
lambda[  18] =   0.04257098059640
lambda[  19] =   0.05888931163447
lambda[  20] =   0.06925638573997
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.254 ms
rank =  0, subspace rotation using ScaLAPACK took 7.472 ms
rank =  0, Distributing orbital back into band + domain format took 21.569 ms
rank = 0, Subspace_Rotation used 29.056 ms

Total time for subspace rotation: 29.063 ms
rank = 0, Efermi =  -0.050033490711 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.612 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.951 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.193 ms
rank = 0, Calculating density took 2126.482 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.675 ms
rank = 0, D2D took 0.819 ms
rank = 0, Transfering density took 0.827 ms
Etot    =   -39.428644955492
Eband   =   -13.289406473526
E1      =    28.142887505504
E2      =   -10.649035443537
E3      =   -14.830853430660
Exc     =   -13.064097509824
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 4.443e-03, dEband = 4.531e-02
rank = 0, Calculating/Estimating energy took 1.024 ms, Etot = -39.428644955, dEtot = 4.443e-03, dEband = 4.531e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 19.9533556879971, which took 0.061 ms

iter_count = 102, r_2norm = 5.729e-04, tol*||rhs|| = 7.981e-04

Anderson update took 63.587 ms, out of which F'*F took 28.397 ms; b-Ax took 189.639 ms, out of which Lap took 169.782 ms
rank = 0, Mixing (+ precond) took 433.841 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383962, int_b + int_rho = 1.382e-13, checking this took 0.107 ms
2-norm of RHS = 808.3339090994887, which took 0.176 ms

iter_count = 300, r_2norm = 6.580e-04, tol*||rhs|| = 8.083e-04

Anderson update took 185.869 ms, out of which F'*F took 84.431 ms; b-Ax took 565.707 ms, out of which Lap took 504.532 ms
Solving Poisson took 1249.079 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.100738 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.111979 
Total time for convolution: 	 convolve: 5.113111 
Total time for convolution: 	 convolve: 5.108960 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.104 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.419 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.276 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 1.268 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.463 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.755 ms

This SCF took 28254.572 ms, scf error = 1.276e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.169256, lowerbound = -0.973399, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2831.680 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.470 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 11.758 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 34.249 ms
rank =  0, finding HY took 29.114 ms
rank =  0, distributing HY into block cyclic form took 128.526 ms
rank =  0, finding Y'*HY took 6.619 ms
Rank 0, Project_Hamiltonian used 198.540 ms
Total time for projection: 198.555 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.960411593561233
    last  calculated eigval = 0.058409066467030
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56141285291377
lambda[   5] =  -0.45395378067614
lambda[   6] =  -0.44461333864515
lambda[   7] =  -0.41652941865158
lambda[   8] =  -0.38714804038707
lambda[   9] =  -0.35863154028131
lambda[  10] =  -0.33375908139790
lambda[  11] =  -0.32820611847683
lambda[  12] =  -0.29002935340790
lambda[  13] =  -0.22544024785170
lambda[  14] =  -0.02691124494289
lambda[  15] =   0.01248545180972
lambda[  16] =   0.01915400960565
lambda[  17] =   0.02234097676010
lambda[  18] =   0.03667831978812
lambda[  19] =   0.05434002387277
lambda[  20] =   0.05840906646703
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 7.426 ms
rank =  0, Distributing orbital back into band + domain format took 21.273 ms
rank = 0, Subspace_Rotation used 28.719 ms

Total time for subspace rotation: 28.724 ms
rank = 0, Efermi =  -0.055601080694 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.390 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.666 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.373 ms
rank = 0, Calculating density took 3068.746 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.997 ms
rank = 0, D2D took 1.188 ms
rank = 0, Transfering density took 1.195 ms
Etot    =   -39.378498857976
Eband   =   -12.178750684930
E1      =    27.132054454563
E2      =   -10.521989630363
E3      =   -15.243430414778
Exc     =   -13.399305320906
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 4.179e-03, dEband = 9.255e-02
rank = 0, Calculating/Estimating energy took 1.283 ms, Etot = -39.378498858, dEtot = 4.179e-03, dEband = 9.255e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 8.6439476390975, which took 0.104 ms

iter_count = 102, r_2norm = 2.190e-04, tol*||rhs|| = 3.458e-04

Anderson update took 64.202 ms, out of which F'*F took 28.763 ms; b-Ax took 191.454 ms, out of which Lap took 170.692 ms
rank = 0, Mixing (+ precond) took 438.257 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383956, int_b + int_rho = 8.004e-14, checking this took 0.119 ms
2-norm of RHS = 807.6455747334957, which took 0.189 ms

iter_count = 264, r_2norm = 7.297e-04, tol*||rhs|| = 8.076e-04

Anderson update took 164.464 ms, out of which F'*F took 74.161 ms; b-Ax took 503.335 ms, out of which Lap took 448.130 ms
Solving Poisson took 1107.690 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.095085 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.099392 
Total time for convolution: 	 convolve: 5.099447 
Total time for convolution: 	 convolve: 5.111729 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.394 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 1.297 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.439 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.759 ms

This SCF took 29024.079 ms, scf error = 3.751e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.158409, lowerbound = -0.960412, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1998.059 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 25.887 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.083 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 29.999 ms
rank =  0, finding HY took 32.338 ms
rank =  0, distributing HY into block cyclic form took 20.536 ms
rank =  0, finding Y'*HY took 5.874 ms
Rank 0, Project_Hamiltonian used 88.790 ms
Total time for projection: 88.805 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.610 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.682 ms
    first calculated eigval = -0.951884049346835
    last  calculated eigval = 0.055292456914070
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55124741562134
lambda[   5] =  -0.44510410603902
lambda[   6] =  -0.43527851417528
lambda[   7] =  -0.40823366860492
lambda[   8] =  -0.37831468705162
lambda[   9] =  -0.34880897506981
lambda[  10] =  -0.32553054213326
lambda[  11] =  -0.31793351632841
lambda[  12] =  -0.28118177956988
lambda[  13] =  -0.21583900796170
lambda[  14] =  -0.02973566455651
lambda[  15] =   0.00974676504380
lambda[  16] =   0.01493792657233
lambda[  17] =   0.01912485258516
lambda[  18] =   0.03190478486326
lambda[  19] =   0.04946538196162
lambda[  20] =   0.05529245691407
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 1.203 ms
rank =  0, subspace rotation using ScaLAPACK took 6.645 ms
rank =  0, Distributing orbital back into band + domain format took 21.966 ms
rank = 0, Subspace_Rotation used 28.629 ms

Total time for subspace rotation: 28.634 ms
rank = 0, Efermi =  -0.058425500293 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.488 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.065 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.447 ms
rank = 0, Calculating density took 2126.824 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.013 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.140 ms
rank = 0, D2D took 1.326 ms
rank = 0, Transfering density took 1.336 ms
Etot    =   -39.374430239553
Eband   =   -11.943161793159
E1      =    26.962996103114
E2      =   -10.437447552489
E3      =   -15.341674861918
Exc     =   -13.475469612072
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 3.391e-04, dEband = 1.963e-02
rank = 0, Calculating/Estimating energy took 1.211 ms, Etot = -39.374430240, dEtot = 3.391e-04, dEband = 1.963e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.7040274019130, which took 0.064 ms

iter_count = 108, r_2norm = 7.070e-05, tol*||rhs|| = 1.082e-04

Anderson update took 67.899 ms, out of which F'*F took 30.219 ms; b-Ax took 201.989 ms, out of which Lap took 180.700 ms
rank = 0, Mixing (+ precond) took 460.963 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383962, int_b + int_rho = 1.382e-13, checking this took 0.106 ms
2-norm of RHS = 807.8517439487897, which took 0.113 ms

iter_count = 252, r_2norm = 7.820e-04, tol*||rhs|| = 8.079e-04

Anderson update took 156.586 ms, out of which F'*F took 71.800 ms; b-Ax took 477.562 ms, out of which Lap took 427.300 ms
Solving Poisson took 1054.187 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.116700 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.713 ms
Total time for convolution: 	 convolve: 5.112855 
Total time for convolution: 	 convolve: 5.100977 
Total time for convolution: 	 convolve: 5.109793 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.405 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
---Transfer Veff_loc: D2D took 1.335 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.282 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.649 ms

This SCF took 28114.084 ms, scf error = 1.561e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.155292, lowerbound = -0.951884, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2010.181 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.101 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.327 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.611 ms
rank =  0, Distribute data + matrix mult took 26.567 ms
rank =  0, finding HY took 31.705 ms
rank =  0, distributing HY into block cyclic form took 20.683 ms
rank =  0, finding Y'*HY took 5.889 ms
Rank 0, Project_Hamiltonian used 84.883 ms
Total time for projection: 84.902 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.167 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.232 ms
    first calculated eigval = -0.947243758462222
    last  calculated eigval = 0.053390043170819
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54574323762599
lambda[   5] =  -0.44030016273229
lambda[   6] =  -0.42992025311114
lambda[   7] =  -0.40361365291612
lambda[   8] =  -0.37322515974767
lambda[   9] =  -0.34306806900212
lambda[  10] =  -0.32088366803835
lambda[  11] =  -0.31194488103681
lambda[  12] =  -0.27696390829934
lambda[  13] =  -0.21120168852025
lambda[  14] =  -0.03072794703822
lambda[  15] =   0.00832802748487
lambda[  16] =   0.01326961966399
lambda[  17] =   0.01819591590817
lambda[  18] =   0.02733029061541
lambda[  19] =   0.04540429047860
lambda[  20] =   0.05339004317082
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 6.580 ms
rank =  0, Distributing orbital back into band + domain format took 22.301 ms
rank = 0, Subspace_Rotation used 28.897 ms

Total time for subspace rotation: 28.902 ms
rank = 0, Efermi =  -0.059417782770 calculate fermi energy took 2.172 ms
rank = 0, --- Calculate rho: sum over local bands took 5.555 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.409 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.297 ms
rank = 0, Calculating density took 2134.748 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.033 ms
rank = 0, D2D took 1.205 ms
rank = 0, Transfering density took 1.212 ms
Etot    =   -39.373260269769
Eband   =   -11.813470194770
E1      =    26.892074727881
E2      =   -10.367406123039
E3      =   -15.389584202359
Exc     =   -13.510937776434
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 9.750e-05, dEband = 1.081e-02
rank = 0, Calculating/Estimating energy took 1.026 ms, Etot = -39.373260270, dEtot = 9.750e-05, dEband = 1.081e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9285987515611, which took 0.064 ms

iter_count = 108, r_2norm = 3.431e-05, tol*||rhs|| = 3.714e-05

Anderson update took 65.405 ms, out of which F'*F took 30.127 ms; b-Ax took 207.813 ms, out of which Lap took 185.514 ms
rank = 0, Mixing (+ precond) took 460.374 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383955, int_b + int_rho = 6.548e-14, checking this took 0.161 ms
2-norm of RHS = 808.2570504514724, which took 0.143 ms

iter_count = 240, r_2norm = 6.698e-04, tol*||rhs|| = 8.083e-04

Anderson update took 150.392 ms, out of which F'*F took 68.540 ms; b-Ax took 454.579 ms, out of which Lap took 407.840 ms
Solving Poisson took 1005.002 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.255 ms
Total time for convolution: 	 convolve: 5.098829 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.104410 
Total time for convolution: 	 convolve: 5.106417 
Total time for convolution: 	 convolve: 5.100366 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.581 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 1.786 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.898 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.731 ms

This SCF took 28032.937 ms, scf error = 5.771e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.153390, lowerbound = -0.947244, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2023.901 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 21.315 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.326 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 25.668 ms
rank =  0, finding HY took 32.282 ms
rank =  0, distributing HY into block cyclic form took 20.603 ms
rank =  0, finding Y'*HY took 5.790 ms
Rank 0, Project_Hamiltonian used 84.391 ms
Total time for projection: 84.417 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.147 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.235 ms
    first calculated eigval = -0.945358097775404
    last  calculated eigval = 0.051865475144984
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54275926768306
lambda[   5] =  -0.43777207044812
lambda[   6] =  -0.42713209685547
lambda[   7] =  -0.40078466154248
lambda[   8] =  -0.37002850496159
lambda[   9] =  -0.33912136444445
lambda[  10] =  -0.31759899396496
lambda[  11] =  -0.30847811069651
lambda[  12] =  -0.27513325475895
lambda[  13] =  -0.20973032671902
lambda[  14] =  -0.03073403299182
lambda[  15] =   0.00790530715474
lambda[  16] =   0.01316259462703
lambda[  17] =   0.01802324846829
lambda[  18] =   0.02377889057426
lambda[  19] =   0.04059362725418
lambda[  20] =   0.05186547514498
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.253 ms
rank =  0, subspace rotation using ScaLAPACK took 6.579 ms
rank =  0, Distributing orbital back into band + domain format took 22.108 ms
rank = 0, Subspace_Rotation used 28.709 ms

Total time for subspace rotation: 28.714 ms
rank = 0, Efermi =  -0.059423868744 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.279 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.750 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.462 ms
rank = 0, Calculating density took 2147.294 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.991 ms
rank = 0, D2D took 1.176 ms
rank = 0, Transfering density took 1.183 ms
Etot    =   -39.372935253018
Eband   =   -11.739610467702
E1      =    26.859853438102
E2      =   -10.321845221513
E3      =   -15.403014332919
Exc     =   -13.520120426007
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 2.708e-05, dEband = 6.155e-03
rank = 0, Calculating/Estimating energy took 1.065 ms, Etot = -39.372935253, dEtot = 2.708e-05, dEband = 6.155e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3783088679719, which took 0.122 ms

iter_count = 114, r_2norm = 9.511e-06, tol*||rhs|| = 1.513e-05

Anderson update took 68.584 ms, out of which F'*F took 31.701 ms; b-Ax took 213.223 ms, out of which Lap took 189.978 ms
rank = 0, Mixing (+ precond) took 486.517 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383972, int_b + int_rho = 2.328e-13, checking this took 0.131 ms
2-norm of RHS = 808.4952856916873, which took 0.156 ms

iter_count = 240, r_2norm = 6.377e-04, tol*||rhs|| = 8.085e-04

Anderson update took 146.941 ms, out of which F'*F took 66.372 ms; b-Ax took 449.266 ms, out of which Lap took 400.743 ms
Solving Poisson took 1003.635 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.599 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.097403 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.103693 
Total time for convolution: 	 convolve: 5.109095 
Total time for convolution: 	 convolve: 5.103899 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.720 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.633 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 1.686 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.368 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.479 ms

This SCF took 28072.078 ms, scf error = 2.886e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.151865, lowerbound = -0.945358, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2081.614 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 21.140 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.336 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.506 ms
rank =  0, finding HY took 32.177 ms
rank =  0, distributing HY into block cyclic form took 20.676 ms
rank =  0, finding Y'*HY took 5.785 ms
Rank 0, Project_Hamiltonian used 84.186 ms
Total time for projection: 84.217 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.212 ms
    first calculated eigval = -0.941894576678348
    last  calculated eigval = 0.051000773050689
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53949043228785
lambda[   5] =  -0.43459688811318
lambda[   6] =  -0.42405365116721
lambda[   7] =  -0.39770610360169
lambda[   8] =  -0.36702040663734
lambda[   9] =  -0.33528953233662
lambda[  10] =  -0.31433481127564
lambda[  11] =  -0.30508654577022
lambda[  12] =  -0.27203170268890
lambda[  13] =  -0.20673492312416
lambda[  14] =  -0.02970040437180
lambda[  15] =   0.00873148207033
lambda[  16] =   0.01449658993127
lambda[  17] =   0.01882652706253
lambda[  18] =   0.02212166042831
lambda[  19] =   0.03545305893107
lambda[  20] =   0.05100077305069
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 6.572 ms
rank =  0, Distributing orbital back into band + domain format took 22.176 ms
rank = 0, Subspace_Rotation used 28.766 ms

Total time for subspace rotation: 28.772 ms
rank = 0, Efermi =  -0.058390240113 calculate fermi energy took 0.076 ms
rank = 0, --- Calculate rho: sum over local bands took 5.392 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.515 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.423 ms
rank = 0, Calculating density took 2204.347 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.993 ms
rank = 0, D2D took 1.173 ms
rank = 0, Transfering density took 1.179 ms
Etot    =   -39.372792053821
Eband   =   -11.654784499215
E1      =    26.818629673606
E2      =   -10.274324689414
E3      =   -15.416675516118
Exc     =   -13.529720081901
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 1.193e-05, dEband = 7.069e-03
rank = 0, Calculating/Estimating energy took 1.111 ms, Etot = -39.372792054, dEtot = 1.193e-05, dEband = 7.069e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2525267606030, which took 0.057 ms

iter_count = 108, r_2norm = 9.803e-06, tol*||rhs|| = 1.010e-05

Anderson update took 64.236 ms, out of which F'*F took 29.593 ms; b-Ax took 202.107 ms, out of which Lap took 179.198 ms
rank = 0, Mixing (+ precond) took 457.072 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383953, int_b + int_rho = 5.093e-14, checking this took 0.125 ms
2-norm of RHS = 808.5041962435814, which took 0.071 ms

iter_count = 222, r_2norm = 7.274e-04, tol*||rhs|| = 8.085e-04

Anderson update took 133.150 ms, out of which F'*F took 60.942 ms; b-Ax took 415.829 ms, out of which Lap took 369.868 ms
Solving Poisson took 927.124 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.113239 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.100666 
Total time for convolution: 	 convolve: 5.190651 
Total time for convolution: 	 convolve: 5.104527 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.005 ms
---Transfer Veff_loc: D2D took 2.491 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.905 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.432 ms

This SCF took 28086.606 ms, scf error = 1.542e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.151001, lowerbound = -0.941895, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2050.753 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 21.034 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.384 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.446 ms
rank =  0, finding HY took 32.270 ms
rank =  0, distributing HY into block cyclic form took 20.592 ms
rank =  0, finding Y'*HY took 6.548 ms
Rank 0, Project_Hamiltonian used 84.888 ms
Total time for projection: 84.910 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.164 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.243 ms
    first calculated eigval = -0.939891297148809
    last  calculated eigval = 0.050847559047170
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53701651146492
lambda[   5] =  -0.43238941896580
lambda[   6] =  -0.42184236536982
lambda[   7] =  -0.39554638905078
lambda[   8] =  -0.36484462327848
lambda[   9] =  -0.33258944802275
lambda[  10] =  -0.31195666601719
lambda[  11] =  -0.30261157008610
lambda[  12] =  -0.26985281236680
lambda[  13] =  -0.20474424121147
lambda[  14] =  -0.02809424181177
lambda[  15] =   0.01042451833074
lambda[  16] =   0.01624824304925
lambda[  17] =   0.01985041128437
lambda[  18] =   0.02233084324044
lambda[  19] =   0.03048716330190
lambda[  20] =   0.05084755904717
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.287 ms
rank =  0, subspace rotation using ScaLAPACK took 6.619 ms
rank =  0, Distributing orbital back into band + domain format took 22.040 ms
rank = 0, Subspace_Rotation used 28.677 ms

Total time for subspace rotation: 28.682 ms
rank = 0, Efermi =  -0.056784077546 calculate fermi energy took 0.100 ms
rank = 0, --- Calculate rho: sum over local bands took 5.347 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.584 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.418 ms
rank = 0, Calculating density took 2174.177 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.989 ms
rank = 0, D2D took 1.155 ms
rank = 0, Transfering density took 1.164 ms
Etot    =   -39.372751052907
Eband   =   -11.595243098884
E1      =    26.786139718013
E2      =   -10.245279083871
E3      =   -15.424902858637
Exc     =   -13.535912262700
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 3.417e-06, dEband = 4.962e-03
rank = 0, Calculating/Estimating energy took 1.237 ms, Etot = -39.372751053, dEtot = 3.417e-06, dEband = 4.962e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1524847616139, which took 0.076 ms

iter_count = 114, r_2norm = 4.075e-06, tol*||rhs|| = 6.099e-06

Anderson update took 68.350 ms, out of which F'*F took 31.173 ms; b-Ax took 210.963 ms, out of which Lap took 187.996 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 480.389 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383953, int_b + int_rho = 5.457e-14, checking this took 0.118 ms
2-norm of RHS = 808.5303995236990, which took 0.151 ms

iter_count = 204, r_2norm = 7.439e-04, tol*||rhs|| = 8.085e-04

Anderson update took 134.997 ms, out of which F'*F took 65.331 ms; b-Ax took 393.463 ms, out of which Lap took 353.207 ms
Solving Poisson took 872.758 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Total time for convolution: 	 convolve: 5.104115 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.389 ms
Total time for convolution: 	 convolve: 5.103189 
Total time for convolution: 	 convolve: 5.109330 
Total time for convolution: 	 convolve: 5.117887 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.695 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
---Transfer Veff_loc: D2D took 1.693 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.908 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.636 ms

This SCF took 27993.639 ms, scf error = 1.062e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.150848, lowerbound = -0.939891, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2009.634 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 29.743 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.108 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 33.889 ms
rank =  0, finding HY took 32.209 ms
rank =  0, distributing HY into block cyclic form took 20.625 ms
rank =  0, finding Y'*HY took 5.815 ms
Rank 0, Project_Hamiltonian used 92.571 ms
Total time for projection: 92.590 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.939055198520183
    last  calculated eigval = 0.050121791303837
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53609840363509
lambda[   5] =  -0.43155292346639
lambda[   6] =  -0.42096238138067
lambda[   7] =  -0.39476286753671
lambda[   8] =  -0.36405045820291
lambda[   9] =  -0.33160687034934
lambda[  10] =  -0.31112483594696
lambda[  11] =  -0.30166854272385
lambda[  12] =  -0.26902142278071
lambda[  13] =  -0.20392280763262
lambda[  14] =  -0.02661536288721
lambda[  15] =   0.01201842692238
lambda[  16] =   0.01755824966153
lambda[  17] =   0.02040834637357
lambda[  18] =   0.02325792100819
lambda[  19] =   0.02665290961141
lambda[  20] =   0.05012179130384
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 6.562 ms
rank =  0, Distributing orbital back into band + domain format took 22.075 ms
rank = 0, Subspace_Rotation used 28.652 ms

Total time for subspace rotation: 28.658 ms
rank = 0, Efermi =  -0.055305198610 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 5.245 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.645 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.452 ms
rank = 0, Calculating density took 2140.592 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.089 ms
rank = 0, D2D took 1.267 ms
rank = 0, Transfering density took 1.274 ms
Etot    =   -39.372735362541
Eband   =   -11.572973376628
E1      =    26.777049530247
E2      =   -10.231864013936
E3      =   -15.425533375620
Exc     =   -13.536291553872
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 1.308e-06, dEband = 1.856e-03
rank = 0, Calculating/Estimating energy took 1.506 ms, Etot = -39.372735363, dEtot = 1.308e-06, dEband = 1.856e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0896100235794, which took 0.064 ms

iter_count = 108, r_2norm = 3.335e-06, tol*||rhs|| = 3.584e-06

Anderson update took 64.184 ms, out of which F'*F took 29.769 ms; b-Ax took 201.958 ms, out of which Lap took 179.196 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.539 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383950, int_b + int_rho = 2.183e-14, checking this took 0.147 ms
2-norm of RHS = 808.5168313228806, which took 0.076 ms

iter_count = 210, r_2norm = 6.610e-04, tol*||rhs|| = 8.085e-04

Anderson update took 125.955 ms, out of which F'*F took 57.297 ms; b-Ax took 398.234 ms, out of which Lap took 354.986 ms
Solving Poisson took 880.302 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.101876 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.379 ms
Total time for convolution: 	 convolve: 5.104006 
Total time for convolution: 	 convolve: 5.100646 
Total time for convolution: 	 convolve: 5.112118 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.778 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.622 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 1.721 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.883 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.642 ms

This SCF took 27875.558 ms, scf error = 6.785e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.150122, lowerbound = -0.939055, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2032.172 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.535 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.054 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.620 ms
rank =  0, finding HY took 32.180 ms
rank =  0, distributing HY into block cyclic form took 20.665 ms
rank =  0, finding Y'*HY took 5.837 ms
Rank 0, Project_Hamiltonian used 84.337 ms
Total time for projection: 84.351 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.162 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.242 ms
    first calculated eigval = -0.937753586015329
    last  calculated eigval = 0.048538328490625
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53471845548299
lambda[   5] =  -0.43028852222885
lambda[   6] =  -0.41965064575078
lambda[   7] =  -0.39353185297384
lambda[   8] =  -0.36276331579372
lambda[   9] =  -0.33001089985307
lambda[  10] =  -0.30983111936502
lambda[  11] =  -0.30020101868450
lambda[  12] =  -0.26775228101104
lambda[  13] =  -0.20263157674533
lambda[  14] =  -0.02328012281499
lambda[  15] =   0.01535082855074
lambda[  16] =   0.02075899415836
lambda[  17] =   0.02314641229819
lambda[  18] =   0.02630549211121
lambda[  19] =   0.02726576413732
lambda[  20] =   0.04853832849062
==subpsace eigenproblem: bcast eigvals took 0.042 ms
Total time for solving subspace eigenvalue problem: 0.303 ms
rank =  0, subspace rotation using ScaLAPACK took 6.583 ms
rank =  0, Distributing orbital back into band + domain format took 22.098 ms
rank = 0, Subspace_Rotation used 28.697 ms

Total time for subspace rotation: 28.704 ms
rank = 0, Efermi =  -0.051969958572 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.226 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.828 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.405 ms
rank = 0, Calculating density took 2155.136 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.428 ms
rank = 0, D2D took 1.535 ms
rank = 0, Transfering density took 1.542 ms
Etot    =   -39.372741598379
Eband   =   -11.538260570740
E1      =    26.759903339394
E2      =   -10.213706380897
E3      =   -15.428324936296
Exc     =   -13.538498332383
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 5.197e-07, dEband = 2.893e-03
rank = 0, Calculating/Estimating energy took 0.980 ms, Etot = -39.372741598, dEtot = 5.197e-07, dEband = 2.893e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0577767363471, which took 0.065 ms

iter_count = 114, r_2norm = 1.786e-06, tol*||rhs|| = 2.311e-06

Anderson update took 68.489 ms, out of which F'*F took 31.306 ms; b-Ax took 211.604 ms, out of which Lap took 188.811 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.371 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383966, int_b + int_rho = 1.783e-13, checking this took 0.141 ms
2-norm of RHS = 808.5162727482628, which took 0.136 ms

iter_count = 150, r_2norm = 7.968e-04, tol*||rhs|| = 8.085e-04

Anderson update took 90.982 ms, out of which F'*F took 41.650 ms; b-Ax took 284.356 ms, out of which Lap took 253.930 ms
Solving Poisson took 629.426 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.122293 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.100774 
Total time for convolution: 	 convolve: 5.105308 
Total time for convolution: 	 convolve: 5.109236 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.770 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.116 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 1.700 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.923 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.683 ms

This SCF took 27675.643 ms, scf error = 3.677e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.148538, lowerbound = -0.937754, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2080.745 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.223 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.043 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 25.306 ms
rank =  0, finding HY took 32.341 ms
rank =  0, distributing HY into block cyclic form took 20.597 ms
rank =  0, finding Y'*HY took 5.818 ms
Rank 0, Project_Hamiltonian used 84.099 ms
Total time for projection: 84.122 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.170 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.244 ms
    first calculated eigval = -0.937450652734560
    last  calculated eigval = 0.045343705129924
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53441257010358
lambda[   5] =  -0.42999380073337
lambda[   6] =  -0.41935658006429
lambda[   7] =  -0.39325379127544
lambda[   8] =  -0.36249082555423
lambda[   9] =  -0.32970153063808
lambda[  10] =  -0.30952945383055
lambda[  11] =  -0.29990286899346
lambda[  12] =  -0.26746170158192
lambda[  13] =  -0.20235419205370
lambda[  14] =  -0.02261065796205
lambda[  15] =   0.01566396264829
lambda[  16] =   0.02114688117604
lambda[  17] =   0.02311915906012
lambda[  18] =   0.02547023481291
lambda[  19] =   0.02713327913780
lambda[  20] =   0.04534370512992
==subpsace eigenproblem: bcast eigvals took 0.035 ms
Total time for solving subspace eigenvalue problem: 0.288 ms
rank =  0, subspace rotation using ScaLAPACK took 6.612 ms
rank =  0, Distributing orbital back into band + domain format took 21.971 ms
rank = 0, Subspace_Rotation used 29.091 ms

Total time for subspace rotation: 29.098 ms
rank = 0, Efermi =  -0.051300493694 calculate fermi energy took 0.620 ms
rank = 0, --- Calculate rho: sum over local bands took 5.342 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.531 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.397 ms
rank = 0, Calculating density took 2203.235 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.001 ms
rank = 0, D2D took 1.194 ms
rank = 0, Transfering density took 1.202 ms
Etot    =   -39.372767316232
Eband   =   -11.530591633322
E1      =    26.755725714967
E2      =   -10.210077381925
E3      =   -15.428957510391
Exc     =   -13.539018938350
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 2.143e-06, dEband = 6.391e-04
rank = 0, Calculating/Estimating energy took 1.378 ms, Etot = -39.372767316, dEtot = 2.143e-06, dEband = 6.391e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0347529752797, which took 0.076 ms

iter_count = 114, r_2norm = 8.929e-07, tol*||rhs|| = 1.390e-06

Anderson update took 67.654 ms, out of which F'*F took 30.924 ms; b-Ax took 213.234 ms, out of which Lap took 188.426 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.833 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383959, int_b + int_rho = 1.091e-13, checking this took 0.126 ms
2-norm of RHS = 808.5260838214143, which took 0.151 ms

iter_count = 180, r_2norm = 7.118e-04, tol*||rhs|| = 8.085e-04

Anderson update took 107.784 ms, out of which F'*F took 49.197 ms; b-Ax took 337.604 ms, out of which Lap took 299.814 ms
Solving Poisson took 757.084 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.109622 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.101111 
Total time for convolution: 	 convolve: 5.107206 
Total time for convolution: 	 convolve: 5.106179 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.401 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.162 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 1.709 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.928 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.670 ms

This SCF took 27841.651 ms, scf error = 2.961e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.145344, lowerbound = -0.937451, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2080.704 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 21.295 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.167 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 25.502 ms
rank =  0, finding HY took 32.162 ms
rank =  0, distributing HY into block cyclic form took 20.633 ms
rank =  0, finding Y'*HY took 5.798 ms
Rank 0, Project_Hamiltonian used 84.130 ms
Total time for projection: 84.158 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.936808404014187
    last  calculated eigval = 0.042564325970300
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53377794583896
lambda[   5] =  -0.42938474451357
lambda[   6] =  -0.41872332025703
lambda[   7] =  -0.39267926527561
lambda[   8] =  -0.36190574332782
lambda[   9] =  -0.32904514380638
lambda[  10] =  -0.30892465709057
lambda[  11] =  -0.29925510479119
lambda[  12] =  -0.26686945640708
lambda[  13] =  -0.20175625330478
lambda[  14] =  -0.01937190986062
lambda[  15] =   0.01748455410434
lambda[  16] =   0.02346795503318
lambda[  17] =   0.02591479035891
lambda[  18] =   0.02842237384778
lambda[  19] =   0.03082040353903
lambda[  20] =   0.04256432597030
==subpsace eigenproblem: bcast eigvals took 0.045 ms
Total time for solving subspace eigenvalue problem: 0.234 ms
rank =  0, subspace rotation using ScaLAPACK took 7.208 ms
rank =  0, Distributing orbital back into band + domain format took 21.451 ms
rank = 0, Subspace_Rotation used 28.678 ms

Total time for subspace rotation: 28.687 ms
rank = 0, Efermi =  -0.048061745602 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.412 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.938 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.323 ms
rank = 0, Calculating density took 2204.004 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.010 ms
rank = 0, D2D took 1.121 ms
rank = 0, Transfering density took 1.127 ms
Etot    =   -39.372823314793
Eband   =   -11.514577849968
E1      =    26.747869756891
E2      =   -10.201676976562
E3      =   -15.430045658752
Exc     =   -13.539920505186
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 4.667e-06, dEband = 1.334e-03
rank = 0, Calculating/Estimating energy took 0.990 ms, Etot = -39.372823315, dEtot = 4.667e-06, dEband = 1.334e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0296822529753, which took 0.089 ms

iter_count = 114, r_2norm = 7.946e-07, tol*||rhs|| = 1.187e-06

Anderson update took 68.178 ms, out of which F'*F took 31.178 ms; b-Ax took 210.951 ms, out of which Lap took 187.990 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 480.430 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383961, int_b + int_rho = 1.310e-13, checking this took 0.135 ms
2-norm of RHS = 808.5295201870399, which took 0.123 ms

iter_count = 138, r_2norm = 7.396e-04, tol*||rhs|| = 8.085e-04

Anderson update took 83.012 ms, out of which F'*F took 38.526 ms; b-Ax took 259.295 ms, out of which Lap took 231.271 ms
Solving Poisson took 576.459 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.102801 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.099254 
Total time for convolution: 	 convolve: 5.113302 
Total time for convolution: 	 convolve: 5.106016 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.617 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.709 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.974 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.729 ms

This SCF took 27651.169 ms, scf error = 1.700e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.142564, lowerbound = -0.936808, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2042.107 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 31.619 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.240 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 35.888 ms
rank =  0, finding HY took 32.192 ms
rank =  0, distributing HY into block cyclic form took 20.877 ms
rank =  0, finding Y'*HY took 5.630 ms
Rank 0, Project_Hamiltonian used 94.631 ms
Total time for projection: 94.649 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.936657128756653
    last  calculated eigval = 0.040581729298197
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53361828467216
lambda[   5] =  -0.42923341909015
lambda[   6] =  -0.41856912537650
lambda[   7] =  -0.39253561837736
lambda[   8] =  -0.36176199168867
lambda[   9] =  -0.32888489259015
lambda[  10] =  -0.30877655799939
lambda[  11] =  -0.29909833101475
lambda[  12] =  -0.26671710836196
lambda[  13] =  -0.20160568179049
lambda[  14] =  -0.01861179889424
lambda[  15] =   0.01740456785705
lambda[  16] =   0.02365550506918
lambda[  17] =   0.02591905305307
lambda[  18] =   0.02938196639288
lambda[  19] =   0.03153249237733
lambda[  20] =   0.04058172929820
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 7.147 ms
rank =  0, Distributing orbital back into band + domain format took 21.504 ms
rank = 0, Subspace_Rotation used 28.668 ms

Total time for subspace rotation: 28.675 ms
rank = 0, Efermi =  -0.047301634654 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.162 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.018 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.291 ms
rank = 0, Calculating density took 2175.599 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.057 ms
rank = 0, D2D took 1.186 ms
rank = 0, Transfering density took 1.192 ms
Etot    =   -39.372856764778
Eband   =   -11.510628521197
E1      =    26.745900018744
E2      =   -10.199614616059
E3      =   -15.430329142006
Exc     =   -13.540154668546
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 2.787e-06, dEband = 3.291e-04
rank = 0, Calculating/Estimating energy took 0.978 ms, Etot = -39.372856765, dEtot = 2.787e-06, dEband = 3.291e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0236915756513, which took 0.111 ms

iter_count = 108, r_2norm = 9.465e-07, tol*||rhs|| = 9.477e-07

Anderson update took 64.318 ms, out of which F'*F took 29.448 ms; b-Ax took 201.724 ms, out of which Lap took 178.949 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.038 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383962, int_b + int_rho = 1.419e-13, checking this took 0.114 ms
2-norm of RHS = 808.5328936712732, which took 0.095 ms

iter_count = 138, r_2norm = 7.166e-04, tol*||rhs|| = 8.085e-04

Anderson update took 82.742 ms, out of which F'*F took 37.881 ms; b-Ax took 263.577 ms, out of which Lap took 235.183 ms
Solving Poisson took 580.013 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.104752 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.104711 
Total time for convolution: 	 convolve: 5.098656 
Total time for convolution: 	 convolve: 5.211490 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 406.263 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.774 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.396 ms
---Transfer Veff_loc: D2D took 1.705 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.897 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.640 ms

This SCF took 28108.175 ms, scf error = 1.322e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.140582, lowerbound = -0.936657, upperbound = 267.583864

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2024.570 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 26.072 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.128 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 30.242 ms
rank =  0, finding HY took 32.224 ms
rank =  0, distributing HY into block cyclic form took 20.753 ms
rank =  0, finding Y'*HY took 5.734 ms
Rank 0, Project_Hamiltonian used 88.987 ms
Total time for projection: 89.735 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.589 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.688 ms
    first calculated eigval = -0.936576218888395
    last  calculated eigval = 0.039734444500415
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53351842985957
lambda[   5] =  -0.42914156754542
lambda[   6] =  -0.41847436383798
lambda[   7] =  -0.39244505410119
lambda[   8] =  -0.36167060306547
lambda[   9] =  -0.32878966150748
lambda[  10] =  -0.30869259712926
lambda[  11] =  -0.29900376676114
lambda[  12] =  -0.26661937427097
lambda[  13] =  -0.20150762018058
lambda[  14] =  -0.01815570869645
lambda[  15] =   0.01696776672654
lambda[  16] =   0.02384226138701
lambda[  17] =   0.02564372229668
lambda[  18] =   0.03009016166206
lambda[  19] =   0.03136206852338
lambda[  20] =   0.03973444450041
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.702 ms
rank =  0, subspace rotation using ScaLAPACK took 6.660 ms
rank =  0, Distributing orbital back into band + domain format took 21.992 ms
rank = 0, Subspace_Rotation used 28.668 ms

Total time for subspace rotation: 28.675 ms
rank = 0, Efermi =  -0.046845544443 calculate fermi energy took 0.105 ms
rank = 0, --- Calculate rho: sum over local bands took 5.242 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.784 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.393 ms
rank = 0, Calculating density took 2153.289 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.976 ms
rank = 0, D2D took 1.151 ms
rank = 0, Transfering density took 1.159 ms
Etot    =   -39.372894608469
Eband   =   -11.508237278358
E1      =    26.744895531350
E2      =   -10.198212543789
E3      =   -15.430283234907
Exc     =   -13.540131288314
Esc     =   -66.697917350842
Entropy =    -0.000000001001
dE = 3.154e-06, dEband = 1.993e-04
rank = 0, Calculating/Estimating energy took 1.240 ms, Etot = -39.372894608, dEtot = 3.154e-06, dEband = 1.993e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0171792656780, which took 0.065 ms

iter_count = 114, r_2norm = 4.642e-07, tol*||rhs|| = 6.872e-07

Anderson update took 68.469 ms, out of which F'*F took 31.207 ms; b-Ax took 211.258 ms, out of which Lap took 188.546 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 480.996 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003383948, int_rho =  26.00000003383944, int_b + int_rho = -4.366e-14, checking this took 0.132 ms
2-norm of RHS = 808.5321125907333, which took 0.166 ms

iter_count = 102, r_2norm = 7.727e-04, tol*||rhs|| = 8.085e-04

Anderson update took 62.160 ms, out of which F'*F took 28.553 ms; b-Ax took 191.306 ms, out of which Lap took 170.787 ms
Solving Poisson took 427.166 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.107295 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.829 ms
Total time for convolution: 	 convolve: 5.104046 
Total time for convolution: 	 convolve: 5.113489 
Total time for convolution: 	 convolve: 5.110731 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 1.640 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.466 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.131 ms

This SCF took 27469.976 ms, scf error = 9.580e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.53351842985957, occ[   4] =   2.00000000000000
lambda[   5] =  -0.42914156754542, occ[   5] =   2.00000000000000
lambda[   6] =  -0.41847436383798, occ[   6] =   2.00000000000000
lambda[   7] =  -0.39244505410119, occ[   7] =   2.00000000000000
lambda[   8] =  -0.36167060306547, occ[   8] =   2.00000000000000
lambda[   9] =  -0.32878966150748, occ[   9] =   2.00000000000000
lambda[  10] =  -0.30869259712926, occ[  10] =   2.00000000000000
lambda[  11] =  -0.29900376676114, occ[  11] =   2.00000000000000
lambda[  12] =  -0.26661937427097, occ[  12] =   2.00000000000000
lambda[  13] =  -0.20150762018058, occ[  13] =   2.00000000000000
lambda[  14] =  -0.01815570869645, occ[  14] =   0.00000003383957
lambda[  15] =   0.01696776672654, occ[  15] =   0.00000000000000
lambda[  16] =   0.02384226138701, occ[  16] =   0.00000000000000
lambda[  17] =   0.02564372229668, occ[  17] =   0.00000000000000
lambda[  18] =   0.03009016166206, occ[  18] =   0.00000000000000
lambda[  19] =   0.03136206852338, occ[  19] =   0.00000000000000
lambda[  20] =   0.03973444450041, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.705 ms, time for Allreduce/Reduce: 12.739 ms 
Time for calculating local force components: 24.508 ms
Start Calculating nonlocal forces
force_nloc = 
  0.85356982358166  -0.55807089420956   0.00000072841615
  0.00284834452582  -0.05131977069378   0.00000001900848
 -0.02514320196164   0.01414860930459  -0.04008795171928
 -0.02514316938216   0.01414857181315   0.04008792563133
 -0.02377362554856   0.01720778090844   0.03979667823454
 -0.02377365215210   0.01720787256432  -0.03979673287456
  0.00248391875181   0.04929151538182  -0.00000000120629
  0.02387745807840  -0.01710319089895  -0.04011572511442
  0.02387747321449  -0.01710318090893   0.04011570766172
 -0.14621341781970  -0.05809899763322  -0.00000008637048
 -0.01344080322335   0.15403931764951   0.00000142663017
  0.01688607319252  -0.00902974139706   0.00000002917125
force_loc = 
 -0.82613605977623   0.54349017287842   0.00001757248428
 -0.00305307100227   0.05467793797806   0.00000031599226
  0.02746244840199  -0.01499049901238   0.04315996475118
  0.02746157624280  -0.01498906307818  -0.04315802490596
  0.02589376306874  -0.01861698077518  -0.04272390275798
  0.02589375195488  -0.01861897991605   0.04272378483011
 -0.00291772072837  -0.05170652586438   0.00000016353338
 -0.02587797707949   0.01762064979017   0.04243075974775
 -0.02587868588132   0.01762118567077  -0.04243284181130
  0.13940729787955   0.05770724322200  -0.00000383456410
  0.00668125884771  -0.14937399018727  -0.00000047704325
 -0.01438500393174   0.00812752391201   0.00000235035965
Time for calculating nonlocal force components: 49.273 ms
[32mforces_xc: 
[0m[32m -0.02837314111241   0.01812267397234   0.00000046342008
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00724131731295   0.00301574334143  -0.00000017813016
[0m[32m  0.00169347125023  -0.00737372003964  -0.00000005808743
[0m[32m -0.00143189842003   0.00016538724771   0.00000006262819
[0mTime for calculating XC forces components: 34.669 ms
 Cartesian force = 
 -0.00091742299732   0.00352556505619   0.00001725282756
 -0.00018277216680   0.00334177969927  -0.00000117649220
  0.00234120075000  -0.00085827729280   0.00307050153896
  0.00234036117030  -0.00085687885005  -0.00307161076758
  0.00214209182983  -0.00142558745175  -0.00292873601638
  0.00214205411244  -0.00142749493675   0.00292554046260
 -0.00041184766691  -0.00243139806758  -0.00000134916585
 -0.00197856469144   0.00050107130621   0.00231352314039
 -0.00197925835718   0.00050161717682  -0.00231864564253
  0.00045715168246   0.00260760134520  -0.00000561055767
 -0.00504411881576  -0.00272478016241  -0.00000061999346
  0.00109112515040  -0.00075321782234   0.00000093066615
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Time for printing density: 390.688 ms
The program took 427.403 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:51
Job ID:        2266725
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:29:48,vmem=8420K,walltime=00:07:29,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-24-2
---------------------------------------
