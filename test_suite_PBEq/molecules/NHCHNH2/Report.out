---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:56
Job ID:    2266498
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:02
Job ID:    2266498
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.072 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 253.420 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 7.
[32m
Time for finding element is 0.009 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 26.850 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 214.732 ms

Freeing SPARC_INPUT_MPI datatype took 0.018 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.973 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.098 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    9.892642	   12.483243	    9.778277	
   13.691910	   10.426988	   10.336997	
   12.353625	    7.516757	   10.017875	
    6.308090	   10.141192	    9.796800	
    9.862837	   10.408528	    9.792425	
   12.247233	    9.389162	    9.663003	
    7.883451	    9.039943	    9.824998	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.176 ms
Set up communicators.

--set up spincomm took 2.208 ms

--set up kptcomm took 0.345 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.078 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.048 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.909 ms

Calculate_SplineDerivRadFun took 0.193 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.734 ms.
time spent on vectorized spline interp: 3.165 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.382 ms.
time spent on vectorized spline interp: 1.653 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.346 ms.
time spent on vectorized spline interp: 1.629 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.340 ms.

Calculating rb for all atom types took 15.277 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.902 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000300475, sum_int_rho = 17.6008276530391
PosCharge = 18.000000030047, NegCharge = -17.600827653039, scal_fac = 1.022679182188
After scaling, int_rho = 18.0000000300475, PosCharge + NegCharge - NetCharge = 0.000e+00
--Calculate Vref took 0.355 ms
--Calculate rho_guess took 1.963 ms

 integral of b = -18.0000000300475,
 int{b} + Nelectron + NetCharge = -3.005e-08,
 Esc = -49.3048854911546,
 MPI_Reduce took 4.851 ms

Calculating b & b_ref took 12.364 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.034 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.043 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.020 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.144 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 26.171 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004741, int_b + int_rho = -7.276e-15, checking this took 0.085 ms
2-norm of RHS = 643.7313518972225, which took 0.106 ms

iter_count = 420, r_2norm = 5.383e-04, tol*||rhs|| = 6.437e-04

Anderson update took 226.108 ms, out of which F'*F took 101.745 ms; b-Ax took 685.318 ms, out of which Lap took 615.940 ms
Solving Poisson took 1456.592 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.408 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.824 ms
Total time for convolution: 	 convolve: 4.861801 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
Total time for convolution: 	 convolve: 4.785474 
Total time for convolution: 	 convolve: 4.804368 
Total time for convolution: 	 convolve: 4.825483 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.731 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.524 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.144 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.032 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
rank = 0, XC calculation took 22858.602 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 1.596 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.154 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.808 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.012 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.602 ms
    Lanczos iter 53, eigmin  = -0.969415100, eigmax = 264.927802935, err_eigmin = 3.367e-04, err_eigmax = 9.659e-03
rank =   0, Lanczos took 113.051 ms, eigmin = -0.969415100288, eigmax = 267.577080964072

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.253833, lowerbound = -1.069415, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1162.321 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 13.142 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.774 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.978 ms
rank =  0, Distribute data + matrix mult took 17.912 ms
rank =  0, finding HY took 19.668 ms
rank =  0, distributing HY into block cyclic form took 11.877 ms
rank =  0, finding Y'*HY took 5.623 ms
Rank 0, Project_Hamiltonian used 55.107 ms
Total time for projection: 55.119 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.386 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.391 ms
rank = 0, Solve_Generalized_EigenProblem used 0.795 ms
    first calculated eigval = 2.804925230023348
    last  calculated eigval = 3.222036887599304
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.80492523002335
lambda[   2] =   2.84093635191187
lambda[   3] =   2.89155274270904
lambda[   4] =   2.92319519739656
lambda[   5] =   2.94540640200285
lambda[   6] =   2.95205863080018
lambda[   7] =   2.98551649231596
lambda[   8] =   3.01232181477447
lambda[   9] =   3.04115875196434
lambda[  10] =   3.06553239461809
lambda[  11] =   3.09600510410951
lambda[  12] =   3.11105731380163
lambda[  13] =   3.14579032424728
lambda[  14] =   3.16449397578347
lambda[  15] =   3.22203688759930
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.826 ms
rank =  0, subspace rotation using ScaLAPACK took 3.587 ms
rank =  0, Distributing orbital back into band + domain format took 12.869 ms
rank = 0, Subspace_Rotation used 16.468 ms

Total time for subspace rotation: 16.471 ms
rank = 0, Efermi =   3.053345574821 calculate fermi energy took 0.043 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.322037, lowerbound = -1.069415, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1102.966 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 48.960 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.331 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.046 ms
rank =  0, Distribute data + matrix mult took 52.350 ms
rank =  0, finding HY took 18.805 ms
rank =  0, distributing HY into block cyclic form took 11.869 ms
rank =  0, finding Y'*HY took 4.330 ms
Rank 0, Project_Hamiltonian used 87.393 ms
Total time for projection: 87.406 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.196 ms
    first calculated eigval = -0.699353023497822
    last  calculated eigval = 0.442597037739716
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.69935302349782
lambda[   2] =  -0.64559257143054
lambda[   3] =  -0.26646367839438
lambda[   4] =  -0.07729833201360
lambda[   5] =  -0.02387137436137
lambda[   6] =   0.09408282124047
lambda[   7] =   0.18209829678397
lambda[   8] =   0.30017683267056
lambda[   9] =   0.32770721215153
lambda[  10] =   0.34681628137046
lambda[  11] =   0.36470495981700
lambda[  12] =   0.39655399814163
lambda[  13] =   0.40524395441754
lambda[  14] =   0.43100782454843
lambda[  15] =   0.44259703773972
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 3.507 ms
rank =  0, Distributing orbital back into band + domain format took 12.025 ms
rank = 0, Subspace_Rotation used 15.545 ms

Total time for subspace rotation: 15.548 ms
rank = 0, Efermi =   0.337261745017 calculate fermi energy took 0.039 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.542597, lowerbound = -1.069415, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1115.172 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 45.803 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.263 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.061 ms
rank =  0, Distribute data + matrix mult took 49.140 ms
rank =  0, finding HY took 18.780 ms
rank =  0, distributing HY into block cyclic form took 12.337 ms
rank =  0, finding Y'*HY took 3.963 ms
Rank 0, Project_Hamiltonian used 84.271 ms
Total time for projection: 84.278 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.163 ms
    first calculated eigval = -0.971191355583882
    last  calculated eigval = 0.156633376906780
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97119135558388
lambda[   2] =  -0.89547245074258
lambda[   3] =  -0.64436504250825
lambda[   4] =  -0.58650266558094
lambda[   5] =  -0.51424482466367
lambda[   6] =  -0.47686547078888
lambda[   7] =  -0.33688428271270
lambda[   8] =  -0.29311454635678
lambda[   9] =  -0.22081732910656
lambda[  10] =   0.02495146128596
lambda[  11] =   0.04687154955652
lambda[  12] =   0.10072675748475
lambda[  13] =   0.10723596563286
lambda[  14] =   0.13121392638058
lambda[  15] =   0.15663337690678
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 3.504 ms
rank =  0, Distributing orbital back into band + domain format took 12.028 ms
rank = 0, Subspace_Rotation used 15.547 ms

Total time for subspace rotation: 15.551 ms
rank = 0, Efermi =  -0.003846716878 calculate fermi energy took 0.040 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.256633, lowerbound = -1.069415, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1104.090 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 34.521 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.299 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.126 ms
rank =  0, Distribute data + matrix mult took 37.956 ms
rank =  0, finding HY took 18.771 ms
rank =  0, distributing HY into block cyclic form took 12.064 ms
rank =  0, finding Y'*HY took 4.379 ms
Rank 0, Project_Hamiltonian used 73.195 ms
Total time for projection: 73.210 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.147 ms
    first calculated eigval = -0.972015217296006
    last  calculated eigval = 0.105370269693796
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97201521729601
lambda[   2] =  -0.89586854353776
lambda[   3] =  -0.64951191199458
lambda[   4] =  -0.59676240368832
lambda[   5] =  -0.52204547152669
lambda[   6] =  -0.49884039812945
lambda[   7] =  -0.41844465437461
lambda[   8] =  -0.34345654862658
lambda[   9] =  -0.31654512564450
lambda[  10] =  -0.07859864473222
lambda[  11] =  -0.00089476708636
lambda[  12] =   0.03086489677480
lambda[  13] =   0.06536681593366
lambda[  14] =   0.06817922446666
lambda[  15] =   0.10537026969380
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.174 ms
rank =  0, subspace rotation using ScaLAPACK took 3.500 ms
rank =  0, Distributing orbital back into band + domain format took 12.116 ms
rank = 0, Subspace_Rotation used 15.629 ms

Total time for subspace rotation: 15.632 ms
rank = 0, Efermi =  -0.107396822954 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.202 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.933 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.161 ms
rank = 0, Calculating density took 4970.883 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.610 ms
rank = 0, D2D took 1.326 ms
rank = 0, Transfering density took 1.333 ms
Etot    =   -29.233525572181
Eband   =   -10.426980551999
E1      =    21.005021459924
E2      =    -8.342383812669
E3      =   -10.433969185368
Exc     =    -9.283033986097
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 4.176e+00, dEband = 1.490e+00
rank = 0, Calculating/Estimating energy took 0.934 ms, Etot = -29.233525572, dEtot = 4.176e+00, dEband = 1.490e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 47.9136318020164, which took 0.063 ms

iter_count = 96, r_2norm = 1.528e-03, tol*||rhs|| = 1.917e-03

Anderson update took 50.186 ms, out of which F'*F took 23.067 ms; b-Ax took 154.973 ms, out of which Lap took 138.977 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 337.322 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004750, int_b + int_rho = 8.004e-14, checking this took 0.091 ms
2-norm of RHS = 639.4768657479017, which took 0.116 ms

iter_count = 288, r_2norm = 5.346e-04, tol*||rhs|| = 6.395e-04

Anderson update took 151.695 ms, out of which F'*F took 69.669 ms; b-Ax took 465.475 ms, out of which Lap took 418.204 ms
Solving Poisson took 998.893 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.767 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 4.807343 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 4.818962 
Total time for convolution: 	 convolve: 4.789512 
Total time for convolution: 	 convolve: 4.778808 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 0.985 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.827 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.834 ms

This SCF took 29247.238 ms, scf error = 1.759e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.205370, lowerbound = -0.972015, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1164.243 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.837 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.441 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 15.296 ms
rank =  0, finding HY took 18.868 ms
rank =  0, distributing HY into block cyclic form took 11.872 ms
rank =  0, finding Y'*HY took 4.550 ms
Rank 0, Project_Hamiltonian used 50.614 ms
Total time for projection: 50.628 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.100 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.164 ms
    first calculated eigval = -0.936818232522542
    last  calculated eigval = 0.077701741622168
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.93681823252254
lambda[   2] =  -0.85468184372058
lambda[   3] =  -0.62112103117272
lambda[   4] =  -0.56750184808778
lambda[   5] =  -0.48366823683241
lambda[   6] =  -0.47247455337439
lambda[   7] =  -0.39132592333629
lambda[   8] =  -0.29868617283974
lambda[   9] =  -0.27870007922883
lambda[  10] =  -0.07042961632164
lambda[  11] =  -0.02802181560784
lambda[  12] =   0.00350366374626
lambda[  13] =   0.03501186980788
lambda[  14] =   0.04058462543857
lambda[  15] =   0.07770174162217
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 3.528 ms
rank =  0, Distributing orbital back into band + domain format took 11.920 ms
rank = 0, Subspace_Rotation used 15.459 ms

Total time for subspace rotation: 15.463 ms
rank = 0, Efermi =  -0.099227794485 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 1.937 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.707 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.220 ms
rank = 0, Calculating density took 1237.502 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.518 ms
rank = 0, D2D took 0.622 ms
rank = 0, Transfering density took 0.628 ms
Etot    =   -29.185707842007
Eband   =    -9.809955844347
E1      =    20.480309390588
E2      =    -8.265924283214
E3      =   -10.592598422631
Exc     =    -9.409698602046
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 6.831e-03, dEband = 8.815e-02
rank = 0, Calculating/Estimating energy took 0.888 ms, Etot = -29.185707842, dEtot = 6.831e-03, dEband = 8.815e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 21.5167606802996, which took 0.055 ms

iter_count = 102, r_2norm = 6.349e-04, tol*||rhs|| = 8.607e-04

Anderson update took 52.660 ms, out of which F'*F took 24.381 ms; b-Ax took 163.794 ms, out of which Lap took 146.176 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 359.412 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004747, int_b + int_rho = 5.457e-14, checking this took 0.108 ms
2-norm of RHS = 635.6424694322588, which took 0.128 ms

iter_count = 294, r_2norm = 5.404e-04, tol*||rhs|| = 6.356e-04

Anderson update took 151.470 ms, out of which F'*F took 70.034 ms; b-Ax took 472.535 ms, out of which Lap took 420.719 ms
Solving Poisson took 1014.139 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.834 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 4.852041 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 4.872074 
Total time for convolution: 	 convolve: 4.916821 
Total time for convolution: 	 convolve: 4.894110 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.952 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.846 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.818 ms

This SCF took 25878.728 ms, scf error = 1.123e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.177702, lowerbound = -0.936818, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1141.666 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.013 ms
rank =  0, Distribute orbital to block cyclic format took 11.851 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.664 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.123 ms
rank =  0, Distribute data + matrix mult took 15.650 ms
rank =  0, finding HY took 19.319 ms
rank =  0, distributing HY into block cyclic form took 12.024 ms
rank =  0, finding Y'*HY took 4.300 ms
Rank 0, Project_Hamiltonian used 51.327 ms
Total time for projection: 51.338 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -0.893123324576362
    last  calculated eigval = 0.065714257741897
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89312332457636
lambda[   2] =  -0.80708678847322
lambda[   3] =  -0.58297137239516
lambda[   4] =  -0.52946360088755
lambda[   5] =  -0.43913177780232
lambda[   6] =  -0.43512750606747
lambda[   7] =  -0.35616960093041
lambda[   8] =  -0.25298699052597
lambda[   9] =  -0.23676554954898
lambda[  10] =  -0.04155208455984
lambda[  11] =  -0.03463734296014
lambda[  12] =  -0.00223727255399
lambda[  13] =   0.02199040420594
lambda[  14] =   0.02924330271088
lambda[  15] =   0.06571425774190
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 3.413 ms
rank =  0, Distributing orbital back into band + domain format took 12.544 ms
rank = 0, Subspace_Rotation used 15.971 ms

Total time for subspace rotation: 15.976 ms
rank = 0, Efermi =  -0.070350454909 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.370 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.494 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.201 ms
rank = 0, Calculating density took 1215.343 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.501 ms
rank = 0, D2D took 0.608 ms
rank = 0, Transfering density took 0.613 ms
Etot    =   -29.157904522467
Eband   =    -9.065653023663
E1      =    19.873737423876
E2      =    -8.114577528881
E3      =   -10.797004252024
Exc     =    -9.572685211538
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 3.972e-03, dEband = 1.063e-01
rank = 0, Calculating/Estimating energy took 0.891 ms, Etot = -29.157904522, dEtot = 3.972e-03, dEband = 1.063e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 8.3195030913487, which took 0.146 ms

iter_count = 102, r_2norm = 2.820e-04, tol*||rhs|| = 3.328e-04

Anderson update took 52.233 ms, out of which F'*F took 24.175 ms; b-Ax took 164.671 ms, out of which Lap took 146.600 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 358.085 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004747, int_b + int_rho = 5.093e-14, checking this took 0.093 ms
2-norm of RHS = 635.5144994272021, which took 0.081 ms

iter_count = 282, r_2norm = 5.012e-04, tol*||rhs|| = 6.355e-04

Anderson update took 144.212 ms, out of which F'*F took 66.988 ms; b-Ax took 456.761 ms, out of which Lap took 405.798 ms
Solving Poisson took 969.991 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 4.737141 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 143.237 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 4.859299 
Total time for convolution: 	 convolve: 4.757780 
Total time for convolution: 	 convolve: 4.734054 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.967 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.839 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.827 ms

This SCF took 25504.247 ms, scf error = 5.273e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.165714, lowerbound = -0.893123, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1109.371 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.743 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.329 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 15.100 ms
rank =  0, finding HY took 18.743 ms
rank =  0, distributing HY into block cyclic form took 11.546 ms
rank =  0, finding Y'*HY took 5.632 ms
Rank 0, Project_Hamiltonian used 51.052 ms
Total time for projection: 51.067 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.080 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.876552686558996
    last  calculated eigval = 0.057098970331217
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87655268655900
lambda[   2] =  -0.79068608774282
lambda[   3] =  -0.56563282317067
lambda[   4] =  -0.51373735226814
lambda[   5] =  -0.42137131459294
lambda[   6] =  -0.41807908010587
lambda[   7] =  -0.34212657618517
lambda[   8] =  -0.23808761217122
lambda[   9] =  -0.22553345285319
lambda[  10] =  -0.03719399957022
lambda[  11] =  -0.02688667146701
lambda[  12] =  -0.00288936400452
lambda[  13] =   0.01643888967846
lambda[  14] =   0.02353141396853
lambda[  15] =   0.05709897033122
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 3.385 ms
rank =  0, Distributing orbital back into band + domain format took 12.282 ms
rank = 0, Subspace_Rotation used 15.681 ms

Total time for subspace rotation: 15.687 ms
rank = 0, Efermi =  -0.065992179341 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.203 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.906 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.268 ms
rank = 0, Calculating density took 1182.814 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.623 ms
rank = 0, D2D took 0.720 ms
rank = 0, Transfering density took 0.725 ms
Etot    =   -29.152665235080
Eband   =    -8.783613972416
E1      =    19.682275034952
E2      =    -8.010920264968
E3      =   -10.879997091263
Exc     =    -9.637358161801
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 7.485e-04, dEband = 4.029e-02
rank = 0, Calculating/Estimating energy took 0.847 ms, Etot = -29.152665235, dEtot = 7.485e-04, dEband = 4.029e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.3565450265182, which took 0.043 ms

iter_count = 108, r_2norm = 8.967e-05, tol*||rhs|| = 9.426e-05

Anderson update took 55.704 ms, out of which F'*F took 25.200 ms; b-Ax took 173.063 ms, out of which Lap took 153.509 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 381.335 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004742, int_b + int_rho = 3.638e-15, checking this took 0.099 ms
2-norm of RHS = 635.8439373727136, which took 0.095 ms

iter_count = 264, r_2norm = 6.252e-04, tol*||rhs|| = 6.358e-04

Anderson update took 136.246 ms, out of which F'*F took 62.213 ms; b-Ax took 426.920 ms, out of which Lap took 381.409 ms
Solving Poisson took 913.261 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Total time for convolution: 	 convolve: 4.771308 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 4.755487 
Total time for convolution: 	 convolve: 4.769106 
Total time for convolution: 	 convolve: 4.840176 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.176 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.011 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
---Transfer Veff_loc: D2D took 0.905 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.799 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.725 ms

This SCF took 25355.516 ms, scf error = 2.009e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.157099, lowerbound = -0.876553, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1121.990 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.975 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.264 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.041 ms
rank =  0, Distribute data + matrix mult took 15.290 ms
rank =  0, finding HY took 18.910 ms
rank =  0, distributing HY into block cyclic form took 11.944 ms
rank =  0, finding Y'*HY took 4.217 ms
Rank 0, Project_Hamiltonian used 50.389 ms
Total time for projection: 50.403 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -0.870058271026983
    last  calculated eigval = 0.047855947060145
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87005827102698
lambda[   2] =  -0.78316653387998
lambda[   3] =  -0.55867341892827
lambda[   4] =  -0.50706531881358
lambda[   5] =  -0.41351940385627
lambda[   6] =  -0.41079526355596
lambda[   7] =  -0.33646918619782
lambda[   8] =  -0.22983831570681
lambda[   9] =  -0.22011404326443
lambda[  10] =  -0.03736376620802
lambda[  11] =  -0.02142383147644
lambda[  12] =  -0.00300497022357
lambda[  13] =   0.01382539109670
lambda[  14] =   0.02018627983414
lambda[  15] =   0.04785594706015
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 2.941 ms
rank =  0, Distributing orbital back into band + domain format took 11.875 ms
rank = 0, Subspace_Rotation used 14.828 ms

Total time for subspace rotation: 14.834 ms
rank = 0, Efermi =  -0.066161944381 calculate fermi energy took 3.288 ms
rank = 0, --- Calculate rho: sum over local bands took 3.075 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.812 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.158 ms
rank = 0, Calculating density took 1195.828 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
rank = 0, D2D took 0.751 ms
rank = 0, Transfering density took 0.758 ms
Etot    =   -29.151318351311
Eband   =    -8.659399511583
E1      =    19.613347973827
E2      =    -7.947739171484
E3      =   -10.916756083383
Exc     =    -9.664876576376
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 1.924e-04, dEband = 1.774e-02
rank = 0, Calculating/Estimating energy took 1.070 ms, Etot = -29.151318351, dEtot = 1.924e-04, dEband = 1.774e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0112507497717, which took 0.044 ms

iter_count = 108, r_2norm = 3.865e-05, tol*||rhs|| = 4.045e-05

Anderson update took 54.656 ms, out of which F'*F took 25.378 ms; b-Ax took 170.869 ms, out of which Lap took 152.934 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.446 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004740, int_b + int_rho = -1.819e-14, checking this took 0.094 ms
2-norm of RHS = 636.3005255258454, which took 0.079 ms

iter_count = 252, r_2norm = 5.539e-04, tol*||rhs|| = 6.363e-04

Anderson update took 127.441 ms, out of which F'*F took 59.380 ms; b-Ax took 402.547 ms, out of which Lap took 358.979 ms
Solving Poisson took 853.670 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 4.768131 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 4.757343 
Total time for convolution: 	 convolve: 4.762298 
Total time for convolution: 	 convolve: 4.769676 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.211 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.945 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.319 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.287 ms

This SCF took 25409.126 ms, scf error = 8.526e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.147856, lowerbound = -0.870058, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1146.106 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.962 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.333 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 15.334 ms
rank =  0, finding HY took 19.123 ms
rank =  0, distributing HY into block cyclic form took 11.914 ms
rank =  0, finding Y'*HY took 4.658 ms
Rank 0, Project_Hamiltonian used 51.075 ms
Total time for projection: 51.090 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.868510977869028
    last  calculated eigval = 0.038381087356123
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.86851097786903
lambda[   2] =  -0.78107354061997
lambda[   3] =  -0.55713956519022
lambda[   4] =  -0.50525504859545
lambda[   5] =  -0.41147457792554
lambda[   6] =  -0.40909398568789
lambda[   7] =  -0.33483722144472
lambda[   8] =  -0.22678487825283
lambda[   9] =  -0.21795310153423
lambda[  10] =  -0.03761952182227
lambda[  11] =  -0.02004054367766
lambda[  12] =  -0.00336778344115
lambda[  13] =   0.01221986455629
lambda[  14] =   0.01843022392468
lambda[  15] =   0.03838108735612
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 3.532 ms
rank =  0, Distributing orbital back into band + domain format took 11.944 ms
rank = 0, Subspace_Rotation used 15.489 ms

Total time for subspace rotation: 15.495 ms
rank = 0, Efermi =  -0.066417699951 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 3.028 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.222 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.167 ms
rank = 0, Calculating density took 1219.397 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.598 ms
rank = 0, D2D took 0.775 ms
rank = 0, Transfering density took 0.784 ms
Etot    =   -29.150950758314
Eband   =    -8.624245795370
E1      =    19.610600614510
E2      =    -7.913155974565
E3      =   -10.921917646752
Exc     =    -9.667493706724
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 5.251e-05, dEband = 5.022e-03
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -29.150950758, dEtot = 5.251e-05, dEband = 5.022e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5218342063491, which took 0.055 ms

iter_count = 108, r_2norm = 2.066e-05, tol*||rhs|| = 2.087e-05

Anderson update took 56.670 ms, out of which F'*F took 26.031 ms; b-Ax took 175.479 ms, out of which Lap took 157.580 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 382.281 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004740, int_b + int_rho = -2.183e-14, checking this took 0.113 ms
2-norm of RHS = 636.4200033865151, which took 0.089 ms

iter_count = 246, r_2norm = 5.871e-04, tol*||rhs|| = 6.364e-04

Anderson update took 128.259 ms, out of which F'*F took 58.452 ms; b-Ax took 400.406 ms, out of which Lap took 356.552 ms
Solving Poisson took 851.495 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 4.795210 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 4.856400 
Total time for convolution: 	 convolve: 4.758533 
Total time for convolution: 	 convolve: 4.856381 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.139 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
---Transfer Veff_loc: D2D took 0.911 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.319 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.251 ms

This SCF took 25462.873 ms, scf error = 4.245e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.138381, lowerbound = -0.868511, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1133.669 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.060 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.327 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.093 ms
rank =  0, Distribute data + matrix mult took 15.491 ms
rank =  0, finding HY took 18.924 ms
rank =  0, distributing HY into block cyclic form took 11.741 ms
rank =  0, finding Y'*HY took 4.341 ms
Rank 0, Project_Hamiltonian used 50.544 ms
Total time for projection: 50.557 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.864764848695633
    last  calculated eigval = 0.030985662262247
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.86476484869563
lambda[   2] =  -0.77749248408229
lambda[   3] =  -0.55388385949024
lambda[   4] =  -0.50204873914657
lambda[   5] =  -0.40796844497791
lambda[   6] =  -0.40604706293269
lambda[   7] =  -0.33126524152383
lambda[   8] =  -0.22321285954967
lambda[   9] =  -0.21439646362225
lambda[  10] =  -0.03749325659790
lambda[  11] =  -0.01717338295578
lambda[  12] =  -0.00315450638661
lambda[  13] =   0.01135630443248
lambda[  14] =   0.01796827836489
lambda[  15] =   0.03098566226225
==subpsace eigenproblem: bcast eigvals took 0.052 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 3.507 ms
rank =  0, Distributing orbital back into band + domain format took 11.964 ms
rank = 0, Subspace_Rotation used 15.483 ms

Total time for subspace rotation: 15.487 ms
rank = 0, Efermi =  -0.066291434765 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.975 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.107 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.172 ms
rank = 0, Calculating density took 1206.280 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.628 ms
rank = 0, D2D took 0.814 ms
rank = 0, Transfering density took 0.822 ms
Etot    =   -29.150747456056
Eband   =    -8.562160009169
E1      =    19.580039907067
E2      =    -7.878935187098
E3      =   -10.931626171111
Exc     =    -9.674303220116
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 2.904e-05, dEband = 8.869e-03
rank = 0, Calculating/Estimating energy took 0.896 ms, Etot = -29.150747456, dEtot = 2.904e-05, dEband = 8.869e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2512227937925, which took 0.082 ms

iter_count = 114, r_2norm = 6.954e-06, tol*||rhs|| = 1.005e-05

Anderson update took 58.568 ms, out of which F'*F took 27.444 ms; b-Ax took 183.956 ms, out of which Lap took 165.036 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.890 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004746, int_b + int_rho = 3.638e-14, checking this took 0.093 ms
2-norm of RHS = 636.4582929645279, which took 0.086 ms

iter_count = 240, r_2norm = 5.484e-04, tol*||rhs|| = 6.365e-04

Anderson update took 122.884 ms, out of which F'*F took 56.672 ms; b-Ax took 386.536 ms, out of which Lap took 345.353 ms
Solving Poisson took 823.548 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 4.805767 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 4.808006 
Total time for convolution: 	 convolve: 4.774488 
Total time for convolution: 	 convolve: 4.813036 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.913 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.329 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.264 ms

This SCF took 25385.175 ms, scf error = 2.392e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.130986, lowerbound = -0.864765, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1113.873 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.010 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.285 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 15.313 ms
rank =  0, finding HY took 19.047 ms
rank =  0, distributing HY into block cyclic form took 11.917 ms
rank =  0, finding Y'*HY took 4.226 ms
Rank 0, Project_Hamiltonian used 50.529 ms
Total time for projection: 50.543 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.862398224114100
    last  calculated eigval = 0.027321062644216
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.86239822411410
lambda[   2] =  -0.77488863295396
lambda[   3] =  -0.55178009080346
lambda[   4] =  -0.50009991406437
lambda[   5] =  -0.40548273794378
lambda[   6] =  -0.40396366197866
lambda[   7] =  -0.32872258449355
lambda[   8] =  -0.22020824264187
lambda[   9] =  -0.21200193160422
lambda[  10] =  -0.03665560802389
lambda[  11] =  -0.01476704266287
lambda[  12] =  -0.00175445922278
lambda[  13] =   0.01126511312715
lambda[  14] =   0.01856205789189
lambda[  15] =   0.02732106264422
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 3.500 ms
rank =  0, Distributing orbital back into band + domain format took 11.972 ms
rank = 0, Subspace_Rotation used 15.485 ms

Total time for subspace rotation: 15.490 ms
rank = 0, Efermi =  -0.065453786209 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.941 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.188 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.182 ms
rank = 0, Calculating density took 1186.536 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.626 ms
rank = 0, D2D took 0.804 ms
rank = 0, Transfering density took 0.812 ms
Etot    =   -29.150768949821
Eband   =    -8.519092042297
E1      =    19.559638237789
E2      =    -7.855039816457
E3      =   -10.935512764604
Exc     =    -9.676982234327
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 3.071e-06, dEband = 6.153e-03
rank = 0, Calculating/Estimating energy took 0.994 ms, Etot = -29.150768950, dEtot = 3.071e-06, dEband = 6.153e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2189913706313, which took 0.055 ms

iter_count = 114, r_2norm = 5.613e-06, tol*||rhs|| = 8.760e-06

Anderson update took 58.889 ms, out of which F'*F took 27.598 ms; b-Ax took 185.216 ms, out of which Lap took 166.009 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 402.827 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004744, int_b + int_rho = 2.183e-14, checking this took 0.099 ms
2-norm of RHS = 636.4614953221389, which took 0.092 ms

iter_count = 216, r_2norm = 5.364e-04, tol*||rhs|| = 6.365e-04

Anderson update took 111.419 ms, out of which F'*F took 56.282 ms; b-Ax took 353.902 ms, out of which Lap took 316.806 ms
Solving Poisson took 747.895 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.503 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 4.935696 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 4.761330 
Total time for convolution: 	 convolve: 4.903758 
Total time for convolution: 	 convolve: 4.778512 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.145 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
---Transfer Veff_loc: D2D took 0.925 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.324 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.271 ms

This SCF took 25470.505 ms, scf error = 1.378e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.127321, lowerbound = -0.862398, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1115.711 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.876 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.409 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 15.309 ms
rank =  0, finding HY took 19.004 ms
rank =  0, distributing HY into block cyclic form took 11.938 ms
rank =  0, finding Y'*HY took 4.188 ms
Rank 0, Project_Hamiltonian used 50.467 ms
Total time for projection: 50.480 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.861492573039051
    last  calculated eigval = 0.025726221215986
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.86149257303905
lambda[   2] =  -0.77392536828304
lambda[   3] =  -0.55083559077480
lambda[   4] =  -0.49917414865126
lambda[   5] =  -0.40448940475674
lambda[   6] =  -0.40298104362640
lambda[   7] =  -0.32779925536790
lambda[   8] =  -0.21918647124807
lambda[   9] =  -0.21110879504279
lambda[  10] =  -0.03560139686579
lambda[  11] =  -0.01383716077177
lambda[  12] =  -0.00019770857431
lambda[  13] =   0.01172791415952
lambda[  14] =   0.01896341138810
lambda[  15] =   0.02572622121599
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 3.582 ms
rank =  0, Distributing orbital back into band + domain format took 11.967 ms
rank = 0, Subspace_Rotation used 15.562 ms

Total time for subspace rotation: 15.567 ms
rank = 0, Efermi =  -0.064399574993 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.067 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.088 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.166 ms
rank = 0, Calculating density took 1188.373 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
rank = 0, D2D took 0.749 ms
rank = 0, Transfering density took 0.758 ms
Etot    =   -29.150840835628
Eband   =    -8.501985302650
E1      =    19.551635593052
E2      =    -7.845500009378
E3      =   -10.937062592014
Exc     =    -9.678168235376
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 1.027e-05, dEband = 2.444e-03
rank = 0, Calculating/Estimating energy took 1.018 ms, Etot = -29.150840836, dEtot = 1.027e-05, dEband = 2.444e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1164299073034, which took 0.046 ms

iter_count = 108, r_2norm = 4.586e-06, tol*||rhs|| = 4.657e-06

Anderson update took 56.047 ms, out of which F'*F took 26.109 ms; b-Ax took 175.850 ms, out of which Lap took 157.979 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 381.834 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004746, int_b + int_rho = 3.638e-14, checking this took 0.940 ms
2-norm of RHS = 636.4248290637152, which took 0.084 ms

iter_count = 216, r_2norm = 5.952e-04, tol*||rhs|| = 6.364e-04

Anderson update took 111.709 ms, out of which F'*F took 51.235 ms; b-Ax took 348.575 ms, out of which Lap took 311.297 ms
Solving Poisson took 744.657 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 4.768699 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 4.763966 
Total time for convolution: 	 convolve: 4.767194 
Total time for convolution: 	 convolve: 4.896355 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.941 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.331 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.296 ms

This SCF took 25259.780 ms, scf error = 1.023e-03
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.125726, lowerbound = -0.861493, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1113.140 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.062 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.187 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.019 ms
rank =  0, Distribute data + matrix mult took 15.280 ms
rank =  0, finding HY took 18.946 ms
rank =  0, distributing HY into block cyclic form took 11.901 ms
rank =  0, finding Y'*HY took 4.381 ms
Rank 0, Project_Hamiltonian used 50.533 ms
Total time for projection: 50.548 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -0.860250085951501
    last  calculated eigval = 0.027381264386572
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.86025008595150
lambda[   2] =  -0.77265553245282
lambda[   3] =  -0.54966050745324
lambda[   4] =  -0.49801030897531
lambda[   5] =  -0.40325491618143
lambda[   6] =  -0.40179489299917
lambda[   7] =  -0.32651949606237
lambda[   8] =  -0.21786033509956
lambda[   9] =  -0.20981888057896
lambda[  10] =  -0.03214393927416
lambda[  11] =  -0.01240503143109
lambda[  12] =   0.00438953929968
lambda[  13] =   0.01441787501950
lambda[  14] =   0.02162343178737
lambda[  15] =   0.02738126438657
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 3.480 ms
rank =  0, Distributing orbital back into band + domain format took 11.984 ms
rank = 0, Subspace_Rotation used 15.476 ms

Total time for subspace rotation: 15.480 ms
rank = 0, Efermi =  -0.060942117402 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 3.074 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.977 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.154 ms
rank = 0, Calculating density took 1185.669 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
rank = 0, D2D took 0.800 ms
rank = 0, Transfering density took 0.809 ms
Etot    =   -29.150896201544
Eband   =    -8.479649912475
E1      =    19.540223285793
E2      =    -7.834388666211
E3      =   -10.938182179793
Exc     =    -9.679154928821
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 7.909e-06, dEband = 3.191e-03
rank = 0, Calculating/Estimating energy took 1.020 ms, Etot = -29.150896202, dEtot = 7.909e-06, dEband = 3.191e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0702127170167, which took 0.091 ms

iter_count = 114, r_2norm = 2.071e-06, tol*||rhs|| = 2.809e-06

Anderson update took 58.850 ms, out of which F'*F took 27.637 ms; b-Ax took 184.656 ms, out of which Lap took 165.914 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 402.989 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004742, int_b + int_rho = -3.638e-15, checking this took 0.099 ms
2-norm of RHS = 636.4373140859276, which took 0.091 ms

iter_count = 198, r_2norm = 5.737e-04, tol*||rhs|| = 6.364e-04

Anderson update took 101.196 ms, out of which F'*F took 47.449 ms; b-Ax took 320.321 ms, out of which Lap took 286.170 ms
Solving Poisson took 682.688 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 4.819985 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 52.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 4.761566 
Total time for convolution: 	 convolve: 4.789887 
Total time for convolution: 	 convolve: 4.776675 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.922 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.331 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.275 ms

This SCF took 25216.699 ms, scf error = 5.902e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.127381, lowerbound = -0.860250, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1132.116 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.886 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.390 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 15.297 ms
rank =  0, finding HY took 18.990 ms
rank =  0, distributing HY into block cyclic form took 11.955 ms
rank =  0, finding Y'*HY took 4.158 ms
Rank 0, Project_Hamiltonian used 50.426 ms
Total time for projection: 50.440 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -0.859148467960745
    last  calculated eigval = 0.028647221947101
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85914846796074
lambda[   2] =  -0.77155761866726
lambda[   3] =  -0.54862424246295
lambda[   4] =  -0.49698622678927
lambda[   5] =  -0.40219148060257
lambda[   6] =  -0.40076461043197
lambda[   7] =  -0.32547172203898
lambda[   8] =  -0.21676882880121
lambda[   9] =  -0.20878027727973
lambda[  10] =  -0.02952795201359
lambda[  11] =  -0.01139307744035
lambda[  12] =   0.00761140584819
lambda[  13] =   0.01565192184623
lambda[  14] =   0.02408512832666
lambda[  15] =   0.02864722194710
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 3.617 ms
rank =  0, Distributing orbital back into band + domain format took 11.859 ms
rank = 0, Subspace_Rotation used 15.489 ms

Total time for subspace rotation: 15.493 ms
rank = 0, Efermi =  -0.058326130219 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 3.066 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.190 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.150 ms
rank = 0, Calculating density took 1204.757 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
rank = 0, D2D took 0.735 ms
rank = 0, Transfering density took 0.743 ms
Etot    =   -29.151001876522
Eband   =    -8.460586950957
E1      =    19.530230171814
E2      =    -7.824742159205
E3      =   -10.940424008240
Exc     =    -9.680925772778
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 1.510e-05, dEband = 2.723e-03
rank = 0, Calculating/Estimating energy took 1.068 ms, Etot = -29.151001877, dEtot = 1.510e-05, dEband = 2.723e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0617008846915, which took 0.046 ms

iter_count = 108, r_2norm = 1.925e-06, tol*||rhs|| = 2.468e-06

Anderson update took 55.808 ms, out of which F'*F took 25.902 ms; b-Ax took 174.978 ms, out of which Lap took 156.825 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 380.314 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004746, int_b + int_rho = 3.638e-14, checking this took 0.091 ms
2-norm of RHS = 636.4559411605144, which took 0.105 ms

iter_count = 186, r_2norm = 5.431e-04, tol*||rhs|| = 6.365e-04

Anderson update took 94.940 ms, out of which F'*F took 44.225 ms; b-Ax took 300.364 ms, out of which Lap took 268.436 ms
Solving Poisson took 640.262 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 4.765607 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 85.827 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 4.770793 
Total time for convolution: 	 convolve: 4.755897 
Total time for convolution: 	 convolve: 4.808335 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.138 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.927 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.286 ms

This SCF took 25168.357 ms, scf error = 3.953e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.128647, lowerbound = -0.859148, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1137.263 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.909 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.325 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 15.269 ms
rank =  0, finding HY took 19.065 ms
rank =  0, distributing HY into block cyclic form took 11.985 ms
rank =  0, finding Y'*HY took 4.177 ms
Rank 0, Project_Hamiltonian used 50.523 ms
Total time for projection: 50.538 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -0.858897612264379
    last  calculated eigval = 0.030578794990742
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85889761226438
lambda[   2] =  -0.77136452154986
lambda[   3] =  -0.54836103139794
lambda[   4] =  -0.49672316629505
lambda[   5] =  -0.40197078255535
lambda[   6] =  -0.40052358435381
lambda[   7] =  -0.32520923746816
lambda[   8] =  -0.21661166849334
lambda[   9] =  -0.20855748038521
lambda[  10] =  -0.02667325624974
lambda[  11] =  -0.01112154523098
lambda[  12] =   0.00999775496035
lambda[  13] =   0.01667329578083
lambda[  14] =   0.02697325086378
lambda[  15] =   0.03057879499074
==subpsace eigenproblem: bcast eigvals took 0.058 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 3.493 ms
rank =  0, Distributing orbital back into band + domain format took 11.936 ms
rank = 0, Subspace_Rotation used 15.443 ms

Total time for subspace rotation: 15.448 ms
rank = 0, Efermi =  -0.055471434430 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.962 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.189 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.164 ms
rank = 0, Calculating density took 1209.887 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.610 ms
rank = 0, D2D took 0.768 ms
rank = 0, Transfering density took 0.775 ms
Etot    =   -29.151060008320
Eband   =    -8.456438170328
E1      =    19.528998683398
E2      =    -7.821895166922
E3      =   -10.940018480862
Exc     =    -9.680648677127
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 8.305e-06, dEband = 5.927e-04
rank = 0, Calculating/Estimating energy took 1.400 ms, Etot = -29.151060008, dEtot = 8.305e-06, dEband = 5.927e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0577708117937, which took 0.046 ms

iter_count = 108, r_2norm = 1.912e-06, tol*||rhs|| = 2.311e-06

Anderson update took 55.367 ms, out of which F'*F took 26.282 ms; b-Ax took 176.015 ms, out of which Lap took 157.887 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 381.202 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004742, int_b + int_rho = 0.000e+00, checking this took 0.099 ms
2-norm of RHS = 636.4574410987340, which took 0.088 ms

iter_count = 138, r_2norm = 5.928e-04, tol*||rhs|| = 6.365e-04

Anderson update took 71.447 ms, out of which F'*F took 32.764 ms; b-Ax took 223.049 ms, out of which Lap took 199.334 ms
Solving Poisson took 477.615 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 4.788677 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 4.754431 
Total time for convolution: 	 convolve: 4.780311 
Total time for convolution: 	 convolve: 4.826420 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.777 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.521 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
---Transfer Veff_loc: D2D took 0.898 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.321 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.242 ms

This SCF took 24964.983 ms, scf error = 2.764e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.130579, lowerbound = -0.858898, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1105.859 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.931 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.263 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.180 ms
rank =  0, Distribute data + matrix mult took 15.389 ms
rank =  0, finding HY took 18.796 ms
rank =  0, distributing HY into block cyclic form took 11.986 ms
rank =  0, finding Y'*HY took 4.142 ms
Rank 0, Project_Hamiltonian used 50.339 ms
Total time for projection: 50.368 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -0.858751837142685
    last  calculated eigval = 0.031251139490251
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85875183714269
lambda[   2] =  -0.77121461550556
lambda[   3] =  -0.54821842293761
lambda[   4] =  -0.49658300680679
lambda[   5] =  -0.40182561111113
lambda[   6] =  -0.40038251259097
lambda[   7] =  -0.32506537696895
lambda[   8] =  -0.21646075313489
lambda[   9] =  -0.20841216681668
lambda[  10] =  -0.02571103270559
lambda[  11] =  -0.01098078575749
lambda[  12] =   0.01060407673829
lambda[  13] =   0.01677484008707
lambda[  14] =   0.02802689737980
lambda[  15] =   0.03125113949025
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 3.573 ms
rank =  0, Distributing orbital back into band + domain format took 11.834 ms
rank = 0, Subspace_Rotation used 15.418 ms

Total time for subspace rotation: 15.423 ms
rank = 0, Efermi =  -0.054509210922 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.867 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.226 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 1178.196 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
rank = 0, D2D took 1.066 ms
rank = 0, Transfering density took 1.072 ms
Etot    =   -29.151073250914
Eband   =    -8.453828606803
E1      =    19.527665512122
E2      =    -7.820553552851
E3      =   -10.940272812482
Exc     =    -9.680851029519
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 1.892e-06, dEband = 3.728e-04
rank = 0, Calculating/Estimating energy took 0.862 ms, Etot = -29.151073251, dEtot = 1.892e-06, dEband = 3.728e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0457182242153, which took 0.047 ms

iter_count = 108, r_2norm = 1.456e-06, tol*||rhs|| = 1.829e-06

Anderson update took 55.408 ms, out of which F'*F took 26.103 ms; b-Ax took 175.436 ms, out of which Lap took 157.353 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 380.210 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004753, int_b + int_rho = 1.055e-13, checking this took 0.097 ms
2-norm of RHS = 636.4603338020045, which took 0.098 ms

iter_count = 162, r_2norm = 5.439e-04, tol*||rhs|| = 6.365e-04

Anderson update took 82.814 ms, out of which F'*F took 38.614 ms; b-Ax took 261.211 ms, out of which Lap took 233.358 ms
Solving Poisson took 556.871 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 4.764928 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 4.792786 
Total time for convolution: 	 convolve: 4.762408 
Total time for convolution: 	 convolve: 4.758063 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.778 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.484 ms
---Transfer Veff_loc: D2D took 0.934 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.329 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.285 ms

This SCF took 24941.798 ms, scf error = 2.376e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.131251, lowerbound = -0.858752, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1144.215 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.782 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.215 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.410 ms
rank =  0, Distribute data + matrix mult took 15.418 ms
rank =  0, finding HY took 18.817 ms
rank =  0, distributing HY into block cyclic form took 11.924 ms
rank =  0, finding Y'*HY took 4.135 ms
Rank 0, Project_Hamiltonian used 50.326 ms
Total time for projection: 50.344 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -0.858630014628689
    last  calculated eigval = 0.031355474758222
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85863001462869
lambda[   2] =  -0.77108480324584
lambda[   3] =  -0.54807871474846
lambda[   4] =  -0.49644480512099
lambda[   5] =  -0.40169311199328
lambda[   6] =  -0.40024679824212
lambda[   7] =  -0.32493277060328
lambda[   8] =  -0.21633438353027
lambda[   9] =  -0.20827525210863
lambda[  10] =  -0.02560843556159
lambda[  11] =  -0.01095831204881
lambda[  12] =   0.00937017688508
lambda[  13] =   0.01591112178332
lambda[  14] =   0.02927236340658
lambda[  15] =   0.03135547475822
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 3.463 ms
rank =  0, Distributing orbital back into band + domain format took 11.765 ms
rank = 0, Subspace_Rotation used 15.243 ms

Total time for subspace rotation: 15.249 ms
rank = 0, Efermi =  -0.054406613692 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.925 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.182 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.149 ms
rank = 0, Calculating density took 1216.381 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
rank = 0, D2D took 1.187 ms
rank = 0, Transfering density took 1.193 ms
Etot    =   -29.151130850658
Eband   =    -8.451441309213
E1      =    19.526700982489
E2      =    -7.819094181303
E3      =   -10.940210431789
Exc     =    -9.680809644980
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 8.229e-06, dEband = 3.410e-04
rank = 0, Calculating/Estimating energy took 0.875 ms, Etot = -29.151130851, dEtot = 8.229e-06, dEband = 3.410e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0437469708814, which took 0.049 ms

iter_count = 108, r_2norm = 1.423e-06, tol*||rhs|| = 1.750e-06

Anderson update took 55.589 ms, out of which F'*F took 26.076 ms; b-Ax took 175.472 ms, out of which Lap took 157.126 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 381.160 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004744, int_b + int_rho = 2.183e-14, checking this took 0.093 ms
2-norm of RHS = 636.4577836670679, which took 0.108 ms

iter_count = 108, r_2norm = 5.576e-04, tol*||rhs|| = 6.365e-04

Anderson update took 55.409 ms, out of which F'*F took 25.795 ms; b-Ax took 174.022 ms, out of which Lap took 155.509 ms
Solving Poisson took 372.630 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 4.810935 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 4.795413 
Total time for convolution: 	 convolve: 4.758053 
Total time for convolution: 	 convolve: 4.852045 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.157 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
---Transfer Veff_loc: D2D took 0.928 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.322 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.273 ms

This SCF took 24937.912 ms, scf error = 2.160e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.131355, lowerbound = -0.858630, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1115.294 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.653 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.199 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.163 ms
rank =  0, Distribute data + matrix mult took 15.028 ms
rank =  0, finding HY took 18.785 ms
rank =  0, distributing HY into block cyclic form took 11.753 ms
rank =  0, finding Y'*HY took 4.309 ms
Rank 0, Project_Hamiltonian used 49.901 ms
Total time for projection: 49.915 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -0.858522770371944
    last  calculated eigval = 0.031711830101404
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85852277037194
lambda[   2] =  -0.77097757364367
lambda[   3] =  -0.54798544578323
lambda[   4] =  -0.49635251646587
lambda[   5] =  -0.40159567602013
lambda[   6] =  -0.40015539253531
lambda[   7] =  -0.32483521491536
lambda[   8] =  -0.21623893048119
lambda[   9] =  -0.20817806436653
lambda[  10] =  -0.02527065071496
lambda[  11] =  -0.01087245624711
lambda[  12] =   0.00964338751118
lambda[  13] =   0.01579055781063
lambda[  14] =   0.02949792931493
lambda[  15] =   0.03171183010140
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 3.480 ms
rank =  0, Distributing orbital back into band + domain format took 11.670 ms
rank = 0, Subspace_Rotation used 15.165 ms

Total time for subspace rotation: 15.170 ms
rank = 0, Efermi =  -0.054068828925 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 3.015 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.150 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.154 ms
rank = 0, Calculating density took 1187.009 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.520 ms
rank = 0, D2D took 1.144 ms
rank = 0, Transfering density took 1.153 ms
Etot    =   -29.151133822267
Eband   =    -8.449683169926
E1      =    19.525619148108
E2      =    -7.818357815597
E3      =   -10.940472904043
Exc     =    -9.681015028042
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 4.245e-07, dEband = 2.512e-04
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -29.151133822, dEtot = 4.245e-07, dEband = 2.512e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0257588739524, which took 0.045 ms

iter_count = 108, r_2norm = 9.098e-07, tol*||rhs|| = 1.030e-06

Anderson update took 54.919 ms, out of which F'*F took 26.227 ms; b-Ax took 174.790 ms, out of which Lap took 156.768 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 379.782 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004747, int_b + int_rho = 4.729e-14, checking this took 0.092 ms
2-norm of RHS = 636.4588145089232, which took 0.081 ms

iter_count = 156, r_2norm = 5.711e-04, tol*||rhs|| = 6.365e-04

Anderson update took 79.671 ms, out of which F'*F took 36.885 ms; b-Ax took 251.073 ms, out of which Lap took 224.138 ms
Solving Poisson took 535.962 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 4.783483 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 87.712 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 4.756435 
Total time for convolution: 	 convolve: 4.768324 
Total time for convolution: 	 convolve: 4.760063 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.147 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
---Transfer Veff_loc: D2D took 0.917 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.320 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.260 ms

This SCF took 25002.504 ms, scf error = 1.682e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.131712, lowerbound = -0.858523, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1123.104 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.946 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.203 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.108 ms
rank =  0, Distribute data + matrix mult took 15.269 ms
rank =  0, finding HY took 19.015 ms
rank =  0, distributing HY into block cyclic form took 11.996 ms
rank =  0, finding Y'*HY took 4.156 ms
Rank 0, Project_Hamiltonian used 50.463 ms
Total time for projection: 50.477 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.858455424158806
    last  calculated eigval = 0.032024833107691
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85845542415881
lambda[   2] =  -0.77091906278602
lambda[   3] =  -0.54790824955265
lambda[   4] =  -0.49627291300777
lambda[   5] =  -0.40153193713643
lambda[   6] =  -0.40007935234960
lambda[   7] =  -0.32476755426336
lambda[   8] =  -0.21621925953023
lambda[   9] =  -0.20812766411521
lambda[  10] =  -0.02516511025880
lambda[  11] =  -0.01086531201102
lambda[  12] =   0.00935556557161
lambda[  13] =   0.01528877439111
lambda[  14] =   0.02952498009865
lambda[  15] =   0.03202483310769
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 3.385 ms
rank =  0, Distributing orbital back into band + domain format took 11.643 ms
rank = 0, Subspace_Rotation used 15.040 ms

Total time for subspace rotation: 15.045 ms
rank = 0, Efermi =  -0.053963288427 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.736 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.347 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.207 ms
rank = 0, Calculating density took 1195.218 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
rank = 0, D2D took 1.220 ms
rank = 0, Transfering density took 1.227 ms
Etot    =   -29.151158509203
Eband   =    -8.448562834556
E1      =    19.525281138941
E2      =    -7.817594420643
E3      =   -10.940268649923
Exc     =    -9.680854392107
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 3.527e-06, dEband = 1.600e-04
rank = 0, Calculating/Estimating energy took 0.890 ms, Etot = -29.151158509, dEtot = 3.527e-06, dEband = 1.600e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0171264598048, which took 0.070 ms

iter_count = 114, r_2norm = 4.568e-07, tol*||rhs|| = 6.851e-07

Anderson update took 58.762 ms, out of which F'*F took 27.686 ms; b-Ax took 184.988 ms, out of which Lap took 165.951 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 402.073 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004752, int_b + int_rho = 9.823e-14, checking this took 0.094 ms
2-norm of RHS = 636.4586225906887, which took 0.084 ms

iter_count = 114, r_2norm = 5.818e-04, tol*||rhs|| = 6.365e-04

Anderson update took 58.585 ms, out of which F'*F took 27.103 ms; b-Ax took 184.332 ms, out of which Lap took 164.770 ms
Solving Poisson took 394.623 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 4.806510 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 4.797592 
Total time for convolution: 	 convolve: 4.779563 
Total time for convolution: 	 convolve: 4.783371 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.515 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.153 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
---Transfer Veff_loc: D2D took 0.913 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.268 ms

This SCF took 24916.680 ms, scf error = 1.750e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.132025, lowerbound = -0.858455, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1159.214 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.873 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.538 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.429 ms
rank =  0, finding HY took 18.947 ms
rank =  0, distributing HY into block cyclic form took 12.087 ms
rank =  0, finding Y'*HY took 4.094 ms
Rank 0, Project_Hamiltonian used 50.606 ms
Total time for projection: 50.622 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.858411639675527
    last  calculated eigval = 0.032363013925210
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85841163967553
lambda[   2] =  -0.77087497457194
lambda[   3] =  -0.54786481812703
lambda[   4] =  -0.49622757265460
lambda[   5] =  -0.40148988403371
lambda[   6] =  -0.40003497219749
lambda[   7] =  -0.32472580980499
lambda[   8] =  -0.21617975442450
lambda[   9] =  -0.20808559580329
lambda[  10] =  -0.02484779240842
lambda[  11] =  -0.01083120621195
lambda[  12] =   0.00944730407128
lambda[  13] =   0.01543306985039
lambda[  14] =   0.02970268383901
lambda[  15] =   0.03236301392521
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.176 ms
rank =  0, subspace rotation using ScaLAPACK took 3.556 ms
rank =  0, Distributing orbital back into band + domain format took 12.011 ms
rank = 0, Subspace_Rotation used 15.579 ms

Total time for subspace rotation: 15.583 ms
rank = 0, Efermi =  -0.053645970642 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 3.015 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.111 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.165 ms
rank = 0, Calculating density took 1231.983 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.579 ms
rank = 0, D2D took 0.772 ms
rank = 0, Transfering density took 0.781 ms
Etot    =   -29.151161839627
Eband   =    -8.447790043333
E1      =    19.524914958562
E2      =    -7.817182620415
E3      =   -10.940280047843
Exc     =    -9.680863931068
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 4.758e-07, dEband = 1.104e-04
rank = 0, Calculating/Estimating energy took 0.980 ms, Etot = -29.151161840, dEtot = 4.758e-07, dEband = 1.104e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0169661560619, which took 0.047 ms

iter_count = 114, r_2norm = 4.480e-07, tol*||rhs|| = 6.786e-07

Anderson update took 58.616 ms, out of which F'*F took 27.459 ms; b-Ax took 184.911 ms, out of which Lap took 165.838 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 401.663 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004752, int_b + int_rho = 9.823e-14, checking this took 0.111 ms
2-norm of RHS = 636.4584098612218, which took 0.094 ms

iter_count = 72, r_2norm = 5.285e-04, tol*||rhs|| = 6.365e-04

Anderson update took 36.870 ms, out of which F'*F took 17.066 ms; b-Ax took 116.329 ms, out of which Lap took 103.983 ms
Solving Poisson took 250.098 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 4.796775 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 4.771902 
Total time for convolution: 	 convolve: 4.773990 
Total time for convolution: 	 convolve: 4.774340 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
---Transfer Veff_loc: D2D took 0.932 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.332 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.287 ms

This SCF took 24744.853 ms, scf error = 1.657e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.132363, lowerbound = -0.858412, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1133.609 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.964 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.263 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.180 ms
rank =  0, Distribute data + matrix mult took 15.443 ms
rank =  0, finding HY took 19.500 ms
rank =  0, distributing HY into block cyclic form took 11.954 ms
rank =  0, finding Y'*HY took 4.201 ms
Rank 0, Project_Hamiltonian used 51.125 ms
Total time for projection: 51.139 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.858389886394467
    last  calculated eigval = 0.032438657882624
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85838988639447
lambda[   2] =  -0.77085221480742
lambda[   3] =  -0.54784455926643
lambda[   4] =  -0.49620719602864
lambda[   5] =  -0.40146853645633
lambda[   6] =  -0.40001448513710
lambda[   7] =  -0.32470505751516
lambda[   8] =  -0.21615679212288
lambda[   9] =  -0.20806365551198
lambda[  10] =  -0.02474744485875
lambda[  11] =  -0.01081227051115
lambda[  12] =   0.00948594586680
lambda[  13] =   0.01551071539277
lambda[  14] =   0.02964413086128
lambda[  15] =   0.03243865788262
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 3.587 ms
rank =  0, Distributing orbital back into band + domain format took 11.904 ms
rank = 0, Subspace_Rotation used 15.502 ms

Total time for subspace rotation: 15.507 ms
rank = 0, Efermi =  -0.053545623040 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 3.111 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.065 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.176 ms
rank = 0, Calculating density took 1206.901 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.624 ms
rank = 0, D2D took 0.815 ms
rank = 0, Transfering density took 0.822 ms
Etot    =   -29.151160935259
Eband   =    -8.447404767224
E1      =    19.524707105296
E2      =    -7.816999845535
E3      =   -10.940312416722
Exc     =    -9.680890043541
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 1.292e-07, dEband = 5.504e-05
rank = 0, Calculating/Estimating energy took 0.928 ms, Etot = -29.151160935, dEtot = 1.292e-07, dEband = 5.504e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0255595008173, which took 0.048 ms

iter_count = 108, r_2norm = 7.023e-07, tol*||rhs|| = 1.022e-06

Anderson update took 55.519 ms, out of which F'*F took 26.439 ms; b-Ax took 176.202 ms, out of which Lap took 158.132 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 381.775 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004747, int_b + int_rho = 4.729e-14, checking this took 0.104 ms
2-norm of RHS = 636.4582680871223, which took 0.109 ms

iter_count = 108, r_2norm = 5.665e-04, tol*||rhs|| = 6.365e-04

Anderson update took 55.491 ms, out of which F'*F took 25.753 ms; b-Ax took 175.023 ms, out of which Lap took 156.334 ms
Solving Poisson took 373.824 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 4.794606 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.871 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 4.795406 
Total time for convolution: 	 convolve: 4.799217 
Total time for convolution: 	 convolve: 4.769274 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.905 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.342 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.268 ms

This SCF took 24926.293 ms, scf error = 1.561e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.132439, lowerbound = -0.858390, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1119.518 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.873 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.290 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.087 ms
rank =  0, Distribute data + matrix mult took 15.263 ms
rank =  0, finding HY took 19.015 ms
rank =  0, distributing HY into block cyclic form took 11.895 ms
rank =  0, finding Y'*HY took 4.264 ms
Rank 0, Project_Hamiltonian used 50.473 ms
Total time for projection: 50.491 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.858297921535415
    last  calculated eigval = 0.032267907959718
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85829792153541
lambda[   2] =  -0.77077299076903
lambda[   3] =  -0.54775570272590
lambda[   4] =  -0.49612020901275
lambda[   5] =  -0.40138759841146
lambda[   6] =  -0.39993249720138
lambda[   7] =  -0.32461972181468
lambda[   8] =  -0.21609376820014
lambda[   9] =  -0.20798608657056
lambda[  10] =  -0.02491094074916
lambda[  11] =  -0.01075598766892
lambda[  12] =   0.00925231433050
lambda[  13] =   0.01572845129095
lambda[  14] =   0.02921648540317
lambda[  15] =   0.03226790795972
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 3.548 ms
rank =  0, Distributing orbital back into band + domain format took 11.970 ms
rank = 0, Subspace_Rotation used 15.538 ms

Total time for subspace rotation: 15.542 ms
rank = 0, Efermi =  -0.053709118923 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 3.117 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.128 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.142 ms
rank = 0, Calculating density took 1192.221 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.517 ms
rank = 0, D2D took 0.853 ms
rank = 0, Transfering density took 0.865 ms
Etot    =   -29.151169196210
Eband   =    -8.445932993231
E1      =    19.523903816248
E2      =    -7.816293923813
E3      =   -10.940452065181
Exc     =    -9.681000516174
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 1.180e-06, dEband = 2.103e-04
rank = 0, Calculating/Estimating energy took 0.948 ms, Etot = -29.151169196, dEtot = 1.180e-06, dEband = 2.103e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0233626078412, which took 0.059 ms

iter_count = 108, r_2norm = 6.774e-07, tol*||rhs|| = 9.345e-07

Anderson update took 55.706 ms, out of which F'*F took 26.327 ms; b-Ax took 175.641 ms, out of which Lap took 157.623 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 381.442 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004745, int_b + int_rho = 3.274e-14, checking this took 0.091 ms
2-norm of RHS = 636.4600364442050, which took 0.106 ms

iter_count = 96, r_2norm = 6.264e-04, tol*||rhs|| = 6.365e-04

Anderson update took 49.389 ms, out of which F'*F took 22.898 ms; b-Ax took 155.087 ms, out of which Lap took 138.623 ms
Solving Poisson took 333.203 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.508 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 4.774832 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 4.796903 
Total time for convolution: 	 convolve: 4.752390 
Total time for convolution: 	 convolve: 4.758837 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
---Transfer Veff_loc: D2D took 0.941 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.445 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.410 ms

This SCF took 24733.177 ms, scf error = 1.376e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.132268, lowerbound = -0.858298, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1106.523 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.743 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.235 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 15.017 ms
rank =  0, finding HY took 18.753 ms
rank =  0, distributing HY into block cyclic form took 11.606 ms
rank =  0, finding Y'*HY took 4.302 ms
Rank 0, Project_Hamiltonian used 49.704 ms
Total time for projection: 49.719 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.858298748455344
    last  calculated eigval = 0.033241128612821
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85829874845534
lambda[   2] =  -0.77076954237330
lambda[   3] =  -0.54775091367905
lambda[   4] =  -0.49611395991588
lambda[   5] =  -0.40138349284152
lambda[   6] =  -0.39992498985458
lambda[   7] =  -0.32461703890380
lambda[   8] =  -0.21608180183318
lambda[   9] =  -0.20798015927009
lambda[  10] =  -0.02409505289842
lambda[  11] =  -0.01072115335026
lambda[  12] =   0.00966846881759
lambda[  13] =   0.01650467055667
lambda[  14] =   0.03011109428921
lambda[  15] =   0.03324112861282
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 3.433 ms
rank =  0, Distributing orbital back into band + domain format took 11.640 ms
rank = 0, Subspace_Rotation used 15.086 ms

Total time for subspace rotation: 15.090 ms
rank = 0, Efermi =  -0.052893231055 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.898 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.177 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.154 ms
rank = 0, Calculating density took 1177.845 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.599 ms
rank = 0, D2D took 0.792 ms
rank = 0, Transfering density took 0.801 ms
Etot    =   -29.151165944651
Eband   =    -8.445841294977
E1      =    19.523965462409
E2      =    -7.816157558766
E3      =   -10.940396296720
Exc     =    -9.680958475523
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 4.645e-07, dEband = 1.310e-05
rank = 0, Calculating/Estimating energy took 0.903 ms, Etot = -29.151165945, dEtot = 4.645e-07, dEband = 1.310e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0240158597382, which took 0.062 ms

iter_count = 108, r_2norm = 6.719e-07, tol*||rhs|| = 9.606e-07

Anderson update took 54.312 ms, out of which F'*F took 25.762 ms; b-Ax took 173.844 ms, out of which Lap took 155.830 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.119 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004742, int_b + int_rho = 0.000e+00, checking this took 0.961 ms
2-norm of RHS = 636.4603246575680, which took 0.106 ms

iter_count = 78, r_2norm = 5.817e-04, tol*||rhs|| = 6.365e-04

Anderson update took 40.962 ms, out of which F'*F took 18.311 ms; b-Ax took 128.802 ms, out of which Lap took 115.536 ms
Solving Poisson took 272.292 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 4.792649 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 4.812025 
Total time for convolution: 	 convolve: 4.819202 
Total time for convolution: 	 convolve: 4.789280 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
---Transfer Veff_loc: D2D took 0.923 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.319 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.265 ms

This SCF took 24828.795 ms, scf error = 1.550e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.133241, lowerbound = -0.858299, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1128.575 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.001 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.242 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.084 ms
rank =  0, Distribute data + matrix mult took 15.335 ms
rank =  0, finding HY took 19.025 ms
rank =  0, distributing HY into block cyclic form took 11.823 ms
rank =  0, finding Y'*HY took 4.223 ms
Rank 0, Project_Hamiltonian used 50.432 ms
Total time for projection: 50.445 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -0.858289911858215
    last  calculated eigval = 0.033228574939990
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85828991185821
lambda[   2] =  -0.77075667665675
lambda[   3] =  -0.54774188178037
lambda[   4] =  -0.49610503143183
lambda[   5] =  -0.40137305214293
lambda[   6] =  -0.39991461399690
lambda[   7] =  -0.32460719515350
lambda[   8] =  -0.21606630501908
lambda[   9] =  -0.20796903168617
lambda[  10] =  -0.02411524983241
lambda[  11] =  -0.01071301443106
lambda[  12] =   0.00960153239412
lambda[  13] =   0.01676510812278
lambda[  14] =   0.03009587693499
lambda[  15] =   0.03322857493999
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 3.543 ms
rank =  0, Distributing orbital back into band + domain format took 11.984 ms
rank = 0, Subspace_Rotation used 15.538 ms

Total time for subspace rotation: 15.543 ms
rank = 0, Efermi =  -0.052913428007 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.918 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.183 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.144 ms
rank = 0, Calculating density took 1201.085 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.607 ms
rank = 0, D2D took 0.813 ms
rank = 0, Transfering density took 0.822 ms
Etot    =   -29.151168991567
Eband   =    -8.445647400176
E1      =    19.523873328111
E2      =    -7.816053021775
E3      =   -10.940394644789
Exc     =    -9.680957094019
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 4.353e-07, dEband = 2.770e-05
rank = 0, Calculating/Estimating energy took 0.906 ms, Etot = -29.151168992, dEtot = 4.353e-07, dEband = 2.770e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0258786554162, which took 0.093 ms

iter_count = 108, r_2norm = 6.519e-07, tol*||rhs|| = 1.035e-06

Anderson update took 55.227 ms, out of which F'*F took 26.082 ms; b-Ax took 174.768 ms, out of which Lap took 156.865 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 379.143 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004745, int_b + int_rho = 2.910e-14, checking this took 0.095 ms
2-norm of RHS = 636.4602522722026, which took 0.092 ms

iter_count = 72, r_2norm = 6.230e-04, tol*||rhs|| = 6.365e-04

Anderson update took 37.614 ms, out of which F'*F took 16.973 ms; b-Ax took 115.269 ms, out of which Lap took 103.072 ms
Solving Poisson took 248.783 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.134 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 4.820588 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 4.754062 
Total time for convolution: 	 convolve: 4.770083 
Total time for convolution: 	 convolve: 4.780319 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.149 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
---Transfer Veff_loc: D2D took 0.905 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.332 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.259 ms

This SCF took 24705.234 ms, scf error = 1.500e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.133229, lowerbound = -0.858290, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1137.774 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.980 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.292 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.290 ms
rank =  0, finding HY took 18.998 ms
rank =  0, distributing HY into block cyclic form took 11.735 ms
rank =  0, finding Y'*HY took 4.936 ms
Rank 0, Project_Hamiltonian used 50.986 ms
Total time for projection: 51.001 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -0.858303545089244
    last  calculated eigval = 0.032967122136160
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85830354508924
lambda[   2] =  -0.77076916644020
lambda[   3] =  -0.54775267526550
lambda[   4] =  -0.49611580114115
lambda[   5] =  -0.40138525760058
lambda[   6] =  -0.39992549916106
lambda[   7] =  -0.32461872057818
lambda[   8] =  -0.21607957617885
lambda[   9] =  -0.20798022944906
lambda[  10] =  -0.02436906313785
lambda[  11] =  -0.01073896500880
lambda[  12] =   0.00932485162135
lambda[  13] =   0.01686247199897
lambda[  14] =   0.02976827055743
lambda[  15] =   0.03296712213616
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 3.429 ms
rank =  0, Distributing orbital back into band + domain format took 11.793 ms
rank = 0, Subspace_Rotation used 15.235 ms

Total time for subspace rotation: 15.240 ms
rank = 0, Efermi =  -0.053167241307 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.908 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.176 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.188 ms
rank = 0, Calculating density took 1210.593 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
rank = 0, D2D took 0.709 ms
rank = 0, Transfering density took 0.719 ms
Etot    =   -29.151169810197
Eband   =    -8.445860942540
E1      =    19.523998456932
E2      =    -7.816150166323
E3      =   -10.940347441859
Exc     =    -9.680919440725
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 1.169e-07, dEband = 3.051e-05
rank = 0, Calculating/Estimating energy took 1.266 ms, Etot = -29.151169810, dEtot = 1.169e-07, dEband = 3.051e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0292757409283, which took 0.062 ms

iter_count = 102, r_2norm = 1.082e-06, tol*||rhs|| = 1.171e-06

Anderson update took 52.992 ms, out of which F'*F took 24.710 ms; b-Ax took 165.485 ms, out of which Lap took 148.605 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 361.329 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004747, int_b + int_rho = 4.729e-14, checking this took 0.094 ms
2-norm of RHS = 636.4591719034786, which took 0.108 ms

iter_count = 90, r_2norm = 5.978e-04, tol*||rhs|| = 6.365e-04

Anderson update took 46.451 ms, out of which F'*F took 21.364 ms; b-Ax took 145.109 ms, out of which Lap took 129.682 ms
Solving Poisson took 312.006 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 4.825083 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 4.801857 
Total time for convolution: 	 convolve: 4.760606 
Total time for convolution: 	 convolve: 4.789198 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.523 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.931 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.316 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.269 ms

This SCF took 24818.151 ms, scf error = 1.517e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.132967, lowerbound = -0.858304, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1134.490 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.033 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.276 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.328 ms
rank =  0, finding HY took 19.059 ms
rank =  0, distributing HY into block cyclic form took 11.945 ms
rank =  0, finding Y'*HY took 4.147 ms
Rank 0, Project_Hamiltonian used 50.506 ms
Total time for projection: 50.520 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.095 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.166 ms
    first calculated eigval = -0.858298252114116
    last  calculated eigval = 0.031093901655488
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85829825211412
lambda[   2] =  -0.77076824785681
lambda[   3] =  -0.54775181671229
lambda[   4] =  -0.49611499362032
lambda[   5] =  -0.40138504103120
lambda[   6] =  -0.39992624245877
lambda[   7] =  -0.32461722722174
lambda[   8] =  -0.21608486345882
lambda[   9] =  -0.20798081238112
lambda[  10] =  -0.02603629151707
lambda[  11] =  -0.01080391526826
lambda[  12] =   0.00822185485326
lambda[  13] =   0.01595796782639
lambda[  14] =   0.02744532529228
lambda[  15] =   0.03109390165549
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 3.528 ms
rank =  0, Distributing orbital back into band + domain format took 11.931 ms
rank = 0, Subspace_Rotation used 15.471 ms

Total time for subspace rotation: 15.476 ms
rank = 0, Efermi =  -0.054834469668 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 3.024 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.175 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.157 ms
rank = 0, Calculating density took 1207.147 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.597 ms
rank = 0, D2D took 0.766 ms
rank = 0, Transfering density took 0.774 ms
Etot    =   -29.151177226060
Eband   =    -8.445854994493
E1      =    19.523925784681
E2      =    -7.816204484054
E3      =   -10.940363028606
Exc     =    -9.680930036862
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 1.059e-06, dEband = 8.497e-07
rank = 0, Calculating/Estimating energy took 1.404 ms, Etot = -29.151177226, dEtot = 1.059e-06, dEband = 8.497e-07
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0320485992624, which took 0.051 ms

iter_count = 102, r_2norm = 1.090e-06, tol*||rhs|| = 1.282e-06

Anderson update took 52.865 ms, out of which F'*F took 24.752 ms; b-Ax took 165.689 ms, out of which Lap took 148.683 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 361.307 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004746, int_b + int_rho = 3.638e-14, checking this took 0.090 ms
2-norm of RHS = 636.4588640310503, which took 0.091 ms

iter_count = 66, r_2norm = 5.874e-04, tol*||rhs|| = 6.365e-04

Anderson update took 33.866 ms, out of which F'*F took 15.613 ms; b-Ax took 106.627 ms, out of which Lap took 95.302 ms
Solving Poisson took 229.953 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 4.800250 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 4.753666 
Total time for convolution: 	 convolve: 4.782206 
Total time for convolution: 	 convolve: 4.818288 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.771 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.925 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.326 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.274 ms

This SCF took 24709.934 ms, scf error = 1.327e-04
-------------
SCF iter 24  
-------------

 Chebfilt 27, in Chebyshev filtering, lambda_cutoff = 0.131094, lowerbound = -0.858298, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1143.764 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.883 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.319 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.091 ms
rank =  0, Distribute data + matrix mult took 15.304 ms
rank =  0, finding HY took 18.950 ms
rank =  0, distributing HY into block cyclic form took 12.008 ms
rank =  0, finding Y'*HY took 4.112 ms
Rank 0, Project_Hamiltonian used 50.399 ms
Total time for projection: 50.411 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.061 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.858307070155116
    last  calculated eigval = 0.030849676137177
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85830707015512
lambda[   2] =  -0.77077948341803
lambda[   3] =  -0.54776092915345
lambda[   4] =  -0.49612395556786
lambda[   5] =  -0.40139582758020
lambda[   6] =  -0.39993624326879
lambda[   7] =  -0.32462716432286
lambda[   8] =  -0.21610020847063
lambda[   9] =  -0.20799168754016
lambda[  10] =  -0.02624111422743
lambda[  11] =  -0.01082226916007
lambda[  12] =   0.00805368649797
lambda[  13] =   0.01583263131295
lambda[  14] =   0.02712488184885
lambda[  15] =   0.03084967613718
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 3.581 ms
rank =  0, Distributing orbital back into band + domain format took 11.981 ms
rank = 0, Subspace_Rotation used 15.575 ms

Total time for subspace rotation: 15.579 ms
rank = 0, Efermi =  -0.055039292394 calculate fermi energy took 0.080 ms
rank = 0, --- Calculate rho: sum over local bands took 2.937 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.113 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.172 ms
rank = 0, Calculating density took 1216.331 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
rank = 0, D2D took 0.996 ms
rank = 0, Transfering density took 1.003 ms
Etot    =   -29.151181033504
Eband   =    -8.446045139743
E1      =    19.524010833063
E2      =    -7.816311617480
E3      =   -10.940335595756
Exc     =    -9.680908448014
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 5.439e-07, dEband = 2.716e-05
rank = 0, Calculating/Estimating energy took 0.877 ms, Etot = -29.151181034, dEtot = 5.439e-07, dEband = 2.716e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0313598883536, which took 0.065 ms

iter_count = 102, r_2norm = 1.083e-06, tol*||rhs|| = 1.254e-06

Anderson update took 52.740 ms, out of which F'*F took 24.617 ms; b-Ax took 165.591 ms, out of which Lap took 148.571 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 360.522 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004748, int_b + int_rho = 6.185e-14, checking this took 0.106 ms
2-norm of RHS = 636.4582805816475, which took 0.100 ms

iter_count = 60, r_2norm = 6.002e-04, tol*||rhs|| = 6.365e-04

Anderson update took 30.740 ms, out of which F'*F took 14.307 ms; b-Ax took 96.827 ms, out of which Lap took 86.431 ms
Solving Poisson took 209.073 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 4.812647 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 4.843840 
Total time for convolution: 	 convolve: 4.853489 
Total time for convolution: 	 convolve: 4.776759 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.386 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
---Transfer Veff_loc: D2D took 0.931 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.324 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.277 ms

This SCF took 24825.375 ms, scf error = 1.332e-04
-------------
SCF iter 25  
-------------

 Chebfilt 28, in Chebyshev filtering, lambda_cutoff = 0.130850, lowerbound = -0.858307, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1113.807 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.767 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.375 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 15.161 ms
rank =  0, finding HY took 18.959 ms
rank =  0, distributing HY into block cyclic form took 12.008 ms
rank =  0, finding Y'*HY took 4.217 ms
Rank 0, Project_Hamiltonian used 50.373 ms
Total time for projection: 50.390 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -0.858271845328037
    last  calculated eigval = 0.030705666313869
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85827184532804
lambda[   2] =  -0.77074530948490
lambda[   3] =  -0.54773015069671
lambda[   4] =  -0.49609371110297
lambda[   5] =  -0.40136413411722
lambda[   6] =  -0.39990707143214
lambda[   7] =  -0.32459638819766
lambda[   8] =  -0.21606904522775
lambda[   9] =  -0.20796009189949
lambda[  10] =  -0.02627271813175
lambda[  11] =  -0.01079287961799
lambda[  12] =   0.00810680303189
lambda[  13] =   0.01583361428360
lambda[  14] =   0.02697616705415
lambda[  15] =   0.03070566631387
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.188 ms
rank =  0, subspace rotation using ScaLAPACK took 3.470 ms
rank =  0, Distributing orbital back into band + domain format took 11.709 ms
rank = 0, Subspace_Rotation used 15.192 ms

Total time for subspace rotation: 15.198 ms
rank = 0, Efermi =  -0.055070896284 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 2.882 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.293 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.159 ms
rank = 0, Calculating density took 1186.048 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.526 ms
rank = 0, D2D took 1.179 ms
rank = 0, Transfering density took 1.185 ms
Etot    =   -29.151175695052
Eband   =    -8.445475495763
E1      =    19.523635662937
E2      =    -7.816087689461
E3      =   -10.940487874002
Exc     =    -9.681025933643
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 7.626e-07, dEband = 8.138e-05
rank = 0, Calculating/Estimating energy took 0.881 ms, Etot = -29.151175695, dEtot = 7.626e-07, dEband = 8.138e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0283059366964, which took 0.047 ms

iter_count = 102, r_2norm = 9.979e-07, tol*||rhs|| = 1.132e-06

Anderson update took 52.388 ms, out of which F'*F took 24.647 ms; b-Ax took 165.390 ms, out of which Lap took 148.307 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 360.718 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004749, int_b + int_rho = 6.548e-14, checking this took 0.096 ms
2-norm of RHS = 636.4578132667002, which took 0.100 ms

iter_count = 84, r_2norm = 6.277e-04, tol*||rhs|| = 6.365e-04

Anderson update took 43.009 ms, out of which F'*F took 20.021 ms; b-Ax took 135.664 ms, out of which Lap took 121.143 ms
Solving Poisson took 291.724 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 4.774940 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 4.930750 
Total time for convolution: 	 convolve: 4.785723 
Total time for convolution: 	 convolve: 4.766083 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.774 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.937 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.318 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.277 ms

This SCF took 24843.735 ms, scf error = 1.099e-04
-------------
SCF iter 26  
-------------

 Chebfilt 29, in Chebyshev filtering, lambda_cutoff = 0.130706, lowerbound = -0.858272, upperbound = 267.577081

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1112.917 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.860 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.296 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.071 ms
rank =  0, Distribute data + matrix mult took 15.239 ms
rank =  0, finding HY took 18.957 ms
rank =  0, distributing HY into block cyclic form took 11.870 ms
rank =  0, finding Y'*HY took 4.212 ms
Rank 0, Project_Hamiltonian used 50.305 ms
Total time for projection: 50.320 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -0.858177641407974
    last  calculated eigval = 0.030185531255365
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.85817764140797
lambda[   2] =  -0.77064712551890
lambda[   3] =  -0.54764951690841
lambda[   4] =  -0.49601461452984
lambda[   5] =  -0.40127665526991
lambda[   6] =  -0.39982639425034
lambda[   7] =  -0.32451088676818
lambda[   8] =  -0.21597479584822
lambda[   9] =  -0.20787278888838
lambda[  10] =  -0.02649485055775
lambda[  11] =  -0.01071731965119
lambda[  12] =   0.00804168898173
lambda[  13] =   0.01563557685457
lambda[  14] =   0.02663888649099
lambda[  15] =   0.03018553125537
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 3.485 ms
rank =  0, Distributing orbital back into band + domain format took 11.773 ms
rank = 0, Subspace_Rotation used 15.270 ms

Total time for subspace rotation: 15.275 ms
rank = 0, Efermi =  -0.055293028788 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.894 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.251 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.159 ms
rank = 0, Calculating density took 1185.129 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.544 ms
rank = 0, D2D took 1.189 ms
rank = 0, Transfering density took 1.197 ms
Etot    =   -29.151172488806
Eband   =    -8.443900839576
E1      =    19.522667913309
E2      =    -7.815411799852
E3      =   -10.940797280637
Exc     =    -9.681263150981
Esc     =   -49.304885491155
Entropy =    -0.000000000892
dE = 4.580e-07, dEband = 2.250e-04
rank = 0, Calculating/Estimating energy took 0.877 ms, Etot = -29.151172489, dEtot = 4.580e-07, dEband = 2.250e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0147177374757, which took 0.050 ms

iter_count = 108, r_2norm = 4.161e-07, tol*||rhs|| = 5.887e-07

Anderson update took 55.652 ms, out of which F'*F took 25.943 ms; b-Ax took 174.758 ms, out of which Lap took 156.511 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 380.214 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003004742, int_rho =  18.00000003004759, int_b + int_rho = 1.710e-13, checking this took 0.094 ms
2-norm of RHS = 636.4587569612961, which took 0.081 ms

iter_count = 114, r_2norm = 6.359e-04, tol*||rhs|| = 6.365e-04

Anderson update took 58.626 ms, out of which F'*F took 27.074 ms; b-Ax took 183.972 ms, out of which Lap took 164.498 ms
Solving Poisson took 394.421 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.007 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 4.842000 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 4.757128 
Total time for convolution: 	 convolve: 4.778425 
Total time for convolution: 	 convolve: 4.792403 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.249 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
---Transfer Veff_loc: D2D took 0.922 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.328 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.273 ms

This SCF took 25723.437 ms, scf error = 6.921e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.85817764140797, occ[   1] =   2.00000000000000
lambda[   2] =  -0.77064712551890, occ[   2] =   2.00000000000000
lambda[   3] =  -0.54764951690841, occ[   3] =   2.00000000000000
lambda[   4] =  -0.49601461452984, occ[   4] =   2.00000000000000
lambda[   5] =  -0.40127665526991, occ[   5] =   2.00000000000000
lambda[   6] =  -0.39982639425034, occ[   6] =   2.00000000000000
lambda[   7] =  -0.32451088676818, occ[   7] =   2.00000000000000
lambda[   8] =  -0.21597479584822, occ[   8] =   2.00000000000000
lambda[   9] =  -0.20787278888838, occ[   9] =   2.00000000000000
lambda[  10] =  -0.02649485055775, occ[  10] =   0.00000003004747
lambda[  11] =  -0.01071731965119, occ[  11] =   0.00000000000000
lambda[  12] =   0.00804168898173, occ[  12] =   0.00000000000000
lambda[  13] =   0.01563557685457, occ[  13] =   0.00000000000000
lambda[  14] =   0.02663888649099, occ[  14] =   0.00000000000000
lambda[  15] =   0.03018553125537, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.442 ms, time for Allreduce/Reduce: 7.680 ms 
Time for calculating local force components: 15.748 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00010508461338  -0.05026898617839   0.00047304282498
 -0.05115915200878  -0.03622222244139  -0.02259725025387
 -0.00311465610357   0.06506449627585  -0.01123703473884
  0.05320125241727  -0.03391337500567   0.00090262601674
  0.11123488851576  -0.07745165467619  -0.01831174141702
 -0.06729468838098   0.00592714195171   0.36253975655585
  0.12662492359094   0.80225191546223  -0.02339262082713
force_loc = 
 -0.00114371582418   0.05248412427532  -0.00038525230345
  0.05321115081496   0.03790975407185   0.02222159621591
  0.00385274796942  -0.06798685934812   0.01090779600249
 -0.05528801679659   0.03383276953173  -0.00080160639685
 -0.09379320660026   0.08426519287806   0.01701844085150
  0.06687352679320  -0.00698896700273  -0.35236442446455
 -0.13578178782805  -0.78927360381525   0.02244304904053
Time for calculating nonlocal force components: 26.262 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00867851810132  -0.00115330295647   0.00079311512395
[0m[32m  0.00072270131946   0.00006088415445  -0.00884968703191
[0m[32m  0.00047468744655  -0.01846136309649   0.00065139250006
[0mTime for calculating XC forces components: 20.627 ms
 Cartesian force = 
 -0.00104537718754   0.00220428894257   0.00008619085033
  0.00204525282943   0.00167668247611  -0.00037725370916
  0.00073134588911  -0.00293321222663  -0.00033083840755
 -0.00209351035606  -0.00009145462830   0.00009941994870
  0.00875641783743   0.00564938609105  -0.00050178511277
  0.00029479375493  -0.00101179005093   0.00132404538819
 -0.00868892276730  -0.00549390060386  -0.00029977895775
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Time for printing density: 371.382 ms
The program took 683.393 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:31:26
Job ID:        2266498
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:20:36,vmem=8420K,walltime=00:11:43,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-006-15-1
---------------------------------------
