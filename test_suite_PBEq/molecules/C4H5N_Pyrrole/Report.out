---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:22:03
Job ID:    2266803
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:22:09
Job ID:    2266803
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.087 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 18.413 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 8.934 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 96.672 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.949 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.087 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   13.750659	
   10.000000	   13.983694	   11.189567	
   10.000000	    6.016306	   11.189567	
   10.000000	   12.566131	    6.249341	
   10.000000	    7.433869	    6.249341	
   10.000000	   12.121958	   10.362450	
   10.000000	    7.878042	   10.362450	
   10.000000	   11.344735	    7.882408	
   10.000000	    8.655265	    7.882408	
   10.000000	   10.000000	   11.852528	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.013 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.179 ms
Set up communicators.

--set up spincomm took 2.309 ms

--set up kptcomm took 0.350 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.008 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.102 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.826 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.966 ms

Calculate_SplineDerivRadFun took 0.205 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.262 ms.
time spent on vectorized spline interp: 2.656 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.011 ms.
time spent on vectorized spline interp: 1.643 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.507 ms.
time spent on vectorized spline interp: 1.610 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.526 ms.

Calculating rb for all atom types took 15.224 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.898 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000206934, sum_int_rho = 25.4844833066711
PosCharge = 26.000000020693, NegCharge = -25.484483306671, scal_fac = 1.020228650815
After scaling, int_rho = 26.0000000206931, PosCharge + NegCharge - NetCharge = 2.913e-13
--Calculate Vref took 0.600 ms
--Calculate rho_guess took 3.675 ms

 integral of b = -26.0000000206934,
 int{b} + Nelectron + NetCharge = -2.069e-08,
 Esc = -65.2408664229614,
 MPI_Reduce took 8.612 ms

Calculating b & b_ref took 21.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.022 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.030 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.009 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.078 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.007 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.008 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.012 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.680 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069341, int_b + int_rho = -2.328e-13, checking this took 0.091 ms
2-norm of RHS = 747.2373577625153, which took 0.899 ms

iter_count = 420, r_2norm = 6.826e-04, tol*||rhs|| = 7.472e-04

Anderson update took 235.204 ms, out of which F'*F took 107.263 ms; b-Ax took 722.941 ms, out of which Lap took 650.481 ms
Solving Poisson took 1532.137 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.434 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
Total time for convolution: 	 convolve: 5.220533 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 149.500 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
Total time for convolution: 	 convolve: 5.256722 
Total time for convolution: 	 convolve: 5.199801 
Total time for convolution: 	 convolve: 5.157436 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.734 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.406 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
rank = 0, XC calculation took 24908.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 2.180 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.153 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.445 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.137 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.658 ms
    Lanczos iter 55, eigmin  = -0.990535893, eigmax = 264.948165714, err_eigmin = 6.678e-04, err_eigmax = 9.803e-03
rank =   0, Lanczos took 124.878 ms, eigmin = -0.990535892985, eigmax = 267.597647371313

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.253556, lowerbound = -1.090536, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1751.307 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 36.969 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.499 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 41.498 ms
rank =  0, finding HY took 30.385 ms
rank =  0, distributing HY into block cyclic form took 19.384 ms
rank =  0, finding Y'*HY took 6.140 ms
Rank 0, Project_Hamiltonian used 97.439 ms
Total time for projection: 97.453 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.421 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.735 ms
rank = 0, Solve_Generalized_EigenProblem used 1.161 ms
    first calculated eigval = 2.719266740255214
    last  calculated eigval = 3.209503516904019
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.80796582517847
lambda[   5] =   2.85358148116344
lambda[   6] =   2.88103284698439
lambda[   7] =   2.88801166321966
lambda[   8] =   2.94823361291057
lambda[   9] =   2.96012150003457
lambda[  10] =   2.98706651272087
lambda[  11] =   3.00576353393807
lambda[  12] =   3.01025463144628
lambda[  13] =   3.05052354786148
lambda[  14] =   3.07677602276558
lambda[  15] =   3.09414375274776
lambda[  16] =   3.10508838797200
lambda[  17] =   3.16487248839974
lambda[  18] =   3.16998446632067
lambda[  19] =   3.18851431535851
lambda[  20] =   3.20950351690402
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.178 ms
rank =  0, subspace rotation using ScaLAPACK took 5.494 ms
rank =  0, Distributing orbital back into band + domain format took 17.862 ms
rank = 0, Subspace_Rotation used 23.371 ms

Total time for subspace rotation: 23.376 ms
rank = 0, Efermi =   3.063649786600 calculate fermi energy took 0.058 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.309504, lowerbound = -1.090536, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1752.508 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 24.077 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.079 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 28.184 ms
rank =  0, finding HY took 30.016 ms
rank =  0, distributing HY into block cyclic form took 18.201 ms
rank =  0, finding Y'*HY took 5.494 ms
Rank 0, Project_Hamiltonian used 81.926 ms
Total time for projection: 81.942 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.735596116920065
    last  calculated eigval = 0.446612632230792
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.35242962803099
lambda[   5] =  -0.21712626681408
lambda[   6] =  -0.19639097011382
lambda[   7] =  -0.11105992872041
lambda[   8] =  -0.04185618730323
lambda[   9] =   0.01626756436842
lambda[  10] =   0.09196225549611
lambda[  11] =   0.12695903385885
lambda[  12] =   0.24514228831603
lambda[  13] =   0.25729712414695
lambda[  14] =   0.33417480678812
lambda[  15] =   0.34881773129436
lambda[  16] =   0.37406077139229
lambda[  17] =   0.39248760868608
lambda[  18] =   0.39732219116269
lambda[  19] =   0.41888916669305
lambda[  20] =   0.44661263223079
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.181 ms
rank =  0, subspace rotation using ScaLAPACK took 5.492 ms
rank =  0, Distributing orbital back into band + domain format took 17.705 ms
rank = 0, Subspace_Rotation used 23.209 ms

Total time for subspace rotation: 23.214 ms
rank = 0, Efermi =   0.305039101268 calculate fermi energy took 0.029 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.546613, lowerbound = -1.090536, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1757.580 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 25.969 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.932 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 29.961 ms
rank =  0, finding HY took 30.112 ms
rank =  0, distributing HY into block cyclic form took 18.451 ms
rank =  0, finding Y'*HY took 5.502 ms
Rank 0, Project_Hamiltonian used 84.064 ms
Total time for projection: 84.068 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.995736462463314
    last  calculated eigval = 0.139302719008615
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62953814667996
lambda[   5] =  -0.62239375713915
lambda[   6] =  -0.59655671901016
lambda[   7] =  -0.49102424165927
lambda[   8] =  -0.46250816172659
lambda[   9] =  -0.46200286657535
lambda[  10] =  -0.45408132845862
lambda[  11] =  -0.42170063277730
lambda[  12] =  -0.30282579547008
lambda[  13] =  -0.22739053028106
lambda[  14] =  -0.00243420060878
lambda[  15] =   0.03689327308634
lambda[  16] =   0.08432464877942
lambda[  17] =   0.11498483019977
lambda[  18] =   0.11928857537427
lambda[  19] =   0.12676929135868
lambda[  20] =   0.13930271900862
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 5.491 ms
rank =  0, Distributing orbital back into band + domain format took 17.728 ms
rank = 0, Subspace_Rotation used 23.232 ms

Total time for subspace rotation: 23.237 ms
rank = 0, Efermi =  -0.031569906124 calculate fermi energy took 0.029 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.239303, lowerbound = -1.090536, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1721.023 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 35.139 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.945 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 39.108 ms
rank =  0, finding HY took 30.073 ms
rank =  0, distributing HY into block cyclic form took 18.104 ms
rank =  0, finding Y'*HY took 5.594 ms
Rank 0, Project_Hamiltonian used 92.903 ms
Total time for projection: 92.907 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.996434273279900
    last  calculated eigval = 0.092580477947766
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.63623225454715
lambda[   5] =  -0.62540658379396
lambda[   6] =  -0.60005786878489
lambda[   7] =  -0.49702703990782
lambda[   8] =  -0.47888502904188
lambda[   9] =  -0.47455747344442
lambda[  10] =  -0.46617580502803
lambda[  11] =  -0.44870904061097
lambda[  12] =  -0.31453661118396
lambda[  13] =  -0.28542783694512
lambda[  14] =  -0.06796281820181
lambda[  15] =  -0.05103824393139
lambda[  16] =   0.03240289643880
lambda[  17] =   0.04609945018791
lambda[  18] =   0.05324709460801
lambda[  19] =   0.07402136466003
lambda[  20] =   0.09258047794777
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 5.595 ms
rank =  0, Distributing orbital back into band + domain format took 17.705 ms
rank = 0, Subspace_Rotation used 23.314 ms

Total time for subspace rotation: 23.319 ms
rank = 0, Efermi =  -0.097098523760 calculate fermi energy took 0.029 ms
rank = 0, --- Calculate rho: sum over local bands took 3.619 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.694 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.218 ms
rank = 0, Calculating density took 7570.560 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.866 ms
rank = 0, D2D took 1.006 ms
rank = 0, Transfering density took 1.018 ms
Etot    =   -37.569587346607
Eband   =   -14.843987106569
E1      =    29.813245101411
E2      =   -11.234585647348
E3      =   -14.298500507473
Exc     =   -12.831065072688
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 3.757e+00, dEband = 1.484e+00
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -37.569587347, dEtot = 3.757e+00, dEband = 1.484e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 46.9968488171692, which took 0.088 ms

iter_count = 102, r_2norm = 1.179e-03, tol*||rhs|| = 1.880e-03

Anderson update took 55.206 ms, out of which F'*F took 25.446 ms; b-Ax took 173.007 ms, out of which Lap took 155.055 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.828 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069311, int_b + int_rho = -5.311e-13, checking this took 0.139 ms
2-norm of RHS = 742.7586323209777, which took 0.147 ms

iter_count = 288, r_2norm = 7.053e-04, tol*||rhs|| = 7.428e-04

Anderson update took 156.559 ms, out of which F'*F took 73.846 ms; b-Ax took 495.620 ms, out of which Lap took 445.953 ms
Solving Poisson took 1044.770 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.854 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.209340 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.146839 
Total time for convolution: 	 convolve: 5.097138 
Total time for convolution: 	 convolve: 5.135961 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.232 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.393 ms
---Transfer Veff_loc: D2D took 1.272 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.367 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.660 ms

This SCF took 33544.539 ms, scf error = 1.852e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.192580, lowerbound = -0.996434, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1756.037 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.927 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.960 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.910 ms
rank =  0, finding HY took 30.052 ms
rank =  0, distributing HY into block cyclic form took 18.006 ms
rank =  0, finding Y'*HY took 5.522 ms
Rank 0, Project_Hamiltonian used 75.518 ms
Total time for projection: 75.530 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -0.968465423530898
    last  calculated eigval = 0.061357624314608
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.60637637286676
lambda[   5] =  -0.59381821227007
lambda[   6] =  -0.57102580794711
lambda[   7] =  -0.46564481374867
lambda[   8] =  -0.45334805970729
lambda[   9] =  -0.43728844185147
lambda[  10] =  -0.42649014878030
lambda[  11] =  -0.42514427513274
lambda[  12] =  -0.28527227593261
lambda[  13] =  -0.25931639587749
lambda[  14] =  -0.05991047844440
lambda[  15] =  -0.03056716212796
lambda[  16] =   0.00769797620728
lambda[  17] =   0.01817138726068
lambda[  18] =   0.02706849136635
lambda[  19] =   0.05100314257253
lambda[  20] =   0.06135762431461
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.188 ms
rank =  0, subspace rotation using ScaLAPACK took 5.491 ms
rank =  0, Distributing orbital back into band + domain format took 19.205 ms
rank = 0, Subspace_Rotation used 24.712 ms

Total time for subspace rotation: 24.716 ms
rank = 0, Efermi =  -0.089046184005 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.500 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.505 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.234 ms
rank = 0, Calculating density took 1864.830 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.866 ms
rank = 0, D2D took 1.004 ms
rank = 0, Transfering density took 1.007 ms
Etot    =   -37.500366642926
Eband   =   -14.038300789862
E1      =    29.113476107808
E2      =   -11.164922594994
E3      =   -14.484209222991
Exc     =   -12.983807355276
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 6.922e-03, dEband = 8.057e-02
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -37.500366643, dEtot = 6.922e-03, dEband = 8.057e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 16.0538278239356, which took 0.064 ms

iter_count = 108, r_2norm = 3.928e-04, tol*||rhs|| = 6.422e-04

Anderson update took 58.665 ms, out of which F'*F took 27.028 ms; b-Ax took 182.395 ms, out of which Lap took 163.720 ms
rank = 0, Mixing (+ precond) took 399.406 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069308, int_b + int_rho = -5.675e-13, checking this took 0.117 ms
2-norm of RHS = 735.7541738447653, which took 0.125 ms

iter_count = 306, r_2norm = 7.271e-04, tol*||rhs|| = 7.358e-04

Anderson update took 166.807 ms, out of which F'*F took 77.147 ms; b-Ax took 519.100 ms, out of which Lap took 465.464 ms
Solving Poisson took 1104.130 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.084006 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.119702 
Total time for convolution: 	 convolve: 5.102527 
Total time for convolution: 	 convolve: 5.094343 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.373 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 1.270 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.397 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.703 ms

This SCF took 27766.112 ms, scf error = 1.280e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.161358, lowerbound = -0.968465, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1723.328 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 18.005 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.256 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 22.283 ms
rank =  0, finding HY took 30.978 ms
rank =  0, distributing HY into block cyclic form took 18.896 ms
rank =  0, finding Y'*HY took 5.872 ms
Rank 0, Project_Hamiltonian used 78.058 ms
Total time for projection: 78.071 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.914262522607385
    last  calculated eigval = 0.046113099984618
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55234274230058
lambda[   5] =  -0.53101455277955
lambda[   6] =  -0.51242294494770
lambda[   7] =  -0.40341666035895
lambda[   8] =  -0.39872134212748
lambda[   9] =  -0.38008382470874
lambda[  10] =  -0.36629463540412
lambda[  11] =  -0.35206497648206
lambda[  12] =  -0.23240925500009
lambda[  13] =  -0.20698264445310
lambda[  14] =  -0.01862045301941
lambda[  15] =  -0.00791946068045
lambda[  16] =   0.00821799839762
lambda[  17] =   0.01879932440075
lambda[  18] =   0.02126744989594
lambda[  19] =   0.03725109085202
lambda[  20] =   0.04611309998462
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.188 ms
rank =  0, subspace rotation using ScaLAPACK took 6.691 ms
rank =  0, Distributing orbital back into band + domain format took 17.914 ms
rank = 0, Subspace_Rotation used 24.623 ms

Total time for subspace rotation: 24.628 ms
rank = 0, Efermi =  -0.047756159337 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.540 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.209 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.205 ms
rank = 0, Calculating density took 1834.518 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.740 ms
rank = 0, D2D took 0.863 ms
rank = 0, Transfering density took 0.869 ms
Etot    =   -37.436540563924
Eband   =   -12.488671680986
E1      =    27.819959790722
E2      =   -10.897268581834
E3      =   -14.892630068039
Exc     =   -13.316860899950
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 6.383e-03, dEband = 1.550e-01
rank = 0, Calculating/Estimating energy took 0.906 ms, Etot = -37.436540564, dEtot = 6.383e-03, dEband = 1.550e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.1009476097875, which took 0.066 ms

iter_count = 102, r_2norm = 2.796e-04, tol*||rhs|| = 2.840e-04

Anderson update took 55.267 ms, out of which F'*F took 25.681 ms; b-Ax took 172.833 ms, out of which Lap took 155.331 ms
rank = 0, Mixing (+ precond) took 377.930 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069320, int_b + int_rho = -4.475e-13, checking this took 0.134 ms
2-norm of RHS = 735.7861725392324, which took 0.118 ms

iter_count = 270, r_2norm = 6.321e-04, tol*||rhs|| = 7.358e-04

Anderson update took 147.323 ms, out of which F'*F took 68.238 ms; b-Ax took 457.420 ms, out of which Lap took 411.082 ms
Solving Poisson took 974.183 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.086745 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.092414 
Total time for convolution: 	 convolve: 5.119577 
Total time for convolution: 	 convolve: 5.103796 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.308 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.410 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.742 ms

This SCF took 27593.992 ms, scf error = 3.759e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.146113, lowerbound = -0.914263, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1589.865 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.266 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.897 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.187 ms
rank =  0, finding HY took 28.966 ms
rank =  0, distributing HY into block cyclic form took 17.901 ms
rank =  0, finding Y'*HY took 5.372 ms
Rank 0, Project_Hamiltonian used 74.453 ms
Total time for projection: 74.465 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.199 ms
    first calculated eigval = -0.904374111340333
    last  calculated eigval = 0.038401403290930
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54304406793702
lambda[   5] =  -0.52041217428892
lambda[   6] =  -0.50036002846987
lambda[   7] =  -0.39310305339635
lambda[   8] =  -0.38665874515429
lambda[   9] =  -0.37161328254831
lambda[  10] =  -0.35474386193302
lambda[  11] =  -0.34195284700428
lambda[  12] =  -0.22537761703560
lambda[  13] =  -0.19808131478673
lambda[  14] =  -0.02182967115347
lambda[  15] =  -0.00899094063245
lambda[  16] =   0.00541233529217
lambda[  17] =   0.01709872177561
lambda[  18] =   0.02499537642524
lambda[  19] =   0.02840862672722
lambda[  20] =   0.03840140329093
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 7.228 ms
rank =  0, Distributing orbital back into band + domain format took 17.741 ms
rank = 0, Subspace_Rotation used 24.990 ms

Total time for subspace rotation: 24.995 ms
rank = 0, Efermi =  -0.050965376639 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.631 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.923 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.258 ms
rank = 0, Calculating density took 1698.514 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.818 ms
rank = 0, D2D took 0.926 ms
rank = 0, Transfering density took 0.940 ms
Etot    =   -37.432618728728
Eband   =   -12.227591772807
E1      =    27.658371409166
E2      =   -10.784091400174
E3      =   -14.965738908478
Exc     =   -13.372362250156
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 3.922e-04, dEband = 2.611e-02
rank = 0, Calculating/Estimating energy took 0.888 ms, Etot = -37.432618729, dEtot = 3.922e-04, dEband = 2.611e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.9287005370609, which took 0.065 ms

iter_count = 114, r_2norm = 5.148e-05, tol*||rhs|| = 7.715e-05

Anderson update took 61.903 ms, out of which F'*F took 28.836 ms; b-Ax took 192.736 ms, out of which Lap took 172.974 ms
rank = 0, Mixing (+ precond) took 421.833 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069303, int_b + int_rho = -6.148e-13, checking this took 0.106 ms
2-norm of RHS = 736.5375527679190, which took 0.147 ms

iter_count = 264, r_2norm = 7.256e-04, tol*||rhs|| = 7.365e-04

Anderson update took 143.506 ms, out of which F'*F took 66.283 ms; b-Ax took 459.697 ms, out of which Lap took 409.981 ms
Solving Poisson took 988.036 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.077953 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.229 ms
Total time for convolution: 	 convolve: 5.084539 
Total time for convolution: 	 convolve: 5.075682 
Total time for convolution: 	 convolve: 5.078424 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.372 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.165 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 1.294 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.147 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.470 ms

This SCF took 27428.640 ms, scf error = 1.993e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.138401, lowerbound = -0.904374, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1776.273 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.181 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.953 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.158 ms
rank =  0, finding HY took 28.903 ms
rank =  0, distributing HY into block cyclic form took 18.129 ms
rank =  0, finding Y'*HY took 5.127 ms
Rank 0, Project_Hamiltonian used 74.835 ms
Total time for projection: 74.850 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.897598640276780
    last  calculated eigval = 0.034275637863463
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53605038774022
lambda[   5] =  -0.51279722668264
lambda[   6] =  -0.49163666062639
lambda[   7] =  -0.38572558551677
lambda[   8] =  -0.37789636075952
lambda[   9] =  -0.36531849786170
lambda[  10] =  -0.34651690044349
lambda[  11] =  -0.33488118274500
lambda[  12] =  -0.22001922789025
lambda[  13] =  -0.19177193025543
lambda[  14] =  -0.02849462375493
lambda[  15] =  -0.00399498898042
lambda[  16] =   0.00436424326303
lambda[  17] =   0.01638882135813
lambda[  18] =   0.02107528339608
lambda[  19] =   0.03012301065572
lambda[  20] =   0.03427563786346
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 6.461 ms
rank =  0, Distributing orbital back into band + domain format took 18.150 ms
rank = 0, Subspace_Rotation used 24.622 ms

Total time for subspace rotation: 24.626 ms
rank = 0, Efermi =  -0.057630329276 calculate fermi energy took 2.072 ms
rank = 0, --- Calculate rho: sum over local bands took 4.491 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.154 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.237 ms
rank = 0, Calculating density took 1884.966 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.862 ms
rank = 0, D2D took 0.993 ms
rank = 0, Transfering density took 0.995 ms
Etot    =   -37.430512099634
Eband   =   -12.041082015213
E1      =    27.578165868031
E2      =   -10.665719011122
E3      =   -15.012585262335
Exc     =   -13.405033802328
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 2.107e-04, dEband = 1.865e-02
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -37.430512100, dEtot = 2.107e-04, dEband = 1.865e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7977014014141, which took 0.088 ms

iter_count = 114, r_2norm = 2.203e-05, tol*||rhs|| = 3.191e-05

Anderson update took 61.289 ms, out of which F'*F took 28.720 ms; b-Ax took 193.080 ms, out of which Lap took 173.811 ms
rank = 0, Mixing (+ precond) took 420.844 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069316, int_b + int_rho = -4.802e-13, checking this took 0.104 ms
2-norm of RHS = 736.8569803826899, which took 0.157 ms

iter_count = 246, r_2norm = 6.463e-04, tol*||rhs|| = 7.369e-04

Anderson update took 131.953 ms, out of which F'*F took 62.996 ms; b-Ax took 422.040 ms, out of which Lap took 379.904 ms
Solving Poisson took 889.685 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.126 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.102989 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.089331 
Total time for convolution: 	 convolve: 5.077744 
Total time for convolution: 	 convolve: 5.078715 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.587 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 3.519 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 4.948 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.818 ms

This SCF took 27550.782 ms, scf error = 6.707e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.134276, lowerbound = -0.897599, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1733.949 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.037 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.793 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 21.858 ms
rank =  0, finding HY took 28.972 ms
rank =  0, distributing HY into block cyclic form took 17.894 ms
rank =  0, finding Y'*HY took 6.269 ms
Rank 0, Project_Hamiltonian used 75.022 ms
Total time for projection: 75.058 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.893796555835003
    last  calculated eigval = 0.035592425248190
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53178995504233
lambda[   5] =  -0.50808186444436
lambda[   6] =  -0.48766619186022
lambda[   7] =  -0.38109391389857
lambda[   8] =  -0.37422823226107
lambda[   9] =  -0.36149278452252
lambda[  10] =  -0.34149638388129
lambda[  11] =  -0.32943361021610
lambda[  12] =  -0.21521168234560
lambda[  13] =  -0.18778157640133
lambda[  14] =  -0.03182067257027
lambda[  15] =  -0.00097753647671
lambda[  16] =   0.00368201248277
lambda[  17] =   0.01634056670931
lambda[  18] =   0.01808644350356
lambda[  19] =   0.02985841190987
lambda[  20] =   0.03559242524819
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 6.518 ms
rank =  0, Distributing orbital back into band + domain format took 18.023 ms
rank = 0, Subspace_Rotation used 24.554 ms

Total time for subspace rotation: 24.560 ms
rank = 0, Efermi =  -0.060956378105 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.424 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.454 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.195 ms
rank = 0, Calculating density took 1842.438 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.754 ms
rank = 0, D2D took 0.866 ms
rank = 0, Transfering density took 0.869 ms
Etot    =   -37.429800491429
Eband   =   -11.926434389615
E1      =    27.523933256793
E2      =   -10.600366621160
E3      =   -15.030663190858
Exc     =   -13.417462747042
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 7.116e-05, dEband = 1.146e-02
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -37.429800491, dEtot = 7.116e-05, dEband = 1.146e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4458788232520, which took 0.071 ms

iter_count = 114, r_2norm = 1.325e-05, tol*||rhs|| = 1.784e-05

Anderson update took 60.311 ms, out of which F'*F took 28.135 ms; b-Ax took 192.142 ms, out of which Lap took 171.438 ms
rank = 0, Mixing (+ precond) took 417.209 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069302, int_b + int_rho = -6.257e-13, checking this took 0.128 ms
2-norm of RHS = 737.1584196434763, which took 0.072 ms

iter_count = 246, r_2norm = 6.261e-04, tol*||rhs|| = 7.372e-04

Anderson update took 130.416 ms, out of which F'*F took 61.140 ms; b-Ax took 416.013 ms, out of which Lap took 373.495 ms
Solving Poisson took 885.149 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Total time for convolution: 	 convolve: 5.074526 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.315 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.077977 
Total time for convolution: 	 convolve: 5.081138 
Total time for convolution: 	 convolve: 5.101602 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.745 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.601 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.168 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.477 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.710 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.913 ms

This SCF took 27486.849 ms, scf error = 3.911e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.135592, lowerbound = -0.893797, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1732.623 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.046 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.934 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.001 ms
rank =  0, finding HY took 28.983 ms
rank =  0, distributing HY into block cyclic form took 17.975 ms
rank =  0, finding Y'*HY took 5.282 ms
Rank 0, Project_Hamiltonian used 74.270 ms
Total time for projection: 74.284 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.889590208216878
    last  calculated eigval = 0.038951367124132
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52797002251131
lambda[   5] =  -0.50378095029887
lambda[   6] =  -0.48367648174903
lambda[   7] =  -0.37705755911999
lambda[   8] =  -0.37033386966680
lambda[   9] =  -0.35729057456311
lambda[  10] =  -0.33721698543858
lambda[  11] =  -0.32512521442432
lambda[  12] =  -0.21092440915579
lambda[  13] =  -0.18348770310500
lambda[  14] =  -0.03274054448852
lambda[  15] =   0.00259888870649
lambda[  16] =   0.00386994005082
lambda[  17] =   0.01762139295612
lambda[  18] =   0.01815602479958
lambda[  19] =   0.02957892091185
lambda[  20] =   0.03895136712413
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 6.500 ms
rank =  0, Distributing orbital back into band + domain format took 18.074 ms
rank = 0, Subspace_Rotation used 24.586 ms

Total time for subspace rotation: 24.591 ms
rank = 0, Efermi =  -0.061876250025 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.435 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.387 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.196 ms
rank = 0, Calculating density took 1839.875 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.748 ms
rank = 0, D2D took 0.864 ms
rank = 0, Transfering density took 0.867 ms
Etot    =   -37.429347158774
Eband   =   -11.818081825453
E1      =    27.477343957183
E2      =   -10.535164413657
E3      =   -15.041395583382
Exc     =   -13.424302863961
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 4.533e-05, dEband = 1.084e-02
rank = 0, Calculating/Estimating energy took 0.903 ms, Etot = -37.429347159, dEtot = 4.533e-05, dEband = 1.084e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3053600533234, which took 0.054 ms

iter_count = 114, r_2norm = 7.834e-06, tol*||rhs|| = 1.221e-05

Anderson update took 60.533 ms, out of which F'*F took 28.002 ms; b-Ax took 191.888 ms, out of which Lap took 170.734 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.276 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069301, int_b + int_rho = -6.330e-13, checking this took 0.113 ms
2-norm of RHS = 737.1273412044548, which took 0.099 ms

iter_count = 234, r_2norm = 5.872e-04, tol*||rhs|| = 7.371e-04

Anderson update took 124.914 ms, out of which F'*F took 58.300 ms; b-Ax took 395.108 ms, out of which Lap took 354.754 ms
Solving Poisson took 842.739 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.750 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.108505 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 138.719 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.096810 
Total time for convolution: 	 convolve: 5.082090 
Total time for convolution: 	 convolve: 5.098387 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.012 ms
======D2D: initiated sending and receiving took 1.027 ms
---Transfer Veff_loc: D2D took 2.238 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.708 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.975 ms

This SCF took 27621.363 ms, scf error = 2.263e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.138951, lowerbound = -0.889590, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1733.202 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.025 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.958 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.007 ms
rank =  0, finding HY took 29.010 ms
rank =  0, distributing HY into block cyclic form took 17.853 ms
rank =  0, finding Y'*HY took 5.887 ms
Rank 0, Project_Hamiltonian used 74.785 ms
Total time for projection: 74.798 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -0.885980563741524
    last  calculated eigval = 0.042164159248583
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52469841371724
lambda[   5] =  -0.49999754635337
lambda[   6] =  -0.48011255158164
lambda[   7] =  -0.37345743602270
lambda[   8] =  -0.36688351985733
lambda[   9] =  -0.35379811035345
lambda[  10] =  -0.33334802399198
lambda[  11] =  -0.32123393198157
lambda[  12] =  -0.20732672755987
lambda[  13] =  -0.17976101712909
lambda[  14] =  -0.03213493242703
lambda[  15] =   0.00528431919561
lambda[  16] =   0.00600068999915
lambda[  17] =   0.01907784575955
lambda[  18] =   0.02039411818561
lambda[  19] =   0.03060864391894
lambda[  20] =   0.04216415924858
==subpsace eigenproblem: bcast eigvals took 0.078 ms
Total time for solving subspace eigenvalue problem: 0.266 ms
rank =  0, subspace rotation using ScaLAPACK took 6.496 ms
rank =  0, Distributing orbital back into band + domain format took 18.114 ms
rank = 0, Subspace_Rotation used 24.622 ms

Total time for subspace rotation: 24.628 ms
rank = 0, Efermi =  -0.061270637965 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.447 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.377 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.195 ms
rank = 0, Calculating density took 1841.021 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.748 ms
rank = 0, D2D took 0.851 ms
rank = 0, Transfering density took 0.853 ms
Etot    =   -37.429064293278
Eband   =   -11.723095751762
E1      =    27.424018753543
E2      =   -10.490815246679
E3      =   -15.053558148378
Exc     =   -13.433494266534
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 2.829e-05, dEband = 9.499e-03
rank = 0, Calculating/Estimating energy took 0.898 ms, Etot = -37.429064293, dEtot = 2.829e-05, dEband = 9.499e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1603565442318, which took 0.090 ms

iter_count = 108, r_2norm = 5.923e-06, tol*||rhs|| = 6.414e-06

Anderson update took 57.096 ms, out of which F'*F took 26.590 ms; b-Ax took 182.416 ms, out of which Lap took 162.762 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.608 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069308, int_b + int_rho = -5.602e-13, checking this took 0.116 ms
2-norm of RHS = 737.0990919390686, which took 0.117 ms

iter_count = 228, r_2norm = 6.899e-04, tol*||rhs|| = 7.371e-04

Anderson update took 121.474 ms, out of which F'*F took 56.247 ms; b-Ax took 382.785 ms, out of which Lap took 343.668 ms
Solving Poisson took 820.740 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.081936 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.088093 
Total time for convolution: 	 convolve: 5.080965 
Total time for convolution: 	 convolve: 5.083635 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.011 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.655 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.475 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.710 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.215 ms

This SCF took 27379.245 ms, scf error = 1.560e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.142164, lowerbound = -0.885981, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1730.662 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.974 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.997 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.995 ms
rank =  0, finding HY took 28.996 ms
rank =  0, distributing HY into block cyclic form took 17.901 ms
rank =  0, finding Y'*HY took 5.319 ms
Rank 0, Project_Hamiltonian used 74.239 ms
Total time for projection: 74.250 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.884565860735123
    last  calculated eigval = 0.044414609258286
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52307863569077
lambda[   5] =  -0.49822189665514
lambda[   6] =  -0.47834680402063
lambda[   7] =  -0.37174657594449
lambda[   8] =  -0.36519706518628
lambda[   9] =  -0.35210705652602
lambda[  10] =  -0.33146352325635
lambda[  11] =  -0.31943890407154
lambda[  12] =  -0.20547425015640
lambda[  13] =  -0.17789609254135
lambda[  14] =  -0.02778796988909
lambda[  15] =   0.00806232495620
lambda[  16] =   0.01136016025277
lambda[  17] =   0.02383408246690
lambda[  18] =   0.02519055744617
lambda[  19] =   0.03289677602860
lambda[  20] =   0.04441460925829
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 6.478 ms
rank =  0, Distributing orbital back into band + domain format took 18.017 ms
rank = 0, Subspace_Rotation used 24.508 ms

Total time for subspace rotation: 24.513 ms
rank = 0, Efermi =  -0.056923675381 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 4.436 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.340 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.205 ms
rank = 0, Calculating density took 1837.765 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.743 ms
rank = 0, D2D took 0.859 ms
rank = 0, Transfering density took 0.861 ms
Etot    =   -37.428999028547
Eband   =   -11.678436890043
E1      =    27.405643254316
E2      =   -10.464613973821
E3      =   -15.053692615468
Exc     =   -13.433645558526
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 6.526e-06, dEband = 4.466e-03
rank = 0, Calculating/Estimating energy took 1.831 ms, Etot = -37.428999029, dEtot = 6.526e-06, dEband = 4.466e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1274128427896, which took 0.057 ms

iter_count = 114, r_2norm = 3.217e-06, tol*||rhs|| = 5.097e-06

Anderson update took 60.506 ms, out of which F'*F took 28.024 ms; b-Ax took 191.995 ms, out of which Lap took 170.848 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.115 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069311, int_b + int_rho = -5.384e-13, checking this took 0.142 ms
2-norm of RHS = 737.0968892357890, which took 0.112 ms

iter_count = 174, r_2norm = 7.152e-04, tol*||rhs|| = 7.371e-04

Anderson update took 92.896 ms, out of which F'*F took 43.257 ms; b-Ax took 293.857 ms, out of which Lap took 263.732 ms
Solving Poisson took 627.700 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.094410 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.112800 
Total time for convolution: 	 convolve: 5.093611 
Total time for convolution: 	 convolve: 5.075410 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.018 ms
======D2D: initiated sending and receiving took 1.215 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 1.439 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.679 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.148 ms

This SCF took 27248.823 ms, scf error = 8.210e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.144415, lowerbound = -0.884566, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1729.862 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.080 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.963 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 22.066 ms
rank =  0, finding HY took 29.022 ms
rank =  0, distributing HY into block cyclic form took 17.799 ms
rank =  0, finding Y'*HY took 5.409 ms
Rank 0, Project_Hamiltonian used 74.322 ms
Total time for projection: 74.336 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.884021168755697
    last  calculated eigval = 0.044293947807464
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52257815580990
lambda[   5] =  -0.49769848597311
lambda[   6] =  -0.47786399619259
lambda[   7] =  -0.37123202062593
lambda[   8] =  -0.36470482635763
lambda[   9] =  -0.35159914423202
lambda[  10] =  -0.33094275018914
lambda[  11] =  -0.31891807540274
lambda[  12] =  -0.20497224292009
lambda[  13] =  -0.17742838271851
lambda[  14] =  -0.02718844968956
lambda[  15] =   0.00838828997194
lambda[  16] =   0.01203626006431
lambda[  17] =   0.02404232430805
lambda[  18] =   0.02464844175096
lambda[  19] =   0.03152490205048
lambda[  20] =   0.04429394780746
==subpsace eigenproblem: bcast eigvals took 0.085 ms
Total time for solving subspace eigenvalue problem: 0.264 ms
rank =  0, subspace rotation using ScaLAPACK took 6.505 ms
rank =  0, Distributing orbital back into band + domain format took 18.008 ms
rank = 0, Subspace_Rotation used 24.525 ms

Total time for subspace rotation: 24.531 ms
rank = 0, Efermi =  -0.056324155187 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.417 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.403 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.199 ms
rank = 0, Calculating density took 1837.119 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.619 ms
rank = 0, D2D took 1.722 ms
rank = 0, Transfering density took 1.725 ms
Etot    =   -37.429146467511
Eband   =   -11.665207366479
E1      =    27.398231719388
E2      =   -10.458346758882
E3      =   -15.055248150403
Exc     =   -13.434899306123
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 1.474e-05, dEband = 1.323e-03
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -37.429146468, dEtot = 1.474e-05, dEband = 1.323e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0961130447146, which took 0.080 ms

iter_count = 114, r_2norm = 2.342e-06, tol*||rhs|| = 3.845e-06

Anderson update took 60.354 ms, out of which F'*F took 28.136 ms; b-Ax took 192.418 ms, out of which Lap took 171.655 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.263 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069314, int_b + int_rho = -5.020e-13, checking this took 0.128 ms
2-norm of RHS = 737.1001487528512, which took 0.110 ms

iter_count = 180, r_2norm = 7.221e-04, tol*||rhs|| = 7.371e-04

Anderson update took 95.926 ms, out of which F'*F took 44.533 ms; b-Ax took 302.651 ms, out of which Lap took 271.897 ms
Solving Poisson took 649.236 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.079758 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.525 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.080482 
Total time for convolution: 	 convolve: 5.080159 
Total time for convolution: 	 convolve: 5.105800 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 1.467 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.708 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.208 ms

This SCF took 27254.575 ms, scf error = 6.140e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.144294, lowerbound = -0.884021, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1716.258 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 21.146 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.060 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 25.230 ms
rank =  0, finding HY took 28.998 ms
rank =  0, distributing HY into block cyclic form took 17.907 ms
rank =  0, finding Y'*HY took 5.365 ms
Rank 0, Project_Hamiltonian used 77.528 ms
Total time for projection: 77.543 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -0.883223715077819
    last  calculated eigval = 0.044511648012275
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52189311531588
lambda[   5] =  -0.49697512244915
lambda[   6] =  -0.47720943604939
lambda[   7] =  -0.37052766136320
lambda[   8] =  -0.36404368429312
lambda[   9] =  -0.35085214697502
lambda[  10] =  -0.33024515524017
lambda[  11] =  -0.31819278139473
lambda[  12] =  -0.20423302948893
lambda[  13] =  -0.17671726637302
lambda[  14] =  -0.02531466682426
lambda[  15] =   0.00901499781687
lambda[  16] =   0.01433532448592
lambda[  17] =   0.02528288607613
lambda[  18] =   0.02577703351118
lambda[  19] =   0.03146691266925
lambda[  20] =   0.04451164801228
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 6.489 ms
rank =  0, Distributing orbital back into band + domain format took 18.093 ms
rank = 0, Subspace_Rotation used 24.595 ms

Total time for subspace rotation: 24.600 ms
rank = 0, Efermi =  -0.054450372370 calculate fermi energy took 0.664 ms
rank = 0, --- Calculate rho: sum over local bands took 4.517 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.331 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.231 ms
rank = 0, Calculating density took 1827.050 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.842 ms
rank = 0, D2D took 0.978 ms
rank = 0, Transfering density took 0.983 ms
Etot    =   -37.429259803957
Eband   =   -11.646516352040
E1      =    27.387967070471
E2      =   -10.449506528316
E3      =   -15.056921617064
Exc     =   -13.436272244186
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 1.133e-05, dEband = 1.869e-03
rank = 0, Calculating/Estimating energy took 0.906 ms, Etot = -37.429259804, dEtot = 1.133e-05, dEband = 1.869e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0523007896036, which took 0.058 ms

iter_count = 114, r_2norm = 1.279e-06, tol*||rhs|| = 2.092e-06

Anderson update took 60.398 ms, out of which F'*F took 28.038 ms; b-Ax took 192.245 ms, out of which Lap took 170.861 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.314 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069307, int_b + int_rho = -5.748e-13, checking this took 0.113 ms
2-norm of RHS = 737.1217079738802, which took 0.112 ms

iter_count = 186, r_2norm = 6.185e-04, tol*||rhs|| = 7.371e-04

Anderson update took 99.258 ms, out of which F'*F took 46.263 ms; b-Ax took 314.119 ms, out of which Lap took 281.971 ms
Solving Poisson took 670.288 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.080364 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.080551 
Total time for convolution: 	 convolve: 5.084023 
Total time for convolution: 	 convolve: 5.076691 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.471 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.703 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.205 ms

This SCF took 27226.975 ms, scf error = 3.933e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.144512, lowerbound = -0.883224, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1733.594 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.902 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.067 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.992 ms
rank =  0, finding HY took 28.986 ms
rank =  0, distributing HY into block cyclic form took 17.790 ms
rank =  0, finding Y'*HY took 5.381 ms
Rank 0, Project_Hamiltonian used 74.175 ms
Total time for projection: 74.188 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.882730155707333
    last  calculated eigval = 0.044761654715347
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52140958018757
lambda[   5] =  -0.49647462036712
lambda[   6] =  -0.47669716677454
lambda[   7] =  -0.37004083031529
lambda[   8] =  -0.36353988657707
lambda[   9] =  -0.35033813071017
lambda[  10] =  -0.32974758776526
lambda[  11] =  -0.31770059632748
lambda[  12] =  -0.20373239714068
lambda[  13] =  -0.17619495602207
lambda[  14] =  -0.02125324233321
lambda[  15] =   0.00954836901912
lambda[  16] =   0.01799669190470
lambda[  17] =   0.02817977338126
lambda[  18] =   0.02847411565040
lambda[  19] =   0.03258474289422
lambda[  20] =   0.04476165471535
==subpsace eigenproblem: bcast eigvals took 0.042 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 6.527 ms
rank =  0, Distributing orbital back into band + domain format took 17.758 ms
rank = 0, Subspace_Rotation used 24.303 ms

Total time for subspace rotation: 24.308 ms
rank = 0, Efermi =  -0.050388947826 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.302 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.488 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.189 ms
rank = 0, Calculating density took 1840.422 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.690 ms
rank = 0, D2D took 1.310 ms
rank = 0, Transfering density took 1.317 ms
Etot    =   -37.429351469536
Eband   =   -11.633523084467
E1      =    27.382420520070
E2      =   -10.441895239230
E3      =   -15.057405996434
Exc     =   -13.436683717221
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 9.167e-06, dEband = 1.299e-03
rank = 0, Calculating/Estimating energy took 1.325 ms, Etot = -37.429351470, dEtot = 9.167e-06, dEband = 1.299e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0400199107372, which took 0.095 ms

iter_count = 114, r_2norm = 1.097e-06, tol*||rhs|| = 1.601e-06

Anderson update took 60.728 ms, out of which F'*F took 28.128 ms; b-Ax took 192.208 ms, out of which Lap took 171.427 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.692 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069303, int_b + int_rho = -6.148e-13, checking this took 0.101 ms
2-norm of RHS = 737.1225581324144, which took 0.108 ms

iter_count = 138, r_2norm = 6.762e-04, tol*||rhs|| = 7.371e-04

Anderson update took 73.418 ms, out of which F'*F took 34.149 ms; b-Ax took 231.638 ms, out of which Lap took 208.078 ms
Solving Poisson took 498.301 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.078065 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.082961 
Total time for convolution: 	 convolve: 5.083372 
Total time for convolution: 	 convolve: 5.096858 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.420 ms
---Transfer Veff_loc: D2D took 1.451 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.684 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.165 ms

This SCF took 27079.195 ms, scf error = 2.539e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.144762, lowerbound = -0.882730, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1732.217 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.930 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.964 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.916 ms
rank =  0, finding HY took 29.013 ms
rank =  0, distributing HY into block cyclic form took 17.988 ms
rank =  0, finding Y'*HY took 5.265 ms
Rank 0, Project_Hamiltonian used 74.218 ms
Total time for projection: 74.232 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -0.882577191316933
    last  calculated eigval = 0.044524032266036
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52126453652232
lambda[   5] =  -0.49632318119964
lambda[   6] =  -0.47655162207066
lambda[   7] =  -0.36989422256676
lambda[   8] =  -0.36339656759626
lambda[   9] =  -0.35019067068661
lambda[  10] =  -0.32960050250624
lambda[  11] =  -0.31754940341542
lambda[  12] =  -0.20358638472438
lambda[  13] =  -0.17604951571526
lambda[  14] =  -0.02016095576236
lambda[  15] =   0.00965085478435
lambda[  16] =   0.01830375800951
lambda[  17] =   0.02889365702508
lambda[  18] =   0.02906374346496
lambda[  19] =   0.03284818163930
lambda[  20] =   0.04452403226604
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 6.516 ms
rank =  0, Distributing orbital back into band + domain format took 18.454 ms
rank = 0, Subspace_Rotation used 24.988 ms

Total time for subspace rotation: 24.993 ms
rank = 0, Efermi =  -0.049296661269 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.420 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.596 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.242 ms
rank = 0, Calculating density took 1840.052 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.781 ms
rank = 0, D2D took 0.882 ms
rank = 0, Transfering density took 0.888 ms
Etot    =   -37.429383035790
Eband   =   -11.629659969479
E1      =    27.380308901726
E2      =   -10.440055931634
E3      =   -15.057736346541
Exc     =   -13.436957822629
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 3.157e-06, dEband = 3.863e-04
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -37.429383036, dEtot = 3.157e-06, dEband = 3.863e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0322479748964, which took 0.056 ms

iter_count = 114, r_2norm = 8.076e-07, tol*||rhs|| = 1.290e-06

Anderson update took 60.435 ms, out of which F'*F took 27.984 ms; b-Ax took 192.145 ms, out of which Lap took 170.928 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.334 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069304, int_b + int_rho = -6.003e-13, checking this took 0.142 ms
2-norm of RHS = 737.1239509780123, which took 0.120 ms

iter_count = 144, r_2norm = 7.310e-04, tol*||rhs|| = 7.371e-04

Anderson update took 76.943 ms, out of which F'*F took 35.863 ms; b-Ax took 243.143 ms, out of which Lap took 218.350 ms
Solving Poisson took 519.819 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.079955 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.078398 
Total time for convolution: 	 convolve: 5.079015 
Total time for convolution: 	 convolve: 5.080346 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
---Transfer Veff_loc: D2D took 1.463 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.711 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.202 ms

This SCF took 27083.047 ms, scf error = 2.010e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.144524, lowerbound = -0.882577, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1733.024 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.927 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.010 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.960 ms
rank =  0, finding HY took 28.984 ms
rank =  0, distributing HY into block cyclic form took 17.882 ms
rank =  0, finding Y'*HY took 5.387 ms
Rank 0, Project_Hamiltonian used 74.255 ms
Total time for projection: 74.270 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.141 ms
rank = 0, Solve_Generalized_EigenProblem used 1.276 ms
    first calculated eigval = -0.882480426225425
    last  calculated eigval = 0.044205225757614
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52114019416423
lambda[   5] =  -0.49620246169595
lambda[   6] =  -0.47643409769315
lambda[   7] =  -0.36977952782574
lambda[   8] =  -0.36328230871213
lambda[   9] =  -0.35008257130472
lambda[  10] =  -0.32948334617793
lambda[  11] =  -0.31743548376636
lambda[  12] =  -0.20347313784976
lambda[  13] =  -0.17594537315468
lambda[  14] =  -0.02027734720861
lambda[  15] =   0.00965682286559
lambda[  16] =   0.01652462811963
lambda[  17] =   0.02881822215004
lambda[  18] =   0.02938335494198
lambda[  19] =   0.03337427516479
lambda[  20] =   0.04420522575761
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.295 ms
rank =  0, subspace rotation using ScaLAPACK took 6.484 ms
rank =  0, Distributing orbital back into band + domain format took 18.234 ms
rank = 0, Subspace_Rotation used 24.733 ms

Total time for subspace rotation: 24.739 ms
rank = 0, Efermi =  -0.049413052712 calculate fermi energy took 0.102 ms
rank = 0, --- Calculate rho: sum over local bands took 4.449 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.321 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.204 ms
rank = 0, Calculating density took 1841.471 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.762 ms
rank = 0, D2D took 0.868 ms
rank = 0, Transfering density took 0.874 ms
Etot    =   -37.429433323953
Eband   =   -11.626725459224
E1      =    27.379007224078
E2      =   -10.438386151247
E3      =   -15.057703489119
Exc     =   -13.436938305590
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 5.029e-06, dEband = 2.935e-04
rank = 0, Calculating/Estimating energy took 0.916 ms, Etot = -37.429433324, dEtot = 5.029e-06, dEband = 2.935e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0326717780228, which took 0.109 ms

iter_count = 108, r_2norm = 1.262e-06, tol*||rhs|| = 1.307e-06

Anderson update took 57.249 ms, out of which F'*F took 26.654 ms; b-Ax took 182.191 ms, out of which Lap took 162.450 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.809 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069311, int_b + int_rho = -5.311e-13, checking this took 0.111 ms
2-norm of RHS = 737.1233740995095, which took 0.108 ms

iter_count = 108, r_2norm = 6.031e-04, tol*||rhs|| = 7.371e-04

Anderson update took 57.570 ms, out of which F'*F took 26.729 ms; b-Ax took 181.381 ms, out of which Lap took 162.993 ms
Solving Poisson took 390.849 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.081476 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.079824 
Total time for convolution: 	 convolve: 5.090537 
Total time for convolution: 	 convolve: 5.081098 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 1.497 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.687 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.210 ms

This SCF took 26944.150 ms, scf error = 1.609e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.144205, lowerbound = -0.882480, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1733.251 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.950 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.039 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.589 ms
rank =  0, Distribute data + matrix mult took 23.334 ms
rank =  0, finding HY took 28.409 ms
rank =  0, distributing HY into block cyclic form took 17.779 ms
rank =  0, finding Y'*HY took 5.385 ms
Rank 0, Project_Hamiltonian used 74.939 ms
Total time for projection: 74.958 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -0.882366698008021
    last  calculated eigval = 0.043837701868039
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52104413578240
lambda[   5] =  -0.49610285073049
lambda[   6] =  -0.47634226338885
lambda[   7] =  -0.36968227802478
lambda[   8] =  -0.36318854160100
lambda[   9] =  -0.34997979632925
lambda[  10] =  -0.32938833604585
lambda[  11] =  -0.31733773755491
lambda[  12] =  -0.20337550202225
lambda[  13] =  -0.17584950180931
lambda[  14] =  -0.01993728622013
lambda[  15] =   0.00972456388828
lambda[  16] =   0.01644391970755
lambda[  17] =   0.02891807779848
lambda[  18] =   0.02958083133181
lambda[  19] =   0.03364477364676
lambda[  20] =   0.04383770186804
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 6.461 ms
rank =  0, Distributing orbital back into band + domain format took 18.085 ms
rank = 0, Subspace_Rotation used 24.558 ms

Total time for subspace rotation: 24.563 ms
rank = 0, Efermi =  -0.049072991742 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 4.440 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.338 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.210 ms
rank = 0, Calculating density took 1841.063 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.744 ms
rank = 0, D2D took 0.874 ms
rank = 0, Transfering density took 0.879 ms
Etot    =   -37.429446134103
Eband   =   -11.624143900171
E1      =    27.377565733786
E2      =   -10.437178867191
E3      =   -15.057945213278
Exc     =   -13.437125624606
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 1.281e-06, dEband = 2.582e-04
rank = 0, Calculating/Estimating energy took 0.906 ms, Etot = -37.429446134, dEtot = 1.281e-06, dEband = 2.582e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0217557261245, which took 0.056 ms

iter_count = 108, r_2norm = 7.917e-07, tol*||rhs|| = 8.702e-07

Anderson update took 57.180 ms, out of which F'*F took 26.777 ms; b-Ax took 181.990 ms, out of which Lap took 161.990 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.677 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069308, int_b + int_rho = -5.639e-13, checking this took 0.133 ms
2-norm of RHS = 737.1235577955007, which took 0.107 ms

iter_count = 138, r_2norm = 6.704e-04, tol*||rhs|| = 7.371e-04

Anderson update took 74.186 ms, out of which F'*F took 34.106 ms; b-Ax took 242.945 ms, out of which Lap took 219.567 ms
Solving Poisson took 508.250 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.179 ms
Total time for convolution: 	 convolve: 5.079108 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.079193 
Total time for convolution: 	 convolve: 5.083150 
Total time for convolution: 	 convolve: 5.089340 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 1.476 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.711 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.217 ms

This SCF took 27066.068 ms, scf error = 1.292e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.143838, lowerbound = -0.882367, upperbound = 267.597647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1699.575 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.033 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.948 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.004 ms
rank =  0, finding HY took 29.054 ms
rank =  0, distributing HY into block cyclic form took 17.799 ms
rank =  0, finding Y'*HY took 5.392 ms
Rank 0, Project_Hamiltonian used 74.278 ms
Total time for projection: 74.295 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.882207647587384
    last  calculated eigval = 0.043497694659910
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.52089380164625
lambda[   5] =  -0.49595407146615
lambda[   6] =  -0.47619269594591
lambda[   7] =  -0.36953444466752
lambda[   8] =  -0.36303751917556
lambda[   9] =  -0.34982758170812
lambda[  10] =  -0.32924237572109
lambda[  11] =  -0.31719408488588
lambda[  12] =  -0.20323321575430
lambda[  13] =  -0.17570565703019
lambda[  14] =  -0.01983801796967
lambda[  15] =   0.00978735700639
lambda[  16] =   0.01623310011013
lambda[  17] =   0.02844735744197
lambda[  18] =   0.02931612137875
lambda[  19] =   0.03459052845515
lambda[  20] =   0.04349769465991
==subpsace eigenproblem: bcast eigvals took 0.044 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 6.516 ms
rank =  0, Distributing orbital back into band + domain format took 18.054 ms
rank = 0, Subspace_Rotation used 24.581 ms

Total time for subspace rotation: 24.587 ms
rank = 0, Efermi =  -0.048973723465 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.423 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.412 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.255 ms
rank = 0, Calculating density took 1806.885 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
rank = 0, D2D took 0.916 ms
rank = 0, Transfering density took 0.919 ms
Etot    =   -37.429473185427
Eband   =   -11.620270555479
E1      =    27.375771645344
E2      =   -10.435015565654
E3      =   -15.058105534299
Exc     =   -13.437228951662
Esc     =   -65.240866422961
Entropy =    -0.000000000621
dE = 2.705e-06, dEband = 3.873e-04
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -37.429473185, dEtot = 2.705e-06, dEband = 3.873e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0158710274825, which took 0.065 ms

iter_count = 108, r_2norm = 6.122e-07, tol*||rhs|| = 6.348e-07

Anderson update took 57.188 ms, out of which F'*F took 26.562 ms; b-Ax took 182.116 ms, out of which Lap took 162.310 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.792 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002069364, int_rho =  26.00000002069307, int_b + int_rho = -5.748e-13, checking this took 0.141 ms
2-norm of RHS = 737.1231632175095, which took 0.122 ms

iter_count = 108, r_2norm = 6.661e-04, tol*||rhs|| = 7.371e-04

Anderson update took 57.504 ms, out of which F'*F took 26.701 ms; b-Ax took 181.371 ms, out of which Lap took 162.967 ms
Solving Poisson took 391.922 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.082453 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.213 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.081358 
Total time for convolution: 	 convolve: 5.091794 
Total time for convolution: 	 convolve: 5.080854 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 2.409 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.447 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.882 ms

This SCF took 26929.021 ms, scf error = 9.599e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.52089380164625, occ[   4] =   2.00000000000000
lambda[   5] =  -0.49595407146615, occ[   5] =   2.00000000000000
lambda[   6] =  -0.47619269594591, occ[   6] =   2.00000000000000
lambda[   7] =  -0.36953444466752, occ[   7] =   2.00000000000000
lambda[   8] =  -0.36303751917556, occ[   8] =   2.00000000000000
lambda[   9] =  -0.34982758170812, occ[   9] =   2.00000000000000
lambda[  10] =  -0.32924237572109, occ[  10] =   2.00000000000000
lambda[  11] =  -0.31719408488588, occ[  11] =   2.00000000000000
lambda[  12] =  -0.20323321575430, occ[  12] =   2.00000000000000
lambda[  13] =  -0.17570565703019, occ[  13] =   2.00000000000000
lambda[  14] =  -0.01983801796967, occ[  14] =   0.00000002069308
lambda[  15] =   0.00978735700639, occ[  15] =   0.00000000000000
lambda[  16] =   0.01623310011013, occ[  16] =   0.00000000000000
lambda[  17] =   0.02844735744197, occ[  17] =   0.00000000000000
lambda[  18] =   0.02931612137875, occ[  18] =   0.00000000000000
lambda[  19] =   0.03459052845515, occ[  19] =   0.00000000000000
lambda[  20] =   0.04349769465991, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.908 ms, time for Allreduce/Reduce: 9.479 ms 
Time for calculating local force components: 22.110 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000001642764   0.00000004212832  -0.06782289668579
 -0.00000000803333  -0.04844198628859  -0.02051439319595
  0.00000011705659   0.04844173748239  -0.02051428967600
 -0.00000002805200  -0.03101955607790   0.04150350880103
  0.00000004513593   0.03101975577748   0.04150378628533
 -0.00000019433336  -0.12612626115589   0.12964112765741
 -0.00000150682909   0.12612729457140   0.12963463731578
  0.00000011328299  -0.00827405430313   0.02555560149785
 -0.00000036739784   0.00826993836831   0.02555250021094
  0.00000133260558   0.00000581683279  -0.00784203976075
force_loc = 
 -0.00000034283733   0.00000004358669   0.07072928545631
 -0.00000031350142   0.05091774611756   0.02124889578683
 -0.00000010762243  -0.05091777719599   0.02124901049117
  0.00000035980986   0.03243929110218  -0.04327572072466
  0.00000002892952  -0.03244057539426  -0.04327779473704
  0.00000000359714   0.12879267276658  -0.11932766602405
  0.00000103325635  -0.12879404937320  -0.11932545307012
 -0.00000003161393   0.00819724004989  -0.03378154732447
 -0.00000060393466  -0.00819682099833  -0.03377925003994
 -0.00000051262734  -0.00000172851849   0.01170073108774
Time for calculating nonlocal force components: 41.749 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000000141051   0.00132008291546  -0.00696384192614
[0m[32m  0.00000001781593  -0.00132007207568  -0.00696400148974
[0m[32m  0.00000000838330  -0.00084589803682   0.00336464563194
[0m[32m -0.00000004714996   0.00084576160782   0.00336479153946
[0m[32m -0.00000007519663   0.00000000003592  -0.00158583886529
[0mTime for calculating XC forces components: 31.946 ms
 Cartesian force = 
 -0.00000021998579   0.00000022132256   0.00289900994633
 -0.00000021511085   0.00247589543652   0.00072712376670
  0.00000011585806  -0.00247590410605   0.00072734199099
  0.00000043818176   0.00141987063182  -0.00177959074781
  0.00000018048934  -0.00142068400923  -0.00178138727590
 -0.00000008572283   0.00398663013370   0.00334224088304
 -0.00000034933291  -0.00398669126993   0.00333780393174
  0.00000019647626  -0.00092257668251  -0.00486867901886
 -0.00000091205856   0.00091901458535  -0.00486933711373
  0.00000085120550   0.00000422395777   0.00226547363751
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Time for printing density: 384.261 ms
The program took 471.818 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:02
Job ID:        2266803
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:36:24,vmem=8432K,walltime=00:08:02,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-011-11-2
---------------------------------------
