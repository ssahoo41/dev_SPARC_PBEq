---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:27
Job ID:    2266670
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:33
Job ID:    2266670
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.005 ms
Reading input file sprc-calc.inpt

Reading input file took 34.770 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 3.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8

Reading ion file took 7.135 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.

Reading pseudopotential file took 70.765 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.913 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.092 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   10.560623	
   10.000000	   11.424861	    9.439377	
   10.000000	    8.575139	    9.439377	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.016 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.173 ms
Set up communicators.

--set up spincomm took 3.800 ms

--set up kptcomm took 0.354 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 9, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 9 
rank =  0, my blacs rank = 0, BLCYC size (250000, 3), actual size (250000, 3)
rank = 0, mb = nb = 9, mbQ = nbQ = 64
rank = 0, nr_Hp = 9, nc_Hp = 9
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.041 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 3
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.578 ms

Calculate_SplineDerivRadFun took 0.124 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.814 ms.
time spent on vectorized spline interp: 3.657 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.730 ms.
time spent on vectorized spline interp: 1.362 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.340 ms.

Calculating rb for all atom types took 11.913 ms
----------------------
Estimated memory usage
Total: 688.18 MB
orbitals             : 411.99 MB
global sized vectors : 213.62 MB
subspace matrices : 7.59 kB
others : 62.56 MB
----------------------------------------------
Estimated memory usage per processor: 57.35 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.813 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -8.0000000049539, sum_int_rho = 7.8050744940752
PosCharge = 8.000000004954, NegCharge = -7.805074494075, scal_fac = 1.024974202492
After scaling, int_rho = 8.0000000049539, PosCharge + NegCharge - NetCharge = 1.421e-14
--Calculate Vref took 0.139 ms
--Calculate rho_guess took 0.649 ms

 integral of b = -8.0000000049539,
 int{b} + Nelectron + NetCharge = -4.954e-09,
 Esc = -26.9245065020699,
 MPI_Reduce took 0.044 ms

Calculating b & b_ref took 4.106 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.023 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.032 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.015 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.077 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.763 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 16.598 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495386, int_b + int_rho = -1.482e-13, checking this took 0.089 ms
2-norm of RHS = 432.8348122447225, which took 0.801 ms

iter_count = 414, r_2norm = 3.973e-04, tol*||rhs|| = 4.328e-04

Anderson update took 314.284 ms, out of which F'*F took 136.458 ms; b-Ax took 863.443 ms, out of which Lap took 755.543 ms
Solving Poisson took 1890.228 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.408 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
Total time for convolution: 	 convolve: 5.139842 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.842 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
Total time for convolution: 	 convolve: 5.120163 
Total time for convolution: 	 convolve: 5.113304 
Total time for convolution: 	 convolve: 5.099742 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.726 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
rank = 0, XC calculation took 24279.509 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.565 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.194 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.865 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.136 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.838 ms
    Lanczos iter 53, eigmin  = -1.025422655, eigmax = 264.916494038, err_eigmin = 5.297e-05, err_eigmax = 9.509e-03
rank =   0, Lanczos took 131.296 ms, eigmin = -1.025422654835, eigmax = 267.565658978391

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.220118, lowerbound = -1.125423, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 806.294 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.028 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.466 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.019 ms
rank =  0, Distribute data + matrix mult took 24.533 ms
rank =  0, finding HY took 13.891 ms
rank =  0, distributing HY into block cyclic form took 8.119 ms
rank =  0, finding Y'*HY took 3.432 ms
Rank 0, Project_Hamiltonian used 50.007 ms
Total time for projection: 50.030 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.400 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.476 ms
    first calculated eigval = 2.848477314643445
    last  calculated eigval = 3.158985385175379
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =   2.84847731464344
lambda[   2] =   2.92551113004943
lambda[   3] =   2.97210117502774
lambda[   4] =   2.99253361286269
lambda[   5] =   3.03386497363881
lambda[   6] =   3.06573673161812
lambda[   7] =   3.10169167617956
lambda[   8] =   3.14665973860005
lambda[   9] =   3.15898538517538
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.490 ms
rank =  0, subspace rotation using ScaLAPACK took 2.783 ms
rank =  0, Distributing orbital back into band + domain format took 7.954 ms
rank = 0, Subspace_Rotation used 10.752 ms

Total time for subspace rotation: 10.756 ms
rank = 0, Efermi =   3.013199337018 calculate fermi energy took 0.060 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.258985, lowerbound = -1.125423, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 812.447 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 30.341 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.425 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 32.787 ms
rank =  0, finding HY took 13.358 ms
rank =  0, distributing HY into block cyclic form took 8.720 ms
rank =  0, finding Y'*HY took 2.229 ms
Rank 0, Project_Hamiltonian used 57.608 ms
Total time for projection: 57.629 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.684637224827611
    last  calculated eigval = 0.446606167892150
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.68463722482761
lambda[   2] =   0.01847715725875
lambda[   3] =   0.08561368425583
lambda[   4] =   0.28905804981282
lambda[   5] =   0.32922578642750
lambda[   6] =   0.36368481947661
lambda[   7] =   0.37443083017695
lambda[   8] =   0.40589466339515
lambda[   9] =   0.44660616789215
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 2.525 ms
rank =  0, Distributing orbital back into band + domain format took 8.314 ms
rank = 0, Subspace_Rotation used 10.852 ms

Total time for subspace rotation: 10.856 ms
rank = 0, Efermi =   0.309141946339 calculate fermi energy took 0.042 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.546606, lowerbound = -1.125423, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 810.296 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 32.701 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.380 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 35.105 ms
rank =  0, finding HY took 13.767 ms
rank =  0, distributing HY into block cyclic form took 8.153 ms
rank =  0, finding Y'*HY took 2.946 ms
Rank 0, Project_Hamiltonian used 60.004 ms
Total time for projection: 60.010 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -1.025258402584195
    last  calculated eigval = 0.145980796456142
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -1.02525840258420
lambda[   2] =  -0.55646642419117
lambda[   3] =  -0.42864221478049
lambda[   4] =  -0.30181404782625
lambda[   5] =   0.07189621819069
lambda[   6] =   0.10116898018762
lambda[   7] =   0.12172819907588
lambda[   8] =   0.14019518461084
lambda[   9] =   0.14598079645614
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 2.552 ms
rank =  0, Distributing orbital back into band + domain format took 8.152 ms
rank = 0, Subspace_Rotation used 10.716 ms

Total time for subspace rotation: 10.721 ms
rank = 0, Efermi =   0.041499639043 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.245981, lowerbound = -1.125423, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 804.348 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 22.374 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.332 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 24.756 ms
rank =  0, finding HY took 13.339 ms
rank =  0, distributing HY into block cyclic form took 8.114 ms
rank =  0, finding Y'*HY took 3.052 ms
Rank 0, Project_Hamiltonian used 50.331 ms
Total time for projection: 50.337 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.053 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.118 ms
    first calculated eigval = -1.025616926051681
    last  calculated eigval = 0.078951099115012
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -1.02561692605168
lambda[   2] =  -0.56300192778080
lambda[   3] =  -0.43998099590017
lambda[   4] =  -0.36205007304763
lambda[   5] =   0.00501107236063
lambda[   6] =   0.05405577046371
lambda[   7] =   0.06122491752313
lambda[   8] =   0.07290344616129
lambda[   9] =   0.07895109911501
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.127 ms
rank =  0, subspace rotation using ScaLAPACK took 2.579 ms
rank =  0, Distributing orbital back into band + domain format took 8.150 ms
rank = 0, Subspace_Rotation used 10.740 ms

Total time for subspace rotation: 10.745 ms
rank = 0, Efermi =  -0.025385506754 calculate fermi energy took 0.021 ms
rank = 0, --- Calculate rho: sum over local bands took 1.930 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.495 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.198 ms
rank = 0, Calculating density took 3634.812 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.878 ms
rank = 0, D2D took 2.710 ms
rank = 0, Transfering density took 2.719 ms
Etot    =   -17.765321746752
Eband   =    -4.781299845536
E1      =     9.078171916228
E2      =    -4.224335308588
E3      =    -5.406666377770
Exc     =    -4.768689001577
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 5.922e+00, dEband = 1.594e+00
rank = 0, Calculating/Estimating energy took 1.945 ms, Etot = -17.765321747, dEtot = 5.922e+00, dEband = 1.594e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 42.2827896791804, which took 1.034 ms

iter_count = 90, r_2norm = 1.515e-03, tol*||rhs|| = 1.691e-03

Anderson update took 53.171 ms, out of which F'*F took 24.748 ms; b-Ax took 174.999 ms, out of which Lap took 156.821 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 381.088 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495394, int_b + int_rho = -7.185e-14, checking this took 0.625 ms
2-norm of RHS = 430.2856899737587, which took 0.153 ms

iter_count = 282, r_2norm = 4.176e-04, tol*||rhs|| = 4.303e-04

Anderson update took 165.695 ms, out of which F'*F took 77.076 ms; b-Ax took 521.071 ms, out of which Lap took 460.147 ms
Solving Poisson took 1165.625 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.113592 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.339 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.892 ms
Total time for convolution: 	 convolve: 5.095219 
Total time for convolution: 	 convolve: 5.098507 
Total time for convolution: 	 convolve: 5.092364 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.367 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
---Transfer Veff_loc: D2D took 0.959 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.813 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.792 ms

This SCF took 29559.266 ms, scf error = 1.222e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.178951, lowerbound = -1.025617, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 832.500 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 8.470 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.343 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.040 ms
rank =  0, Distribute data + matrix mult took 10.868 ms
rank =  0, finding HY took 13.354 ms
rank =  0, distributing HY into block cyclic form took 7.630 ms
rank =  0, finding Y'*HY took 4.195 ms
Rank 0, Project_Hamiltonian used 36.610 ms
Total time for projection: 36.641 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.061 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.985933082949658
    last  calculated eigval = 0.048792634648848
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.98593308294966
lambda[   2] =  -0.53099307970125
lambda[   3] =  -0.39975133771665
lambda[   4] =  -0.32140670847913
lambda[   5] =  -0.03034034430052
lambda[   6] =   0.03103029979949
lambda[   7] =   0.03592353599423
lambda[   8] =   0.04299659288660
lambda[   9] =   0.04879263464885
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 2.556 ms
rank =  0, Distributing orbital back into band + domain format took 8.177 ms
rank = 0, Subspace_Rotation used 10.748 ms

Total time for subspace rotation: 10.753 ms
rank = 0, Efermi =  -0.060736923431 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 1.886 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.584 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.216 ms
rank = 0, Calculating density took 885.852 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.838 ms
rank = 0, D2D took 1.044 ms
rank = 0, Transfering density took 1.051 ms
Etot    =   -17.748074835650
Eband   =    -4.476168417844
E1      =     8.844521323278
E2      =    -4.153033994967
E3      =    -5.482558528318
Exc     =    -4.827513762144
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 5.749e-03, dEband = 1.017e-01
rank = 0, Calculating/Estimating energy took 1.086 ms, Etot = -17.748074836, dEtot = 5.749e-03, dEband = 1.017e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 20.8139030206247, which took 0.137 ms

iter_count = 96, r_2norm = 6.294e-04, tol*||rhs|| = 8.326e-04

Anderson update took 57.245 ms, out of which F'*F took 26.471 ms; b-Ax took 177.832 ms, out of which Lap took 158.202 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 402.387 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495387, int_b + int_rho = -1.419e-13, checking this took 0.098 ms
2-norm of RHS = 429.0659133622813, which took 0.154 ms

iter_count = 288, r_2norm = 3.742e-04, tol*||rhs|| = 4.291e-04

Anderson update took 174.162 ms, out of which F'*F took 78.959 ms; b-Ax took 534.077 ms, out of which Lap took 471.822 ms
Solving Poisson took 1193.489 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.250 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.787 ms
Total time for convolution: 	 convolve: 5.153117 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.932 ms
Total time for convolution: 	 convolve: 5.154359 
Total time for convolution: 	 convolve: 5.151005 
Total time for convolution: 	 convolve: 5.147909 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.012 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.954 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.806 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.779 ms

This SCF took 27038.029 ms, scf error = 7.635e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.148793, lowerbound = -0.985933, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 832.304 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.237 ms
rank =  0, Distribute orbital to block cyclic format took 8.135 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.561 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 11.096 ms
rank =  0, finding HY took 13.734 ms
rank =  0, distributing HY into block cyclic form took 8.113 ms
rank =  0, finding Y'*HY took 3.067 ms
Rank 0, Project_Hamiltonian used 36.287 ms
Total time for projection: 36.300 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.953133915212839
    last  calculated eigval = 0.036846217533175
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.95313391521284
lambda[   2] =  -0.50397212596497
lambda[   3] =  -0.36593630343840
lambda[   4] =  -0.28699263565198
lambda[   5] =  -0.04073181447592
lambda[   6] =   0.01748360711614
lambda[   7] =   0.02313165960806
lambda[   8] =   0.03359504394126
lambda[   9] =   0.03684621753317
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.136 ms
rank =  0, subspace rotation using ScaLAPACK took 2.582 ms
rank =  0, Distributing orbital back into band + domain format took 8.128 ms
rank = 0, Subspace_Rotation used 10.724 ms

Total time for subspace rotation: 10.730 ms
rank = 0, Efermi =  -0.071128393683 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 1.949 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.498 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.216 ms
rank = 0, Calculating density took 885.251 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.782 ms
rank = 0, D2D took 1.010 ms
rank = 0, Transfering density took 1.013 ms
Etot    =   -17.740990886081
Eband   =    -4.220069960738
E1      =     8.659704903055
E2      =    -4.073336155507
E3      =    -5.548967130526
Exc     =    -4.878422612206
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 2.361e-03, dEband = 8.537e-02
rank = 0, Calculating/Estimating energy took 1.117 ms, Etot = -17.740990886, dEtot = 2.361e-03, dEband = 8.537e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.3941195743578, which took 0.077 ms

iter_count = 108, r_2norm = 8.741e-05, tol*||rhs|| = 1.358e-04

Anderson update took 64.411 ms, out of which F'*F took 29.613 ms; b-Ax took 202.525 ms, out of which Lap took 181.266 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 451.682 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495388, int_b + int_rho = -1.328e-13, checking this took 0.137 ms
2-norm of RHS = 430.5524271578686, which took 0.164 ms

iter_count = 288, r_2norm = 3.810e-04, tol*||rhs|| = 4.306e-04

Anderson update took 173.398 ms, out of which F'*F took 79.036 ms; b-Ax took 541.684 ms, out of which Lap took 477.571 ms
Solving Poisson took 1196.813 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.160142 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.162006 
Total time for convolution: 	 convolve: 6.455605 
Total time for convolution: 	 convolve: 5.196216 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.404 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.398 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.935 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.810 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.762 ms

This SCF took 28451.887 ms, scf error = 4.350e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.136846, lowerbound = -0.953134, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 801.039 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 9.649 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.340 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.103 ms
rank =  0, Distribute data + matrix mult took 12.110 ms
rank =  0, finding HY took 13.475 ms
rank =  0, distributing HY into block cyclic form took 8.075 ms
rank =  0, finding Y'*HY took 2.983 ms
Rank 0, Project_Hamiltonian used 37.150 ms
Total time for projection: 37.167 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.063 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.944896796109152
    last  calculated eigval = 0.031626097540728
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.94489679610915
lambda[   2] =  -0.49517492652153
lambda[   3] =  -0.35591799990637
lambda[   4] =  -0.27780164753227
lambda[   5] =  -0.04396388485000
lambda[   6] =   0.01053038522957
lambda[   7] =   0.01634596490653
lambda[   8] =   0.02721251960822
lambda[   9] =   0.03162609754073
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 2.572 ms
rank =  0, Distributing orbital back into band + domain format took 8.131 ms
rank = 0, Subspace_Rotation used 10.715 ms

Total time for subspace rotation: 10.720 ms
rank = 0, Efermi =  -0.074360463889 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.986 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.858 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.305 ms
rank = 0, Calculating density took 855.335 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.860 ms
rank = 0, D2D took 1.070 ms
rank = 0, Transfering density took 1.073 ms
Etot    =   -17.738634371928
Eband   =    -4.147582740356
E1      =     8.637307386948
E2      =    -4.019686406501
E3      =    -5.568046595900
Exc     =    -4.891585518696
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 7.855e-04, dEband = 2.416e-02
rank = 0, Calculating/Estimating energy took 1.191 ms, Etot = -17.738634372, dEtot = 7.855e-04, dEband = 2.416e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.3515684311188, which took 0.109 ms

iter_count = 108, r_2norm = 4.571e-05, tol*||rhs|| = 5.406e-05

Anderson update took 63.701 ms, out of which F'*F took 30.012 ms; b-Ax took 203.760 ms, out of which Lap took 181.312 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.989 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495387, int_b + int_rho = -1.401e-13, checking this took 0.116 ms
2-norm of RHS = 430.4376109842268, which took 0.179 ms

iter_count = 252, r_2norm = 3.639e-04, tol*||rhs|| = 4.304e-04

Anderson update took 150.342 ms, out of which F'*F took 70.195 ms; b-Ax took 481.293 ms, out of which Lap took 424.362 ms
Solving Poisson took 1051.290 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.244 ms
Total time for convolution: 	 convolve: 5.151758 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 125.157 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.161876 
Total time for convolution: 	 convolve: 5.157430 
Total time for convolution: 	 convolve: 5.143507 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.387 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.169 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.947 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.809 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.778 ms

This SCF took 27046.877 ms, scf error = 8.839e-03
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.131626, lowerbound = -0.944897, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 813.734 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.236 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.481 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.035 ms
rank =  0, Distribute data + matrix mult took 11.765 ms
rank =  0, finding HY took 13.433 ms
rank =  0, distributing HY into block cyclic form took 8.181 ms
rank =  0, finding Y'*HY took 3.008 ms
Rank 0, Project_Hamiltonian used 36.419 ms
Total time for projection: 36.435 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.063 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.940003486125281
    last  calculated eigval = 0.029851084094507
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.94000348612528
lambda[   2] =  -0.49111520454781
lambda[   3] =  -0.35099232081769
lambda[   4] =  -0.27280553330448
lambda[   5] =  -0.04507967443282
lambda[   6] =   0.00881073113990
lambda[   7] =   0.01259285734202
lambda[   8] =   0.02454076988252
lambda[   9] =   0.02985108409451
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.129 ms
rank =  0, subspace rotation using ScaLAPACK took 2.584 ms
rank =  0, Distributing orbital back into band + domain format took 8.143 ms
rank = 0, Subspace_Rotation used 10.743 ms

Total time for subspace rotation: 10.749 ms
rank = 0, Efermi =  -0.075476253528 calculate fermi energy took 1.714 ms
rank = 0, --- Calculate rho: sum over local bands took 2.555 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.975 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.208 ms
rank = 0, Calculating density took 867.900 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.706 ms
rank = 0, D2D took 1.089 ms
rank = 0, Transfering density took 1.094 ms
Etot    =   -17.738368705536
Eband   =    -4.109833089814
E1      =     8.612532533400
E2      =    -4.004618857375
E3      =    -5.577743272677
Exc     =    -4.898923776949
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 8.856e-05, dEband = 1.258e-02
rank = 0, Calculating/Estimating energy took 1.106 ms, Etot = -17.738368706, dEtot = 8.856e-05, dEband = 1.258e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4996564312687, which took 0.052 ms

iter_count = 108, r_2norm = 1.634e-05, tol*||rhs|| = 1.999e-05

Anderson update took 64.759 ms, out of which F'*F took 30.060 ms; b-Ax took 204.829 ms, out of which Lap took 181.819 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.120 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495388, int_b + int_rho = -1.328e-13, checking this took 0.119 ms
2-norm of RHS = 430.5215369415517, which took 0.119 ms

iter_count = 270, r_2norm = 3.583e-04, tol*||rhs|| = 4.305e-04

Anderson update took 157.416 ms, out of which F'*F took 74.839 ms; b-Ax took 506.531 ms, out of which Lap took 451.714 ms
Solving Poisson took 1121.082 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.184 ms
Total time for convolution: 	 convolve: 5.149099 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 117.887 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.155896 
Total time for convolution: 	 convolve: 5.166768 
Total time for convolution: 	 convolve: 5.144062 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.396 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.962 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.377 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.360 ms

This SCF took 27477.538 ms, scf error = 6.027e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.129851, lowerbound = -0.940003, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 795.853 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.238 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.385 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 10.644 ms
rank =  0, finding HY took 13.605 ms
rank =  0, distributing HY into block cyclic form took 8.129 ms
rank =  0, finding Y'*HY took 2.992 ms
Rank 0, Project_Hamiltonian used 35.398 ms
Total time for projection: 35.410 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -0.936498142545547
    last  calculated eigval = 0.027505798374387
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93649814254555
lambda[   2] =  -0.48812396390064
lambda[   3] =  -0.34748241178880
lambda[   4] =  -0.26923151132832
lambda[   5] =  -0.04623411421506
lambda[   6] =   0.00720365966815
lambda[   7] =   0.00927874695821
lambda[   8] =   0.02247873126121
lambda[   9] =   0.02750579837439
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 2.537 ms
rank =  0, Distributing orbital back into band + domain format took 8.160 ms
rank = 0, Subspace_Rotation used 10.711 ms

Total time for subspace rotation: 10.717 ms
rank = 0, Efermi =  -0.076630693416 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 2.548 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.086 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.194 ms
rank = 0, Calculating density took 848.075 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.824 ms
rank = 0, D2D took 1.013 ms
rank = 0, Transfering density took 1.017 ms
Etot    =   -17.738409666657
Eband   =    -4.082672059356
E1      =     8.602606472603
E2      =    -3.986056520601
E3      =    -5.581096309771
Exc     =    -4.900990408052
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 1.365e-05, dEband = 9.054e-03
rank = 0, Calculating/Estimating energy took 1.050 ms, Etot = -17.738409667, dEtot = 1.365e-05, dEband = 9.054e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3593155945709, which took 0.103 ms

iter_count = 108, r_2norm = 1.183e-05, tol*||rhs|| = 1.437e-05

Anderson update took 63.427 ms, out of which F'*F took 30.389 ms; b-Ax took 205.645 ms, out of which Lap took 182.718 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.113 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495389, int_b + int_rho = -1.255e-13, checking this took 0.130 ms
2-norm of RHS = 430.5368495592448, which took 0.148 ms

iter_count = 240, r_2norm = 3.712e-04, tol*||rhs|| = 4.305e-04

Anderson update took 140.944 ms, out of which F'*F took 66.920 ms; b-Ax took 449.032 ms, out of which Lap took 400.019 ms
Solving Poisson took 997.330 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.642 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.143398 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 183.617 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.375 ms
Total time for convolution: 	 convolve: 5.161537 
Total time for convolution: 	 convolve: 5.148366 
Total time for convolution: 	 convolve: 5.160731 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.414 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.982 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.880 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.216 ms

This SCF took 27067.923 ms, scf error = 2.363e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.127506, lowerbound = -0.936498, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 828.389 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.176 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.390 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 10.589 ms
rank =  0, finding HY took 13.552 ms
rank =  0, distributing HY into block cyclic form took 8.142 ms
rank =  0, finding Y'*HY took 2.973 ms
Rank 0, Project_Hamiltonian used 35.287 ms
Total time for projection: 35.303 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.934827746336960
    last  calculated eigval = 0.027040655932883
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93482774633696
lambda[   2] =  -0.48648125207065
lambda[   3] =  -0.34550819749478
lambda[   4] =  -0.26741126031697
lambda[   5] =  -0.04577444424062
lambda[   6] =   0.00559797661704
lambda[   7] =   0.00938171423312
lambda[   8] =   0.02252247337352
lambda[   9] =   0.02704065593288
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 2.521 ms
rank =  0, Distributing orbital back into band + domain format took 8.080 ms
rank = 0, Subspace_Rotation used 10.615 ms

Total time for subspace rotation: 10.622 ms
rank = 0, Efermi =  -0.076171023151 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 2.522 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.164 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.206 ms
rank = 0, Calculating density took 880.491 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.765 ms
rank = 0, D2D took 0.972 ms
rank = 0, Transfering density took 0.977 ms
Etot    =   -17.738449652602
Eband   =    -4.068456912665
E1      =     8.595529894354
E2      =    -3.978323605244
E3      =    -5.583218672320
Exc     =    -4.902558409630
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 1.333e-05, dEband = 4.738e-03
rank = 0, Calculating/Estimating energy took 1.160 ms, Etot = -17.738449653, dEtot = 1.333e-05, dEband = 4.738e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1716197385547, which took 0.054 ms

iter_count = 108, r_2norm = 6.715e-06, tol*||rhs|| = 6.865e-06

Anderson update took 63.547 ms, out of which F'*F took 29.797 ms; b-Ax took 201.005 ms, out of which Lap took 178.297 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.142 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495388, int_b + int_rho = -1.328e-13, checking this took 0.077 ms
2-norm of RHS = 430.5255792727938, which took 0.132 ms

iter_count = 228, r_2norm = 4.293e-04, tol*||rhs|| = 4.305e-04

Anderson update took 134.291 ms, out of which F'*F took 66.167 ms; b-Ax took 446.710 ms, out of which Lap took 398.120 ms
Solving Poisson took 967.319 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.346 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.146764 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 112.301 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.149506 
Total time for convolution: 	 convolve: 5.230677 
Total time for convolution: 	 convolve: 5.173391 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.608 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
---Transfer Veff_loc: D2D took 0.995 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.895 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.267 ms

This SCF took 27074.218 ms, scf error = 1.536e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.127041, lowerbound = -0.934828, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 831.368 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.304 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.437 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 10.780 ms
rank =  0, finding HY took 13.497 ms
rank =  0, distributing HY into block cyclic form took 7.550 ms
rank =  0, finding Y'*HY took 3.783 ms
Rank 0, Project_Hamiltonian used 35.642 ms
Total time for projection: 35.656 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.933825884134207
    last  calculated eigval = 0.027099759333874
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93382588413421
lambda[   2] =  -0.48546868964010
lambda[   3] =  -0.34440820793311
lambda[   4] =  -0.26637008819650
lambda[   5] =  -0.04384369283230
lambda[   6] =   0.00475658520890
lambda[   7] =   0.01199215621685
lambda[   8] =   0.02328576390373
lambda[   9] =   0.02709975933387
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 2.484 ms
rank =  0, Distributing orbital back into band + domain format took 8.195 ms
rank = 0, Subspace_Rotation used 10.695 ms

Total time for subspace rotation: 10.700 ms
rank = 0, Efermi =  -0.074240271885 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.354 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.093 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.222 ms
rank = 0, Calculating density took 883.662 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.846 ms
rank = 0, D2D took 1.080 ms
rank = 0, Transfering density took 1.089 ms
Etot    =   -17.738529625521
Eband   =    -4.060145740025
E1      =     8.591683204040
E2      =    -3.973730633536
E3      =    -5.583652395860
Exc     =    -4.902943616706
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 2.666e-05, dEband = 2.770e-03
rank = 0, Calculating/Estimating energy took 1.044 ms, Etot = -17.738529626, dEtot = 2.666e-05, dEband = 2.770e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1384482812925, which took 0.100 ms

iter_count = 108, r_2norm = 4.025e-06, tol*||rhs|| = 5.538e-06

Anderson update took 63.660 ms, out of which F'*F took 30.308 ms; b-Ax took 202.900 ms, out of which Lap took 182.098 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.445 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495388, int_b + int_rho = -1.291e-13, checking this took 0.136 ms
2-norm of RHS = 430.5486146856975, which took 7.448 ms

iter_count = 228, r_2norm = 3.921e-04, tol*||rhs|| = 4.305e-04

Anderson update took 134.956 ms, out of which F'*F took 63.422 ms; b-Ax took 434.985 ms, out of which Lap took 388.423 ms
Solving Poisson took 955.405 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.152577 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 139.490 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.144689 
Total time for convolution: 	 convolve: 5.152440 
Total time for convolution: 	 convolve: 5.145688 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.725 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.999 ms
---Transfer Veff_loc: D2D took 1.741 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.377 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.141 ms

This SCF took 26993.601 ms, scf error = 1.031e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.127100, lowerbound = -0.933826, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 846.646 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.244 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.478 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 10.770 ms
rank =  0, finding HY took 13.503 ms
rank =  0, distributing HY into block cyclic form took 8.214 ms
rank =  0, finding Y'*HY took 2.891 ms
Rank 0, Project_Hamiltonian used 35.411 ms
Total time for projection: 35.423 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.147 ms
    first calculated eigval = -0.931816252617573
    last  calculated eigval = 0.028777614711817
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93181625261757
lambda[   2] =  -0.48353259819670
lambda[   3] =  -0.34258450311128
lambda[   4] =  -0.26450310100326
lambda[   5] =  -0.03826161555055
lambda[   6] =   0.00478453273447
lambda[   7] =   0.02032233029198
lambda[   8] =   0.02633207347569
lambda[   9] =   0.02877761471182
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 2.460 ms
rank =  0, Distributing orbital back into band + domain format took 8.131 ms
rank = 0, Subspace_Rotation used 10.608 ms

Total time for subspace rotation: 10.613 ms
rank = 0, Efermi =  -0.068658194415 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.333 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.161 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.216 ms
rank = 0, Calculating density took 898.725 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.763 ms
rank = 0, D2D took 1.011 ms
rank = 0, Transfering density took 1.015 ms
Etot    =   -17.738593238022
Eband   =    -4.044872910047
E1      =     8.583867299158
E2      =    -3.965794231988
E3      =    -5.585748366531
Exc     =    -4.904623723427
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 2.120e-05, dEband = 5.091e-03
rank = 0, Calculating/Estimating energy took 1.118 ms, Etot = -17.738593238, dEtot = 2.120e-05, dEband = 5.091e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0951393347773, which took 0.066 ms

iter_count = 108, r_2norm = 2.741e-06, tol*||rhs|| = 3.806e-06

Anderson update took 63.754 ms, out of which F'*F took 30.305 ms; b-Ax took 203.636 ms, out of which Lap took 182.060 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.432 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495388, int_b + int_rho = -1.328e-13, checking this took 0.115 ms
2-norm of RHS = 430.5518053942195, which took 0.067 ms

iter_count = 198, r_2norm = 3.808e-04, tol*||rhs|| = 4.306e-04

Anderson update took 117.431 ms, out of which F'*F took 55.832 ms; b-Ax took 374.980 ms, out of which Lap took 335.097 ms
Solving Poisson took 824.979 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.147784 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 148.622 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.142582 
Total time for convolution: 	 convolve: 5.146843 
Total time for convolution: 	 convolve: 5.156848 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.037 ms
---Transfer Veff_loc: D2D took 1.773 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.373 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.168 ms

This SCF took 26909.616 ms, scf error = 5.827e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.128778, lowerbound = -0.931816, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 807.335 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 37.889 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.389 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 40.300 ms
rank =  0, finding HY took 13.421 ms
rank =  0, distributing HY into block cyclic form took 8.269 ms
rank =  0, finding Y'*HY took 2.947 ms
Rank 0, Project_Hamiltonian used 64.967 ms
Total time for projection: 64.985 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -0.931746525468174
    last  calculated eigval = 0.029592137055698
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93174652546817
lambda[   2] =  -0.48341915252820
lambda[   3] =  -0.34249376030800
lambda[   4] =  -0.26445410974104
lambda[   5] =  -0.03763504948618
lambda[   6] =   0.00442922236361
lambda[   7] =   0.02117061072692
lambda[   8] =   0.02716515291764
lambda[   9] =   0.02959213705570
==subpsace eigenproblem: bcast eigvals took 0.035 ms
Total time for solving subspace eigenvalue problem: 0.172 ms
rank =  0, subspace rotation using ScaLAPACK took 2.506 ms
rank =  0, Distributing orbital back into band + domain format took 8.109 ms
rank = 0, Subspace_Rotation used 10.628 ms

Total time for subspace rotation: 10.633 ms
rank = 0, Efermi =  -0.068031628614 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 2.327 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.205 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.225 ms
rank = 0, Calculating density took 889.005 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.848 ms
rank = 0, D2D took 1.076 ms
rank = 0, Transfering density took 1.081 ms
Etot    =   -17.738680250986
Eband   =    -4.044227096277
E1      =     8.583698530941
E2      =    -3.965342688239
E3      =    -5.585426483703
Exc     =    -4.904414355367
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 2.900e-05, dEband = 2.153e-04
rank = 0, Calculating/Estimating energy took 1.062 ms, Etot = -17.738680251, dEtot = 2.900e-05, dEband = 2.153e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1314726780050, which took 0.073 ms

iter_count = 102, r_2norm = 3.526e-06, tol*||rhs|| = 5.259e-06

Anderson update took 60.022 ms, out of which F'*F took 28.416 ms; b-Ax took 204.872 ms, out of which Lap took 185.560 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 442.970 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495388, int_b + int_rho = -1.337e-13, checking this took 0.075 ms
2-norm of RHS = 430.5886294901732, which took 0.156 ms

iter_count = 198, r_2norm = 3.761e-04, tol*||rhs|| = 4.306e-04

Anderson update took 119.349 ms, out of which F'*F took 55.670 ms; b-Ax took 375.045 ms, out of which Lap took 334.920 ms
Solving Poisson took 825.557 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.146039 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 131.863 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.148963 
Total time for convolution: 	 convolve: 5.148089 
Total time for convolution: 	 convolve: 5.144200 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.178 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.972 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.368 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.363 ms

This SCF took 26910.358 ms, scf error = 5.191e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129592, lowerbound = -0.931747, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 832.541 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.702 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.428 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.080 ms
rank =  0, Distribute data + matrix mult took 15.225 ms
rank =  0, finding HY took 13.454 ms
rank =  0, distributing HY into block cyclic form took 8.228 ms
rank =  0, finding Y'*HY took 2.938 ms
Rank 0, Project_Hamiltonian used 39.878 ms
Total time for projection: 39.905 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.063 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.932057882748935
    last  calculated eigval = 0.032430423503755
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93205788274893
lambda[   2] =  -0.48362007554916
lambda[   3] =  -0.34268682796906
lambda[   4] =  -0.26471189247335
lambda[   5] =  -0.03524586590851
lambda[   6] =   0.00447139925803
lambda[   7] =   0.02425751325530
lambda[   8] =   0.03158110496421
lambda[   9] =   0.03243042350376
==subpsace eigenproblem: bcast eigvals took 0.058 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 2.434 ms
rank =  0, Distributing orbital back into band + domain format took 8.213 ms
rank = 0, Subspace_Rotation used 10.672 ms

Total time for subspace rotation: 10.677 ms
rank = 0, Efermi =  -0.065642445180 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.361 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.149 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.227 ms
rank = 0, Calculating density took 889.182 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.733 ms
rank = 0, D2D took 1.149 ms
rank = 0, Transfering density took 1.153 ms
Etot    =   -17.738709741033
Eband   =    -4.046153357656
E1      =     8.586074194073
E2      =    -3.965115245927
E3      =    -5.584348099043
Exc     =    -4.903587420196
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 9.830e-06, dEband = 6.421e-04
rank = 0, Calculating/Estimating energy took 1.012 ms, Etot = -17.738709741, dEtot = 9.830e-06, dEband = 6.421e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1309007597713, which took 0.063 ms

iter_count = 102, r_2norm = 3.523e-06, tol*||rhs|| = 5.236e-06

Anderson update took 60.262 ms, out of which F'*F took 28.521 ms; b-Ax took 192.020 ms, out of which Lap took 171.955 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 432.905 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495389, int_b + int_rho = -1.237e-13, checking this took 0.121 ms
2-norm of RHS = 430.5900999025306, which took 0.105 ms

iter_count = 150, r_2norm = 3.794e-04, tol*||rhs|| = 4.306e-04

Anderson update took 88.908 ms, out of which F'*F took 42.191 ms; b-Ax took 284.774 ms, out of which Lap took 254.270 ms
Solving Poisson took 626.727 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.162175 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 135.327 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.377 ms
Total time for convolution: 	 convolve: 5.141980 
Total time for convolution: 	 convolve: 5.150409 
Total time for convolution: 	 convolve: 5.157151 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.096 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.973 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.369 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.364 ms

This SCF took 26648.962 ms, scf error = 1.245e-03
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132430, lowerbound = -0.932058, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 841.631 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.523 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.419 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 10.964 ms
rank =  0, finding HY took 13.437 ms
rank =  0, distributing HY into block cyclic form took 8.235 ms
rank =  0, finding Y'*HY took 2.851 ms
Rank 0, Project_Hamiltonian used 35.523 ms
Total time for projection: 35.542 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.063 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -0.932063145836855
    last  calculated eigval = 0.031823012122352
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93206314583685
lambda[   2] =  -0.48362305893048
lambda[   3] =  -0.34271290361057
lambda[   4] =  -0.26473295904988
lambda[   5] =  -0.03560748695665
lambda[   6] =   0.00438047552501
lambda[   7] =   0.02358427996991
lambda[   8] =   0.03080710297201
lambda[   9] =   0.03182301212235
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.166 ms
rank =  0, subspace rotation using ScaLAPACK took 2.430 ms
rank =  0, Distributing orbital back into band + domain format took 8.174 ms
rank = 0, Subspace_Rotation used 10.630 ms

Total time for subspace rotation: 10.636 ms
rank = 0, Efermi =  -0.066004066087 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.330 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.171 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.223 ms
rank = 0, Calculating density took 893.825 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.830 ms
rank = 0, D2D took 1.068 ms
rank = 0, Transfering density took 1.073 ms
Etot    =   -17.738705868580
Eband   =    -4.046264135032
E1      =     8.586065330278
E2      =    -3.965221090001
E3      =    -5.584400182122
Exc     =    -4.903621833725
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 1.291e-06, dEband = 3.693e-05
rank = 0, Calculating/Estimating energy took 1.079 ms, Etot = -17.738705869, dEtot = 1.291e-06, dEband = 3.693e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1301232489230, which took 0.094 ms

iter_count = 102, r_2norm = 3.547e-06, tol*||rhs|| = 5.205e-06

Anderson update took 60.215 ms, out of which F'*F took 28.543 ms; b-Ax took 191.424 ms, out of which Lap took 171.748 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 432.306 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495387, int_b + int_rho = -1.437e-13, checking this took 0.137 ms
2-norm of RHS = 430.5895926702768, which took 0.128 ms

iter_count = 18, r_2norm = 3.910e-04, tol*||rhs|| = 4.306e-04

Anderson update took 10.728 ms, out of which F'*F took 5.153 ms; b-Ax took 34.092 ms, out of which Lap took 30.524 ms
Solving Poisson took 78.255 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.165105 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 86.312 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.158145 
Total time for convolution: 	 convolve: 5.151542 
Total time for convolution: 	 convolve: 5.145466 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.944 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.380 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.346 ms

This SCF took 26070.059 ms, scf error = 1.233e-03
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.131823, lowerbound = -0.932063, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 829.976 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.360 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.338 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 10.738 ms
rank =  0, finding HY took 13.482 ms
rank =  0, distributing HY into block cyclic form took 8.207 ms
rank =  0, finding Y'*HY took 2.923 ms
Rank 0, Project_Hamiltonian used 35.387 ms
Total time for projection: 35.399 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -0.932059685879539
    last  calculated eigval = 0.031667916728943
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93205968587954
lambda[   2] =  -0.48362079732821
lambda[   3] =  -0.34271009902001
lambda[   4] =  -0.26472978657077
lambda[   5] =  -0.03568803255549
lambda[   6] =   0.00432975286238
lambda[   7] =   0.02342747622577
lambda[   8] =   0.03069525444952
lambda[   9] =   0.03166791672894
==subpsace eigenproblem: bcast eigvals took 0.054 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 2.457 ms
rank =  0, Distributing orbital back into band + domain format took 8.189 ms
rank = 0, Subspace_Rotation used 10.663 ms

Total time for subspace rotation: 10.669 ms
rank = 0, Efermi =  -0.066084611720 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.383 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.147 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.226 ms
rank = 0, Calculating density took 882.111 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.771 ms
rank = 0, D2D took 1.012 ms
rank = 0, Transfering density took 1.021 ms
Etot    =   -17.738707201593
Eband   =    -4.046240737774
E1      =     8.586039575176
E2      =    -3.965221415740
E3      =    -5.584405339057
Exc     =    -4.903626291568
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 4.443e-07, dEband = 7.799e-06
rank = 0, Calculating/Estimating energy took 1.449 ms, Etot = -17.738707202, dEtot = 4.443e-07, dEband = 7.799e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1795583235938, which took 0.121 ms

iter_count = 96, r_2norm = 6.477e-06, tol*||rhs|| = 7.182e-06

Anderson update took 56.663 ms, out of which F'*F took 27.045 ms; b-Ax took 180.773 ms, out of which Lap took 162.016 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 407.356 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495385, int_b + int_rho = -1.619e-13, checking this took 0.121 ms
2-norm of RHS = 430.5522971469893, which took 0.118 ms

iter_count = 168, r_2norm = 4.303e-04, tol*||rhs|| = 4.306e-04

Anderson update took 99.707 ms, out of which F'*F took 47.451 ms; b-Ax took 318.833 ms, out of which Lap took 285.075 ms
Solving Poisson took 701.047 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.148031 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 94.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.159170 
Total time for convolution: 	 convolve: 5.144914 
Total time for convolution: 	 convolve: 5.152015 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.331 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 0.968 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.380 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.369 ms

This SCF took 26653.028 ms, scf error = 1.224e-03
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.131668, lowerbound = -0.932060, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 826.667 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.228 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.440 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 21.687 ms
rank =  0, finding HY took 13.424 ms
rank =  0, distributing HY into block cyclic form took 8.215 ms
rank =  0, finding Y'*HY took 2.999 ms
Rank 0, Project_Hamiltonian used 46.356 ms
Total time for projection: 46.381 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.931386659116538
    last  calculated eigval = 0.030194885779869
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93138665911654
lambda[   2] =  -0.48306793648131
lambda[   3] =  -0.34215709350588
lambda[   4] =  -0.26412252233473
lambda[   5] =  -0.03674710451383
lambda[   6] =   0.00470792333651
lambda[   7] =   0.02207431542161
lambda[   8] =   0.02907744445947
lambda[   9] =   0.03019488577987
==subpsace eigenproblem: bcast eigvals took 0.036 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 2.464 ms
rank =  0, Distributing orbital back into band + domain format took 8.186 ms
rank = 0, Subspace_Rotation used 10.663 ms

Total time for subspace rotation: 10.668 ms
rank = 0, Efermi =  -0.067143683632 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.315 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.167 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.219 ms
rank = 0, Calculating density took 889.711 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.815 ms
rank = 0, D2D took 1.047 ms
rank = 0, Transfering density took 1.057 ms
Etot    =   -17.738713187262
Eband   =    -4.041468423059
E1      =     8.582186469702
E2      =    -3.963995753167
E3      =    -5.585780345335
Exc     =    -4.904700830182
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 1.995e-06, dEband = 1.591e-03
rank = 0, Calculating/Estimating energy took 1.451 ms, Etot = -17.738713187, dEtot = 1.995e-06, dEband = 1.591e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1763672246204, which took 0.070 ms

iter_count = 102, r_2norm = 4.569e-06, tol*||rhs|| = 7.055e-06

Anderson update took 59.969 ms, out of which F'*F took 28.542 ms; b-Ax took 191.956 ms, out of which Lap took 172.029 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 431.296 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495389, int_b + int_rho = -1.273e-13, checking this took 0.115 ms
2-norm of RHS = 430.5476653967663, which took 0.101 ms

iter_count = 150, r_2norm = 3.726e-04, tol*||rhs|| = 4.305e-04

Anderson update took 89.357 ms, out of which F'*F took 42.324 ms; b-Ax took 284.694 ms, out of which Lap took 254.646 ms
Solving Poisson took 626.126 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.153265 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 121.980 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.164469 
Total time for convolution: 	 convolve: 5.173064 
Total time for convolution: 	 convolve: 5.154037 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.767 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.016 ms
======D2D: initiated sending and receiving took 1.163 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.012 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.378 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.415 ms

This SCF took 26678.011 ms, scf error = 4.424e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.130195, lowerbound = -0.931387, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 837.488 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.941 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.404 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 11.375 ms
rank =  0, finding HY took 13.491 ms
rank =  0, distributing HY into block cyclic form took 8.060 ms
rank =  0, finding Y'*HY took 3.044 ms
Rank 0, Project_Hamiltonian used 36.001 ms
Total time for projection: 36.021 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.068 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.931137407356469
    last  calculated eigval = 0.030808861617377
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93113740735647
lambda[   2] =  -0.48284232099477
lambda[   3] =  -0.34192419623486
lambda[   4] =  -0.26388690031236
lambda[   5] =  -0.03656857568946
lambda[   6] =   0.00491944940141
lambda[   7] =   0.02251764303163
lambda[   8] =   0.02952689972215
lambda[   9] =   0.03080886161738
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 2.404 ms
rank =  0, Distributing orbital back into band + domain format took 8.260 ms
rank = 0, Subspace_Rotation used 10.681 ms

Total time for subspace rotation: 10.687 ms
rank = 0, Efermi =  -0.066965154774 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.370 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.153 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.244 ms
rank = 0, Calculating density took 890.249 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.831 ms
rank = 0, D2D took 1.978 ms
rank = 0, Transfering density took 1.987 ms
Etot    =   -17.738724818544
Eband   =    -4.039581649978
E1      =     8.581052106246
E2      =    -3.963161337512
E3      =    -5.586100187353
Exc     =    -4.904950297453
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 3.877e-06, dEband = 6.289e-04
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -17.738724819, dEtot = 3.877e-06, dEband = 6.289e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0926385642173, which took 0.059 ms

iter_count = 96, r_2norm = 3.343e-06, tol*||rhs|| = 3.706e-06

Anderson update took 56.554 ms, out of which F'*F took 26.923 ms; b-Ax took 180.850 ms, out of which Lap took 161.901 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 407.348 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495387, int_b + int_rho = -1.482e-13, checking this took 0.115 ms
2-norm of RHS = 430.5830061151621, which took 0.118 ms

iter_count = 198, r_2norm = 3.606e-04, tol*||rhs|| = 4.306e-04

Anderson update took 117.662 ms, out of which F'*F took 55.661 ms; b-Ax took 375.556 ms, out of which Lap took 335.357 ms
Solving Poisson took 825.168 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.166165 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 86.235 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.155532 
Total time for convolution: 	 convolve: 5.195907 
Total time for convolution: 	 convolve: 5.146833 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.738 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.971 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.374 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.368 ms

This SCF took 27045.089 ms, scf error = 3.625e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.130809, lowerbound = -0.931137, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 823.157 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.243 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.466 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.072 ms
rank =  0, Distribute data + matrix mult took 10.796 ms
rank =  0, finding HY took 13.448 ms
rank =  0, distributing HY into block cyclic form took 8.166 ms
rank =  0, finding Y'*HY took 3.003 ms
Rank 0, Project_Hamiltonian used 35.444 ms
Total time for projection: 35.459 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -0.930934526261260
    last  calculated eigval = 0.036310016611002
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93093452626126
lambda[   2] =  -0.48257259950815
lambda[   3] =  -0.34166589252387
lambda[   4] =  -0.26367920544915
lambda[   5] =  -0.03534519925283
lambda[   6] =   0.00547874611140
lambda[   7] =   0.02453836564215
lambda[   8] =   0.03298945101279
lambda[   9] =   0.03631001661100
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.166 ms
rank =  0, subspace rotation using ScaLAPACK took 2.484 ms
rank =  0, Distributing orbital back into band + domain format took 8.117 ms
rank = 0, Subspace_Rotation used 10.614 ms

Total time for subspace rotation: 10.619 ms
rank = 0, Efermi =  -0.065741778454 calculate fermi energy took 0.091 ms
rank = 0, --- Calculate rho: sum over local bands took 2.319 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.084 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.324 ms
rank = 0, Calculating density took 875.285 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.885 ms
rank = 0, D2D took 1.988 ms
rank = 0, Transfering density took 1.995 ms
Etot    =   -17.738768214176
Eband   =    -4.037704447660
E1      =     8.581143437960
E2      =    -3.961203640740
E3      =    -5.585797482572
Exc     =    -4.904701825564
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 1.447e-05, dEband = 6.257e-04
rank = 0, Calculating/Estimating energy took 0.955 ms, Etot = -17.738768214, dEtot = 1.447e-05, dEband = 6.257e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1068669378516, which took 0.089 ms

iter_count = 90, r_2norm = 4.049e-06, tol*||rhs|| = 4.275e-06

Anderson update took 52.748 ms, out of which F'*F took 25.179 ms; b-Ax took 169.025 ms, out of which Lap took 151.539 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 382.241 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495390, int_b + int_rho = -1.128e-13, checking this took 0.115 ms
2-norm of RHS = 430.5836396305137, which took 0.129 ms

iter_count = 162, r_2norm = 3.830e-04, tol*||rhs|| = 4.306e-04

Anderson update took 95.842 ms, out of which F'*F took 45.755 ms; b-Ax took 307.365 ms, out of which Lap took 275.005 ms
Solving Poisson took 674.676 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.159912 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 99.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.149612 
Total time for convolution: 	 convolve: 5.157550 
Total time for convolution: 	 convolve: 5.162618 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.835 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.959 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.377 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.364 ms

This SCF took 26630.754 ms, scf error = 6.708e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.136310, lowerbound = -0.930935, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 815.771 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.846 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.388 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 18.276 ms
rank =  0, finding HY took 13.510 ms
rank =  0, distributing HY into block cyclic form took 8.104 ms
rank =  0, finding Y'*HY took 2.959 ms
Rank 0, Project_Hamiltonian used 42.878 ms
Total time for projection: 42.896 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -0.930593227302801
    last  calculated eigval = 0.038321754913908
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93059322730280
lambda[   2] =  -0.48224235363975
lambda[   3] =  -0.34134706390210
lambda[   4] =  -0.26335503828360
lambda[   5] =  -0.03471843928925
lambda[   6] =   0.00634982572116
lambda[   7] =   0.02561923712174
lambda[   8] =   0.03400797801733
lambda[   9] =   0.03832175491391
==subpsace eigenproblem: bcast eigvals took 0.050 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 2.468 ms
rank =  0, Distributing orbital back into band + domain format took 8.148 ms
rank = 0, Subspace_Rotation used 10.632 ms

Total time for subspace rotation: 10.637 ms
rank = 0, Efermi =  -0.065115018580 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 2.352 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.203 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.222 ms
rank = 0, Calculating density took 875.398 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.025 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.174 ms
rank = 0, D2D took 1.275 ms
rank = 0, Transfering density took 1.278 ms
Etot    =   -17.738766470960
Eband   =    -4.035075366428
E1      =     8.579692924683
E2      =    -3.959939123630
E3      =    -5.586197304209
Exc     =    -4.905013954829
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 5.811e-07, dEband = 8.764e-04
rank = 0, Calculating/Estimating energy took 0.990 ms, Etot = -17.738766471, dEtot = 5.811e-07, dEband = 8.764e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0943715626597, which took 0.057 ms

iter_count = 90, r_2norm = 3.711e-06, tol*||rhs|| = 3.775e-06

Anderson update took 53.383 ms, out of which F'*F took 25.238 ms; b-Ax took 169.671 ms, out of which Lap took 152.139 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 383.192 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495387, int_b + int_rho = -1.437e-13, checking this took 0.122 ms
2-norm of RHS = 430.5843510924988, which took 0.139 ms

iter_count = 150, r_2norm = 3.563e-04, tol*||rhs|| = 4.306e-04

Anderson update took 88.636 ms, out of which F'*F took 42.437 ms; b-Ax took 285.031 ms, out of which Lap took 254.352 ms
Solving Poisson took 626.318 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.182597 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 81.173 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.154669 
Total time for convolution: 	 convolve: 5.152819 
Total time for convolution: 	 convolve: 5.155470 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.065 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.937 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.381 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.341 ms

This SCF took 26960.163 ms, scf error = 5.549e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.138322, lowerbound = -0.930593, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 842.000 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.459 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.420 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 10.902 ms
rank =  0, finding HY took 13.428 ms
rank =  0, distributing HY into block cyclic form took 8.275 ms
rank =  0, finding Y'*HY took 2.998 ms
Rank 0, Project_Hamiltonian used 35.634 ms
Total time for projection: 35.653 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.930357871534461
    last  calculated eigval = 0.040259554811392
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93035787153446
lambda[   2] =  -0.48201646885758
lambda[   3] =  -0.34113850883036
lambda[   4] =  -0.26313630635054
lambda[   5] =  -0.03420709738858
lambda[   6] =   0.00757539897471
lambda[   7] =   0.02673492604714
lambda[   8] =   0.03541738023193
lambda[   9] =   0.04025955481139
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.168 ms
rank =  0, subspace rotation using ScaLAPACK took 2.415 ms
rank =  0, Distributing orbital back into band + domain format took 8.164 ms
rank = 0, Subspace_Rotation used 10.596 ms

Total time for subspace rotation: 10.602 ms
rank = 0, Efermi =  -0.064603676518 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 2.286 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.300 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.850 ms
rank = 0, Calculating density took 895.443 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.522 ms
rank = 0, D2D took 0.633 ms
rank = 0, Transfering density took 0.638 ms
Etot    =   -17.738769933862
Eband   =    -4.033298311315
E1      =     8.578739147360
E2      =    -3.959055505328
E3      =    -5.586454745955
Exc     =    -4.905214518965
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 1.154e-06, dEband = 5.924e-04
rank = 0, Calculating/Estimating energy took 0.973 ms, Etot = -17.738769934, dEtot = 1.154e-06, dEband = 5.924e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1007849294647, which took 0.093 ms

iter_count = 90, r_2norm = 3.824e-06, tol*||rhs|| = 4.031e-06

Anderson update took 53.064 ms, out of which F'*F took 25.263 ms; b-Ax took 169.274 ms, out of which Lap took 152.156 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 382.114 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495388, int_b + int_rho = -1.328e-13, checking this took 0.144 ms
2-norm of RHS = 430.5806617158474, which took 0.158 ms

iter_count = 78, r_2norm = 3.978e-04, tol*||rhs|| = 4.306e-04

Anderson update took 46.474 ms, out of which F'*F took 22.013 ms; b-Ax took 148.458 ms, out of which Lap took 132.728 ms
Solving Poisson took 327.730 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.157172 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 139.756 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.151079 
Total time for convolution: 	 convolve: 5.151393 
Total time for convolution: 	 convolve: 5.175805 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.164 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.703 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.965 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.369 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.357 ms

This SCF took 26353.340 ms, scf error = 5.115e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.140260, lowerbound = -0.930358, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 815.910 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 24.887 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.405 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.094 ms
rank =  0, Distribute data + matrix mult took 27.406 ms
rank =  0, finding HY took 13.376 ms
rank =  0, distributing HY into block cyclic form took 8.251 ms
rank =  0, finding Y'*HY took 2.935 ms
Rank 0, Project_Hamiltonian used 52.001 ms
Total time for projection: 52.031 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.061 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -0.930235239854316
    last  calculated eigval = 0.039487326568959
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93023523985432
lambda[   2] =  -0.48191141109056
lambda[   3] =  -0.34102604051614
lambda[   4] =  -0.26302022187761
lambda[   5] =  -0.03439883531615
lambda[   6] =   0.00727706024725
lambda[   7] =   0.02638871522614
lambda[   8] =   0.03488465000033
lambda[   9] =   0.03948732656896
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 2.442 ms
rank =  0, Distributing orbital back into band + domain format took 8.102 ms
rank = 0, Subspace_Rotation used 10.562 ms

Total time for subspace rotation: 10.567 ms
rank = 0, Efermi =  -0.064795414466 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.798 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.134 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.191 ms
rank = 0, Calculating density took 884.460 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.705 ms
rank = 0, D2D took 1.192 ms
rank = 0, Transfering density took 1.199 ms
Etot    =   -17.738769057569
Eband   =    -4.032385826848
E1      =     8.578112333847
E2      =    -3.958716559007
E3      =    -5.586685890542
Exc     =    -4.905391511892
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 2.921e-07, dEband = 3.042e-04
rank = 0, Calculating/Estimating energy took 1.012 ms, Etot = -17.738769058, dEtot = 2.921e-07, dEband = 3.042e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0740643630518, which took 0.072 ms

iter_count = 96, r_2norm = 2.168e-06, tol*||rhs|| = 2.963e-06

Anderson update took 56.684 ms, out of which F'*F took 26.962 ms; b-Ax took 180.844 ms, out of which Lap took 161.999 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 407.809 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495390, int_b + int_rho = -1.182e-13, checking this took 0.125 ms
2-norm of RHS = 430.5708421322864, which took 0.139 ms

iter_count = 138, r_2norm = 4.111e-04, tol*||rhs|| = 4.306e-04

Anderson update took 80.683 ms, out of which F'*F took 53.256 ms; b-Ax took 278.928 ms, out of which Lap took 249.468 ms
Solving Poisson took 599.516 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.149080 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 133.682 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.150037 
Total time for convolution: 	 convolve: 5.147042 
Total time for convolution: 	 convolve: 5.146312 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.968 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.386 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.381 ms

This SCF took 26604.912 ms, scf error = 3.844e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.139487, lowerbound = -0.930235, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 842.874 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.654 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.370 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 11.042 ms
rank =  0, finding HY took 13.440 ms
rank =  0, distributing HY into block cyclic form took 8.189 ms
rank =  0, finding Y'*HY took 2.969 ms
Rank 0, Project_Hamiltonian used 35.668 ms
Total time for projection: 35.688 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.929901475949501
    last  calculated eigval = 0.037970867598058
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.92990147594950
lambda[   2] =  -0.48162272656951
lambda[   3] =  -0.34072569286337
lambda[   4] =  -0.26270688991616
lambda[   5] =  -0.03509940573200
lambda[   6] =   0.00706647027257
lambda[   7] =   0.02518746359508
lambda[   8] =   0.03389778965414
lambda[   9] =   0.03797086759806
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 2.414 ms
rank =  0, Distributing orbital back into band + domain format took 8.196 ms
rank = 0, Subspace_Rotation used 11.133 ms

Total time for subspace rotation: 11.159 ms
rank = 0, Efermi =  -0.065495984808 calculate fermi energy took 0.616 ms
rank = 0, --- Calculate rho: sum over local bands took 2.503 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.027 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.227 ms
rank = 0, Calculating density took 895.369 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.790 ms
rank = 0, D2D took 0.998 ms
rank = 0, Transfering density took 1.003 ms
Etot    =   -17.738778215287
Eband   =    -4.029913570771
E1      =     8.576432931118
E2      =    -3.957780961427
E3      =    -5.587264372498
Exc     =    -4.905836407334
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 3.053e-06, dEband = 8.241e-04
rank = 0, Calculating/Estimating energy took 1.094 ms, Etot = -17.738778215, dEtot = 3.053e-06, dEband = 8.241e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0341800979127, which took 0.061 ms

iter_count = 102, r_2norm = 8.522e-07, tol*||rhs|| = 1.367e-06

Anderson update took 59.772 ms, out of which F'*F took 28.524 ms; b-Ax took 192.248 ms, out of which Lap took 172.478 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 431.405 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495388, int_b + int_rho = -1.310e-13, checking this took 0.134 ms
2-norm of RHS = 430.5795840020793, which took 0.156 ms

iter_count = 144, r_2norm = 4.075e-04, tol*||rhs|| = 4.306e-04

Anderson update took 85.793 ms, out of which F'*F took 40.719 ms; b-Ax took 273.446 ms, out of which Lap took 244.460 ms
Solving Poisson took 601.197 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.169683 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 111.538 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.136420 
Total time for convolution: 	 convolve: 5.153816 
Total time for convolution: 	 convolve: 5.148439 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.956 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.382 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.361 ms

This SCF took 26586.645 ms, scf error = 1.076e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.137971, lowerbound = -0.929901, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 826.317 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.307 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.396 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.085 ms
rank =  0, Distribute data + matrix mult took 10.802 ms
rank =  0, finding HY took 13.402 ms
rank =  0, distributing HY into block cyclic form took 8.074 ms
rank =  0, finding Y'*HY took 3.024 ms
Rank 0, Project_Hamiltonian used 35.332 ms
Total time for projection: 35.345 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.061 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.930233097435363
    last  calculated eigval = 0.039579193016017
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93023309743536
lambda[   2] =  -0.48190892976239
lambda[   3] =  -0.34102170667722
lambda[   4] =  -0.26301234272045
lambda[   5] =  -0.03524575395927
lambda[   6] =   0.00816004974859
lambda[   7] =   0.02519642904777
lambda[   8] =   0.03514115008614
lambda[   9] =   0.03957919301602
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 2.367 ms
rank =  0, Distributing orbital back into band + domain format took 8.779 ms
rank = 0, Subspace_Rotation used 11.163 ms

Total time for subspace rotation: 11.169 ms
rank = 0, Efermi =  -0.065642333121 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.360 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.881 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.211 ms
rank = 0, Calculating density took 878.572 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.810 ms
rank = 0, D2D took 0.929 ms
rank = 0, Transfering density took 0.935 ms
Etot    =   -17.738791977292
Eband   =    -4.032352153365
E1      =     8.578140258930
E2      =    -3.958652618008
E3      =    -5.586616055481
Exc     =    -4.905342254121
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 4.587e-06, dEband = 8.129e-04
rank = 0, Calculating/Estimating energy took 0.969 ms, Etot = -17.738791977, dEtot = 4.587e-06, dEband = 8.129e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0244672524398, which took 0.087 ms

iter_count = 102, r_2norm = 7.908e-07, tol*||rhs|| = 9.787e-07

Anderson update took 60.485 ms, out of which F'*F took 28.518 ms; b-Ax took 191.622 ms, out of which Lap took 171.434 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 432.029 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495390, int_b + int_rho = -1.146e-13, checking this took 0.143 ms
2-norm of RHS = 430.5755066822783, which took 0.088 ms

iter_count = 120, r_2norm = 4.168e-04, tol*||rhs|| = 4.306e-04

Anderson update took 71.137 ms, out of which F'*F took 34.049 ms; b-Ax took 228.425 ms, out of which Lap took 204.614 ms
Solving Poisson took 501.708 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.153064 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 136.600 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.148546 
Total time for convolution: 	 convolve: 5.140570 
Total time for convolution: 	 convolve: 5.133317 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.824 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.956 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.401 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.379 ms

This SCF took 26518.718 ms, scf error = 3.930e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.139579, lowerbound = -0.930233, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 814.625 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.116 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.394 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 21.532 ms
rank =  0, finding HY took 13.385 ms
rank =  0, distributing HY into block cyclic form took 8.208 ms
rank =  0, finding Y'*HY took 2.937 ms
Rank 0, Project_Hamiltonian used 46.090 ms
Total time for projection: 46.115 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.062 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.930091280779426
    last  calculated eigval = 0.039918536561998
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.93009128077943
lambda[   2] =  -0.48178447236861
lambda[   3] =  -0.34089474322109
lambda[   4] =  -0.26287912999189
lambda[   5] =  -0.03535599357630
lambda[   6] =   0.00872319010677
lambda[   7] =   0.02511489011003
lambda[   8] =   0.03532460203045
lambda[   9] =   0.03991853656200
==subpsace eigenproblem: bcast eigvals took 0.043 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 2.100 ms
rank =  0, Distributing orbital back into band + domain format took 7.832 ms
rank = 0, Subspace_Rotation used 9.950 ms

Total time for subspace rotation: 9.961 ms
rank = 0, Efermi =  -0.065752572700 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.337 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.037 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.249 ms
rank = 0, Calculating density took 878.089 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
rank = 0, D2D took 0.663 ms
rank = 0, Transfering density took 0.669 ms
Etot    =   -17.738795403195
Eband   =    -4.031299252897
E1      =     8.577452513321
E2      =    -3.958235558918
E3      =    -5.586829889263
Exc     =    -4.905507609576
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 1.142e-06, dEband = 3.510e-04
rank = 0, Calculating/Estimating energy took 0.981 ms, Etot = -17.738795403, dEtot = 1.142e-06, dEband = 3.510e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0275151963510, which took 0.053 ms

iter_count = 102, r_2norm = 7.269e-07, tol*||rhs|| = 1.101e-06

Anderson update took 59.651 ms, out of which F'*F took 28.661 ms; b-Ax took 191.988 ms, out of which Lap took 172.285 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 431.042 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495386, int_b + int_rho = -1.564e-13, checking this took 0.108 ms
2-norm of RHS = 430.5723280937040, which took 0.172 ms

iter_count = 132, r_2norm = 4.019e-04, tol*||rhs|| = 4.306e-04

Anderson update took 78.179 ms, out of which F'*F took 37.302 ms; b-Ax took 250.945 ms, out of which Lap took 224.431 ms
Solving Poisson took 550.705 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.171781 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 107.615 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.169342 
Total time for convolution: 	 convolve: 5.150275 
Total time for convolution: 	 convolve: 5.141591 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 3.328 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.945 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.371 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.337 ms

This SCF took 26528.282 ms, scf error = 2.683e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.139919, lowerbound = -0.930091, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 845.217 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.504 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.373 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 10.897 ms
rank =  0, finding HY took 13.378 ms
rank =  0, distributing HY into block cyclic form took 8.185 ms
rank =  0, finding Y'*HY took 2.961 ms
Rank 0, Project_Hamiltonian used 35.451 ms
Total time for projection: 35.466 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.063 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.929957537917232
    last  calculated eigval = 0.040474707186913
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.92995753791723
lambda[   2] =  -0.48166473726008
lambda[   3] =  -0.34077843199888
lambda[   4] =  -0.26275686806532
lambda[   5] =  -0.03554427112174
lambda[   6] =   0.00974243188544
lambda[   7] =   0.02510249535161
lambda[   8] =   0.03553302686320
lambda[   9] =   0.04047470718691
==subpsace eigenproblem: bcast eigvals took 0.060 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 2.122 ms
rank =  0, Distributing orbital back into band + domain format took 7.907 ms
rank = 0, Subspace_Rotation used 10.580 ms

Total time for subspace rotation: 10.591 ms
rank = 0, Efermi =  -0.065940850222 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.402 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.071 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.277 ms
rank = 0, Calculating density took 898.183 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
rank = 0, D2D took 0.662 ms
rank = 0, Transfering density took 0.667 ms
Etot    =   -17.738796942872
Eband   =    -4.030315150659
E1      =     8.576808969754
E2      =    -3.957846989167
E3      =    -5.587031734674
Exc     =    -4.905662983584
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 5.132e-07, dEband = 3.280e-04
rank = 0, Calculating/Estimating energy took 0.983 ms, Etot = -17.738796943, dEtot = 5.132e-07, dEband = 3.280e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0214558866470, which took 0.066 ms

iter_count = 102, r_2norm = 5.894e-07, tol*||rhs|| = 8.582e-07

Anderson update took 60.193 ms, out of which F'*F took 28.476 ms; b-Ax took 191.610 ms, out of which Lap took 171.888 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 432.418 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495391, int_b + int_rho = -1.000e-13, checking this took 0.126 ms
2-norm of RHS = 430.5696307273427, which took 0.157 ms

iter_count = 144, r_2norm = 3.655e-04, tol*||rhs|| = 4.306e-04

Anderson update took 84.862 ms, out of which F'*F took 40.707 ms; b-Ax took 274.075 ms, out of which Lap took 244.986 ms
Solving Poisson took 600.741 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.155 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.146819 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 103.152 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.143726 
Total time for convolution: 	 convolve: 5.156849 
Total time for convolution: 	 convolve: 5.137920 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.631 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.152 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.947 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.375 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.344 ms

This SCF took 26569.661 ms, scf error = 1.575e-04
-------------
SCF iter 24  
-------------

 Chebfilt 27, in Chebyshev filtering, lambda_cutoff = 0.140475, lowerbound = -0.929958, upperbound = 267.565659

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 811.721 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 22.884 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.407 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.055 ms
rank =  0, Distribute data + matrix mult took 25.362 ms
rank =  0, finding HY took 13.428 ms
rank =  0, distributing HY into block cyclic form took 8.182 ms
rank =  0, finding Y'*HY took 2.979 ms
Rank 0, Project_Hamiltonian used 49.977 ms
Total time for projection: 50.002 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.929788968237785
    last  calculated eigval = 0.038587142400563
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.92978896823778
lambda[   2] =  -0.48151279682760
lambda[   3] =  -0.34063674466379
lambda[   4] =  -0.26260806207118
lambda[   5] =  -0.03649014503599
lambda[   6] =   0.01038341190918
lambda[   7] =   0.02356886158481
lambda[   8] =   0.03439100478281
lambda[   9] =   0.03858714240056
==subpsace eigenproblem: bcast eigvals took 0.069 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 1.989 ms
rank =  0, Distributing orbital back into band + domain format took 110.782 ms
rank = 0, Subspace_Rotation used 112.788 ms

Total time for subspace rotation: 112.799 ms
rank = 0, Efermi =  -0.066886724250 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 2.323 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.125 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.273 ms
rank = 0, Calculating density took 981.435 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
rank = 0, D2D took 0.650 ms
rank = 0, Transfering density took 0.655 ms
Etot    =   -17.738802076333
Eband   =    -4.029093143781
E1      =     8.576000240186
E2      =    -3.957366283878
E3      =    -5.587296420185
Exc     =    -4.905865374576
Esc     =   -26.924506502070
Entropy =    -0.000000000155
dE = 1.711e-06, dEband = 4.073e-04
rank = 0, Calculating/Estimating energy took 1.004 ms, Etot = -17.738802076, dEtot = 1.711e-06, dEband = 4.073e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0092133680029, which took 0.082 ms

iter_count = 108, r_2norm = 2.356e-07, tol*||rhs|| = 3.685e-07

Anderson update took 63.379 ms, out of which F'*F took 30.353 ms; b-Ax took 203.236 ms, out of which Lap took 182.509 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.666 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000000495401, int_rho =   8.00000000495386, int_b + int_rho = -1.583e-13, checking this took 0.134 ms
2-norm of RHS = 430.5700286322053, which took 0.129 ms

iter_count = 102, r_2norm = 3.676e-04, tol*||rhs|| = 4.306e-04

Anderson update took 60.138 ms, out of which F'*F took 28.917 ms; b-Ax took 194.209 ms, out of which Lap took 173.806 ms
Solving Poisson took 426.405 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.150352 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 109.841 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.136879 
Total time for convolution: 	 convolve: 5.141343 
Total time for convolution: 	 convolve: 5.146351 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.765 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.971 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.379 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.371 ms

This SCF took 26501.469 ms, scf error = 3.975e-05
The last 9 occupations of kpoints #1 are (Nelectron = 8):
lambda[   1] =  -0.92978896823778, occ[   1] =   2.00000000000000
lambda[   2] =  -0.48151279682760, occ[   2] =   2.00000000000000
lambda[   3] =  -0.34063674466379, occ[   3] =   2.00000000000000
lambda[   4] =  -0.26260806207118, occ[   4] =   2.00000000000000
lambda[   5] =  -0.03649014503599, occ[   5] =   0.00000000495388
lambda[   6] =   0.01038341190918, occ[   6] =   0.00000000000000
lambda[   7] =   0.02356886158481, occ[   7] =   0.00000000000000
lambda[   8] =   0.03439100478281, occ[   8] =   0.00000000000000
lambda[   9] =   0.03858714240056, occ[   9] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 8 (90%) = 0.000000000000000.
Occupation of state 9 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.951 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.137 ms, time for Allreduce/Reduce: 3.467 ms 
Time for calculating local force components: 8.577 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000291252677   0.00000022322309  -1.11458900329176
 -0.00000000728069  -0.06057492428989   0.04433321787437
 -0.00000000256435   0.06057492992237   0.04433322211589
force_loc = 
 -0.00000131174301  -0.00000018963971   1.08653872883372
  0.00000022357163   0.06528374200336  -0.04655358831045
  0.00000007816715  -0.06528370214525  -0.04655346072896
Time for calculating nonlocal force components: 20.167 ms
[32mforces_xc: 
[0m[32m -0.00000007901118  -0.00000000239462   0.03247177776797
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0mTime for calculating XC forces components: 9.161 ms
 Cartesian force = 
  0.00000091721714   0.00000000562898   0.00442787188967
 -0.00000038826450   0.00470879215369  -0.00221400185634
 -0.00000052895264  -0.00470879778266  -0.00221387003333
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.373 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Time for printing density: 387.538 ms
The program took 674.797 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:31:48
Job ID:        2266670
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:18:36,vmem=8464K,walltime=00:11:33,mem=8168K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-17-2
---------------------------------------
