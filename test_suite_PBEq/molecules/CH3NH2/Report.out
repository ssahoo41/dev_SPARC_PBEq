---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:45
Job ID:    2266481
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:51
Job ID:    2266481
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.068 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 3.265 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 7.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 8.245 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 91.933 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.950 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.084 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.551066	   12.142378	   10.000000	
   11.448934	   11.937828	   11.659684	
   11.448934	   11.937828	    8.340316	
    9.454481	    7.857622	    8.476229	
    9.454481	    7.857622	   11.523771	
   10.428747	   11.263392	   10.000000	
   10.428747	    8.488265	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.170 ms
Set up communicators.

--set up spincomm took 3.811 ms

--set up kptcomm took 0.348 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {2, 2, 3}
gridsizes = [100, 100, 100], Nstates = 13, dmcomm dims = [2, 2, 3]

--set up dmcomm took 0.011 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 1, ScaLAPACK topology Dims = (1, 1)
nproc = 12, size_blacscomm = 1 = dims[0] * dims[1] = (1, 1)
Nd_blacscomm 85000, Nstates 13 
rank =  0, my blacs rank = 0, BLCYC size (85000, 13), actual size (85000, 13)
rank = 0, mb = nb = 13, mbQ = nbQ = 64
rank = 0, nr_Hp = 13, nc_Hp = 13
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.109 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 1
# of bands per bandcomm          : 13
npdomain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.954 ms

Calculate_SplineDerivRadFun took 0.229 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.259 ms.
time spent on vectorized spline interp: 2.725 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.008 ms.
time spent on vectorized spline interp: 1.652 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.492 ms.
time spent on vectorized spline interp: 1.687 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.521 ms.

Calculating rb for all atom types took 16.108 ms
----------------------
Estimated memory usage
Total: 562.34 MB
orbitals             : 297.55 MB
global sized vectors : 213.62 MB
subspace matrices : 47.53 kB
others : 51.12 MB
----------------------------------------------
Estimated memory usage per processor: 46.86 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.915 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -14.0000000204638, sum_int_rho = 13.5071430989358
PosCharge = 14.000000020464, NegCharge = -13.507143098936, scal_fac = 1.036488613315
After scaling, int_rho = 14.0000000204637, PosCharge + NegCharge - NetCharge = 4.619e-14
--Calculate Vref took 0.261 ms
--Calculate rho_guess took 1.428 ms

 integral of b = -14.0000000204638,
 int{b} + Nelectron + NetCharge = -2.046e-08,
 Esc = -34.1900293581100,
 MPI_Reduce took 6.062 ms

Calculating b & b_ref took 12.237 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.011 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.023 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.024 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 24.903 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046382, int_b + int_rho = 1.455e-14, checking this took 0.097 ms
2-norm of RHS = 627.5364937451618, which took 0.094 ms

iter_count = 420, r_2norm = 4.892e-04, tol*||rhs|| = 6.275e-04

Anderson update took 240.820 ms, out of which F'*F took 104.781 ms; b-Ax took 729.107 ms, out of which Lap took 653.097 ms
Solving Poisson took 1556.604 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.374 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.818 ms
Total time for convolution: 	 convolve: 5.113871 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.249 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.770 ms
Total time for convolution: 	 convolve: 5.095050 
Total time for convolution: 	 convolve: 5.088728 
Total time for convolution: 	 convolve: 5.090235 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.710 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
rank = 0, XC calculation took 24254.442 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.583 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 1.654 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.125 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.738 ms
    Lanczos iter 53, eigmin  = -0.888634420, eigmax = 264.923181556, err_eigmin = 7.106e-04, err_eigmax = 9.755e-03
rank =   0, Lanczos took 119.614 ms, eigmin = -0.888634419925, eigmax = 267.572413372060

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.291889, lowerbound = -0.988634, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1092.590 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.790 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.053 ms
rank =  0, Distribute data + matrix mult took 2.848 ms
rank =  0, finding HY took 18.080 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.396 ms
Rank 0, Project_Hamiltonian used 23.346 ms
Total time for projection: 23.361 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.365 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.115 ms
rank = 0, Solve_Generalized_EigenProblem used 0.495 ms
    first calculated eigval = 2.843686882651987
    last  calculated eigval = 3.236744354586512
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =   2.84368688265199
lambda[   2] =   2.89100221529342
lambda[   3] =   2.91479298359336
lambda[   4] =   2.93504459320362
lambda[   5] =   2.97407625115233
lambda[   6] =   3.00474810377187
lambda[   7] =   3.03531841157996
lambda[   8] =   3.05064380287688
lambda[   9] =   3.08278688656030
lambda[  10] =   3.09675237861057
lambda[  11] =   3.14353293322853
lambda[  12] =   3.20976612647307
lambda[  13] =   3.23674435458651
==subpsace eigenproblem: bcast eigvals took 0.037 ms
Total time for solving subspace eigenvalue problem: 0.535 ms
rank =  0, subspace rotation using ScaLAPACK took 2.940 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 2.946 ms

Total time for subspace rotation: 2.947 ms
rank = 0, Efermi =   3.042981107426 calculate fermi energy took 0.048 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.336744, lowerbound = -0.988634, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1084.566 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.725 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.090 ms
rank =  0, Distribute data + matrix mult took 2.819 ms
rank =  0, finding HY took 18.027 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.322 ms
Rank 0, Project_Hamiltonian used 23.186 ms
Total time for projection: 23.190 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.025 ms
rank = 0, Solve_Generalized_EigenProblem used 0.132 ms
    first calculated eigval = -0.562081604295743
    last  calculated eigval = 0.443385913695544
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.56208160429574
lambda[   2] =  -0.15569554261190
lambda[   3] =  -0.08926707292049
lambda[   4] =  -0.06949497302096
lambda[   5] =   0.05794641072786
lambda[   6] =   0.15064665988171
lambda[   7] =   0.25151925717598
lambda[   8] =   0.31986954929826
lambda[   9] =   0.37125297267545
lambda[  10] =   0.39193089936531
lambda[  11] =   0.40015608566114
lambda[  12] =   0.41839715254474
lambda[  13] =   0.44338591369554
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 3.045 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.049 ms

Total time for subspace rotation: 3.050 ms
rank = 0, Efermi =   0.290723817538 calculate fermi energy took 0.020 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.543386, lowerbound = -0.988634, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1084.146 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.730 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.067 ms
rank =  0, Distribute data + matrix mult took 2.802 ms
rank =  0, finding HY took 18.151 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.318 ms
Rank 0, Project_Hamiltonian used 23.293 ms
Total time for projection: 23.329 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.027 ms
rank = 0, Solve_Generalized_EigenProblem used 0.114 ms
    first calculated eigval = -0.896491634581634
    last  calculated eigval = 0.161008467468310
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.89649163458163
lambda[   2] =  -0.70817840112471
lambda[   3] =  -0.51850536692922
lambda[   4] =  -0.49185773935278
lambda[   5] =  -0.45604077908384
lambda[   6] =  -0.41641970832593
lambda[   7] =  -0.27280301012248
lambda[   8] =   0.06266753564205
lambda[   9] =   0.08944334378852
lambda[  10] =   0.11023479582688
lambda[  11] =   0.12720617165155
lambda[  12] =   0.13381362508311
lambda[  13] =   0.16100846746831
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.131 ms
rank =  0, subspace rotation using ScaLAPACK took 2.963 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 2.978 ms

Total time for subspace rotation: 2.978 ms
rank = 0, Efermi =   0.033521801876 calculate fermi energy took 0.042 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.261008, lowerbound = -0.988634, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1092.486 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.738 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.065 ms
rank =  0, Distribute data + matrix mult took 2.809 ms
rank =  0, finding HY took 18.084 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.334 ms
Rank 0, Project_Hamiltonian used 23.247 ms
Total time for projection: 23.251 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.108 ms
    first calculated eigval = -0.897494536555860
    last  calculated eigval = 0.102815536832897
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.89749453655586
lambda[   2] =  -0.71188308744244
lambda[   3] =  -0.53091717013529
lambda[   4] =  -0.49796534338793
lambda[   5] =  -0.46198765228796
lambda[   6] =  -0.42630585199252
lambda[   7] =  -0.30223263196294
lambda[   8] =   0.00347698770568
lambda[   9] =   0.02856528352068
lambda[  10] =   0.06095908923731
lambda[  11] =   0.07021945715354
lambda[  12] =   0.08333038887964
lambda[  13] =   0.10281553683290
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.120 ms
rank =  0, subspace rotation using ScaLAPACK took 3.036 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.043 ms

Total time for subspace rotation: 3.043 ms
rank = 0, Efermi =  -0.025668746061 calculate fermi energy took 0.028 ms
rank = 0, --- Calculate rho: sum over local bands took 1.499 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 4583.573 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
rank = 0, D2D took 0.459 ms
rank = 0, Transfering density took 1.373 ms
Etot    =   -19.448582924631
Eband   =    -7.657572547459
E1      =    15.772065760728
E2      =    -5.680188052457
E3      =    -7.611227326336
Exc     =    -6.664462157969
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 2.778e+00, dEband = 1.094e+00
rank = 0, Calculating/Estimating energy took 0.883 ms, Etot = -19.448582925, dEtot = 2.778e+00, dEband = 1.094e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 42.7570270375740, which took 0.055 ms

iter_count = 96, r_2norm = 1.355e-03, tol*||rhs|| = 1.710e-03

Anderson update took 51.521 ms, out of which F'*F took 24.061 ms; b-Ax took 162.422 ms, out of which Lap took 145.811 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.898 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046371, int_b + int_rho = -9.823e-14, checking this took 0.107 ms
2-norm of RHS = 623.7970909978044, which took 0.156 ms

iter_count = 282, r_2norm = 6.116e-04, tol*||rhs|| = 6.238e-04

Anderson update took 149.765 ms, out of which F'*F took 70.582 ms; b-Ax took 479.352 ms, out of which Lap took 426.747 ms
Solving Poisson took 1011.802 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.908 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.153150 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.388 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.373 ms
Total time for convolution: 	 convolve: 5.174583 
Total time for convolution: 	 convolve: 5.176108 
Total time for convolution: 	 convolve: 5.129788 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.382 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.575 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.328 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.346 ms

This SCF took 30776.318 ms, scf error = 1.938e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.202816, lowerbound = -0.897495, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1086.473 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.728 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.039 ms
rank =  0, Distribute data + matrix mult took 2.771 ms
rank =  0, finding HY took 18.151 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.314 ms
Rank 0, Project_Hamiltonian used 23.258 ms
Total time for projection: 23.274 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.110 ms
    first calculated eigval = -0.864811529838321
    last  calculated eigval = 0.072494978279410
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86481152983832
lambda[   2] =  -0.67762966660657
lambda[   3] =  -0.50242227136058
lambda[   4] =  -0.46598082602161
lambda[   5] =  -0.43041824969991
lambda[   6] =  -0.39720047835091
lambda[   7] =  -0.26761485488659
lambda[   8] =  -0.02551018776655
lambda[   9] =   0.00589245170404
lambda[  10] =   0.03626327384845
lambda[  11] =   0.04555978416487
lambda[  12] =   0.05980123691332
lambda[  13] =   0.07249497827941
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.128 ms
rank =  0, subspace rotation using ScaLAPACK took 3.034 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.038 ms

Total time for subspace rotation: 3.039 ms
rank = 0, Efermi =  -0.054655921602 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 1.510 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1114.585 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.336 ms
rank = 0, D2D took 1.435 ms
rank = 0, Transfering density took 1.441 ms
Etot    =   -19.412877611028
Eband   =    -7.212155754051
E1      =    15.378590238482
E2      =    -5.640647539182
E3      =    -7.733116830625
Exc     =    -6.763047106542
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 5.101e-03, dEband = 6.363e-02
rank = 0, Calculating/Estimating energy took 0.862 ms, Etot = -19.412877611, dEtot = 5.101e-03, dEband = 6.363e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 14.4843075946729, which took 1.357 ms

iter_count = 102, r_2norm = 4.528e-04, tol*||rhs|| = 5.794e-04

Anderson update took 54.233 ms, out of which F'*F took 25.193 ms; b-Ax took 172.377 ms, out of which Lap took 153.560 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.916 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046377, int_b + int_rho = -4.366e-14, checking this took 0.074 ms
2-norm of RHS = 618.6791392502662, which took 0.091 ms

iter_count = 294, r_2norm = 6.154e-04, tol*||rhs|| = 6.187e-04

Anderson update took 155.775 ms, out of which F'*F took 72.599 ms; b-Ax took 494.976 ms, out of which Lap took 440.737 ms
Solving Poisson took 1050.810 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.790 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.254452 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.244665 
Total time for convolution: 	 convolve: 5.164608 
Total time for convolution: 	 convolve: 5.224975 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.520 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.604 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.684 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.314 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.331 ms

This SCF took 27869.444 ms, scf error = 1.327e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.172495, lowerbound = -0.864812, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1101.498 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.733 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.079 ms
rank =  0, Distribute data + matrix mult took 2.817 ms
rank =  0, finding HY took 18.283 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.327 ms
Rank 0, Project_Hamiltonian used 23.449 ms
Total time for projection: 23.469 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.115 ms
    first calculated eigval = -0.816894445461178
    last  calculated eigval = 0.058051333994165
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.81689444546118
lambda[   2] =  -0.62178258535918
lambda[   3] =  -0.45838018178992
lambda[   4] =  -0.41570218384604
lambda[   5] =  -0.38023781749479
lambda[   6] =  -0.34894222763263
lambda[   7] =  -0.21668244312354
lambda[   8] =  -0.03407850655060
lambda[   9] =   0.00071329472961
lambda[  10] =   0.02466377853839
lambda[  11] =   0.03392337057971
lambda[  12] =   0.04362238535176
lambda[  13] =   0.05805133399417
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.133 ms
rank =  0, subspace rotation using ScaLAPACK took 3.025 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.033 ms

Total time for subspace rotation: 3.033 ms
rank = 0, Efermi =  -0.063224240356 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.238 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.033 ms
rank = 0, Calculating density took 1130.978 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
rank = 0, D2D took 0.324 ms
rank = 0, Transfering density took 0.329 ms
Etot    =   -19.385404082141
Eband   =    -6.517243770112
E1      =    14.783837442346
E2      =    -5.524127872621
E3      =    -7.958012333401
Exc     =    -6.944108601673
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 3.925e-03, dEband = 9.927e-02
rank = 0, Calculating/Estimating energy took 0.862 ms, Etot = -19.385404082, dEtot = 3.925e-03, dEband = 9.927e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.7668190561687, which took 0.075 ms

iter_count = 108, r_2norm = 9.843e-05, tol*||rhs|| = 1.507e-04

Anderson update took 57.533 ms, out of which F'*F took 26.748 ms; b-Ax took 183.859 ms, out of which Lap took 163.366 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.816 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046374, int_b + int_rho = -7.640e-14, checking this took 0.128 ms
2-norm of RHS = 618.4340018949806, which took 0.117 ms

iter_count = 276, r_2norm = 5.950e-04, tol*||rhs|| = 6.184e-04

Anderson update took 146.266 ms, out of which F'*F took 68.494 ms; b-Ax took 466.472 ms, out of which Lap took 416.889 ms
Solving Poisson took 987.063 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.419 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.196868 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.157533 
Total time for convolution: 	 convolve: 5.160687 
Total time for convolution: 	 convolve: 5.151790 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.777 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.546 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.330 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.348 ms

This SCF took 27207.515 ms, scf error = 5.028e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.158051, lowerbound = -0.816894, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1089.326 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.724 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.052 ms
rank =  0, Distribute data + matrix mult took 2.782 ms
rank =  0, finding HY took 18.177 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.354 ms
Rank 0, Project_Hamiltonian used 23.336 ms
Total time for projection: 23.355 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.028 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.810637410571415
    last  calculated eigval = 0.049661815587767
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.81063741057142
lambda[   2] =  -0.60648237091795
lambda[   3] =  -0.44908733373034
lambda[   4] =  -0.40412202193494
lambda[   5] =  -0.36716006591863
lambda[   6] =  -0.33383230105111
lambda[   7] =  -0.21019756874330
lambda[   8] =  -0.03637179236957
lambda[   9] =  -0.00079048450880
lambda[  10] =   0.01809082717811
lambda[  11] =   0.02624857593012
lambda[  12] =   0.03143680883025
lambda[  13] =   0.04966181558777
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 3.057 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.064 ms

Total time for subspace rotation: 3.065 ms
rank = 0, Efermi =  -0.065517526207 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.476 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1118.030 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.262 ms
rank = 0, D2D took 0.481 ms
rank = 0, Transfering density took 0.490 ms
Etot    =   -19.381308621878
Eband   =    -6.363038146480
E1      =    14.687851518344
E2      =    -5.453823885404
E3      =    -8.026394006892
Exc     =    -6.996310527313
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 5.851e-04, dEband = 2.203e-02
rank = 0, Calculating/Estimating energy took 1.034 ms, Etot = -19.381308622, dEtot = 5.851e-04, dEband = 2.203e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.6594938320708, which took 0.060 ms

iter_count = 108, r_2norm = 5.903e-05, tol*||rhs|| = 6.638e-05

Anderson update took 57.018 ms, out of which F'*F took 26.831 ms; b-Ax took 185.045 ms, out of which Lap took 163.788 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.882 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046377, int_b + int_rho = -4.729e-14, checking this took 0.120 ms
2-norm of RHS = 618.4852217781648, which took 0.144 ms

iter_count = 240, r_2norm = 5.446e-04, tol*||rhs|| = 6.185e-04

Anderson update took 145.791 ms, out of which F'*F took 61.826 ms; b-Ax took 414.887 ms, out of which Lap took 371.374 ms
Solving Poisson took 888.136 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.178500 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.189034 
Total time for convolution: 	 convolve: 5.206990 
Total time for convolution: 	 convolve: 5.237846 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.369 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.319 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.335 ms

This SCF took 27487.940 ms, scf error = 1.178e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.149662, lowerbound = -0.810637, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1086.292 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.733 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.095 ms
rank =  0, Distribute data + matrix mult took 2.833 ms
rank =  0, finding HY took 18.207 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.324 ms
Rank 0, Project_Hamiltonian used 23.387 ms
Total time for projection: 23.404 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.095 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.122 ms
    first calculated eigval = -0.807529358304456
    last  calculated eigval = 0.043038062407030
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.80752935830446
lambda[   2] =  -0.60343654412060
lambda[   3] =  -0.44618921706065
lambda[   4] =  -0.40111705281340
lambda[   5] =  -0.36417024145979
lambda[   6] =  -0.33083968594941
lambda[   7] =  -0.20709196747694
lambda[   8] =  -0.03711139446358
lambda[   9] =  -0.00156786190891
lambda[  10] =   0.01405847445991
lambda[  11] =   0.02010789014011
lambda[  12] =   0.02714068662152
lambda[  13] =   0.04303806240703
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 3.034 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.041 ms

Total time for subspace rotation: 3.042 ms
rank = 0, Efermi =  -0.066257128328 calculate fermi energy took 0.674 ms
rank = 0, --- Calculate rho: sum over local bands took 1.456 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1115.634 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
rank = 0, D2D took 0.463 ms
rank = 0, Transfering density took 0.473 ms
Etot    =   -19.380925641676
Eband   =    -6.320748135130
E1      =    14.664010736962
E2      =    -5.432294854712
E3      =    -8.039501107912
Exc     =    -7.005954847407
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 5.471e-05, dEband = 6.041e-03
rank = 0, Calculating/Estimating energy took 1.003 ms, Etot = -19.380925642, dEtot = 5.471e-05, dEband = 6.041e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6118082356996, which took 0.073 ms

iter_count = 114, r_2norm = 1.667e-05, tol*||rhs|| = 2.447e-05

Anderson update took 60.579 ms, out of which F'*F took 28.321 ms; b-Ax took 193.836 ms, out of which Lap took 172.278 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.580 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046376, int_b + int_rho = -5.093e-14, checking this took 0.109 ms
2-norm of RHS = 618.7541069735097, which took 0.098 ms

iter_count = 252, r_2norm = 5.614e-04, tol*||rhs|| = 6.188e-04

Anderson update took 133.878 ms, out of which F'*F took 62.447 ms; b-Ax took 426.024 ms, out of which Lap took 379.486 ms
Solving Poisson took 901.249 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Total time for convolution: 	 convolve: 5.224923 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.200799 
Total time for convolution: 	 convolve: 5.203012 
Total time for convolution: 	 convolve: 5.212515 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.619 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.326 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.342 ms

This SCF took 27300.613 ms, scf error = 8.108e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.143038, lowerbound = -0.807529, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1090.952 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.723 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 2.753 ms
rank =  0, finding HY took 18.219 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.335 ms
Rank 0, Project_Hamiltonian used 23.330 ms
Total time for projection: 23.341 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.017 ms
rank = 0, Solve_Generalized_EigenProblem used 0.086 ms
    first calculated eigval = -0.802585582497961
    last  calculated eigval = 0.037164155316694
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.80258558249796
lambda[   2] =  -0.59945695669826
lambda[   3] =  -0.44193764166492
lambda[   4] =  -0.39674653412066
lambda[   5] =  -0.36000194940771
lambda[   6] =  -0.32691654904833
lambda[   7] =  -0.20229954272127
lambda[   8] =  -0.03689256905848
lambda[   9] =  -0.00120738590716
lambda[  10] =   0.01185194193094
lambda[  11] =   0.01735652914091
lambda[  12] =   0.02504709486863
lambda[  13] =   0.03716415531669
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 2.785 ms
rank =  0, Distributing orbital back into band + domain format took 0.005 ms
rank = 0, Subspace_Rotation used 2.798 ms

Total time for subspace rotation: 2.799 ms
rank = 0, Efermi =  -0.066038302871 calculate fermi energy took 0.101 ms
rank = 0, --- Calculate rho: sum over local bands took 1.462 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1119.838 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
rank = 0, D2D took 0.496 ms
rank = 0, Transfering density took 0.504 ms
Etot    =   -19.380600096711
Eband   =    -6.259889513073
E1      =    14.635964584580
E2      =    -5.395640318340
E3      =    -8.052924152238
Exc     =    -7.015210280071
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 4.651e-05, dEband = 8.694e-03
rank = 0, Calculating/Estimating energy took 0.968 ms, Etot = -19.380600097, dEtot = 4.651e-05, dEband = 8.694e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3117891367174, which took 0.062 ms

iter_count = 114, r_2norm = 7.728e-06, tol*||rhs|| = 1.247e-05

Anderson update took 60.140 ms, out of which F'*F took 28.290 ms; b-Ax took 194.017 ms, out of which Lap took 172.213 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.309 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046378, int_b + int_rho = -2.910e-14, checking this took 0.085 ms
2-norm of RHS = 618.9014427249284, which took 0.141 ms

iter_count = 246, r_2norm = 5.853e-04, tol*||rhs|| = 6.189e-04

Anderson update took 131.146 ms, out of which F'*F took 60.570 ms; b-Ax took 414.015 ms, out of which Lap took 369.232 ms
Solving Poisson took 880.800 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.188314 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.193893 
Total time for convolution: 	 convolve: 5.172245 
Total time for convolution: 	 convolve: 5.185936 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.751 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.334 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.351 ms

This SCF took 27162.397 ms, scf error = 4.018e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.137164, lowerbound = -0.802586, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1086.998 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.717 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.035 ms
rank =  0, Distribute data + matrix mult took 2.756 ms
rank =  0, finding HY took 18.168 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 2.321 ms
Rank 0, Project_Hamiltonian used 23.269 ms
Total time for projection: 23.315 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.036 ms
rank = 0, Solve_Generalized_EigenProblem used 0.461 ms
    first calculated eigval = -0.798295680051326
    last  calculated eigval = 0.033904404198134
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79829568005133
lambda[   2] =  -0.59459226371748
lambda[   3] =  -0.43804657275469
lambda[   4] =  -0.39207803379079
lambda[   5] =  -0.35521771319188
lambda[   6] =  -0.32243195953214
lambda[   7] =  -0.19807762872391
lambda[   8] =  -0.03546966694341
lambda[   9] =   0.00099040274564
lambda[  10] =   0.01180660564004
lambda[  11] =   0.01776969573199
lambda[  12] =   0.02486988759313
lambda[  13] =   0.03390440419813
==subpsace eigenproblem: bcast eigvals took 0.515 ms
Total time for solving subspace eigenvalue problem: 0.983 ms
rank =  0, subspace rotation using ScaLAPACK took 3.072 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.077 ms

Total time for subspace rotation: 3.077 ms
rank = 0, Efermi =  -0.064615400784 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.478 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1115.980 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.246 ms
rank = 0, D2D took 0.397 ms
rank = 0, Transfering density took 0.400 ms
Etot    =   -19.380508161572
Eband   =    -6.197479704250
E1      =    14.603765427839
E2      =    -5.362422851320
E3      =    -8.063877042565
Exc     =    -7.023064420321
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 1.313e-05, dEband = 8.916e-03
rank = 0, Calculating/Estimating energy took 1.099 ms, Etot = -19.380508162, dEtot = 1.313e-05, dEband = 8.916e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2196116830739, which took 0.076 ms

iter_count = 114, r_2norm = 6.448e-06, tol*||rhs|| = 8.784e-06

Anderson update took 60.350 ms, out of which F'*F took 28.097 ms; b-Ax took 196.730 ms, out of which Lap took 175.155 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.362 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046376, int_b + int_rho = -5.275e-14, checking this took 0.100 ms
2-norm of RHS = 618.9464489643883, which took 0.163 ms

iter_count = 210, r_2norm = 5.644e-04, tol*||rhs|| = 6.189e-04

Anderson update took 111.505 ms, out of which F'*F took 52.039 ms; b-Ax took 354.941 ms, out of which Lap took 316.009 ms
Solving Poisson took 751.266 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.193525 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.189994 
Total time for convolution: 	 convolve: 5.190562 
Total time for convolution: 	 convolve: 5.211046 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.526 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 0.345 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.003 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.365 ms

This SCF took 27231.185 ms, scf error = 2.012e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.133904, lowerbound = -0.798296, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1088.477 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.722 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 2.750 ms
rank =  0, finding HY took 35.629 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.511 ms
Rank 0, Project_Hamiltonian used 41.354 ms
Total time for projection: 41.406 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.110 ms
    first calculated eigval = -0.798169631999308
    last  calculated eigval = 0.031585888837537
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79816963199931
lambda[   2] =  -0.59444099102668
lambda[   3] =  -0.43782366385793
lambda[   4] =  -0.39192899597762
lambda[   5] =  -0.35503540545374
lambda[   6] =  -0.32219403371998
lambda[   7] =  -0.19787255178949
lambda[   8] =  -0.03470576328337
lambda[   9] =   0.00198106484136
lambda[  10] =   0.01167044708741
lambda[  11] =   0.01817236298872
lambda[  12] =   0.02467791073283
lambda[  13] =   0.03158588883754
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.126 ms
rank =  0, subspace rotation using ScaLAPACK took 3.091 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.096 ms

Total time for subspace rotation: 3.097 ms
rank = 0, Efermi =  -0.063851497157 calculate fermi energy took 0.099 ms
rank = 0, --- Calculate rho: sum over local bands took 1.507 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1134.807 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
rank = 0, D2D took 0.497 ms
rank = 0, Transfering density took 0.505 ms
Etot    =   -19.380554444467
Eband   =    -6.194930548360
E1      =    14.605585136438
E2      =    -5.358302063872
E3      =    -8.062183470302
Exc     =    -7.021665207994
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 6.612e-06, dEband = 3.642e-04
rank = 0, Calculating/Estimating energy took 0.979 ms, Etot = -19.380554444, dEtot = 6.612e-06, dEband = 3.642e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1005730788095, which took 0.071 ms

iter_count = 114, r_2norm = 3.340e-06, tol*||rhs|| = 4.023e-06

Anderson update took 60.102 ms, out of which F'*F took 28.266 ms; b-Ax took 194.974 ms, out of which Lap took 173.594 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.764 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046378, int_b + int_rho = -3.638e-14, checking this took 0.109 ms
2-norm of RHS = 618.9073241173060, which took 0.138 ms

iter_count = 228, r_2norm = 4.995e-04, tol*||rhs|| = 6.189e-04

Anderson update took 121.182 ms, out of which F'*F took 56.098 ms; b-Ax took 383.934 ms, out of which Lap took 342.546 ms
Solving Poisson took 816.147 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.189321 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.201142 
Total time for convolution: 	 convolve: 5.197210 
Total time for convolution: 	 convolve: 5.211417 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.520 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.311 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.328 ms

This SCF took 27367.084 ms, scf error = 1.562e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.131586, lowerbound = -0.798170, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1086.821 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.210 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.034 ms
rank =  0, Distribute data + matrix mult took 3.668 ms
rank =  0, finding HY took 18.112 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.315 ms
Rank 0, Project_Hamiltonian used 24.118 ms
Total time for projection: 24.130 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.113 ms
    first calculated eigval = -0.796320420570453
    last  calculated eigval = 0.031556688454756
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79632042057045
lambda[   2] =  -0.59224149532781
lambda[   3] =  -0.43596366096839
lambda[   4] =  -0.38990540504517
lambda[   5] =  -0.35292542619742
lambda[   6] =  -0.32008337719741
lambda[   7] =  -0.19586115976784
lambda[   8] =  -0.03150048110722
lambda[   9] =   0.00617129925833
lambda[  10] =   0.01574836598935
lambda[  11] =   0.02060490857566
lambda[  12] =   0.02611889465509
lambda[  13] =   0.03155668845476
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.127 ms
rank =  0, subspace rotation using ScaLAPACK took 3.029 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.036 ms

Total time for subspace rotation: 3.037 ms
rank = 0, Efermi =  -0.060646214873 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.502 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1115.747 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.261 ms
rank = 0, D2D took 0.448 ms
rank = 0, Transfering density took 0.456 ms
Etot    =   -19.380554041779
Eband   =    -6.166601890794
E1      =    14.590258172255
E2      =    -5.344473497990
E3      =    -8.066034206342
Exc     =    -7.024688668848
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 5.753e-08, dEband = 4.047e-03
rank = 0, Calculating/Estimating energy took 1.007 ms, Etot = -19.380554042, dEtot = 5.753e-08, dEband = 4.047e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0935675581946, which took 0.061 ms

iter_count = 108, r_2norm = 3.523e-06, tol*||rhs|| = 3.743e-06

Anderson update took 57.176 ms, out of which F'*F took 26.809 ms; b-Ax took 183.584 ms, out of which Lap took 163.119 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.069 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046376, int_b + int_rho = -5.093e-14, checking this took 0.126 ms
2-norm of RHS = 618.9075056720508, which took 0.129 ms

iter_count = 204, r_2norm = 5.919e-04, tol*||rhs|| = 6.189e-04

Anderson update took 108.413 ms, out of which F'*F took 50.528 ms; b-Ax took 345.852 ms, out of which Lap took 308.313 ms
Solving Poisson took 730.049 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.099 ms
Total time for convolution: 	 convolve: 5.184201 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.473 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.194280 
Total time for convolution: 	 convolve: 5.212141 
Total time for convolution: 	 convolve: 5.157152 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.159 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.329 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.347 ms

This SCF took 27016.819 ms, scf error = 8.153e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.131557, lowerbound = -0.796320, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1088.052 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.723 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.034 ms
rank =  0, Distribute data + matrix mult took 2.762 ms
rank =  0, finding HY took 18.265 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.342 ms
Rank 0, Project_Hamiltonian used 23.392 ms
Total time for projection: 23.407 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.113 ms
    first calculated eigval = -0.795293499794732
    last  calculated eigval = 0.032349275128780
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79529349979473
lambda[   2] =  -0.59127678835939
lambda[   3] =  -0.43501584034855
lambda[   4] =  -0.38891321684128
lambda[   5] =  -0.35193150720584
lambda[   6] =  -0.31911293104538
lambda[   7] =  -0.19490415277029
lambda[   8] =  -0.02857532018551
lambda[   9] =   0.00881850457987
lambda[  10] =   0.01957489701421
lambda[  11] =   0.02248946877061
lambda[  12] =   0.02653567257243
lambda[  13] =   0.03234927512878
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.128 ms
rank =  0, subspace rotation using ScaLAPACK took 3.051 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.057 ms

Total time for subspace rotation: 3.058 ms
rank = 0, Efermi =  -0.057721053987 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.508 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1116.589 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
rank = 0, D2D took 0.441 ms
rank = 0, Transfering density took 0.448 ms
Etot    =   -19.380629867236
Eband   =    -6.152895873316
E1      =    14.583373352873
E2      =    -5.337396559829
E3      =    -8.067143186494
Exc     =    -7.025617734393
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 1.083e-05, dEband = 1.958e-03
rank = 0, Calculating/Estimating energy took 1.045 ms, Etot = -19.380629867, dEtot = 1.083e-05, dEband = 1.958e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0813705684656, which took 0.135 ms

iter_count = 108, r_2norm = 2.561e-06, tol*||rhs|| = 3.255e-06

Anderson update took 57.114 ms, out of which F'*F took 26.805 ms; b-Ax took 183.650 ms, out of which Lap took 163.199 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.499 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046376, int_b + int_rho = -5.639e-14, checking this took 0.113 ms
2-norm of RHS = 618.9110470438910, which took 0.149 ms

iter_count = 180, r_2norm = 5.341e-04, tol*||rhs|| = 6.189e-04

Anderson update took 95.962 ms, out of which F'*F took 44.404 ms; b-Ax took 306.476 ms, out of which Lap took 273.697 ms
Solving Poisson took 648.834 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.668 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Total time for convolution: 	 convolve: 5.185685 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.556 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.201628 
Total time for convolution: 	 convolve: 5.198425 
Total time for convolution: 	 convolve: 5.176254 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.781 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.340 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.681 ms

This SCF took 27466.865 ms, scf error = 5.459e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.132349, lowerbound = -0.795293, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1086.285 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.932 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 2.961 ms
rank =  0, finding HY took 18.161 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.329 ms
Rank 0, Project_Hamiltonian used 23.475 ms
Total time for projection: 23.487 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.018 ms
rank = 0, Solve_Generalized_EigenProblem used 0.087 ms
    first calculated eigval = -0.795007311530141
    last  calculated eigval = 0.033136375111073
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79500731153014
lambda[   2] =  -0.59091564818220
lambda[   3] =  -0.43471037766284
lambda[   4] =  -0.38858318121685
lambda[   5] =  -0.35157201682305
lambda[   6] =  -0.31873683445943
lambda[   7] =  -0.19466987423906
lambda[   8] =  -0.02661657849140
lambda[   9] =   0.00964802390232
lambda[  10] =   0.02186345982717
lambda[  11] =   0.02315087538820
lambda[  12] =   0.02758870401770
lambda[  13] =   0.03313637511107
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.130 ms
rank =  0, subspace rotation using ScaLAPACK took 3.048 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.053 ms

Total time for subspace rotation: 3.054 ms
rank = 0, Efermi =  -0.055762312335 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.471 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1114.558 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
rank = 0, D2D took 0.437 ms
rank = 0, Transfering density took 0.445 ms
Etot    =   -19.380682134240
Eband   =    -6.148390488772
E1      =    14.581278873999
E2      =    -5.334905184151
E3      =    -8.067466356635
Exc     =    -7.025912701529
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 7.467e-06, dEband = 6.436e-04
rank = 0, Calculating/Estimating energy took 1.058 ms, Etot = -19.380682134, dEtot = 7.467e-06, dEband = 6.436e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0444520174281, which took 0.052 ms

iter_count = 108, r_2norm = 1.744e-06, tol*||rhs|| = 1.778e-06

Anderson update took 56.854 ms, out of which F'*F took 26.897 ms; b-Ax took 184.065 ms, out of which Lap took 163.648 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.653 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046376, int_b + int_rho = -5.639e-14, checking this took 0.099 ms
2-norm of RHS = 618.9142221795620, which took 0.116 ms

iter_count = 174, r_2norm = 5.450e-04, tol*||rhs|| = 6.189e-04

Anderson update took 92.568 ms, out of which F'*F took 43.043 ms; b-Ax took 294.361 ms, out of which Lap took 262.231 ms
Solving Poisson took 624.503 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.253 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.190599 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.192459 
Total time for convolution: 	 convolve: 5.217811 
Total time for convolution: 	 convolve: 5.197700 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.778 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.041 ms
---Transfer Veff_loc: D2D took 1.143 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.163 ms

This SCF took 26940.367 ms, scf error = 4.205e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.133136, lowerbound = -0.795007, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1088.350 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.724 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.102 ms
rank =  0, Distribute data + matrix mult took 2.829 ms
rank =  0, finding HY took 18.212 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.351 ms
Rank 0, Project_Hamiltonian used 23.414 ms
Total time for projection: 23.431 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.118 ms
    first calculated eigval = -0.794527189166342
    last  calculated eigval = 0.033825761585298
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79452718916634
lambda[   2] =  -0.59042432652002
lambda[   3] =  -0.43424899649526
lambda[   4] =  -0.38811305227389
lambda[   5] =  -0.35110164863485
lambda[   6] =  -0.31827249768939
lambda[   7] =  -0.19419735633450
lambda[   8] =  -0.02535333890067
lambda[   9] =   0.00991317636330
lambda[  10] =   0.02237481449470
lambda[  11] =   0.02285345181663
lambda[  12] =   0.02929848032234
lambda[  13] =   0.03382576158530
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.134 ms
rank =  0, subspace rotation using ScaLAPACK took 3.042 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.050 ms

Total time for subspace rotation: 3.051 ms
rank = 0, Efermi =  -0.054499072730 calculate fermi energy took 0.088 ms
rank = 0, --- Calculate rho: sum over local bands took 1.486 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1116.621 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
rank = 0, D2D took 0.440 ms
rank = 0, Transfering density took 0.444 ms
Etot    =   -19.380757545750
Eband   =    -6.141770134747
E1      =    14.577652200949
E2      =    -5.331677872414
E3      =    -8.068267251913
Exc     =    -7.026555377555
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 1.077e-05, dEband = 9.458e-04
rank = 0, Calculating/Estimating energy took 1.032 ms, Etot = -19.380757546, dEtot = 1.077e-05, dEband = 9.458e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0391603766611, which took 0.056 ms

iter_count = 108, r_2norm = 1.383e-06, tol*||rhs|| = 1.566e-06

Anderson update took 57.002 ms, out of which F'*F took 26.923 ms; b-Ax took 184.293 ms, out of which Lap took 163.872 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.850 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046372, int_b + int_rho = -8.731e-14, checking this took 0.081 ms
2-norm of RHS = 618.9229563792280, which took 0.084 ms

iter_count = 156, r_2norm = 5.553e-04, tol*||rhs|| = 6.189e-04

Anderson update took 83.069 ms, out of which F'*F took 38.301 ms; b-Ax took 263.305 ms, out of which Lap took 235.202 ms
Solving Poisson took 559.466 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.176398 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 14.620 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.186705 
Total time for convolution: 	 convolve: 5.217519 
Total time for convolution: 	 convolve: 5.184103 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.518 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.318 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.335 ms

This SCF took 26872.546 ms, scf error = 2.462e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.133826, lowerbound = -0.794527, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1086.969 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.725 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.059 ms
rank =  0, Distribute data + matrix mult took 2.789 ms
rank =  0, finding HY took 18.198 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.303 ms
Rank 0, Project_Hamiltonian used 23.312 ms
Total time for projection: 23.336 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.116 ms
    first calculated eigval = -0.794571999122786
    last  calculated eigval = 0.035514425955138
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79457199912279
lambda[   2] =  -0.59044457847637
lambda[   3] =  -0.43426099536217
lambda[   4] =  -0.38814364065464
lambda[   5] =  -0.35112153126225
lambda[   6] =  -0.31827440275490
lambda[   7] =  -0.19423166958878
lambda[   8] =  -0.02410080509558
lambda[   9] =   0.01051649977582
lambda[  10] =   0.02238427876233
lambda[  11] =   0.02374808186613
lambda[  12] =   0.03082334084428
lambda[  13] =   0.03551442595514
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.139 ms
rank =  0, subspace rotation using ScaLAPACK took 3.052 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.058 ms

Total time for subspace rotation: 3.058 ms
rank = 0, Efermi =  -0.053246538936 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 1.482 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1115.127 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
rank = 0, D2D took 0.434 ms
rank = 0, Transfering density took 0.441 ms
Etot    =   -19.380777197439
Eband   =    -6.142097634937
E1      =    14.578354499707
E2      =    -5.331387827794
E3      =    -8.067832155294
Exc     =    -7.026224686572
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 2.807e-06, dEband = 4.679e-05
rank = 0, Calculating/Estimating energy took 1.050 ms, Etot = -19.380777197, dEtot = 2.807e-06, dEband = 4.679e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0384886941694, which took 0.070 ms

iter_count = 108, r_2norm = 1.353e-06, tol*||rhs|| = 1.540e-06

Anderson update took 57.134 ms, out of which F'*F took 26.657 ms; b-Ax took 184.520 ms, out of which Lap took 163.147 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.788 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046379, int_b + int_rho = -2.547e-14, checking this took 0.104 ms
2-norm of RHS = 618.9225354792137, which took 0.137 ms

iter_count = 30, r_2norm = 5.720e-04, tol*||rhs|| = 6.189e-04

Anderson update took 15.985 ms, out of which F'*F took 7.518 ms; b-Ax took 50.748 ms, out of which Lap took 45.255 ms
Solving Poisson took 110.233 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.178375 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.270 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.178336 
Total time for convolution: 	 convolve: 5.227815 
Total time for convolution: 	 convolve: 5.180762 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.526 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.309 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.327 ms

This SCF took 26410.993 ms, scf error = 2.905e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135514, lowerbound = -0.794572, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1089.068 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.717 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.062 ms
rank =  0, Distribute data + matrix mult took 2.783 ms
rank =  0, finding HY took 18.314 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.314 ms
Rank 0, Project_Hamiltonian used 23.432 ms
Total time for projection: 23.447 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.794575499441430
    last  calculated eigval = 0.035229014801927
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79457549944143
lambda[   2] =  -0.59044801520869
lambda[   3] =  -0.43426477370844
lambda[   4] =  -0.38814674621792
lambda[   5] =  -0.35112476028464
lambda[   6] =  -0.31827811960394
lambda[   7] =  -0.19423531761669
lambda[   8] =  -0.02411943025208
lambda[   9] =   0.01047126913335
lambda[  10] =   0.02221052315891
lambda[  11] =   0.02369148462971
lambda[  12] =   0.03062190961698
lambda[  13] =   0.03522901480193
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 3.040 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.045 ms

Total time for subspace rotation: 3.046 ms
rank = 0, Efermi =  -0.053265164078 calculate fermi energy took 0.098 ms
rank = 0, --- Calculate rho: sum over local bands took 1.491 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1117.389 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
rank = 0, D2D took 0.446 ms
rank = 0, Transfering density took 0.450 ms
Etot    =   -19.380779888250
Eband   =    -6.142146464657
E1      =    14.578374819150
E2      =    -5.331423210937
E3      =    -8.067798700861
Exc     =    -7.026200795817
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 3.844e-07, dEband = 6.976e-06
rank = 0, Calculating/Estimating energy took 1.868 ms, Etot = -19.380779888, dEtot = 3.844e-07, dEband = 6.976e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0394313174968, which took 0.066 ms

iter_count = 108, r_2norm = 1.360e-06, tol*||rhs|| = 1.577e-06

Anderson update took 57.096 ms, out of which F'*F took 26.783 ms; b-Ax took 184.068 ms, out of which Lap took 163.518 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.035 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046377, int_b + int_rho = -4.547e-14, checking this took 0.110 ms
2-norm of RHS = 618.9226821824720, which took 0.127 ms

iter_count = 66, r_2norm = 6.025e-04, tol*||rhs|| = 6.189e-04

Anderson update took 34.957 ms, out of which F'*F took 16.258 ms; b-Ax took 111.143 ms, out of which Lap took 99.060 ms
Solving Poisson took 238.430 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.177799 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.342 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.191471 
Total time for convolution: 	 convolve: 5.182810 
Total time for convolution: 	 convolve: 5.227797 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.175 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.314 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.331 ms

This SCF took 26547.833 ms, scf error = 2.844e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.135229, lowerbound = -0.794575, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1086.933 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.708 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 2.740 ms
rank =  0, finding HY took 18.169 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.352 ms
Rank 0, Project_Hamiltonian used 23.280 ms
Total time for projection: 23.299 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.794545184302748
    last  calculated eigval = 0.035207160910038
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79454518430275
lambda[   2] =  -0.59042053150760
lambda[   3] =  -0.43423885297309
lambda[   4] =  -0.38811850104339
lambda[   5] =  -0.35109754824346
lambda[   6] =  -0.31825304858877
lambda[   7] =  -0.19420738860612
lambda[   8] =  -0.02405474882101
lambda[   9] =   0.01047856029379
lambda[  10] =   0.02209587481322
lambda[  11] =   0.02371630457698
lambda[  12] =   0.03053343715223
lambda[  13] =   0.03520716091004
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.023 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.028 ms

Total time for subspace rotation: 3.029 ms
rank = 0, Efermi =  -0.053200482645 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 1.514 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1115.038 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
rank = 0, D2D took 1.922 ms
rank = 0, Transfering density took 1.928 ms
Etot    =   -19.380776138479
Eband   =    -6.141762111023
E1      =    14.578142901540
E2      =    -5.331249150881
E3      =    -8.067902962095
Exc     =    -7.026279683248
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 5.357e-07, dEband = 5.491e-05
rank = 0, Calculating/Estimating energy took 0.900 ms, Etot = -19.380776138, dEtot = 5.357e-07, dEband = 5.491e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0396530402180, which took 0.089 ms

iter_count = 108, r_2norm = 1.306e-06, tol*||rhs|| = 1.586e-06

Anderson update took 57.029 ms, out of which F'*F took 26.887 ms; b-Ax took 183.681 ms, out of which Lap took 163.422 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.756 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046373, int_b + int_rho = -8.004e-14, checking this took 0.102 ms
2-norm of RHS = 618.9219410694215, which took 0.122 ms

iter_count = 138, r_2norm = 5.614e-04, tol*||rhs|| = 6.189e-04

Anderson update took 73.308 ms, out of which F'*F took 34.174 ms; b-Ax took 233.431 ms, out of which Lap took 207.912 ms
Solving Poisson took 494.839 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.187880 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.199451 
Total time for convolution: 	 convolve: 5.215082 
Total time for convolution: 	 convolve: 5.198199 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.787 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 0.337 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.357 ms

This SCF took 26933.312 ms, scf error = 2.682e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.135207, lowerbound = -0.794545, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1089.348 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.724 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.041 ms
rank =  0, Distribute data + matrix mult took 2.769 ms
rank =  0, finding HY took 18.152 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.321 ms
Rank 0, Project_Hamiltonian used 23.265 ms
Total time for projection: 23.284 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.100 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -0.794297918199308
    last  calculated eigval = 0.036010504443338
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79429791819931
lambda[   2] =  -0.59019260037563
lambda[   3] =  -0.43401718315387
lambda[   4] =  -0.38788632110513
lambda[   5] =  -0.35087167078027
lambda[   6] =  -0.31803907893176
lambda[   7] =  -0.19398000105582
lambda[   8] =  -0.02386604651009
lambda[   9] =   0.01030085220711
lambda[  10] =   0.02216926971064
lambda[  11] =   0.02362806221760
lambda[  12] =   0.03067643642350
lambda[  13] =   0.03601050444334
==subpsace eigenproblem: bcast eigvals took 0.061 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 3.049 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.054 ms

Total time for subspace rotation: 3.055 ms
rank = 0, Efermi =  -0.053011780346 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 1.554 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1117.568 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.857 ms
rank = 0, D2D took 0.985 ms
rank = 0, Transfering density took 0.991 ms
Etot    =   -19.380790740314
Eband   =    -6.138569547692
E1      =    14.576321397525
E2      =    -5.329747459763
E3      =    -8.068386084163
Exc     =    -7.026646775348
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 2.086e-06, dEband = 4.561e-04
rank = 0, Calculating/Estimating energy took 0.887 ms, Etot = -19.380790740, dEtot = 2.086e-06, dEband = 4.561e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0267016389807, which took 0.061 ms

iter_count = 108, r_2norm = 6.933e-07, tol*||rhs|| = 1.068e-06

Anderson update took 57.087 ms, out of which F'*F took 26.735 ms; b-Ax took 183.688 ms, out of which Lap took 163.308 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.855 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046378, int_b + int_rho = -3.456e-14, checking this took 0.135 ms
2-norm of RHS = 618.9223222453381, which took 0.092 ms

iter_count = 156, r_2norm = 5.658e-04, tol*||rhs|| = 6.189e-04

Anderson update took 82.910 ms, out of which F'*F took 38.689 ms; b-Ax took 264.027 ms, out of which Lap took 234.617 ms
Solving Poisson took 560.279 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.222001 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.187204 
Total time for convolution: 	 convolve: 5.200456 
Total time for convolution: 	 convolve: 5.174723 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.752 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.429 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.335 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.355 ms

This SCF took 26878.359 ms, scf error = 1.895e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.136011, lowerbound = -0.794298, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1087.228 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.738 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.056 ms
rank =  0, Distribute data + matrix mult took 2.798 ms
rank =  0, finding HY took 18.504 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.337 ms
Rank 0, Project_Hamiltonian used 23.706 ms
Total time for projection: 23.740 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.109 ms
    first calculated eigval = -0.794203742231510
    last  calculated eigval = 0.037807222118533
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79420374223151
lambda[   2] =  -0.59010910732195
lambda[   3] =  -0.43390697175465
lambda[   4] =  -0.38780495509064
lambda[   5] =  -0.35079123239524
lambda[   6] =  -0.31794661287961
lambda[   7] =  -0.19391236773601
lambda[   8] =  -0.02405144817181
lambda[   9] =   0.00990443895184
lambda[  10] =   0.02285053675272
lambda[  11] =   0.02313717820286
lambda[  12] =   0.03113173780235
lambda[  13] =   0.03780722211853
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.134 ms
rank =  0, subspace rotation using ScaLAPACK took 3.058 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.064 ms

Total time for subspace rotation: 3.065 ms
rank = 0, Efermi =  -0.053197182017 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.081 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1116.895 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
rank = 0, D2D took 0.336 ms
rank = 0, Transfering density took 0.340 ms
Etot    =   -19.380817207231
Eband   =    -6.137349979311
E1      =    14.575946175788
E2      =    -5.328900250920
E3      =    -8.068247799032
Exc     =    -7.026532094936
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 3.781e-06, dEband = 1.742e-04
rank = 0, Calculating/Estimating energy took 0.892 ms, Etot = -19.380817207, dEtot = 3.781e-06, dEband = 1.742e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0240360948686, which took 0.072 ms

iter_count = 108, r_2norm = 6.304e-07, tol*||rhs|| = 9.614e-07

Anderson update took 56.904 ms, out of which F'*F took 26.803 ms; b-Ax took 183.643 ms, out of which Lap took 163.023 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.707 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046379, int_b + int_rho = -2.183e-14, checking this took 0.111 ms
2-norm of RHS = 618.9208457526438, which took 0.137 ms

iter_count = 114, r_2norm = 5.978e-04, tol*||rhs|| = 6.189e-04

Anderson update took 60.067 ms, out of which F'*F took 31.712 ms; b-Ax took 196.123 ms, out of which Lap took 175.030 ms
Solving Poisson took 411.694 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.195564 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.419 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.262561 
Total time for convolution: 	 convolve: 5.160451 
Total time for convolution: 	 convolve: 5.151278 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.567 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.312 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.329 ms

This SCF took 26709.710 ms, scf error = 1.959e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.137807, lowerbound = -0.794204, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1089.064 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.729 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 2.755 ms
rank =  0, finding HY took 18.227 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.307 ms
Rank 0, Project_Hamiltonian used 23.309 ms
Total time for projection: 23.375 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.106 ms
    first calculated eigval = -0.794082955444500
    last  calculated eigval = 0.038955067617575
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79408295544450
lambda[   2] =  -0.58999492170627
lambda[   3] =  -0.43379433322987
lambda[   4] =  -0.38769094700691
lambda[   5] =  -0.35068071896598
lambda[   6] =  -0.31783985085425
lambda[   7] =  -0.19380229120121
lambda[   8] =  -0.02353311516062
lambda[   9] =   0.01019961454260
lambda[  10] =   0.02334656286705
lambda[  11] =   0.02398630871979
lambda[  12] =   0.03198864948463
lambda[  13] =   0.03895506761758
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.134 ms
rank =  0, subspace rotation using ScaLAPACK took 3.062 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.070 ms

Total time for subspace rotation: 3.071 ms
rank = 0, Efermi =  -0.052678849020 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.453 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1117.711 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
rank = 0, D2D took 0.420 ms
rank = 0, Transfering density took 0.427 ms
Etot    =   -19.380818593954
Eband   =    -6.135772037300
E1      =    14.575026463612
E2      =    -5.328184192221
E3      =    -8.068481248077
Exc     =    -7.026709101839
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 1.981e-07, dEband = 2.254e-04
rank = 0, Calculating/Estimating energy took 1.075 ms, Etot = -19.380818594, dEtot = 1.981e-07, dEband = 2.254e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0205763307909, which took 0.067 ms

iter_count = 108, r_2norm = 6.033e-07, tol*||rhs|| = 8.231e-07

Anderson update took 56.898 ms, out of which F'*F took 26.761 ms; b-Ax took 183.506 ms, out of which Lap took 162.829 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.082 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046375, int_b + int_rho = -6.185e-14, checking this took 0.111 ms
2-norm of RHS = 618.9215636472161, which took 0.126 ms

iter_count = 90, r_2norm = 5.813e-04, tol*||rhs|| = 6.189e-04

Anderson update took 47.671 ms, out of which F'*F took 22.115 ms; b-Ax took 151.561 ms, out of which Lap took 134.972 ms
Solving Poisson took 324.303 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.173370 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 29.773 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.252244 
Total time for convolution: 	 convolve: 5.227131 
Total time for convolution: 	 convolve: 5.174577 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.369 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.330 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.349 ms

This SCF took 26688.612 ms, scf error = 1.311e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.138955, lowerbound = -0.794083, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1087.731 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.718 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.082 ms
rank =  0, Distribute data + matrix mult took 2.804 ms
rank =  0, finding HY took 18.474 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.383 ms
Rank 0, Project_Hamiltonian used 23.688 ms
Total time for projection: 23.713 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.111 ms
    first calculated eigval = -0.794027348009493
    last  calculated eigval = 0.039745025523589
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79402734800949
lambda[   2] =  -0.58994036003154
lambda[   3] =  -0.43374174046489
lambda[   4] =  -0.38763722054387
lambda[   5] =  -0.35062713148282
lambda[   6] =  -0.31778756099044
lambda[   7] =  -0.19375180506964
lambda[   8] =  -0.02337152020352
lambda[   9] =   0.01026160739286
lambda[  10] =   0.02331095786229
lambda[  11] =   0.02461546149300
lambda[  12] =   0.03242962158678
lambda[  13] =   0.03974502552359
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.135 ms
rank =  0, subspace rotation using ScaLAPACK took 3.056 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.062 ms

Total time for subspace rotation: 3.063 ms
rank = 0, Efermi =  -0.052517254073 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 1.475 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1116.801 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
rank = 0, D2D took 0.427 ms
rank = 0, Transfering density took 0.434 ms
Etot    =   -19.380823577954
Eband   =    -6.135026333664
E1      =    14.574635882898
E2      =    -5.327803128663
E3      =    -8.068566898141
Exc     =    -7.026773795268
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 7.120e-07, dEband = 1.065e-04
rank = 0, Calculating/Estimating energy took 1.065 ms, Etot = -19.380823578, dEtot = 7.120e-07, dEband = 1.065e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0143010132437, which took 0.066 ms

iter_count = 108, r_2norm = 4.986e-07, tol*||rhs|| = 5.720e-07

Anderson update took 56.845 ms, out of which F'*F took 26.866 ms; b-Ax took 183.398 ms, out of which Lap took 162.986 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.173 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046374, int_b + int_rho = -7.276e-14, checking this took 0.117 ms
2-norm of RHS = 618.9240833393160, which took 0.140 ms

iter_count = 126, r_2norm = 5.649e-04, tol*||rhs|| = 6.189e-04

Anderson update took 66.869 ms, out of which F'*F took 31.074 ms; b-Ax took 212.720 ms, out of which Lap took 189.429 ms
Solving Poisson took 452.154 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.205998 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.175756 
Total time for convolution: 	 convolve: 5.182362 
Total time for convolution: 	 convolve: 5.170040 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.604 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.324 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.343 ms

This SCF took 26714.379 ms, scf error = 1.131e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.139745, lowerbound = -0.794027, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1087.564 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.728 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 2.767 ms
rank =  0, finding HY took 18.123 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.318 ms
Rank 0, Project_Hamiltonian used 23.230 ms
Total time for projection: 23.245 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.108 ms
    first calculated eigval = -0.794045791335306
    last  calculated eigval = 0.039410913104401
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79404579133531
lambda[   2] =  -0.58995369144566
lambda[   3] =  -0.43375129754227
lambda[   4] =  -0.38765210280473
lambda[   5] =  -0.35064017835520
lambda[   6] =  -0.31779668163815
lambda[   7] =  -0.19377214310552
lambda[   8] =  -0.02420316757691
lambda[   9] =   0.00992924001355
lambda[  10] =   0.02222680451282
lambda[  11] =   0.02516284939289
lambda[  12] =   0.03199050690495
lambda[  13] =   0.03941091310440
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.120 ms
rank =  0, subspace rotation using ScaLAPACK took 3.063 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.070 ms

Total time for subspace rotation: 3.071 ms
rank = 0, Efermi =  -0.053348901406 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.472 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1116.160 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.262 ms
rank = 0, D2D took 0.424 ms
rank = 0, Transfering density took 0.432 ms
Etot    =   -19.380826960810
Eband   =    -6.135223772949
E1      =    14.574866702468
E2      =    -5.327797692899
E3      =    -8.068436723063
Exc     =    -7.026674947567
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 4.833e-07, dEband = 2.821e-05
rank = 0, Calculating/Estimating energy took 1.070 ms, Etot = -19.380826961, dEtot = 4.833e-07, dEband = 2.821e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0161771917051, which took 0.051 ms

iter_count = 108, r_2norm = 4.629e-07, tol*||rhs|| = 6.471e-07

Anderson update took 60.416 ms, out of which F'*F took 26.668 ms; b-Ax took 183.628 ms, out of which Lap took 162.933 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.677 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046380, int_b + int_rho = -1.091e-14, checking this took 0.121 ms
2-norm of RHS = 618.9248299126914, which took 0.093 ms

iter_count = 102, r_2norm = 5.512e-04, tol*||rhs|| = 6.189e-04

Anderson update took 54.102 ms, out of which F'*F took 25.277 ms; b-Ax took 172.500 ms, out of which Lap took 152.928 ms
Solving Poisson took 366.903 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.191010 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.190164 
Total time for convolution: 	 convolve: 5.204567 
Total time for convolution: 	 convolve: 5.209612 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.181 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.333 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.350 ms

This SCF took 26684.093 ms, scf error = 1.494e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.139411, lowerbound = -0.794046, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1087.653 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.015 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.714 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.071 ms
rank =  0, Distribute data + matrix mult took 2.789 ms
rank =  0, finding HY took 18.178 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.307 ms
Rank 0, Project_Hamiltonian used 23.306 ms
Total time for projection: 23.332 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.518 ms
    first calculated eigval = -0.794091955852197
    last  calculated eigval = 0.038799451137518
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79409195585220
lambda[   2] =  -0.58999180811822
lambda[   3] =  -0.43378881527395
lambda[   4] =  -0.38769194117604
lambda[   5] =  -0.35067862432120
lambda[   6] =  -0.31783189304077
lambda[   7] =  -0.19381538331400
lambda[   8] =  -0.02444775936739
lambda[   9] =   0.00983805750020
lambda[  10] =   0.02202641552032
lambda[  11] =   0.02553638688304
lambda[  12] =   0.03146907514149
lambda[  13] =   0.03879945113752
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.533 ms
rank =  0, subspace rotation using ScaLAPACK took 3.290 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.295 ms

Total time for subspace rotation: 3.296 ms
rank = 0, Efermi =  -0.053593493189 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.489 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1116.435 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
rank = 0, D2D took 0.426 ms
rank = 0, Transfering density took 0.434 ms
Etot    =   -19.380828106576
Eband   =    -6.135780842693
E1      =    14.575227084664
E2      =    -5.328027459002
E3      =    -8.068298711825
Exc     =    -7.026571160648
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 1.637e-07, dEband = 7.958e-05
rank = 0, Calculating/Estimating energy took 1.054 ms, Etot = -19.380828107, dEtot = 1.637e-07, dEband = 7.958e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0151454338706, which took 0.067 ms

iter_count = 108, r_2norm = 4.178e-07, tol*||rhs|| = 6.058e-07

Anderson update took 57.016 ms, out of which F'*F took 26.784 ms; b-Ax took 183.356 ms, out of which Lap took 162.804 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.313 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046373, int_b + int_rho = -8.367e-14, checking this took 0.129 ms
2-norm of RHS = 618.9241986039232, which took 0.094 ms

iter_count = 66, r_2norm = 5.390e-04, tol*||rhs|| = 6.189e-04

Anderson update took 34.972 ms, out of which F'*F took 16.467 ms; b-Ax took 111.528 ms, out of which Lap took 99.326 ms
Solving Poisson took 239.422 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.179339 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.575 ms
Total time for convolution: 	 convolve: 5.189927 
Total time for convolution: 	 convolve: 5.196930 
Total time for convolution: 	 convolve: 5.184262 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.315 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.332 ms

This SCF took 26546.777 ms, scf error = 1.906e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.138799, lowerbound = -0.794092, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1088.601 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.713 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.077 ms
rank =  0, Distribute data + matrix mult took 2.796 ms
rank =  0, finding HY took 18.247 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.523 ms
Rank 0, Project_Hamiltonian used 24.063 ms
Total time for projection: 24.127 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.028 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.794077559739210
    last  calculated eigval = 0.038439137787660
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79407755973921
lambda[   2] =  -0.58998417593343
lambda[   3] =  -0.43377793859504
lambda[   4] =  -0.38768224905384
lambda[   5] =  -0.35067053078816
lambda[   6] =  -0.31782505798232
lambda[   7] =  -0.19380521468245
lambda[   8] =  -0.02460227419957
lambda[   9] =   0.00967406376877
lambda[  10] =   0.02182609219137
lambda[  11] =   0.02499254560438
lambda[  12] =   0.03095308789315
lambda[  13] =   0.03843913778766
==subpsace eigenproblem: bcast eigvals took 0.074 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 3.043 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.047 ms

Total time for subspace rotation: 3.048 ms
rank = 0, Efermi =  -0.053748008026 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.508 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1117.613 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.259 ms
rank = 0, D2D took 0.445 ms
rank = 0, Transfering density took 0.453 ms
Etot    =   -19.380830226444
Eband   =    -6.135645454052
E1      =    14.575127027544
E2      =    -5.327984785763
E3      =    -8.068316937846
Exc     =    -7.026584164820
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 3.028e-07, dEband = 1.934e-05
rank = 0, Calculating/Estimating energy took 1.022 ms, Etot = -19.380830226, dEtot = 3.028e-07, dEband = 1.934e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0152627895747, which took 0.089 ms

iter_count = 108, r_2norm = 4.204e-07, tol*||rhs|| = 6.105e-07

Anderson update took 56.639 ms, out of which F'*F took 27.104 ms; b-Ax took 184.208 ms, out of which Lap took 163.582 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.294 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046371, int_b + int_rho = -1.037e-13, checking this took 0.116 ms
2-norm of RHS = 618.9239310925904, which took 0.123 ms

iter_count = 24, r_2norm = 5.945e-04, tol*||rhs|| = 6.189e-04

Anderson update took 12.694 ms, out of which F'*F took 5.937 ms; b-Ax took 40.436 ms, out of which Lap took 36.051 ms
Solving Poisson took 88.805 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.204214 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.826 ms
Total time for convolution: 	 convolve: 5.195398 
Total time for convolution: 	 convolve: 5.184069 
Total time for convolution: 	 convolve: 5.188795 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.224 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 0.327 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.346 ms

This SCF took 26393.678 ms, scf error = 1.756e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.138439, lowerbound = -0.794078, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1088.456 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.165 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.034 ms
rank =  0, Distribute data + matrix mult took 4.045 ms
rank =  0, finding HY took 18.261 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.327 ms
Rank 0, Project_Hamiltonian used 24.656 ms
Total time for projection: 24.674 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.118 ms
    first calculated eigval = -0.794071607256100
    last  calculated eigval = 0.038230067431681
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79407160725610
lambda[   2] =  -0.58997811307375
lambda[   3] =  -0.43377262608121
lambda[   4] =  -0.38767679370444
lambda[   5] =  -0.35066500108605
lambda[   6] =  -0.31781958398913
lambda[   7] =  -0.19379894392371
lambda[   8] =  -0.02466980387705
lambda[   9] =   0.00963393196892
lambda[  10] =   0.02178965992590
lambda[  11] =   0.02497131641750
lambda[  12] =   0.03062174566755
lambda[  13] =   0.03823006743168
==subpsace eigenproblem: bcast eigvals took 0.052 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 3.065 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.070 ms

Total time for subspace rotation: 3.071 ms
rank = 0, Efermi =  -0.053815537710 calculate fermi energy took 0.087 ms
rank = 0, --- Calculate rho: sum over local bands took 1.501 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1118.066 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.268 ms
rank = 0, D2D took 0.464 ms
rank = 0, Transfering density took 0.473 ms
Etot    =   -19.380824702500
Eband   =    -6.135565338734
E1      =    14.575059861966
E2      =    -5.327964392423
E3      =    -8.068371778488
Exc     =    -7.026626037919
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 7.891e-07, dEband = 1.145e-05
rank = 0, Calculating/Estimating energy took 0.976 ms, Etot = -19.380824703, dEtot = 7.891e-07, dEband = 1.145e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0224635713820, which took 0.049 ms

iter_count = 102, r_2norm = 7.277e-07, tol*||rhs|| = 8.985e-07

Anderson update took 54.123 ms, out of which F'*F took 25.386 ms; b-Ax took 173.491 ms, out of which Lap took 154.330 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 372.529 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046376, int_b + int_rho = -5.457e-14, checking this took 0.107 ms
2-norm of RHS = 618.9229810621978, which took 0.125 ms

iter_count = 90, r_2norm = 5.740e-04, tol*||rhs|| = 6.189e-04

Anderson update took 48.054 ms, out of which F'*F took 22.408 ms; b-Ax took 152.261 ms, out of which Lap took 135.556 ms
Solving Poisson took 324.280 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.149 ms
Total time for convolution: 	 convolve: 5.204665 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.386 ms
Total time for convolution: 	 convolve: 5.176719 
Total time for convolution: 	 convolve: 5.172816 
Total time for convolution: 	 convolve: 5.183622 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 0.351 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.371 ms

This SCF took 26565.028 ms, scf error = 1.657e-04
-------------
SCF iter 24  
-------------

 Chebfilt 27, in Chebyshev filtering, lambda_cutoff = 0.138230, lowerbound = -0.794072, upperbound = 267.572413

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1100.513 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.819 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 2.850 ms
rank =  0, finding HY took 18.122 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.334 ms
Rank 0, Project_Hamiltonian used 23.326 ms
Total time for projection: 23.337 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.017 ms
rank = 0, Solve_Generalized_EigenProblem used 0.097 ms
    first calculated eigval = -0.793986545886890
    last  calculated eigval = 0.038604377773588
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.79398654588689
lambda[   2] =  -0.58990453483414
lambda[   3] =  -0.43370235803491
lambda[   4] =  -0.38759994359968
lambda[   5] =  -0.35059206889016
lambda[   6] =  -0.31775367724152
lambda[   7] =  -0.19372078170283
lambda[   8] =  -0.02439679934795
lambda[   9] =   0.00983048040235
lambda[  10] =   0.02208716545541
lambda[  11] =   0.02515493655770
lambda[  12] =   0.03093146106720
lambda[  13] =   0.03860437777359
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.046 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.051 ms

Total time for subspace rotation: 3.051 ms
rank = 0, Efermi =  -0.053542533187 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.506 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1129.004 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
rank = 0, D2D took 0.422 ms
rank = 0, Transfering density took 0.426 ms
Etot    =   -19.380826898920
Eband   =    -6.134519820880
E1      =    14.574378132983
E2      =    -5.327538480379
E3      =    -8.068612260736
Exc     =    -7.026806593414
Esc     =   -34.190029358110
Entropy =    -0.000000000614
dE = 3.138e-07, dEband = 1.494e-04
rank = 0, Calculating/Estimating energy took 1.071 ms, Etot = -19.380826899, dEtot = 3.138e-07, dEband = 1.494e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0227261344261, which took 0.076 ms

iter_count = 102, r_2norm = 7.743e-07, tol*||rhs|| = 9.090e-07

Anderson update took 53.825 ms, out of which F'*F took 25.336 ms; b-Ax took 174.307 ms, out of which Lap took 154.961 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 372.147 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002046381, int_rho =  14.00000002046370, int_b + int_rho = -1.128e-13, checking this took 0.129 ms
2-norm of RHS = 618.9231227830562, which took 0.098 ms

iter_count = 24, r_2norm = 5.982e-04, tol*||rhs|| = 6.189e-04

Anderson update took 12.777 ms, out of which F'*F took 5.892 ms; b-Ax took 40.333 ms, out of which Lap took 35.921 ms
Solving Poisson took 88.914 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.175424 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.414 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.204556 
Total time for convolution: 	 convolve: 5.170834 
Total time for convolution: 	 convolve: 5.199126 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.186 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.330 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.654 ms

This SCF took 26464.888 ms, scf error = 9.837e-05
The last 13 occupations of kpoints #1 are (Nelectron = 14):
lambda[   1] =  -0.79398654588689, occ[   1] =   2.00000000000000
lambda[   2] =  -0.58990453483414, occ[   2] =   2.00000000000000
lambda[   3] =  -0.43370235803491, occ[   3] =   2.00000000000000
lambda[   4] =  -0.38759994359968, occ[   4] =   2.00000000000000
lambda[   5] =  -0.35059206889016, occ[   5] =   2.00000000000000
lambda[   6] =  -0.31775367724152, occ[   6] =   2.00000000000000
lambda[   7] =  -0.19372078170283, occ[   7] =   2.00000000000000
lambda[   8] =  -0.02439679934795, occ[   8] =   0.00000002046374
lambda[   9] =   0.00983048040235, occ[   9] =   0.00000000000000
lambda[  10] =   0.02208716545541, occ[  10] =   0.00000000000000
lambda[  11] =   0.02515493655770, occ[  11] =   0.00000000000000
lambda[  12] =   0.03093146106720, occ[  12] =   0.00000000000000
lambda[  13] =   0.03860437777359, occ[  13] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 12 (90%) = 0.000000000000000.
Occupation of state 13 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.307 ms, time for Allreduce/Reduce: 7.734 ms 
Time for calculating local force components: 14.550 ms
Start Calculating nonlocal forces
force_nloc = 
  0.04404256399504  -0.02083051963647   0.00000001202880
 -0.02520249909925  -0.01662844437569  -0.04025134924591
 -0.02520246533948  -0.01662845639336   0.04025136702091
  0.03105769189101   0.02240769268279   0.05158035415786
  0.03105769532195   0.02240771216812  -0.05158035204395
  0.00108651876662  -0.09881419171798   0.00000023949738
 -0.66943305958808   0.24707916368104   0.00000024802409
force_loc = 
 -0.04756785995595   0.02290259030744  -0.00000015065920
  0.02676835919386   0.01813396018667   0.04276134113216
  0.02676767379270   0.01813463623851  -0.04276203631254
 -0.03150257657990  -0.02488481863440  -0.05496440137746
 -0.03150262021947  -0.02488505990804   0.05496456134325
  0.00056418780501   0.09211728963491  -0.00000168521178
  0.65116796946503  -0.23769059474789  -0.00000324825665
Time for calculating nonlocal force components: 19.864 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00038340382766   0.00581658857059  -0.00000005724852
[0m[32m  0.01752564889097  -0.00866948768686  -0.00000012113482
[0mTime for calculating XC forces components: 19.855 ms
 Cartesian force = 
 -0.00352681484201   0.00207663347535   0.00000061541051
  0.00156434121351   0.00151007861535   0.00251074592716
  0.00156368957212   0.00151074264952  -0.00250991525072
 -0.00044640357000  -0.00247256314723  -0.00338329317869
 -0.00044644377862  -0.00247278493555   0.00338496334021
  0.00203259151819  -0.00087575070811  -0.00000074892200
 -0.00074096011319   0.00072364405067  -0.00000236732648
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.049 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.168 ms
Time for printing density: 380.719 ms
The program took 677.811 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:31:10
Job ID:        2266481
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:18:12,vmem=8492K,walltime=00:11:31,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-21-1
---------------------------------------
