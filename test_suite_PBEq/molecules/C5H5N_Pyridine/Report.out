---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:40
Job ID:    2266451
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:47
Job ID:    2266451
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.049 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.018 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 7.663 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 11.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 7.585 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 77.293 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.956 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.086 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	    6.315114	
   10.000000	   13.898688	   13.463538	
   10.000000	    6.101312	   13.463538	
   10.000000	   14.075922	    8.753515	
   10.000000	    5.924078	    8.753515	
   10.000000	   10.000000	    8.369904	
   10.000000	   12.164628	   12.355596	
   10.000000	    7.835372	   12.355596	
   10.000000	   12.264024	    9.718619	
   10.000000	    7.735976	    9.718619	
   10.000000	   10.000000	   13.684886	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.172 ms
Set up communicators.

--set up spincomm took 2.288 ms

--set up kptcomm took 0.355 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 23, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 23 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 23, mbQ = nbQ = 64
rank = 0, nr_Hp = 23, nc_Hp = 23
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.073 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.100 ms

Calculate_SplineDerivRadFun took 0.206 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.811 ms.
time spent on vectorized spline interp: 2.740 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.618 ms.
time spent on vectorized spline interp: 1.678 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.483 ms.
time spent on vectorized spline interp: 1.661 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.353 ms.

Calculating rb for all atom types took 16.353 ms
----------------------
Estimated memory usage
Total: 1.36 GB
orbitals             : 1.03 GB
global sized vectors : 213.62 MB
subspace matrices : 12.40 kB
others : 126.65 MB
----------------------------------------------
Estimated memory usage per processor: 116.10 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.053 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -30.0000000214091, sum_int_rho = 29.4783312187116
PosCharge = 30.000000021409, NegCharge = -29.478331218712, scal_fac = 1.017696687062
After scaling, int_rho = 30.0000000214091, PosCharge + NegCharge - NetCharge = 2.842e-14
--Calculate Vref took 0.590 ms
--Calculate rho_guess took 3.188 ms

 integral of b = -30.0000000214091,
 int{b} + Nelectron + NetCharge = -2.141e-08,
 Esc = -75.5899988019798,
 MPI_Reduce took 11.621 ms

Calculating b & b_ref took 22.682 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.078 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.089 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.076 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.672 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.006 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.008 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.008 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.439 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140898, int_b + int_rho = -1.026e-12, checking this took 0.786 ms
2-norm of RHS = 783.2399976255008, which took 0.452 ms

iter_count = 420, r_2norm = 7.192e-04, tol*||rhs|| = 7.832e-04

Anderson update took 240.589 ms, out of which F'*F took 105.890 ms; b-Ax took 716.105 ms, out of which Lap took 640.365 ms
Solving Poisson took 1524.628 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.417 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
Total time for convolution: 	 convolve: 5.189638 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.191 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
Total time for convolution: 	 convolve: 5.123843 
Total time for convolution: 	 convolve: 5.169774 
Total time for convolution: 	 convolve: 5.220104 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.196 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.446 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
rank = 0, XC calculation took 24769.199 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 4.885 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.257 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.276 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.159 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.675 ms
    Lanczos iter 54, eigmin  = -0.945387757, eigmax = 264.939583643, err_eigmin = 8.222e-04, err_eigmax = 9.790e-03
rank =   0, Lanczos took 122.672 ms, eigmin = -0.945387757083, eigmax = 267.588979479675

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.271796, lowerbound = -1.045388, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1592.544 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.073 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.249 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.339 ms
rank =  0, finding HY took 26.796 ms
rank =  0, distributing HY into block cyclic form took 21.527 ms
rank =  0, finding Y'*HY took 5.971 ms
Rank 0, Project_Hamiltonian used 79.079 ms
Total time for projection: 79.090 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.334 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 1.433 ms
    first calculated eigval = 2.716494321415396
    last  calculated eigval = 3.273275454544669
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =   2.84973428828521
lambda[   7] =   2.87631008130850
lambda[   8] =   2.90709481075678
lambda[   9] =   2.92051160982845
lambda[  10] =   2.94039549435971
lambda[  11] =   2.97599555857638
lambda[  12] =   2.99496513182431
lambda[  13] =   3.01193984344729
lambda[  14] =   3.02158212727647
lambda[  15] =   3.05095287634489
lambda[  16] =   3.06155589643096
lambda[  17] =   3.09106019698842
lambda[  18] =   3.13191944905938
lambda[  19] =   3.14660170565776
lambda[  20] =   3.16404221532913
lambda[  21] =   3.17785058182814
lambda[  22] =   3.22021290570326
lambda[  23] =   3.27327545454467
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 1.452 ms
rank =  0, subspace rotation using ScaLAPACK took 8.701 ms
rank =  0, Distributing orbital back into band + domain format took 20.171 ms
rank = 0, Subspace_Rotation used 28.885 ms

Total time for subspace rotation: 28.889 ms
rank = 0, Efermi =   3.056254386505 calculate fermi energy took 0.054 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.373275, lowerbound = -1.045388, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1559.718 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 19.795 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.042 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.857 ms
rank =  0, finding HY took 27.100 ms
rank =  0, distributing HY into block cyclic form took 19.648 ms
rank =  0, finding Y'*HY took 4.921 ms
Rank 0, Project_Hamiltonian used 74.551 ms
Total time for projection: 74.556 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.235 ms
    first calculated eigval = -0.734753932600866
    last  calculated eigval = 0.443529469658683
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.27746557175154
lambda[   7] =  -0.16473798856032
lambda[   8] =  -0.14092991691997
lambda[   9] =  -0.01801512069435
lambda[  10] =   0.00450236756021
lambda[  11] =   0.10032225958024
lambda[  12] =   0.16600197790338
lambda[  13] =   0.21405584735737
lambda[  14] =   0.24175817253019
lambda[  15] =   0.25797431249946
lambda[  16] =   0.28562116746717
lambda[  17] =   0.32543336467324
lambda[  18] =   0.34186999529009
lambda[  19] =   0.35621332117370
lambda[  20] =   0.37748451151263
lambda[  21] =   0.39399335214847
lambda[  22] =   0.43213105266038
lambda[  23] =   0.44352946965868
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 8.598 ms
rank =  0, Distributing orbital back into band + domain format took 20.168 ms
rank = 0, Subspace_Rotation used 28.781 ms

Total time for subspace rotation: 28.785 ms
rank = 0, Efermi =   0.271797743216 calculate fermi energy took 0.033 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.543529, lowerbound = -1.045388, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1557.436 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 19.632 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.282 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.931 ms
rank =  0, finding HY took 26.955 ms
rank =  0, distributing HY into block cyclic form took 19.535 ms
rank =  0, finding Y'*HY took 5.136 ms
Rank 0, Project_Hamiltonian used 74.582 ms
Total time for projection: 74.586 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.235 ms
    first calculated eigval = -0.956531168356061
    last  calculated eigval = 0.143869902277756
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.57840704501424
lambda[   7] =  -0.54619950538503
lambda[   8] =  -0.51802764634679
lambda[   9] =  -0.48266603291819
lambda[  10] =  -0.45829451656132
lambda[  11] =  -0.42729128874280
lambda[  12] =  -0.41706301642573
lambda[  13] =  -0.32570833569607
lambda[  14] =  -0.28358451268090
lambda[  15] =  -0.26894325326942
lambda[  16] =  -0.08874237807597
lambda[  17] =  -0.08053243953006
lambda[  18] =   0.07380852724051
lambda[  19] =   0.08043135739001
lambda[  20] =   0.09763784564967
lambda[  21] =   0.11297035578728
lambda[  22] =   0.12893121981252
lambda[  23] =   0.14386990227776
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 8.630 ms
rank =  0, Distributing orbital back into band + domain format took 20.196 ms
rank = 0, Subspace_Rotation used 28.842 ms

Total time for subspace rotation: 28.847 ms
rank = 0, Efermi =  -0.117847484623 calculate fermi energy took 0.032 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.243870, lowerbound = -1.045388, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1556.530 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 19.654 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.150 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.824 ms
rank =  0, finding HY took 27.047 ms
rank =  0, distributing HY into block cyclic form took 19.669 ms
rank =  0, finding Y'*HY took 4.892 ms
Rank 0, Project_Hamiltonian used 74.456 ms
Total time for projection: 74.460 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.135 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.115 ms
rank = 0, Solve_Generalized_EigenProblem used 0.253 ms
    first calculated eigval = -0.957067139352349
    last  calculated eigval = 0.092637529670545
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.58046878322347
lambda[   7] =  -0.55517959684246
lambda[   8] =  -0.52310659777374
lambda[   9] =  -0.48953109039261
lambda[  10] =  -0.46774946171920
lambda[  11] =  -0.43568656108415
lambda[  12] =  -0.43010675800568
lambda[  13] =  -0.34631168282120
lambda[  14] =  -0.32232215511012
lambda[  15] =  -0.32135271747053
lambda[  16] =  -0.14244708865717
lambda[  17] =  -0.12718988237288
lambda[  18] =   0.01574463003748
lambda[  19] =   0.03657897168450
lambda[  20] =   0.04466873832312
lambda[  21] =   0.05518699262657
lambda[  22] =   0.07326949984573
lambda[  23] =   0.09263752967055
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.264 ms
rank =  0, subspace rotation using ScaLAPACK took 8.639 ms
rank =  0, Distributing orbital back into band + domain format took 20.269 ms
rank = 0, Subspace_Rotation used 28.937 ms

Total time for subspace rotation: 28.943 ms
rank = 0, Efermi =  -0.171552165811 calculate fermi energy took 0.034 ms
rank = 0, --- Calculate rho: sum over local bands took 5.374 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.107 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.646 ms
rank = 0, Calculating density took 6830.805 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.862 ms
rank = 0, D2D took 1.962 ms
rank = 0, Transfering density took 1.970 ms
Etot    =   -43.597288407782
Eband   =   -16.884320807089
E1      =    34.385491188381
E2      =   -12.880181428318
E3      =   -16.413343012727
Exc     =   -14.801984427497
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 3.963e+00, dEband = 1.535e+00
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -43.597288408, dEtot = 3.963e+00, dEband = 1.535e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 54.0468079009361, which took 0.097 ms

iter_count = 96, r_2norm = 1.864e-03, tol*||rhs|| = 2.162e-03

Anderson update took 51.872 ms, out of which F'*F took 24.344 ms; b-Ax took 164.298 ms, out of which Lap took 146.712 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 353.938 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140905, int_b + int_rho = -9.604e-13, checking this took 0.116 ms
2-norm of RHS = 778.5391571481355, which took 0.889 ms

iter_count = 288, r_2norm = 6.475e-04, tol*||rhs|| = 7.785e-04

Anderson update took 154.588 ms, out of which F'*F took 72.223 ms; b-Ax took 504.004 ms, out of which Lap took 454.590 ms
Solving Poisson took 1055.532 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.421 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.218289 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.285 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.268665 
Total time for convolution: 	 convolve: 5.203522 
Total time for convolution: 	 convolve: 5.243715 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.634 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.023 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.581 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.284 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.912 ms

This SCF took 33203.446 ms, scf error = 1.941e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.192638, lowerbound = -0.957067, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1576.709 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.622 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.285 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.926 ms
rank =  0, finding HY took 26.948 ms
rank =  0, distributing HY into block cyclic form took 20.186 ms
rank =  0, finding Y'*HY took 5.543 ms
Rank 0, Project_Hamiltonian used 75.633 ms
Total time for projection: 75.644 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.143 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.234 ms
    first calculated eigval = -0.931823773310363
    last  calculated eigval = 0.064496353777922
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.55304416697305
lambda[   7] =  -0.51975851272860
lambda[   8] =  -0.49643352740590
lambda[   9] =  -0.46068398226069
lambda[  10] =  -0.43787123433873
lambda[  11] =  -0.41503739621905
lambda[  12] =  -0.40146288749419
lambda[  13] =  -0.32266770828185
lambda[  14] =  -0.30035943598682
lambda[  15] =  -0.29146143188411
lambda[  16] =  -0.12297588525006
lambda[  17] =  -0.10871283231162
lambda[  18] =   0.00392331306525
lambda[  19] =   0.01873268762810
lambda[  20] =   0.02494107782033
lambda[  21] =   0.03129960222776
lambda[  22] =   0.04598754579787
lambda[  23] =   0.06449635377792
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 9.232 ms
rank =  0, Distributing orbital back into band + domain format took 20.050 ms
rank = 0, Subspace_Rotation used 29.300 ms

Total time for subspace rotation: 29.306 ms
rank = 0, Efermi =  -0.152080962433 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.382 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.121 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.619 ms
rank = 0, Calculating density took 1699.618 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.864 ms
rank = 0, D2D took 1.964 ms
rank = 0, Transfering density took 1.971 ms
Etot    =   -43.525150915020
Eband   =   -16.035978234265
E1      =    33.624671271961
E2      =   -12.826700124314
E3      =   -16.626479242040
Exc     =   -14.977024516448
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 6.558e-03, dEband = 7.712e-02
rank = 0, Calculating/Estimating energy took 0.914 ms, Etot = -43.525150915, dEtot = 6.558e-03, dEband = 7.712e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 14.8965010168458, which took 0.057 ms

iter_count = 108, r_2norm = 3.650e-04, tol*||rhs|| = 5.959e-04

Anderson update took 57.790 ms, out of which F'*F took 27.580 ms; b-Ax took 185.814 ms, out of which Lap took 166.718 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 401.324 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140906, int_b + int_rho = -9.495e-13, checking this took 0.108 ms
2-norm of RHS = 770.9752074482765, which took 0.124 ms

iter_count = 306, r_2norm = 7.185e-04, tol*||rhs|| = 7.710e-04

Anderson update took 163.698 ms, out of which F'*F took 76.844 ms; b-Ax took 520.066 ms, out of which Lap took 467.229 ms
Solving Poisson took 1107.288 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.187835 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.011 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.206464 
Total time for convolution: 	 convolve: 5.193531 
Total time for convolution: 	 convolve: 5.194347 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.189 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 3.519 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.232 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.784 ms

This SCF took 28403.778 ms, scf error = 1.352e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.164496, lowerbound = -0.931824, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1572.228 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.567 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.811 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.396 ms
rank =  0, finding HY took 27.513 ms
rank =  0, distributing HY into block cyclic form took 19.593 ms
rank =  0, finding Y'*HY took 5.022 ms
Rank 0, Project_Hamiltonian used 75.555 ms
Total time for projection: 75.566 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 1.072 ms
    first calculated eigval = -0.878262339808904
    last  calculated eigval = 0.065504576534333
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.49419251947610
lambda[   7] =  -0.44778473233167
lambda[   8] =  -0.43815181002529
lambda[   9] =  -0.39970566472326
lambda[  10] =  -0.37386053638503
lambda[  11] =  -0.37274017701058
lambda[  12] =  -0.33797115976030
lambda[  13] =  -0.27494388034073
lambda[  14] =  -0.25402321059604
lambda[  15] =  -0.23032715710287
lambda[  16] =  -0.07629794556914
lambda[  17] =  -0.06323901388371
lambda[  18] =  -0.01388225043484
lambda[  19] =   0.01571453154227
lambda[  20] =   0.01705028766115
lambda[  21] =   0.03599500480817
lambda[  22] =   0.04409646106706
lambda[  23] =   0.06550457653433
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 1.100 ms
rank =  0, subspace rotation using ScaLAPACK took 8.716 ms
rank =  0, Distributing orbital back into band + domain format took 19.978 ms
rank = 0, Subspace_Rotation used 28.713 ms

Total time for subspace rotation: 28.723 ms
rank = 0, Efermi =  -0.105403022808 calculate fermi energy took 0.112 ms
rank = 0, --- Calculate rho: sum over local bands took 5.462 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.076 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.608 ms
rank = 0, Calculating density took 1695.487 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.857 ms
rank = 0, D2D took 1.959 ms
rank = 0, Transfering density took 1.966 ms
Etot    =   -43.453688198360
Eband   =   -14.258047610086
E1      =    32.107276266816
E2      =   -12.544478851892
E3      =   -17.133296117100
Exc     =   -15.390693021461
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 6.497e-03, dEband = 1.616e-01
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -43.453688198, dEtot = 6.497e-03, dEband = 1.616e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.2125541102753, which took 0.051 ms

iter_count = 102, r_2norm = 2.423e-04, tol*||rhs|| = 2.485e-04

Anderson update took 55.274 ms, out of which F'*F took 25.810 ms; b-Ax took 174.111 ms, out of which Lap took 156.221 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 377.490 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140908, int_b + int_rho = -9.277e-13, checking this took 0.126 ms
2-norm of RHS = 771.5933305297816, which took 0.110 ms

iter_count = 264, r_2norm = 7.250e-04, tol*||rhs|| = 7.716e-04

Anderson update took 141.653 ms, out of which F'*F took 66.244 ms; b-Ax took 446.948 ms, out of which Lap took 401.710 ms
Solving Poisson took 947.790 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.158416 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.786 ms
Total time for convolution: 	 convolve: 5.156779 
Total time for convolution: 	 convolve: 5.158879 
Total time for convolution: 	 convolve: 5.162847 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 3.521 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.179 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.729 ms

This SCF took 27731.335 ms, scf error = 3.356e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.165505, lowerbound = -0.878262, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1570.198 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.565 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.307 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.892 ms
rank =  0, finding HY took 26.255 ms
rank =  0, distributing HY into block cyclic form took 19.720 ms
rank =  0, finding Y'*HY took 4.868 ms
Rank 0, Project_Hamiltonian used 75.009 ms
Total time for projection: 75.021 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.135 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.229 ms
    first calculated eigval = -0.870159941351532
    last  calculated eigval = 0.063028338462856
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.48529319053976
lambda[   7] =  -0.44016890558259
lambda[   8] =  -0.42918847764949
lambda[   9] =  -0.39054317617418
lambda[  10] =  -0.36675681734064
lambda[  11] =  -0.36561511723626
lambda[  12] =  -0.32946154244725
lambda[  13] =  -0.27039121280951
lambda[  14] =  -0.24800069524941
lambda[  15] =  -0.22348831100889
lambda[  16] =  -0.07126547777315
lambda[  17] =  -0.05745418988554
lambda[  18] =  -0.02335469277985
lambda[  19] =   0.01406505462718
lambda[  20] =   0.01619073654482
lambda[  21] =   0.02874421334135
lambda[  22] =   0.03894743327381
lambda[  23] =   0.06302833846286
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 8.698 ms
rank =  0, Distributing orbital back into band + domain format took 20.015 ms
rank = 0, Subspace_Rotation used 28.727 ms

Total time for subspace rotation: 28.732 ms
rank = 0, Efermi =  -0.100370554885 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.415 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.097 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.601 ms
rank = 0, Calculating density took 1692.442 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.058 ms
rank = 0, D2D took 2.171 ms
rank = 0, Transfering density took 2.178 ms
Etot    =   -43.450409213266
Eband   =   -14.031060429575
E1      =    31.985843604996
E2      =   -12.425842341385
E3      =   -17.197057465569
Exc     =   -15.438093393019
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 2.981e-04, dEband = 2.064e-02
rank = 0, Calculating/Estimating energy took 0.911 ms, Etot = -43.450409213, dEtot = 2.981e-04, dEband = 2.064e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.7223465135480, which took 0.052 ms

iter_count = 114, r_2norm = 4.309e-05, tol*||rhs|| = 6.889e-05

Anderson update took 61.303 ms, out of which F'*F took 28.790 ms; b-Ax took 194.323 ms, out of which Lap took 174.361 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.923 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140902, int_b + int_rho = -9.895e-13, checking this took 0.075 ms
2-norm of RHS = 772.4849160407661, which took 0.134 ms

iter_count = 264, r_2norm = 7.206e-04, tol*||rhs|| = 7.725e-04

Anderson update took 140.798 ms, out of which F'*F took 67.600 ms; b-Ax took 453.562 ms, out of which Lap took 410.117 ms
Solving Poisson took 956.646 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.159 ms
Total time for convolution: 	 convolve: 5.165114 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.490 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.164474 
Total time for convolution: 	 convolve: 5.191633 
Total time for convolution: 	 convolve: 5.270498 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 3.568 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.680 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.283 ms

This SCF took 27925.218 ms, scf error = 1.654e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.163028, lowerbound = -0.870160, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1563.602 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.627 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.166 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.814 ms
rank =  0, finding HY took 26.877 ms
rank =  0, distributing HY into block cyclic form took 19.610 ms
rank =  0, finding Y'*HY took 4.952 ms
Rank 0, Project_Hamiltonian used 74.278 ms
Total time for projection: 74.288 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.135 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -0.862299232319467
    last  calculated eigval = 0.060520571514239
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47739257427136
lambda[   7] =  -0.43322688449786
lambda[   8] =  -0.42092726004762
lambda[   9] =  -0.38257882962388
lambda[  10] =  -0.36073297759487
lambda[  11] =  -0.35809037040516
lambda[  12] =  -0.32163327139961
lambda[  13] =  -0.26501404696723
lambda[  14] =  -0.24252619078733
lambda[  15] =  -0.21595662746652
lambda[  16] =  -0.06596931250628
lambda[  17] =  -0.05206215115770
lambda[  18] =  -0.02740526141720
lambda[  19] =   0.01375176324267
lambda[  20] =   0.01623442427203
lambda[  21] =   0.02417777362727
lambda[  22] =   0.03492968287256
lambda[  23] =   0.06052057151424
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.239 ms
rank =  0, subspace rotation using ScaLAPACK took 8.708 ms
rank =  0, Distributing orbital back into band + domain format took 20.085 ms
rank = 0, Subspace_Rotation used 28.809 ms

Total time for subspace rotation: 28.814 ms
rank = 0, Efermi =  -0.095074389710 calculate fermi energy took 1.000 ms
rank = 0, --- Calculate rho: sum over local bands took 5.407 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.914 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.592 ms
rank = 0, Calculating density took 1685.351 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.828 ms
rank = 0, D2D took 1.924 ms
rank = 0, Transfering density took 1.927 ms
Etot    =   -43.448550905226
Eband   =   -13.817164940424
E1      =    31.889098406135
E2      =   -12.295040767803
E3      =   -17.250354095754
Exc     =   -15.475880431873
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 1.689e-04, dEband = 1.945e-02
rank = 0, Calculating/Estimating energy took 0.939 ms, Etot = -43.448550905, dEtot = 1.689e-04, dEband = 1.945e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9397314345044, which took 0.062 ms

iter_count = 108, r_2norm = 3.560e-05, tol*||rhs|| = 3.759e-05

Anderson update took 57.778 ms, out of which F'*F took 27.195 ms; b-Ax took 183.544 ms, out of which Lap took 165.005 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.300 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140906, int_b + int_rho = -9.459e-13, checking this took 0.115 ms
2-norm of RHS = 772.8077131619365, which took 0.095 ms

iter_count = 234, r_2norm = 7.611e-04, tol*||rhs|| = 7.728e-04

Anderson update took 130.717 ms, out of which F'*F took 59.315 ms; b-Ax took 399.241 ms, out of which Lap took 359.253 ms
Solving Poisson took 858.608 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.214798 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.196124 
Total time for convolution: 	 convolve: 5.155468 
Total time for convolution: 	 convolve: 5.188532 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.196 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.516 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.325 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.671 ms

This SCF took 27722.231 ms, scf error = 5.789e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.160521, lowerbound = -0.862299, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1568.514 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.552 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.124 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.697 ms
rank =  0, finding HY took 26.877 ms
rank =  0, distributing HY into block cyclic form took 19.480 ms
rank =  0, finding Y'*HY took 5.091 ms
Rank 0, Project_Hamiltonian used 74.171 ms
Total time for projection: 74.179 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -0.859599486342804
    last  calculated eigval = 0.057492520559223
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47490149500795
lambda[   7] =  -0.43057610057402
lambda[   8] =  -0.41846325918697
lambda[   9] =  -0.38020130056531
lambda[  10] =  -0.35821587142904
lambda[  11] =  -0.35549882143480
lambda[  12] =  -0.31910105309257
lambda[  13] =  -0.26222383914383
lambda[  14] =  -0.24026430059374
lambda[  15] =  -0.21299802745985
lambda[  16] =  -0.06356609187066
lambda[  17] =  -0.04988884995761
lambda[  18] =  -0.02914880653047
lambda[  19] =   0.01325548058614
lambda[  20] =   0.01605019107003
lambda[  21] =   0.02193074539905
lambda[  22] =   0.03127904910508
lambda[  23] =   0.05749252055922
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 8.671 ms
rank =  0, Distributing orbital back into band + domain format took 19.728 ms
rank = 0, Subspace_Rotation used 28.414 ms

Total time for subspace rotation: 28.418 ms
rank = 0, Efermi =  -0.092671169066 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.459 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.158 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.612 ms
rank = 0, Calculating density took 1688.720 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.839 ms
rank = 0, D2D took 1.950 ms
rank = 0, Transfering density took 1.956 ms
Etot    =   -43.448150629953
Eband   =   -13.739253208891
E1      =    31.857682120708
E2      =   -12.245293762351
E3      =   -17.260276902008
Exc     =   -15.482151403506
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 3.639e-05, dEband = 7.083e-03
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -43.448150630, dEtot = 3.639e-05, dEband = 7.083e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4425865391493, which took 0.113 ms

iter_count = 114, r_2norm = 1.182e-05, tol*||rhs|| = 1.770e-05

Anderson update took 60.696 ms, out of which F'*F took 28.857 ms; b-Ax took 194.180 ms, out of which Lap took 174.121 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.675 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140905, int_b + int_rho = -9.604e-13, checking this took 0.078 ms
2-norm of RHS = 773.1090529721814, which took 0.134 ms

iter_count = 246, r_2norm = 6.489e-04, tol*||rhs|| = 7.731e-04

Anderson update took 131.701 ms, out of which F'*F took 62.052 ms; b-Ax took 419.492 ms, out of which Lap took 373.017 ms
Solving Poisson took 888.753 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.173922 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.163996 
Total time for convolution: 	 convolve: 5.235778 
Total time for convolution: 	 convolve: 5.178499 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.172 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.415 ms
---Transfer Veff_loc: D2D took 3.524 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.183 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.742 ms

This SCF took 27784.067 ms, scf error = 3.608e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.157493, lowerbound = -0.859599, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1576.228 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.588 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.217 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.827 ms
rank =  0, finding HY took 26.910 ms
rank =  0, distributing HY into block cyclic form took 19.514 ms
rank =  0, finding Y'*HY took 5.000 ms
Rank 0, Project_Hamiltonian used 74.282 ms
Total time for projection: 74.294 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.138 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.234 ms
    first calculated eigval = -0.855136687430991
    last  calculated eigval = 0.055752450996737
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47063398058280
lambda[   7] =  -0.42598072303302
lambda[   8] =  -0.41444243092578
lambda[   9] =  -0.37604844921358
lambda[  10] =  -0.35403629024876
lambda[  11] =  -0.35113120470071
lambda[  12] =  -0.31487109620309
lambda[  13] =  -0.25796805999970
lambda[  14] =  -0.23618501688249
lambda[  15] =  -0.20851639910880
lambda[  16] =  -0.05960442304530
lambda[  17] =  -0.04596353088371
lambda[  18] =  -0.02891146480110
lambda[  19] =   0.01378656992697
lambda[  20] =   0.01676000366834
lambda[  21] =   0.02176209906320
lambda[  22] =   0.02981035598459
lambda[  23] =   0.05575245099674
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 8.654 ms
rank =  0, Distributing orbital back into band + domain format took 19.969 ms
rank = 0, Subspace_Rotation used 28.638 ms

Total time for subspace rotation: 28.643 ms
rank = 0, Efermi =  -0.088709500348 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.682 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.797 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.631 ms
rank = 0, Calculating density took 1696.666 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.839 ms
rank = 0, D2D took 1.940 ms
rank = 0, Transfering density took 1.946 ms
Etot    =   -43.447791463103
Eband   =   -13.608948898243
E1      =    31.795601921432
E2      =   -12.172231115208
E3      =   -17.276894445182
Exc     =   -15.493571244061
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 3.265e-05, dEband = 1.185e-02
rank = 0, Calculating/Estimating energy took 0.913 ms, Etot = -43.447791463, dEtot = 3.265e-05, dEband = 1.185e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2623475730654, which took 0.056 ms

iter_count = 114, r_2norm = 6.630e-06, tol*||rhs|| = 1.049e-05

Anderson update took 61.016 ms, out of which F'*F took 28.817 ms; b-Ax took 195.199 ms, out of which Lap took 175.424 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.233 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140913, int_b + int_rho = -8.804e-13, checking this took 0.108 ms
2-norm of RHS = 773.1027074155759, which took 0.114 ms

iter_count = 228, r_2norm = 7.594e-04, tol*||rhs|| = 7.731e-04

Anderson update took 122.180 ms, out of which F'*F took 57.583 ms; b-Ax took 391.433 ms, out of which Lap took 351.337 ms
Solving Poisson took 825.574 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.164284 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.417 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.165734 
Total time for convolution: 	 convolve: 5.196931 
Total time for convolution: 	 convolve: 5.173461 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.720 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.429 ms
---Transfer Veff_loc: D2D took 3.533 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.322 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.891 ms

This SCF took 27700.672 ms, scf error = 1.919e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.155752, lowerbound = -0.855137, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1574.602 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.723 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.034 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.774 ms
rank =  0, finding HY took 26.882 ms
rank =  0, distributing HY into block cyclic form took 19.593 ms
rank =  0, finding Y'*HY took 4.871 ms
Rank 0, Project_Hamiltonian used 74.149 ms
Total time for projection: 74.160 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.229 ms
    first calculated eigval = -0.851612388976600
    last  calculated eigval = 0.054884493395869
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46760982663192
lambda[   7] =  -0.42257388942136
lambda[   8] =  -0.41156538938164
lambda[   9] =  -0.37301761026135
lambda[  10] =  -0.35086772210402
lambda[  11] =  -0.34805805005000
lambda[  12] =  -0.31182591519169
lambda[  13] =  -0.25490964615853
lambda[  14] =  -0.23311941441875
lambda[  15] =  -0.20489856983978
lambda[  16] =  -0.05657604436454
lambda[  17] =  -0.04293864974707
lambda[  18] =  -0.02741468748565
lambda[  19] =   0.01551934230153
lambda[  20] =   0.01830430973480
lambda[  21] =   0.02280744986551
lambda[  22] =   0.02911803843417
lambda[  23] =   0.05488449339587
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 8.714 ms
rank =  0, Distributing orbital back into band + domain format took 19.834 ms
rank = 0, Subspace_Rotation used 28.564 ms

Total time for subspace rotation: 28.570 ms
rank = 0, Efermi =  -0.085681121571 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.448 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.155 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1694.906 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.773 ms
rank = 0, D2D took 2.878 ms
rank = 0, Transfering density took 2.886 ms
Etot    =   -43.447704790898
Eband   =   -13.513127868247
E1      =    31.743854336036
E2      =   -12.125561158729
E3      =   -17.287481741304
Exc     =   -15.501475356099
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 7.879e-06, dEband = 8.711e-03
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -43.447704791, dEtot = 7.879e-06, dEband = 8.711e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1967918720284, which took 0.051 ms

iter_count = 114, r_2norm = 5.752e-06, tol*||rhs|| = 7.872e-06

Anderson update took 60.294 ms, out of which F'*F took 28.747 ms; b-Ax took 194.721 ms, out of which Lap took 174.126 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.527 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140905, int_b + int_rho = -9.604e-13, checking this took 0.101 ms
2-norm of RHS = 773.1251700838434, which took 0.157 ms

iter_count = 198, r_2norm = 6.774e-04, tol*||rhs|| = 7.731e-04

Anderson update took 105.918 ms, out of which F'*F took 49.817 ms; b-Ax took 335.604 ms, out of which Lap took 300.293 ms
Solving Poisson took 712.753 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
Total time for convolution: 	 convolve: 5.183185 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.155461 
Total time for convolution: 	 convolve: 5.222104 
Total time for convolution: 	 convolve: 5.167170 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 3.499 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.357 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.890 ms

This SCF took 27570.220 ms, scf error = 1.288e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.154884, lowerbound = -0.851612, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1573.740 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.667 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.168 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.854 ms
rank =  0, finding HY took 27.122 ms
rank =  0, distributing HY into block cyclic form took 19.576 ms
rank =  0, finding Y'*HY took 4.930 ms
Rank 0, Project_Hamiltonian used 74.512 ms
Total time for projection: 74.525 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -0.850930483175236
    last  calculated eigval = 0.052142062895571
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46699683608602
lambda[   7] =  -0.42201818898431
lambda[   8] =  -0.41092909099048
lambda[   9] =  -0.37239911000954
lambda[  10] =  -0.35022003106779
lambda[  11] =  -0.34747314616005
lambda[  12] =  -0.31122225269546
lambda[  13] =  -0.25430358770502
lambda[  14] =  -0.23251221601959
lambda[  15] =  -0.20422236313661
lambda[  16] =  -0.05595253078273
lambda[  17] =  -0.04231029286787
lambda[  18] =  -0.02655720370983
lambda[  19] =   0.01633201036884
lambda[  20] =   0.01905471886197
lambda[  21] =   0.02368343627113
lambda[  22] =   0.02846295092200
lambda[  23] =   0.05214206289557
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.248 ms
rank =  0, subspace rotation using ScaLAPACK took 8.666 ms
rank =  0, Distributing orbital back into band + domain format took 19.872 ms
rank = 0, Subspace_Rotation used 28.556 ms

Total time for subspace rotation: 28.560 ms
rank = 0, Efermi =  -0.085057608005 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 6.119 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.971 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.607 ms
rank = 0, Calculating density took 1694.355 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.840 ms
rank = 0, D2D took 1.942 ms
rank = 0, Transfering density took 1.947 ms
Etot    =   -43.447712684198
Eband   =   -13.494804572558
E1      =    31.736954700437
E2      =   -12.113891315982
E3      =   -17.288017134464
Exc     =   -15.501772459901
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 7.176e-07, dEband = 1.666e-03
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -43.447712684, dEtot = 7.176e-07, dEband = 1.666e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0934592421769, which took 0.058 ms

iter_count = 114, r_2norm = 2.456e-06, tol*||rhs|| = 3.738e-06

Anderson update took 60.501 ms, out of which F'*F took 28.807 ms; b-Ax took 196.410 ms, out of which Lap took 175.936 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.186 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140902, int_b + int_rho = -9.895e-13, checking this took 0.097 ms
2-norm of RHS = 773.0924935831200, which took 0.128 ms

iter_count = 210, r_2norm = 7.603e-04, tol*||rhs|| = 7.731e-04

Anderson update took 112.539 ms, out of which F'*F took 53.437 ms; b-Ax took 357.401 ms, out of which Lap took 319.946 ms
Solving Poisson took 758.570 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.188945 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.208689 
Total time for convolution: 	 convolve: 5.248116 
Total time for convolution: 	 convolve: 5.207637 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.590 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
---Transfer Veff_loc: D2D took 3.507 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.383 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.925 ms

This SCF took 27730.651 ms, scf error = 9.251e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.152142, lowerbound = -0.850930, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1588.487 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.612 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.198 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.831 ms
rank =  0, finding HY took 27.032 ms
rank =  0, distributing HY into block cyclic form took 19.619 ms
rank =  0, finding Y'*HY took 4.924 ms
Rank 0, Project_Hamiltonian used 74.439 ms
Total time for projection: 74.453 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -0.849357743440095
    last  calculated eigval = 0.051139559595351
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46539081507866
lambda[   7] =  -0.42044276428074
lambda[   8] =  -0.40933202112456
lambda[   9] =  -0.37080088666673
lambda[  10] =  -0.34862222558049
lambda[  11] =  -0.34586463429748
lambda[  12] =  -0.30962770979713
lambda[  13] =  -0.25269468190943
lambda[  14] =  -0.23090779793129
lambda[  15] =  -0.20264735687664
lambda[  16] =  -0.05429230594410
lambda[  17] =  -0.04065426073658
lambda[  18] =  -0.02231782860047
lambda[  19] =   0.02080990332465
lambda[  20] =   0.02356936514585
lambda[  21] =   0.02878480829892
lambda[  22] =   0.03162813933754
lambda[  23] =   0.05113955959535
==subpsace eigenproblem: bcast eigvals took 0.082 ms
Total time for solving subspace eigenvalue problem: 0.313 ms
rank =  0, subspace rotation using ScaLAPACK took 8.672 ms
rank =  0, Distributing orbital back into band + domain format took 20.137 ms
rank = 0, Subspace_Rotation used 28.826 ms

Total time for subspace rotation: 28.831 ms
rank = 0, Efermi =  -0.083397383136 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.479 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.903 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.598 ms
rank = 0, Calculating density took 1709.563 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.843 ms
rank = 0, D2D took 1.946 ms
rank = 0, Transfering density took 1.952 ms
Etot    =   -43.447741508862
Eband   =   -13.446868992947
E1      =    31.713422813010
E2      =   -12.089005774731
E3      =   -17.290575533113
Exc     =   -15.503877834148
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 2.620e-06, dEband = 4.358e-03
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -43.447741509, dEtot = 2.620e-06, dEband = 4.358e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0775406453421, which took 0.052 ms

iter_count = 114, r_2norm = 2.276e-06, tol*||rhs|| = 3.102e-06

Anderson update took 60.252 ms, out of which F'*F took 28.733 ms; b-Ax took 195.918 ms, out of which Lap took 175.438 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.259 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140905, int_b + int_rho = -9.532e-13, checking this took 0.109 ms
2-norm of RHS = 773.0927402289891, which took 0.113 ms

iter_count = 150, r_2norm = 7.449e-04, tol*||rhs|| = 7.731e-04

Anderson update took 80.317 ms, out of which F'*F took 37.665 ms; b-Ax took 253.629 ms, out of which Lap took 227.005 ms
Solving Poisson took 540.376 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.162563 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 69.383 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.237607 
Total time for convolution: 	 convolve: 5.264612 
Total time for convolution: 	 convolve: 5.199074 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.503 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.138 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.674 ms

This SCF took 27609.919 ms, scf error = 4.798e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.151140, lowerbound = -0.849358, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1574.319 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.665 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.095 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.778 ms
rank =  0, finding HY took 26.859 ms
rank =  0, distributing HY into block cyclic form took 19.595 ms
rank =  0, finding Y'*HY took 4.814 ms
Rank 0, Project_Hamiltonian used 74.071 ms
Total time for projection: 74.081 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.849012935231420
    last  calculated eigval = 0.047031718173718
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46507950019293
lambda[   7] =  -0.42010451990163
lambda[   8] =  -0.40904158791693
lambda[   9] =  -0.37049975175967
lambda[  10] =  -0.34829671907942
lambda[  11] =  -0.34554222190218
lambda[  12] =  -0.30931870652304
lambda[  13] =  -0.25236372625139
lambda[  14] =  -0.23059791544487
lambda[  15] =  -0.20231092028577
lambda[  16] =  -0.05397143907011
lambda[  17] =  -0.04035282027213
lambda[  18] =  -0.02165510053669
lambda[  19] =   0.02131318661939
lambda[  20] =   0.02427910925033
lambda[  21] =   0.02950640166302
lambda[  22] =   0.03161836031992
lambda[  23] =   0.04703171817372
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.238 ms
rank =  0, subspace rotation using ScaLAPACK took 8.659 ms
rank =  0, Distributing orbital back into band + domain format took 20.002 ms
rank = 0, Subspace_Rotation used 28.676 ms

Total time for subspace rotation: 28.682 ms
rank = 0, Efermi =  -0.083076516248 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.444 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.191 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.593 ms
rank = 0, Calculating density took 1694.982 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.836 ms
rank = 0, D2D took 1.937 ms
rank = 0, Transfering density took 1.943 ms
Etot    =   -43.447776081341
Eband   =   -13.437194291340
E1      =    31.708221023471
E2      =   -12.084323802094
E3      =   -17.291456681182
Exc     =   -15.504584494125
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 3.143e-06, dEband = 8.795e-04
rank = 0, Calculating/Estimating energy took 0.927 ms, Etot = -43.447776081, dEtot = 3.143e-06, dEband = 8.795e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0502202916860, which took 0.071 ms

iter_count = 114, r_2norm = 1.212e-06, tol*||rhs|| = 2.009e-06

Anderson update took 60.897 ms, out of which F'*F took 30.139 ms; b-Ax took 195.490 ms, out of which Lap took 175.547 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.824 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140907, int_b + int_rho = -9.350e-13, checking this took 0.106 ms
2-norm of RHS = 773.1176309592304, which took 0.127 ms

iter_count = 186, r_2norm = 6.256e-04, tol*||rhs|| = 7.731e-04

Anderson update took 101.358 ms, out of which F'*F took 46.395 ms; b-Ax took 314.497 ms, out of which Lap took 281.927 ms
Solving Poisson took 672.167 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.191069 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 43.505 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.205698 
Total time for convolution: 	 convolve: 5.172613 
Total time for convolution: 	 convolve: 5.158914 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 3.514 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.408 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.957 ms

This SCF took 27558.895 ms, scf error = 4.114e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.147032, lowerbound = -0.849013, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1569.028 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.760 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.208 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.989 ms
rank =  0, finding HY took 26.944 ms
rank =  0, distributing HY into block cyclic form took 19.474 ms
rank =  0, finding Y'*HY took 5.037 ms
Rank 0, Project_Hamiltonian used 74.473 ms
Total time for projection: 74.485 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.637 ms
rank = 0, Solve_Generalized_EigenProblem used 1.168 ms
    first calculated eigval = -0.848140505997711
    last  calculated eigval = 0.044428016666869
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46423576057356
lambda[   7] =  -0.41925236886241
lambda[   8] =  -0.40824988890366
lambda[   9] =  -0.36969237718524
lambda[  10] =  -0.34742727779851
lambda[  11] =  -0.34468322045697
lambda[  12] =  -0.30850464026629
lambda[  13] =  -0.25148904522671
lambda[  14] =  -0.22975744531161
lambda[  15] =  -0.20150103964979
lambda[  16] =  -0.05311088811344
lambda[  17] =  -0.03955151624853
lambda[  18] =  -0.01836885524965
lambda[  19] =   0.02583659971816
lambda[  20] =   0.02699795227774
lambda[  21] =   0.03314910259042
lambda[  22] =   0.03399126569808
lambda[  23] =   0.04442801666687
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 1.186 ms
rank =  0, subspace rotation using ScaLAPACK took 8.704 ms
rank =  0, Distributing orbital back into band + domain format took 19.795 ms
rank = 0, Subspace_Rotation used 28.513 ms

Total time for subspace rotation: 28.519 ms
rank = 0, Efermi =  -0.082215965238 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.464 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.059 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.600 ms
rank = 0, Calculating density took 1690.473 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.846 ms
rank = 0, D2D took 1.946 ms
rank = 0, Transfering density took 1.951 ms
Etot    =   -43.447907210141
Eband   =   -13.411879043659
E1      =    31.695963385814
E2      =   -12.070841746587
E3      =   -17.293030688951
Exc     =   -15.505865185212
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 1.192e-05, dEband = 2.301e-03
rank = 0, Calculating/Estimating energy took 0.931 ms, Etot = -43.447907210, dEtot = 1.192e-05, dEband = 2.301e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0417091876038, which took 0.060 ms

iter_count = 108, r_2norm = 1.664e-06, tol*||rhs|| = 1.668e-06

Anderson update took 57.221 ms, out of which F'*F took 27.447 ms; b-Ax took 185.317 ms, out of which Lap took 166.139 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.017 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140904, int_b + int_rho = -9.713e-13, checking this took 0.102 ms
2-norm of RHS = 773.1206940781306, which took 0.127 ms

iter_count = 150, r_2norm = 7.273e-04, tol*||rhs|| = 7.731e-04

Anderson update took 80.222 ms, out of which F'*F took 37.749 ms; b-Ax took 255.525 ms, out of which Lap took 228.961 ms
Solving Poisson took 543.242 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.180995 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.617 ms
Total time for convolution: 	 convolve: 5.215743 
Total time for convolution: 	 convolve: 5.166075 
Total time for convolution: 	 convolve: 5.163192 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.522 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.118 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.673 ms

This SCF took 27350.067 ms, scf error = 2.192e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.144428, lowerbound = -0.848141, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1574.756 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.433 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.724 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.178 ms
rank =  0, finding HY took 26.607 ms
rank =  0, distributing HY into block cyclic form took 19.468 ms
rank =  0, finding Y'*HY took 4.972 ms
Rank 0, Project_Hamiltonian used 74.254 ms
Total time for projection: 74.266 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.231 ms
    first calculated eigval = -0.847939172678189
    last  calculated eigval = 0.042268382754030
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46405507989342
lambda[   7] =  -0.41906454412774
lambda[   8] =  -0.40806671391105
lambda[   9] =  -0.36951137086880
lambda[  10] =  -0.34722648346332
lambda[  11] =  -0.34450675573395
lambda[  12] =  -0.30832691248132
lambda[  13] =  -0.25130108070923
lambda[  14] =  -0.22956224245008
lambda[  15] =  -0.20128567189461
lambda[  16] =  -0.05291709906173
lambda[  17] =  -0.03936739224563
lambda[  18] =  -0.01700788120432
lambda[  19] =   0.02753332230009
lambda[  20] =   0.02778351448669
lambda[  21] =   0.03446055873876
lambda[  22] =   0.03505656472507
lambda[  23] =   0.04226838275403
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 8.678 ms
rank =  0, Distributing orbital back into band + domain format took 19.963 ms
rank = 0, Subspace_Rotation used 28.656 ms

Total time for subspace rotation: 28.661 ms
rank = 0, Efermi =  -0.082022176296 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.449 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.027 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.611 ms
rank = 0, Calculating density took 1695.165 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.832 ms
rank = 0, D2D took 1.931 ms
rank = 0, Transfering density took 1.936 ms
Etot    =   -43.447950124473
Eband   =   -13.406221182242
E1      =    31.693328748979
E2      =   -12.067767380310
E3      =   -17.293157442574
Exc     =   -15.505983711472
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 3.901e-06, dEband = 5.144e-04
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -43.447950124, dEtot = 3.901e-06, dEband = 5.144e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0336215725643, which took 0.057 ms

iter_count = 114, r_2norm = 8.239e-07, tol*||rhs|| = 1.345e-06

Anderson update took 62.643 ms, out of which F'*F took 29.006 ms; b-Ax took 195.101 ms, out of which Lap took 175.102 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.050 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140909, int_b + int_rho = -9.168e-13, checking this took 0.108 ms
2-norm of RHS = 773.1214363950173, which took 0.089 ms

iter_count = 126, r_2norm = 7.440e-04, tol*||rhs|| = 7.731e-04

Anderson update took 67.688 ms, out of which F'*F took 31.825 ms; b-Ax took 214.803 ms, out of which Lap took 192.542 ms
Solving Poisson took 457.245 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.272 ms
Total time for convolution: 	 convolve: 5.165332 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.950 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.165658 
Total time for convolution: 	 convolve: 5.184776 
Total time for convolution: 	 convolve: 5.171730 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 3.508 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.390 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.934 ms

This SCF took 27273.496 ms, scf error = 1.681e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.142268, lowerbound = -0.847939, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1566.646 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.582 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.186 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.787 ms
rank =  0, finding HY took 26.851 ms
rank =  0, distributing HY into block cyclic form took 19.524 ms
rank =  0, finding Y'*HY took 4.961 ms
Rank 0, Project_Hamiltonian used 74.151 ms
Total time for projection: 74.162 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.847829635634756
    last  calculated eigval = 0.040517671448611
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46394124123265
lambda[   7] =  -0.41894432430184
lambda[   8] =  -0.40795456774752
lambda[   9] =  -0.36939753731843
lambda[  10] =  -0.34711297178696
lambda[  11] =  -0.34439292465634
lambda[  12] =  -0.30821430277238
lambda[  13] =  -0.25118942178081
lambda[  14] =  -0.22944519042048
lambda[  15] =  -0.20117805986895
lambda[  16] =  -0.05281858785358
lambda[  17] =  -0.03926670581645
lambda[  18] =  -0.01674961052738
lambda[  19] =   0.02733076180777
lambda[  20] =   0.02813832669375
lambda[  21] =   0.03453901965856
lambda[  22] =   0.03526501010500
lambda[  23] =   0.04051767144861
==subpsace eigenproblem: bcast eigvals took 0.038 ms
Total time for solving subspace eigenvalue problem: 0.261 ms
rank =  0, subspace rotation using ScaLAPACK took 8.665 ms
rank =  0, Distributing orbital back into band + domain format took 19.783 ms
rank = 0, Subspace_Rotation used 28.461 ms

Total time for subspace rotation: 28.466 ms
rank = 0, Efermi =  -0.081923665156 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 5.419 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.241 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.595 ms
rank = 0, Calculating density took 1686.916 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.831 ms
rank = 0, D2D took 1.923 ms
rank = 0, Transfering density took 1.925 ms
Etot    =   -43.447980228113
Eband   =   -13.402776194185
E1      =    31.691563831124
E2      =   -12.066023716325
E3      =   -17.293341319861
Exc     =   -15.506134098616
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 2.737e-06, dEband = 3.132e-04
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -43.447980228, dEtot = 2.737e-06, dEband = 3.132e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0257807507862, which took 0.050 ms

iter_count = 108, r_2norm = 9.944e-07, tol*||rhs|| = 1.031e-06

Anderson update took 57.076 ms, out of which F'*F took 27.135 ms; b-Ax took 201.815 ms, out of which Lap took 182.515 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 413.036 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140905, int_b + int_rho = -9.568e-13, checking this took 0.108 ms
2-norm of RHS = 773.1242140175115, which took 0.112 ms

iter_count = 138, r_2norm = 6.209e-04, tol*||rhs|| = 7.731e-04

Anderson update took 73.797 ms, out of which F'*F took 34.512 ms; b-Ax took 234.198 ms, out of which Lap took 209.081 ms
Solving Poisson took 498.833 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.205429 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.167060 
Total time for convolution: 	 convolve: 5.166545 
Total time for convolution: 	 convolve: 5.256791 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.630 ms
---Transfer Veff_loc: D2D took 3.868 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.312 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.214 ms

This SCF took 27678.553 ms, scf error = 1.358e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.140518, lowerbound = -0.847830, upperbound = 267.588979

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1578.630 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.714 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.069 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.801 ms
rank =  0, finding HY took 26.849 ms
rank =  0, distributing HY into block cyclic form took 19.347 ms
rank =  0, finding Y'*HY took 5.103 ms
Rank 0, Project_Hamiltonian used 74.126 ms
Total time for projection: 74.138 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.231 ms
    first calculated eigval = -0.847672674326796
    last  calculated eigval = 0.039587579808081
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46378540860948
lambda[   7] =  -0.41878559374049
lambda[   8] =  -0.40780061699628
lambda[   9] =  -0.36924211659606
lambda[  10] =  -0.34695995163124
lambda[  11] =  -0.34423817894994
lambda[  12] =  -0.30805903680007
lambda[  13] =  -0.25103873574653
lambda[  14] =  -0.22929458467133
lambda[  15] =  -0.20103577141445
lambda[  16] =  -0.05269801620774
lambda[  17] =  -0.03914043425946
lambda[  18] =  -0.01669643099573
lambda[  19] =   0.02649939914996
lambda[  20] =   0.02879278456535
lambda[  21] =   0.03443805421171
lambda[  22] =   0.03533949446093
lambda[  23] =   0.03958757980808
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.270 ms
rank =  0, subspace rotation using ScaLAPACK took 8.677 ms
rank =  0, Distributing orbital back into band + domain format took 19.738 ms
rank = 0, Subspace_Rotation used 28.431 ms

Total time for subspace rotation: 28.437 ms
rank = 0, Efermi =  -0.081803093337 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 5.417 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.270 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 1698.881 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.834 ms
rank = 0, D2D took 1.927 ms
rank = 0, Transfering density took 1.930 ms
Etot    =   -43.448020534415
Eband   =   -13.398126247890
E1      =    31.689330266190
E2      =   -12.063496921681
E3      =   -17.293586467180
Exc     =   -15.506309138954
Esc     =   -75.589998801980
Entropy =    -0.000000000642
dE = 3.664e-06, dEband = 4.227e-04
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -43.448020534, dEtot = 3.664e-06, dEband = 4.227e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0188057325046, which took 0.062 ms

iter_count = 108, r_2norm = 6.546e-07, tol*||rhs|| = 7.522e-07

Anderson update took 57.349 ms, out of which F'*F took 27.310 ms; b-Ax took 184.768 ms, out of which Lap took 165.368 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.674 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000002141001, int_rho =  30.00000002140907, int_b + int_rho = -9.386e-13, checking this took 0.113 ms
2-norm of RHS = 773.1215146384905, which took 0.103 ms

iter_count = 132, r_2norm = 7.045e-04, tol*||rhs|| = 7.731e-04

Anderson update took 72.560 ms, out of which F'*F took 34.001 ms; b-Ax took 224.477 ms, out of which Lap took 201.425 ms
Solving Poisson took 480.173 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.160394 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.739 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.198390 
Total time for convolution: 	 convolve: 5.163601 
Total time for convolution: 	 convolve: 5.204418 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.134 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.485 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.548 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.153 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.734 ms

This SCF took 27335.517 ms, scf error = 9.303e-05
The last 18 occupations of kpoints #1 are (Nelectron = 30):
lambda[   6] =  -0.46378540860948, occ[   6] =   2.00000000000000
lambda[   7] =  -0.41878559374049, occ[   7] =   2.00000000000000
lambda[   8] =  -0.40780061699628, occ[   8] =   2.00000000000000
lambda[   9] =  -0.36924211659606, occ[   9] =   2.00000000000000
lambda[  10] =  -0.34695995163124, occ[  10] =   2.00000000000000
lambda[  11] =  -0.34423817894994, occ[  11] =   2.00000000000000
lambda[  12] =  -0.30805903680007, occ[  12] =   2.00000000000000
lambda[  13] =  -0.25103873574653, occ[  13] =   2.00000000000000
lambda[  14] =  -0.22929458467133, occ[  14] =   2.00000000000000
lambda[  15] =  -0.20103577141445, occ[  15] =   2.00000000000000
lambda[  16] =  -0.05269801620774, occ[  16] =   0.00000002140905
lambda[  17] =  -0.03914043425946, occ[  17] =   0.00000000000000
lambda[  18] =  -0.01669643099573, occ[  18] =   0.00000000000000
lambda[  19] =   0.02649939914996, occ[  19] =   0.00000000000000
lambda[  20] =   0.02879278456535, occ[  20] =   0.00000000000000
lambda[  21] =   0.03443805421171, occ[  21] =   0.00000000000000
lambda[  22] =   0.03533949446093, occ[  22] =   0.00000000000000
lambda[  23] =   0.03958757980808, occ[  23] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 21 (90%) = 0.000000000000000.
Occupation of state 23 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.732 ms, time for Allreduce/Reduce: 13.562 ms 
Time for calculating local force components: 24.961 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000000096921  -0.00000002160197   0.05165503566522
 -0.00000002077502  -0.04346115462799  -0.02844366677599
 -0.00000001805908   0.04346152185269  -0.02844385233828
 -0.00000000757970  -0.04540376804246   0.02420476438213
  0.00000001750433   0.04540361174343   0.02420467337261
 -0.00000085676709   0.00000181312539   0.01678346913997
 -0.00000057360623  -0.07962816892234   0.03446543367004
  0.00000095902946   0.07963179464356   0.03446588592612
  0.00000019723051  -0.01931348965895  -0.00038179824720
 -0.00000032547276   0.01931121731450  -0.00037954127025
  0.00000008568073  -0.00000297666832  -0.83764753799391
force_loc = 
 -0.00000025081003   0.00000024695418  -0.05221549594309
  0.00000003849840   0.04474240388592   0.02908719728231
  0.00000053405113  -0.04474222560164   0.02908756107618
  0.00000025525686   0.04627499375496  -0.02467423869634
 -0.00000030095745  -0.04627504798228  -0.02467459647161
  0.00000033745407   0.00000038246490  -0.01943275681127
 -0.00000069382250   0.07765316518379  -0.03085396390402
 -0.00000034110918  -0.07765405439783  -0.03085122399373
  0.00000050742158   0.02151632711615  -0.00141027348189
  0.00000111110283  -0.02151506858988  -0.00141061598976
  0.00000052914528  -0.00000080755401   0.81462151329827
Time for calculating nonlocal force components: 41.910 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000003315492  -0.00000001355827   0.00236918605978
[0m[32m -0.00000003245052   0.00015512328232  -0.00234434646837
[0m[32m -0.00000003259157  -0.00015524535293  -0.00234420011409
[0m[32m  0.00000004984547  -0.00188480815666   0.00161117540184
[0m[32m  0.00000005412445   0.00188488157355   0.00161112182347
[0m[32m  0.00000003135737   0.00000002514218   0.02137330182986
[0mTime for calculating XC forces components: 35.763 ms
 Cartesian force = 
 -0.00000036867806   0.00000016559566  -0.00056338849860
 -0.00000009917544   0.00128118950139   0.00064060228559
  0.00000039909322  -0.00128076350549   0.00064078051718
  0.00000013077834   0.00087116595596  -0.00047240253494
 -0.00000040035194  -0.00087149599540  -0.00047285131972
 -0.00000060305693   0.00000212227547  -0.00028302983224
 -0.00000141677808  -0.00181994021278   0.00126419507692
  0.00000046842989   0.00182243513626   0.00126753359757
  0.00000063759874   0.00031796954399  -0.00018382454799
  0.00000072285570  -0.00031902945837  -0.00018196365727
  0.00000052928456  -0.00000381883669  -0.00165565108650
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Time for printing density: 380.714 ms
The program took 448.726 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:18
Job ID:        2266451
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:33:12,vmem=8356K,walltime=00:07:46,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-8-2
---------------------------------------
