---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:42
Job ID:    2266465
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:48
Job ID:    2266465
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 13.044 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 4.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = N.psp8

Reading ion file took 20.204 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 65.938 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.049 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.089 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.265559	    7.548494	   10.000000	
    9.396837	    8.007667	   10.000000	
    9.212300	   10.358056	   10.000000	
    8.734441	   12.451506	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.016 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.172 ms
Set up communicators.

--set up spincomm took 2.373 ms

--set up kptcomm took 0.396 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.077 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.400 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.580 ms

Calculate_SplineDerivRadFun took 0.113 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.322 ms.
time spent on vectorized spline interp: 2.250 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.008 ms.
time spent on vectorized spline interp: 1.695 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.499 ms.

Calculating rb for all atom types took 10.782 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.924 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000144672, sum_int_rho = 15.8953194174588
PosCharge = 16.000000014467, NegCharge = -15.895319417459, scal_fac = 1.006585623998
After scaling, int_rho = 16.0000000144673, PosCharge + NegCharge - NetCharge = -7.816e-14
--Calculate Vref took 0.336 ms
--Calculate rho_guess took 1.908 ms

 integral of b = -16.0000000144672,
 int{b} + Nelectron + NetCharge = -1.447e-08,
 Esc = -51.1615064821133,
 MPI_Reduce took 4.369 ms

Calculating b & b_ref took 11.969 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.007 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.091 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.001 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.002 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.793 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 26.918 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446718, int_b + int_rho = -1.164e-13, checking this took 0.089 ms
2-norm of RHS = 524.1523674706443, which took 0.806 ms

iter_count = 420, r_2norm = 5.230e-04, tol*||rhs|| = 5.242e-04

Anderson update took 243.560 ms, out of which F'*F took 107.216 ms; b-Ax took 729.341 ms, out of which Lap took 647.841 ms
Solving Poisson took 1544.958 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.419 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
Total time for convolution: 	 convolve: 5.131609 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.502 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
Total time for convolution: 	 convolve: 5.143255 
Total time for convolution: 	 convolve: 5.248700 
Total time for convolution: 	 convolve: 5.250372 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.721 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.454 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
rank = 0, XC calculation took 25021.730 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 1.117 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.772 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 3.016 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.140 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.686 ms
    Lanczos iter 53, eigmin  = -1.111819614, eigmax = 264.923774324, err_eigmin = 4.815e-04, err_eigmax = 9.651e-03
rank =   0, Lanczos took 119.557 ms, eigmin = -1.111819613914, eigmax = 267.573012066866

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.180596, lowerbound = -1.211820, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1175.881 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.633 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.497 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.184 ms
rank =  0, Distribute data + matrix mult took 17.333 ms
rank =  0, finding HY took 19.150 ms
rank =  0, distributing HY into block cyclic form took 13.713 ms
rank =  0, finding Y'*HY took 1.939 ms
Rank 0, Project_Hamiltonian used 52.163 ms
Total time for projection: 52.183 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.358 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.412 ms
    first calculated eigval = 2.786891650199135
    last  calculated eigval = 3.186764906530231
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.78689165019914
lambda[   2] =   2.81690708360798
lambda[   3] =   2.86758575837840
lambda[   4] =   2.91380871463054
lambda[   5] =   2.96329972805966
lambda[   6] =   2.98563180391964
lambda[   7] =   3.01317897808462
lambda[   8] =   3.03436807648394
lambda[   9] =   3.07626042302345
lambda[  10] =   3.09010100573375
lambda[  11] =   3.12566782999950
lambda[  12] =   3.13129252281770
lambda[  13] =   3.15714744860620
lambda[  14] =   3.18676490653023
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.426 ms
rank =  0, subspace rotation using ScaLAPACK took 3.209 ms
rank =  0, Distributing orbital back into band + domain format took 12.087 ms
rank = 0, Subspace_Rotation used 15.308 ms

Total time for subspace rotation: 15.313 ms
rank = 0, Efermi =   3.055314408158 calculate fermi energy took 0.047 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.286765, lowerbound = -1.211820, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1162.974 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.848 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.428 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 15.198 ms
rank =  0, finding HY took 18.669 ms
rank =  0, distributing HY into block cyclic form took 12.731 ms
rank =  0, finding Y'*HY took 2.041 ms
Rank 0, Project_Hamiltonian used 48.668 ms
Total time for projection: 48.675 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.897604240057351
    last  calculated eigval = 0.469204646286384
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.89760424005735
lambda[   2] =  -0.77422143826068
lambda[   3] =  -0.35984358471328
lambda[   4] =  -0.11455313527563
lambda[   5] =  -0.05055217516720
lambda[   6] =   0.12468092592575
lambda[   7] =   0.20345768515166
lambda[   8] =   0.23347672423595
lambda[   9] =   0.28782286471365
lambda[  10] =   0.34551685183232
lambda[  11] =   0.37421307058707
lambda[  12] =   0.40960056035729
lambda[  13] =   0.44734936653224
lambda[  14] =   0.46920464628638
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 3.195 ms
rank =  0, Distributing orbital back into band + domain format took 12.016 ms
rank = 0, Subspace_Rotation used 15.225 ms

Total time for subspace rotation: 15.229 ms
rank = 0, Efermi =   0.260690456609 calculate fermi energy took 0.023 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.569205, lowerbound = -1.211820, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1163.965 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.928 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.452 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.399 ms
rank =  0, finding HY took 18.005 ms
rank =  0, distributing HY into block cyclic form took 12.609 ms
rank =  0, finding Y'*HY took 2.173 ms
Rank 0, Project_Hamiltonian used 47.213 ms
Total time for projection: 47.220 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -1.118057005732600
    last  calculated eigval = 0.154553461643734
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.11805700573260
lambda[   2] =  -0.98120555863385
lambda[   3] =  -0.64937619699442
lambda[   4] =  -0.50321742527268
lambda[   5] =  -0.49811402419267
lambda[   6] =  -0.46595470309029
lambda[   7] =  -0.34598969118783
lambda[   8] =  -0.28379856952186
lambda[   9] =  -0.04725597490361
lambda[  10] =   0.01895766663990
lambda[  11] =   0.08404810644662
lambda[  12] =   0.10383946273352
lambda[  13] =   0.12981992473458
lambda[  14] =   0.15455346164373
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 3.167 ms
rank =  0, Distributing orbital back into band + domain format took 12.113 ms
rank = 0, Subspace_Rotation used 15.294 ms

Total time for subspace rotation: 15.298 ms
rank = 0, Efermi =  -0.076712133305 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.254553, lowerbound = -1.211820, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1141.535 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.522 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.354 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 13.898 ms
rank =  0, finding HY took 18.280 ms
rank =  0, distributing HY into block cyclic form took 12.650 ms
rank =  0, finding Y'*HY took 2.189 ms
Rank 0, Project_Hamiltonian used 47.046 ms
Total time for projection: 47.052 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -1.118255351402539
    last  calculated eigval = 0.095380562163664
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.11825535140254
lambda[   2] =  -0.98150656820006
lambda[   3] =  -0.65115139511934
lambda[   4] =  -0.51390773803773
lambda[   5] =  -0.50655081252473
lambda[   6] =  -0.47716142510130
lambda[   7] =  -0.37645271818715
lambda[   8] =  -0.32358064321653
lambda[   9] =  -0.10573981197106
lambda[  10] =  -0.07827568214035
lambda[  11] =   0.00506875302897
lambda[  12] =   0.05662919964305
lambda[  13] =   0.06438539334151
lambda[  14] =   0.09538056216366
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.198 ms
rank =  0, Distributing orbital back into band + domain format took 12.081 ms
rank = 0, Subspace_Rotation used 15.292 ms

Total time for subspace rotation: 15.296 ms
rank = 0, Efermi =  -0.135195970281 calculate fermi energy took 0.021 ms
rank = 0, --- Calculate rho: sum over local bands took 2.135 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.640 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.105 ms
rank = 0, Calculating density took 5026.987 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.407 ms
rank = 0, D2D took 0.772 ms
rank = 0, Transfering density took 0.775 ms
Etot    =   -31.700914433857
Eband   =    -9.897133305109
E1      =    19.667862942837
E2      =    -8.719711510406
E3      =   -10.090252186155
Exc     =    -9.120101285595
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 7.925e+00, dEband = 2.474e+00
rank = 0, Calculating/Estimating energy took 1.001 ms, Etot = -31.700914434, dEtot = 7.925e+00, dEband = 2.474e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 44.2601966508010, which took 0.047 ms

iter_count = 96, r_2norm = 1.060e-03, tol*||rhs|| = 1.770e-03

Anderson update took 51.592 ms, out of which F'*F took 24.244 ms; b-Ax took 162.803 ms, out of which Lap took 146.218 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 350.715 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446729, int_b + int_rho = -5.457e-15, checking this took 0.099 ms
2-norm of RHS = 521.3021597688791, which took 0.127 ms

iter_count = 282, r_2norm = 4.228e-04, tol*||rhs|| = 5.213e-04

Anderson update took 151.628 ms, out of which F'*F took 72.038 ms; b-Ax took 477.924 ms, out of which Lap took 430.409 ms
Solving Poisson took 1015.111 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.406 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.108 ms
Total time for convolution: 	 convolve: 5.083139 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.092091 
Total time for convolution: 	 convolve: 5.089825 
Total time for convolution: 	 convolve: 5.186745 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.376 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.672 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.988 ms

This SCF took 30820.309 ms, scf error = 1.468e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.195381, lowerbound = -1.118255, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1122.750 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.577 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.461 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.219 ms
rank =  0, Distribute data + matrix mult took 14.270 ms
rank =  0, finding HY took 17.835 ms
rank =  0, distributing HY into block cyclic form took 12.618 ms
rank =  0, finding Y'*HY took 2.203 ms
Rank 0, Project_Hamiltonian used 46.957 ms
Total time for projection: 46.973 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -1.106304042864471
    last  calculated eigval = 0.077094457556845
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.10630404286447
lambda[   2] =  -0.95696189081445
lambda[   3] =  -0.61968057494542
lambda[   4] =  -0.50046549110813
lambda[   5] =  -0.49850464227204
lambda[   6] =  -0.45431027323771
lambda[   7] =  -0.34493862445245
lambda[   8] =  -0.29168920726088
lambda[   9] =  -0.10820678150133
lambda[  10] =  -0.07315687003264
lambda[  11] =  -0.02574352859113
lambda[  12] =   0.03542495772512
lambda[  13] =   0.04449145691794
lambda[  14] =   0.07709445755685
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 3.214 ms
rank =  0, Distributing orbital back into band + domain format took 12.101 ms
rank = 0, Subspace_Rotation used 15.326 ms

Total time for subspace rotation: 15.330 ms
rank = 0, Efermi =  -0.137662939822 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.230 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.510 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.089 ms
rank = 0, Calculating density took 1188.204 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.407 ms
rank = 0, D2D took 0.873 ms
rank = 0, Transfering density took 0.876 ms
Etot    =   -31.664034918687
Eband   =    -9.545709495477
E1      =    19.360395500032
E2      =    -8.690769223126
E3      =   -10.192850384745
Exc     =    -9.200834048562
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 9.220e-03, dEband = 8.786e-02
rank = 0, Calculating/Estimating energy took 0.913 ms, Etot = -31.664034919, dEtot = 9.220e-03, dEband = 8.786e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 19.3738564318879, which took 0.057 ms

iter_count = 96, r_2norm = 6.982e-04, tol*||rhs|| = 7.750e-04

Anderson update took 51.009 ms, out of which F'*F took 24.517 ms; b-Ax took 164.144 ms, out of which Lap took 146.763 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 355.072 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446728, int_b + int_rho = -2.183e-14, checking this took 0.125 ms
2-norm of RHS = 518.9978290802859, which took 0.107 ms

iter_count = 282, r_2norm = 4.970e-04, tol*||rhs|| = 5.190e-04

Anderson update took 150.414 ms, out of which F'*F took 71.379 ms; b-Ax took 484.241 ms, out of which Lap took 434.031 ms
Solving Poisson took 1013.845 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.515 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.596 ms
Total time for convolution: 	 convolve: 5.087115 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 41.845 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.080458 
Total time for convolution: 	 convolve: 5.085697 
Total time for convolution: 	 convolve: 5.095294 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.398 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.444 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 1.853 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.310 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.184 ms

This SCF took 26954.624 ms, scf error = 8.726e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.177094, lowerbound = -1.106304, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1109.920 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 24.235 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.661 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.061 ms
rank =  0, Distribute data + matrix mult took 25.970 ms
rank =  0, finding HY took 19.447 ms
rank =  0, distributing HY into block cyclic form took 12.710 ms
rank =  0, finding Y'*HY took 2.140 ms
Rank 0, Project_Hamiltonian used 60.294 ms
Total time for projection: 60.309 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.095 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -1.083201656149924
    last  calculated eigval = 0.065758806965597
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.08320165614992
lambda[   2] =  -0.92767332742650
lambda[   3] =  -0.58808942185310
lambda[   4] =  -0.48224926085800
lambda[   5] =  -0.48137320162276
lambda[   6] =  -0.42620475475247
lambda[   7] =  -0.31256750425657
lambda[   8] =  -0.26158157145158
lambda[   9] =  -0.09235804380381
lambda[  10] =  -0.05368152730442
lambda[  11] =  -0.03304600474819
lambda[  12] =   0.02688440323394
lambda[  13] =   0.03500392139409
lambda[  14] =   0.06575880696560
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 3.222 ms
rank =  0, Distributing orbital back into band + domain format took 12.092 ms
rank = 0, Subspace_Rotation used 15.330 ms

Total time for subspace rotation: 15.334 ms
rank = 0, Efermi =  -0.121814202138 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.079 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.685 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.098 ms
rank = 0, Calculating density took 1188.690 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.416 ms
rank = 0, D2D took 0.638 ms
rank = 0, Transfering density took 0.642 ms
Etot    =   -31.647298214411
Eband   =    -9.125881398078
E1      =    19.006438793421
E2      =    -8.614196377990
E3      =   -10.318201861000
Exc     =    -9.298747366192
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 4.184e-03, dEband = 1.050e-01
rank = 0, Calculating/Estimating energy took 1.191 ms, Etot = -31.647298214, dEtot = 4.184e-03, dEband = 1.050e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.1257465568122, which took 0.053 ms

iter_count = 102, r_2norm = 1.781e-04, tol*||rhs|| = 2.050e-04

Anderson update took 54.451 ms, out of which F'*F took 25.716 ms; b-Ax took 174.381 ms, out of which Lap took 156.634 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.587 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446729, int_b + int_rho = -3.638e-15, checking this took 0.076 ms
2-norm of RHS = 519.1268379709282, which took 0.105 ms

iter_count = 276, r_2norm = 4.736e-04, tol*||rhs|| = 5.191e-04

Anderson update took 146.890 ms, out of which F'*F took 69.254 ms; b-Ax took 470.086 ms, out of which Lap took 419.606 ms
Solving Poisson took 990.738 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.415 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.102336 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.094537 
Total time for convolution: 	 convolve: 5.083918 
Total time for convolution: 	 convolve: 5.080135 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.678 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.993 ms

This SCF took 26951.946 ms, scf error = 3.990e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.165759, lowerbound = -1.083202, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1102.883 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.597 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.468 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 14.084 ms
rank =  0, finding HY took 18.287 ms
rank =  0, distributing HY into block cyclic form took 12.388 ms
rank =  0, finding Y'*HY took 2.484 ms
Rank 0, Project_Hamiltonian used 47.273 ms
Total time for projection: 47.287 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -1.063841773859392
    last  calculated eigval = 0.054888882322713
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06384177385939
lambda[   2] =  -0.91225236620172
lambda[   3] =  -0.57608704564124
lambda[   4] =  -0.46753570981134
lambda[   5] =  -0.46726597844200
lambda[   6] =  -0.40673498620870
lambda[   7] =  -0.30175788568737
lambda[   8] =  -0.25160891802009
lambda[   9] =  -0.07873702304853
lambda[  10] =  -0.04023739766818
lambda[  11] =  -0.03527053900099
lambda[  12] =   0.02179026403227
lambda[  13] =   0.03025773538253
lambda[  14] =   0.05488888232271
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.166 ms
rank =  0, subspace rotation using ScaLAPACK took 3.236 ms
rank =  0, Distributing orbital back into band + domain format took 12.080 ms
rank = 0, Subspace_Rotation used 15.328 ms

Total time for subspace rotation: 15.333 ms
rank = 0, Efermi =  -0.108193181440 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.120 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.949 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.107 ms
rank = 0, Calculating density took 1168.999 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.429 ms
rank = 0, D2D took 0.638 ms
rank = 0, Transfering density took 0.640 ms
Etot    =   -31.643715041051
Eband   =    -8.894169328883
E1      =    18.839301732447
E2      =    -8.536934189484
E3      =   -10.385752649963
Exc     =    -9.350027801510
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 8.958e-04, dEband = 5.793e-02
rank = 0, Calculating/Estimating energy took 1.084 ms, Etot = -31.643715041, dEtot = 8.958e-04, dEband = 5.793e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.0051473951986, which took 0.064 ms

iter_count = 102, r_2norm = 1.104e-04, tol*||rhs|| = 1.202e-04

Anderson update took 54.533 ms, out of which F'*F took 25.707 ms; b-Ax took 173.723 ms, out of which Lap took 156.013 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 377.988 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446728, int_b + int_rho = -1.819e-14, checking this took 0.159 ms
2-norm of RHS = 519.4936094369228, which took 0.161 ms

iter_count = 240, r_2norm = 4.782e-04, tol*||rhs|| = 5.195e-04

Anderson update took 128.115 ms, out of which F'*F took 61.445 ms; b-Ax took 414.529 ms, out of which Lap took 372.253 ms
Solving Poisson took 868.207 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.085794 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.096191 
Total time for convolution: 	 convolve: 5.079580 
Total time for convolution: 	 convolve: 5.090017 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.358 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.196 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.711 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.684 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.014 ms

This SCF took 26766.818 ms, scf error = 1.252e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.154889, lowerbound = -1.063842, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1159.896 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.725 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.414 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.061 ms
rank =  0, Distribute data + matrix mult took 14.213 ms
rank =  0, finding HY took 18.189 ms
rank =  0, distributing HY into block cyclic form took 12.642 ms
rank =  0, finding Y'*HY took 2.326 ms
Rank 0, Project_Hamiltonian used 47.400 ms
Total time for projection: 47.419 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.045 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -1.061953064964812
    last  calculated eigval = 0.045590881847542
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06195306496481
lambda[   2] =  -0.90954940647468
lambda[   3] =  -0.57268502534412
lambda[   4] =  -0.46597703257078
lambda[   5] =  -0.46551324002698
lambda[   6] =  -0.40453568906082
lambda[   7] =  -0.29875377075603
lambda[   8] =  -0.24903172105841
lambda[   9] =  -0.07725693195881
lambda[  10] =  -0.03848573759084
lambda[  11] =  -0.03624209367612
lambda[  12] =   0.01840442912476
lambda[  13] =   0.02756950339692
lambda[  14] =   0.04559088184754
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.166 ms
rank =  0, subspace rotation using ScaLAPACK took 3.282 ms
rank =  0, Distributing orbital back into band + domain format took 12.095 ms
rank = 0, Subspace_Rotation used 15.389 ms

Total time for subspace rotation: 15.393 ms
rank = 0, Efermi =  -0.106713090286 calculate fermi energy took 0.200 ms
rank = 0, --- Calculate rho: sum over local bands took 2.128 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.720 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.074 ms
rank = 0, Calculating density took 1226.061 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.483 ms
rank = 0, D2D took 0.764 ms
rank = 0, Transfering density took 0.768 ms
Etot    =   -31.643277648080
Eband   =    -8.855997901631
E1      =    18.819570148238
E2      =    -8.515727317010
E3      =   -10.397110155802
Exc     =    -9.358180884947
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 1.093e-04, dEband = 9.543e-03
rank = 0, Calculating/Estimating energy took 1.814 ms, Etot = -31.643277648, dEtot = 1.093e-04, dEband = 9.543e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7745837468941, which took 0.061 ms

iter_count = 114, r_2norm = 1.905e-05, tol*||rhs|| = 3.098e-05

Anderson update took 60.621 ms, out of which F'*F took 28.822 ms; b-Ax took 195.092 ms, out of which Lap took 175.281 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.086 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446733, int_b + int_rho = 3.456e-14, checking this took 0.101 ms
2-norm of RHS = 520.4704477653449, which took 0.096 ms

iter_count = 252, r_2norm = 5.025e-04, tol*||rhs|| = 5.205e-04

Anderson update took 135.598 ms, out of which F'*F took 63.555 ms; b-Ax took 442.698 ms, out of which Lap took 398.586 ms
Solving Poisson took 917.547 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.093323 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Total time for convolution: 	 convolve: 5.118490 
Total time for convolution: 	 convolve: 5.081240 
Total time for convolution: 	 convolve: 5.081627 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.618 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.646 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 0.688 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.009 ms

This SCF took 26931.229 ms, scf error = 8.210e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.145591, lowerbound = -1.061953, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1168.182 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.558 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.412 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 14.015 ms
rank =  0, finding HY took 18.177 ms
rank =  0, distributing HY into block cyclic form took 12.585 ms
rank =  0, finding Y'*HY took 2.076 ms
Rank 0, Project_Hamiltonian used 46.881 ms
Total time for projection: 46.952 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -1.061712383061609
    last  calculated eigval = 0.037916370267371
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06171238306161
lambda[   2] =  -0.90832646946312
lambda[   3] =  -0.57040867549681
lambda[   4] =  -0.46545725058242
lambda[   5] =  -0.46484438582442
lambda[   6] =  -0.40293363458617
lambda[   7] =  -0.29668346503485
lambda[   8] =  -0.24728438009488
lambda[   9] =  -0.07653526030132
lambda[  10] =  -0.03747215621104
lambda[  11] =  -0.03684207405326
lambda[  12] =   0.01599766225456
lambda[  13] =   0.02594506221334
lambda[  14] =   0.03791637026737
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 3.368 ms
rank =  0, Distributing orbital back into band + domain format took 12.053 ms
rank = 0, Subspace_Rotation used 15.436 ms

Total time for subspace rotation: 15.439 ms
rank = 0, Efermi =  -0.105991418667 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.119 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.747 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.073 ms
rank = 0, Calculating density took 1233.853 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.528 ms
rank = 0, D2D took 1.637 ms
rank = 0, Transfering density took 1.645 ms
Etot    =   -31.642916239786
Eband   =    -8.835301289396
E1      =    18.827566763352
E2      =    -8.484757347462
E3      =   -10.402023150204
Exc     =    -9.360455728856
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 9.035e-05, dEband = 5.174e-03
rank = 0, Calculating/Estimating energy took 0.886 ms, Etot = -31.642916240, dEtot = 9.035e-05, dEband = 5.174e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5937078252730, which took 0.051 ms

iter_count = 108, r_2norm = 1.907e-05, tol*||rhs|| = 2.375e-05

Anderson update took 57.627 ms, out of which F'*F took 27.365 ms; b-Ax took 184.487 ms, out of which Lap took 165.946 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.287 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446725, int_b + int_rho = -4.184e-14, checking this took 0.134 ms
2-norm of RHS = 520.5163838042479, which took 0.129 ms

iter_count = 228, r_2norm = 4.344e-04, tol*||rhs|| = 5.205e-04

Anderson update took 121.371 ms, out of which F'*F took 57.320 ms; b-Ax took 389.365 ms, out of which Lap took 349.252 ms
Solving Poisson took 819.745 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.107399 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.138914 
Total time for convolution: 	 convolve: 5.100741 
Total time for convolution: 	 convolve: 5.152268 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.586 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.553 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.664 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.971 ms

This SCF took 26949.792 ms, scf error = 3.230e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.137916, lowerbound = -1.061712, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1158.478 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.533 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.399 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.078 ms
rank =  0, Distribute data + matrix mult took 14.021 ms
rank =  0, finding HY took 18.412 ms
rank =  0, distributing HY into block cyclic form took 12.685 ms
rank =  0, finding Y'*HY took 2.070 ms
Rank 0, Project_Hamiltonian used 47.220 ms
Total time for projection: 47.233 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -1.060533290706441
    last  calculated eigval = 0.033337940496183
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06053329070644
lambda[   2] =  -0.90752172230561
lambda[   3] =  -0.57022953252585
lambda[   4] =  -0.46438109302585
lambda[   5] =  -0.46385041103971
lambda[   6] =  -0.40125025253239
lambda[   7] =  -0.29607619301668
lambda[   8] =  -0.24657606103994
lambda[   9] =  -0.07545327240177
lambda[  10] =  -0.03727795070790
lambda[  11] =  -0.03651662767968
lambda[  12] =   0.01431202306983
lambda[  13] =   0.02486585383065
lambda[  14] =   0.03333794049618
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 3.321 ms
rank =  0, Distributing orbital back into band + domain format took 12.074 ms
rank = 0, Subspace_Rotation used 15.408 ms

Total time for subspace rotation: 15.412 ms
rank = 0, Efermi =  -0.104909430764 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.127 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.831 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.762 ms
rank = 0, Calculating density took 1225.608 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.411 ms
rank = 0, D2D took 0.525 ms
rank = 0, Transfering density took 0.531 ms
Etot    =   -31.642918714999
Eband   =    -8.820837113477
E1      =    18.820980516902
E2      =    -8.476100544104
E3      =   -10.404453663504
Exc     =    -9.362109843480
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 6.188e-07, dEband = 3.616e-03
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -31.642918715, dEtot = 6.188e-07, dEband = 3.616e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2272823634603, which took 0.084 ms

iter_count = 114, r_2norm = 5.753e-06, tol*||rhs|| = 9.091e-06

Anderson update took 61.656 ms, out of which F'*F took 28.730 ms; b-Ax took 193.802 ms, out of which Lap took 174.149 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.242 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446728, int_b + int_rho = -1.819e-14, checking this took 0.107 ms
2-norm of RHS = 520.5638971163189, which took 0.078 ms

iter_count = 240, r_2norm = 4.616e-04, tol*||rhs|| = 5.206e-04

Anderson update took 128.086 ms, out of which F'*F took 60.157 ms; b-Ax took 407.552 ms, out of which Lap took 365.411 ms
Solving Poisson took 861.713 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.127481 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.149 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.143732 
Total time for convolution: 	 convolve: 5.102008 
Total time for convolution: 	 convolve: 5.108113 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.054 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 0.687 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.291 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.992 ms

This SCF took 27018.974 ms, scf error = 2.272e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.133338, lowerbound = -1.060533, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1150.644 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.606 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.423 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.078 ms
rank =  0, Distribute data + matrix mult took 14.119 ms
rank =  0, finding HY took 18.305 ms
rank =  0, distributing HY into block cyclic form took 12.716 ms
rank =  0, finding Y'*HY took 2.024 ms
Rank 0, Project_Hamiltonian used 47.192 ms
Total time for projection: 47.207 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.164 ms
    first calculated eigval = -1.058617705050692
    last  calculated eigval = 0.031714312338286
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05861770505069
lambda[   2] =  -0.90545109205885
lambda[   3] =  -0.56850254674949
lambda[   4] =  -0.46252427952352
lambda[   5] =  -0.46197034810221
lambda[   6] =  -0.39923628720219
lambda[   7] =  -0.29397023644419
lambda[   8] =  -0.24457323746707
lambda[   9] =  -0.07377514638432
lambda[  10] =  -0.03689606570790
lambda[  11] =  -0.03467364775417
lambda[  12] =   0.01374350847336
lambda[  13] =   0.02545999320348
lambda[  14] =   0.03171431233829
==subpsace eigenproblem: bcast eigvals took 0.050 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 3.310 ms
rank =  0, Distributing orbital back into band + domain format took 12.161 ms
rank = 0, Subspace_Rotation used 15.892 ms

Total time for subspace rotation: 15.898 ms
rank = 0, Efermi =  -0.103231304745 calculate fermi energy took 0.603 ms
rank = 0, --- Calculate rho: sum over local bands took 1.848 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.498 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.063 ms
rank = 0, Calculating density took 1217.043 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.501 ms
rank = 0, D2D took 0.827 ms
rank = 0, Transfering density took 0.835 ms
Etot    =   -31.642958651006
Eband   =    -8.789691466264
E1      =    18.805045589854
E2      =    -8.459260201589
E3      =   -10.410086500117
Exc     =    -9.366152993750
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 9.984e-06, dEband = 7.786e-03
rank = 0, Calculating/Estimating energy took 0.951 ms, Etot = -31.642958651, dEtot = 9.984e-06, dEband = 7.786e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1660348155206, which took 0.048 ms

iter_count = 108, r_2norm = 6.498e-06, tol*||rhs|| = 6.641e-06

Anderson update took 57.602 ms, out of which F'*F took 27.333 ms; b-Ax took 184.132 ms, out of which Lap took 165.210 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.871 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446727, int_b + int_rho = -2.365e-14, checking this took 0.111 ms
2-norm of RHS = 520.5169672603524, which took 0.104 ms

iter_count = 216, r_2norm = 4.684e-04, tol*||rhs|| = 5.205e-04

Anderson update took 114.949 ms, out of which F'*F took 54.158 ms; b-Ax took 367.733 ms, out of which Lap took 329.199 ms
Solving Poisson took 775.361 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.164619 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.134254 
Total time for convolution: 	 convolve: 5.085144 
Total time for convolution: 	 convolve: 5.150103 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.015 ms
======D2D: initiated sending and receiving took 1.369 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.976 ms

This SCF took 26927.708 ms, scf error = 1.087e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.131714, lowerbound = -1.058618, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1156.968 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.593 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.412 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.026 ms
rank =  0, finding HY took 18.392 ms
rank =  0, distributing HY into block cyclic form took 12.708 ms
rank =  0, finding Y'*HY took 2.038 ms
Rank 0, Project_Hamiltonian used 47.194 ms
Total time for projection: 47.210 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -1.057396571430217
    last  calculated eigval = 0.031391667185183
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05739657143022
lambda[   2] =  -0.90439957260985
lambda[   3] =  -0.56763886912915
lambda[   4] =  -0.46141729290004
lambda[   5] =  -0.46086977454039
lambda[   6] =  -0.39796601738235
lambda[   7] =  -0.29295789277625
lambda[   8] =  -0.24358821573526
lambda[   9] =  -0.07269762966795
lambda[  10] =  -0.03571401178609
lambda[  11] =  -0.03362543421909
lambda[  12] =   0.01341368944587
lambda[  13] =   0.02685076330944
lambda[  14] =   0.03139166718518
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 4.023 ms
rank =  0, Distributing orbital back into band + domain format took 11.163 ms
rank = 0, Subspace_Rotation used 15.204 ms

Total time for subspace rotation: 15.234 ms
rank = 0, Efermi =  -0.102153787998 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.148 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.709 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.075 ms
rank = 0, Calculating density took 1223.181 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.494 ms
rank = 0, D2D took 0.694 ms
rank = 0, Transfering density took 0.701 ms
Etot    =   -31.643028933057
Eband   =    -8.772468414059
E1      =    18.794893734236
E2      =    -8.451600782717
E3      =   -10.412521885186
Exc     =    -9.368070438586
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 1.757e-05, dEband = 4.306e-03
rank = 0, Calculating/Estimating energy took 1.041 ms, Etot = -31.643028933, dEtot = 1.757e-05, dEband = 4.306e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0988499070029, which took 0.093 ms

iter_count = 108, r_2norm = 3.638e-06, tol*||rhs|| = 3.954e-06

Anderson update took 57.959 ms, out of which F'*F took 27.353 ms; b-Ax took 184.078 ms, out of which Lap took 165.290 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.105 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446730, int_b + int_rho = 9.095e-15, checking this took 0.131 ms
2-norm of RHS = 520.5452962324796, which took 0.087 ms

iter_count = 210, r_2norm = 4.293e-04, tol*||rhs|| = 5.205e-04

Anderson update took 111.660 ms, out of which F'*F took 52.556 ms; b-Ax took 357.605 ms, out of which Lap took 320.187 ms
Solving Poisson took 754.369 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.095569 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.103511 
Total time for convolution: 	 convolve: 5.166369 
Total time for convolution: 	 convolve: 5.089001 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.409 ms
---Transfer Veff_loc: D2D took 0.672 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.993 ms

This SCF took 26834.102 ms, scf error = 7.315e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.131392, lowerbound = -1.057397, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1157.771 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.614 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.419 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.052 ms
rank =  0, finding HY took 18.389 ms
rank =  0, distributing HY into block cyclic form took 12.720 ms
rank =  0, finding Y'*HY took 2.022 ms
Rank 0, Project_Hamiltonian used 47.209 ms
Total time for projection: 47.222 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.147 ms
    first calculated eigval = -1.057052434929902
    last  calculated eigval = 0.032086352094362
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05705243492990
lambda[   2] =  -0.90405355603859
lambda[   3] =  -0.56720504107960
lambda[   4] =  -0.46101004085169
lambda[   5] =  -0.46046106474624
lambda[   6] =  -0.39767623565616
lambda[   7] =  -0.29253374716868
lambda[   8] =  -0.24318249529608
lambda[   9] =  -0.07225501666006
lambda[  10] =  -0.03347505170450
lambda[  11] =  -0.03320097737112
lambda[  12] =   0.01378058656633
lambda[  13] =   0.02905428144762
lambda[  14] =   0.03208635209436
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 3.220 ms
rank =  0, Distributing orbital back into band + domain format took 10.974 ms
rank = 0, Subspace_Rotation used 14.217 ms

Total time for subspace rotation: 14.791 ms
rank = 0, Efermi =  -0.101711175050 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.103 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.771 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1224.119 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.494 ms
rank = 0, D2D took 0.797 ms
rank = 0, Transfering density took 0.807 ms
Etot    =   -31.643084118044
Eband   =    -8.766349232579
E1      =    18.793408861099
E2      =    -8.447026867188
E3      =   -10.412105307603
Exc     =    -9.367769438803
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 1.380e-05, dEband = 1.530e-03
rank = 0, Calculating/Estimating energy took 0.965 ms, Etot = -31.643084118, dEtot = 1.380e-05, dEband = 1.530e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0686316919076, which took 0.066 ms

iter_count = 108, r_2norm = 2.349e-06, tol*||rhs|| = 2.745e-06

Anderson update took 57.806 ms, out of which F'*F took 27.081 ms; b-Ax took 183.790 ms, out of which Lap took 164.875 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.027 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446725, int_b + int_rho = -4.729e-14, checking this took 0.150 ms
2-norm of RHS = 520.5640786935352, which took 0.081 ms

iter_count = 204, r_2norm = 4.378e-04, tol*||rhs|| = 5.206e-04

Anderson update took 108.564 ms, out of which F'*F took 51.457 ms; b-Ax took 347.113 ms, out of which Lap took 310.718 ms
Solving Poisson took 732.599 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.077490 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.939 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.114219 
Total time for convolution: 	 convolve: 5.124840 
Total time for convolution: 	 convolve: 5.081266 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.339 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.402 ms
---Transfer Veff_loc: D2D took 0.667 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.992 ms

This SCF took 26789.046 ms, scf error = 4.941e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.132086, lowerbound = -1.057052, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1154.109 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.502 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.429 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 13.948 ms
rank =  0, finding HY took 18.587 ms
rank =  0, distributing HY into block cyclic form took 12.782 ms
rank =  0, finding Y'*HY took 2.015 ms
Rank 0, Project_Hamiltonian used 47.361 ms
Total time for projection: 47.376 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.594 ms
rank = 0, Solve_Generalized_EigenProblem used 1.537 ms
    first calculated eigval = -1.056317915819829
    last  calculated eigval = 0.034056127642240
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05631791581983
lambda[   2] =  -0.90330482717583
lambda[   3] =  -0.56653569323794
lambda[   4] =  -0.46028109820267
lambda[   5] =  -0.45975065517685
lambda[   6] =  -0.39696355241504
lambda[   7] =  -0.29184705865099
lambda[   8] =  -0.24248694963223
lambda[   9] =  -0.07152994986239
lambda[  10] =  -0.03252680079696
lambda[  11] =  -0.02988943558174
lambda[  12] =   0.01465246444424
lambda[  13] =   0.03077425302717
lambda[  14] =   0.03405612764224
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 1.556 ms
rank =  0, subspace rotation using ScaLAPACK took 3.327 ms
rank =  0, Distributing orbital back into band + domain format took 12.082 ms
rank = 0, Subspace_Rotation used 15.420 ms

Total time for subspace rotation: 15.425 ms
rank = 0, Efermi =  -0.100986108229 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.125 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.765 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1221.579 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
rank = 0, D2D took 0.759 ms
rank = 0, Transfering density took 0.769 ms
Etot    =   -31.643155123399
Eband   =    -8.754975501658
E1      =    18.787901241832
E2      =    -8.440908277424
E3      =   -10.413018232581
Exc     =    -9.368500891026
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 1.775e-05, dEband = 2.843e-03
rank = 0, Calculating/Estimating energy took 0.980 ms, Etot = -31.643155123, dEtot = 1.775e-05, dEband = 2.843e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0559960489665, which took 0.077 ms

iter_count = 108, r_2norm = 2.122e-06, tol*||rhs|| = 2.240e-06

Anderson update took 57.258 ms, out of which F'*F took 27.089 ms; b-Ax took 183.915 ms, out of which Lap took 164.839 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.829 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446728, int_b + int_rho = -2.183e-14, checking this took 0.107 ms
2-norm of RHS = 520.5544120829710, which took 0.098 ms

iter_count = 162, r_2norm = 4.617e-04, tol*||rhs|| = 5.206e-04

Anderson update took 86.680 ms, out of which F'*F took 40.537 ms; b-Ax took 278.692 ms, out of which Lap took 250.368 ms
Solving Poisson took 584.137 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.083216 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.795 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.204 ms
Total time for convolution: 	 convolve: 5.089937 
Total time for convolution: 	 convolve: 5.077677 
Total time for convolution: 	 convolve: 5.094349 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.312 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.465 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.690 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.009 ms

This SCF took 26563.938 ms, scf error = 3.273e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.134056, lowerbound = -1.056318, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1158.613 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.564 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.437 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.020 ms
rank =  0, finding HY took 18.291 ms
rank =  0, distributing HY into block cyclic form took 12.390 ms
rank =  0, finding Y'*HY took 1.774 ms
Rank 0, Project_Hamiltonian used 47.725 ms
Total time for projection: 47.739 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.147 ms
    first calculated eigval = -1.055999463332165
    last  calculated eigval = 0.034436940382907
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05599946333216
lambda[   2] =  -0.90300368686566
lambda[   3] =  -0.56629468247385
lambda[   4] =  -0.45999115145305
lambda[   5] =  -0.45946576523975
lambda[   6] =  -0.39666046808979
lambda[   7] =  -0.29158328485619
lambda[   8] =  -0.24221987925466
lambda[   9] =  -0.07127419037952
lambda[  10] =  -0.03232199804316
lambda[  11] =  -0.02905296907993
lambda[  12] =   0.01440559836181
lambda[  13] =   0.03055043761752
lambda[  14] =   0.03443694038291
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 3.314 ms
rank =  0, Distributing orbital back into band + domain format took 12.114 ms
rank = 0, Subspace_Rotation used 15.441 ms

Total time for subspace rotation: 15.445 ms
rank = 0, Efermi =  -0.100730348693 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.119 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.751 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.074 ms
rank = 0, Calculating density took 1225.069 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.473 ms
rank = 0, D2D took 0.773 ms
rank = 0, Transfering density took 0.785 ms
Etot    =   -31.643180422518
Eband   =    -8.750436764161
E1      =    18.785130589224
E2      =    -8.438992079749
E3      =   -10.413627789527
Exc     =    -9.368987634305
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 6.325e-06, dEband = 1.135e-03
rank = 0, Calculating/Estimating energy took 0.987 ms, Etot = -31.643180423, dEtot = 6.325e-06, dEband = 1.135e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0364879257131, which took 0.086 ms

iter_count = 108, r_2norm = 1.403e-06, tol*||rhs|| = 1.460e-06

Anderson update took 57.799 ms, out of which F'*F took 27.110 ms; b-Ax took 184.309 ms, out of which Lap took 165.421 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.892 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446730, int_b + int_rho = 0.000e+00, checking this took 0.107 ms
2-norm of RHS = 520.5681813905220, which took 0.092 ms

iter_count = 174, r_2norm = 4.979e-04, tol*||rhs|| = 5.206e-04

Anderson update took 92.795 ms, out of which F'*F took 43.511 ms; b-Ax took 295.935 ms, out of which Lap took 264.892 ms
Solving Poisson took 624.907 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.087648 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.078709 
Total time for convolution: 	 convolve: 5.098333 
Total time for convolution: 	 convolve: 5.088685 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.408 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.005 ms

This SCF took 26621.925 ms, scf error = 2.443e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134437, lowerbound = -1.055999, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1155.593 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.161 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.350 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 13.534 ms
rank =  0, finding HY took 18.480 ms
rank =  0, distributing HY into block cyclic form took 12.742 ms
rank =  0, finding Y'*HY took 2.009 ms
Rank 0, Project_Hamiltonian used 48.021 ms
Total time for projection: 48.041 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -1.055726049110945
    last  calculated eigval = 0.036007437836084
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05572604911095
lambda[   2] =  -0.90274196836365
lambda[   3] =  -0.56602113156861
lambda[   4] =  -0.45971455152013
lambda[   5] =  -0.45919066881114
lambda[   6] =  -0.39641276326536
lambda[   7] =  -0.29130916492192
lambda[   8] =  -0.24195045976783
lambda[   9] =  -0.07103397921981
lambda[  10] =  -0.03214483652626
lambda[  11] =  -0.02784722298915
lambda[  12] =   0.01441047623441
lambda[  13] =   0.03162541186628
lambda[  14] =   0.03600743783608
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 3.367 ms
rank =  0, Distributing orbital back into band + domain format took 12.193 ms
rank = 0, Subspace_Rotation used 15.574 ms

Total time for subspace rotation: 15.578 ms
rank = 0, Efermi =  -0.100490137577 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.149 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.704 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.075 ms
rank = 0, Calculating density took 1222.475 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.488 ms
rank = 0, D2D took 0.709 ms
rank = 0, Transfering density took 0.717 ms
Etot    =   -31.643222680448
Eband   =    -8.746133515687
E1      =    18.783388971067
E2      =    -8.436357528355
E3      =   -10.413737978809
Exc     =    -9.369067160439
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 1.056e-05, dEband = 1.076e-03
rank = 0, Calculating/Estimating energy took 1.003 ms, Etot = -31.643222680, dEtot = 1.056e-05, dEband = 1.076e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0357678813346, which took 0.122 ms

iter_count = 108, r_2norm = 1.242e-06, tol*||rhs|| = 1.431e-06

Anderson update took 57.661 ms, out of which F'*F took 27.079 ms; b-Ax took 184.029 ms, out of which Lap took 164.991 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.776 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446729, int_b + int_rho = -1.819e-15, checking this took 0.095 ms
2-norm of RHS = 520.5693996208088, which took 0.102 ms

iter_count = 144, r_2norm = 4.751e-04, tol*||rhs|| = 5.206e-04

Anderson update took 76.880 ms, out of which F'*F took 35.827 ms; b-Ax took 244.437 ms, out of which Lap took 218.697 ms
Solving Poisson took 517.559 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.103 ms
Total time for convolution: 	 convolve: 5.084452 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.085474 
Total time for convolution: 	 convolve: 5.124038 
Total time for convolution: 	 convolve: 5.082065 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.391 ms
---Transfer Veff_loc: D2D took 0.647 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.959 ms

This SCF took 26518.421 ms, scf error = 1.877e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136007, lowerbound = -1.055726, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1151.066 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.552 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.388 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.049 ms
rank =  0, Distribute data + matrix mult took 14.002 ms
rank =  0, finding HY took 18.382 ms
rank =  0, distributing HY into block cyclic form took 12.729 ms
rank =  0, finding Y'*HY took 2.006 ms
Rank 0, Project_Hamiltonian used 47.149 ms
Total time for projection: 47.163 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -1.055703100804253
    last  calculated eigval = 0.037144349831875
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05570310080425
lambda[   2] =  -0.90272475275161
lambda[   3] =  -0.56598184338365
lambda[   4] =  -0.45968116739882
lambda[   5] =  -0.45915385612009
lambda[   6] =  -0.39637194477087
lambda[   7] =  -0.29126600608479
lambda[   8] =  -0.24191316329195
lambda[   9] =  -0.07100579669146
lambda[  10] =  -0.03212830052797
lambda[  11] =  -0.02722811840138
lambda[  12] =   0.01448146668267
lambda[  13] =   0.03250359666686
lambda[  14] =   0.03714434983187
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 3.302 ms
rank =  0, Distributing orbital back into band + domain format took 12.113 ms
rank = 0, Subspace_Rotation used 15.426 ms

Total time for subspace rotation: 15.430 ms
rank = 0, Efermi =  -0.100461955023 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.110 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.804 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1216.958 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.487 ms
rank = 0, D2D took 0.785 ms
rank = 0, Transfering density took 0.795 ms
Etot    =   -31.643235107156
Eband   =    -8.745591670239
E1      =    18.783317906978
E2      =    -8.435913426430
E3      =   -10.413591857283
Exc     =    -9.368960145056
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 3.107e-06, dEband = 1.355e-04
rank = 0, Calculating/Estimating energy took 0.963 ms, Etot = -31.643235107, dEtot = 3.107e-06, dEband = 1.355e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0373017924796, which took 0.075 ms

iter_count = 108, r_2norm = 1.232e-06, tol*||rhs|| = 1.492e-06

Anderson update took 57.996 ms, out of which F'*F took 27.112 ms; b-Ax took 183.671 ms, out of which Lap took 164.901 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.352 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446735, int_b + int_rho = 5.821e-14, checking this took 0.131 ms
2-norm of RHS = 520.5697746294069, which took 0.104 ms

iter_count = 84, r_2norm = 4.689e-04, tol*||rhs|| = 5.206e-04

Anderson update took 44.617 ms, out of which F'*F took 20.956 ms; b-Ax took 142.509 ms, out of which Lap took 127.577 ms
Solving Poisson took 304.271 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.104799 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.097716 
Total time for convolution: 	 convolve: 5.123916 
Total time for convolution: 	 convolve: 5.099684 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.454 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.497 ms

This SCF took 26354.244 ms, scf error = 2.070e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.137144, lowerbound = -1.055703, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1154.824 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.575 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.421 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 14.035 ms
rank =  0, finding HY took 18.260 ms
rank =  0, distributing HY into block cyclic form took 12.808 ms
rank =  0, finding Y'*HY took 1.989 ms
Rank 0, Project_Hamiltonian used 47.117 ms
Total time for projection: 47.132 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -1.055691233683826
    last  calculated eigval = 0.036761910776161
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05569123368383
lambda[   2] =  -0.90271289981550
lambda[   3] =  -0.56597938163859
lambda[   4] =  -0.45967076243774
lambda[   5] =  -0.45914508351802
lambda[   6] =  -0.39636549578850
lambda[   7] =  -0.29126125385267
lambda[   8] =  -0.24190620016742
lambda[   9] =  -0.07099446607506
lambda[  10] =  -0.03211330322073
lambda[  11] =  -0.02737470767405
lambda[  12] =   0.01409227026278
lambda[  13] =   0.03222140315902
lambda[  14] =   0.03676191077616
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.296 ms
rank =  0, Distributing orbital back into band + domain format took 12.060 ms
rank = 0, Subspace_Rotation used 15.366 ms

Total time for subspace rotation: 15.371 ms
rank = 0, Efermi =  -0.100450624385 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.096 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.763 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1220.520 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.467 ms
rank = 0, D2D took 0.819 ms
rank = 0, Transfering density took 0.823 ms
Etot    =   -31.643233103682
Eband   =    -8.745464622832
E1      =    18.783235805329
E2      =    -8.435859466941
E3      =   -10.413628036344
Exc     =    -9.368985306913
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 5.009e-07, dEband = 3.176e-05
rank = 0, Calculating/Estimating energy took 0.996 ms, Etot = -31.643233104, dEtot = 5.009e-07, dEband = 3.176e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0342210971301, which took 0.079 ms

iter_count = 108, r_2norm = 1.254e-06, tol*||rhs|| = 1.369e-06

Anderson update took 57.775 ms, out of which F'*F took 27.100 ms; b-Ax took 184.174 ms, out of which Lap took 165.135 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.784 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446733, int_b + int_rho = 3.092e-14, checking this took 0.131 ms
2-norm of RHS = 520.5698170789894, which took 0.062 ms

iter_count = 108, r_2norm = 4.833e-04, tol*||rhs|| = 5.206e-04

Anderson update took 57.658 ms, out of which F'*F took 27.108 ms; b-Ax took 183.884 ms, out of which Lap took 164.877 ms
Solving Poisson took 389.188 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.110505 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.076206 
Total time for convolution: 	 convolve: 5.087971 
Total time for convolution: 	 convolve: 5.080158 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.042 ms
---Transfer Veff_loc: D2D took 1.492 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.307 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.815 ms

This SCF took 26370.254 ms, scf error = 2.028e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136762, lowerbound = -1.055691, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1154.341 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.217 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.408 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.055 ms
rank =  0, Distribute data + matrix mult took 18.693 ms
rank =  0, finding HY took 18.404 ms
rank =  0, distributing HY into block cyclic form took 12.727 ms
rank =  0, finding Y'*HY took 2.016 ms
Rank 0, Project_Hamiltonian used 51.867 ms
Total time for projection: 51.881 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -1.055729933519582
    last  calculated eigval = 0.036417236273444
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05572993351958
lambda[   2] =  -0.90275062263141
lambda[   3] =  -0.56600958581594
lambda[   4] =  -0.45971052911023
lambda[   5] =  -0.45918454506130
lambda[   6] =  -0.39640898445260
lambda[   7] =  -0.29130006702892
lambda[   8] =  -0.24194404293389
lambda[   9] =  -0.07103578758982
lambda[  10] =  -0.03215548055143
lambda[  11] =  -0.02763407217793
lambda[  12] =   0.01379128823200
lambda[  13] =   0.03189659842620
lambda[  14] =   0.03641723627344
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.314 ms
rank =  0, Distributing orbital back into band + domain format took 12.126 ms
rank = 0, Subspace_Rotation used 15.452 ms

Total time for subspace rotation: 15.456 ms
rank = 0, Efermi =  -0.100491945939 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.151 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.745 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1224.912 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.449 ms
rank = 0, D2D took 0.799 ms
rank = 0, Transfering density took 0.803 ms
Etot    =   -31.643230803056
Eband   =    -8.746076622135
E1      =    18.783528020779
E2      =    -8.436195536878
E3      =   -10.413571240940
Exc     =    -9.368942496966
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 5.752e-07, dEband = 1.530e-04
rank = 0, Calculating/Estimating energy took 0.987 ms, Etot = -31.643230803, dEtot = 5.752e-07, dEband = 1.530e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0343342154215, which took 0.064 ms

iter_count = 108, r_2norm = 1.214e-06, tol*||rhs|| = 1.373e-06

Anderson update took 58.105 ms, out of which F'*F took 27.154 ms; b-Ax took 183.878 ms, out of which Lap took 165.041 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.716 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446731, int_b + int_rho = 1.273e-14, checking this took 0.120 ms
2-norm of RHS = 520.5708798764510, which took 0.106 ms

iter_count = 96, r_2norm = 5.113e-04, tol*||rhs|| = 5.206e-04

Anderson update took 51.013 ms, out of which F'*F took 24.176 ms; b-Ax took 163.023 ms, out of which Lap took 145.988 ms
Solving Poisson took 345.828 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.077082 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.108886 
Total time for convolution: 	 convolve: 5.285803 
Total time for convolution: 	 convolve: 5.095639 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.294 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.484 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 0.693 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.290 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.997 ms

This SCF took 26571.887 ms, scf error = 2.039e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.136417, lowerbound = -1.055730, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1121.984 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 26.663 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.424 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.049 ms
rank =  0, Distribute data + matrix mult took 28.151 ms
rank =  0, finding HY took 18.567 ms
rank =  0, distributing HY into block cyclic form took 12.730 ms
rank =  0, finding Y'*HY took 2.015 ms
Rank 0, Project_Hamiltonian used 61.494 ms
Total time for projection: 61.508 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -1.055709080283989
    last  calculated eigval = 0.036458692510538
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05570908028399
lambda[   2] =  -0.90273052005671
lambda[   3] =  -0.56599052066989
lambda[   4] =  -0.45968976270702
lambda[   5] =  -0.45916262071208
lambda[   6] =  -0.39637733070335
lambda[   7] =  -0.29127386333093
lambda[   8] =  -0.24192020387013
lambda[   9] =  -0.07100976553813
lambda[  10] =  -0.03213105981491
lambda[  11] =  -0.02753880074142
lambda[  12] =   0.01370941348260
lambda[  13] =   0.03200601436912
lambda[  14] =   0.03645869251054
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 3.292 ms
rank =  0, Distributing orbital back into band + domain format took 12.058 ms
rank = 0, Subspace_Rotation used 15.361 ms

Total time for subspace rotation: 15.366 ms
rank = 0, Efermi =  -0.100465923856 calculate fermi energy took 0.081 ms
rank = 0, --- Calculate rho: sum over local bands took 2.116 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.748 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.075 ms
rank = 0, Calculating density took 1202.130 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.473 ms
rank = 0, D2D took 0.743 ms
rank = 0, Transfering density took 0.752 ms
Etot    =   -31.643230011198
Eband   =    -8.745707805696
E1      =    18.783372483439
E2      =    -8.435964555992
E3      =   -10.413639896742
Exc     =    -9.368992659124
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 1.980e-07, dEband = 9.220e-05
rank = 0, Calculating/Estimating energy took 1.437 ms, Etot = -31.643230011, dEtot = 1.980e-07, dEband = 9.220e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0379789388499, which took 0.059 ms

iter_count = 108, r_2norm = 1.191e-06, tol*||rhs|| = 1.519e-06

Anderson update took 57.492 ms, out of which F'*F took 28.397 ms; b-Ax took 185.200 ms, out of which Lap took 166.419 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.531 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446735, int_b + int_rho = 5.275e-14, checking this took 0.096 ms
2-norm of RHS = 520.5694937703728, which took 0.107 ms

iter_count = 102, r_2norm = 4.819e-04, tol*||rhs|| = 5.206e-04

Anderson update took 54.534 ms, out of which F'*F took 25.534 ms; b-Ax took 173.320 ms, out of which Lap took 155.198 ms
Solving Poisson took 367.864 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.090595 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.101614 
Total time for convolution: 	 convolve: 5.087893 
Total time for convolution: 	 convolve: 5.093714 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.141 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.671 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.999 ms

This SCF took 26341.042 ms, scf error = 2.082e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.136459, lowerbound = -1.055709, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1148.258 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.334 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.405 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 21.757 ms
rank =  0, finding HY took 18.383 ms
rank =  0, distributing HY into block cyclic form took 12.595 ms
rank =  0, finding Y'*HY took 2.089 ms
Rank 0, Project_Hamiltonian used 54.854 ms
Total time for projection: 54.870 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -1.055706350396866
    last  calculated eigval = 0.036264462485666
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05570635039687
lambda[   2] =  -0.90272601787360
lambda[   3] =  -0.56599245424104
lambda[   4] =  -0.45968999778911
lambda[   5] =  -0.45916461458073
lambda[   6] =  -0.39638765329543
lambda[   7] =  -0.29128216891403
lambda[   8] =  -0.24192491420167
lambda[   9] =  -0.07103327603136
lambda[  10] =  -0.03215756113097
lambda[  11] =  -0.02793673002967
lambda[  12] =   0.01349210734734
lambda[  13] =   0.03162410041303
lambda[  14] =   0.03626446248567
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 3.299 ms
rank =  0, Distributing orbital back into band + domain format took 12.171 ms
rank = 0, Subspace_Rotation used 15.482 ms

Total time for subspace rotation: 15.486 ms
rank = 0, Efermi =  -0.100489434430 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.152 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.764 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1221.878 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.510 ms
rank = 0, D2D took 1.795 ms
rank = 0, Transfering density took 1.804 ms
Etot    =   -31.643235387794
Eband   =    -8.745748343613
E1      =    18.783306289001
E2      =    -8.436067952836
E3      =   -10.413633441443
Exc     =    -9.368988244909
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 1.344e-06, dEband = 1.013e-05
rank = 0, Calculating/Estimating energy took 0.867 ms, Etot = -31.643235388, dEtot = 1.344e-06, dEband = 1.013e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0390301618133, which took 0.084 ms

iter_count = 108, r_2norm = 1.221e-06, tol*||rhs|| = 1.561e-06

Anderson update took 57.964 ms, out of which F'*F took 27.271 ms; b-Ax took 184.071 ms, out of which Lap took 165.347 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.436 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446729, int_b + int_rho = -7.276e-15, checking this took 0.106 ms
2-norm of RHS = 520.5725569801991, which took 0.097 ms

iter_count = 84, r_2norm = 4.888e-04, tol*||rhs|| = 5.206e-04

Anderson update took 44.833 ms, out of which F'*F took 20.880 ms; b-Ax took 143.316 ms, out of which Lap took 128.430 ms
Solving Poisson took 303.608 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.092209 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.223 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.136749 
Total time for convolution: 	 convolve: 5.097552 
Total time for convolution: 	 convolve: 5.087808 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.825 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.524 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.679 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 26343.324 ms, scf error = 1.888e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.136264, lowerbound = -1.055706, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.155 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.577 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.414 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.010 ms
rank =  0, finding HY took 18.327 ms
rank =  0, distributing HY into block cyclic form took 12.652 ms
rank =  0, finding Y'*HY took 2.069 ms
Rank 0, Project_Hamiltonian used 47.086 ms
Total time for projection: 47.101 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -1.055736713678600
    last  calculated eigval = 0.036618862572987
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05573671367860
lambda[   2] =  -0.90275207062888
lambda[   3] =  -0.56600788378182
lambda[   4] =  -0.45971255790788
lambda[   5] =  -0.45918673551591
lambda[   6] =  -0.39640586786045
lambda[   7] =  -0.29130030666048
lambda[   8] =  -0.24194305414571
lambda[   9] =  -0.07104679386177
lambda[  10] =  -0.03217189070366
lambda[  11] =  -0.02755597782869
lambda[  12] =   0.01358956552610
lambda[  13] =   0.03186781383751
lambda[  14] =   0.03661886257299
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 3.351 ms
rank =  0, Distributing orbital back into band + domain format took 12.011 ms
rank = 0, Subspace_Rotation used 15.376 ms

Total time for subspace rotation: 15.380 ms
rank = 0, Efermi =  -0.100502952253 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.129 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.790 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.075 ms
rank = 0, Calculating density took 1185.901 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.433 ms
rank = 0, D2D took 1.152 ms
rank = 0, Transfering density took 1.158 ms
Etot    =   -31.643233239698
Eband   =    -8.746090381387
E1      =    18.783617871906
E2      =    -8.436123355515
E3      =   -10.413534578352
Exc     =    -9.368912181532
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 5.370e-07, dEband = 8.551e-05
rank = 0, Calculating/Estimating energy took 0.885 ms, Etot = -31.643233240, dEtot = 5.370e-07, dEband = 8.551e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0365626362570, which took 0.049 ms

iter_count = 108, r_2norm = 1.140e-06, tol*||rhs|| = 1.463e-06

Anderson update took 57.792 ms, out of which F'*F took 27.151 ms; b-Ax took 184.781 ms, out of which Lap took 165.674 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.891 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446732, int_b + int_rho = 2.365e-14, checking this took 0.097 ms
2-norm of RHS = 520.5665905550427, which took 0.094 ms

iter_count = 120, r_2norm = 4.994e-04, tol*||rhs|| = 5.206e-04

Anderson update took 349.391 ms, out of which F'*F took 30.244 ms; b-Ax took 204.131 ms, out of which Lap took 183.062 ms
Solving Poisson took 717.920 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.124718 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.096766 
Total time for convolution: 	 convolve: 5.083872 
Total time for convolution: 	 convolve: 5.114671 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.065 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.678 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.286 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.977 ms

This SCF took 26726.194 ms, scf error = 2.108e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.136619, lowerbound = -1.055737, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1158.030 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.573 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.406 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 13.999 ms
rank =  0, finding HY took 18.251 ms
rank =  0, distributing HY into block cyclic form took 12.813 ms
rank =  0, finding Y'*HY took 1.992 ms
Rank 0, Project_Hamiltonian used 47.083 ms
Total time for projection: 47.100 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.100 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -1.055620044577703
    last  calculated eigval = 0.035999808723313
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05562004457770
lambda[   2] =  -0.90264370153352
lambda[   3] =  -0.56592770850824
lambda[   4] =  -0.45961622051463
lambda[   5] =  -0.45909361197156
lambda[   6] =  -0.39633409858542
lambda[   7] =  -0.29122377291532
lambda[   8] =  -0.24186446368046
lambda[   9] =  -0.07097725102382
lambda[  10] =  -0.03210190755853
lambda[  11] =  -0.02820244237882
lambda[  12] =   0.01326238723774
lambda[  13] =   0.03145359863517
lambda[  14] =   0.03599980872331
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 3.376 ms
rank =  0, Distributing orbital back into band + domain format took 16.158 ms
rank = 0, Subspace_Rotation used 19.550 ms

Total time for subspace rotation: 19.996 ms
rank = 0, Efermi =  -0.100433409332 calculate fermi energy took 0.599 ms
rank = 0, --- Calculate rho: sum over local bands took 2.078 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.848 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1228.966 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.494 ms
rank = 0, D2D took 0.753 ms
rank = 0, Transfering density took 0.762 ms
Etot    =   -31.643237242669
Eband   =    -8.744647245601
E1      =    18.782553676341
E2      =    -8.435666419440
E3      =   -10.413845876665
Exc     =    -9.369149486962
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 1.001e-06, dEband = 3.608e-04
rank = 0, Calculating/Estimating energy took 0.999 ms, Etot = -31.643237243, dEtot = 1.001e-06, dEband = 3.608e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0319812028456, which took 0.056 ms

iter_count = 108, r_2norm = 9.240e-07, tol*||rhs|| = 1.279e-06

Anderson update took 57.739 ms, out of which F'*F took 27.374 ms; b-Ax took 183.712 ms, out of which Lap took 164.934 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.048 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446731, int_b + int_rho = 2.001e-14, checking this took 0.152 ms
2-norm of RHS = 520.5672557590175, which took 0.104 ms

iter_count = 150, r_2norm = 4.762e-04, tol*||rhs|| = 5.206e-04

Anderson update took 80.412 ms, out of which F'*F took 37.740 ms; b-Ax took 254.855 ms, out of which Lap took 228.566 ms
Solving Poisson took 539.911 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.084898 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.079097 
Total time for convolution: 	 convolve: 5.087038 
Total time for convolution: 	 convolve: 5.099564 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.370 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.144 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.663 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.971 ms

This SCF took 26526.843 ms, scf error = 1.522e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.136000, lowerbound = -1.055620, upperbound = 267.573012

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1128.568 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.538 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.421 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.039 ms
rank =  0, Distribute data + matrix mult took 14.011 ms
rank =  0, finding HY took 18.328 ms
rank =  0, distributing HY into block cyclic form took 12.642 ms
rank =  0, finding Y'*HY took 2.058 ms
Rank 0, Project_Hamiltonian used 47.069 ms
Total time for projection: 47.084 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.165 ms
    first calculated eigval = -1.055374578243573
    last  calculated eigval = 0.035571383504667
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05537457824357
lambda[   2] =  -0.90240279151753
lambda[   3] =  -0.56572137312560
lambda[   4] =  -0.45939272257052
lambda[   5] =  -0.45887842372391
lambda[   6] =  -0.39615095508634
lambda[   7] =  -0.29103836608591
lambda[   8] =  -0.24167053837891
lambda[   9] =  -0.07081430771914
lambda[  10] =  -0.03195264855479
lambda[  11] =  -0.02895108323301
lambda[  12] =   0.01315016336127
lambda[  13] =   0.03099317804376
lambda[  14] =   0.03557138350467
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 4.043 ms
rank =  0, Distributing orbital back into band + domain format took 11.081 ms
rank = 0, Subspace_Rotation used 15.138 ms

Total time for subspace rotation: 15.146 ms
rank = 0, Efermi =  -0.100270466089 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.098 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.800 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1194.657 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.488 ms
rank = 0, D2D took 0.803 ms
rank = 0, Transfering density took 0.811 ms
Etot    =   -31.643248948136
Eband   =    -8.741259498489
E1      =    18.780613060730
E2      =    -8.434091559949
E3      =   -10.414313708515
Exc     =    -9.369501296288
Esc     =   -51.161506482113
Entropy =    -0.000000000439
dE = 2.926e-06, dEband = 8.469e-04
rank = 0, Calculating/Estimating energy took 0.972 ms, Etot = -31.643248948, dEtot = 2.926e-06, dEband = 8.469e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0216321010155, which took 0.048 ms

iter_count = 108, r_2norm = 5.789e-07, tol*||rhs|| = 8.653e-07

Anderson update took 57.707 ms, out of which F'*F took 26.956 ms; b-Ax took 183.749 ms, out of which Lap took 164.734 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.016 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001446730, int_rho =  16.00000001446725, int_b + int_rho = -4.184e-14, checking this took 0.092 ms
2-norm of RHS = 520.5701052751166, which took 0.088 ms

iter_count = 156, r_2norm = 4.389e-04, tol*||rhs|| = 5.206e-04

Anderson update took 82.882 ms, out of which F'*F took 38.971 ms; b-Ax took 265.300 ms, out of which Lap took 237.473 ms
Solving Poisson took 561.289 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.094226 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.081464 
Total time for convolution: 	 convolve: 5.085739 
Total time for convolution: 	 convolve: 5.082862 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.549 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
---Transfer Veff_loc: D2D took 0.707 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.319 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.040 ms

This SCF took 26550.468 ms, scf error = 9.892e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -1.05537457824357, occ[   1] =   2.00000000000000
lambda[   2] =  -0.90240279151753, occ[   2] =   2.00000000000000
lambda[   3] =  -0.56572137312560, occ[   3] =   2.00000000000000
lambda[   4] =  -0.45939272257052, occ[   4] =   2.00000000000000
lambda[   5] =  -0.45887842372391, occ[   5] =   2.00000000000000
lambda[   6] =  -0.39615095508634, occ[   6] =   2.00000000000000
lambda[   7] =  -0.29103836608591, occ[   7] =   2.00000000000000
lambda[   8] =  -0.24167053837891, occ[   8] =   2.00000000000000
lambda[   9] =  -0.07081430771914, occ[   9] =   0.00000001446729
lambda[  10] =  -0.03195264855479, occ[  10] =   0.00000000000000
lambda[  11] =  -0.02895108323301, occ[  11] =   0.00000000000000
lambda[  12] =   0.01315016336127, occ[  12] =   0.00000000000000
lambda[  13] =   0.03099317804376, occ[  13] =   0.00000000000000
lambda[  14] =   0.03557138350467, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.002 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.430 ms, time for Allreduce/Reduce: 5.921 ms 
Time for calculating local force components: 14.079 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.06096411819665   0.01776446453989   0.00000001076052
  0.50183968892912   0.87301210671683   0.00000019475343
 -0.12479827127431   0.05870737020509  -0.00000006413024
  0.26277912339703  -1.14863184872577  -0.00000046920480
force_loc = 
  0.06461708709853  -0.02286332703272  -0.00000034431479
 -0.48996114500723  -0.84456970708288  -0.00000490175808
  0.12444335402328  -0.08045432277590  -0.00000042080995
 -0.26135859682358   1.14007637205969   0.00000230214696
Time for calculating nonlocal force components: 23.945 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.01292074101897  -0.02266641871205  -0.00000018072916
[0m[32m  0.00132799572191   0.00830300607087   0.00000001962958
[0m[32m -0.00499168138968   0.02124392342380   0.00000006671410
[0mTime for calculating XC forces components: 17.640 ms
 Cartesian force = 
  0.00364979503701  -0.00507926716454   0.00000061318134
 -0.00104537096194   0.00579557625019  -0.00000394099820
  0.00096990460602  -0.01342435117166   0.00000048142499
 -0.00357432868109   0.01270804208601   0.00000284639187
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.354 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Time for printing density: 390.119 ms
The program took 592.793 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:41
Job ID:        2266465
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:00:48,vmem=8476K,walltime=00:10:04,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-11-2
---------------------------------------
