---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:17
Job ID:    2266815
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:22
Job ID:    2266815
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.060 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.016 ms

Set default values took 0.005 ms
Reading input file sprc-calc.inpt

Reading input file took 8.548 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 3.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = C.psp8

Reading ion file took 11.119 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 42.390 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.949 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.075 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   12.396108	
   10.000000	   10.000000	    7.603892	
   10.000000	   10.000000	   10.195814	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.146 ms
Set up communicators.

--set up spincomm took 2.298 ms

--set up kptcomm took 0.358 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {2, 2, 3}
gridsizes = [100, 100, 100], Nstates = 13, dmcomm dims = [2, 2, 3]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 1, ScaLAPACK topology Dims = (1, 1)
nproc = 12, size_blacscomm = 1 = dims[0] * dims[1] = (1, 1)
Nd_blacscomm 85000, Nstates 13 
rank =  0, my blacs rank = 0, BLCYC size (85000, 13), actual size (85000, 13)
rank = 0, mb = nb = 13, mbQ = nbQ = 64
rank = 0, nr_Hp = 13, nc_Hp = 13
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.072 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 1
# of bands per bandcomm          : 13
npdomain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.422 ms

Calculate_SplineDerivRadFun took 0.163 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.284 ms.
time spent on vectorized spline interp: 3.246 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.031 ms.
time spent on vectorized spline interp: 1.664 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.515 ms.

Calculating rb for all atom types took 11.751 ms
----------------------
Estimated memory usage
Total: 562.34 MB
orbitals             : 297.55 MB
global sized vectors : 213.62 MB
subspace matrices : 47.53 kB
others : 51.12 MB
----------------------------------------------
Estimated memory usage per processor: 46.86 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.200 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.010 ms
Calculating pseudocharge density ... 
the global sum of int_b = -14.0000000038430, sum_int_rho = 13.9848643415976
PosCharge = 14.000000003843, NegCharge = -13.984864341598, scal_fac = 1.001082288814
After scaling, int_rho = 14.0000000038430, PosCharge + NegCharge - NetCharge = 7.105e-15
--Calculate Vref took 0.292 ms
--Calculate rho_guess took 1.841 ms

 integral of b = -14.0000000038430,
 int{b} + Nelectron + NetCharge = -3.843e-09,
 Esc = -44.7155359183986,
 MPI_Reduce took 3.978 ms

Calculating b & b_ref took 11.189 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.010 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.074 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.008 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.032 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.019 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.004 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 24.699 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384298, int_b + int_rho = -4.457e-13, checking this took 0.090 ms
2-norm of RHS = 438.2866681087160, which took 0.124 ms

iter_count = 426, r_2norm = 3.815e-04, tol*||rhs|| = 4.383e-04

Anderson update took 237.211 ms, out of which F'*F took 107.276 ms; b-Ax took 727.722 ms, out of which Lap took 654.113 ms
Solving Poisson took 1542.670 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.410 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.810 ms
Total time for convolution: 	 convolve: 5.147163 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 63.663 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.819 ms
Total time for convolution: 	 convolve: 5.089389 
Total time for convolution: 	 convolve: 5.127877 
Total time for convolution: 	 convolve: 5.114296 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.726 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
rank = 0, XC calculation took 24451.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.579 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 1.696 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.141 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.673 ms
    Lanczos iter 54, eigmin  = -1.138968993, eigmax = 264.925517900, err_eigmin = 1.289e-03, err_eigmax = 9.769e-03
rank =   0, Lanczos took 121.657 ms, eigmin = -1.138968993119, eigmax = 267.574773079082

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.167902, lowerbound = -1.238969, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1085.925 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.780 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 2.816 ms
rank =  0, finding HY took 18.300 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.360 ms
Rank 0, Project_Hamiltonian used 23.497 ms
Total time for projection: 23.557 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.316 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.114 ms
rank = 0, Solve_Generalized_EigenProblem used 0.434 ms
    first calculated eigval = 2.798390262023538
    last  calculated eigval = 3.225611066336585
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =   2.79839026202354
lambda[   2] =   2.89901112586680
lambda[   3] =   2.89920348640108
lambda[   4] =   2.94607251144401
lambda[   5] =   2.96908347995556
lambda[   6] =   3.00494095894937
lambda[   7] =   3.04011120483619
lambda[   8] =   3.07631355443241
lambda[   9] =   3.07894727250460
lambda[  10] =   3.10163946172653
lambda[  11] =   3.13663478683665
lambda[  12] =   3.18200524892309
lambda[  13] =   3.22561106633659
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.450 ms
rank =  0, subspace rotation using ScaLAPACK took 2.995 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.002 ms

Total time for subspace rotation: 3.003 ms
rank = 0, Efermi =   3.058125923916 calculate fermi energy took 0.051 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.325611, lowerbound = -1.238969, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1087.041 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.298 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.038 ms
rank =  0, Distribute data + matrix mult took 4.276 ms
rank =  0, finding HY took 18.239 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 2.347 ms
Rank 0, Project_Hamiltonian used 24.886 ms
Total time for projection: 24.894 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.107 ms
    first calculated eigval = -1.038005195403135
    last  calculated eigval = 0.452720793905045
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.03800519540314
lambda[   2] =  -0.31594089498762
lambda[   3] =  -0.11642266759119
lambda[   4] =   0.02588663169663
lambda[   5] =   0.19181769200882
lambda[   6] =   0.21430189169367
lambda[   7] =   0.27451405419670
lambda[   8] =   0.31961786452719
lambda[   9] =   0.33640022767738
lambda[  10] =   0.35762713455676
lambda[  11] =   0.39597471437938
lambda[  12] =   0.42212725524313
lambda[  13] =   0.45272079390504
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.126 ms
rank =  0, subspace rotation using ScaLAPACK took 2.712 ms
rank =  0, Distributing orbital back into band + domain format took 0.002 ms
rank = 0, Subspace_Rotation used 2.728 ms

Total time for subspace rotation: 2.730 ms
rank = 0, Efermi =   0.297066112903 calculate fermi energy took 0.076 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.552721, lowerbound = -1.238969, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1095.397 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.715 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 2.741 ms
rank =  0, finding HY took 18.222 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.305 ms
Rank 0, Project_Hamiltonian used 23.291 ms
Total time for projection: 23.302 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.069 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.019 ms
rank = 0, Solve_Generalized_EigenProblem used 0.091 ms
    first calculated eigval = -1.147451089785587
    last  calculated eigval = 0.134875546922899
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.14745108978559
lambda[   2] =  -0.76974675547555
lambda[   3] =  -0.56943791298480
lambda[   4] =  -0.48728305114456
lambda[   5] =  -0.46963067549703
lambda[   6] =  -0.33795888568214
lambda[   7] =  -0.22862225621868
lambda[   8] =  -0.21401530195574
lambda[   9] =   0.00709152796670
lambda[  10] =   0.07690241536727
lambda[  11] =   0.08274331934904
lambda[  12] =   0.10896185229054
lambda[  13] =   0.13487554692290
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.111 ms
rank =  0, subspace rotation using ScaLAPACK took 3.006 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.013 ms

Total time for subspace rotation: 3.014 ms
rank = 0, Efermi =  -0.221318779054 calculate fermi energy took 0.027 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.234876, lowerbound = -1.238969, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1091.132 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.308 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 3.346 ms
rank =  0, finding HY took 18.150 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.311 ms
Rank 0, Project_Hamiltonian used 23.825 ms
Total time for projection: 23.828 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.111 ms
    first calculated eigval = -1.147537043595623
    last  calculated eigval = 0.084920337645566
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.14753704359562
lambda[   2] =  -0.77436018565801
lambda[   3] =  -0.57775291226057
lambda[   4] =  -0.49542462044934
lambda[   5] =  -0.49516564489052
lambda[   6] =  -0.36694503219971
lambda[   7] =  -0.28725145747595
lambda[   8] =  -0.28625429920161
lambda[   9] =  -0.04897479426048
lambda[  10] =  -0.01395197697842
lambda[  11] =   0.02874031441932
lambda[  12] =   0.05553310116194
lambda[  13] =   0.08492033764557
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.123 ms
rank =  0, subspace rotation using ScaLAPACK took 3.011 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.017 ms

Total time for subspace rotation: 3.018 ms
rank = 0, Efermi =  -0.286752878326 calculate fermi energy took 0.019 ms
rank = 0, --- Calculate rho: sum over local bands took 1.491 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 4593.804 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
rank = 0, D2D took 0.443 ms
rank = 0, Transfering density took 0.452 ms
Etot    =   -28.407865208207
Eband   =    -8.287952845225
E1      =    16.594903144671
E2      =    -7.308036661448
E3      =    -8.655334257280
Exc     =    -7.954395149528
Esc     =   -44.715535918399
Entropy =    -0.008255358456
dE = 9.469e+00, dEband = 2.763e+00
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -28.407865208, dEtot = 9.469e+00, dEband = 2.763e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 36.2545198173600, which took 0.068 ms

iter_count = 90, r_2norm = 1.287e-03, tol*||rhs|| = 1.450e-03

Anderson update took 47.966 ms, out of which F'*F took 22.553 ms; b-Ax took 152.738 ms, out of which Lap took 136.500 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 327.847 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384297, int_b + int_rho = -4.566e-13, checking this took 0.127 ms
2-norm of RHS = 435.5314703704208, which took 0.152 ms

iter_count = 270, r_2norm = 4.217e-04, tol*||rhs|| = 4.355e-04

Anderson update took 144.980 ms, out of which F'*F took 68.374 ms; b-Ax took 459.097 ms, out of which Lap took 412.228 ms
Solving Poisson took 968.776 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.864 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.113 ms
Total time for convolution: 	 convolve: 5.133958 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 81.308 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.290892 
Total time for convolution: 	 convolve: 5.116240 
Total time for convolution: 	 convolve: 5.174676 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.177 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.316 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.333 ms

This SCF took 30754.019 ms, scf error = 1.295e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.184920, lowerbound = -1.147537, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1083.221 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.699 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 2.727 ms
rank =  0, finding HY took 18.128 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.322 ms
Rank 0, Project_Hamiltonian used 23.200 ms
Total time for projection: 23.210 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.025 ms
rank = 0, Solve_Generalized_EigenProblem used 0.116 ms
    first calculated eigval = -1.115678291905722
    last  calculated eigval = 0.056228163125278
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.11567829190572
lambda[   2] =  -0.75808628059624
lambda[   3] =  -0.54493104067275
lambda[   4] =  -0.47319808112241
lambda[   5] =  -0.47289174560480
lambda[   6] =  -0.34753333534106
lambda[   7] =  -0.27251953157505
lambda[   8] =  -0.27214991544445
lambda[   9] =  -0.04296540309950
lambda[  10] =  -0.03035081740269
lambda[  11] =   0.00132050360957
lambda[  12] =   0.03532472570956
lambda[  13] =   0.05622816312528
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.135 ms
rank =  0, subspace rotation using ScaLAPACK took 2.988 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 2.996 ms

Total time for subspace rotation: 2.997 ms
rank = 0, Efermi =  -0.272334723497 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 1.496 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1111.228 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
rank = 0, D2D took 0.478 ms
rank = 0, Transfering density took 0.482 ms
Etot    =   -28.388946352414
Eband   =    -7.969317483253
E1      =    16.314663677502
E2      =    -7.269521691217
E3      =    -8.747229250091
Exc     =    -8.027219377460
Esc     =   -44.715535918399
Entropy =    -0.008288192111
dE = 6.306e-03, dEband = 1.062e-01
rank = 0, Calculating/Estimating energy took 0.937 ms, Etot = -28.388946352, dEtot = 6.306e-03, dEband = 1.062e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 18.2457720943480, which took 1.369 ms

iter_count = 96, r_2norm = 6.640e-04, tol*||rhs|| = 7.298e-04

Anderson update took 51.978 ms, out of which F'*F took 23.805 ms; b-Ax took 164.088 ms, out of which Lap took 146.563 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 355.028 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384297, int_b + int_rho = -4.584e-13, checking this took 0.117 ms
2-norm of RHS = 434.0615905154203, which took 0.143 ms

iter_count = 288, r_2norm = 3.635e-04, tol*||rhs|| = 4.341e-04

Anderson update took 157.099 ms, out of which F'*F took 71.822 ms; b-Ax took 487.165 ms, out of which Lap took 435.455 ms
Solving Poisson took 1036.329 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.889 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.182509 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.212157 
Total time for convolution: 	 convolve: 5.167926 
Total time for convolution: 	 convolve: 5.214663 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.679 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.697 ms

This SCF took 27342.399 ms, scf error = 8.463e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.156228, lowerbound = -1.115678, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1083.174 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.717 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 2.747 ms
rank =  0, finding HY took 18.149 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.317 ms
Rank 0, Project_Hamiltonian used 23.231 ms
Total time for projection: 23.245 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.019 ms
rank = 0, Solve_Generalized_EigenProblem used 0.087 ms
    first calculated eigval = -1.088936160265344
    last  calculated eigval = 0.041426616145673
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.08893616026534
lambda[   2] =  -0.73039224575642
lambda[   3] =  -0.51845030697001
lambda[   4] =  -0.45505351187519
lambda[   5] =  -0.45490106104892
lambda[   6] =  -0.31631075231920
lambda[   7] =  -0.25209279605927
lambda[   8] =  -0.25202046895126
lambda[   9] =  -0.02560048377682
lambda[  10] =  -0.02531179172706
lambda[  11] =  -0.01132519073143
lambda[  12] =   0.02840205943554
lambda[  13] =   0.04142661614567
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 3.002 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.008 ms

Total time for subspace rotation: 3.008 ms
rank = 0, Efermi =  -0.252056632493 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.529 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1111.213 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
rank = 0, D2D took 0.452 ms
rank = 0, Transfering density took 0.454 ms
Etot    =   -28.373457147088
Eband   =    -7.632201743999
E1      =    16.026186941561
E2      =    -7.214670603681
E3      =    -8.851357391537
Exc     =    -8.109641188336
Esc     =   -44.715535918399
Entropy =    -0.008293233133
dE = 5.163e-03, dEband = 1.124e-01
rank = 0, Calculating/Estimating energy took 0.935 ms, Etot = -28.373457147, dEtot = 5.163e-03, dEband = 1.124e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.3970695301003, which took 0.064 ms

iter_count = 102, r_2norm = 1.687e-04, tol*||rhs|| = 2.159e-04

Anderson update took 54.704 ms, out of which F'*F took 25.216 ms; b-Ax took 172.984 ms, out of which Lap took 154.305 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.191 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384300, int_b + int_rho = -4.238e-13, checking this took 0.103 ms
2-norm of RHS = 434.4903266203096, which took 0.070 ms

iter_count = 276, r_2norm = 4.274e-04, tol*||rhs|| = 4.345e-04

Anderson update took 146.651 ms, out of which F'*F took 68.892 ms; b-Ax took 466.233 ms, out of which Lap took 417.348 ms
Solving Poisson took 987.776 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.463 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.268575 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.281619 
Total time for convolution: 	 convolve: 5.229946 
Total time for convolution: 	 convolve: 5.225288 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.687 ms
---Transfer Veff_loc: D2D took 0.782 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.417 ms

This SCF took 27448.760 ms, scf error = 3.520e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.141427, lowerbound = -1.088936, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1081.746 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.725 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.050 ms
rank =  0, Distribute data + matrix mult took 2.780 ms
rank =  0, finding HY took 18.173 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.316 ms
Rank 0, Project_Hamiltonian used 23.288 ms
Total time for projection: 23.305 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.069 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.018 ms
rank = 0, Solve_Generalized_EigenProblem used 0.091 ms
    first calculated eigval = -1.078086371508450
    last  calculated eigval = 0.033336364913696
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07808637150845
lambda[   2] =  -0.71432480639105
lambda[   3] =  -0.50818674825464
lambda[   4] =  -0.44786527960111
lambda[   5] =  -0.44774273791063
lambda[   6] =  -0.29881303767047
lambda[   7] =  -0.24227359680977
lambda[   8] =  -0.24218687025569
lambda[   9] =  -0.02772166244820
lambda[  10] =  -0.01545373049055
lambda[  11] =  -0.01095001214126
lambda[  12] =   0.02538891551580
lambda[  13] =   0.03333636491370
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 2.994 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.000 ms

Total time for subspace rotation: 3.001 ms
rank = 0, Efermi =  -0.242230233520 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.535 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1109.927 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
rank = 0, D2D took 0.465 ms
rank = 0, Transfering density took 0.468 ms
Etot    =   -28.369903439081
Eband   =    -7.474499008027
E1      =    15.903852782232
E2      =    -7.171294306762
E3      =    -8.903495283699
Exc     =    -8.150217740116
Esc     =   -44.715535918399
Entropy =    -0.008293145232
dE = 1.185e-03, dEband = 5.257e-02
rank = 0, Calculating/Estimating energy took 0.961 ms, Etot = -28.369903439, dEtot = 1.185e-03, dEband = 5.257e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.9578346692873, which took 0.090 ms

iter_count = 108, r_2norm = 5.509e-05, tol*||rhs|| = 7.831e-05

Anderson update took 57.770 ms, out of which F'*F took 26.772 ms; b-Ax took 183.550 ms, out of which Lap took 164.000 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.833 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384298, int_b + int_rho = -4.475e-13, checking this took 0.109 ms
2-norm of RHS = 435.1931530773345, which took 0.102 ms

iter_count = 252, r_2norm = 4.139e-04, tol*||rhs|| = 4.352e-04

Anderson update took 133.857 ms, out of which F'*F took 62.597 ms; b-Ax took 424.188 ms, out of which Lap took 379.726 ms
Solving Poisson took 900.922 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Total time for convolution: 	 convolve: 5.333587 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.272929 
Total time for convolution: 	 convolve: 5.248640 
Total time for convolution: 	 convolve: 5.247103 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.537 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.323 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.341 ms

This SCF took 27561.071 ms, scf error = 1.144e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.133336, lowerbound = -1.078086, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1085.079 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.718 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 2.749 ms
rank =  0, finding HY took 18.148 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.308 ms
Rank 0, Project_Hamiltonian used 23.227 ms
Total time for projection: 23.239 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.108 ms
    first calculated eigval = -1.076303388911887
    last  calculated eigval = 0.029096486110014
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07630338891189
lambda[   2] =  -0.71291435525122
lambda[   3] =  -0.50625053767343
lambda[   4] =  -0.44665352898975
lambda[   5] =  -0.44662484354095
lambda[   6] =  -0.29641417173212
lambda[   7] =  -0.24135058873515
lambda[   8] =  -0.24134954471212
lambda[   9] =  -0.03045628084285
lambda[  10] =  -0.01422905018347
lambda[  11] =  -0.01212173850074
lambda[  12] =   0.02384261484687
lambda[  13] =   0.02909648611001
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.125 ms
rank =  0, subspace rotation using ScaLAPACK took 3.028 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.034 ms

Total time for subspace rotation: 3.035 ms
rank = 0, Efermi =  -0.241350066711 calculate fermi energy took 0.679 ms
rank = 0, --- Calculate rho: sum over local bands took 1.513 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1113.752 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
rank = 0, D2D took 0.452 ms
rank = 0, Transfering density took 0.456 ms
Etot    =   -28.369450317174
Eband   =    -7.453021786657
E1      =    15.899480126987
E2      =    -7.152176018753
E3      =    -8.910672379848
Exc     =    -8.154927703838
Esc     =   -44.715535918399
Entropy =    -0.008293433868
dE = 1.510e-04, dEband = 7.159e-03
rank = 0, Calculating/Estimating energy took 0.977 ms, Etot = -28.369450317, dEtot = 1.510e-04, dEband = 7.159e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5157315941744, which took 0.128 ms

iter_count = 114, r_2norm = 1.467e-05, tol*||rhs|| = 2.063e-05

Anderson update took 60.740 ms, out of which F'*F took 28.010 ms; b-Ax took 193.113 ms, out of which Lap took 172.348 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.568 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384299, int_b + int_rho = -4.402e-13, checking this took 0.101 ms
2-norm of RHS = 436.0323015670740, which took 0.135 ms

iter_count = 258, r_2norm = 4.019e-04, tol*||rhs|| = 4.360e-04

Anderson update took 136.747 ms, out of which F'*F took 64.142 ms; b-Ax took 437.963 ms, out of which Lap took 391.416 ms
Solving Poisson took 924.313 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.239749 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.246327 
Total time for convolution: 	 convolve: 5.251855 
Total time for convolution: 	 convolve: 5.286259 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.324 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.341 ms

This SCF took 27447.667 ms, scf error = 6.550e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.129096, lowerbound = -1.076303, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1082.479 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.705 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 2.736 ms
rank =  0, finding HY took 18.415 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.334 ms
Rank 0, Project_Hamiltonian used 23.508 ms
Total time for projection: 23.520 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.019 ms
rank = 0, Solve_Generalized_EigenProblem used 0.087 ms
    first calculated eigval = -1.076109420442672
    last  calculated eigval = 0.027048522603150
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07610942044267
lambda[   2] =  -0.71303479222558
lambda[   3] =  -0.50560160358385
lambda[   4] =  -0.44656226734947
lambda[   5] =  -0.44652272696607
lambda[   6] =  -0.29489901984336
lambda[   7] =  -0.24125246133895
lambda[   8] =  -0.24121226900680
lambda[   9] =  -0.03174383118143
lambda[  10] =  -0.01385106465261
lambda[  11] =  -0.01279643761742
lambda[  12] =   0.02269243281818
lambda[  13] =   0.02704852260315
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.136 ms
rank =  0, subspace rotation using ScaLAPACK took 3.004 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.009 ms

Total time for subspace rotation: 3.010 ms
rank = 0, Efermi =  -0.241232365160 calculate fermi energy took 0.083 ms
rank = 0, --- Calculate rho: sum over local bands took 1.582 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1110.881 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.270 ms
rank = 0, D2D took 0.463 ms
rank = 0, Transfering density took 0.466 ms
Etot    =   -28.369225738361
Eband   =    -7.447924516098
E1      =    15.911553853011
E2      =    -7.133487478172
E3      =    -8.912988550821
Exc     =    -8.155501813961
Esc     =   -44.715535918399
Entropy =    -0.008293371908
dE = 7.486e-05, dEband = 1.699e-03
rank = 0, Calculating/Estimating energy took 1.769 ms, Etot = -28.369225738, dEtot = 7.486e-05, dEband = 1.699e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3586800551510, which took 0.057 ms

iter_count = 114, r_2norm = 9.780e-06, tol*||rhs|| = 1.435e-05

Anderson update took 60.973 ms, out of which F'*F took 28.265 ms; b-Ax took 192.865 ms, out of which Lap took 172.146 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.163 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384300, int_b + int_rho = -4.238e-13, checking this took 0.102 ms
2-norm of RHS = 436.1190156129028, which took 0.145 ms

iter_count = 240, r_2norm = 3.644e-04, tol*||rhs|| = 4.361e-04

Anderson update took 127.241 ms, out of which F'*F took 59.455 ms; b-Ax took 405.815 ms, out of which Lap took 362.858 ms
Solving Poisson took 859.163 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.232902 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.244482 
Total time for convolution: 	 convolve: 5.272158 
Total time for convolution: 	 convolve: 5.230708 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.170 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.012 ms
======D2D: initiated sending and receiving took 1.656 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.343 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.359 ms

This SCF took 27338.578 ms, scf error = 2.827e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.127049, lowerbound = -1.076109, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1083.136 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.696 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.034 ms
rank =  0, Distribute data + matrix mult took 2.735 ms
rank =  0, finding HY took 18.291 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.295 ms
Rank 0, Project_Hamiltonian used 23.345 ms
Total time for projection: 23.359 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.112 ms
    first calculated eigval = -1.075679207985794
    last  calculated eigval = 0.025929658269548
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07567920798579
lambda[   2] =  -0.71216072132829
lambda[   3] =  -0.50491538975395
lambda[   4] =  -0.44620730337218
lambda[   5] =  -0.44619136860660
lambda[   6] =  -0.29298246948828
lambda[   7] =  -0.24028099674273
lambda[   8] =  -0.24026490328408
lambda[   9] =  -0.03222399690482
lambda[  10] =  -0.01315983173767
lambda[  11] =  -0.01257555207155
lambda[  12] =   0.02187359094832
lambda[  13] =   0.02592965826955
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.127 ms
rank =  0, subspace rotation using ScaLAPACK took 2.981 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 2.989 ms

Total time for subspace rotation: 2.990 ms
rank = 0, Efermi =  -0.240272950001 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 1.501 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1111.246 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.568 ms
rank = 0, D2D took 1.669 ms
rank = 0, Transfering density took 1.673 ms
Etot    =   -28.369236670150
Eband   =    -7.436818841902
E1      =    15.906347733920
E2      =    -7.126420149751
E3      =    -8.916807702759
Exc     =    -8.158164072310
Esc     =   -44.715535918399
Entropy =    -0.008293423969
dE = 3.644e-06, dEband = 3.702e-03
rank = 0, Calculating/Estimating energy took 0.861 ms, Etot = -28.369236670, dEtot = 3.644e-06, dEband = 3.702e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1748203239248, which took 0.099 ms

iter_count = 114, r_2norm = 4.413e-06, tol*||rhs|| = 6.993e-06

Anderson update took 60.936 ms, out of which F'*F took 28.469 ms; b-Ax took 193.668 ms, out of which Lap took 173.170 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.587 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384299, int_b + int_rho = -4.384e-13, checking this took 0.097 ms
2-norm of RHS = 436.0410236669752, which took 0.122 ms

iter_count = 240, r_2norm = 4.126e-04, tol*||rhs|| = 4.360e-04

Anderson update took 127.173 ms, out of which F'*F took 59.906 ms; b-Ax took 406.811 ms, out of which Lap took 363.733 ms
Solving Poisson took 859.141 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Total time for convolution: 	 convolve: 5.231005 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.220356 
Total time for convolution: 	 convolve: 5.268075 
Total time for convolution: 	 convolve: 5.272552 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.165 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.334 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.352 ms

This SCF took 27350.204 ms, scf error = 1.935e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.125930, lowerbound = -1.075679, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1082.274 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.713 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 2.747 ms
rank =  0, finding HY took 18.185 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.302 ms
Rank 0, Project_Hamiltonian used 23.257 ms
Total time for projection: 23.274 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.108 ms
    first calculated eigval = -1.074296117680521
    last  calculated eigval = 0.026180524214223
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07429611768052
lambda[   2] =  -0.71076652510200
lambda[   3] =  -0.50362251360687
lambda[   4] =  -0.44505956932817
lambda[   5] =  -0.44505207110679
lambda[   6] =  -0.29122331500689
lambda[   7] =  -0.23901983654459
lambda[   8] =  -0.23901349242173
lambda[   9] =  -0.03160333313682
lambda[  10] =  -0.01195414986838
lambda[  11] =  -0.01162988549974
lambda[  12] =   0.02198156901114
lambda[  13] =   0.02618052421422
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.124 ms
rank =  0, subspace rotation using ScaLAPACK took 3.006 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.012 ms

Total time for subspace rotation: 3.013 ms
rank = 0, Efermi =  -0.239016664471 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.585 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.019 ms
rank = 0, Calculating density took 1111.887 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
rank = 0, D2D took 0.336 ms
rank = 0, Transfering density took 0.341 ms
Etot    =   -28.369388076851
Eband   =    -7.418073556637
E1      =    15.894400464081
E2      =    -7.118335092934
E3      =    -8.921334144051
Exc     =    -8.161554870517
Esc     =   -44.715535918399
Entropy =    -0.008293432365
dE = 5.047e-05, dEband = 6.248e-03
rank = 0, Calculating/Estimating energy took 0.999 ms, Etot = -28.369388077, dEtot = 5.047e-05, dEband = 6.248e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1291733886304, which took 0.053 ms

iter_count = 114, r_2norm = 3.365e-06, tol*||rhs|| = 5.167e-06

Anderson update took 60.956 ms, out of which F'*F took 28.321 ms; b-Ax took 193.525 ms, out of which Lap took 172.835 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.266 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384300, int_b + int_rho = -4.256e-13, checking this took 0.108 ms
2-norm of RHS = 436.0460239401073, which took 0.134 ms

iter_count = 204, r_2norm = 3.849e-04, tol*||rhs|| = 4.360e-04

Anderson update took 108.114 ms, out of which F'*F took 50.636 ms; b-Ax took 344.220 ms, out of which Lap took 307.858 ms
Solving Poisson took 730.057 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Total time for convolution: 	 convolve: 5.234260 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.241448 
Total time for convolution: 	 convolve: 5.250450 
Total time for convolution: 	 convolve: 5.217496 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.323 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.341 ms

This SCF took 27175.035 ms, scf error = 8.647e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.126181, lowerbound = -1.074296, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1107.606 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.704 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 2.738 ms
rank =  0, finding HY took 18.284 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.335 ms
Rank 0, Project_Hamiltonian used 23.382 ms
Total time for projection: 23.447 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.114 ms
    first calculated eigval = -1.073766528191633
    last  calculated eigval = 0.026296235427557
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07376652819163
lambda[   2] =  -0.71008009909655
lambda[   3] =  -0.50313421807326
lambda[   4] =  -0.44459046843326
lambda[   5] =  -0.44458764354176
lambda[   6] =  -0.29045639058209
lambda[   7] =  -0.23843085219155
lambda[   8] =  -0.23842736131214
lambda[   9] =  -0.03094761231914
lambda[  10] =  -0.01147399063202
lambda[  11] =  -0.01128396648603
lambda[  12] =   0.02213742655347
lambda[  13] =   0.02629623542756
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 2.997 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.387 ms

Total time for subspace rotation: 3.388 ms
rank = 0, Efermi =  -0.238429106739 calculate fermi energy took 0.617 ms
rank = 0, --- Calculate rho: sum over local bands took 1.467 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1136.757 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
rank = 0, D2D took 0.461 ms
rank = 0, Transfering density took 0.463 ms
Etot    =   -28.369447422658
Eband   =    -7.410088911193
E1      =    15.889765244913
E2      =    -7.114578873786
E3      =    -8.922823983567
Exc     =    -8.162697261892
Esc     =   -44.715535918399
Entropy =    -0.008293433442
dE = 1.978e-05, dEband = 2.662e-03
rank = 0, Calculating/Estimating energy took 1.014 ms, Etot = -28.369447423, dEtot = 1.978e-05, dEband = 2.662e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0773367303008, which took 0.055 ms

iter_count = 108, r_2norm = 2.479e-06, tol*||rhs|| = 3.093e-06

Anderson update took 57.687 ms, out of which F'*F took 26.905 ms; b-Ax took 183.393 ms, out of which Lap took 163.846 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.551 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384296, int_b + int_rho = -4.620e-13, checking this took 0.147 ms
2-norm of RHS = 436.0843572920100, which took 0.128 ms

iter_count = 216, r_2norm = 3.946e-04, tol*||rhs|| = 4.361e-04

Anderson update took 114.334 ms, out of which F'*F took 53.713 ms; b-Ax took 366.897 ms, out of which Lap took 328.117 ms
Solving Poisson took 773.208 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Total time for convolution: 	 convolve: 5.234246 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.284346 
Total time for convolution: 	 convolve: 5.254806 
Total time for convolution: 	 convolve: 5.249126 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.014 ms
======D2D: initiated sending and receiving took 1.357 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.923 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.311 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.331 ms

This SCF took 27298.976 ms, scf error = 6.669e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.126296, lowerbound = -1.073767, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1083.033 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.719 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 2.761 ms
rank =  0, finding HY took 18.108 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.300 ms
Rank 0, Project_Hamiltonian used 23.191 ms
Total time for projection: 23.255 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.110 ms
    first calculated eigval = -1.072843928798706
    last  calculated eigval = 0.028935381953022
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07284392879871
lambda[   2] =  -0.70933800519740
lambda[   3] =  -0.50232273965510
lambda[   4] =  -0.44372177463272
lambda[   5] =  -0.44372014410837
lambda[   6] =  -0.28986536972116
lambda[   7] =  -0.23769195994494
lambda[   8] =  -0.23769065815546
lambda[   9] =  -0.02801022324732
lambda[  10] =  -0.01088569372976
lambda[  11] =  -0.01077901250826
lambda[  12] =   0.02369613236260
lambda[  13] =   0.02893538195302
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.127 ms
rank =  0, subspace rotation using ScaLAPACK took 3.017 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.024 ms

Total time for subspace rotation: 3.025 ms
rank = 0, Efermi =  -0.237691309038 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 1.516 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1111.562 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
rank = 0, D2D took 0.446 ms
rank = 0, Transfering density took 0.449 ms
Etot    =   -28.369524651764
Eband   =    -7.399006543371
E1      =    15.884847782861
E2      =    -7.108143888934
E3      =    -8.923673982919
Exc     =    -8.163354410863
Esc     =   -44.715535918399
Entropy =    -0.008293433845
dE = 2.574e-05, dEband = 3.694e-03
rank = 0, Calculating/Estimating energy took 1.013 ms, Etot = -28.369524652, dEtot = 2.574e-05, dEband = 3.694e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0453589391128, which took 0.069 ms

iter_count = 108, r_2norm = 1.784e-06, tol*||rhs|| = 1.814e-06

Anderson update took 57.565 ms, out of which F'*F took 26.899 ms; b-Ax took 183.883 ms, out of which Lap took 164.141 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.256 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384299, int_b + int_rho = -4.347e-13, checking this took 0.107 ms
2-norm of RHS = 436.0872127741002, which took 0.138 ms

iter_count = 192, r_2norm = 3.916e-04, tol*||rhs|| = 4.361e-04

Anderson update took 101.942 ms, out of which F'*F took 47.823 ms; b-Ax took 324.242 ms, out of which Lap took 290.191 ms
Solving Poisson took 688.107 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.237076 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.237241 
Total time for convolution: 	 convolve: 6.365966 
Total time for convolution: 	 convolve: 5.235550 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.338 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.355 ms

This SCF took 28267.850 ms, scf error = 3.545e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.128935, lowerbound = -1.072844, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1084.946 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.711 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.044 ms
rank =  0, Distribute data + matrix mult took 2.761 ms
rank =  0, finding HY took 18.195 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.316 ms
Rank 0, Project_Hamiltonian used 23.292 ms
Total time for projection: 23.309 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.018 ms
rank = 0, Solve_Generalized_EigenProblem used 0.086 ms
    first calculated eigval = -1.072227437161655
    last  calculated eigval = 0.031328709781067
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07222743716166
lambda[   2] =  -0.70857948220897
lambda[   3] =  -0.50173113762674
lambda[   4] =  -0.44312740061168
lambda[   5] =  -0.44312560260330
lambda[   6] =  -0.28910147280448
lambda[   7] =  -0.23700812921330
lambda[   8] =  -0.23700625096032
lambda[   9] =  -0.02593801011565
lambda[  10] =  -0.01032378064013
lambda[  11] =  -0.01026525340752
lambda[  12] =   0.02420641821418
lambda[  13] =   0.03132870978107
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 2.672 ms
rank =  0, Distributing orbital back into band + domain format took 0.004 ms
rank = 0, Subspace_Rotation used 2.685 ms

Total time for subspace rotation: 2.686 ms
rank = 0, Efermi =  -0.237007190074 calculate fermi energy took 0.236 ms
rank = 0, --- Calculate rho: sum over local bands took 1.455 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1113.979 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
rank = 0, D2D took 0.488 ms
rank = 0, Transfering density took 0.497 ms
Etot    =   -28.369563508112
Eband   =    -7.389799447389
E1      =    15.879848780332
E2      =    -7.103600657027
E3      =    -8.925038294047
Exc     =    -8.164422439956
Esc     =   -44.715535918399
Entropy =    -0.008293433774
dE = 1.295e-05, dEband = 3.069e-03
rank = 0, Calculating/Estimating energy took 0.954 ms, Etot = -28.369563508, dEtot = 1.295e-05, dEband = 3.069e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0485099178774, which took 0.134 ms

iter_count = 108, r_2norm = 1.519e-06, tol*||rhs|| = 1.940e-06

Anderson update took 57.649 ms, out of which F'*F took 26.762 ms; b-Ax took 183.483 ms, out of which Lap took 163.677 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.101 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384301, int_b + int_rho = -4.111e-13, checking this took 0.123 ms
2-norm of RHS = 436.0953683785403, which took 0.092 ms

iter_count = 162, r_2norm = 3.942e-04, tol*||rhs|| = 4.361e-04

Anderson update took 85.760 ms, out of which F'*F took 40.313 ms; b-Ax took 274.325 ms, out of which Lap took 245.295 ms
Solving Poisson took 580.653 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.126 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Total time for convolution: 	 convolve: 5.223747 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.228612 
Total time for convolution: 	 convolve: 5.245315 
Total time for convolution: 	 convolve: 5.247144 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.697 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.312 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.331 ms

This SCF took 27017.234 ms, scf error = 2.546e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.131329, lowerbound = -1.072227, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1083.393 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.707 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.090 ms
rank =  0, Distribute data + matrix mult took 2.802 ms
rank =  0, finding HY took 18.173 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.292 ms
Rank 0, Project_Hamiltonian used 23.286 ms
Total time for projection: 23.299 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.484 ms
    first calculated eigval = -1.072046560551966
    last  calculated eigval = 0.032246157896839
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07204656055197
lambda[   2] =  -0.70844691346634
lambda[   3] =  -0.50156192541873
lambda[   4] =  -0.44294805129855
lambda[   5] =  -0.44294555680762
lambda[   6] =  -0.28901255935124
lambda[   7] =  -0.23687248185037
lambda[   8] =  -0.23686996303751
lambda[   9] =  -0.02525259922052
lambda[  10] =  -0.01021916675606
lambda[  11] =  -0.01018877454462
lambda[  12] =   0.02381251825364
lambda[  13] =   0.03224615789684
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.501 ms
rank =  0, subspace rotation using ScaLAPACK took 3.284 ms
rank =  0, Distributing orbital back into band + domain format took 0.002 ms
rank = 0, Subspace_Rotation used 3.297 ms

Total time for subspace rotation: 3.298 ms
rank = 0, Efermi =  -0.236871222431 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 1.525 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1112.158 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
rank = 0, D2D took 0.551 ms
rank = 0, Transfering density took 0.562 ms
Etot    =   -28.369579754209
Eband   =    -7.387665580075
E1      =    15.879011351258
E2      =    -7.102262929209
E3      =    -8.925123628276
Exc     =    -8.164482730813
Esc     =   -44.715535918399
Entropy =    -0.008293433666
dE = 5.415e-06, dEband = 7.113e-04
rank = 0, Calculating/Estimating energy took 0.943 ms, Etot = -28.369579754, dEtot = 5.415e-06, dEband = 7.113e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0288336212289, which took 0.060 ms

iter_count = 108, r_2norm = 9.287e-07, tol*||rhs|| = 1.153e-06

Anderson update took 57.528 ms, out of which F'*F took 27.132 ms; b-Ax took 183.522 ms, out of which Lap took 163.994 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.554 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384301, int_b + int_rho = -4.202e-13, checking this took 0.127 ms
2-norm of RHS = 436.1027616603197, which took 0.128 ms

iter_count = 174, r_2norm = 4.135e-04, tol*||rhs|| = 4.361e-04

Anderson update took 92.519 ms, out of which F'*F took 43.125 ms; b-Ax took 293.280 ms, out of which Lap took 262.571 ms
Solving Poisson took 623.615 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.246684 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.228865 
Total time for convolution: 	 convolve: 5.244289 
Total time for convolution: 	 convolve: 5.234512 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.323 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.341 ms

This SCF took 27066.213 ms, scf error = 1.832e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132246, lowerbound = -1.072047, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1113.976 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.726 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 2.754 ms
rank =  0, finding HY took 18.179 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.305 ms
Rank 0, Project_Hamiltonian used 23.685 ms
Total time for projection: 23.725 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.018 ms
rank = 0, Solve_Generalized_EigenProblem used 0.087 ms
    first calculated eigval = -1.071805647929043
    last  calculated eigval = 0.034349975178919
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07180564792904
lambda[   2] =  -0.70819499406767
lambda[   3] =  -0.50133053911501
lambda[   4] =  -0.44269678811660
lambda[   5] =  -0.44269628845896
lambda[   6] =  -0.28879642406071
lambda[   7] =  -0.23663134660415
lambda[   8] =  -0.23663090621170
lambda[   9] =  -0.02374681935860
lambda[  10] =  -0.01003171193352
lambda[  11] =  -0.01001745982659
lambda[  12] =   0.02375749165206
lambda[  13] =   0.03434997517892
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.610 ms
rank =  0, subspace rotation using ScaLAPACK took 3.013 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.019 ms

Total time for subspace rotation: 3.019 ms
rank = 0, Efermi =  -0.236631126395 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 1.506 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1142.956 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.256 ms
rank = 0, D2D took 0.441 ms
rank = 0, Transfering density took 0.444 ms
Etot    =   -28.369604629520
Eband   =    -7.384303617236
E1      =    15.877616683612
E2      =    -7.100246760970
E3      =    -8.925246412684
Exc     =    -8.164581517249
Esc     =   -44.715535918399
Entropy =    -0.008293433902
dE = 8.292e-06, dEband = 1.121e-03
rank = 0, Calculating/Estimating energy took 1.016 ms, Etot = -28.369604630, dEtot = 8.292e-06, dEband = 1.121e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0266409022768, which took 0.070 ms

iter_count = 108, r_2norm = 9.227e-07, tol*||rhs|| = 1.066e-06

Anderson update took 57.294 ms, out of which F'*F took 30.758 ms; b-Ax took 187.128 ms, out of which Lap took 167.719 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.892 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384304, int_b + int_rho = -3.820e-13, checking this took 0.115 ms
2-norm of RHS = 436.1043695525049, which took 0.138 ms

iter_count = 114, r_2norm = 3.899e-04, tol*||rhs|| = 4.361e-04

Anderson update took 61.449 ms, out of which F'*F took 28.606 ms; b-Ax took 193.425 ms, out of which Lap took 173.013 ms
Solving Poisson took 411.551 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Total time for convolution: 	 convolve: 5.214807 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.656 ms
Total time for convolution: 	 convolve: 5.245987 
Total time for convolution: 	 convolve: 5.233959 
Total time for convolution: 	 convolve: 5.243069 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.330 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.349 ms

This SCF took 26882.710 ms, scf error = 1.396e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.134350, lowerbound = -1.071806, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1083.200 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.714 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.614 ms
rank =  0, Distribute data + matrix mult took 3.787 ms
rank =  0, finding HY took 18.083 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.316 ms
Rank 0, Project_Hamiltonian used 24.209 ms
Total time for projection: 24.223 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.106 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -1.071776263958915
    last  calculated eigval = 0.034706184340811
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07177626395892
lambda[   2] =  -0.70816087610547
lambda[   3] =  -0.50129923347710
lambda[   4] =  -0.44266699740336
lambda[   5] =  -0.44266682545498
lambda[   6] =  -0.28874955265320
lambda[   7] =  -0.23659533917724
lambda[   8] =  -0.23659530860796
lambda[   9] =  -0.02345277587445
lambda[  10] =  -0.01000259009541
lambda[  11] =  -0.00999620064201
lambda[  12] =   0.02308052938483
lambda[  13] =   0.03470618434081
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 3.010 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.016 ms

Total time for subspace rotation: 3.017 ms
rank = 0, Efermi =  -0.236595323880 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 1.529 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1112.290 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
rank = 0, D2D took 0.449 ms
rank = 0, Transfering density took 0.453 ms
Etot    =   -28.369607449597
Eband   =    -7.383830146801
E1      =    15.877429417875
E2      =    -7.099947188195
E3      =    -8.925288645268
Exc     =    -8.164613201826
Esc     =   -44.715535918399
Entropy =    -0.008293433910
dE = 9.400e-07, dEband = 1.578e-04
rank = 0, Calculating/Estimating energy took 0.972 ms, Etot = -28.369607450, dEtot = 9.400e-07, dEband = 1.578e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0264754540015, which took 0.139 ms

iter_count = 108, r_2norm = 9.429e-07, tol*||rhs|| = 1.059e-06

Anderson update took 57.911 ms, out of which F'*F took 26.802 ms; b-Ax took 183.700 ms, out of which Lap took 164.004 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.026 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384299, int_b + int_rho = -4.329e-13, checking this took 0.103 ms
2-norm of RHS = 436.1052801523411, which took 0.111 ms

iter_count = 90, r_2norm = 4.142e-04, tol*||rhs|| = 4.361e-04

Anderson update took 48.016 ms, out of which F'*F took 22.312 ms; b-Ax took 151.888 ms, out of which Lap took 135.989 ms
Solving Poisson took 324.376 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.139 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.270340 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.225436 
Total time for convolution: 	 convolve: 5.292738 
Total time for convolution: 	 convolve: 5.235412 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.318 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.334 ms

This SCF took 26860.245 ms, scf error = 1.389e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.134706, lowerbound = -1.071776, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1086.449 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.710 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 2.740 ms
rank =  0, finding HY took 18.156 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 2.297 ms
Rank 0, Project_Hamiltonian used 23.213 ms
Total time for projection: 23.229 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -1.071757970552984
    last  calculated eigval = 0.034708975168247
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07175797055298
lambda[   2] =  -0.70814752922104
lambda[   3] =  -0.50127890193298
lambda[   4] =  -0.44265134497621
lambda[   5] =  -0.44265113309109
lambda[   6] =  -0.28872713920254
lambda[   7] =  -0.23657964811094
lambda[   8] =  -0.23657962600060
lambda[   9] =  -0.02343904837616
lambda[  10] =  -0.00999085099024
lambda[  11] =  -0.00998827988619
lambda[  12] =   0.02234263282127
lambda[  13] =   0.03470897516825
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.137 ms
rank =  0, subspace rotation using ScaLAPACK took 2.988 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 2.994 ms

Total time for subspace rotation: 2.995 ms
rank = 0, Efermi =  -0.236579637043 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 1.493 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1114.426 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
rank = 0, D2D took 0.407 ms
rank = 0, Transfering density took 0.410 ms
Etot    =   -28.369606374291
Eband   =    -7.383587312974
E1      =    15.877316980223
E2      =    -7.099804468069
E3      =    -8.925338617120
Exc     =    -8.164649774420
Esc     =   -44.715535918399
Entropy =    -0.008293433910
dE = 3.584e-07, dEband = 8.094e-05
rank = 0, Calculating/Estimating energy took 1.095 ms, Etot = -28.369606374, dEtot = 3.584e-07, dEband = 8.094e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0283806744953, which took 0.054 ms

iter_count = 108, r_2norm = 8.243e-07, tol*||rhs|| = 1.135e-06

Anderson update took 57.918 ms, out of which F'*F took 26.903 ms; b-Ax took 183.354 ms, out of which Lap took 163.689 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.260 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384298, int_b + int_rho = -4.475e-13, checking this took 0.151 ms
2-norm of RHS = 436.1039260346194, which took 0.116 ms

iter_count = 114, r_2norm = 4.142e-04, tol*||rhs|| = 4.361e-04

Anderson update took 60.506 ms, out of which F'*F took 28.390 ms; b-Ax took 193.282 ms, out of which Lap took 172.808 ms
Solving Poisson took 410.297 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Total time for convolution: 	 convolve: 5.249523 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.233204 
Total time for convolution: 	 convolve: 5.318579 
Total time for convolution: 	 convolve: 5.275211 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.578 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.311 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.655 ms

This SCF took 27053.645 ms, scf error = 1.336e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.134709, lowerbound = -1.071758, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1085.312 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.731 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 2.759 ms
rank =  0, finding HY took 18.286 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.319 ms
Rank 0, Project_Hamiltonian used 23.388 ms
Total time for projection: 23.409 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.027 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -1.071714852128772
    last  calculated eigval = 0.034786769906667
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07171485212877
lambda[   2] =  -0.70808259641593
lambda[   3] =  -0.50123799415394
lambda[   4] =  -0.44260811100021
lambda[   5] =  -0.44260736232288
lambda[   6] =  -0.28866369130858
lambda[   7] =  -0.23652311438810
lambda[   8] =  -0.23652236350817
lambda[   9] =  -0.02339545860370
lambda[  10] =  -0.00995015786072
lambda[  11] =  -0.00994924611976
lambda[  12] =   0.02180913805087
lambda[  13] =   0.03478676990667
==subpsace eigenproblem: bcast eigvals took 0.072 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 3.000 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.006 ms

Total time for subspace rotation: 3.007 ms
rank = 0, Efermi =  -0.236522738936 calculate fermi energy took 0.099 ms
rank = 0, --- Calculate rho: sum over local bands took 1.535 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.039 ms
rank = 0, Calculating density took 1113.687 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
rank = 0, D2D took 0.463 ms
rank = 0, Transfering density took 0.471 ms
Etot    =   -28.369615773507
Eband   =    -7.382874693509
E1      =    15.876901139692
E2      =    -7.099486313571
E3      =    -8.925408113340
Exc     =    -8.164707294314
Esc     =   -44.715535918399
Entropy =    -0.008293433888
dE = 3.133e-06, dEband = 2.375e-04
rank = 0, Calculating/Estimating energy took 0.953 ms, Etot = -28.369615774, dEtot = 3.133e-06, dEband = 2.375e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0291403824308, which took 0.113 ms

iter_count = 108, r_2norm = 7.404e-07, tol*||rhs|| = 1.166e-06

Anderson update took 57.720 ms, out of which F'*F took 26.717 ms; b-Ax took 183.743 ms, out of which Lap took 164.108 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.877 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384301, int_b + int_rho = -4.184e-13, checking this took 0.109 ms
2-norm of RHS = 436.1043422280326, which took 0.091 ms

iter_count = 144, r_2norm = 3.657e-04, tol*||rhs|| = 4.361e-04

Anderson update took 76.437 ms, out of which F'*F took 36.148 ms; b-Ax took 243.866 ms, out of which Lap took 218.564 ms
Solving Poisson took 517.829 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.273109 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.407 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.239078 
Total time for convolution: 	 convolve: 5.245035 
Total time for convolution: 	 convolve: 5.241670 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.837 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.097 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.117 ms

This SCF took 27057.243 ms, scf error = 1.297e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.134787, lowerbound = -1.071715, upperbound = 267.574773

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1084.305 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.715 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 2.752 ms
rank =  0, finding HY took 18.230 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 2.325 ms
Rank 0, Project_Hamiltonian used 23.330 ms
Total time for projection: 23.346 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.100 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.025 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -1.071576933917094
    last  calculated eigval = 0.034354778805502
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.07157693391709
lambda[   2] =  -0.70798045701808
lambda[   3] =  -0.50111241613226
lambda[   4] =  -0.44248299667636
lambda[   5] =  -0.44248225183080
lambda[   6] =  -0.28858192116135
lambda[   7] =  -0.23642274120160
lambda[   8] =  -0.23642198678341
lambda[   9] =  -0.02374190616123
lambda[  10] =  -0.00987735028101
lambda[  11] =  -0.00987635302951
lambda[  12] =   0.02160578826762
lambda[  13] =   0.03435477880550
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 2.988 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 2.994 ms

Total time for subspace rotation: 2.995 ms
rank = 0, Efermi =  -0.236422363980 calculate fermi energy took 0.075 ms
rank = 0, --- Calculate rho: sum over local bands took 1.516 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1112.457 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
rank = 0, D2D took 0.449 ms
rank = 0, Transfering density took 0.453 ms
Etot    =   -28.369629796481
Eband   =    -7.381278682409
E1      =    15.876056707587
E2      =    -7.098689977798
E3      =    -8.925544373108
Exc     =    -8.164812820279
Esc     =   -44.715535918399
Entropy =    -0.008293433888
dE = 4.674e-06, dEband = 5.320e-04
rank = 0, Calculating/Estimating energy took 1.014 ms, Etot = -28.369629796, dEtot = 4.674e-06, dEband = 5.320e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0193079481028, which took 0.068 ms

iter_count = 102, r_2norm = 6.236e-07, tol*||rhs|| = 7.723e-07

Anderson update took 54.420 ms, out of which F'*F took 25.596 ms; b-Ax took 173.185 ms, out of which Lap took 154.650 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.750 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000000384343, int_rho =  14.00000000384301, int_b + int_rho = -4.165e-13, checking this took 0.076 ms
2-norm of RHS = 436.1060161506867, which took 0.132 ms

iter_count = 156, r_2norm = 3.621e-04, tol*||rhs|| = 4.361e-04

Anderson update took 83.000 ms, out of which F'*F took 38.835 ms; b-Ax took 264.853 ms, out of which Lap took 236.631 ms
Solving Poisson took 560.829 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Total time for convolution: 	 convolve: 5.226812 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.287287 
Total time for convolution: 	 convolve: 5.290201 
Total time for convolution: 	 convolve: 5.267039 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.839 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.327 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.701 ms

This SCF took 27118.464 ms, scf error = 8.296e-05
The last 13 occupations of kpoints #1 are (Nelectron = 14):
lambda[   1] =  -1.07157693391709, occ[   1] =   2.00000000000000
lambda[   2] =  -0.70798045701808, occ[   2] =   2.00000000000000
lambda[   3] =  -0.50111241613226, occ[   3] =   2.00000000000000
lambda[   4] =  -0.44248299667636, occ[   4] =   2.00000000000000
lambda[   5] =  -0.44248225183080, occ[   5] =   2.00000000000000
lambda[   6] =  -0.28858192116135, occ[   6] =   2.00000000000000
lambda[   7] =  -0.23642274120160, occ[   7] =   1.00005791249624
lambda[   8] =  -0.23642198678341, occ[   8] =   0.99994209134495
lambda[   9] =  -0.02374190616123, occ[   9] =   0.00000000000000
lambda[  10] =  -0.00987735028101, occ[  10] =   0.00000000000000
lambda[  11] =  -0.00987635302951, occ[  11] =   0.00000000000000
lambda[  12] =   0.02160578826762, occ[  12] =   0.00000000000000
lambda[  13] =   0.03435477880550, occ[  13] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 12 (90%) = 0.000000000000000.
Occupation of state 13 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.437 ms, time for Allreduce/Reduce: 4.371 ms 
Time for calculating local force components: 12.378 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000010419825  -0.00000121253922  -1.33303981673863
 -0.00000051016385   0.00001282586889   0.62912092763496
 -0.00000025303808  -0.00000184121845   0.24359549958590
force_loc = 
 -0.00000244932424   0.00000413297202   1.32402139848242
  0.00000211638745  -0.00001071544411  -0.60917211472764
 -0.00000418946241   0.00000947950738  -0.26901059396230
Time for calculating nonlocal force components: 19.734 ms
[32mforces_xc: 
[0m[32m -0.00000007245488   0.00000010203464   0.02978817848659
[0m[32m  0.00000011737753  -0.00000062984758  -0.01654269438669
[0m[32m -0.00000023336299   0.00000043497817   0.00125154462452
[0mTime for calculating XC forces components: 14.834 ms
 Cartesian force = 
 -0.00000062763314  -0.00000116963647   0.02076565056400
  0.00000351354888  -0.00000271152672   0.00340200885426
 -0.00000288591574   0.00000388116319  -0.02416765941826
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.721 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Time for printing density: 380.138 ms
The program took 494.745 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:35:38
Job ID:        2266815
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:41:00,vmem=8368K,walltime=00:08:25,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-4-1
---------------------------------------
