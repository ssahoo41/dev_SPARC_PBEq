---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:28
Job ID:    2266780
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:33
Job ID:    2266780
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.057 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 7.612 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 3.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = C.psp8

Reading ion file took 6.773 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 57.759 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.978 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.088 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   12.204112	
   10.000000	   10.000000	    7.795888	
   10.000000	   10.000000	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.160 ms
Set up communicators.

--set up spincomm took 2.380 ms

--set up kptcomm took 0.345 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.014 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.091 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.312 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.608 ms

Calculate_SplineDerivRadFun took 0.168 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.245 ms.
time spent on vectorized spline interp: 2.619 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.961 ms.
time spent on vectorized spline interp: 1.512 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.425 ms.

Calculating rb for all atom types took 10.770 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.204 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.009 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000024554, sum_int_rho = 15.9909865618216
PosCharge = 16.000000002455, NegCharge = -15.990986561822, scal_fac = 1.000563657570
After scaling, int_rho = 16.0000000024555, PosCharge + NegCharge - NetCharge = -8.527e-14
--Calculate Vref took 0.284 ms
--Calculate rho_guess took 1.722 ms

 integral of b = -16.0000000024554,
 int{b} + Nelectron + NetCharge = -2.455e-09,
 Esc = -58.3813166893007,
 MPI_Reduce took 3.626 ms

Calculating b & b_ref took 10.525 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.024 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.109 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.008 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.030 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.019 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.006 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 26.686 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245553, int_b + int_rho = -3.747e-13, checking this took 0.087 ms
2-norm of RHS = 468.4196558697560, which took 0.063 ms

iter_count = 426, r_2norm = 3.692e-04, tol*||rhs|| = 4.684e-04

Anderson update took 232.326 ms, out of which F'*F took 141.024 ms; b-Ax took 825.761 ms, out of which Lap took 788.739 ms
Solving Poisson took 1341.303 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.496 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
Total time for convolution: 	 convolve: 5.121462 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.436 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
Total time for convolution: 	 convolve: 5.142545 
Total time for convolution: 	 convolve: 5.097735 
Total time for convolution: 	 convolve: 5.104492 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.746 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.139 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.499 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.191 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
rank = 0, XC calculation took 24316.629 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 1.127 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.793 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 3.029 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.141 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.658 ms
    Lanczos iter 53, eigmin  = -1.158472665, eigmax = 264.916289390, err_eigmin = 1.490e-04, err_eigmax = 9.969e-03
rank =   0, Lanczos took 103.556 ms, eigmin = -1.158472665306, eigmax = 267.565452284395

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.153490, lowerbound = -1.258473, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1067.660 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 10.309 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.366 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 6.406 ms
rank =  0, Distribute data + matrix mult took 18.108 ms
rank =  0, finding HY took 17.887 ms
rank =  0, distributing HY into block cyclic form took 10.029 ms
rank =  0, finding Y'*HY took 4.473 ms
Rank 0, Project_Hamiltonian used 50.533 ms
Total time for projection: 50.553 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.330 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.396 ms
    first calculated eigval = 2.798867409907704
    last  calculated eigval = 3.188566139518518
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.79886740990770
lambda[   2] =   2.82895943324163
lambda[   3] =   2.85645491326908
lambda[   4] =   2.89899552586150
lambda[   5] =   2.95783239091609
lambda[   6] =   2.98193602910527
lambda[   7] =   3.01966709327816
lambda[   8] =   3.05972151454468
lambda[   9] =   3.07049671063268
lambda[  10] =   3.09457631063612
lambda[  11] =   3.10263184906057
lambda[  12] =   3.13170500281340
lambda[  13] =   3.16516362857114
lambda[  14] =   3.18856613951852
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.410 ms
rank =  0, subspace rotation using ScaLAPACK took 1.817 ms
rank =  0, Distributing orbital back into band + domain format took 8.175 ms
rank = 0, Subspace_Rotation used 10.010 ms

Total time for subspace rotation: 10.015 ms
rank = 0, Efermi =   3.065109112523 calculate fermi energy took 0.049 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.288566, lowerbound = -1.258473, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1055.798 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 8.548 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.250 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 5.344 ms
rank =  0, Distribute data + matrix mult took 15.160 ms
rank =  0, finding HY took 17.025 ms
rank =  0, distributing HY into block cyclic form took 8.516 ms
rank =  0, finding Y'*HY took 4.661 ms
Rank 0, Project_Hamiltonian used 45.421 ms
Total time for projection: 45.426 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -1.049479943923650
    last  calculated eigval = 0.425820741048136
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04947994392365
lambda[   2] =  -0.95670869325362
lambda[   3] =  -0.28740614398508
lambda[   4] =  -0.19585961079755
lambda[   5] =  -0.05130499865940
lambda[   6] =   0.09212751828793
lambda[   7] =   0.18475754607423
lambda[   8] =   0.25896780646971
lambda[   9] =   0.31138049466857
lambda[  10] =   0.32590698924717
lambda[  11] =   0.36391267224015
lambda[  12] =   0.38324274916079
lambda[  13] =   0.38724088570962
lambda[  14] =   0.42582074104814
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 1.900 ms
rank =  0, Distributing orbital back into band + domain format took 8.177 ms
rank = 0, Subspace_Rotation used 10.094 ms

Total time for subspace rotation: 10.099 ms
rank = 0, Efermi =   0.285176806392 calculate fermi energy took 0.022 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.525821, lowerbound = -1.258473, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1055.047 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.514 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.250 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 5.341 ms
rank =  0, Distribute data + matrix mult took 15.123 ms
rank =  0, finding HY took 16.996 ms
rank =  0, distributing HY into block cyclic form took 8.476 ms
rank =  0, finding Y'*HY took 4.629 ms
Rank 0, Project_Hamiltonian used 45.258 ms
Total time for projection: 45.261 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -1.159404802307591
    last  calculated eigval = 0.122307918146059
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.15940480230759
lambda[   2] =  -1.13405695712504
lambda[   3] =  -0.59012072911408
lambda[   4] =  -0.56067080609228
lambda[   5] =  -0.52620559911916
lambda[   6] =  -0.52554067200749
lambda[   7] =  -0.41564193002616
lambda[   8] =  -0.39366145783505
lambda[   9] =   0.00757026330397
lambda[  10] =   0.02716497759540
lambda[  11] =   0.07434984095325
lambda[  12] =   0.08392489390797
lambda[  13] =   0.11416162775633
lambda[  14] =   0.12230791814606
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 1.899 ms
rank =  0, Distributing orbital back into band + domain format took 8.146 ms
rank = 0, Subspace_Rotation used 10.060 ms

Total time for subspace rotation: 10.065 ms
rank = 0, Efermi =  -0.023427495171 calculate fermi energy took 0.018 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.222308, lowerbound = -1.258473, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 998.201 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 13.639 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.255 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 4.211 ms
rank =  0, Distribute data + matrix mult took 19.125 ms
rank =  0, finding HY took 16.880 ms
rank =  0, distributing HY into block cyclic form took 8.415 ms
rank =  0, finding Y'*HY took 4.729 ms
Rank 0, Project_Hamiltonian used 49.180 ms
Total time for projection: 49.185 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -1.159451461846758
    last  calculated eigval = 0.074003616274805
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.15945146184676
lambda[   2] =  -1.13420739415336
lambda[   3] =  -0.59922307461162
lambda[   4] =  -0.56858870738866
lambda[   5] =  -0.53117834731923
lambda[   6] =  -0.53116088346041
lambda[   7] =  -0.42140139553135
lambda[   8] =  -0.42125737721388
lambda[   9] =  -0.05745772713194
lambda[  10] =  -0.04279590120030
lambda[  11] =   0.00366603358144
lambda[  12] =   0.03712533429889
lambda[  13] =   0.06467605410295
lambda[  14] =   0.07400361627480
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 1.915 ms
rank =  0, Distributing orbital back into band + domain format took 8.137 ms
rank = 0, Subspace_Rotation used 10.069 ms

Total time for subspace rotation: 10.073 ms
rank = 0, Efermi =  -0.088455485917 calculate fermi energy took 0.019 ms
rank = 0, --- Calculate rho: sum over local bands took 4.747 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.599 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.055 ms
rank = 0, Calculating density took 4519.668 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.350 ms
rank = 0, D2D took 2.435 ms
rank = 0, Transfering density took 2.439 ms
Etot    =   -39.185472976333
Eband   =   -10.732937283192
E1      =    19.265007926765
E2      =    -9.634758718622
E3      =   -11.168184367915
Exc     =   -10.139170017065
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 1.306e+01, dEband = 3.578e+00
rank = 0, Calculating/Estimating energy took 1.005 ms, Etot = -39.185472976, dEtot = 1.306e+01, dEband = 3.578e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 50.7457919464730, which took 0.211 ms

iter_count = 90, r_2norm = 1.534e-03, tol*||rhs|| = 2.030e-03

Anderson update took 47.967 ms, out of which F'*F took 29.942 ms; b-Ax took 173.534 ms, out of which Lap took 165.821 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 284.889 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245550, int_b + int_rho = -4.056e-13, checking this took 0.247 ms
2-norm of RHS = 463.6078090086498, which took 0.267 ms

iter_count = 270, r_2norm = 4.132e-04, tol*||rhs|| = 4.636e-04

Anderson update took 147.805 ms, out of which F'*F took 90.375 ms; b-Ax took 518.405 ms, out of which Lap took 495.648 ms
Solving Poisson took 843.132 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.430 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.066113 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.369 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.075915 
Total time for convolution: 	 convolve: 5.130488 
Total time for convolution: 	 convolve: 5.074698 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.370 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.145 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.125 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.136 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.214 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.166 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.676 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.014 ms

This SCF took 29974.536 ms, scf error = 1.277e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.174004, lowerbound = -1.159451, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1049.527 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.345 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.255 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 5.131 ms
rank =  0, Distribute data + matrix mult took 14.752 ms
rank =  0, finding HY took 17.151 ms
rank =  0, distributing HY into block cyclic form took 8.428 ms
rank =  0, finding Y'*HY took 4.711 ms
Rank 0, Project_Hamiltonian used 45.077 ms
Total time for projection: 45.090 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -1.125609125711180
    last  calculated eigval = 0.050862277805508
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.12560912571118
lambda[   2] =  -1.09469518531571
lambda[   3] =  -0.55963200384484
lambda[   4] =  -0.52439477172301
lambda[   5] =  -0.50634037051087
lambda[   6] =  -0.50632715044997
lambda[   7] =  -0.37936600135771
lambda[   8] =  -0.37934211754485
lambda[   9] =  -0.05128194475510
lambda[  10] =  -0.04680275929320
lambda[  11] =  -0.02543408809085
lambda[  12] =   0.02009687105615
lambda[  13] =   0.04258720263598
lambda[  14] =   0.05086227780551
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 1.923 ms
rank =  0, Distributing orbital back into band + domain format took 8.144 ms
rank = 0, Subspace_Rotation used 10.087 ms

Total time for subspace rotation: 10.092 ms
rank = 0, Efermi =  -0.082282708624 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 1.326 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.633 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.051 ms
rank = 0, Calculating density took 1106.997 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
rank = 0, D2D took 4.229 ms
rank = 0, Transfering density took 4.230 ms
Etot    =   -39.139578669126
Eband   =   -10.151413453042
E1      =    18.808061710495
E2      =    -9.521618352950
E3      =   -11.323143373685
Exc     =   -10.259671963833
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 1.530e-02, dEband = 1.938e-01
rank = 0, Calculating/Estimating energy took 0.986 ms, Etot = -39.139578669, dEtot = 1.530e-02, dEband = 1.938e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 21.9106338931020, which took 0.297 ms

iter_count = 96, r_2norm = 5.931e-04, tol*||rhs|| = 8.764e-04

Anderson update took 52.294 ms, out of which F'*F took 32.787 ms; b-Ax took 187.808 ms, out of which Lap took 179.518 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 310.703 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245549, int_b + int_rho = -4.111e-13, checking this took 0.257 ms
2-norm of RHS = 462.0984887583464, which took 0.253 ms

iter_count = 276, r_2norm = 3.919e-04, tol*||rhs|| = 4.621e-04

Anderson update took 145.809 ms, out of which F'*F took 92.686 ms; b-Ax took 536.912 ms, out of which Lap took 513.282 ms
Solving Poisson took 860.239 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.653 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
Total time for convolution: 	 convolve: 5.098140 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.069891 
Total time for convolution: 	 convolve: 5.066633 
Total time for convolution: 	 convolve: 5.067871 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.488 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.139 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.134 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.383 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 0.709 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.324 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.051 ms

This SCF took 26667.534 ms, scf error = 6.725e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.150862, lowerbound = -1.125609, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1060.106 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.574 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.593 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 4.740 ms
rank =  0, Distribute data + matrix mult took 14.925 ms
rank =  0, finding HY took 18.362 ms
rank =  0, distributing HY into block cyclic form took 8.692 ms
rank =  0, finding Y'*HY took 4.636 ms
Rank 0, Project_Hamiltonian used 46.648 ms
Total time for projection: 46.664 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.095 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -1.096602500355468
    last  calculated eigval = 0.040119671225580
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.09660250035547
lambda[   2] =  -1.06200225422814
lambda[   3] =  -0.52995498265953
lambda[   4] =  -0.49139108139502
lambda[   5] =  -0.48547316617551
lambda[   6] =  -0.48546634707348
lambda[   7] =  -0.35050477074105
lambda[   8] =  -0.35048359913626
lambda[   9] =  -0.04201506215305
lambda[  10] =  -0.03410587671795
lambda[  11] =  -0.02754262011512
lambda[  12] =   0.01565621625443
lambda[  13] =   0.03417430191857
lambda[  14] =   0.04011967122558
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 1.992 ms
rank =  0, Distributing orbital back into band + domain format took 8.322 ms
rank = 0, Subspace_Rotation used 10.332 ms

Total time for subspace rotation: 10.338 ms
rank = 0, Efermi =  -0.073012845078 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 1.413 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.632 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.052 ms
rank = 0, Calculating density took 1119.483 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
rank = 0, D2D took 4.113 ms
rank = 0, Transfering density took 4.116 ms
Etot    =   -39.126107172350
Eband   =    -9.703757403632
E1      =    18.467660573306
E2      =    -9.401468293350
E3      =   -11.438936038318
Exc     =   -10.349097984314
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 4.490e-03, dEband = 1.492e-01
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -39.126107172, dEtot = 4.490e-03, dEband = 1.492e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 2.9360709445034, which took 0.190 ms

iter_count = 102, r_2norm = 1.137e-04, tol*||rhs|| = 1.174e-04

Anderson update took 55.110 ms, out of which F'*F took 33.337 ms; b-Ax took 195.662 ms, out of which Lap took 186.546 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 327.868 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245549, int_b + int_rho = -4.147e-13, checking this took 0.252 ms
2-norm of RHS = 464.4721367874590, which took 0.253 ms

iter_count = 282, r_2norm = 3.814e-04, tol*||rhs|| = 4.645e-04

Anderson update took 150.739 ms, out of which F'*F took 93.623 ms; b-Ax took 544.241 ms, out of which Lap took 520.116 ms
Solving Poisson took 879.909 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.562 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Total time for convolution: 	 convolve: 5.131370 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.096242 
Total time for convolution: 	 convolve: 5.088658 
Total time for convolution: 	 convolve: 5.094455 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.305 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.143 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.327 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.028 ms

This SCF took 26738.136 ms, scf error = 3.573e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.140120, lowerbound = -1.096603, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1016.873 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.054 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.311 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.028 ms
rank =  0, Distribute data + matrix mult took 13.407 ms
rank =  0, finding HY took 17.259 ms
rank =  0, distributing HY into block cyclic form took 9.011 ms
rank =  0, finding Y'*HY took 4.230 ms
Rank 0, Project_Hamiltonian used 43.940 ms
Total time for projection: 43.952 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -1.072551938187058
    last  calculated eigval = 0.036284931590562
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.07255193818706
lambda[   2] =  -1.03683345222720
lambda[   3] =  -0.50978439405629
lambda[   4] =  -0.46926625424354
lambda[   5] =  -0.46704998998026
lambda[   6] =  -0.46704791121946
lambda[   7] =  -0.33468484332732
lambda[   8] =  -0.33468165315128
lambda[   9] =  -0.04036287341485
lambda[  10] =  -0.01546145434136
lambda[  11] =  -0.01372222815192
lambda[  12] =   0.01430083488411
lambda[  13] =   0.02884063181308
lambda[  14] =   0.03628493159056
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 2.127 ms
rank =  0, Distributing orbital back into band + domain format took 8.831 ms
rank = 0, Subspace_Rotation used 10.973 ms

Total time for subspace rotation: 10.978 ms
rank = 0, Efermi =  -0.071360632129 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.750 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.464 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.055 ms
rank = 0, Calculating density took 1074.367 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
rank = 0, D2D took 3.296 ms
rank = 0, Transfering density took 3.298 ms
Etot    =   -39.121967091073
Eband   =    -9.383800872884
E1      =    18.262430462426
E2      =    -9.273034950641
E3      =   -11.511077449851
Exc     =   -10.403392391728
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 1.380e-03, dEband = 1.067e-01
rank = 0, Calculating/Estimating energy took 0.903 ms, Etot = -39.121967091, dEtot = 1.380e-03, dEband = 1.067e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 2.0086902773397, which took 0.175 ms

iter_count = 102, r_2norm = 6.912e-05, tol*||rhs|| = 8.035e-05

Anderson update took 55.260 ms, out of which F'*F took 32.250 ms; b-Ax took 189.034 ms, out of which Lap took 179.374 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 326.065 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245548, int_b + int_rho = -4.238e-13, checking this took 0.124 ms
2-norm of RHS = 465.1677553619227, which took 0.267 ms

iter_count = 240, r_2norm = 3.566e-04, tol*||rhs|| = 4.652e-04

Anderson update took 128.374 ms, out of which F'*F took 76.199 ms; b-Ax took 474.052 ms, out of which Lap took 451.270 ms
Solving Poisson took 776.182 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Total time for convolution: 	 convolve: 5.125746 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.113269 
Total time for convolution: 	 convolve: 5.085728 
Total time for convolution: 	 convolve: 5.089618 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.286 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.146 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.143 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.688 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.317 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.020 ms

This SCF took 26584.546 ms, scf error = 7.132e-03
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.136285, lowerbound = -1.072552, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1056.464 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.129 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.309 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.986 ms
rank =  0, Distribute data + matrix mult took 14.443 ms
rank =  0, finding HY took 17.186 ms
rank =  0, distributing HY into block cyclic form took 9.075 ms
rank =  0, finding Y'*HY took 4.073 ms
Rank 0, Project_Hamiltonian used 44.813 ms
Total time for projection: 44.830 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.041 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -1.071018875188815
    last  calculated eigval = 0.034282749962277
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.07101887518881
lambda[   2] =  -1.03500600194010
lambda[   3] =  -0.50708743125566
lambda[   4] =  -0.46635968942287
lambda[   5] =  -0.46573612806229
lambda[   6] =  -0.46573394472982
lambda[   7] =  -0.33234557966000
lambda[   8] =  -0.33234508083373
lambda[   9] =  -0.04068656354291
lambda[  10] =  -0.01427609809714
lambda[  11] =  -0.01344010594225
lambda[  12] =   0.01287027675842
lambda[  13] =   0.02677451004081
lambda[  14] =   0.03428274996228
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 1.985 ms
rank =  0, Distributing orbital back into band + domain format took 8.809 ms
rank = 0, Subspace_Rotation used 10.807 ms

Total time for subspace rotation: 10.812 ms
rank = 0, Efermi =  -0.071684322171 calculate fermi energy took 3.005 ms
rank = 0, --- Calculate rho: sum over local bands took 1.376 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.603 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.051 ms
rank = 0, Calculating density took 1117.375 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.396 ms
rank = 0, D2D took 0.950 ms
rank = 0, Transfering density took 0.952 ms
Etot    =   -39.121611730140
Eband   =    -9.351265462286
E1      =    18.253465788716
E2      =    -9.247446724532
E3      =   -11.517862554850
Exc     =   -10.407804646573
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 1.185e-04, dEband = 1.085e-02
rank = 0, Calculating/Estimating energy took 1.710 ms, Etot = -39.121611730, dEtot = 1.185e-04, dEband = 1.085e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5620919827766, which took 0.239 ms

iter_count = 108, r_2norm = 2.160e-05, tol*||rhs|| = 2.248e-05

Anderson update took 57.139 ms, out of which F'*F took 33.824 ms; b-Ax took 200.596 ms, out of which Lap took 190.497 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 344.992 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245550, int_b + int_rho = -4.056e-13, checking this took 0.183 ms
2-norm of RHS = 465.9583494313059, which took 0.266 ms

iter_count = 240, r_2norm = 4.093e-04, tol*||rhs|| = 4.660e-04

Anderson update took 127.201 ms, out of which F'*F took 76.616 ms; b-Ax took 450.073 ms, out of which Lap took 427.194 ms
Solving Poisson took 752.420 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.137 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Total time for convolution: 	 convolve: 5.087765 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.102158 
Total time for convolution: 	 convolve: 5.088468 
Total time for convolution: 	 convolve: 5.089508 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.167 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.137 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.705 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.328 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.050 ms

This SCF took 26574.147 ms, scf error = 4.424e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.134283, lowerbound = -1.071019, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1048.085 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.212 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.335 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.672 ms
rank =  0, Distribute data + matrix mult took 14.234 ms
rank =  0, finding HY took 17.254 ms
rank =  0, distributing HY into block cyclic form took 9.047 ms
rank =  0, finding Y'*HY took 4.072 ms
Rank 0, Project_Hamiltonian used 44.636 ms
Total time for projection: 44.651 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -1.070812735226300
    last  calculated eigval = 0.033418965993072
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.07081273522630
lambda[   2] =  -1.03472018024057
lambda[   3] =  -0.50568902429894
lambda[   4] =  -0.46528831101195
lambda[   5] =  -0.46528686100182
lambda[   6] =  -0.46494589574443
lambda[   7] =  -0.33135600426208
lambda[   8] =  -0.33135366548984
lambda[   9] =  -0.04060385153358
lambda[  10] =  -0.01379225253787
lambda[  11] =  -0.01339115312122
lambda[  12] =   0.01149750854169
lambda[  13] =   0.02591591864566
lambda[  14] =   0.03341896599307
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 1.986 ms
rank =  0, Distributing orbital back into band + domain format took 9.064 ms
rank = 0, Subspace_Rotation used 11.066 ms

Total time for subspace rotation: 11.071 ms
rank = 0, Efermi =  -0.071601610226 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.456 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.638 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.053 ms
rank = 0, Calculating density took 1106.225 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.417 ms
rank = 0, D2D took 4.146 ms
rank = 0, Transfering density took 4.152 ms
Etot    =   -39.121383068424
Eband   =    -9.338905354652
E1      =    18.261724462900
E2      =    -9.226004679728
E3      =   -11.518385898510
Exc     =   -10.407276065532
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 7.622e-05, dEband = 4.120e-03
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -39.121383068, dEtot = 7.622e-05, dEband = 4.120e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3538229328028, which took 0.268 ms

iter_count = 108, r_2norm = 9.432e-06, tol*||rhs|| = 1.415e-05

Anderson update took 56.809 ms, out of which F'*F took 34.115 ms; b-Ax took 201.544 ms, out of which Lap took 191.285 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 345.888 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245551, int_b + int_rho = -3.911e-13, checking this took 0.223 ms
2-norm of RHS = 465.8414976083243, which took 0.231 ms

iter_count = 240, r_2norm = 3.899e-04, tol*||rhs|| = 4.658e-04

Anderson update took 128.055 ms, out of which F'*F took 76.428 ms; b-Ax took 449.652 ms, out of which Lap took 426.660 ms
Solving Poisson took 750.912 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Total time for convolution: 	 convolve: 5.096896 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Total time for convolution: 	 convolve: 5.140238 
Total time for convolution: 	 convolve: 5.202318 
Total time for convolution: 	 convolve: 5.145031 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.838 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.412 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.696 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.338 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.051 ms

This SCF took 26825.921 ms, scf error = 2.029e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.133419, lowerbound = -1.070813, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1044.743 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 9.426 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.411 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.561 ms
rank =  0, Distribute data + matrix mult took 14.419 ms
rank =  0, finding HY took 18.056 ms
rank =  0, distributing HY into block cyclic form took 9.183 ms
rank =  0, finding Y'*HY took 3.889 ms
Rank 0, Project_Hamiltonian used 45.584 ms
Total time for projection: 45.625 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -1.068375072152999
    last  calculated eigval = 0.031648535400693
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06837507215300
lambda[   2] =  -1.03221681293649
lambda[   3] =  -0.50322727708565
lambda[   4] =  -0.46313556153354
lambda[   5] =  -0.46313484138651
lambda[   6] =  -0.46241502885514
lambda[   7] =  -0.32928303863317
lambda[   8] =  -0.32928202617495
lambda[   9] =  -0.04011528265967
lambda[  10] =  -0.01162035410690
lambda[  11] =  -0.01141362956626
lambda[  12] =   0.01006228277820
lambda[  13] =   0.02596797784715
lambda[  14] =   0.03164853540069
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 1.972 ms
rank =  0, Distributing orbital back into band + domain format took 8.793 ms
rank = 0, Subspace_Rotation used 10.777 ms

Total time for subspace rotation: 10.782 ms
rank = 0, Efermi =  -0.071113041049 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 1.518 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.615 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.057 ms
rank = 0, Calculating density took 1103.642 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.396 ms
rank = 0, D2D took 4.046 ms
rank = 0, Transfering density took 4.056 ms
Etot    =   -39.121510462604
Eband   =    -9.302139317615
E1      =    18.239564166733
E2      =    -9.209841130046
E3      =   -11.524549577160
Exc     =   -10.412009329549
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 4.246e-05, dEband = 1.226e-02
rank = 0, Calculating/Estimating energy took 0.899 ms, Etot = -39.121510463, dEtot = 4.246e-05, dEband = 1.226e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2119366001181, which took 0.164 ms

iter_count = 108, r_2norm = 5.879e-06, tol*||rhs|| = 8.477e-06

Anderson update took 57.859 ms, out of which F'*F took 34.375 ms; b-Ax took 204.694 ms, out of which Lap took 194.237 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 348.042 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245554, int_b + int_rho = -3.638e-13, checking this took 0.182 ms
2-norm of RHS = 465.9121217181620, which took 0.156 ms

iter_count = 204, r_2norm = 3.800e-04, tol*||rhs|| = 4.659e-04

Anderson update took 108.325 ms, out of which F'*F took 65.314 ms; b-Ax took 385.116 ms, out of which Lap took 365.340 ms
Solving Poisson took 644.174 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.140366 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.158692 
Total time for convolution: 	 convolve: 5.116965 
Total time for convolution: 	 convolve: 5.113618 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.524 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.141 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.161 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.449 ms
---Transfer Veff_loc: D2D took 0.710 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.327 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.062 ms

This SCF took 26608.402 ms, scf error = 8.821e-04
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.131649, lowerbound = -1.068375, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1047.091 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.961 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.293 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.700 ms
rank =  0, Distribute data + matrix mult took 13.971 ms
rank =  0, finding HY took 17.459 ms
rank =  0, distributing HY into block cyclic form took 8.809 ms
rank =  0, finding Y'*HY took 4.224 ms
Rank 0, Project_Hamiltonian used 44.498 ms
Total time for projection: 44.512 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -1.067926556376757
    last  calculated eigval = 0.031187805493524
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06792655637676
lambda[   2] =  -1.03172829127713
lambda[   3] =  -0.50260346512807
lambda[   4] =  -0.46269823256183
lambda[   5] =  -0.46269777484110
lambda[   6] =  -0.46177682701512
lambda[   7] =  -0.32864684402199
lambda[   8] =  -0.32864640234306
lambda[   9] =  -0.03963211526969
lambda[  10] =  -0.01121447177010
lambda[  11] =  -0.01109649703053
lambda[  12] =   0.00966233956790
lambda[  13] =   0.02598972127502
lambda[  14] =   0.03118780549352
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 2.168 ms
rank =  0, Distributing orbital back into band + domain format took 8.602 ms
rank = 0, Subspace_Rotation used 10.795 ms

Total time for subspace rotation: 10.799 ms
rank = 0, Efermi =  -0.070629873522 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 1.348 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.607 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.055 ms
rank = 0, Calculating density took 1104.747 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.405 ms
rank = 0, D2D took 3.966 ms
rank = 0, Transfering density took 3.972 ms
Etot    =   -39.121562308724
Eband   =    -9.293448787227
E1      =    18.236269820056
E2      =    -9.204031312122
E3      =   -11.525667134707
Exc     =   -10.412765099002
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 1.728e-05, dEband = 2.897e-03
rank = 0, Calculating/Estimating energy took 0.934 ms, Etot = -39.121562309, dEtot = 1.728e-05, dEband = 2.897e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1579410788479, which took 0.280 ms

iter_count = 102, r_2norm = 4.821e-06, tol*||rhs|| = 6.318e-06

Anderson update took 54.146 ms, out of which F'*F took 32.413 ms; b-Ax took 192.069 ms, out of which Lap took 182.405 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 327.125 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245551, int_b + int_rho = -3.893e-13, checking this took 0.224 ms
2-norm of RHS = 465.9616736666438, which took 0.229 ms

iter_count = 222, r_2norm = 4.304e-04, tol*||rhs|| = 4.660e-04

Anderson update took 115.372 ms, out of which F'*F took 72.654 ms; b-Ax took 421.107 ms, out of which Lap took 400.072 ms
Solving Poisson took 698.640 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 5.139098 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.118933 
Total time for convolution: 	 convolve: 5.132315 
Total time for convolution: 	 convolve: 5.092664 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.601 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.140 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.154 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.416 ms
---Transfer Veff_loc: D2D took 0.685 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.321 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.029 ms

This SCF took 26584.909 ms, scf error = 6.501e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.131188, lowerbound = -1.067927, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1050.737 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.237 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.309 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.649 ms
rank =  0, Distribute data + matrix mult took 14.217 ms
rank =  0, finding HY took 17.443 ms
rank =  0, distributing HY into block cyclic form took 9.059 ms
rank =  0, finding Y'*HY took 3.980 ms
Rank 0, Project_Hamiltonian used 44.734 ms
Total time for projection: 44.746 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -1.066358184039905
    last  calculated eigval = 0.032660654320425
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06635818403990
lambda[   2] =  -1.03017952992296
lambda[   3] =  -0.50117398926946
lambda[   4] =  -0.46119121859475
lambda[   5] =  -0.46119088173233
lambda[   6] =  -0.46035395877760
lambda[   7] =  -0.32725861793497
lambda[   8] =  -0.32725822646586
lambda[   9] =  -0.03550654685011
lambda[  10] =  -0.00955270783013
lambda[  11] =  -0.00946494672870
lambda[  12] =   0.01006821038218
lambda[  13] =   0.02906972679925
lambda[  14] =   0.03266065432043
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 2.066 ms
rank =  0, Distributing orbital back into band + domain format took 8.978 ms
rank = 0, Subspace_Rotation used 11.065 ms

Total time for subspace rotation: 11.070 ms
rank = 0, Efermi =  -0.066504305685 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 1.568 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.569 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.052 ms
rank = 0, Calculating density took 1109.122 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.038 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.427 ms
rank = 0, D2D took 3.546 ms
rank = 0, Transfering density took 3.552 ms
Etot    =   -39.121626059035
Eband   =    -9.269929213563
E1      =    18.224525103506
E2      =    -9.191679519411
E3      =   -11.527933298954
Exc     =   -10.414518077964
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 2.125e-05, dEband = 7.840e-03
rank = 0, Calculating/Estimating energy took 0.933 ms, Etot = -39.121626059, dEtot = 2.125e-05, dEband = 7.840e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0974431400467, which took 0.241 ms

iter_count = 108, r_2norm = 2.602e-06, tol*||rhs|| = 3.898e-06

Anderson update took 57.764 ms, out of which F'*F took 34.269 ms; b-Ax took 203.437 ms, out of which Lap took 193.293 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 346.671 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245552, int_b + int_rho = -3.783e-13, checking this took 0.236 ms
2-norm of RHS = 465.9526835340668, which took 0.224 ms

iter_count = 174, r_2norm = 4.464e-04, tol*||rhs|| = 4.660e-04

Anderson update took 91.969 ms, out of which F'*F took 55.909 ms; b-Ax took 327.727 ms, out of which Lap took 311.661 ms
Solving Poisson took 547.665 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.167 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Total time for convolution: 	 convolve: 5.132252 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.114064 
Total time for convolution: 	 convolve: 5.096071 
Total time for convolution: 	 convolve: 5.102958 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.160 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.142 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.159 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.433 ms
---Transfer Veff_loc: D2D took 0.692 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.030 ms

This SCF took 26448.931 ms, scf error = 3.420e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.132661, lowerbound = -1.066358, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1035.344 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.515 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.345 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.781 ms
rank =  0, Distribute data + matrix mult took 18.655 ms
rank =  0, finding HY took 17.397 ms
rank =  0, distributing HY into block cyclic form took 9.353 ms
rank =  0, finding Y'*HY took 3.800 ms
Rank 0, Project_Hamiltonian used 49.239 ms
Total time for projection: 49.257 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -1.065958517925569
    last  calculated eigval = 0.032054911371791
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06595851792557
lambda[   2] =  -1.02976245322647
lambda[   3] =  -0.50075966322293
lambda[   4] =  -0.46082629175125
lambda[   5] =  -0.46082611519484
lambda[   6] =  -0.45992916366109
lambda[   7] =  -0.32684706494204
lambda[   8] =  -0.32684689071451
lambda[   9] =  -0.03465156560276
lambda[  10] =  -0.00918558657740
lambda[  11] =  -0.00913394880657
lambda[  12] =   0.00977932038456
lambda[  13] =   0.02990105410079
lambda[  14] =   0.03205491137179
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 2.606 ms
rank =  0, Distributing orbital back into band + domain format took 8.637 ms
rank = 0, Subspace_Rotation used 11.262 ms

Total time for subspace rotation: 11.268 ms
rank = 0, Efermi =  -0.065649324199 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 1.373 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.603 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.054 ms
rank = 0, Calculating density took 1098.711 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.402 ms
rank = 0, D2D took 2.909 ms
rank = 0, Transfering density took 2.914 ms
Etot    =   -39.121655366947
Eband   =    -9.263512321362
E1      =    18.220845047901
E2      =    -9.188722005845
E3      =   -11.528828955121
Exc     =   -10.415222365073
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 9.769e-06, dEband = 2.139e-03
rank = 0, Calculating/Estimating energy took 0.892 ms, Etot = -39.121655367, dEtot = 9.769e-06, dEband = 2.139e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0561183156645, which took 0.210 ms

iter_count = 108, r_2norm = 1.410e-06, tol*||rhs|| = 2.245e-06

Anderson update took 57.813 ms, out of which F'*F took 34.212 ms; b-Ax took 203.186 ms, out of which Lap took 192.805 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 346.863 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245557, int_b + int_rho = -3.292e-13, checking this took 0.228 ms
2-norm of RHS = 465.9641520971494, which took 0.242 ms

iter_count = 192, r_2norm = 4.263e-04, tol*||rhs|| = 4.660e-04

Anderson update took 100.502 ms, out of which F'*F took 62.469 ms; b-Ax took 361.717 ms, out of which Lap took 343.418 ms
Solving Poisson took 605.386 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Total time for convolution: 	 convolve: 5.089907 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.723 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.089637 
Total time for convolution: 	 convolve: 5.114483 
Total time for convolution: 	 convolve: 5.092088 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.820 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.137 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.146 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.284 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.432 ms
---Transfer Veff_loc: D2D took 0.705 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.315 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.045 ms

This SCF took 26585.873 ms, scf error = 2.594e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.132055, lowerbound = -1.065959, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1050.473 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 9.840 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.301 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.059 ms
rank =  0, Distribute data + matrix mult took 14.220 ms
rank =  0, finding HY took 17.496 ms
rank =  0, distributing HY into block cyclic form took 9.199 ms
rank =  0, finding Y'*HY took 3.843 ms
Rank 0, Project_Hamiltonian used 44.788 ms
Total time for projection: 44.803 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.605 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.695 ms
    first calculated eigval = -1.065659643489872
    last  calculated eigval = 0.034192733477543
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06565964348987
lambda[   2] =  -1.02948994585912
lambda[   3] =  -0.50047314625199
lambda[   4] =  -0.46048061602174
lambda[   5] =  -0.46048050733575
lambda[   6] =  -0.45966898239448
lambda[   7] =  -0.32656208526964
lambda[   8] =  -0.32656192228903
lambda[   9] =  -0.03222714734612
lambda[  10] =  -0.00883555611097
lambda[  11] =  -0.00880638586699
lambda[  12] =   0.00988829744854
lambda[  13] =   0.03359363448723
lambda[  14] =   0.03419273347754
==subpsace eigenproblem: bcast eigvals took 0.171 ms
Total time for solving subspace eigenvalue problem: 1.548 ms
rank =  0, subspace rotation using ScaLAPACK took 2.197 ms
rank =  0, Distributing orbital back into band + domain format took 8.916 ms
rank = 0, Subspace_Rotation used 11.137 ms

Total time for subspace rotation: 11.142 ms
rank = 0, Efermi =  -0.063224906086 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.453 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.609 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.055 ms
rank = 0, Calculating density took 1110.239 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.413 ms
rank = 0, D2D took 3.449 ms
rank = 0, Transfering density took 3.455 ms
Etot    =   -39.121686219793
Eband   =    -9.258753697902
E1      =    18.219273768818
E2      =    -9.185605738087
E3      =   -11.528509281149
Exc     =   -10.415004620566
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 1.028e-05, dEband = 1.586e-03
rank = 0, Calculating/Estimating energy took 0.933 ms, Etot = -39.121686220, dEtot = 1.028e-05, dEband = 1.586e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0666671732282, which took 0.246 ms

iter_count = 102, r_2norm = 2.294e-06, tol*||rhs|| = 2.667e-06

Anderson update took 54.403 ms, out of which F'*F took 32.423 ms; b-Ax took 191.414 ms, out of which Lap took 181.872 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 327.935 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245548, int_b + int_rho = -4.184e-13, checking this took 0.228 ms
2-norm of RHS = 465.9601849246011, which took 0.249 ms

iter_count = 156, r_2norm = 4.246e-04, tol*||rhs|| = 4.660e-04

Anderson update took 82.872 ms, out of which F'*F took 49.955 ms; b-Ax took 291.616 ms, out of which Lap took 277.240 ms
Solving Poisson took 490.940 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 5.094441 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.753 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.095 ms
Total time for convolution: 	 convolve: 5.114410 
Total time for convolution: 	 convolve: 5.120369 
Total time for convolution: 	 convolve: 5.131248 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.523 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.163 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.155 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.417 ms
---Transfer Veff_loc: D2D took 0.685 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.329 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.040 ms

This SCF took 26416.305 ms, scf error = 2.653e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.134193, lowerbound = -1.065660, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1024.178 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.144 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.299 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.592 ms
rank =  0, Distribute data + matrix mult took 13.054 ms
rank =  0, finding HY took 17.499 ms
rank =  0, distributing HY into block cyclic form took 9.329 ms
rank =  0, finding Y'*HY took 3.783 ms
Rank 0, Project_Hamiltonian used 44.238 ms
Total time for projection: 44.253 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -1.065484811364607
    last  calculated eigval = 0.035557022844937
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06548481136461
lambda[   2] =  -1.02930714605306
lambda[   3] =  -0.50028348404223
lambda[   4] =  -0.46031966703038
lambda[   5] =  -0.46031954501642
lambda[   6] =  -0.45947355899872
lambda[   7] =  -0.32637829024883
lambda[   8] =  -0.32637808925659
lambda[   9] =  -0.03169155646220
lambda[  10] =  -0.00869428508062
lambda[  11] =  -0.00867972441715
lambda[  12] =   0.01001528262612
lambda[  13] =   0.03412793760597
lambda[  14] =   0.03555702284494
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 2.163 ms
rank =  0, Distributing orbital back into band + domain format took 9.122 ms
rank = 0, Subspace_Rotation used 11.303 ms

Total time for subspace rotation: 11.308 ms
rank = 0, Efermi =  -0.062689315182 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 1.377 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.574 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.052 ms
rank = 0, Calculating density took 1082.048 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.026 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.434 ms
rank = 0, D2D took 3.366 ms
rank = 0, Transfering density took 3.373 ms
Etot    =   -39.121696200085
Eband   =    -9.255889184099
E1      =    18.217710060625
E2      =    -9.184239223232
E3      =   -11.528807305252
Exc     =   -10.415246915716
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 3.327e-06, dEband = 9.548e-04
rank = 0, Calculating/Estimating energy took 0.986 ms, Etot = -39.121696200, dEtot = 3.327e-06, dEband = 9.548e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0635943904832, which took 0.251 ms

iter_count = 102, r_2norm = 2.430e-06, tol*||rhs|| = 2.544e-06

Anderson update took 54.242 ms, out of which F'*F took 32.198 ms; b-Ax took 190.832 ms, out of which Lap took 181.067 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 326.811 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245553, int_b + int_rho = -3.729e-13, checking this took 0.194 ms
2-norm of RHS = 465.9582388569027, which took 0.236 ms

iter_count = 54, r_2norm = 4.063e-04, tol*||rhs|| = 4.660e-04

Anderson update took 28.261 ms, out of which F'*F took 17.790 ms; b-Ax took 102.006 ms, out of which Lap took 96.933 ms
Solving Poisson took 172.009 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.163 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Total time for convolution: 	 convolve: 5.093113 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.268 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.111498 
Total time for convolution: 	 convolve: 5.097665 
Total time for convolution: 	 convolve: 5.096578 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.135 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.195 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.433 ms
---Transfer Veff_loc: D2D took 0.696 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.316 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.040 ms

This SCF took 26003.836 ms, scf error = 2.050e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.135557, lowerbound = -1.065485, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1020.849 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.062 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.310 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.787 ms
rank =  0, Distribute data + matrix mult took 13.170 ms
rank =  0, finding HY took 17.421 ms
rank =  0, distributing HY into block cyclic form took 9.122 ms
rank =  0, finding Y'*HY took 3.941 ms
Rank 0, Project_Hamiltonian used 43.682 ms
Total time for projection: 43.694 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.095 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.165 ms
    first calculated eigval = -1.065486706907095
    last  calculated eigval = 0.035256399624886
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06548670690710
lambda[   2] =  -1.02930867521320
lambda[   3] =  -0.50028581830518
lambda[   4] =  -0.46032259899766
lambda[   5] =  -0.46032247842601
lambda[   6] =  -0.45947546371450
lambda[   7] =  -0.32638110343555
lambda[   8] =  -0.32638089920274
lambda[   9] =  -0.03182003755544
lambda[  10] =  -0.00870408335040
lambda[  11] =  -0.00869689833194
lambda[  12] =   0.00984207290735
lambda[  13] =   0.03391032639945
lambda[  14] =   0.03525639962489
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.181 ms
rank =  0, subspace rotation using ScaLAPACK took 1.979 ms
rank =  0, Distributing orbital back into band + domain format took 9.008 ms
rank = 0, Subspace_Rotation used 11.004 ms

Total time for subspace rotation: 11.008 ms
rank = 0, Efermi =  -0.062817795820 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.566 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.585 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.053 ms
rank = 0, Calculating density took 1078.070 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.391 ms
rank = 0, D2D took 3.352 ms
rank = 0, Transfering density took 3.356 ms
Etot    =   -39.121700961774
Eband   =    -9.255927488482
E1      =    18.217688255469
E2      =    -9.184296837370
E3      =   -11.528802677550
Exc     =   -10.415244554302
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 1.587e-06, dEband = 1.277e-05
rank = 0, Calculating/Estimating energy took 0.968 ms, Etot = -39.121700962, dEtot = 1.587e-06, dEband = 1.277e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0668066830495, which took 0.162 ms

iter_count = 102, r_2norm = 2.468e-06, tol*||rhs|| = 2.672e-06

Anderson update took 54.299 ms, out of which F'*F took 32.406 ms; b-Ax took 192.267 ms, out of which Lap took 182.550 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 327.989 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245549, int_b + int_rho = -4.147e-13, checking this took 0.222 ms
2-norm of RHS = 465.9615106586675, which took 0.160 ms

iter_count = 72, r_2norm = 4.158e-04, tol*||rhs|| = 4.660e-04

Anderson update took 37.934 ms, out of which F'*F took 23.026 ms; b-Ax took 135.248 ms, out of which Lap took 128.392 ms
Solving Poisson took 228.182 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 5.125201 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.140996 
Total time for convolution: 	 convolve: 5.197007 
Total time for convolution: 	 convolve: 5.167174 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 4.378 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.154 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.512 ms
---Transfer Veff_loc: D2D took 0.792 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.326 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.521 ms

This SCF took 26369.224 ms, scf error = 2.017e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135256, lowerbound = -1.065487, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1020.674 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 9.349 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.292 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.433 ms
rank =  0, Distribute data + matrix mult took 13.089 ms
rank =  0, finding HY took 17.576 ms
rank =  0, distributing HY into block cyclic form took 9.110 ms
rank =  0, finding Y'*HY took 3.932 ms
Rank 0, Project_Hamiltonian used 43.744 ms
Total time for projection: 43.757 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -1.065501726895388
    last  calculated eigval = 0.035037935331441
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06550172689539
lambda[   2] =  -1.02932398275417
lambda[   3] =  -0.50029819817754
lambda[   4] =  -0.46033628999363
lambda[   5] =  -0.46033615873634
lambda[   6] =  -0.45948787683929
lambda[   7] =  -0.32639562774470
lambda[   8] =  -0.32639542052451
lambda[   9] =  -0.03183170654810
lambda[  10] =  -0.00871712178817
lambda[  11] =  -0.00871347781644
lambda[  12] =   0.00968546285259
lambda[  13] =   0.03385793809058
lambda[  14] =   0.03503793533144
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 2.118 ms
rank =  0, Distributing orbital back into band + domain format took 9.156 ms
rank = 0, Subspace_Rotation used 11.290 ms

Total time for subspace rotation: 11.295 ms
rank = 0, Efermi =  -0.062829465253 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.405 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.590 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.054 ms
rank = 0, Calculating density took 1078.094 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.387 ms
rank = 0, D2D took 3.287 ms
rank = 0, Transfering density took 3.291 ms
Etot    =   -39.121696545841
Eband   =    -9.256150563409
E1      =    18.217851578561
E2      =    -9.184360984092
E3      =   -11.528785999153
Exc     =   -10.415227854858
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 1.472e-06, dEband = 7.436e-05
rank = 0, Calculating/Estimating energy took 0.956 ms, Etot = -39.121696546, dEtot = 1.472e-06, dEband = 7.436e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0545902820073, which took 0.212 ms

iter_count = 108, r_2norm = 1.500e-06, tol*||rhs|| = 2.184e-06

Anderson update took 57.823 ms, out of which F'*F took 34.141 ms; b-Ax took 202.380 ms, out of which Lap took 191.844 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 346.519 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245554, int_b + int_rho = -3.602e-13, checking this took 0.214 ms
2-norm of RHS = 465.9545923091673, which took 0.219 ms

iter_count = 132, r_2norm = 4.243e-04, tol*||rhs|| = 4.660e-04

Anderson update took 69.017 ms, out of which F'*F took 41.902 ms; b-Ax took 247.340 ms, out of which Lap took 234.467 ms
Solving Poisson took 416.269 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
Total time for convolution: 	 convolve: 5.216336 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.089367 
Total time for convolution: 	 convolve: 5.133945 
Total time for convolution: 	 convolve: 5.087147 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.854 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.285 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.151 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.751 ms
---Transfer Veff_loc: D2D took 1.950 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.332 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.303 ms

This SCF took 26402.405 ms, scf error = 2.109e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.135038, lowerbound = -1.065502, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1018.455 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 9.102 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.318 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.740 ms
rank =  0, Distribute data + matrix mult took 13.173 ms
rank =  0, finding HY took 17.464 ms
rank =  0, distributing HY into block cyclic form took 9.350 ms
rank =  0, finding Y'*HY took 3.707 ms
Rank 0, Project_Hamiltonian used 43.730 ms
Total time for projection: 43.743 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -1.065407231759672
    last  calculated eigval = 0.035103972118395
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06540723175967
lambda[   2] =  -1.02922953105731
lambda[   3] =  -0.50023146863768
lambda[   4] =  -0.46025157169599
lambda[   5] =  -0.46025148881044
lambda[   6] =  -0.45942168055770
lambda[   7] =  -0.32631331577077
lambda[   8] =  -0.32631315972696
lambda[   9] =  -0.03195453945812
lambda[  10] =  -0.00864959658664
lambda[  11] =  -0.00864769486640
lambda[  12] =   0.00977321887478
lambda[  13] =   0.03390338910888
lambda[  14] =   0.03510397211840
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 1.992 ms
rank =  0, Distributing orbital back into band + domain format took 8.832 ms
rank = 0, Subspace_Rotation used 10.835 ms

Total time for subspace rotation: 10.840 ms
rank = 0, Efermi =  -0.062952298005 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 1.540 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.653 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.055 ms
rank = 0, Calculating density took 1075.558 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.380 ms
rank = 0, D2D took 3.647 ms
rank = 0, Transfering density took 3.650 ms
Etot    =   -39.121703569097
Eband   =    -9.254838896112
E1      =    18.216983207678
E2      =    -9.183878104855
E3      =   -11.528957240592
Exc     =   -10.415366536731
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 2.341e-06, dEband = 4.372e-04
rank = 0, Calculating/Estimating energy took 0.902 ms, Etot = -39.121703569, dEtot = 2.341e-06, dEband = 4.372e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0471357552996, which took 0.196 ms

iter_count = 108, r_2norm = 1.390e-06, tol*||rhs|| = 1.885e-06

Anderson update took 57.457 ms, out of which F'*F took 34.180 ms; b-Ax took 202.998 ms, out of which Lap took 192.457 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 347.088 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245553, int_b + int_rho = -3.674e-13, checking this took 0.085 ms
2-norm of RHS = 465.9534776625788, which took 0.232 ms

iter_count = 150, r_2norm = 4.132e-04, tol*||rhs|| = 4.660e-04

Anderson update took 79.559 ms, out of which F'*F took 48.162 ms; b-Ax took 279.980 ms, out of which Lap took 266.167 ms
Solving Poisson took 471.512 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.134 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.140427 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.164084 
Total time for convolution: 	 convolve: 5.165667 
Total time for convolution: 	 convolve: 5.162643 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 4.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.140 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.738 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.689 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.315 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.019 ms

This SCF took 26804.983 ms, scf error = 1.690e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.135104, lowerbound = -1.065407, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1045.204 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.242 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.296 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.834 ms
rank =  0, Distribute data + matrix mult took 14.392 ms
rank =  0, finding HY took 17.467 ms
rank =  0, distributing HY into block cyclic form took 8.985 ms
rank =  0, finding Y'*HY took 3.972 ms
Rank 0, Project_Hamiltonian used 44.849 ms
Total time for projection: 44.864 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -1.065202249013116
    last  calculated eigval = 0.035962841609875
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06520224901312
lambda[   2] =  -1.02902364463321
lambda[   3] =  -0.50006246842388
lambda[   4] =  -0.46006503813996
lambda[   5] =  -0.46006500642519
lambda[   6] =  -0.45925195189183
lambda[   7] =  -0.32613124622699
lambda[   8] =  -0.32613117399263
lambda[   9] =  -0.03193382277418
lambda[  10] =  -0.00848925090743
lambda[  11] =  -0.00848837055353
lambda[  12] =   0.01025281306247
lambda[  13] =   0.03467387389702
lambda[  14] =   0.03596284160987
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 2.154 ms
rank =  0, Distributing orbital back into band + domain format took 8.796 ms
rank = 0, Subspace_Rotation used 10.964 ms

Total time for subspace rotation: 10.969 ms
rank = 0, Efermi =  -0.062931581315 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.479 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.542 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.056 ms
rank = 0, Calculating density took 1103.445 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.443 ms
rank = 0, D2D took 3.675 ms
rank = 0, Transfering density took 3.678 ms
Etot    =   -39.121721224854
Eband   =    -9.251865557572
E1      =    18.215267683124
E2      =    -9.182525619690
E3      =   -11.529301378614
Exc     =   -10.415633659331
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 5.885e-06, dEband = 9.911e-04
rank = 0, Calculating/Estimating energy took 0.884 ms, Etot = -39.121721225, dEtot = 5.885e-06, dEband = 9.911e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0487218777441, which took 0.263 ms

iter_count = 96, r_2norm = 1.413e-06, tol*||rhs|| = 1.949e-06

Anderson update took 50.912 ms, out of which F'*F took 30.261 ms; b-Ax took 178.506 ms, out of which Lap took 169.308 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 307.853 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245548, int_b + int_rho = -4.238e-13, checking this took 0.143 ms
2-norm of RHS = 465.9775166474394, which took 0.217 ms

iter_count = 168, r_2norm = 4.481e-04, tol*||rhs|| = 4.660e-04

Anderson update took 87.819 ms, out of which F'*F took 52.558 ms; b-Ax took 314.994 ms, out of which Lap took 298.792 ms
Solving Poisson took 527.515 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Total time for convolution: 	 convolve: 5.093246 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.500 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.158600 
Total time for convolution: 	 convolve: 5.123080 
Total time for convolution: 	 convolve: 5.094744 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.968 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.142 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.539 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.201 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 0.714 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.328 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.056 ms

This SCF took 26414.897 ms, scf error = 1.276e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.135963, lowerbound = -1.065202, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1042.466 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.245 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.289 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.546 ms
rank =  0, Distribute data + matrix mult took 14.097 ms
rank =  0, finding HY took 17.360 ms
rank =  0, distributing HY into block cyclic form took 9.064 ms
rank =  0, finding Y'*HY took 3.890 ms
Rank 0, Project_Hamiltonian used 44.442 ms
Total time for projection: 44.458 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.168 ms
    first calculated eigval = -1.065025027580651
    last  calculated eigval = 0.039559072159583
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06502502758065
lambda[   2] =  -1.02885417754452
lambda[   3] =  -0.49986517805521
lambda[   4] =  -0.45986875447776
lambda[   5] =  -0.45986866405087
lambda[   6] =  -0.45906264163924
lambda[   7] =  -0.32594620843649
lambda[   8] =  -0.32594608395138
lambda[   9] =  -0.03158919379490
lambda[  10] =  -0.00833064141086
lambda[  11] =  -0.00833032273425
lambda[  12] =   0.01259899030491
lambda[  13] =   0.03671818263241
lambda[  14] =   0.03955907215958
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 1.959 ms
rank =  0, Distributing orbital back into band + domain format took 9.068 ms
rank = 0, Subspace_Rotation used 11.044 ms

Total time for subspace rotation: 11.049 ms
rank = 0, Efermi =  -0.062586952308 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.387 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.579 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.054 ms
rank = 0, Calculating density took 1100.329 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.410 ms
rank = 0, D2D took 3.517 ms
rank = 0, Transfering density took 3.519 ms
Etot    =   -39.121748558995
Eband   =    -9.248873471550
E1      =    18.214419161254
E2      =    -9.180377578053
E3      =   -11.529160021342
Exc     =   -10.415515158715
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 9.111e-06, dEband = 9.974e-04
rank = 0, Calculating/Estimating energy took 1.894 ms, Etot = -39.121748559, dEtot = 9.111e-06, dEband = 9.974e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0472930931846, which took 0.218 ms

iter_count = 96, r_2norm = 1.655e-06, tol*||rhs|| = 1.892e-06

Anderson update took 51.313 ms, out of which F'*F took 30.509 ms; b-Ax took 180.509 ms, out of which Lap took 171.503 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 308.681 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245553, int_b + int_rho = -3.747e-13, checking this took 0.233 ms
2-norm of RHS = 465.9746285253695, which took 0.237 ms

iter_count = 102, r_2norm = 4.454e-04, tol*||rhs|| = 4.660e-04

Anderson update took 54.715 ms, out of which F'*F took 32.723 ms; b-Ax took 190.909 ms, out of which Lap took 181.628 ms
Solving Poisson took 321.637 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.098736 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 69.359 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.128033 
Total time for convolution: 	 convolve: 5.110793 
Total time for convolution: 	 convolve: 5.137749 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 7.782 ms
======D2D: initiated sending and receiving took 15.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.130 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.141 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.015 ms
======D2D: initiated sending and receiving took 0.985 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.697 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.319 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.031 ms

This SCF took 26383.279 ms, scf error = 1.858e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.139559, lowerbound = -1.065025, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1020.295 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.058 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.325 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.809 ms
rank =  0, Distribute data + matrix mult took 13.206 ms
rank =  0, finding HY took 17.541 ms
rank =  0, distributing HY into block cyclic form took 9.116 ms
rank =  0, finding Y'*HY took 3.900 ms
Rank 0, Project_Hamiltonian used 43.797 ms
Total time for projection: 43.811 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -1.065073478126751
    last  calculated eigval = 0.038925656067792
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06507347812675
lambda[   2] =  -1.02890325765661
lambda[   3] =  -0.49991300537698
lambda[   4] =  -0.45991564498759
lambda[   5] =  -0.45991550265852
lambda[   6] =  -0.45911050688125
lambda[   7] =  -0.32599384042787
lambda[   8] =  -0.32599366525052
lambda[   9] =  -0.03255948128897
lambda[  10] =  -0.00840365903507
lambda[  11] =  -0.00840305520052
lambda[  12] =   0.01313871586373
lambda[  13] =   0.03619610656886
lambda[  14] =   0.03892565606779
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 1.971 ms
rank =  0, Distributing orbital back into band + domain format took 9.049 ms
rank = 0, Subspace_Rotation used 11.034 ms

Total time for subspace rotation: 11.038 ms
rank = 0, Efermi =  -0.063557240044 calculate fermi energy took 0.082 ms
rank = 0, --- Calculate rho: sum over local bands took 1.552 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.558 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.052 ms
rank = 0, Calculating density took 1077.601 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.788 ms
rank = 0, D2D took 3.362 ms
rank = 0, Transfering density took 3.367 ms
Etot    =   -39.121754732924
Eband   =    -9.249637802812
E1      =    18.214798782850
E2      =    -9.180793492246
E3      =   -11.529020666458
Exc     =   -10.415413182287
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 2.058e-06, dEband = 2.548e-04
rank = 0, Calculating/Estimating energy took 0.967 ms, Etot = -39.121754733, dEtot = 2.058e-06, dEband = 2.548e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0297889202069, which took 0.233 ms

iter_count = 102, r_2norm = 8.936e-07, tol*||rhs|| = 1.192e-06

Anderson update took 54.150 ms, out of which F'*F took 31.992 ms; b-Ax took 189.995 ms, out of which Lap took 180.273 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 326.098 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245550, int_b + int_rho = -4.056e-13, checking this took 0.236 ms
2-norm of RHS = 465.9851335950950, which took 0.238 ms

iter_count = 114, r_2norm = 4.287e-04, tol*||rhs|| = 4.660e-04

Anderson update took 59.982 ms, out of which F'*F took 36.252 ms; b-Ax took 215.199 ms, out of which Lap took 203.750 ms
Solving Poisson took 361.625 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Total time for convolution: 	 convolve: 5.114696 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.199611 
Total time for convolution: 	 convolve: 5.097341 
Total time for convolution: 	 convolve: 5.090369 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.266 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.150 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.149 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.735 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.083 ms

This SCF took 26251.557 ms, scf error = 1.847e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.138926, lowerbound = -1.065073, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1048.694 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 9.449 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.292 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.577 ms
rank =  0, Distribute data + matrix mult took 14.339 ms
rank =  0, finding HY took 17.450 ms
rank =  0, distributing HY into block cyclic form took 9.157 ms
rank =  0, finding Y'*HY took 4.122 ms
Rank 0, Project_Hamiltonian used 45.097 ms
Total time for projection: 45.112 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -1.065209554094958
    last  calculated eigval = 0.039545155585829
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06520955409496
lambda[   2] =  -1.02904860193181
lambda[   3] =  -0.50002249201787
lambda[   4] =  -0.46001922994148
lambda[   5] =  -0.46001915934275
lambda[   6] =  -0.45922891883018
lambda[   7] =  -0.32610917702298
lambda[   8] =  -0.32610908155025
lambda[   9] =  -0.03140399207251
lambda[  10] =  -0.00847445262988
lambda[  11] =  -0.00847441773416
lambda[  12] =   0.01276261826110
lambda[  13] =   0.03707042456608
lambda[  14] =   0.03954515558583
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.343 ms
rank =  0, subspace rotation using ScaLAPACK took 2.231 ms
rank =  0, Distributing orbital back into band + domain format took 9.320 ms
rank = 0, Subspace_Rotation used 11.570 ms

Total time for subspace rotation: 11.576 ms
rank = 0, Efermi =  -0.062401750872 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.390 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.611 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1108.672 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.362 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
rank = 0, D2D took 2.276 ms
rank = 0, Transfering density took 2.284 ms
Etot    =   -39.121747954242
Eband   =    -9.251532429542
E1      =    18.216273961625
E2      =    -9.181326451398
E3      =   -11.528542875793
Exc     =   -10.415042124138
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 2.260e-06, dEband = 6.315e-04
rank = 0, Calculating/Estimating energy took 1.214 ms, Etot = -39.121747954, dEtot = 2.260e-06, dEband = 6.315e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0335603866231, which took 0.253 ms

iter_count = 96, r_2norm = 1.147e-06, tol*||rhs|| = 1.342e-06

Anderson update took 49.939 ms, out of which F'*F took 34.174 ms; b-Ax took 184.744 ms, out of which Lap took 175.400 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 314.396 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245552, int_b + int_rho = -3.783e-13, checking this took 0.148 ms
2-norm of RHS = 465.9776073615333, which took 0.246 ms

iter_count = 120, r_2norm = 4.068e-04, tol*||rhs|| = 4.660e-04

Anderson update took 63.913 ms, out of which F'*F took 38.606 ms; b-Ax took 224.390 ms, out of which Lap took 213.268 ms
Solving Poisson took 378.103 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Total time for convolution: 	 convolve: 5.088886 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.243 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.105855 
Total time for convolution: 	 convolve: 5.089723 
Total time for convolution: 	 convolve: 5.089522 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.832 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.121 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.162 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.322 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.019 ms

This SCF took 26224.355 ms, scf error = 3.109e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.139545, lowerbound = -1.065210, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1041.709 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.106 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.295 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.555 ms
rank =  0, Distribute data + matrix mult took 13.973 ms
rank =  0, finding HY took 17.424 ms
rank =  0, distributing HY into block cyclic form took 9.263 ms
rank =  0, finding Y'*HY took 3.611 ms
Rank 0, Project_Hamiltonian used 44.310 ms
Total time for projection: 44.325 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -1.064968965469103
    last  calculated eigval = 0.039081159634370
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06496896546910
lambda[   2] =  -1.02879782565725
lambda[   3] =  -0.49981658250821
lambda[   4] =  -0.45981713961890
lambda[   5] =  -0.45981703566180
lambda[   6] =  -0.45901383429658
lambda[   7] =  -0.32589612542215
lambda[   8] =  -0.32589598160157
lambda[   9] =  -0.03152487897293
lambda[  10] =  -0.00828247841792
lambda[  11] =  -0.00828245094994
lambda[  12] =   0.01276110896600
lambda[  13] =   0.03688918639575
lambda[  14] =   0.03908115963437
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 2.063 ms
rank =  0, Distributing orbital back into band + domain format took 8.558 ms
rank = 0, Subspace_Rotation used 12.040 ms

Total time for subspace rotation: 12.044 ms
rank = 0, Efermi =  -0.062522637384 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.467 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.710 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.055 ms
rank = 0, Calculating density took 1100.590 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.387 ms
rank = 0, D2D took 2.364 ms
rank = 0, Transfering density took 2.372 ms
Etot    =   -39.121748452909
Eband   =    -9.248046980549
E1      =    18.213951119642
E2      =    -9.179990007118
E3      =   -11.529280774617
Exc     =   -10.415606684358
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 1.662e-07, dEband = 1.162e-03
rank = 0, Calculating/Estimating energy took 1.003 ms, Etot = -39.121748453, dEtot = 1.662e-07, dEband = 1.162e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0283566694845, which took 0.260 ms

iter_count = 96, r_2norm = 9.115e-07, tol*||rhs|| = 1.134e-06

Anderson update took 51.215 ms, out of which F'*F took 30.225 ms; b-Ax took 179.035 ms, out of which Lap took 169.910 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 307.488 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245552, int_b + int_rho = -3.802e-13, checking this took 0.240 ms
2-norm of RHS = 465.9727095476965, which took 0.256 ms

iter_count = 120, r_2norm = 4.377e-04, tol*||rhs|| = 4.660e-04

Anderson update took 62.992 ms, out of which F'*F took 39.086 ms; b-Ax took 225.996 ms, out of which Lap took 214.658 ms
Solving Poisson took 378.304 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.115891 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.106926 
Total time for convolution: 	 convolve: 5.091018 
Total time for convolution: 	 convolve: 5.090882 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.054 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.580 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.136 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.142 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.180 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.694 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.319 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.028 ms

This SCF took 26157.575 ms, scf error = 1.720e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.139081, lowerbound = -1.064969, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1046.697 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.219 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.309 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.734 ms
rank =  0, Distribute data + matrix mult took 14.277 ms
rank =  0, finding HY took 17.438 ms
rank =  0, distributing HY into block cyclic form took 9.072 ms
rank =  0, finding Y'*HY took 3.966 ms
Rank 0, Project_Hamiltonian used 44.788 ms
Total time for projection: 44.803 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -1.064813039000545
    last  calculated eigval = 0.038977710493922
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06481303900054
lambda[   2] =  -1.02863773496755
lambda[   3] =  -0.49968289846377
lambda[   4] =  -0.45968075016468
lambda[   5] =  -0.45968064909690
lambda[   6] =  -0.45887654445978
lambda[   7] =  -0.32575691587306
lambda[   8] =  -0.32575677900570
lambda[   9] =  -0.03157704803707
lambda[  10] =  -0.00815507143515
lambda[  11] =  -0.00815499048508
lambda[  12] =   0.01300169644528
lambda[  13] =   0.03694926121890
lambda[  14] =   0.03897771049392
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 1.916 ms
rank =  0, Distributing orbital back into band + domain format took 9.967 ms
rank = 0, Subspace_Rotation used 11.904 ms

Total time for subspace rotation: 11.909 ms
rank = 0, Efermi =  -0.062574806359 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 1.359 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.684 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.052 ms
rank = 0, Calculating density took 1105.814 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.378 ms
rank = 0, D2D took 2.580 ms
rank = 0, Transfering density took 2.587 ms
Etot    =   -39.121752368664
Eband   =    -9.245770622141
E1      =    18.212502380289
E2      =    -9.179066798591
E3      =   -11.529677949292
Exc     =   -10.415912185315
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 1.305e-06, dEband = 7.588e-04
rank = 0, Calculating/Estimating energy took 1.245 ms, Etot = -39.121752369, dEtot = 1.305e-06, dEband = 7.588e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0244119801932, which took 0.250 ms

iter_count = 90, r_2norm = 8.335e-07, tol*||rhs|| = 9.765e-07

Anderson update took 48.111 ms, out of which F'*F took 28.542 ms; b-Ax took 168.750 ms, out of which Lap took 160.366 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 289.715 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245546, int_b + int_rho = -4.384e-13, checking this took 0.191 ms
2-norm of RHS = 465.9715645143004, which took 0.251 ms

iter_count = 126, r_2norm = 4.631e-04, tol*||rhs|| = 4.660e-04

Anderson update took 67.200 ms, out of which F'*F took 40.550 ms; b-Ax took 235.621 ms, out of which Lap took 224.060 ms
Solving Poisson took 395.968 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Total time for convolution: 	 convolve: 5.168967 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.094211 
Total time for convolution: 	 convolve: 5.095446 
Total time for convolution: 	 convolve: 5.091985 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.030 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.141 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.021 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.306 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 0.702 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.031 ms

This SCF took 26238.445 ms, scf error = 1.003e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.138978, lowerbound = -1.064813, upperbound = 267.565452

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1043.980 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 9.142 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.295 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.918 ms
rank =  0, Distribute data + matrix mult took 14.375 ms
rank =  0, finding HY took 17.458 ms
rank =  0, distributing HY into block cyclic form took 8.837 ms
rank =  0, finding Y'*HY took 4.128 ms
Rank 0, Project_Hamiltonian used 44.833 ms
Total time for projection: 44.848 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -1.064702324818225
    last  calculated eigval = 0.039339742899419
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06470232481822
lambda[   2] =  -1.02852768373103
lambda[   3] =  -0.49957327196423
lambda[   4] =  -0.45957155983485
lambda[   5] =  -0.45957155478275
lambda[   6] =  -0.45876817500087
lambda[   7] =  -0.32564828774437
lambda[   8] =  -0.32564827677748
lambda[   9] =  -0.03197585574207
lambda[  10] =  -0.00806446893650
lambda[  11] =  -0.00806427146643
lambda[  12] =   0.01443077774353
lambda[  13] =   0.03691072947273
lambda[  14] =   0.03933974289942
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 2.104 ms
rank =  0, Distributing orbital back into band + domain format took 9.562 ms
rank = 0, Subspace_Rotation used 11.688 ms

Total time for subspace rotation: 11.693 ms
rank = 0, Efermi =  -0.062973614357 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 1.529 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.656 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.055 ms
rank = 0, Calculating density took 1103.101 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.423 ms
rank = 0, D2D took 2.590 ms
rank = 0, Transfering density took 2.597 ms
Etot    =   -39.121761302946
Eband   =    -9.244022269386
E1      =    18.211612508858
E2      =    -9.178175815131
E3      =   -11.529790991905
Exc     =   -10.416001660074
Esc     =   -58.381316689301
Entropy =    -0.000000000078
dE = 2.978e-06, dEband = 5.828e-04
rank = 0, Calculating/Estimating energy took 0.988 ms, Etot = -39.121761303, dEtot = 2.978e-06, dEband = 5.828e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0161461108429, which took 0.234 ms

iter_count = 96, r_2norm = 4.594e-07, tol*||rhs|| = 6.458e-07

Anderson update took 50.975 ms, out of which F'*F took 30.328 ms; b-Ax took 179.166 ms, out of which Lap took 170.017 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 307.645 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000245590, int_rho =  16.00000000245551, int_b + int_rho = -3.911e-13, checking this took 0.209 ms
2-norm of RHS = 465.9685037666657, which took 0.219 ms

iter_count = 120, r_2norm = 4.593e-04, tol*||rhs|| = 4.660e-04

Anderson update took 63.424 ms, out of which F'*F took 38.047 ms; b-Ax took 224.891 ms, out of which Lap took 213.530 ms
Solving Poisson took 377.337 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.163 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Total time for convolution: 	 convolve: 5.094610 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.633 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.087491 
Total time for convolution: 	 convolve: 5.107573 
Total time for convolution: 	 convolve: 5.089734 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.871 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.518 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.126 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.139 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.713 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.070 ms

This SCF took 26183.170 ms, scf error = 8.639e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -1.06470232481822, occ[   1] =   2.00000000000000
lambda[   2] =  -1.02852768373103, occ[   2] =   2.00000000000000
lambda[   3] =  -0.49957327196423, occ[   3] =   2.00000000000000
lambda[   4] =  -0.45957155983485, occ[   4] =   2.00000000000000
lambda[   5] =  -0.45957155478275, occ[   5] =   2.00000000000000
lambda[   6] =  -0.45876817500087, occ[   6] =   2.00000000000000
lambda[   7] =  -0.32564828774437, occ[   7] =   2.00000000000000
lambda[   8] =  -0.32564827677748, occ[   8] =   2.00000000000000
lambda[   9] =  -0.03197585574207, occ[   9] =   0.00000000245551
lambda[  10] =  -0.00806446893650, occ[  10] =   0.00000000000000
lambda[  11] =  -0.00806427146643, occ[  11] =   0.00000000000000
lambda[  12] =   0.01443077774353, occ[  12] =   0.00000000000000
lambda[  13] =   0.03691072947273, occ[  13] =   0.00000000000000
lambda[  14] =   0.03933974289942, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.157 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.438 ms, time for Allreduce/Reduce: 4.884 ms 
Time for calculating local force components: 12.400 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000008077386  -0.00000000908217  -1.40862454344649
  0.00000037211031  -0.00000034308690   1.40862437435419
 -0.00000026683282   0.00000020582380   0.00000015785358
force_loc = 
  0.00000325073717  -0.00000141493471   1.38054708088366
  0.00000173769977  -0.00000122656147  -1.38054683033704
 -0.00000158514077   0.00000128874709  -0.00000003658076
Time for calculating nonlocal force components: 22.948 ms
[32mforces_xc: 
[0m[32m  0.00000018627970  -0.00000009513178   0.03301117708861
[0m[32m  0.00000011644018  -0.00000008941026  -0.03301118012943
[0m[32m -0.00000011488756   0.00000008842560  -0.00000000734341
[0mTime for calculating XC forces components: 14.530 ms
 Cartesian force = 
  0.00000225873079  -0.00000098741172   0.00493365041148
  0.00000096719031  -0.00000112732170  -0.00493370022659
 -0.00000322592110   0.00000211473343   0.00000004981511
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.194 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Time for printing density: 380.368 ms
The program took 612.835 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:31:47
Job ID:        2266780
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:04:36,vmem=8392K,walltime=00:10:23,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-003-16-2
---------------------------------------
