---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:42
Job ID:    2266967
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:47
Job ID:    2266967
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.060 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 23.274 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 3.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8

Reading ion file took 17.386 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 78.536 ms

Freeing SPARC_INPUT_MPI datatype took 0.015 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.923 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.081 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   11.872560	    9.597873	
   10.000000	    8.127440	    9.597873	
   10.000000	   10.000000	   10.402127	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.006 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.158 ms
Set up communicators.

--set up spincomm took 3.810 ms

--set up kptcomm took 0.373 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 8, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.008 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 8 
rank =  0, my blacs rank = 0, BLCYC size (340000, 2), actual size (340000, 2)
rank = 0, mb = nb = 8, mbQ = nbQ = 64
rank = 0, nr_Hp = 8, nc_Hp = 8
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.066 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.835 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 2
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.734 ms

Calculate_SplineDerivRadFun took 0.895 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.386 ms.
time spent on vectorized spline interp: 3.027 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.382 ms.
time spent on vectorized spline interp: 1.870 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.495 ms.

Calculating rb for all atom types took 11.170 ms
----------------------
Estimated memory usage
Total: 637.82 MB
orbitals             : 366.21 MB
global sized vectors : 213.62 MB
subspace matrices : 4.50 kB
others : 57.98 MB
----------------------------------------------
Estimated memory usage per processor: 53.15 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.038 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.010 ms
Calculating pseudocharge density ... 
the global sum of int_b = -6.0000000050109, sum_int_rho = 5.7992161516605
PosCharge = 6.000000005011, NegCharge = -5.799216151661, scal_fac = 1.034622584863
After scaling, int_rho = 6.0000000050108, PosCharge + NegCharge - NetCharge = 6.839e-14
--Calculate Vref took 0.135 ms
--Calculate rho_guess took 0.676 ms

 integral of b = -6.0000000050109,
 int{b} + Nelectron + NetCharge = -5.011e-09,
 Esc = -13.2585748249664,
 MPI_Reduce took 0.046 ms

Calculating b & b_ref took 4.039 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.009 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.019 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.776 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 15.053 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501081, int_b + int_rho = -1.346e-13, checking this took 0.087 ms
2-norm of RHS = 401.2507048222137, which took 0.429 ms

iter_count = 420, r_2norm = 3.456e-04, tol*||rhs|| = 4.013e-04

Anderson update took 257.666 ms, out of which F'*F took 118.830 ms; b-Ax took 792.548 ms, out of which Lap took 709.333 ms
Solving Poisson took 1746.897 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
Total time for convolution: 	 convolve: 5.163181 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
Total time for convolution: 	 convolve: 5.109956 
Total time for convolution: 	 convolve: 5.127226 
Total time for convolution: 	 convolve: 5.110590 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.726 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.486 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.175 ms
rank = 0, XC calculation took 24338.569 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 2.188 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.001 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.154 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.464 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.136 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.844 ms
    Lanczos iter 53, eigmin  = -0.667333983, eigmax = 264.918413893, err_eigmin = 1.804e-04, err_eigmax = 9.566e-03
rank =   0, Lanczos took 133.626 ms, eigmin = -0.667333982861, eigmax = 267.567598031775

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.400132, lowerbound = -0.767334, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 794.801 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.641 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.484 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 9.152 ms
rank =  0, finding HY took 14.630 ms
rank =  0, distributing HY into block cyclic form took 7.635 ms
rank =  0, finding Y'*HY took 2.108 ms
Rank 0, Project_Hamiltonian used 33.554 ms
Total time for projection: 33.565 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.264 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.338 ms
    first calculated eigval = 2.831019511076737
    last  calculated eigval = 3.161658934977068
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =   2.83101951107674
lambda[   2] =   2.87196073476609
lambda[   3] =   3.00282156883561
lambda[   4] =   3.00944530081076
lambda[   5] =   3.04947506247882
lambda[   6] =   3.07009356686044
lambda[   7] =   3.12719872784495
lambda[   8] =   3.16165893497707
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.350 ms
rank =  0, subspace rotation using ScaLAPACK took 2.392 ms
rank =  0, Distributing orbital back into band + domain format took 7.561 ms
rank = 0, Subspace_Rotation used 9.965 ms

Total time for subspace rotation: 9.970 ms
rank = 0, Efermi =   3.006133434843 calculate fermi energy took 0.049 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.261659, lowerbound = -0.767334, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 805.100 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 7.737 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.349 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 9.108 ms
rank =  0, finding HY took 13.978 ms
rank =  0, distributing HY into block cyclic form took 7.618 ms
rank =  0, finding Y'*HY took 1.959 ms
Rank 0, Project_Hamiltonian used 33.534 ms
Total time for projection: 33.540 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.052 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.115 ms
    first calculated eigval = -0.188466939642651
    last  calculated eigval = 0.421039710152938
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.18846693964265
lambda[   2] =   0.16479433399917
lambda[   3] =   0.26898119345693
lambda[   4] =   0.32657890868137
lambda[   5] =   0.37149122865265
lambda[   6] =   0.37895912955923
lambda[   7] =   0.40722200505478
lambda[   8] =   0.42103971015294
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.124 ms
rank =  0, subspace rotation using ScaLAPACK took 2.389 ms
rank =  0, Distributing orbital back into band + domain format took 7.472 ms
rank = 0, Subspace_Rotation used 9.874 ms

Total time for subspace rotation: 9.879 ms
rank = 0, Efermi =   0.297855899544 calculate fermi energy took 0.022 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.521040, lowerbound = -0.767334, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 800.659 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 7.622 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.295 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 8.940 ms
rank =  0, finding HY took 13.945 ms
rank =  0, distributing HY into block cyclic form took 7.517 ms
rank =  0, finding Y'*HY took 2.016 ms
Rank 0, Project_Hamiltonian used 32.443 ms
Total time for projection: 32.449 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.053 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.108 ms
    first calculated eigval = -0.666157329580128
    last  calculated eigval = 0.139381536986898
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.66615732958013
lambda[   2] =  -0.46501358662340
lambda[   3] =  -0.17390095400345
lambda[   4] =  -0.13562936762588
lambda[   5] =   0.08625180362106
lambda[   6] =   0.10880591780856
lambda[   7] =   0.11839303799431
lambda[   8] =   0.13938153698690
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.115 ms
rank =  0, subspace rotation using ScaLAPACK took 2.393 ms
rank =  0, Distributing orbital back into band + domain format took 7.461 ms
rank = 0, Subspace_Rotation used 9.868 ms

Total time for subspace rotation: 9.872 ms
rank = 0, Efermi =  -0.154765146474 calculate fermi energy took 0.022 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.239382, lowerbound = -0.767334, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 808.279 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 7.665 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.354 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 9.047 ms
rank =  0, finding HY took 13.945 ms
rank =  0, distributing HY into block cyclic form took 7.563 ms
rank =  0, finding Y'*HY took 1.980 ms
Rank 0, Project_Hamiltonian used 32.561 ms
Total time for projection: 32.569 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.049 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.968 ms
    first calculated eigval = -0.668176934463486
    last  calculated eigval = 0.088876566335358
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.66817693446349
lambda[   2] =  -0.48485349127470
lambda[   3] =  -0.24595601607150
lambda[   4] =  -0.21808098421784
lambda[   5] =   0.03709835030728
lambda[   6] =   0.05889953244971
lambda[   7] =   0.07139267304518
lambda[   8] =   0.08887656633536
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.977 ms
rank =  0, subspace rotation using ScaLAPACK took 2.383 ms
rank =  0, Distributing orbital back into band + domain format took 7.529 ms
rank = 0, Subspace_Rotation used 9.923 ms

Total time for subspace rotation: 9.928 ms
rank = 0, Efermi =  -0.232018499550 calculate fermi energy took 0.020 ms
rank = 0, --- Calculate rho: sum over local bands took 2.073 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.405 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.336 ms
rank = 0, Calculating density took 3524.034 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.991 ms
rank = 0, D2D took 1.107 ms
rank = 0, Transfering density took 1.110 ms
Etot    =    -7.043281605330
Eband   =    -2.797768743539
E1      =     6.636077024570
E2      =    -2.070114243599
E3      =    -2.880563966607
Exc     =    -2.573465741575
Esc     =   -13.258574824966
Entropy =    -0.000227530025
dE = 2.348e+00, dEband = 9.326e-01
rank = 0, Calculating/Estimating energy took 0.971 ms, Etot = -7.043281605, dEtot = 2.348e+00, dEband = 9.326e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 40.7662770816189, which took 0.510 ms

iter_count = 90, r_2norm = 1.435e-03, tol*||rhs|| = 1.631e-03

Anderson update took 54.281 ms, out of which F'*F took 24.822 ms; b-Ax took 168.418 ms, out of which Lap took 150.315 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 380.667 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501082, int_b + int_rho = -1.291e-13, checking this took 0.143 ms
2-norm of RHS = 399.1775371254254, which took 0.190 ms

iter_count = 282, r_2norm = 3.519e-04, tol*||rhs|| = 3.992e-04

Anderson update took 167.345 ms, out of which F'*F took 79.598 ms; b-Ax took 535.841 ms, out of which Lap took 479.519 ms
Solving Poisson took 1171.238 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.417 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Total time for convolution: 	 convolve: 5.106251 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 139.788 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.111649 
Total time for convolution: 	 convolve: 5.134266 
Total time for convolution: 	 convolve: 5.112461 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.317 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.145 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.585 ms
---Transfer Veff_loc: D2D took 1.323 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.390 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.736 ms

This SCF took 29674.196 ms, scf error = 3.149e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.188877, lowerbound = -0.668177, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 797.497 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.004 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.385 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 13.413 ms
rank =  0, finding HY took 13.746 ms
rank =  0, distributing HY into block cyclic form took 7.695 ms
rank =  0, finding Y'*HY took 2.259 ms
Rank 0, Project_Hamiltonian used 37.144 ms
Total time for projection: 37.157 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.526 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.618 ms
    first calculated eigval = -0.650546198912762
    last  calculated eigval = 0.063977086536374
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.65054619891276
lambda[   2] =  -0.46530371020468
lambda[   3] =  -0.22835444294284
lambda[   4] =  -0.20893664422019
lambda[   5] =   0.00193835386192
lambda[   6] =   0.03737000178774
lambda[   7] =   0.05041219143994
lambda[   8] =   0.06397708653637
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.650 ms
rank =  0, subspace rotation using ScaLAPACK took 2.232 ms
rank =  0, Distributing orbital back into band + domain format took 7.504 ms
rank = 0, Subspace_Rotation used 9.749 ms

Total time for subspace rotation: 9.754 ms
rank = 0, Efermi =  -0.218645543488 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.150 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.304 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.430 ms
rank = 0, Calculating density took 851.474 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.888 ms
rank = 0, D2D took 1.003 ms
rank = 0, Transfering density took 1.006 ms
Etot    =    -7.034093036597
Eband   =    -2.687209756965
E1      =     6.521512817632
E2      =    -2.076927875871
E3      =    -2.922943880524
Exc     =    -2.608244540017
Esc     =   -13.258574824966
Entropy =    -0.001448488675
dE = 3.063e-03, dEband = 3.685e-02
rank = 0, Calculating/Estimating energy took 0.978 ms, Etot = -7.034093037, dEtot = 3.063e-03, dEband = 3.685e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 13.5000933083954, which took 0.064 ms

iter_count = 102, r_2norm = 3.577e-04, tol*||rhs|| = 5.400e-04

Anderson update took 61.684 ms, out of which F'*F took 28.482 ms; b-Ax took 190.438 ms, out of which Lap took 170.050 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 433.672 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501078, int_b + int_rho = -1.664e-13, checking this took 0.120 ms
2-norm of RHS = 396.2975969018045, which took 0.146 ms

iter_count = 300, r_2norm = 3.481e-04, tol*||rhs|| = 3.963e-04

Anderson update took 178.872 ms, out of which F'*F took 84.398 ms; b-Ax took 565.622 ms, out of which Lap took 503.939 ms
Solving Poisson took 1240.874 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.939 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.083982 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 28.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.086111 
Total time for convolution: 	 convolve: 5.103705 
Total time for convolution: 	 convolve: 5.091667 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.396 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.223 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.254 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.427 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.702 ms

This SCF took 26878.831 ms, scf error = 2.165e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.163977, lowerbound = -0.650546, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 810.147 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.726 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.685 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 9.430 ms
rank =  0, finding HY took 14.095 ms
rank =  0, distributing HY into block cyclic form took 7.718 ms
rank =  0, finding Y'*HY took 1.759 ms
Rank 0, Project_Hamiltonian used 33.691 ms
Total time for projection: 33.703 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.048 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.108 ms
    first calculated eigval = -0.615645656797051
    last  calculated eigval = 0.045975361328453
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.61564565679705
lambda[   2] =  -0.42764083453408
lambda[   3] =  -0.19229664176398
lambda[   4] =  -0.18580932722295
lambda[   5] =  -0.01826476891403
lambda[   6] =   0.02741786571458
lambda[   7] =   0.03622465239293
lambda[   8] =   0.04597536132845
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.120 ms
rank =  0, subspace rotation using ScaLAPACK took 2.204 ms
rank =  0, Distributing orbital back into band + domain format took 7.734 ms
rank = 0, Subspace_Rotation used 9.953 ms

Total time for subspace rotation: 9.957 ms
rank = 0, Efermi =  -0.189052984474 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.162 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.234 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.355 ms
rank = 0, Calculating density took 859.826 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.956 ms
rank = 0, D2D took 1.059 ms
rank = 0, Transfering density took 1.062 ms
Etot    =    -7.022360676868
Eband   =    -2.467711471175
E1      =     6.323404970765
E2      =    -2.054513092326
E3      =    -3.022356693796
Exc     =    -2.689523409962
Esc     =   -13.258574824966
Entropy =    -0.006825727651
dE = 3.911e-03, dEband = 7.317e-02
rank = 0, Calculating/Estimating energy took 0.980 ms, Etot = -7.022360677, dEtot = 3.911e-03, dEband = 7.317e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 6.5868277031564, which took 0.052 ms

iter_count = 102, r_2norm = 1.971e-04, tol*||rhs|| = 2.635e-04

Anderson update took 62.384 ms, out of which F'*F took 27.668 ms; b-Ax took 189.230 ms, out of which Lap took 167.943 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 433.930 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501082, int_b + int_rho = -1.264e-13, checking this took 0.192 ms
2-norm of RHS = 396.4209802992468, which took 0.071 ms

iter_count = 216, r_2norm = 3.554e-04, tol*||rhs|| = 3.964e-04

Anderson update took 142.074 ms, out of which F'*F took 61.345 ms; b-Ax took 411.725 ms, out of which Lap took 366.628 ms
Solving Poisson took 928.224 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.087715 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.855 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.568 ms
Total time for convolution: 	 convolve: 5.092704 
Total time for convolution: 	 convolve: 5.081295 
Total time for convolution: 	 convolve: 5.105040 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.380 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.161 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.279 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.391 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.691 ms

This SCF took 26543.759 ms, scf error = 9.725e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.145975, lowerbound = -0.615646, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 800.050 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.742 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.508 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 9.275 ms
rank =  0, finding HY took 13.652 ms
rank =  0, distributing HY into block cyclic form took 7.757 ms
rank =  0, finding Y'*HY took 1.915 ms
Rank 0, Project_Hamiltonian used 33.141 ms
Total time for projection: 33.154 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.043 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.107 ms
    first calculated eigval = -0.616595243799403
    last  calculated eigval = 0.037387520863326
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.61659524379940
lambda[   2] =  -0.42857162659769
lambda[   3] =  -0.19638035433535
lambda[   4] =  -0.18726657170066
lambda[   5] =  -0.02504533126310
lambda[   6] =   0.02529333508283
lambda[   7] =   0.03002880227879
lambda[   8] =   0.03738752086333
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.137 ms
rank =  0, subspace rotation using ScaLAPACK took 2.418 ms
rank =  0, Distributing orbital back into band + domain format took 7.370 ms
rank = 0, Subspace_Rotation used 9.800 ms

Total time for subspace rotation: 9.804 ms
rank = 0, Efermi =  -0.191823462994 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 2.254 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.356 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.422 ms
rank = 0, Calculating density took 849.326 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.119 ms
rank = 0, D2D took 1.230 ms
rank = 0, Transfering density took 1.233 ms
Etot    =    -7.022078252302
Eband   =    -2.479625825751
E1      =     6.334031105724
E2      =    -2.056181976820
E3      =    -3.014295721325
Exc     =    -2.682739722629
Esc     =   -13.258574824966
Entropy =    -0.005646682826
dE = 9.414e-05, dEband = 3.971e-03
rank = 0, Calculating/Estimating energy took 0.980 ms, Etot = -7.022078252, dEtot = 9.414e-05, dEband = 3.971e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 1.4390725851754, which took 0.079 ms

iter_count = 108, r_2norm = 5.154e-05, tol*||rhs|| = 5.756e-05

Anderson update took 64.242 ms, out of which F'*F took 29.631 ms; b-Ax took 201.363 ms, out of which Lap took 179.083 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.596 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501080, int_b + int_rho = -1.501e-13, checking this took 0.149 ms
2-norm of RHS = 396.0001312836574, which took 0.181 ms

iter_count = 270, r_2norm = 3.820e-04, tol*||rhs|| = 3.960e-04

Anderson update took 162.062 ms, out of which F'*F took 73.935 ms; b-Ax took 505.492 ms, out of which Lap took 445.810 ms
Solving Poisson took 1131.230 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.161944 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.601 ms
Total time for convolution: 	 convolve: 5.139171 
Total time for convolution: 	 convolve: 5.151487 
Total time for convolution: 	 convolve: 5.146023 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.406 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.298 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.217 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.545 ms

This SCF took 26990.033 ms, scf error = 4.829e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.137388, lowerbound = -0.616595, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 786.643 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.028 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.543 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 19.129 ms
rank =  0, finding HY took 12.702 ms
rank =  0, distributing HY into block cyclic form took 7.566 ms
rank =  0, finding Y'*HY took 2.061 ms
Rank 0, Project_Hamiltonian used 42.057 ms
Total time for projection: 42.073 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.054 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.606481302982216
    last  calculated eigval = 0.031426188363467
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60648130298222
lambda[   2] =  -0.41732423650089
lambda[   3] =  -0.19284577370571
lambda[   4] =  -0.18220369870557
lambda[   5] =  -0.02872592211842
lambda[   6] =   0.02285458303933
lambda[   7] =   0.02438123155017
lambda[   8] =   0.03142618836347
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 2.431 ms
rank =  0, Distributing orbital back into band + domain format took 7.399 ms
rank = 0, Subspace_Rotation used 9.843 ms

Total time for subspace rotation: 9.846 ms
rank = 0, Efermi =  -0.187524736178 calculate fermi energy took 1.260 ms
rank = 0, --- Calculate rho: sum over local bands took 2.395 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.488 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.324 ms
rank = 0, Calculating density took 845.234 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.043 ms
rank = 0, D2D took 1.211 ms
rank = 0, Transfering density took 1.214 ms
Etot    =    -7.021183465796
Eband   =    -2.430047099838
E1      =     6.294586187687
E2      =    -2.041042849816
E3      =    -3.037683821254
Exc     =    -2.700964074483
Esc     =   -13.258574824966
Entropy =    -0.004910325265
dE = 2.983e-04, dEband = 1.653e-02
rank = 0, Calculating/Estimating energy took 1.027 ms, Etot = -7.021183466, dEtot = 2.983e-04, dEband = 1.653e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5012077145510, which took 0.140 ms

iter_count = 114, r_2norm = 1.672e-05, tol*||rhs|| = 2.005e-05

Anderson update took 67.916 ms, out of which F'*F took 45.515 ms; b-Ax took 229.097 ms, out of which Lap took 206.123 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 497.511 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501081, int_b + int_rho = -1.328e-13, checking this took 0.116 ms
2-norm of RHS = 396.0987679989396, which took 0.173 ms

iter_count = 240, r_2norm = 3.782e-04, tol*||rhs|| = 3.961e-04

Anderson update took 142.197 ms, out of which F'*F took 65.819 ms; b-Ax took 456.072 ms, out of which Lap took 403.968 ms
Solving Poisson took 1007.369 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.141856 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 68.771 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.145617 
Total time for convolution: 	 convolve: 5.198071 
Total time for convolution: 	 convolve: 5.141960 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 1.716 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.002 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.892 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.645 ms

This SCF took 26979.574 ms, scf error = 1.251e-02
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.131426, lowerbound = -0.606481, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 796.869 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.843 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.356 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 9.227 ms
rank =  0, finding HY took 13.384 ms
rank =  0, distributing HY into block cyclic form took 7.602 ms
rank =  0, finding Y'*HY took 2.018 ms
Rank 0, Project_Hamiltonian used 32.703 ms
Total time for projection: 32.717 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.051 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.114 ms
    first calculated eigval = -0.605395748359702
    last  calculated eigval = 0.028686899496951
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60539574835970
lambda[   2] =  -0.41607255913497
lambda[   3] =  -0.19158727144899
lambda[   4] =  -0.18151071969771
lambda[   5] =  -0.03016928379194
lambda[   6] =   0.02106762782007
lambda[   7] =   0.02184829369333
lambda[   8] =   0.02868689949695
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 2.387 ms
rank =  0, Distributing orbital back into band + domain format took 7.475 ms
rank = 0, Subspace_Rotation used 9.873 ms

Total time for subspace rotation: 9.879 ms
rank = 0, Efermi =  -0.186548995547 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.183 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.302 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.303 ms
rank = 0, Calculating density took 845.534 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.058 ms
rank = 0, D2D took 1.159 ms
rank = 0, Transfering density took 1.162 ms
Etot    =    -7.021201765370
Eband   =    -2.422762424412
E1      =     6.292377616032
E2      =    -2.035171580374
E3      =    -3.041270411838
Exc     =    -2.703500189660
Esc     =   -13.258574824966
Entropy =    -0.005183934576
dE = 6.100e-06, dEband = 2.428e-03
rank = 0, Calculating/Estimating energy took 0.974 ms, Etot = -7.021201765, dEtot = 6.100e-06, dEband = 2.428e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2998552085117, which took 0.080 ms

iter_count = 108, r_2norm = 1.130e-05, tol*||rhs|| = 1.199e-05

Anderson update took 64.735 ms, out of which F'*F took 31.089 ms; b-Ax took 214.347 ms, out of which Lap took 191.982 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.702 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501081, int_b + int_rho = -1.337e-13, checking this took 0.126 ms
2-norm of RHS = 396.3287397755664, which took 0.169 ms

iter_count = 252, r_2norm = 3.390e-04, tol*||rhs|| = 3.963e-04

Anderson update took 150.747 ms, out of which F'*F took 70.817 ms; b-Ax took 478.206 ms, out of which Lap took 427.209 ms
Solving Poisson took 1047.048 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.121 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.147507 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 85.012 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.375 ms
Total time for convolution: 	 convolve: 5.171755 
Total time for convolution: 	 convolve: 5.147064 
Total time for convolution: 	 convolve: 5.149105 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.385 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.346 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.709 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.928 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.677 ms

This SCF took 27026.966 ms, scf error = 7.517e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.128687, lowerbound = -0.605396, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 804.532 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.832 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.352 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.018 ms
rank =  0, Distribute data + matrix mult took 9.220 ms
rank =  0, finding HY took 13.545 ms
rank =  0, distributing HY into block cyclic form took 7.505 ms
rank =  0, finding Y'*HY took 2.078 ms
Rank 0, Project_Hamiltonian used 32.466 ms
Total time for projection: 32.490 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.054 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.605101025159806
    last  calculated eigval = 0.027107849861664
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60510102515981
lambda[   2] =  -0.41576205667395
lambda[   3] =  -0.19120517968136
lambda[   4] =  -0.18126698331110
lambda[   5] =  -0.03079541848712
lambda[   6] =   0.01971427755612
lambda[   7] =   0.02079315033718
lambda[   8] =   0.02710784986166
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.139 ms
rank =  0, subspace rotation using ScaLAPACK took 2.445 ms
rank =  0, Distributing orbital back into band + domain format took 7.399 ms
rank = 0, Subspace_Rotation used 9.859 ms

Total time for subspace rotation: 9.864 ms
rank = 0, Efermi =  -0.186236081470 calculate fermi energy took 0.117 ms
rank = 0, --- Calculate rho: sum over local bands took 2.193 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.411 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.329 ms
rank = 0, Calculating density took 853.576 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.022 ms
rank = 0, D2D took 1.126 ms
rank = 0, Transfering density took 1.128 ms
Etot    =    -7.021274198402
Eband   =    -2.420767369329
E1      =     6.296448786094
E2      =    -2.028581331139
E3      =    -3.041063720850
Exc     =    -2.702775046622
Esc     =   -13.258574824966
Entropy =    -0.005250795569
dE = 2.414e-05, dEband = 6.650e-04
rank = 0, Calculating/Estimating energy took 0.966 ms, Etot = -7.021274198, dEtot = 2.414e-05, dEband = 6.650e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1563656352223, which took 0.065 ms

iter_count = 114, r_2norm = 4.263e-06, tol*||rhs|| = 6.255e-06

Anderson update took 70.505 ms, out of which F'*F took 32.201 ms; b-Ax took 218.465 ms, out of which Lap took 195.244 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 493.182 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501082, int_b + int_rho = -1.246e-13, checking this took 0.129 ms
2-norm of RHS = 396.2952260375370, which took 0.196 ms

iter_count = 240, r_2norm = 3.240e-04, tol*||rhs|| = 3.963e-04

Anderson update took 151.877 ms, out of which F'*F took 70.589 ms; b-Ax took 470.839 ms, out of which Lap took 425.206 ms
Solving Poisson took 1032.549 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.101 ms
Total time for convolution: 	 convolve: 5.184864 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.320 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.142859 
Total time for convolution: 	 convolve: 5.202083 
Total time for convolution: 	 convolve: 5.308495 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.523 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.659 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.286 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.414 ms
---Transfer Veff_loc: D2D took 2.838 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.445 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.685 ms

This SCF took 27233.459 ms, scf error = 3.825e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.127108, lowerbound = -0.605101, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 799.425 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.703 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.532 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 9.258 ms
rank =  0, finding HY took 13.567 ms
rank =  0, distributing HY into block cyclic form took 7.599 ms
rank =  0, finding Y'*HY took 1.948 ms
Rank 0, Project_Hamiltonian used 32.404 ms
Total time for projection: 32.445 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.055 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.113 ms
    first calculated eigval = -0.603418044007533
    last  calculated eigval = 0.026746928244684
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60341804400753
lambda[   2] =  -0.41428819909911
lambda[   3] =  -0.18970292445036
lambda[   4] =  -0.17965419333262
lambda[   5] =  -0.03042063036807
lambda[   6] =   0.01966529286401
lambda[   7] =   0.02055978240405
lambda[   8] =   0.02674692824468
==subpsace eigenproblem: bcast eigvals took 0.067 ms
Total time for solving subspace eigenvalue problem: 0.188 ms
rank =  0, subspace rotation using ScaLAPACK took 2.387 ms
rank =  0, Distributing orbital back into band + domain format took 7.540 ms
rank = 0, Subspace_Rotation used 9.939 ms

Total time for subspace rotation: 9.945 ms
rank = 0, Efermi =  -0.184678558865 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 2.295 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.505 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.327 ms
rank = 0, Calculating density took 848.911 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.042 ms
rank = 0, D2D took 1.148 ms
rank = 0, Transfering density took 1.150 ms
Etot    =    -7.021361391163
Eband   =    -2.411465416126
E1      =     6.289868237107
E2      =    -2.025157989679
E3      =    -3.043236167603
Exc     =    -2.704386160182
Esc     =   -13.258574824966
Entropy =    -0.005197384278
dE = 2.906e-05, dEband = 3.101e-03
rank = 0, Calculating/Estimating energy took 0.978 ms, Etot = -7.021361391, dEtot = 2.906e-05, dEband = 3.101e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1248694802935, which took 0.090 ms

iter_count = 114, r_2norm = 3.281e-06, tol*||rhs|| = 4.995e-06

Anderson update took 67.008 ms, out of which F'*F took 31.482 ms; b-Ax took 212.030 ms, out of which Lap took 190.287 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.085 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501081, int_b + int_rho = -1.410e-13, checking this took 0.138 ms
2-norm of RHS = 396.3039492971151, which took 0.171 ms

iter_count = 210, r_2norm = 3.333e-04, tol*||rhs|| = 3.963e-04

Anderson update took 141.009 ms, out of which F'*F took 64.945 ms; b-Ax took 406.947 ms, out of which Lap took 369.441 ms
Solving Poisson took 897.059 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.072 ms
Total time for convolution: 	 convolve: 5.151889 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 114.224 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.173957 
Total time for convolution: 	 convolve: 5.192764 
Total time for convolution: 	 convolve: 5.179830 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.394 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.650 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.919 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.605 ms

This SCF took 27120.186 ms, scf error = 3.935e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.126747, lowerbound = -0.603418, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 807.717 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.001 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.284 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 9.314 ms
rank =  0, finding HY took 13.531 ms
rank =  0, distributing HY into block cyclic form took 7.577 ms
rank =  0, finding Y'*HY took 1.973 ms
Rank 0, Project_Hamiltonian used 32.429 ms
Total time for projection: 32.446 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.057 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.603185645725187
    last  calculated eigval = 0.026686276789540
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60318564572519
lambda[   2] =  -0.41403194587912
lambda[   3] =  -0.18910835103952
lambda[   4] =  -0.17936366616468
lambda[   5] =  -0.03012191716615
lambda[   6] =   0.01962193821529
lambda[   7] =   0.02052769280598
lambda[   8] =   0.02668627678954
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.139 ms
rank =  0, subspace rotation using ScaLAPACK took 2.367 ms
rank =  0, Distributing orbital back into band + domain format took 7.551 ms
rank = 0, Subspace_Rotation used 9.932 ms

Total time for subspace rotation: 9.938 ms
rank = 0, Efermi =  -0.184236008577 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.130 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.278 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.321 ms
rank = 0, Calculating density took 856.071 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.018 ms
rank = 0, D2D took 1.115 ms
rank = 0, Transfering density took 1.117 ms
Etot    =    -7.021400812785
Eband   =    -2.409255873412
E1      =     6.289092801375
E2      =    -2.023654541357
E3      =    -3.044008936712
Exc     =    -2.704982222302
Esc     =   -13.258574824966
Entropy =    -0.005344171547
dE = 1.314e-05, dEband = 7.365e-04
rank = 0, Calculating/Estimating energy took 0.988 ms, Etot = -7.021400813, dEtot = 1.314e-05, dEband = 7.365e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0780703839390, which took 0.182 ms

iter_count = 108, r_2norm = 2.626e-06, tol*||rhs|| = 3.123e-06

Anderson update took 66.363 ms, out of which F'*F took 29.695 ms; b-Ax took 200.992 ms, out of which Lap took 179.025 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.940 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501080, int_b + int_rho = -1.510e-13, checking this took 0.139 ms
2-norm of RHS = 396.2771317575160, which took 0.149 ms

iter_count = 222, r_2norm = 3.749e-04, tol*||rhs|| = 3.963e-04

Anderson update took 140.440 ms, out of which F'*F took 62.721 ms; b-Ax took 418.190 ms, out of which Lap took 372.419 ms
Solving Poisson took 929.224 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
Total time for convolution: 	 convolve: 5.172345 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 55.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.156272 
Total time for convolution: 	 convolve: 5.157625 
Total time for convolution: 	 convolve: 5.150483 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.662 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.896 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.559 ms

This SCF took 26877.219 ms, scf error = 2.858e-03
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.126686, lowerbound = -0.603186, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 804.123 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.663 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.527 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 9.214 ms
rank =  0, finding HY took 13.489 ms
rank =  0, distributing HY into block cyclic form took 7.551 ms
rank =  0, finding Y'*HY took 2.006 ms
Rank 0, Project_Hamiltonian used 32.289 ms
Total time for projection: 32.302 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.046 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.602510904729782
    last  calculated eigval = 0.028298572668589
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60251090472978
lambda[   2] =  -0.41334711397283
lambda[   3] =  -0.18852943910456
lambda[   4] =  -0.17865325922068
lambda[   5] =  -0.02808014937994
lambda[   6] =   0.02099000604198
lambda[   7] =   0.02232021881299
lambda[   8] =   0.02829857266859
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 2.388 ms
rank =  0, Distributing orbital back into band + domain format took 7.451 ms
rank = 0, Subspace_Rotation used 9.851 ms

Total time for subspace rotation: 9.857 ms
rank = 0, Efermi =  -0.183591349137 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.205 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.170 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.297 ms
rank = 0, Calculating density took 852.256 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.042 ms
rank = 0, D2D took 1.163 ms
rank = 0, Transfering density took 1.165 ms
Etot    =    -7.021485738050
Eband   =    -2.405396934431
E1      =     6.287206827164
E2      =    -2.021500165062
E3      =    -3.044265911240
Exc     =    -2.705206141194
Esc     =   -13.258574824966
Entropy =    -0.005280740925
dE = 2.831e-05, dEband = 1.286e-03
rank = 0, Calculating/Estimating energy took 0.981 ms, Etot = -7.021485738, dEtot = 2.831e-05, dEband = 1.286e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0455987290925, which took 0.054 ms

iter_count = 114, r_2norm = 1.443e-06, tol*||rhs|| = 1.824e-06

Anderson update took 67.803 ms, out of which F'*F took 32.136 ms; b-Ax took 214.098 ms, out of which Lap took 191.362 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.131 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501080, int_b + int_rho = -1.455e-13, checking this took 0.116 ms
2-norm of RHS = 396.2781767780671, which took 0.208 ms

iter_count = 174, r_2norm = 3.481e-04, tol*||rhs|| = 3.963e-04

Anderson update took 108.867 ms, out of which F'*F took 49.144 ms; b-Ax took 330.127 ms, out of which Lap took 292.590 ms
Solving Poisson took 728.984 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.151988 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 78.902 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.160731 
Total time for convolution: 	 convolve: 5.179982 
Total time for convolution: 	 convolve: 5.153883 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.390 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 1.649 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.510 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.605 ms

This SCF took 26729.778 ms, scf error = 8.964e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.128299, lowerbound = -0.602511, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 800.308 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.756 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.493 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 9.282 ms
rank =  0, finding HY took 13.491 ms
rank =  0, distributing HY into block cyclic form took 7.559 ms
rank =  0, finding Y'*HY took 1.972 ms
Rank 0, Project_Hamiltonian used 32.333 ms
Total time for projection: 32.347 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.056 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.115 ms
    first calculated eigval = -0.602250443394845
    last  calculated eigval = 0.028584862952104
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60225044339485
lambda[   2] =  -0.41309665326887
lambda[   3] =  -0.18826949194681
lambda[   4] =  -0.17840381275320
lambda[   5] =  -0.02764728812742
lambda[   6] =   0.02096869727948
lambda[   7] =   0.02265821526177
lambda[   8] =   0.02858486295210
==subpsace eigenproblem: bcast eigvals took 0.102 ms
Total time for solving subspace eigenvalue problem: 0.225 ms
rank =  0, subspace rotation using ScaLAPACK took 2.390 ms
rank =  0, Distributing orbital back into band + domain format took 7.500 ms
rank = 0, Subspace_Rotation used 9.902 ms

Total time for subspace rotation: 9.907 ms
rank = 0, Efermi =  -0.183336652324 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 2.061 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.433 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.371 ms
rank = 0, Calculating density took 848.763 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.965 ms
rank = 0, D2D took 1.057 ms
rank = 0, Transfering density took 1.059 ms
Etot    =    -7.021499835876
Eband   =    -2.403853721689
E1      =     6.286320682471
E2      =    -2.020746462946
E3      =    -3.044676264702
Exc     =    -2.705528889787
Esc     =   -13.258574824966
Entropy =    -0.005285809553
dE = 4.699e-06, dEband = 5.144e-04
rank = 0, Calculating/Estimating energy took 0.976 ms, Etot = -7.021499836, dEtot = 4.699e-06, dEband = 5.144e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0292972411359, which took 0.070 ms

iter_count = 108, r_2norm = 1.067e-06, tol*||rhs|| = 1.172e-06

Anderson update took 65.741 ms, out of which F'*F took 30.909 ms; b-Ax took 202.286 ms, out of which Lap took 180.598 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.992 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501083, int_b + int_rho = -1.164e-13, checking this took 0.120 ms
2-norm of RHS = 396.2975393338832, which took 0.137 ms

iter_count = 204, r_2norm = 3.377e-04, tol*||rhs|| = 3.963e-04

Anderson update took 127.255 ms, out of which F'*F took 57.105 ms; b-Ax took 387.131 ms, out of which Lap took 342.067 ms
Solving Poisson took 853.872 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.165556 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 81.981 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.181015 
Total time for convolution: 	 convolve: 5.196682 
Total time for convolution: 	 convolve: 5.155180 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.034 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.988 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 2.372 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.870 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.279 ms

This SCF took 26943.517 ms, scf error = 6.812e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.128585, lowerbound = -0.602250, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 806.315 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.656 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.552 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 9.233 ms
rank =  0, finding HY took 13.442 ms
rank =  0, distributing HY into block cyclic form took 7.555 ms
rank =  0, finding Y'*HY took 2.003 ms
Rank 0, Project_Hamiltonian used 32.263 ms
Total time for projection: 32.281 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.057 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.113 ms
    first calculated eigval = -0.601544200269538
    last  calculated eigval = 0.031871550016203
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60154420026954
lambda[   2] =  -0.41241047377506
lambda[   3] =  -0.18762266779948
lambda[   4] =  -0.17772997590838
lambda[   5] =  -0.02453859470647
lambda[   6] =   0.02276869846729
lambda[   7] =   0.02638401554638
lambda[   8] =   0.03187155001620
==subpsace eigenproblem: bcast eigvals took 0.067 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 2.388 ms
rank =  0, Distributing orbital back into band + domain format took 7.531 ms
rank = 0, Subspace_Rotation used 9.934 ms

Total time for subspace rotation: 9.940 ms
rank = 0, Efermi =  -0.182676321828 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 2.077 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.400 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.358 ms
rank = 0, Calculating density took 854.672 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.957 ms
rank = 0, D2D took 1.059 ms
rank = 0, Transfering density took 1.061 ms
Etot    =    -7.021545574489
Eband   =    -2.399779032820
E1      =     6.284416738021
E2      =    -2.018365318649
E3      =    -3.045480872291
Exc     =    -2.706181876054
Esc     =   -13.258574824966
Entropy =    -0.005272769610
dE = 1.525e-05, dEband = 1.358e-03
rank = 0, Calculating/Estimating energy took 1.005 ms, Etot = -7.021545574, dEtot = 1.525e-05, dEband = 1.358e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0197764576650, which took 0.161 ms

iter_count = 114, r_2norm = 5.547e-07, tol*||rhs|| = 7.911e-07

Anderson update took 67.405 ms, out of which F'*F took 30.927 ms; b-Ax took 213.520 ms, out of which Lap took 190.474 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.458 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501083, int_b + int_rho = -1.137e-13, checking this took 0.140 ms
2-norm of RHS = 396.2966028846807, which took 0.174 ms

iter_count = 144, r_2norm = 3.895e-04, tol*||rhs|| = 3.963e-04

Anderson update took 90.103 ms, out of which F'*F took 41.040 ms; b-Ax took 273.625 ms, out of which Lap took 242.560 ms
Solving Poisson took 604.172 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.150389 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 99.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.179024 
Total time for convolution: 	 convolve: 5.149340 
Total time for convolution: 	 convolve: 5.163358 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.579 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.386 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.000 ms
---Transfer Veff_loc: D2D took 2.225 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.947 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.207 ms

This SCF took 26640.386 ms, scf error = 4.494e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.131872, lowerbound = -0.601544, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 813.078 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.676 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.573 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 9.271 ms
rank =  0, finding HY took 13.431 ms
rank =  0, distributing HY into block cyclic form took 7.707 ms
rank =  0, finding Y'*HY took 1.986 ms
Rank 0, Project_Hamiltonian used 32.423 ms
Total time for projection: 32.439 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.055 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.116 ms
    first calculated eigval = -0.601481697990380
    last  calculated eigval = 0.032478797281735
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60148169799038
lambda[   2] =  -0.41234967987451
lambda[   3] =  -0.18753384926236
lambda[   4] =  -0.17765437533839
lambda[   5] =  -0.02400157808404
lambda[   6] =   0.02269156148690
lambda[   7] =   0.02699998938409
lambda[   8] =   0.03247879728173
==subpsace eigenproblem: bcast eigvals took 0.052 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 2.385 ms
rank =  0, Distributing orbital back into band + domain format took 7.506 ms
rank = 0, Subspace_Rotation used 9.905 ms

Total time for subspace rotation: 9.912 ms
rank = 0, Efermi =  -0.182594112275 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.119 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.308 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.313 ms
rank = 0, Calculating density took 861.465 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.034 ms
rank = 0, D2D took 1.133 ms
rank = 0, Transfering density took 1.135 ms
Etot    =    -7.021552278823
Eband   =    -2.399352936785
E1      =     6.284211284571
E2      =    -2.018142075589
E3      =    -3.045529390313
Exc     =    -2.706228116744
Esc     =   -13.258574824966
Entropy =    -0.005279150800
dE = 2.235e-06, dEband = 1.420e-04
rank = 0, Calculating/Estimating energy took 0.991 ms, Etot = -7.021552279, dEtot = 2.235e-06, dEband = 1.420e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0183291347095, which took 0.067 ms

iter_count = 114, r_2norm = 4.971e-07, tol*||rhs|| = 7.332e-07

Anderson update took 67.004 ms, out of which F'*F took 31.317 ms; b-Ax took 212.453 ms, out of which Lap took 189.559 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.565 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501083, int_b + int_rho = -1.210e-13, checking this took 0.113 ms
2-norm of RHS = 396.2979844558259, which took 0.068 ms

iter_count = 138, r_2norm = 3.895e-04, tol*||rhs|| = 3.963e-04

Anderson update took 85.477 ms, out of which F'*F took 38.770 ms; b-Ax took 262.650 ms, out of which Lap took 232.059 ms
Solving Poisson took 577.311 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.153453 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 83.427 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.151865 
Total time for convolution: 	 convolve: 5.151527 
Total time for convolution: 	 convolve: 5.158718 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.218 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.175 ms
---Transfer Veff_loc: D2D took 2.440 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.894 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.370 ms

This SCF took 26738.868 ms, scf error = 2.765e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.132479, lowerbound = -0.601482, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 818.046 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 7.727 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.434 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 9.197 ms
rank =  0, finding HY took 13.476 ms
rank =  0, distributing HY into block cyclic form took 7.615 ms
rank =  0, finding Y'*HY took 1.956 ms
Rank 0, Project_Hamiltonian used 32.275 ms
Total time for projection: 32.295 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.052 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.111 ms
    first calculated eigval = -0.601400872711887
    last  calculated eigval = 0.032935987525456
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60140087271189
lambda[   2] =  -0.41226932372745
lambda[   3] =  -0.18745677169243
lambda[   4] =  -0.17758330019177
lambda[   5] =  -0.02365129721501
lambda[   6] =   0.02258278776780
lambda[   7] =   0.02739683912072
lambda[   8] =   0.03293598752546
==subpsace eigenproblem: bcast eigvals took 0.041 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 2.386 ms
rank =  0, Distributing orbital back into band + domain format took 7.574 ms
rank = 0, Subspace_Rotation used 9.985 ms

Total time for subspace rotation: 9.990 ms
rank = 0, Efermi =  -0.182520035916 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.163 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.334 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.442 ms
rank = 0, Calculating density took 866.592 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
rank = 0, D2D took 0.914 ms
rank = 0, Transfering density took 0.916 ms
Etot    =    -7.021565094379
Eband   =    -2.398875574239
E1      =     6.284013373466
E2      =    -2.017840983729
E3      =    -3.045583287836
Exc     =    -2.706270291906
Esc     =   -13.258574824966
Entropy =    -0.005282048298
dE = 4.272e-06, dEband = 1.591e-04
rank = 0, Calculating/Estimating energy took 0.982 ms, Etot = -7.021565094, dEtot = 4.272e-06, dEband = 1.591e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0119055066357, which took 0.051 ms

iter_count = 108, r_2norm = 4.664e-07, tol*||rhs|| = 4.762e-07

Anderson update took 64.053 ms, out of which F'*F took 29.749 ms; b-Ax took 202.244 ms, out of which Lap took 180.671 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.648 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501081, int_b + int_rho = -1.355e-13, checking this took 0.192 ms
2-norm of RHS = 396.2987853407865, which took 0.065 ms

iter_count = 162, r_2norm = 3.940e-04, tol*||rhs|| = 3.963e-04

Anderson update took 100.151 ms, out of which F'*F took 46.156 ms; b-Ax took 308.592 ms, out of which Lap took 273.520 ms
Solving Poisson took 683.506 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.146 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.162886 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 89.854 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.477 ms
Total time for convolution: 	 convolve: 5.147702 
Total time for convolution: 	 convolve: 5.149462 
Total time for convolution: 	 convolve: 5.146613 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.396 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 1.713 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.940 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.686 ms

This SCF took 26648.570 ms, scf error = 2.447e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.132936, lowerbound = -0.601401, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 799.583 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.186 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.403 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.961 ms
rank =  0, Distribute data + matrix mult took 10.561 ms
rank =  0, finding HY took 13.689 ms
rank =  0, distributing HY into block cyclic form took 7.591 ms
rank =  0, finding Y'*HY took 1.971 ms
Rank 0, Project_Hamiltonian used 33.843 ms
Total time for projection: 33.856 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.060 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.601295943280900
    last  calculated eigval = 0.034217083956379
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60129594328090
lambda[   2] =  -0.41215970617145
lambda[   3] =  -0.18737688248498
lambda[   4] =  -0.17750629194612
lambda[   5] =  -0.02264382264964
lambda[   6] =   0.02322871449258
lambda[   7] =   0.02860245812204
lambda[   8] =   0.03421708395638
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 2.392 ms
rank =  0, Distributing orbital back into band + domain format took 7.439 ms
rank = 0, Subspace_Rotation used 9.842 ms

Total time for subspace rotation: 9.848 ms
rank = 0, Efermi =  -0.182441587190 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 2.063 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.450 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.282 ms
rank = 0, Calculating density took 849.343 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.039 ms
rank = 0, D2D took 1.140 ms
rank = 0, Transfering density took 1.142 ms
Etot    =    -7.021588034993
Eband   =    -2.398286297179
E1      =     6.283826410236
E2      =    -2.017418308966
E3      =    -3.045567744640
Exc     =    -2.706255937752
Esc     =   -13.258574824966
Entropy =    -0.005283438938
dE = 7.647e-06, dEband = 1.964e-04
rank = 0, Calculating/Estimating energy took 0.981 ms, Etot = -7.021588035, dEtot = 7.647e-06, dEband = 1.964e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0105211028897, which took 0.174 ms

iter_count = 114, r_2norm = 2.688e-07, tol*||rhs|| = 4.208e-07

Anderson update took 66.999 ms, out of which F'*F took 31.285 ms; b-Ax took 211.747 ms, out of which Lap took 188.782 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.370 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501081, int_b + int_rho = -1.346e-13, checking this took 0.430 ms
2-norm of RHS = 396.2981688570929, which took 0.201 ms

iter_count = 96, r_2norm = 3.459e-04, tol*||rhs|| = 3.963e-04

Anderson update took 59.799 ms, out of which F'*F took 27.014 ms; b-Ax took 182.371 ms, out of which Lap took 160.877 ms
Solving Poisson took 403.071 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.150981 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 105.005 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.164946 
Total time for convolution: 	 convolve: 5.223260 
Total time for convolution: 	 convolve: 5.154595 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.020 ms
======D2D: initiated sending and receiving took 1.254 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.694 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.897 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.628 ms

This SCF took 26481.188 ms, scf error = 1.712e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.134217, lowerbound = -0.601296, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 800.377 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 7.824 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.384 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 9.237 ms
rank =  0, finding HY took 13.500 ms
rank =  0, distributing HY into block cyclic form took 7.579 ms
rank =  0, finding Y'*HY took 1.974 ms
Rank 0, Project_Hamiltonian used 32.322 ms
Total time for projection: 32.337 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.053 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.601274990620354
    last  calculated eigval = 0.034550192346859
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60127499062035
lambda[   2] =  -0.41214003122881
lambda[   3] =  -0.18735595880099
lambda[   4] =  -0.17748631404234
lambda[   5] =  -0.02235219158029
lambda[   6] =   0.02292773561707
lambda[   7] =   0.02872362531393
lambda[   8] =   0.03455019234686
==subpsace eigenproblem: bcast eigvals took 0.056 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 2.373 ms
rank =  0, Distributing orbital back into band + domain format took 7.504 ms
rank = 0, Subspace_Rotation used 9.892 ms

Total time for subspace rotation: 9.898 ms
rank = 0, Efermi =  -0.182421136396 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.166 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.249 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.327 ms
rank = 0, Calculating density took 848.651 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.127 ms
rank = 0, D2D took 1.244 ms
rank = 0, Transfering density took 1.246 ms
Etot    =    -7.021590149352
Eband   =    -2.398163061854
E1      =     6.283754015361
E2      =    -2.017365809984
E3      =    -3.045578966239
Exc     =    -2.706267158658
Esc     =   -13.258574824966
Entropy =    -0.005283895458
dE = 7.048e-07, dEband = 4.108e-05
rank = 0, Calculating/Estimating energy took 0.958 ms, Etot = -7.021590149, dEtot = 7.048e-07, dEband = 4.108e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0096419305714, which took 0.146 ms

iter_count = 108, r_2norm = 3.738e-07, tol*||rhs|| = 3.857e-07

Anderson update took 63.321 ms, out of which F'*F took 29.282 ms; b-Ax took 200.391 ms, out of which Lap took 178.436 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.314 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501083, int_b + int_rho = -1.210e-13, checking this took 0.156 ms
2-norm of RHS = 396.2977356338850, which took 0.167 ms

iter_count = 114, r_2norm = 3.382e-04, tol*||rhs|| = 3.963e-04

Anderson update took 71.097 ms, out of which F'*F took 32.321 ms; b-Ax took 217.353 ms, out of which Lap took 192.615 ms
Solving Poisson took 479.012 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.160630 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 71.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.151761 
Total time for convolution: 	 convolve: 5.164254 
Total time for convolution: 	 convolve: 5.146489 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.997 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.585 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.135 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 1.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.902 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.611 ms

This SCF took 26776.740 ms, scf error = 1.336e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.134550, lowerbound = -0.601275, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 796.558 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.655 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.553 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 9.232 ms
rank =  0, finding HY took 13.514 ms
rank =  0, distributing HY into block cyclic form took 7.667 ms
rank =  0, finding Y'*HY took 1.985 ms
Rank 0, Project_Hamiltonian used 32.426 ms
Total time for projection: 32.439 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.059 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.601256735160760
    last  calculated eigval = 0.035152882588142
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60125673516076
lambda[   2] =  -0.41212141056732
lambda[   3] =  -0.18734064409975
lambda[   4] =  -0.17747308971292
lambda[   5] =  -0.02196788922056
lambda[   6] =   0.02285874471327
lambda[   7] =   0.02891442919559
lambda[   8] =   0.03515288258814
==subpsace eigenproblem: bcast eigvals took 0.068 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 2.411 ms
rank =  0, Distributing orbital back into band + domain format took 7.502 ms
rank = 0, Subspace_Rotation used 9.924 ms

Total time for subspace rotation: 9.930 ms
rank = 0, Efermi =  -0.182406866881 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.134 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.489 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.319 ms
rank = 0, Calculating density took 845.179 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.027 ms
rank = 0, D2D took 1.125 ms
rank = 0, Transfering density took 1.126 ms
Etot    =    -7.021594148393
Eband   =    -2.398058386975
E1      =     6.283713833260
E2      =    -2.017305069433
E3      =    -3.045561627638
Exc     =    -2.706256562336
Esc     =   -13.258574824966
Entropy =    -0.005284904446
dE = 1.333e-06, dEband = 3.489e-05
rank = 0, Calculating/Estimating energy took 0.975 ms, Etot = -7.021594148, dEtot = 1.333e-06, dEband = 3.489e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0084478505110, which took 0.158 ms

iter_count = 114, r_2norm = 2.174e-07, tol*||rhs|| = 3.379e-07

Anderson update took 66.485 ms, out of which F'*F took 31.090 ms; b-Ax took 212.136 ms, out of which Lap took 188.064 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.104 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501080, int_b + int_rho = -1.446e-13, checking this took 0.121 ms
2-norm of RHS = 396.2974254436956, which took 0.180 ms

iter_count = 84, r_2norm = 3.200e-04, tol*||rhs|| = 3.963e-04

Anderson update took 51.081 ms, out of which F'*F took 23.299 ms; b-Ax took 158.707 ms, out of which Lap took 140.171 ms
Solving Poisson took 350.725 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.139 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.156735 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 103.509 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.149450 
Total time for convolution: 	 convolve: 5.177646 
Total time for convolution: 	 convolve: 5.150966 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.592 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.145 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.549 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.559 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.914 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.513 ms

This SCF took 26398.533 ms, scf error = 1.164e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.135153, lowerbound = -0.601257, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 792.081 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 25.392 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.458 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 26.889 ms
rank =  0, finding HY took 13.507 ms
rank =  0, distributing HY into block cyclic form took 7.669 ms
rank =  0, finding Y'*HY took 1.941 ms
Rank 0, Project_Hamiltonian used 50.039 ms
Total time for projection: 50.053 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.052 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.115 ms
    first calculated eigval = -0.601243645741138
    last  calculated eigval = 0.035232250003360
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60124364574114
lambda[   2] =  -0.41210860276756
lambda[   3] =  -0.18733019958863
lambda[   4] =  -0.17746311737838
lambda[   5] =  -0.02197749225088
lambda[   6] =   0.02256424588197
lambda[   7] =   0.02860037194645
lambda[   8] =   0.03523225000336
==subpsace eigenproblem: bcast eigvals took 0.043 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 2.471 ms
rank =  0, Distributing orbital back into band + domain format took 7.478 ms
rank = 0, Subspace_Rotation used 9.963 ms

Total time for subspace rotation: 9.969 ms
rank = 0, Efermi =  -0.182396658458 calculate fermi energy took 0.640 ms
rank = 0, --- Calculate rho: sum over local bands took 2.285 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.511 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.379 ms
rank = 0, Calculating density took 858.604 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.409 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.385 ms
rank = 0, D2D took 1.548 ms
rank = 0, Transfering density took 1.551 ms
Etot    =    -7.021594925053
Eband   =    -2.397985637311
E1      =     6.283667660503
E2      =    -2.017276449418
E3      =    -3.045572398659
Exc     =    -2.706265839001
Esc     =   -13.258574824966
Entropy =    -0.005285132355
dE = 2.589e-07, dEband = 2.425e-05
rank = 0, Calculating/Estimating energy took 1.258 ms, Etot = -7.021594925, dEtot = 2.589e-07, dEband = 2.425e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0076497946943, which took 0.117 ms

iter_count = 108, r_2norm = 1.958e-07, tol*||rhs|| = 3.060e-07

Anderson update took 63.150 ms, out of which F'*F took 29.490 ms; b-Ax took 202.610 ms, out of which Lap took 180.954 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.946 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501081, int_b + int_rho = -1.392e-13, checking this took 0.126 ms
2-norm of RHS = 396.2981055572043, which took 0.128 ms

iter_count = 126, r_2norm = 3.712e-04, tol*||rhs|| = 3.963e-04

Anderson update took 77.265 ms, out of which F'*F took 35.377 ms; b-Ax took 239.937 ms, out of which Lap took 211.617 ms
Solving Poisson took 528.039 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.226 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.147928 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 89.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.162493 
Total time for convolution: 	 convolve: 5.146260 
Total time for convolution: 	 convolve: 5.196516 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.772 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.597 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.356 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.915 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.620 ms

This SCF took 27974.694 ms, scf error = 1.022e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.135232, lowerbound = -0.601244, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 830.472 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.719 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.461 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 9.204 ms
rank =  0, finding HY took 13.473 ms
rank =  0, distributing HY into block cyclic form took 7.635 ms
rank =  0, finding Y'*HY took 1.981 ms
Rank 0, Project_Hamiltonian used 32.320 ms
Total time for projection: 32.336 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.057 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.114 ms
    first calculated eigval = -0.601235080397555
    last  calculated eigval = 0.035500190607453
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60123508039756
lambda[   2] =  -0.41209672741963
lambda[   3] =  -0.18733066444965
lambda[   4] =  -0.17746214017142
lambda[   5] =  -0.02195299002048
lambda[   6] =   0.02317061280603
lambda[   7] =   0.02821544116913
lambda[   8] =   0.03550019060745
==subpsace eigenproblem: bcast eigvals took 0.092 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 2.407 ms
rank =  0, Distributing orbital back into band + domain format took 7.476 ms
rank = 0, Subspace_Rotation used 9.896 ms

Total time for subspace rotation: 9.900 ms
rank = 0, Efermi =  -0.182396402285 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 2.206 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.373 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.304 ms
rank = 0, Calculating density took 878.907 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.035 ms
rank = 0, D2D took 1.146 ms
rank = 0, Transfering density took 1.148 ms
Etot    =    -7.021600337574
Eband   =    -2.397945887883
E1      =     6.283685256429
E2      =    -2.017219864568
E3      =    -3.045533938268
Exc     =    -2.706234247691
Esc     =   -13.258574824966
Entropy =    -0.005284436298
dE = 1.804e-06, dEband = 1.325e-05
rank = 0, Calculating/Estimating energy took 1.405 ms, Etot = -7.021600338, dEtot = 1.804e-06, dEband = 1.325e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0077236925660, which took 0.056 ms

iter_count = 108, r_2norm = 1.980e-07, tol*||rhs|| = 3.089e-07

Anderson update took 63.638 ms, out of which F'*F took 29.670 ms; b-Ax took 201.077 ms, out of which Lap took 179.003 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 464.860 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501082, int_b + int_rho = -1.301e-13, checking this took 0.142 ms
2-norm of RHS = 396.2984209183809, which took 0.066 ms

iter_count = 60, r_2norm = 3.631e-04, tol*||rhs|| = 3.963e-04

Anderson update took 36.476 ms, out of which F'*F took 16.760 ms; b-Ax took 114.840 ms, out of which Lap took 101.257 ms
Solving Poisson took 252.532 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.181197 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 81.773 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.574 ms
Total time for convolution: 	 convolve: 5.170293 
Total time for convolution: 	 convolve: 5.177780 
Total time for convolution: 	 convolve: 5.150251 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.603 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 1.532 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.653 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.384 ms

This SCF took 26300.336 ms, scf error = 1.302e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.135500, lowerbound = -0.601235, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 804.771 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.554 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.662 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 9.251 ms
rank =  0, finding HY took 13.450 ms
rank =  0, distributing HY into block cyclic form took 7.670 ms
rank =  0, finding Y'*HY took 1.989 ms
Rank 0, Project_Hamiltonian used 32.388 ms
Total time for projection: 32.400 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.058 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.601239310488247
    last  calculated eigval = 0.035624909528064
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60123931048825
lambda[   2] =  -0.41210060540035
lambda[   3] =  -0.18733335705954
lambda[   4] =  -0.17746527820054
lambda[   5] =  -0.02183166459392
lambda[   6] =   0.02319855426558
lambda[   7] =   0.02806016005974
lambda[   8] =   0.03562490952806
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.140 ms
rank =  0, subspace rotation using ScaLAPACK took 2.414 ms
rank =  0, Distributing orbital back into band + domain format took 7.521 ms
rank = 0, Subspace_Rotation used 9.946 ms

Total time for subspace rotation: 9.950 ms
rank = 0, Efermi =  -0.182399317604 calculate fermi energy took 1.264 ms
rank = 0, --- Calculate rho: sum over local bands took 2.557 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.360 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.363 ms
rank = 0, Calculating density took 854.044 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.962 ms
rank = 0, D2D took 1.172 ms
rank = 0, Transfering density took 1.175 ms
Etot    =    -7.021599768187
Eband   =    -2.397967426771
E1      =     6.283709679020
E2      =    -2.017220754584
E3      =    -3.045522895860
Exc     =    -2.706226194620
Esc     =   -13.258574824966
Entropy =    -0.005284651294
dE = 1.898e-07, dEband = 7.180e-06
rank = 0, Calculating/Estimating energy took 2.170 ms, Etot = -7.021599768, dEtot = 1.898e-07, dEband = 7.180e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0085239548012, which took 0.061 ms

iter_count = 102, r_2norm = 3.126e-07, tol*||rhs|| = 3.410e-07

Anderson update took 59.917 ms, out of which F'*F took 27.964 ms; b-Ax took 192.341 ms, out of which Lap took 171.607 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.212 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501083, int_b + int_rho = -1.137e-13, checking this took 0.134 ms
2-norm of RHS = 396.2985302196286, which took 0.189 ms

iter_count = 48, r_2norm = 3.558e-04, tol*||rhs|| = 3.963e-04

Anderson update took 28.971 ms, out of which F'*F took 13.148 ms; b-Ax took 89.746 ms, out of which Lap took 79.298 ms
Solving Poisson took 214.228 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.155601 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 73.726 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.150294 
Total time for convolution: 	 convolve: 5.156836 
Total time for convolution: 	 convolve: 5.146210 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.609 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.365 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.702 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.945 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.685 ms

This SCF took 26192.607 ms, scf error = 1.312e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.135625, lowerbound = -0.601239, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 827.565 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.699 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.517 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 12.244 ms
rank =  0, finding HY took 13.466 ms
rank =  0, distributing HY into block cyclic form took 7.867 ms
rank =  0, finding Y'*HY took 1.749 ms
Rank 0, Project_Hamiltonian used 35.358 ms
Total time for projection: 35.371 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.056 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.601246555151199
    last  calculated eigval = 0.035453900612199
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60124655515120
lambda[   2] =  -0.41210683754951
lambda[   3] =  -0.18733622936981
lambda[   4] =  -0.17747040942536
lambda[   5] =  -0.02190626907297
lambda[   6] =   0.02265994689790
lambda[   7] =   0.02774278894402
lambda[   8] =   0.03545390061220
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 2.352 ms
rank =  0, Distributing orbital back into band + domain format took 7.571 ms
rank = 0, Subspace_Rotation used 9.935 ms

Total time for subspace rotation: 9.940 ms
rank = 0, Efermi =  -0.182403319372 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 2.124 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.536 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.279 ms
rank = 0, Calculating density took 879.080 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.064 ms
rank = 0, D2D took 1.168 ms
rank = 0, Transfering density took 1.582 ms
Etot    =    -7.021600965889
Eband   =    -2.397999808335
E1      =     6.283740161594
E2      =    -2.017227544270
E3      =    -3.045497219642
Exc     =    -2.706205516477
Esc     =   -13.258574824966
Entropy =    -0.005285741617
dE = 3.992e-07, dEband = 1.079e-05
rank = 0, Calculating/Estimating energy took 1.525 ms, Etot = -7.021600966, dEtot = 3.992e-07, dEband = 1.079e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0075163333417, which took 0.093 ms

iter_count = 108, r_2norm = 2.100e-07, tol*||rhs|| = 3.007e-07

Anderson update took 63.086 ms, out of which F'*F took 29.765 ms; b-Ax took 202.755 ms, out of which Lap took 180.751 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.383 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501082, int_b + int_rho = -1.246e-13, checking this took 0.137 ms
2-norm of RHS = 396.2978506445502, which took 0.117 ms

iter_count = 42, r_2norm = 3.386e-04, tol*||rhs|| = 3.963e-04

Anderson update took 25.678 ms, out of which F'*F took 11.728 ms; b-Ax took 79.460 ms, out of which Lap took 70.024 ms
Solving Poisson took 177.610 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.158726 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 88.703 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.166152 
Total time for convolution: 	 convolve: 5.155833 
Total time for convolution: 	 convolve: 5.157910 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.183 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.593 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 1.623 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.905 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.560 ms

This SCF took 26227.939 ms, scf error = 1.333e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.135454, lowerbound = -0.601247, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 810.091 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.810 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.373 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 9.208 ms
rank =  0, finding HY took 13.597 ms
rank =  0, distributing HY into block cyclic form took 7.597 ms
rank =  0, finding Y'*HY took 1.972 ms
Rank 0, Project_Hamiltonian used 32.404 ms
Total time for projection: 32.419 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.052 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.601232397551543
    last  calculated eigval = 0.035189630331137
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60123239755154
lambda[   2] =  -0.41209443619433
lambda[   3] =  -0.18732759762612
lambda[   4] =  -0.17746068804048
lambda[   5] =  -0.02210295653796
lambda[   6] =   0.02249893814202
lambda[   7] =   0.02724324582703
lambda[   8] =   0.03518963033114
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.137 ms
rank =  0, subspace rotation using ScaLAPACK took 2.447 ms
rank =  0, Distributing orbital back into band + domain format took 7.479 ms
rank = 0, Subspace_Rotation used 9.940 ms

Total time for subspace rotation: 9.945 ms
rank = 0, Efermi =  -0.182394142808 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.145 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.263 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.327 ms
rank = 0, Calculating density took 858.429 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.946 ms
rank = 0, D2D took 2.043 ms
rank = 0, Transfering density took 2.045 ms
Etot    =    -7.021601176922
Eband   =    -2.397929579659
E1      =     6.283666359809
E2      =    -2.017223677360
E3      =    -3.045528853182
Exc     =    -2.706230446971
Esc     =   -13.258574824966
Entropy =    -0.005285215677
dE = 7.034e-08, dEband = 2.341e-05
rank = 0, Calculating/Estimating energy took 1.180 ms, Etot = -7.021601177, dEtot = 7.034e-08, dEband = 2.341e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0074029304056, which took 0.051 ms

iter_count = 108, r_2norm = 2.190e-07, tol*||rhs|| = 2.961e-07

Anderson update took 63.172 ms, out of which F'*F took 29.320 ms; b-Ax took 202.458 ms, out of which Lap took 179.527 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.032 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501080, int_b + int_rho = -1.455e-13, checking this took 0.142 ms
2-norm of RHS = 396.2974671906332, which took 0.145 ms

iter_count = 42, r_2norm = 3.760e-04, tol*||rhs|| = 3.963e-04

Anderson update took 26.284 ms, out of which F'*F took 11.997 ms; b-Ax took 79.853 ms, out of which Lap took 70.526 ms
Solving Poisson took 178.407 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.168 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.170443 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 76.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.154201 
Total time for convolution: 	 convolve: 5.194673 
Total time for convolution: 	 convolve: 5.149971 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.591 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.696 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.917 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.652 ms

This SCF took 26243.413 ms, scf error = 1.058e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.135190, lowerbound = -0.601232, upperbound = 267.567598

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 806.590 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.769 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.542 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 9.338 ms
rank =  0, finding HY took 13.403 ms
rank =  0, distributing HY into block cyclic form took 7.581 ms
rank =  0, finding Y'*HY took 2.185 ms
Rank 0, Project_Hamiltonian used 32.554 ms
Total time for projection: 32.567 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.063 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.601224169372936
    last  calculated eigval = 0.034790533069624
The last 8 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 6):
lambda[   1] =  -0.60122416937294
lambda[   2] =  -0.41208681190166
lambda[   3] =  -0.18731896485320
lambda[   4] =  -0.17745318795787
lambda[   5] =  -0.02238215533641
lambda[   6] =   0.02219384099691
lambda[   7] =   0.02675251113672
lambda[   8] =   0.03479053306962
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.357 ms
rank =  0, subspace rotation using ScaLAPACK took 2.539 ms
rank =  0, Distributing orbital back into band + domain format took 7.555 ms
rank = 0, Subspace_Rotation used 10.112 ms

Total time for subspace rotation: 10.118 ms
rank = 0, Efermi =  -0.182386076380 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.195 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.415 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.223 ms
rank = 0, Calculating density took 855.578 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 2.263 ms
rank = 0, D2D took 2.365 ms
rank = 0, Transfering density took 2.371 ms
Etot    =    -7.021602123622
Eband   =    -2.397880450412
E1      =     6.283623685514
E2      =    -2.017213101013
E3      =    -3.045545983432
Exc     =    -2.706243855807
Esc     =   -13.258574824966
Entropy =    -0.005285762396
dE = 3.156e-07, dEband = 1.638e-05
rank = 0, Calculating/Estimating energy took 1.207 ms, Etot = -7.021602124, dEtot = 3.156e-07, dEband = 1.638e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0079419178221, which took 0.104 ms

iter_count = 102, r_2norm = 3.079e-07, tol*||rhs|| = 3.177e-07

Anderson update took 60.380 ms, out of which F'*F took 28.173 ms; b-Ax took 192.856 ms, out of which Lap took 170.793 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.023 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -6.00000000501095, int_rho =   6.00000000501082, int_b + int_rho = -1.282e-13, checking this took 0.117 ms
2-norm of RHS = 396.2961617884389, which took 0.158 ms

iter_count = 84, r_2norm = 3.785e-04, tol*||rhs|| = 3.963e-04

Anderson update took 51.507 ms, out of which F'*F took 24.967 ms; b-Ax took 162.478 ms, out of which Lap took 143.711 ms
Solving Poisson took 354.752 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.288 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.150597 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 94.995 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.150875 
Total time for convolution: 	 convolve: 5.145802 
Total time for convolution: 	 convolve: 5.145107 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.271 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.537 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.453 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.014 ms

This SCF took 26311.971 ms, scf error = 8.444e-05
The last 8 occupations of kpoints #1 are (Nelectron = 6):
lambda[   1] =  -0.60122416937294, occ[   1] =   2.00000000000000
lambda[   2] =  -0.41208681190166, occ[   2] =   2.00000000000000
lambda[   3] =  -0.18731896485320, occ[   3] =   1.65745802171021
lambda[   4] =  -0.17745318795787, occ[   4] =   0.34254198331376
lambda[   5] =  -0.02238215533641, occ[   5] =   0.00000000000000
lambda[   6] =   0.02219384099691, occ[   6] =   0.00000000000000
lambda[   7] =   0.02675251113672, occ[   7] =   0.00000000000000
lambda[   8] =   0.03479053306962, occ[   8] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 7 (90%) = 0.000000000000000.
Occupation of state 8 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.818 ms, time for Allreduce/Reduce: 3.207 ms 
Time for calculating local force components: 10.199 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000001120135  -0.05012562245879   0.01782023206436
  0.00000000954075   0.05012561829779   0.01782023116130
  0.00000203284931  -0.00000011242720  -0.28057668404966
force_loc = 
 -0.00000001744527   0.05130070165177  -0.03641318028846
 -0.00000003733413  -0.05130053997439  -0.03641336450574
 -0.00000037117041   0.00000048043380   0.31069868531505
Time for calculating nonlocal force components: 20.185 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000005695454   0.00000002042869   0.00708334045249
[0mTime for calculating XC forces components: 9.240 ms
 Cartesian force = 
 -0.00000052980628   0.00117489720909  -0.01859936827388
 -0.00000055135573  -0.00117510366049  -0.01859955339422
  0.00000108116201   0.00000020645140   0.03719892166810
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.376 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Time for printing density: 391.258 ms
The program took 645.821 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:39:34
Job ID:        2266967
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:11:36,vmem=8356K,walltime=00:10:58,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-5-2
---------------------------------------
