---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:48
Job ID:    2266506
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:56
Job ID:    2266506
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.049 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.012 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 17.930 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 6.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = N.psp8

Reading ion file took 41.801 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 45.980 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.937 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.081 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    9.603552	   12.046097	   11.075166	
   10.396448	    7.953903	   11.075166	
   11.792029	   11.898906	    8.924834	
    8.207971	    8.101094	    8.924834	
   10.000000	   11.365106	    9.325654	
   10.000000	    8.634894	    9.325654	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.151 ms
Set up communicators.

--set up spincomm took 2.355 ms

--set up kptcomm took 0.380 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {2, 2, 3}
gridsizes = [100, 100, 100], Nstates = 13, dmcomm dims = [2, 2, 3]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 1, ScaLAPACK topology Dims = (1, 1)
nproc = 12, size_blacscomm = 1 = dims[0] * dims[1] = (1, 1)
Nd_blacscomm 85000, Nstates 13 
rank =  0, my blacs rank = 0, BLCYC size (85000, 13), actual size (85000, 13)
rank = 0, mb = nb = 13, mbQ = nbQ = 64
rank = 0, nr_Hp = 13, nc_Hp = 13
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.079 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 1
# of bands per bandcomm          : 13
npdomain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.565 ms

Calculate_SplineDerivRadFun took 0.114 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.290 ms.
time spent on vectorized spline interp: 2.742 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.056 ms.
time spent on vectorized spline interp: 1.625 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.533 ms.

Calculating rb for all atom types took 11.255 ms
----------------------
Estimated memory usage
Total: 562.34 MB
orbitals             : 297.55 MB
global sized vectors : 213.62 MB
subspace matrices : 47.53 kB
others : 51.12 MB
----------------------------------------------
Estimated memory usage per processor: 46.86 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.912 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.011 ms
Calculating pseudocharge density ... 
the global sum of int_b = -14.0000000205310, sum_int_rho = 13.6078034525912
PosCharge = 14.000000020531, NegCharge = -13.607803452591, scal_fac = 1.028821445673
After scaling, int_rho = 14.0000000205309, PosCharge + NegCharge - NetCharge = 1.776e-15
--Calculate Vref took 0.272 ms
--Calculate rho_guess took 1.621 ms

 integral of b = -14.0000000205310,
 int{b} + Nelectron + NetCharge = -2.053e-08,
 Esc = -38.9551021538252,
 MPI_Reduce took 4.605 ms

Calculating b & b_ref took 11.325 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.008 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.016 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.002 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.009 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 24.806 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053098, int_b + int_rho = -2.547e-14, checking this took 0.091 ms
2-norm of RHS = 600.0678502154220, which took 0.103 ms

iter_count = 414, r_2norm = 5.966e-04, tol*||rhs|| = 6.001e-04

Anderson update took 241.539 ms, out of which F'*F took 103.982 ms; b-Ax took 704.278 ms, out of which Lap took 632.544 ms
Solving Poisson took 1505.901 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.393 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
Total time for convolution: 	 convolve: 5.131835 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 43.635 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.789 ms
Total time for convolution: 	 convolve: 5.118845 
Total time for convolution: 	 convolve: 5.105837 
Total time for convolution: 	 convolve: 5.095244 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.719 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.512 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
rank = 0, XC calculation took 24486.992 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.550 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 1.605 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.139 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.640 ms
    Lanczos iter 53, eigmin  = -0.953672280, eigmax = 264.921762090, err_eigmin = 2.593e-04, err_eigmax = 9.828e-03
rank =   0, Lanczos took 119.115 ms, eigmin = -0.953672279707, eigmax = 267.570979710594

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.258654, lowerbound = -1.053672, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1090.940 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.778 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 2.804 ms
rank =  0, finding HY took 18.220 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 2.349 ms
Rank 0, Project_Hamiltonian used 23.392 ms
Total time for projection: 23.403 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.319 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.114 ms
rank = 0, Solve_Generalized_EigenProblem used 0.437 ms
    first calculated eigval = 2.826713488550418
    last  calculated eigval = 3.238092323743439
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =   2.82671348855042
lambda[   2] =   2.89472890750989
lambda[   3] =   2.91926769117516
lambda[   4] =   2.94702967911815
lambda[   5] =   2.97431037695380
lambda[   6] =   3.00715921128686
lambda[   7] =   3.03585209873372
lambda[   8] =   3.06054475220232
lambda[   9] =   3.07586961541787
lambda[  10] =   3.10111456233062
lambda[  11] =   3.14667806889380
lambda[  12] =   3.20609875901410
lambda[  13] =   3.23809232374344
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.461 ms
rank =  0, subspace rotation using ScaLAPACK took 3.078 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.083 ms

Total time for subspace rotation: 3.084 ms
rank = 0, Efermi =   3.048198421045 calculate fermi energy took 0.046 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.338092, lowerbound = -1.053672, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1089.942 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.712 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 3.590 ms
rank =  0, finding HY took 18.143 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.340 ms
Rank 0, Project_Hamiltonian used 24.090 ms
Total time for projection: 24.094 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.109 ms
    first calculated eigval = -0.609007430212097
    last  calculated eigval = 0.461134302735109
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.60900743021210
lambda[   2] =  -0.28682945832704
lambda[   3] =  -0.12502494045041
lambda[   4] =  -0.03131709974704
lambda[   5] =   0.09294304045316
lambda[   6] =   0.19452185422498
lambda[   7] =   0.27859911985136
lambda[   8] =   0.31817957199836
lambda[   9] =   0.36207293367067
lambda[  10] =   0.37921840962014
lambda[  11] =   0.39115608529116
lambda[  12] =   0.42274521101920
lambda[  13] =   0.46113430273511
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.120 ms
rank =  0, subspace rotation using ScaLAPACK took 3.036 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.042 ms

Total time for subspace rotation: 3.042 ms
rank = 0, Efermi =   0.298389440086 calculate fermi energy took 0.019 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.561134, lowerbound = -1.053672, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1092.896 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.714 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 2.741 ms
rank =  0, finding HY took 18.179 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.316 ms
Rank 0, Project_Hamiltonian used 23.252 ms
Total time for projection: 23.256 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.100 ms
    first calculated eigval = -0.954494357018852
    last  calculated eigval = 0.143072351570538
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.95449435701885
lambda[   2] =  -0.78537957874351
lambda[   3] =  -0.53409078497623
lambda[   4] =  -0.51355705139672
lambda[   5] =  -0.47989035926709
lambda[   6] =  -0.29991772944543
lambda[   7] =  -0.26546198713125
lambda[   8] =   0.04707137448340
lambda[   9] =   0.07908348730301
lambda[  10] =   0.11072003858432
lambda[  11] =   0.11825352924244
lambda[  12] =   0.13403557724761
lambda[  13] =   0.14307235157054
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.112 ms
rank =  0, subspace rotation using ScaLAPACK took 3.027 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.032 ms

Total time for subspace rotation: 3.033 ms
rank = 0, Efermi =   0.017928590677 calculate fermi energy took 0.020 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.243072, lowerbound = -1.053672, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1091.490 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.394 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 3.432 ms
rank =  0, finding HY took 18.172 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.341 ms
Rank 0, Project_Hamiltonian used 24.390 ms
Total time for projection: 24.405 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.149 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.017 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.955543022681599
    last  calculated eigval = 0.090008099291644
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.95554302268160
lambda[   2] =  -0.78660089737738
lambda[   3] =  -0.54044350267456
lambda[   4] =  -0.52755258571439
lambda[   5] =  -0.49366455991165
lambda[   6] =  -0.31541451153483
lambda[   7] =  -0.31137865948573
lambda[   8] =  -0.01750159859875
lambda[   9] =   0.02116046494439
lambda[  10] =   0.05957510606356
lambda[  11] =   0.06342923812537
lambda[  12] =   0.06496142145793
lambda[  13] =   0.09000809929164
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 3.034 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.039 ms

Total time for subspace rotation: 3.040 ms
rank = 0, Efermi =  -0.046644382409 calculate fermi energy took 0.021 ms
rank = 0, --- Calculate rho: sum over local bands took 1.471 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 4596.558 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
rank = 0, D2D took 0.446 ms
rank = 0, Transfering density took 0.449 ms
Etot    =   -23.154814415654
Eband   =    -7.861195479120
E1      =    16.234983218213
E2      =    -6.437772181377
E3      =    -8.239760803027
Exc     =    -7.251032984710
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 3.859e+00, dEband = 1.310e+00
rank = 0, Calculating/Estimating energy took 0.969 ms, Etot = -23.154814416, dEtot = 3.859e+00, dEband = 1.310e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 51.5891325225658, which took 0.048 ms

iter_count = 96, r_2norm = 1.290e-03, tol*||rhs|| = 2.064e-03

Anderson update took 51.495 ms, out of which F'*F took 23.956 ms; b-Ax took 162.044 ms, out of which Lap took 145.499 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.743 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053099, int_b + int_rho = -2.365e-14, checking this took 0.112 ms
2-norm of RHS = 596.6282480087001, which took 0.156 ms

iter_count = 282, r_2norm = 5.554e-04, tol*||rhs|| = 5.966e-04

Anderson update took 151.725 ms, out of which F'*F took 71.573 ms; b-Ax took 477.496 ms, out of which Lap took 428.995 ms
Solving Poisson took 1011.733 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.945 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.122 ms
Total time for convolution: 	 convolve: 5.237342 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.197704 
Total time for convolution: 	 convolve: 5.235469 
Total time for convolution: 	 convolve: 5.233140 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.346 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 0.349 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.372 ms

This SCF took 30827.420 ms, scf error = 1.759e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.190008, lowerbound = -0.955543, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1091.807 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.739 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 2.765 ms
rank =  0, finding HY took 18.440 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.339 ms
Rank 0, Project_Hamiltonian used 23.566 ms
Total time for projection: 23.579 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.112 ms
    first calculated eigval = -0.926477459413039
    last  calculated eigval = 0.068859381231036
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.92647745941304
lambda[   2] =  -0.75291457621415
lambda[   3] =  -0.51230134811072
lambda[   4] =  -0.49961670834038
lambda[   5] =  -0.46422350585298
lambda[   6] =  -0.28197348229927
lambda[   7] =  -0.27807310686704
lambda[   8] =  -0.03545029276974
lambda[   9] =   0.00020237102095
lambda[  10] =   0.03203756338621
lambda[  11] =   0.03540630407019
lambda[  12] =   0.04226600759110
lambda[  13] =   0.06885938123104
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.131 ms
rank =  0, subspace rotation using ScaLAPACK took 3.061 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.066 ms

Total time for subspace rotation: 3.067 ms
rank = 0, Efermi =  -0.064593076565 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.490 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.035 ms
rank = 0, Calculating density took 1120.213 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
rank = 0, D2D took 0.419 ms
rank = 0, Transfering density took 0.422 ms
Etot    =   -23.123149131455
Eband   =    -7.431160374923
E1      =    15.868441508719
E2      =    -6.382391892071
E3      =    -8.355550206994
Exc     =    -7.343270209875
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 5.278e-03, dEband = 7.167e-02
rank = 0, Calculating/Estimating energy took 1.004 ms, Etot = -23.123149131, dEtot = 5.278e-03, dEband = 7.167e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 16.4104682062184, which took 1.336 ms

iter_count = 102, r_2norm = 4.544e-04, tol*||rhs|| = 6.564e-04

Anderson update took 54.497 ms, out of which F'*F took 25.639 ms; b-Ax took 174.448 ms, out of which Lap took 155.797 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.415 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053092, int_b + int_rho = -8.731e-14, checking this took 0.115 ms
2-norm of RHS = 592.6304045243412, which took 0.168 ms

iter_count = 294, r_2norm = 5.477e-04, tol*||rhs|| = 5.926e-04

Anderson update took 157.118 ms, out of which F'*F took 73.838 ms; b-Ax took 499.646 ms, out of which Lap took 447.759 ms
Solving Poisson took 1056.776 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.210607 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.327552 
Total time for convolution: 	 convolve: 5.172197 
Total time for convolution: 	 convolve: 5.171376 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.600 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.189 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.332 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.655 ms

This SCF took 27508.796 ms, scf error = 1.182e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.168859, lowerbound = -0.926477, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1087.106 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.701 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 2.730 ms
rank =  0, finding HY took 18.248 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.324 ms
Rank 0, Project_Hamiltonian used 23.318 ms
Total time for projection: 23.339 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.016 ms
rank = 0, Solve_Generalized_EigenProblem used 0.087 ms
    first calculated eigval = -0.885136503520252
    last  calculated eigval = 0.056113653138400
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.88513650352025
lambda[   2] =  -0.70287310769223
lambda[   3] =  -0.47060716026779
lambda[   4] =  -0.45736278227749
lambda[   5] =  -0.42149878274807
lambda[   6] =  -0.23290755151351
lambda[   7] =  -0.22883286653289
lambda[   8] =  -0.03856648301536
lambda[   9] =  -0.00368770393349
lambda[  10] =   0.02056278197721
lambda[  11] =   0.02257374716954
lambda[  12] =   0.03198089069936
lambda[  13] =   0.05611365313840
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.163 ms
rank =  0, subspace rotation using ScaLAPACK took 3.033 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.039 ms

Total time for subspace rotation: 3.040 ms
rank = 0, Efermi =  -0.067709266834 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.470 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1115.275 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
rank = 0, D2D took 0.418 ms
rank = 0, Transfering density took 0.420 ms
Etot    =   -23.101230092556
Eband   =    -6.798437509896
E1      =    15.352429184389
E2      =    -6.247379274684
E3      =    -8.550988974606
Exc     =    -7.498487861897
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 3.653e-03, dEband = 1.055e-01
rank = 0, Calculating/Estimating energy took 0.982 ms, Etot = -23.101230093, dEtot = 3.653e-03, dEband = 1.055e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.2111905461478, which took 0.060 ms

iter_count = 102, r_2norm = 1.699e-04, tol*||rhs|| = 2.084e-04

Anderson update took 54.748 ms, out of which F'*F took 25.400 ms; b-Ax took 172.671 ms, out of which Lap took 154.222 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.403 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053094, int_b + int_rho = -6.912e-14, checking this took 0.108 ms
2-norm of RHS = 593.5321162246789, which took 0.078 ms

iter_count = 276, r_2norm = 5.336e-04, tol*||rhs|| = 5.935e-04

Anderson update took 146.729 ms, out of which F'*F took 69.153 ms; b-Ax took 474.999 ms, out of which Lap took 426.576 ms
Solving Poisson took 989.637 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.464 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.259872 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.216192 
Total time for convolution: 	 convolve: 5.189760 
Total time for convolution: 	 convolve: 5.215962 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 1.141 ms
---Transfer Veff_loc: D2D took 1.234 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.250 ms

This SCF took 27362.988 ms, scf error = 4.521e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.156114, lowerbound = -0.885137, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1103.507 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.709 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.037 ms
rank =  0, Distribute data + matrix mult took 2.750 ms
rank =  0, finding HY took 18.258 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.326 ms
Rank 0, Project_Hamiltonian used 23.354 ms
Total time for projection: 23.367 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.017 ms
rank = 0, Solve_Generalized_EigenProblem used 0.087 ms
    first calculated eigval = -0.882704480318076
    last  calculated eigval = 0.046084321818429
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.88270448031808
lambda[   2] =  -0.69604644540066
lambda[   3] =  -0.46508283536932
lambda[   4] =  -0.45039849695383
lambda[   5] =  -0.41703031712475
lambda[   6] =  -0.22799978485937
lambda[   7] =  -0.22422651363589
lambda[   8] =  -0.03939982807356
lambda[   9] =  -0.00579432507791
lambda[  10] =   0.01517542089471
lambda[  11] =   0.01772871727265
lambda[  12] =   0.02681135154050
lambda[  13] =   0.04608432181843
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 3.034 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.039 ms

Total time for subspace rotation: 3.040 ms
rank = 0, Efermi =  -0.068542611875 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.484 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.033 ms
rank = 0, Calculating density took 1131.721 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.238 ms
rank = 0, D2D took 0.391 ms
rank = 0, Transfering density took 0.394 ms
Etot    =   -23.098471299706
Eband   =    -6.726977748133
E1      =    15.337816455594
E2      =    -6.184168780559
E3      =    -8.584146884810
Exc     =    -7.522523518094
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 4.598e-04, dEband = 1.191e-02
rank = 0, Calculating/Estimating energy took 1.101 ms, Etot = -23.098471300, dEtot = 4.598e-04, dEband = 1.191e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.2611893858368, which took 0.064 ms

iter_count = 114, r_2norm = 3.299e-05, tol*||rhs|| = 5.045e-05

Anderson update took 61.313 ms, out of which F'*F took 28.554 ms; b-Ax took 193.287 ms, out of which Lap took 172.902 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.409 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053092, int_b + int_rho = -8.549e-14, checking this took 0.100 ms
2-norm of RHS = 593.4613928792177, which took 0.127 ms

iter_count = 252, r_2norm = 4.955e-04, tol*||rhs|| = 5.935e-04

Anderson update took 133.976 ms, out of which F'*F took 63.455 ms; b-Ax took 429.282 ms, out of which Lap took 384.843 ms
Solving Poisson took 901.339 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.175825 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 51.857 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.187535 
Total time for convolution: 	 convolve: 5.200715 
Total time for convolution: 	 convolve: 5.201842 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.631 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.255 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.316 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.332 ms

This SCF took 27269.491 ms, scf error = 1.060e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.146084, lowerbound = -0.882704, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1085.896 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.697 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 2.724 ms
rank =  0, finding HY took 18.205 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.329 ms
Rank 0, Project_Hamiltonian used 23.275 ms
Total time for projection: 23.287 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.111 ms
    first calculated eigval = -0.878001291110773
    last  calculated eigval = 0.037322261119708
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.87800129111077
lambda[   2] =  -0.69112020488143
lambda[   3] =  -0.46054591085288
lambda[   4] =  -0.44582262839799
lambda[   5] =  -0.41248515039181
lambda[   6] =  -0.22314070701408
lambda[   7] =  -0.21936180185702
lambda[   8] =  -0.03990879679707
lambda[   9] =  -0.00662698392622
lambda[  10] =   0.01159189547658
lambda[  11] =   0.01665103014263
lambda[  12] =   0.02393224996226
lambda[  13] =   0.03732226111971
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.131 ms
rank =  0, subspace rotation using ScaLAPACK took 3.040 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.046 ms

Total time for subspace rotation: 3.047 ms
rank = 0, Efermi =  -0.069051580614 calculate fermi energy took 0.668 ms
rank = 0, --- Calculate rho: sum over local bands took 1.430 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1114.539 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
rank = 0, D2D took 0.446 ms
rank = 0, Transfering density took 0.448 ms
Etot    =   -23.097950169032
Eband   =    -6.660955389831
E1      =    15.294966976314
E2      =    -6.156874608264
E3      =    -8.603621719907
Exc     =    -7.537355929245
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 8.686e-05, dEband = 1.100e-02
rank = 0, Calculating/Estimating energy took 1.011 ms, Etot = -23.097950169, dEtot = 8.686e-05, dEband = 1.100e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5437536531076, which took 0.062 ms

iter_count = 114, r_2norm = 1.385e-05, tol*||rhs|| = 2.175e-05

Anderson update took 60.948 ms, out of which F'*F took 30.797 ms; b-Ax took 216.909 ms, out of which Lap took 196.949 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 439.845 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053094, int_b + int_rho = -6.912e-14, checking this took 0.100 ms
2-norm of RHS = 593.7188325367582, which took 0.120 ms

iter_count = 258, r_2norm = 5.535e-04, tol*||rhs|| = 5.937e-04

Anderson update took 137.914 ms, out of which F'*F took 66.470 ms; b-Ax took 448.457 ms, out of which Lap took 402.663 ms
Solving Poisson took 929.008 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Total time for convolution: 	 convolve: 5.176537 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.198 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.241469 
Total time for convolution: 	 convolve: 5.181127 
Total time for convolution: 	 convolve: 5.191752 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.509 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.328 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.347 ms

This SCF took 27276.355 ms, scf error = 6.774e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.137322, lowerbound = -0.878001, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1085.104 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.730 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 2.758 ms
rank =  0, finding HY took 18.219 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.311 ms
Rank 0, Project_Hamiltonian used 23.309 ms
Total time for projection: 23.316 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.110 ms
    first calculated eigval = -0.872403981358708
    last  calculated eigval = 0.031532903428761
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.87240398135871
lambda[   2] =  -0.68690406065159
lambda[   3] =  -0.45590507697190
lambda[   4] =  -0.44138065149113
lambda[   5] =  -0.40783742100330
lambda[   6] =  -0.21852673212762
lambda[   7] =  -0.21468891718294
lambda[   8] =  -0.04024919088439
lambda[   9] =  -0.00655780075729
lambda[  10] =   0.00869556282789
lambda[  11] =   0.01644865221288
lambda[  12] =   0.02071066386615
lambda[  13] =   0.03153290342876
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.126 ms
rank =  0, subspace rotation using ScaLAPACK took 3.037 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.042 ms

Total time for subspace rotation: 3.042 ms
rank = 0, Efermi =  -0.069391974682 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.502 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1113.273 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
rank = 0, D2D took 0.435 ms
rank = 0, Transfering density took 0.442 ms
Etot    =   -23.097702037856
Eband   =    -6.595293682401
E1      =    15.265358136326
E2      =    -6.117542784456
E3      =    -8.614457621418
Exc     =    -7.544664743214
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 4.136e-05, dEband = 1.094e-02
rank = 0, Calculating/Estimating energy took 1.344 ms, Etot = -23.097702038, dEtot = 4.136e-05, dEband = 1.094e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3740774882486, which took 0.119 ms

iter_count = 108, r_2norm = 1.230e-05, tol*||rhs|| = 1.496e-05

Anderson update took 57.851 ms, out of which F'*F took 27.079 ms; b-Ax took 183.806 ms, out of which Lap took 164.385 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.781 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053093, int_b + int_rho = -8.367e-14, checking this took 0.152 ms
2-norm of RHS = 593.7405818111821, which took 0.133 ms

iter_count = 246, r_2norm = 5.082e-04, tol*||rhs|| = 5.937e-04

Anderson update took 130.678 ms, out of which F'*F took 61.668 ms; b-Ax took 418.703 ms, out of which Lap took 375.333 ms
Solving Poisson took 879.534 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Total time for convolution: 	 convolve: 5.167990 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 85.490 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.187203 
Total time for convolution: 	 convolve: 5.225897 
Total time for convolution: 	 convolve: 5.174813 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.099 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.337 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.355 ms

This SCF took 27216.733 ms, scf error = 3.053e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.131533, lowerbound = -0.872404, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1084.163 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.723 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 2.754 ms
rank =  0, finding HY took 18.115 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.312 ms
Rank 0, Project_Hamiltonian used 23.201 ms
Total time for projection: 23.215 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.025 ms
rank = 0, Solve_Generalized_EigenProblem used 0.113 ms
    first calculated eigval = -0.869931876323632
    last  calculated eigval = 0.029344395484954
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86993187632363
lambda[   2] =  -0.68401267260210
lambda[   3] =  -0.45333092711570
lambda[   4] =  -0.43871742647210
lambda[   5] =  -0.40514476973087
lambda[   6] =  -0.21553089217280
lambda[   7] =  -0.21165279555027
lambda[   8] =  -0.03959212918138
lambda[   9] =  -0.00526424528135
lambda[  10] =   0.00757845130648
lambda[  11] =   0.01748225695422
lambda[  12] =   0.01928059481616
lambda[  13] =   0.02934439548495
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.128 ms
rank =  0, subspace rotation using ScaLAPACK took 3.026 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.032 ms

Total time for subspace rotation: 3.033 ms
rank = 0, Efermi =  -0.068734912980 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.502 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1112.179 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.288 ms
rank = 0, D2D took 1.390 ms
rank = 0, Transfering density took 1.398 ms
Etot    =   -23.097738462577
Eband   =    -6.556642720748
E1      =    15.246567252082
E2      =    -6.095987886425
E3      =    -8.620189558792
Exc     =    -7.548738284685
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 6.071e-06, dEband = 6.442e-03
rank = 0, Calculating/Estimating energy took 0.901 ms, Etot = -23.097738463, dEtot = 6.071e-06, dEband = 6.442e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1995404280621, which took 0.057 ms

iter_count = 114, r_2norm = 5.642e-06, tol*||rhs|| = 7.982e-06

Anderson update took 61.051 ms, out of which F'*F took 28.440 ms; b-Ax took 193.515 ms, out of which Lap took 172.800 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.897 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053096, int_b + int_rho = -4.911e-14, checking this took 0.119 ms
2-norm of RHS = 593.7658861781216, which took 0.146 ms

iter_count = 216, r_2norm = 4.749e-04, tol*||rhs|| = 5.938e-04

Anderson update took 114.898 ms, out of which F'*F took 54.146 ms; b-Ax took 367.916 ms, out of which Lap took 329.694 ms
Solving Poisson took 773.239 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.164500 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.735 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.173485 
Total time for convolution: 	 convolve: 5.210999 
Total time for convolution: 	 convolve: 5.240367 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.310 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.328 ms

This SCF took 27210.526 ms, scf error = 1.628e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.129344, lowerbound = -0.869932, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1084.939 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.726 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 2.752 ms
rank =  0, finding HY took 18.090 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.310 ms
Rank 0, Project_Hamiltonian used 23.173 ms
Total time for projection: 23.184 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.111 ms
    first calculated eigval = -0.869355868140448
    last  calculated eigval = 0.028288425395025
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86935586814045
lambda[   2] =  -0.68357605573561
lambda[   3] =  -0.45282947508101
lambda[   4] =  -0.43822616451512
lambda[   5] =  -0.40462252004755
lambda[   6] =  -0.21503154869935
lambda[   7] =  -0.21114902550375
lambda[   8] =  -0.03891712334566
lambda[   9] =  -0.00432598584008
lambda[  10] =   0.00745633679244
lambda[  11] =   0.01801960022277
lambda[  12] =   0.01880008248364
lambda[  13] =   0.02828842539503
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.127 ms
rank =  0, subspace rotation using ScaLAPACK took 3.049 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.055 ms

Total time for subspace rotation: 3.055 ms
rank = 0, Efermi =  -0.068059907139 calculate fermi energy took 0.083 ms
rank = 0, --- Calculate rho: sum over local bands took 1.491 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1113.380 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.826 ms
rank = 0, D2D took 0.936 ms
rank = 0, Transfering density took 0.939 ms
Etot    =   -23.097823091398
Eband   =    -6.549581316245
E1      =    15.244566592735
E2      =    -6.090949547143
E3      =    -8.619490873450
Exc     =    -7.548146634040
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 1.410e-05, dEband = 1.177e-03
rank = 0, Calculating/Estimating energy took 0.873 ms, Etot = -23.097823091, dEtot = 1.410e-05, dEband = 1.177e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1254795852209, which took 0.055 ms

iter_count = 108, r_2norm = 4.553e-06, tol*||rhs|| = 5.019e-06

Anderson update took 57.909 ms, out of which F'*F took 26.855 ms; b-Ax took 183.512 ms, out of which Lap took 164.045 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.125 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053088, int_b + int_rho = -1.273e-13, checking this took 0.097 ms
2-norm of RHS = 593.7535702628123, which took 0.106 ms

iter_count = 228, r_2norm = 4.970e-04, tol*||rhs|| = 5.938e-04

Anderson update took 121.268 ms, out of which F'*F took 57.084 ms; b-Ax took 388.625 ms, out of which Lap took 347.912 ms
Solving Poisson took 815.847 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Total time for convolution: 	 convolve: 5.244025 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.600 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.191554 
Total time for convolution: 	 convolve: 5.195168 
Total time for convolution: 	 convolve: 5.175098 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.407 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.350 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.372 ms

This SCF took 27127.485 ms, scf error = 1.201e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.128288, lowerbound = -0.869356, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1084.678 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.723 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 2.757 ms
rank =  0, finding HY took 18.180 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.337 ms
Rank 0, Project_Hamiltonian used 23.292 ms
Total time for projection: 23.302 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.063 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.017 ms
rank = 0, Solve_Generalized_EigenProblem used 0.084 ms
    first calculated eigval = -0.867595082734766
    last  calculated eigval = 0.030244422525741
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86759508273477
lambda[   2] =  -0.68187234805437
lambda[   3] =  -0.45112085476970
lambda[   4] =  -0.43647763434655
lambda[   5] =  -0.40288701236396
lambda[   6] =  -0.21333832937129
lambda[   7] =  -0.20946144683939
lambda[   8] =  -0.03470973397961
lambda[   9] =   0.00105373194231
lambda[  10] =   0.00979001486971
lambda[  11] =   0.02072295282218
lambda[  12] =   0.02261600994858
lambda[  13] =   0.03024442252574
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 3.040 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.047 ms

Total time for subspace rotation: 3.776 ms
rank = 0, Efermi =  -0.063852517766 calculate fermi energy took 0.588 ms
rank = 0, --- Calculate rho: sum over local bands took 1.390 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1113.976 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
rank = 0, D2D took 0.370 ms
rank = 0, Transfering density took 0.375 ms
Etot    =   -23.097909105722
Eband   =    -6.525505417673
E1      =    15.232701013533
E2      =    -6.078337180191
E3      =    -8.621357767760
Exc     =    -7.549697495091
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 1.434e-05, dEband = 4.013e-03
rank = 0, Calculating/Estimating energy took 1.260 ms, Etot = -23.097909106, dEtot = 1.434e-05, dEband = 4.013e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0931032637887, which took 0.070 ms

iter_count = 108, r_2norm = 3.609e-06, tol*||rhs|| = 3.724e-06

Anderson update took 58.112 ms, out of which F'*F took 27.001 ms; b-Ax took 183.190 ms, out of which Lap took 163.661 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.919 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053098, int_b + int_rho = -3.274e-14, checking this took 0.115 ms
2-norm of RHS = 593.7461392725093, which took 0.120 ms

iter_count = 186, r_2norm = 5.321e-04, tol*||rhs|| = 5.937e-04

Anderson update took 99.425 ms, out of which F'*F took 46.932 ms; b-Ax took 316.552 ms, out of which Lap took 284.237 ms
Solving Poisson took 667.006 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.174843 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 83.901 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.232625 
Total time for convolution: 	 convolve: 5.183064 
Total time for convolution: 	 convolve: 5.172400 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.358 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.677 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.329 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.348 ms

This SCF took 27000.125 ms, scf error = 6.610e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.130244, lowerbound = -0.867595, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1085.666 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.712 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 2.739 ms
rank =  0, finding HY took 18.140 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.353 ms
Rank 0, Project_Hamiltonian used 23.255 ms
Total time for projection: 23.271 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.106 ms
    first calculated eigval = -0.866998982677188
    last  calculated eigval = 0.030300519391678
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86699898267719
lambda[   2] =  -0.68134151010111
lambda[   3] =  -0.45059024562730
lambda[   4] =  -0.43595950146599
lambda[   5] =  -0.40233647902683
lambda[   6] =  -0.21280170275339
lambda[   7] =  -0.20892362853678
lambda[   8] =  -0.03355927292933
lambda[   9] =   0.00220421353125
lambda[  10] =   0.01043801947403
lambda[  11] =   0.02122050423322
lambda[  12] =   0.02349428488741
lambda[  13] =   0.03030051939168
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.122 ms
rank =  0, subspace rotation using ScaLAPACK took 3.070 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.077 ms

Total time for subspace rotation: 3.078 ms
rank = 0, Efermi =  -0.062702056714 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.472 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1114.259 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.016 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
rank = 0, D2D took 0.419 ms
rank = 0, Transfering density took 0.425 ms
Etot    =   -23.097978154274
Eband   =    -6.517904101066
E1      =    15.228352067786
E2      =    -6.074880928126
E3      =    -8.622140692644
Exc     =    -7.550345587322
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 1.151e-05, dEband = 1.267e-03
rank = 0, Calculating/Estimating energy took 1.067 ms, Etot = -23.097978154, dEtot = 1.151e-05, dEband = 1.267e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0927313681011, which took 0.138 ms

iter_count = 108, r_2norm = 2.468e-06, tol*||rhs|| = 3.709e-06

Anderson update took 58.084 ms, out of which F'*F took 27.221 ms; b-Ax took 183.255 ms, out of which Lap took 163.936 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.301 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053097, int_b + int_rho = -4.184e-14, checking this took 0.103 ms
2-norm of RHS = 593.7677641184205, which took 0.095 ms

iter_count = 192, r_2norm = 5.542e-04, tol*||rhs|| = 5.938e-04

Anderson update took 101.971 ms, out of which F'*F took 48.134 ms; b-Ax took 326.371 ms, out of which Lap took 292.586 ms
Solving Poisson took 687.197 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Total time for convolution: 	 convolve: 5.178054 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 64.265 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.162863 
Total time for convolution: 	 convolve: 5.201190 
Total time for convolution: 	 convolve: 5.191220 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.517 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.334 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.353 ms

This SCF took 26977.400 ms, scf error = 5.007e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.130301, lowerbound = -0.866999, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1084.949 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.703 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 2.730 ms
rank =  0, finding HY took 18.140 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.332 ms
Rank 0, Project_Hamiltonian used 23.222 ms
Total time for projection: 23.236 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.108 ms
    first calculated eigval = -0.866488249621131
    last  calculated eigval = 0.032326173890171
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86648824962113
lambda[   2] =  -0.68079873713444
lambda[   3] =  -0.45006933685666
lambda[   4] =  -0.43541976982983
lambda[   5] =  -0.40180576150049
lambda[   6] =  -0.21229966806131
lambda[   7] =  -0.20842443976464
lambda[   8] =  -0.03089988021949
lambda[   9] =   0.00428357113012
lambda[  10] =   0.01173948573211
lambda[  11] =   0.02368992700014
lambda[  12] =   0.02572764781417
lambda[  13] =   0.03232617389017
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.124 ms
rank =  0, subspace rotation using ScaLAPACK took 3.009 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.016 ms

Total time for subspace rotation: 3.016 ms
rank = 0, Efermi =  -0.060042664004 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 1.456 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1113.493 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
rank = 0, D2D took 0.462 ms
rank = 0, Transfering density took 0.470 ms
Etot    =   -23.098055424501
Eband   =    -6.510611926171
E1      =    15.225242725851
E2      =    -6.070531863156
E3      =    -8.622649747465
Exc     =    -7.550765680360
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 1.288e-05, dEband = 1.215e-03
rank = 0, Calculating/Estimating energy took 1.002 ms, Etot = -23.098055425, dEtot = 1.288e-05, dEband = 1.215e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0680812538387, which took 0.088 ms

iter_count = 108, r_2norm = 1.930e-06, tol*||rhs|| = 2.723e-06

Anderson update took 57.897 ms, out of which F'*F took 27.051 ms; b-Ax took 183.096 ms, out of which Lap took 163.604 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.686 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053096, int_b + int_rho = -5.275e-14, checking this took 0.134 ms
2-norm of RHS = 593.7756361994284, which took 0.131 ms

iter_count = 162, r_2norm = 5.337e-04, tol*||rhs|| = 5.938e-04

Anderson update took 86.355 ms, out of which F'*F took 48.533 ms; b-Ax took 283.078 ms, out of which Lap took 255.038 ms
Solving Poisson took 587.680 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Total time for convolution: 	 convolve: 5.166722 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 28.521 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.201714 
Total time for convolution: 	 convolve: 5.213566 
Total time for convolution: 	 convolve: 5.174551 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.667 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.581 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.329 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.349 ms

This SCF took 26881.756 ms, scf error = 3.492e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132326, lowerbound = -0.866488, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1088.105 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.731 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.109 ms
rank =  0, Distribute data + matrix mult took 2.845 ms
rank =  0, finding HY took 18.155 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.325 ms
Rank 0, Project_Hamiltonian used 23.345 ms
Total time for projection: 23.359 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.108 ms
    first calculated eigval = -0.866290960455743
    last  calculated eigval = 0.033747226255127
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86629096045574
lambda[   2] =  -0.68058680968396
lambda[   3] =  -0.44986592059811
lambda[   4] =  -0.43520996019810
lambda[   5] =  -0.40159935901409
lambda[   6] =  -0.21209522773365
lambda[   7] =  -0.20822202818268
lambda[   8] =  -0.02944659136026
lambda[   9] =   0.00534293859615
lambda[  10] =   0.01210148775934
lambda[  11] =   0.02562408416200
lambda[  12] =   0.02660709854423
lambda[  13] =   0.03374722625513
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.511 ms
rank =  0, subspace rotation using ScaLAPACK took 3.312 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.319 ms

Total time for subspace rotation: 3.319 ms
rank = 0, Efermi =  -0.058589375178 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.502 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1116.936 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
rank = 0, D2D took 0.421 ms
rank = 0, Transfering density took 0.427 ms
Etot    =   -23.098085485582
Eband   =    -6.507740532337
E1      =    15.224069223976
E2      =    -6.068790853002
E3      =    -8.622752122731
Exc     =    -7.550854998511
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 5.010e-06, dEband = 4.786e-04
rank = 0, Calculating/Estimating energy took 1.028 ms, Etot = -23.098085486, dEtot = 5.010e-06, dEband = 4.786e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0530107704717, which took 0.051 ms

iter_count = 108, r_2norm = 1.574e-06, tol*||rhs|| = 2.120e-06

Anderson update took 57.889 ms, out of which F'*F took 26.950 ms; b-Ax took 183.108 ms, out of which Lap took 163.552 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.730 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053098, int_b + int_rho = -3.274e-14, checking this took 0.141 ms
2-norm of RHS = 593.7735907172720, which took 0.140 ms

iter_count = 150, r_2norm = 5.814e-04, tol*||rhs|| = 5.938e-04

Anderson update took 79.990 ms, out of which F'*F took 37.570 ms; b-Ax took 255.238 ms, out of which Lap took 228.784 ms
Solving Poisson took 537.851 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Total time for convolution: 	 convolve: 5.230443 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.154289 
Total time for convolution: 	 convolve: 5.281970 
Total time for convolution: 	 convolve: 5.234111 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.316 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.344 ms

This SCF took 26936.691 ms, scf error = 3.508e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.133747, lowerbound = -0.866291, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1105.557 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.701 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 2.728 ms
rank =  0, finding HY took 18.194 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.308 ms
Rank 0, Project_Hamiltonian used 23.253 ms
Total time for projection: 23.266 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.700 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.019 ms
rank = 0, Solve_Generalized_EigenProblem used 0.723 ms
    first calculated eigval = -0.866117503694865
    last  calculated eigval = 0.034845420497590
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86611750369486
lambda[   2] =  -0.68040885084212
lambda[   3] =  -0.44969667272663
lambda[   4] =  -0.43504012118913
lambda[   5] =  -0.40142727057474
lambda[   6] =  -0.21191452017874
lambda[   7] =  -0.20804216645537
lambda[   8] =  -0.02878572213569
lambda[   9] =   0.00572863896169
lambda[  10] =   0.01225204832762
lambda[  11] =   0.02655305271737
lambda[  12] =   0.02716455584816
lambda[  13] =   0.03484542049759
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.739 ms
rank =  0, subspace rotation using ScaLAPACK took 3.043 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.047 ms

Total time for subspace rotation: 3.048 ms
rank = 0, Efermi =  -0.057928505918 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.467 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1134.607 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
rank = 0, D2D took 0.440 ms
rank = 0, Transfering density took 0.448 ms
Etot    =   -23.098110125790
Eband   =    -6.505294211914
E1      =    15.222724904750
E2      =    -6.067621022242
E3      =    -8.622991399770
Exc     =    -7.551051086197
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 4.107e-06, dEband = 4.077e-04
rank = 0, Calculating/Estimating energy took 1.019 ms, Etot = -23.098110126, dEtot = 4.107e-06, dEband = 4.077e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0488211764982, which took 0.067 ms

iter_count = 108, r_2norm = 1.557e-06, tol*||rhs|| = 1.953e-06

Anderson update took 58.003 ms, out of which F'*F took 26.942 ms; b-Ax took 183.048 ms, out of which Lap took 163.533 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.930 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053093, int_b + int_rho = -7.822e-14, checking this took 0.099 ms
2-norm of RHS = 593.7706283652475, which took 0.143 ms

iter_count = 114, r_2norm = 5.521e-04, tol*||rhs|| = 5.938e-04

Anderson update took 60.793 ms, out of which F'*F took 28.712 ms; b-Ax took 194.194 ms, out of which Lap took 174.118 ms
Solving Poisson took 409.581 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.204874 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.740 ms
Total time for convolution: 	 convolve: 5.175683 
Total time for convolution: 	 convolve: 5.212146 
Total time for convolution: 	 convolve: 5.168739 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.338 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.358 ms

This SCF took 26791.818 ms, scf error = 2.698e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.134845, lowerbound = -0.866118, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1084.475 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.719 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 2.754 ms
rank =  0, finding HY took 18.212 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.331 ms
Rank 0, Project_Hamiltonian used 23.333 ms
Total time for projection: 23.345 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.113 ms
    first calculated eigval = -0.866029152371112
    last  calculated eigval = 0.035496464273791
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86602915237111
lambda[   2] =  -0.68032479288583
lambda[   3] =  -0.44961403547888
lambda[   4] =  -0.43495932846935
lambda[   5] =  -0.40134360864062
lambda[   6] =  -0.21183191689268
lambda[   7] =  -0.20795945171865
lambda[   8] =  -0.02846766640741
lambda[   9] =   0.00584571284878
lambda[  10] =   0.01242774869393
lambda[  11] =   0.02678846529524
lambda[  12] =   0.02771200568691
lambda[  13] =   0.03549646427379
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.132 ms
rank =  0, subspace rotation using ScaLAPACK took 3.030 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.036 ms

Total time for subspace rotation: 3.036 ms
rank = 0, Efermi =  -0.057610450227 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 1.487 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1112.638 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
rank = 0, D2D took 0.421 ms
rank = 0, Transfering density took 0.425 ms
Etot    =   -23.098120683749
Eband   =    -6.504124573499
E1      =    15.222015125646
E2      =    -6.067125572929
E3      =    -8.623120280375
Exc     =    -7.551154934760
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 1.760e-06, dEband = 1.949e-04
rank = 0, Calculating/Estimating energy took 1.014 ms, Etot = -23.098120684, dEtot = 1.760e-06, dEband = 1.949e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0369421830989, which took 0.052 ms

iter_count = 108, r_2norm = 1.100e-06, tol*||rhs|| = 1.478e-06

Anderson update took 57.983 ms, out of which F'*F took 26.948 ms; b-Ax took 182.997 ms, out of which Lap took 163.344 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.865 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053098, int_b + int_rho = -3.092e-14, checking this took 0.145 ms
2-norm of RHS = 593.7750824319999, which took 0.144 ms

iter_count = 162, r_2norm = 5.375e-04, tol*||rhs|| = 5.938e-04

Anderson update took 86.009 ms, out of which F'*F took 40.581 ms; b-Ax took 275.718 ms, out of which Lap took 247.160 ms
Solving Poisson took 580.366 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.152554 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 63.821 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.238069 
Total time for convolution: 	 convolve: 5.179166 
Total time for convolution: 	 convolve: 5.212124 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.338 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.355 ms

This SCF took 26917.506 ms, scf error = 2.261e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.135496, lowerbound = -0.866029, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1083.712 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.217 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 3.248 ms
rank =  0, finding HY took 18.106 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.326 ms
Rank 0, Project_Hamiltonian used 23.699 ms
Total time for projection: 23.722 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.108 ms
    first calculated eigval = -0.866101794668433
    last  calculated eigval = 0.037100579901190
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86610179466843
lambda[   2] =  -0.68036199071008
lambda[   3] =  -0.44965024423893
lambda[   4] =  -0.43498456179304
lambda[   5] =  -0.40138463448976
lambda[   6] =  -0.21188634402076
lambda[   7] =  -0.20801689730615
lambda[   8] =  -0.02900379500500
lambda[   9] =   0.00471906797659
lambda[  10] =   0.01365597432966
lambda[  11] =   0.02609681911003
lambda[  12] =   0.02850892760047
lambda[  13] =   0.03710057990119
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.127 ms
rank =  0, subspace rotation using ScaLAPACK took 3.031 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.037 ms

Total time for subspace rotation: 3.038 ms
rank = 0, Efermi =  -0.058146578798 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 1.476 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1112.623 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
rank = 0, D2D took 0.410 ms
rank = 0, Transfering density took 0.412 ms
Etot    =   -23.098153388146
Eband   =    -6.504772935050
E1      =    15.222859897782
E2      =    -6.067022730076
E3      =    -8.622544782318
Exc     =    -7.550705708831
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 5.451e-06, dEband = 1.081e-04
rank = 0, Calculating/Estimating energy took 1.085 ms, Etot = -23.098153388, dEtot = 5.451e-06, dEband = 1.081e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0427818880727, which took 0.050 ms

iter_count = 108, r_2norm = 1.072e-06, tol*||rhs|| = 1.711e-06

Anderson update took 58.192 ms, out of which F'*F took 27.103 ms; b-Ax took 183.140 ms, out of which Lap took 163.499 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.120 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053098, int_b + int_rho = -2.547e-14, checking this took 0.127 ms
2-norm of RHS = 593.7753660710473, which took 0.154 ms

iter_count = 120, r_2norm = 5.256e-04, tol*||rhs|| = 5.938e-04

Anderson update took 63.839 ms, out of which F'*F took 30.067 ms; b-Ax took 204.078 ms, out of which Lap took 182.865 ms
Solving Poisson took 430.947 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.066 ms
Total time for convolution: 	 convolve: 5.202034 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.254767 
Total time for convolution: 	 convolve: 5.167928 
Total time for convolution: 	 convolve: 5.154799 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.325 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.346 ms

This SCF took 26739.792 ms, scf error = 3.724e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.137101, lowerbound = -0.866102, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1086.235 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.710 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 2.738 ms
rank =  0, finding HY took 18.149 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.320 ms
Rank 0, Project_Hamiltonian used 23.228 ms
Total time for projection: 23.234 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.118 ms
    first calculated eigval = -0.866078826275018
    last  calculated eigval = 0.035867038882527
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86607882627502
lambda[   2] =  -0.68034390855669
lambda[   3] =  -0.44963326588343
lambda[   4] =  -0.43496913340429
lambda[   5] =  -0.40136704520350
lambda[   6] =  -0.21187487581229
lambda[   7] =  -0.20800550307851
lambda[   8] =  -0.02938248462206
lambda[   9] =   0.00458462907688
lambda[  10] =   0.01274299949580
lambda[  11] =   0.02560490270338
lambda[  12] =   0.02737925171236
lambda[  13] =   0.03586703888253
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.131 ms
rank =  0, subspace rotation using ScaLAPACK took 3.036 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.045 ms

Total time for subspace rotation: 3.045 ms
rank = 0, Efermi =  -0.058525268405 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 1.499 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1114.291 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
rank = 0, D2D took 0.404 ms
rank = 0, Transfering density took 0.411 ms
Etot    =   -23.098151143148
Eband   =    -6.504545117031
E1      =    15.222657267445
E2      =    -6.066969191633
E3      =    -8.622667878383
Exc     =    -7.550798209137
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 3.742e-07, dEband = 3.797e-05
rank = 0, Calculating/Estimating energy took 1.064 ms, Etot = -23.098151143, dEtot = 3.742e-07, dEband = 3.797e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0428553600287, which took 0.052 ms

iter_count = 108, r_2norm = 1.089e-06, tol*||rhs|| = 1.714e-06

Anderson update took 57.740 ms, out of which F'*F took 27.270 ms; b-Ax took 183.620 ms, out of which Lap took 164.142 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.515 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053093, int_b + int_rho = -8.185e-14, checking this took 0.111 ms
2-norm of RHS = 593.7746367552725, which took 0.145 ms

iter_count = 78, r_2norm = 5.763e-04, tol*||rhs|| = 5.938e-04

Anderson update took 42.042 ms, out of which F'*F took 20.176 ms; b-Ax took 132.850 ms, out of which Lap took 119.099 ms
Solving Poisson took 282.688 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Total time for convolution: 	 convolve: 5.189598 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 37.136 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.194367 
Total time for convolution: 	 convolve: 5.182195 
Total time for convolution: 	 convolve: 5.193666 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.334 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.986 ms

This SCF took 26574.546 ms, scf error = 3.373e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.135867, lowerbound = -0.866079, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1084.291 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.727 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 2.764 ms
rank =  0, finding HY took 18.127 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.331 ms
Rank 0, Project_Hamiltonian used 23.242 ms
Total time for projection: 23.255 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.108 ms
    first calculated eigval = -0.866070648157501
    last  calculated eigval = 0.036005100915660
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86607064815750
lambda[   2] =  -0.68033784541955
lambda[   3] =  -0.44962755238751
lambda[   4] =  -0.43496459355589
lambda[   5] =  -0.40136149834156
lambda[   6] =  -0.21187249055611
lambda[   7] =  -0.20800315719998
lambda[   8] =  -0.02929282927503
lambda[   9] =   0.00463981409044
lambda[  10] =   0.01271118558135
lambda[  11] =   0.02569162058426
lambda[  12] =   0.02739642046357
lambda[  13] =   0.03600510091566
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.127 ms
rank =  0, subspace rotation using ScaLAPACK took 3.091 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.096 ms

Total time for subspace rotation: 3.097 ms
rank = 0, Efermi =  -0.058435613090 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.473 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.036 ms
rank = 0, Calculating density took 1112.378 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
rank = 0, D2D took 0.398 ms
rank = 0, Transfering density took 0.401 ms
Etot    =   -23.098149702930
Eband   =    -6.504475571838
E1      =    15.222568054128
E2      =    -6.066985913381
E3      =    -8.622694979854
Exc     =    -7.550820924015
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 2.400e-07, dEband = 1.159e-05
rank = 0, Calculating/Estimating energy took 1.106 ms, Etot = -23.098149703, dEtot = 2.400e-07, dEband = 1.159e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0441041751797, which took 0.157 ms

iter_count = 108, r_2norm = 1.109e-06, tol*||rhs|| = 1.764e-06

Anderson update took 57.934 ms, out of which F'*F took 27.048 ms; b-Ax took 183.134 ms, out of which Lap took 163.720 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.765 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053096, int_b + int_rho = -5.093e-14, checking this took 0.112 ms
2-norm of RHS = 593.7746338029706, which took 0.073 ms

iter_count = 36, r_2norm = 5.426e-04, tol*||rhs|| = 5.938e-04

Anderson update took 19.125 ms, out of which F'*F took 9.039 ms; b-Ax took 61.211 ms, out of which Lap took 54.887 ms
Solving Poisson took 131.963 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Total time for convolution: 	 convolve: 5.222903 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.177216 
Total time for convolution: 	 convolve: 5.169294 
Total time for convolution: 	 convolve: 5.291899 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.328 ms
---Transfer Veff_loc: D2D took 1.425 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.441 ms

This SCF took 26576.310 ms, scf error = 3.196e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.136005, lowerbound = -0.866071, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1084.946 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.709 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 2.737 ms
rank =  0, finding HY took 18.179 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.331 ms
Rank 0, Project_Hamiltonian used 23.268 ms
Total time for projection: 23.275 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.105 ms
    first calculated eigval = -0.866078399874348
    last  calculated eigval = 0.036101264721489
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86607839987435
lambda[   2] =  -0.68034452073414
lambda[   3] =  -0.44963388402131
lambda[   4] =  -0.43497049561609
lambda[   5] =  -0.40136850540440
lambda[   6] =  -0.21187944013132
lambda[   7] =  -0.20801025722469
lambda[   8] =  -0.02916171864939
lambda[   9] =   0.00476307032416
lambda[  10] =   0.01271894402766
lambda[  11] =   0.02580770255673
lambda[  12] =   0.02742367903186
lambda[  13] =   0.03610126472149
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.119 ms
rank =  0, subspace rotation using ScaLAPACK took 3.031 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.036 ms

Total time for subspace rotation: 3.036 ms
rank = 0, Efermi =  -0.058304502461 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.474 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1112.993 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
rank = 0, D2D took 0.432 ms
rank = 0, Transfering density took 0.439 ms
Etot    =   -23.098147614288
Eband   =    -6.504571006611
E1      =    15.222635548525
E2      =    -6.067022956236
E3      =    -8.622672871706
Exc     =    -7.550805829703
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 3.481e-07, dEband = 1.591e-05
rank = 0, Calculating/Estimating energy took 1.124 ms, Etot = -23.098147614, dEtot = 3.481e-07, dEband = 1.591e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0424106773543, which took 0.058 ms

iter_count = 108, r_2norm = 1.034e-06, tol*||rhs|| = 1.696e-06

Anderson update took 57.828 ms, out of which F'*F took 27.016 ms; b-Ax took 183.213 ms, out of which Lap took 163.635 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.363 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053095, int_b + int_rho = -5.821e-14, checking this took 0.122 ms
2-norm of RHS = 593.7756136785684, which took 0.109 ms

iter_count = 102, r_2norm = 5.780e-04, tol*||rhs|| = 5.938e-04

Anderson update took 54.085 ms, out of which F'*F took 25.599 ms; b-Ax took 173.432 ms, out of which Lap took 155.336 ms
Solving Poisson took 366.283 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Total time for convolution: 	 convolve: 5.165368 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.657 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.205055 
Total time for convolution: 	 convolve: 5.197807 
Total time for convolution: 	 convolve: 5.205626 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.206 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.333 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.350 ms

This SCF took 26643.890 ms, scf error = 3.306e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.136101, lowerbound = -0.866078, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1116.001 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.716 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 2.744 ms
rank =  0, finding HY took 18.159 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.338 ms
Rank 0, Project_Hamiltonian used 23.263 ms
Total time for projection: 23.277 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.105 ms
    first calculated eigval = -0.866066299430415
    last  calculated eigval = 0.036012409308244
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86606629943041
lambda[   2] =  -0.68033688118502
lambda[   3] =  -0.44962627346729
lambda[   4] =  -0.43496508197759
lambda[   5] =  -0.40136105947374
lambda[   6] =  -0.21187706126148
lambda[   7] =  -0.20800764338931
lambda[   8] =  -0.02953196945772
lambda[   9] =   0.00431192883248
lambda[  10] =   0.01269236471556
lambda[  11] =   0.02540979172793
lambda[  12] =   0.02711200289039
lambda[  13] =   0.03601240930824
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.120 ms
rank =  0, subspace rotation using ScaLAPACK took 3.026 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.031 ms

Total time for subspace rotation: 3.032 ms
rank = 0, Efermi =  -0.058674753265 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.489 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1144.058 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
rank = 0, D2D took 0.448 ms
rank = 0, Transfering density took 0.456 ms
Etot    =   -23.098149674495
Eband   =    -6.504480600976
E1      =    15.222537684835
E2      =    -6.067005262413
E3      =    -8.622740910595
Exc     =    -7.550850776920
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 3.434e-07, dEband = 1.507e-05
rank = 0, Calculating/Estimating energy took 1.019 ms, Etot = -23.098149674, dEtot = 3.434e-07, dEband = 1.507e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0372948051240, which took 0.077 ms

iter_count = 108, r_2norm = 1.021e-06, tol*||rhs|| = 1.492e-06

Anderson update took 57.862 ms, out of which F'*F took 26.943 ms; b-Ax took 183.236 ms, out of which Lap took 163.604 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.562 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053093, int_b + int_rho = -7.822e-14, checking this took 0.125 ms
2-norm of RHS = 593.7746250153787, which took 0.148 ms

iter_count = 96, r_2norm = 5.800e-04, tol*||rhs|| = 5.938e-04

Anderson update took 50.976 ms, out of which F'*F took 24.095 ms; b-Ax took 163.568 ms, out of which Lap took 146.494 ms
Solving Poisson took 345.520 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Total time for convolution: 	 convolve: 5.197614 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.176880 
Total time for convolution: 	 convolve: 5.220844 
Total time for convolution: 	 convolve: 5.186872 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.499 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.307 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.326 ms

This SCF took 26637.707 ms, scf error = 3.009e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.136012, lowerbound = -0.866066, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1084.715 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.704 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 2.744 ms
rank =  0, finding HY took 18.139 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.324 ms
Rank 0, Project_Hamiltonian used 23.240 ms
Total time for projection: 23.252 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.104 ms
    first calculated eigval = -0.865990979515445
    last  calculated eigval = 0.036066403970716
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86599097951544
lambda[   2] =  -0.68027110263173
lambda[   3] =  -0.44956010416867
lambda[   4] =  -0.43490166426528
lambda[   5] =  -0.40129491281738
lambda[   6] =  -0.21181678085579
lambda[   7] =  -0.20794651858396
lambda[   8] =  -0.02966888306786
lambda[   9] =   0.00409407659665
lambda[  10] =   0.01278312832896
lambda[  11] =   0.02532469587173
lambda[  12] =   0.02696925152974
lambda[  13] =   0.03606640397072
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.131 ms
rank =  0, subspace rotation using ScaLAPACK took 3.026 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.033 ms

Total time for subspace rotation: 3.034 ms
rank = 0, Efermi =  -0.058811666864 calculate fermi energy took 0.078 ms
rank = 0, --- Calculate rho: sum over local bands took 1.479 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.033 ms
rank = 0, Calculating density took 1112.790 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
rank = 0, D2D took 0.431 ms
rank = 0, Transfering density took 0.438 ms
Etot    =   -23.098155646709
Eband   =    -6.503564126286
E1      =    15.221963822379
E2      =    -6.066624444550
E3      =    -8.622887344238
Exc     =    -7.550964977149
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 9.954e-07, dEband = 1.527e-04
rank = 0, Calculating/Estimating energy took 1.374 ms, Etot = -23.098155647, dEtot = 9.954e-07, dEband = 1.527e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0525054225540, which took 0.072 ms

iter_count = 102, r_2norm = 1.433e-06, tol*||rhs|| = 2.100e-06

Anderson update took 55.918 ms, out of which F'*F took 32.507 ms; b-Ax took 179.558 ms, out of which Lap took 161.325 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 382.310 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053091, int_b + int_rho = -9.641e-14, checking this took 0.107 ms
2-norm of RHS = 593.7733803946785, which took 0.141 ms

iter_count = 144, r_2norm = 5.153e-04, tol*||rhs|| = 5.938e-04

Anderson update took 76.252 ms, out of which F'*F took 36.008 ms; b-Ax took 245.059 ms, out of which Lap took 219.619 ms
Solving Poisson took 515.594 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.179400 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.849 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.170188 
Total time for convolution: 	 convolve: 5.231238 
Total time for convolution: 	 convolve: 5.180470 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.714 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.072 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.316 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.334 ms

This SCF took 26872.325 ms, scf error = 2.456e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.136066, lowerbound = -0.865991, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1083.824 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.698 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 2.726 ms
rank =  0, finding HY took 18.171 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.323 ms
Rank 0, Project_Hamiltonian used 23.238 ms
Total time for projection: 23.249 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.017 ms
rank = 0, Solve_Generalized_EigenProblem used 0.085 ms
    first calculated eigval = -0.865744700861582
    last  calculated eigval = 0.037285653650070
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86574470086158
lambda[   2] =  -0.68004261605177
lambda[   3] =  -0.44933059246210
lambda[   4] =  -0.43467543416029
lambda[   5] =  -0.40106537849434
lambda[   6] =  -0.21160788485471
lambda[   7] =  -0.20773620793540
lambda[   8] =  -0.02951337540924
lambda[   9] =   0.00391271190326
lambda[  10] =   0.01400456329881
lambda[  11] =   0.02562732569368
lambda[  12] =   0.02814691983433
lambda[  13] =   0.03728565365007
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.181 ms
rank =  0, subspace rotation using ScaLAPACK took 3.034 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.039 ms

Total time for subspace rotation: 3.040 ms
rank = 0, Efermi =  -0.058656159202 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.491 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1111.912 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.052 ms
rank = 0, D2D took 1.150 ms
rank = 0, Transfering density took 1.154 ms
Etot    =   -23.098165193388
Eband   =    -6.500405630246
E1      =    15.220211104468
E2      =    -6.065132214904
E3      =    -8.623240537028
Exc     =    -7.551241265100
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 1.591e-06, dEband = 5.264e-04
rank = 0, Calculating/Estimating energy took 0.927 ms, Etot = -23.098165193, dEtot = 1.591e-06, dEband = 5.264e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0416257770443, which took 0.086 ms

iter_count = 102, r_2norm = 1.263e-06, tol*||rhs|| = 1.665e-06

Anderson update took 54.539 ms, out of which F'*F took 25.428 ms; b-Ax took 173.283 ms, out of which Lap took 154.728 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.119 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053091, int_b + int_rho = -1.019e-13, checking this took 0.111 ms
2-norm of RHS = 593.7713610547682, which took 0.120 ms

iter_count = 126, r_2norm = 5.756e-04, tol*||rhs|| = 5.938e-04

Anderson update took 67.051 ms, out of which F'*F took 31.666 ms; b-Ax took 214.589 ms, out of which Lap took 192.531 ms
Solving Poisson took 452.183 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.195337 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.448 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.203888 
Total time for convolution: 	 convolve: 5.236756 
Total time for convolution: 	 convolve: 5.183835 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.489 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.322 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.340 ms

This SCF took 26756.865 ms, scf error = 1.691e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.137286, lowerbound = -0.865745, upperbound = 267.570980

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1115.799 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.714 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 2.748 ms
rank =  0, finding HY took 18.191 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.324 ms
Rank 0, Project_Hamiltonian used 23.284 ms
Total time for projection: 23.297 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.063 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.018 ms
rank = 0, Solve_Generalized_EigenProblem used 0.084 ms
    first calculated eigval = -0.865563132282767
    last  calculated eigval = 0.036119088976959
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.86556313228277
lambda[   2] =  -0.67987769585664
lambda[   3] =  -0.44916729138210
lambda[   4] =  -0.43451760079776
lambda[   5] =  -0.40090175748566
lambda[   6] =  -0.21145415892996
lambda[   7] =  -0.20758120479438
lambda[   8] =  -0.03045713031502
lambda[   9] =   0.00319137582968
lambda[  10] =   0.01401928037020
lambda[  11] =   0.02481490495214
lambda[  12] =   0.02729244500776
lambda[  13] =   0.03611908897696
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.133 ms
rank =  0, subspace rotation using ScaLAPACK took 3.040 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.045 ms

Total time for subspace rotation: 3.046 ms
rank = 0, Efermi =  -0.059599914097 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.477 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 1145.253 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
rank = 0, D2D took 0.324 ms
rank = 0, Transfering density took 0.329 ms
Etot    =   -23.098169482953
Eband   =    -6.498125683684
E1      =    15.218813502313
E2      =    -6.064150799648
E3      =    -8.623645780418
Exc     =    -7.551551727207
Esc     =   -38.955102153825
Entropy =    -0.000000000616
dE = 7.149e-07, dEband = 3.800e-04
rank = 0, Calculating/Estimating energy took 0.860 ms, Etot = -23.098169483, dEtot = 7.149e-07, dEband = 3.800e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0274108465765, which took 0.064 ms

iter_count = 102, r_2norm = 7.206e-07, tol*||rhs|| = 1.096e-06

Anderson update took 54.658 ms, out of which F'*F took 25.443 ms; b-Ax took 172.885 ms, out of which Lap took 154.496 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.343 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000002053101, int_rho =  14.00000002053097, int_b + int_rho = -4.002e-14, checking this took 0.103 ms
2-norm of RHS = 593.7735603592187, which took 0.137 ms

iter_count = 138, r_2norm = 5.541e-04, tol*||rhs|| = 5.938e-04

Anderson update took 73.159 ms, out of which F'*F took 34.597 ms; b-Ax took 235.047 ms, out of which Lap took 210.246 ms
Solving Poisson took 494.671 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.210317 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.701 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.184343 
Total time for convolution: 	 convolve: 5.187538 
Total time for convolution: 	 convolve: 5.158002 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.406 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 0.344 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.362 ms

This SCF took 26780.336 ms, scf error = 9.107e-05
The last 13 occupations of kpoints #1 are (Nelectron = 14):
lambda[   1] =  -0.86556313228277, occ[   1] =   2.00000000000000
lambda[   2] =  -0.67987769585664, occ[   2] =   2.00000000000000
lambda[   3] =  -0.44916729138210, occ[   3] =   2.00000000000000
lambda[   4] =  -0.43451760079776, occ[   4] =   2.00000000000000
lambda[   5] =  -0.40090175748566, occ[   5] =   2.00000000000000
lambda[   6] =  -0.21145415892996, occ[   6] =   2.00000000000000
lambda[   7] =  -0.20758120479438, occ[   7] =   2.00000000000000
lambda[   8] =  -0.03045713031502, occ[   8] =   0.00000002053095
lambda[   9] =   0.00319137582968, occ[   9] =   0.00000000000000
lambda[  10] =   0.01401928037020, occ[  10] =   0.00000000000000
lambda[  11] =   0.02481490495214, occ[  11] =   0.00000000000000
lambda[  12] =   0.02729244500776, occ[  12] =   0.00000000000000
lambda[  13] =   0.03611908897696, occ[  13] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 12 (90%) = 0.000000000000000.
Occupation of state 13 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.151 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.376 ms, time for Allreduce/Reduce: 5.710 ms 
Time for calculating local force components: 12.991 ms
Start Calculating nonlocal forces
force_nloc = 
  0.01483538151186  -0.02410880512538  -0.05756737239700
 -0.01483539219400   0.02410881009040  -0.05756752747856
 -0.06091179977471  -0.01884207687119   0.01587493036829
  0.06091193389009   0.01884207983866   0.01587494326344
  0.46260038630633  -0.34943333076350   0.50440985583624
 -0.46260176853099   0.34942969967048   0.50441169183858
force_loc = 
 -0.01702077598233   0.02706725261381   0.06122758103410
  0.01702049463112  -0.02706752582195   0.06122632901955
  0.06456426307785   0.02148393684577  -0.01825631250704
 -0.06456331767933  -0.02148372531457  -0.01825640505215
 -0.44987313997928   0.33570317592065  -0.49208442248354
  0.44987143643503  -0.33570456786838  -0.49208173897470
Time for calculating nonlocal force components: 19.947 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.01198023748589   0.01366572871826  -0.01357745353380
[0m[32m  0.01198007745945  -0.01366565705092  -0.01357732693956
[0mTime for calculating XC forces components: 17.030 ms
 Cartesian force = 
 -0.00218498475133   0.00295928167475   0.00365074663813
  0.00218551215626  -0.00295788154524   0.00364933954202
  0.00365287302227   0.00264269416088  -0.00239084413773
 -0.00365097407011  -0.00264081128960  -0.00239092378769
  0.00074741856029  -0.00006359193828  -0.00126148218008
 -0.00074984491737   0.00006030893749  -0.00125683607465
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Time for printing density: 389.870 ms
The program took 624.671 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:22
Job ID:        2266506
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:07:48,vmem=8480K,walltime=00:10:39,mem=8168K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-9-1
---------------------------------------
