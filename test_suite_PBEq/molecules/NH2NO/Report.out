---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:16
Job ID:    2266772
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:21
Job ID:    2266772
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.064 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 19.458 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 7.447 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 139.425 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.049 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.099 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    7.214603	    9.822423	    9.890447	
   11.207177	   11.565741	   10.103595	
   12.785397	    8.642798	   10.225133	
    9.047018	    8.434259	    9.887678	
   11.259849	    9.680312	    9.774867	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 3.215 ms
Set up communicators.

--set up spincomm took 0.261 ms

--set up kptcomm took 0.379 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.011 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.079 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.165 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.650 ms

Calculate_SplineDerivRadFun took 0.225 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 2.058 ms.
time spent on vectorized spline interp: 3.995 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 8.770 ms.
time spent on vectorized spline interp: 4.391 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.512 ms.
time spent on vectorized spline interp: 2.181 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.854 ms.

Calculating rb for all atom types took 28.792 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.899 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.011 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000256883, sum_int_rho = 17.8002065503824
PosCharge = 18.000000025688, NegCharge = -17.800206550382, scal_fac = 1.011224222300
After scaling, int_rho = 18.0000000256883, PosCharge + NegCharge - NetCharge = 1.421e-14
--Calculate Vref took 0.601 ms
--Calculate rho_guess took 2.913 ms

 integral of b = -18.0000000256883,
 int{b} + Nelectron + NetCharge = -2.569e-08,
 Esc = -60.0615977225607,
 MPI_Reduce took 0.045 ms

Calculating b & b_ref took 11.508 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.031 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.038 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.024 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.219 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 73.199 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568830, int_b + int_rho = -3.274e-14, checking this took 0.097 ms
2-norm of RHS = 581.0699734069437, which took 0.081 ms

iter_count = 420, r_2norm = 4.994e-04, tol*||rhs|| = 5.811e-04

Anderson update took 238.549 ms, out of which F'*F took 105.218 ms; b-Ax took 717.266 ms, out of which Lap took 647.500 ms
Solving Poisson took 1526.895 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.477 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.864 ms
Total time for convolution: 	 convolve: 5.217908 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.717 ms
Total time for convolution: 	 convolve: 5.172498 
Total time for convolution: 	 convolve: 5.133789 
Total time for convolution: 	 convolve: 5.171010 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.778 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.429 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
rank = 0, XC calculation took 24582.857 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.635 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.289 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 5.049 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.148 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.626 ms
    Lanczos iter 53, eigmin  = -1.105036972, eigmax = 264.923124933, err_eigmin = 7.291e-04, err_eigmax = 9.609e-03
rank =   0, Lanczos took 118.263 ms, eigmin = -1.105036972211, eigmax = 267.572356182610

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.183660, lowerbound = -1.205037, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1181.703 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.924 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.772 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.798 ms
rank =  0, Distribute data + matrix mult took 17.509 ms
rank =  0, finding HY took 20.283 ms
rank =  0, distributing HY into block cyclic form took 11.829 ms
rank =  0, finding Y'*HY took 5.563 ms
Rank 0, Project_Hamiltonian used 55.213 ms
Total time for projection: 55.224 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.380 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.710 ms
rank = 0, Solve_Generalized_EigenProblem used 1.660 ms
    first calculated eigval = 2.796973422452252
    last  calculated eigval = 3.217752450830961
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.79697342245225
lambda[   2] =   2.83272374492571
lambda[   3] =   2.89075839378776
lambda[   4] =   2.92957473295934
lambda[   5] =   2.93806414932374
lambda[   6] =   2.96579335155160
lambda[   7] =   3.00230602272711
lambda[   8] =   3.00493100477765
lambda[   9] =   3.05334001787501
lambda[  10] =   3.06707610230803
lambda[  11] =   3.10380766636395
lambda[  12] =   3.12127817286081
lambda[  13] =   3.14045270442276
lambda[  14] =   3.15049085179947
lambda[  15] =   3.21775245083096
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.678 ms
rank =  0, subspace rotation using ScaLAPACK took 3.550 ms
rank =  0, Distributing orbital back into band + domain format took 12.628 ms
rank = 0, Subspace_Rotation used 16.193 ms

Total time for subspace rotation: 16.196 ms
rank = 0, Efermi =   3.060208060292 calculate fermi energy took 0.051 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.317752, lowerbound = -1.205037, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1120.971 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 32.831 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.360 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 36.236 ms
rank =  0, finding HY took 19.219 ms
rank =  0, distributing HY into block cyclic form took 11.723 ms
rank =  0, finding Y'*HY took 4.283 ms
Rank 0, Project_Hamiltonian used 71.490 ms
Total time for projection: 71.504 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -0.920002338494774
    last  calculated eigval = 0.424075958707043
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.92000233849477
lambda[   2] =  -0.69905111923773
lambda[   3] =  -0.44842486447035
lambda[   4] =  -0.22511710795319
lambda[   5] =  -0.12068185934317
lambda[   6] =   0.17337012406949
lambda[   7] =   0.23272972313182
lambda[   8] =   0.28860212168971
lambda[   9] =   0.29909115064277
lambda[  10] =   0.32560516716605
lambda[  11] =   0.36426683888944
lambda[  12] =   0.37595688824599
lambda[  13] =   0.40910692892936
lambda[  14] =   0.41816686236029
lambda[  15] =   0.42407595870704
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 3.444 ms
rank =  0, Distributing orbital back into band + domain format took 11.744 ms
rank = 0, Subspace_Rotation used 15.208 ms

Total time for subspace rotation: 15.211 ms
rank = 0, Efermi =   0.312348573802 calculate fermi energy took 0.021 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.524076, lowerbound = -1.205037, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1127.367 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 31.638 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.338 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.051 ms
rank =  0, Distribute data + matrix mult took 35.039 ms
rank =  0, finding HY took 19.260 ms
rank =  0, distributing HY into block cyclic form took 11.626 ms
rank =  0, finding Y'*HY took 3.556 ms
Rank 0, Project_Hamiltonian used 70.544 ms
Total time for projection: 70.548 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -1.115931423316060
    last  calculated eigval = 0.148451267172891
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.11593142331606
lambda[   2] =  -0.94354231366655
lambda[   3] =  -0.69110390129264
lambda[   4] =  -0.59724065705117
lambda[   5] =  -0.52696723764441
lambda[   6] =  -0.43598405050137
lambda[   7] =  -0.39055790196366
lambda[   8] =  -0.30032406065814
lambda[   9] =  -0.23411068269303
lambda[  10] =  -0.09741050311015
lambda[  11] =   0.07021170335860
lambda[  12] =   0.10091794475363
lambda[  13] =   0.12000688259967
lambda[  14] =   0.12441563996989
lambda[  15] =   0.14845126717289
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 3.481 ms
rank =  0, Distributing orbital back into band + domain format took 11.742 ms
rank = 0, Subspace_Rotation used 15.235 ms

Total time for subspace rotation: 15.239 ms
rank = 0, Efermi =  -0.126350978093 calculate fermi energy took 0.020 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.248451, lowerbound = -1.205037, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1126.739 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 32.768 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.450 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 36.237 ms
rank =  0, finding HY took 19.246 ms
rank =  0, distributing HY into block cyclic form took 11.724 ms
rank =  0, finding Y'*HY took 4.315 ms
Rank 0, Project_Hamiltonian used 71.548 ms
Total time for projection: 71.554 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -1.116039656591229
    last  calculated eigval = 0.100053079282786
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.11603965659123
lambda[   2] =  -0.94417617274353
lambda[   3] =  -0.69175462775478
lambda[   4] =  -0.59961243438890
lambda[   5] =  -0.53426094074230
lambda[   6] =  -0.46530445464900
lambda[   7] =  -0.41744231526491
lambda[   8] =  -0.34163826592594
lambda[   9] =  -0.26885806049237
lambda[  10] =  -0.13631595510124
lambda[  11] =   0.03636930662635
lambda[  12] =   0.04621820517757
lambda[  13] =   0.05741380464043
lambda[  14] =   0.08151515725294
lambda[  15] =   0.10005307928279
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.441 ms
rank =  0, Distributing orbital back into band + domain format took 11.766 ms
rank = 0, Subspace_Rotation used 15.220 ms

Total time for subspace rotation: 15.224 ms
rank = 0, Efermi =  -0.165256430057 calculate fermi energy took 0.021 ms
rank = 0, --- Calculate rho: sum over local bands took 4.791 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.617 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.166 ms
rank = 0, Calculating density took 5018.944 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.585 ms
rank = 0, D2D took 1.758 ms
rank = 0, Transfering density took 1.769 ms
Etot    =   -38.451621799873
Eband   =   -10.758173860608
E1      =    21.365089598456
E2      =    -9.769918476047
E3      =   -11.865324946353
Exc     =   -10.632183236796
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 7.690e+00, dEband = 2.152e+00
rank = 0, Calculating/Estimating energy took 1.243 ms, Etot = -38.451621800, dEtot = 7.690e+00, dEband = 2.152e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 65.0306837828779, which took 0.045 ms

iter_count = 90, r_2norm = 1.788e-03, tol*||rhs|| = 2.601e-03

Anderson update took 48.025 ms, out of which F'*F took 22.284 ms; b-Ax took 149.084 ms, out of which Lap took 133.883 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 324.123 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568829, int_b + int_rho = -4.729e-14, checking this took 0.133 ms
2-norm of RHS = 578.0632744357544, which took 0.124 ms

iter_count = 276, r_2norm = 5.358e-04, tol*||rhs|| = 5.781e-04

Anderson update took 146.752 ms, out of which F'*F took 69.001 ms; b-Ax took 463.191 ms, out of which Lap took 415.901 ms
Solving Poisson took 981.721 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.851 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.165172 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.170092 
Total time for convolution: 	 convolve: 5.121562 
Total time for convolution: 	 convolve: 5.118941 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.888 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.976 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.901 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.896 ms

This SCF took 30933.370 ms, scf error = 1.481e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.200053, lowerbound = -1.116040, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1143.590 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.672 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.425 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.040 ms
rank =  0, Distribute data + matrix mult took 15.149 ms
rank =  0, finding HY took 19.274 ms
rank =  0, distributing HY into block cyclic form took 11.766 ms
rank =  0, finding Y'*HY took 4.217 ms
Rank 0, Project_Hamiltonian used 50.437 ms
Total time for projection: 50.461 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -1.106264762260997
    last  calculated eigval = 0.077986013264612
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.10626476226100
lambda[   2] =  -0.91392126961881
lambda[   3] =  -0.66684219958577
lambda[   4] =  -0.56826569576221
lambda[   5] =  -0.51065648931364
lambda[   6] =  -0.45396346004986
lambda[   7] =  -0.40132002462361
lambda[   8] =  -0.30955464939360
lambda[   9] =  -0.24653880867045
lambda[  10] =  -0.12898916955466
lambda[  11] =   0.01632570384804
lambda[  12] =   0.02133785480234
lambda[  13] =   0.02815386131732
lambda[  14] =   0.06155290743600
lambda[  15] =   0.07798601326461
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 3.493 ms
rank =  0, Distributing orbital back into band + domain format took 11.827 ms
rank = 0, Subspace_Rotation used 15.332 ms

Total time for subspace rotation: 15.336 ms
rank = 0, Efermi =  -0.157929644535 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 3.289 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.319 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.156 ms
rank = 0, Calculating density took 1216.076 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.650 ms
rank = 0, D2D took 0.854 ms
rank = 0, Transfering density took 0.863 ms
Etot    =   -38.415872545390
Eband   =   -10.354654721871
E1      =    21.027560306156
E2      =    -9.714903092267
E3      =   -11.981136280403
Exc     =   -10.723219779017
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 7.150e-03, dEband = 8.070e-02
rank = 0, Calculating/Estimating energy took 1.157 ms, Etot = -38.415872545, dEtot = 7.150e-03, dEband = 8.070e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 28.4363120499300, which took 0.068 ms

iter_count = 96, r_2norm = 7.953e-04, tol*||rhs|| = 1.137e-03

Anderson update took 51.056 ms, out of which F'*F took 23.625 ms; b-Ax took 159.322 ms, out of which Lap took 142.648 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 348.538 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568838, int_b + int_rho = 4.366e-14, checking this took 0.099 ms
2-norm of RHS = 575.9618547389546, which took 0.139 ms

iter_count = 282, r_2norm = 5.718e-04, tol*||rhs|| = 5.760e-04

Anderson update took 148.834 ms, out of which F'*F took 69.493 ms; b-Ax took 475.169 ms, out of which Lap took 426.032 ms
Solving Poisson took 1001.673 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.862 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.220326 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.216482 
Total time for convolution: 	 convolve: 5.350670 
Total time for convolution: 	 convolve: 5.259699 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.373 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.183 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 0.965 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.886 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.869 ms

This SCF took 27623.635 ms, scf error = 9.010e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.177986, lowerbound = -1.106265, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1189.214 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.750 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.684 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.051 ms
rank =  0, Distribute data + matrix mult took 15.495 ms
rank =  0, finding HY took 19.868 ms
rank =  0, distributing HY into block cyclic form took 11.992 ms
rank =  0, finding Y'*HY took 4.300 ms
Rank 0, Project_Hamiltonian used 51.686 ms
Total time for projection: 51.706 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -1.092185353408555
    last  calculated eigval = 0.066336847837344
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.09218535340856
lambda[   2] =  -0.88512633840655
lambda[   3] =  -0.63895869160021
lambda[   4] =  -0.53838757751812
lambda[   5] =  -0.48376510640734
lambda[   6] =  -0.43958082680747
lambda[   7] =  -0.37718085247831
lambda[   8] =  -0.28193322255675
lambda[   9] =  -0.21946089140307
lambda[  10] =  -0.11204703885850
lambda[  11] =  -0.00426773298884
lambda[  12] =   0.01469473304808
lambda[  13] =   0.01636649516265
lambda[  14] =   0.04773837392626
lambda[  15] =   0.06633684783734
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 3.973 ms
rank =  0, Distributing orbital back into band + domain format took 11.726 ms
rank = 0, Subspace_Rotation used 15.720 ms

Total time for subspace rotation: 15.747 ms
rank = 0, Efermi =  -0.140987513842 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.116 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.159 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.144 ms
rank = 0, Calculating density took 1263.840 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.491 ms
rank = 0, D2D took 0.607 ms
rank = 0, Transfering density took 0.609 ms
Etot    =   -38.401024483417
Eband   =    -9.913157724051
E1      =    20.670444196375
E2      =    -9.615660563252
E3      =   -12.118206778235
Exc     =   -10.830580573901
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 2.970e-03, dEband = 8.830e-02
rank = 0, Calculating/Estimating energy took 0.902 ms, Etot = -38.401024483, dEtot = 2.970e-03, dEband = 8.830e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 5.7013721156214, which took 0.450 ms

iter_count = 102, r_2norm = 2.088e-04, tol*||rhs|| = 2.281e-04

Anderson update took 54.350 ms, out of which F'*F took 25.019 ms; b-Ax took 169.322 ms, out of which Lap took 151.504 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 370.547 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568830, int_b + int_rho = -3.638e-14, checking this took 0.116 ms
2-norm of RHS = 576.3483010501252, which took 0.105 ms

iter_count = 282, r_2norm = 4.390e-04, tol*||rhs|| = 5.763e-04

Anderson update took 150.927 ms, out of which F'*F took 69.706 ms; b-Ax took 470.683 ms, out of which Lap took 421.611 ms
Solving Poisson took 1004.174 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.083591 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.173 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.147740 
Total time for convolution: 	 convolve: 5.100173 
Total time for convolution: 	 convolve: 5.119151 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.557 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.988 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.896 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.905 ms

This SCF took 27109.255 ms, scf error = 3.960e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.166337, lowerbound = -1.092185, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1152.902 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 11.798 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.304 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.121 ms
rank =  0, finding HY took 19.014 ms
rank =  0, distributing HY into block cyclic form took 11.644 ms
rank =  0, finding Y'*HY took 5.480 ms
Rank 0, Project_Hamiltonian used 51.287 ms
Total time for projection: 51.299 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.164 ms
    first calculated eigval = -1.081988766760968
    last  calculated eigval = 0.057181072099477
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08198876676097
lambda[   2] =  -0.87543033973596
lambda[   3] =  -0.62681812682975
lambda[   4] =  -0.52772255709330
lambda[   5] =  -0.46943077973796
lambda[   6] =  -0.43007572844685
lambda[   7] =  -0.36075144981655
lambda[   8] =  -0.27560245654165
lambda[   9] =  -0.20457906232809
lambda[  10] =  -0.10071515632264
lambda[  11] =  -0.02021226743155
lambda[  12] =   0.00946057387528
lambda[  13] =   0.01443474645244
lambda[  14] =   0.03682891099489
lambda[  15] =   0.05718107209948
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.176 ms
rank =  0, subspace rotation using ScaLAPACK took 4.001 ms
rank =  0, Distributing orbital back into band + domain format took 11.374 ms
rank = 0, Subspace_Rotation used 15.392 ms

Total time for subspace rotation: 15.400 ms
rank = 0, Efermi =  -0.129655631265 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.457 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.935 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.212 ms
rank = 0, Calculating density took 1226.987 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
rank = 0, D2D took 0.646 ms
rank = 0, Transfering density took 0.648 ms
Etot    =   -38.398038631873
Eband   =    -9.704798537169
E1      =    20.529341161359
E2      =    -9.535391696567
E3      =   -12.186669028527
Exc     =   -10.883044257830
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 5.972e-04, dEband = 4.167e-02
rank = 0, Calculating/Estimating energy took 0.903 ms, Etot = -38.398038632, dEtot = 5.972e-04, dEband = 4.167e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.0790494800175, which took 0.049 ms

iter_count = 102, r_2norm = 1.076e-04, tol*||rhs|| = 1.232e-04

Anderson update took 54.061 ms, out of which F'*F took 25.090 ms; b-Ax took 170.682 ms, out of which Lap took 152.779 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 370.617 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568832, int_b + int_rho = -1.819e-14, checking this took 0.106 ms
2-norm of RHS = 577.0702620217477, which took 0.085 ms

iter_count = 252, r_2norm = 5.108e-04, tol*||rhs|| = 5.771e-04

Anderson update took 136.235 ms, out of which F'*F took 62.949 ms; b-Ax took 435.058 ms, out of which Lap took 393.474 ms
Solving Poisson took 911.968 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.118803 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 67.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.127747 
Total time for convolution: 	 convolve: 5.102475 
Total time for convolution: 	 convolve: 5.178660 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.187 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.951 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.814 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.787 ms

This SCF took 27111.297 ms, scf error = 1.186e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.157181, lowerbound = -1.081989, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1161.132 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.785 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.392 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.197 ms
rank =  0, finding HY took 19.104 ms
rank =  0, distributing HY into block cyclic form took 11.579 ms
rank =  0, finding Y'*HY took 4.520 ms
Rank 0, Project_Hamiltonian used 50.440 ms
Total time for projection: 50.454 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.516 ms
    first calculated eigval = -1.080896212430935
    last  calculated eigval = 0.048372946985707
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08089621243093
lambda[   2] =  -0.87417756829249
lambda[   3] =  -0.62551973080688
lambda[   4] =  -0.52583029536263
lambda[   5] =  -0.46763709484381
lambda[   6] =  -0.42918248558002
lambda[   7] =  -0.35874873489160
lambda[   8] =  -0.27465148773922
lambda[   9] =  -0.20264308373362
lambda[  10] =  -0.09992500491806
lambda[  11] =  -0.02941607002185
lambda[  12] =   0.00740929278097
lambda[  13] =   0.01297649152317
lambda[  14] =   0.02960016865014
lambda[  15] =   0.04837294698571
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.535 ms
rank =  0, subspace rotation using ScaLAPACK took 3.985 ms
rank =  0, Distributing orbital back into band + domain format took 11.616 ms
rank = 0, Subspace_Rotation used 15.622 ms

Total time for subspace rotation: 15.628 ms
rank = 0, Efermi =  -0.128865479896 calculate fermi energy took 2.045 ms
rank = 0, --- Calculate rho: sum over local bands took 3.225 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.911 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.172 ms
rank = 0, Calculating density took 1235.166 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.575 ms
rank = 0, D2D took 0.829 ms
rank = 0, Transfering density took 0.833 ms
Etot    =   -38.397625563242
Eband   =    -9.678573389929
E1      =    20.528138377170
E2      =    -9.508241509552
E3      =   -12.194002667033
Exc     =   -10.887837003741
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 8.261e-05, dEband = 5.245e-03
rank = 0, Calculating/Estimating energy took 1.020 ms, Etot = -38.397625563, dEtot = 8.261e-05, dEband = 5.245e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7330782747207, which took 0.055 ms

iter_count = 114, r_2norm = 1.912e-05, tol*||rhs|| = 2.932e-05

Anderson update took 60.693 ms, out of which F'*F took 28.183 ms; b-Ax took 190.140 ms, out of which Lap took 170.429 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 412.816 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568829, int_b + int_rho = -5.093e-14, checking this took 0.091 ms
2-norm of RHS = 577.5869927325879, which took 0.086 ms

iter_count = 246, r_2norm = 4.741e-04, tol*||rhs|| = 5.776e-04

Anderson update took 131.216 ms, out of which F'*F took 60.317 ms; b-Ax took 411.820 ms, out of which Lap took 368.539 ms
Solving Poisson took 875.908 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.152260 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.102017 
Total time for convolution: 	 convolve: 5.120991 
Total time for convolution: 	 convolve: 5.097790 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.593 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.238 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 0.980 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.329 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.331 ms

This SCF took 27407.314 ms, scf error = 5.775e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.148373, lowerbound = -1.080896, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1135.358 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 11.727 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.338 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 15.106 ms
rank =  0, finding HY took 19.225 ms
rank =  0, distributing HY into block cyclic form took 11.655 ms
rank =  0, finding Y'*HY took 3.633 ms
Rank 0, Project_Hamiltonian used 50.345 ms
Total time for projection: 50.363 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -1.080297110449424
    last  calculated eigval = 0.040651242657906
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08029711044942
lambda[   2] =  -0.87371618293628
lambda[   3] =  -0.62534942787568
lambda[   4] =  -0.52525890146289
lambda[   5] =  -0.46715006025031
lambda[   6] =  -0.42875611809318
lambda[   7] =  -0.35828379851875
lambda[   8] =  -0.27416758173560
lambda[   9] =  -0.20216127667397
lambda[  10] =  -0.09983982628460
lambda[  11] =  -0.03400221535235
lambda[  12] =   0.00620971764500
lambda[  13] =   0.01199242079055
lambda[  14] =   0.02514379036012
lambda[  15] =   0.04065124265791
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.168 ms
rank =  0, subspace rotation using ScaLAPACK took 3.493 ms
rank =  0, Distributing orbital back into band + domain format took 11.866 ms
rank = 0, Subspace_Rotation used 15.375 ms

Total time for subspace rotation: 15.379 ms
rank = 0, Efermi =  -0.128780301230 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 3.084 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.348 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.168 ms
rank = 0, Calculating density took 1207.985 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.701 ms
rank = 0, D2D took 0.853 ms
rank = 0, Transfering density took 0.859 ms
Etot    =   -38.397448545505
Eband   =    -9.670280918557
E1      =    20.537061970186
E2      =    -9.490623962402
E3      =   -12.193292272959
Exc     =   -10.886548109169
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 3.540e-05, dEband = 1.658e-03
rank = 0, Calculating/Estimating energy took 0.901 ms, Etot = -38.397448546, dEtot = 3.540e-05, dEband = 1.658e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5087826537368, which took 0.097 ms

iter_count = 108, r_2norm = 1.542e-05, tol*||rhs|| = 2.035e-05

Anderson update took 57.514 ms, out of which F'*F took 27.069 ms; b-Ax took 181.483 ms, out of which Lap took 163.122 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 391.572 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568829, int_b + int_rho = -5.093e-14, checking this took 0.098 ms
2-norm of RHS = 577.5909054297824, which took 0.102 ms

iter_count = 246, r_2norm = 4.716e-04, tol*||rhs|| = 5.776e-04

Anderson update took 131.154 ms, out of which F'*F took 61.281 ms; b-Ax took 411.533 ms, out of which Lap took 369.829 ms
Solving Poisson took 876.350 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.124396 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.656 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.132025 
Total time for convolution: 	 convolve: 5.123975 
Total time for convolution: 	 convolve: 5.144349 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.836 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.973 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.329 ms

This SCF took 27013.137 ms, scf error = 2.663e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.140651, lowerbound = -1.080297, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1153.797 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.079 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.862 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 14.991 ms
rank =  0, finding HY took 19.128 ms
rank =  0, distributing HY into block cyclic form took 11.630 ms
rank =  0, finding Y'*HY took 4.368 ms
Rank 0, Project_Hamiltonian used 50.650 ms
Total time for projection: 50.667 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -1.077400887068682
    last  calculated eigval = 0.035007106525583
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07740088706868
lambda[   2] =  -0.87164134125833
lambda[   3] =  -0.62347907061343
lambda[   4] =  -0.52393324926774
lambda[   5] =  -0.46436015663809
lambda[   6] =  -0.42622302858285
lambda[   7] =  -0.35560485308443
lambda[   8] =  -0.27220868659388
lambda[   9] =  -0.19954632447963
lambda[  10] =  -0.09746108075803
lambda[  11] =  -0.03620654330986
lambda[  12] =   0.00538213439702
lambda[  13] =   0.01106147359556
lambda[  14] =   0.02264548240118
lambda[  15] =   0.03500710652558
==subpsace eigenproblem: bcast eigvals took 0.053 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 3.494 ms
rank =  0, Distributing orbital back into band + domain format took 11.813 ms
rank = 0, Subspace_Rotation used 15.317 ms

Total time for subspace rotation: 15.322 ms
rank = 0, Efermi =  -0.126401555687 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 3.052 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.309 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.165 ms
rank = 0, Calculating density took 1226.676 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.688 ms
rank = 0, D2D took 0.854 ms
rank = 0, Transfering density took 0.857 ms
Etot    =   -38.397377333692
Eband   =    -9.628795197678
E1      =    20.514416230818
E2      =    -9.470085496427
E3      =   -12.199948494322
Exc     =   -10.891434634255
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 1.424e-05, dEband = 8.297e-03
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -38.397377334, dEtot = 1.424e-05, dEband = 8.297e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3031957916359, which took 0.079 ms

iter_count = 108, r_2norm = 1.036e-05, tol*||rhs|| = 1.213e-05

Anderson update took 57.292 ms, out of which F'*F took 26.633 ms; b-Ax took 182.017 ms, out of which Lap took 162.950 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 391.131 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568830, int_b + int_rho = -3.274e-14, checking this took 0.095 ms
2-norm of RHS = 577.6295293239690, which took 0.133 ms

iter_count = 222, r_2norm = 5.419e-04, tol*||rhs|| = 5.776e-04

Anderson update took 142.215 ms, out of which F'*F took 55.007 ms; b-Ax took 372.552 ms, out of which Lap took 334.736 ms
Solving Poisson took 814.845 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.121 ms
Total time for convolution: 	 convolve: 5.115849 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 85.684 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.158437 
Total time for convolution: 	 convolve: 5.116737 
Total time for convolution: 	 convolve: 5.144588 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.978 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.334 ms

This SCF took 27066.006 ms, scf error = 1.413e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.135007, lowerbound = -1.077401, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1136.668 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 11.776 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.352 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.149 ms
rank =  0, finding HY took 19.090 ms
rank =  0, distributing HY into block cyclic form took 11.807 ms
rank =  0, finding Y'*HY took 4.144 ms
Rank 0, Project_Hamiltonian used 50.237 ms
Total time for projection: 50.255 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -1.076618610832046
    last  calculated eigval = 0.032027314626951
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07661861083205
lambda[   2] =  -0.87116965912956
lambda[   3] =  -0.62310238520759
lambda[   4] =  -0.52368630575538
lambda[   5] =  -0.46363517442208
lambda[   6] =  -0.42548438606397
lambda[   7] =  -0.35495923368886
lambda[   8] =  -0.27163882615625
lambda[   9] =  -0.19889049039289
lambda[  10] =  -0.09683777673063
lambda[  11] =  -0.03680260233331
lambda[  12] =   0.00530991998284
lambda[  13] =   0.01073202983659
lambda[  14] =   0.02183493179545
lambda[  15] =   0.03202731462695
==subpsace eigenproblem: bcast eigvals took 0.081 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 3.508 ms
rank =  0, Distributing orbital back into band + domain format took 11.735 ms
rank = 0, Subspace_Rotation used 15.255 ms

Total time for subspace rotation: 15.260 ms
rank = 0, Efermi =  -0.125778251711 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.072 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.365 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.167 ms
rank = 0, Calculating density took 1209.122 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.683 ms
rank = 0, D2D took 0.856 ms
rank = 0, Transfering density took 0.859 ms
Etot    =   -38.397441372968
Eband   =    -9.618370145785
E1      =    20.511455898800
E2      =    -9.462514338474
E3      =   -12.199570757211
Exc     =   -10.891014498341
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 1.281e-05, dEband = 2.085e-03
rank = 0, Calculating/Estimating energy took 0.933 ms, Etot = -38.397441373, dEtot = 1.281e-05, dEband = 2.085e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1340138327845, which took 0.051 ms

iter_count = 114, r_2norm = 3.277e-06, tol*||rhs|| = 5.361e-06

Anderson update took 60.904 ms, out of which F'*F took 28.287 ms; b-Ax took 190.743 ms, out of which Lap took 171.047 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 411.638 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568832, int_b + int_rho = -1.455e-14, checking this took 0.095 ms
2-norm of RHS = 577.6311707688643, which took 0.088 ms

iter_count = 228, r_2norm = 4.686e-04, tol*||rhs|| = 5.776e-04

Anderson update took 121.392 ms, out of which F'*F took 56.686 ms; b-Ax took 381.512 ms, out of which Lap took 342.536 ms
Solving Poisson took 811.322 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.282829 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.097320 
Total time for convolution: 	 convolve: 5.188671 
Total time for convolution: 	 convolve: 5.101129 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.908 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.351 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.285 ms

This SCF took 27137.416 ms, scf error = 1.025e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.132027, lowerbound = -1.076619, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1147.985 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 11.814 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.289 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.123 ms
rank =  0, finding HY took 19.234 ms
rank =  0, distributing HY into block cyclic form took 11.667 ms
rank =  0, finding Y'*HY took 4.334 ms
Rank 0, Project_Hamiltonian used 50.395 ms
Total time for projection: 50.412 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -1.075522977254790
    last  calculated eigval = 0.031344707795524
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07552297725479
lambda[   2] =  -0.87021341484804
lambda[   3] =  -0.62212858900595
lambda[   4] =  -0.52284344358924
lambda[   5] =  -0.46233029118055
lambda[   6] =  -0.42431708600551
lambda[   7] =  -0.35365980061306
lambda[   8] =  -0.27063590680652
lambda[   9] =  -0.19761430987398
lambda[  10] =  -0.09567613242351
lambda[  11] =  -0.03582895919442
lambda[  12] =   0.00670034539291
lambda[  13] =   0.01080206151475
lambda[  14] =   0.02278507012564
lambda[  15] =   0.03134470779552
==subpsace eigenproblem: bcast eigvals took 0.054 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 3.483 ms
rank =  0, Distributing orbital back into band + domain format took 11.786 ms
rank = 0, Subspace_Rotation used 15.282 ms

Total time for subspace rotation: 15.287 ms
rank = 0, Efermi =  -0.124616607348 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 3.056 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.272 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.164 ms
rank = 0, Calculating density took 1220.558 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.689 ms
rank = 0, D2D took 0.854 ms
rank = 0, Transfering density took 0.857 ms
Etot    =   -38.397527485143
Eband   =    -9.598531640813
E1      =    20.502161047032
E2      =    -9.451562864097
E3      =   -12.200894471250
Exc     =   -10.892016503383
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 1.722e-05, dEband = 3.968e-03
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -38.397527485, dEtot = 1.722e-05, dEband = 3.968e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1191460547024, which took 0.076 ms

iter_count = 108, r_2norm = 4.183e-06, tol*||rhs|| = 4.766e-06

Anderson update took 57.506 ms, out of which F'*F took 26.828 ms; b-Ax took 181.800 ms, out of which Lap took 163.305 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 391.758 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568834, int_b + int_rho = 3.638e-15, checking this took 0.074 ms
2-norm of RHS = 577.6171965324185, which took 0.091 ms

iter_count = 198, r_2norm = 5.595e-04, tol*||rhs|| = 5.776e-04

Anderson update took 105.285 ms, out of which F'*F took 49.184 ms; b-Ax took 331.291 ms, out of which Lap took 297.604 ms
Solving Poisson took 704.697 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.109333 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 73.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.101893 
Total time for convolution: 	 convolve: 5.129958 
Total time for convolution: 	 convolve: 5.120657 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.966 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.354 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.342 ms

This SCF took 26903.543 ms, scf error = 5.768e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.131345, lowerbound = -1.075523, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1127.536 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 11.730 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.354 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 15.112 ms
rank =  0, finding HY took 19.123 ms
rank =  0, distributing HY into block cyclic form took 11.856 ms
rank =  0, finding Y'*HY took 4.090 ms
Rank 0, Project_Hamiltonian used 50.209 ms
Total time for projection: 50.225 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -1.074736684495296
    last  calculated eigval = 0.030003902020931
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07473668449530
lambda[   2] =  -0.86950999084984
lambda[   3] =  -0.62150522952118
lambda[   4] =  -0.52224164803631
lambda[   5] =  -0.46164273057084
lambda[   6] =  -0.42361096425617
lambda[   7] =  -0.35300299842238
lambda[   8] =  -0.26994324044505
lambda[   9] =  -0.19692362959511
lambda[  10] =  -0.09502244282317
lambda[  11] =  -0.03453010275117
lambda[  12] =   0.00836246459605
lambda[  13] =   0.01049848391229
lambda[  14] =   0.02348119045708
lambda[  15] =   0.03000390202093
==subpsace eigenproblem: bcast eigvals took 0.050 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 3.510 ms
rank =  0, Distributing orbital back into band + domain format took 11.890 ms
rank = 0, Subspace_Rotation used 15.425 ms

Total time for subspace rotation: 15.431 ms
rank = 0, Efermi =  -0.123962917772 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.116 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.937 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.179 ms
rank = 0, Calculating density took 1200.765 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.519 ms
rank = 0, D2D took 0.621 ms
rank = 0, Transfering density took 0.623 ms
Etot    =   -38.397606307238
Eband   =    -9.586234234825
E1      =    20.495421836256
E2      =    -9.445752297869
E3      =   -12.201837147591
Exc     =   -10.892785630802
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 1.576e-05, dEband = 2.459e-03
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -38.397606307, dEtot = 1.576e-05, dEband = 2.459e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0930158139241, which took 0.070 ms

iter_count = 108, r_2norm = 2.752e-06, tol*||rhs|| = 3.721e-06

Anderson update took 57.456 ms, out of which F'*F took 26.819 ms; b-Ax took 181.558 ms, out of which Lap took 162.886 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 391.781 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568828, int_b + int_rho = -5.457e-14, checking this took 0.098 ms
2-norm of RHS = 577.6340341807919, which took 0.104 ms

iter_count = 198, r_2norm = 5.311e-04, tol*||rhs|| = 5.776e-04

Anderson update took 105.270 ms, out of which F'*F took 49.383 ms; b-Ax took 331.449 ms, out of which Lap took 297.835 ms
Solving Poisson took 704.274 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.109316 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 53.812 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.117633 
Total time for convolution: 	 convolve: 5.103005 
Total time for convolution: 	 convolve: 5.194187 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.515 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 0.963 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.320 ms

This SCF took 26970.757 ms, scf error = 4.099e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.130004, lowerbound = -1.074737, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1155.382 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.807 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.378 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.204 ms
rank =  0, finding HY took 19.078 ms
rank =  0, distributing HY into block cyclic form took 11.765 ms
rank =  0, finding Y'*HY took 4.176 ms
Rank 0, Project_Hamiltonian used 50.264 ms
Total time for projection: 50.277 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -1.074018132154699
    last  calculated eigval = 0.030088248377401
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07401813215470
lambda[   2] =  -0.86888666996553
lambda[   3] =  -0.62090169015528
lambda[   4] =  -0.52164977389110
lambda[   5] =  -0.46099608916982
lambda[   6] =  -0.42292809628182
lambda[   7] =  -0.35233341867301
lambda[   8] =  -0.26935365983210
lambda[   9] =  -0.19626044476812
lambda[  10] =  -0.09435164948037
lambda[  11] =  -0.03162650932218
lambda[  12] =   0.01048980223673
lambda[  13] =   0.01251311912129
lambda[  14] =   0.02555778049566
lambda[  15] =   0.03008824837740
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.174 ms
rank =  0, subspace rotation using ScaLAPACK took 3.519 ms
rank =  0, Distributing orbital back into band + domain format took 11.846 ms
rank = 0, Subspace_Rotation used 15.379 ms

Total time for subspace rotation: 15.383 ms
rank = 0, Efermi =  -0.123292124461 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.097 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.284 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.165 ms
rank = 0, Calculating density took 1227.870 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.677 ms
rank = 0, D2D took 0.840 ms
rank = 0, Transfering density took 0.843 ms
Etot    =   -38.397637046470
Eband   =    -9.574655952207
E1      =    20.489931578340
E2      =    -9.439491074764
E3      =   -12.202556931617
Exc     =   -10.893362955657
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 6.148e-06, dEband = 2.316e-03
rank = 0, Calculating/Estimating energy took 1.790 ms, Etot = -38.397637046, dEtot = 6.148e-06, dEband = 2.316e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0725170673838, which took 0.050 ms

iter_count = 108, r_2norm = 2.474e-06, tol*||rhs|| = 2.901e-06

Anderson update took 57.320 ms, out of which F'*F took 26.881 ms; b-Ax took 181.043 ms, out of which Lap took 162.524 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 390.763 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568827, int_b + int_rho = -6.548e-14, checking this took 0.100 ms
2-norm of RHS = 577.6362915280585, which took 0.092 ms

iter_count = 150, r_2norm = 5.687e-04, tol*||rhs|| = 5.776e-04

Anderson update took 79.822 ms, out of which F'*F took 37.369 ms; b-Ax took 250.865 ms, out of which Lap took 225.432 ms
Solving Poisson took 534.611 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.315654 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.132069 
Total time for convolution: 	 convolve: 5.170817 
Total time for convolution: 	 convolve: 5.104295 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.207 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.975 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.333 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.330 ms

This SCF took 26900.113 ms, scf error = 2.693e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.130088, lowerbound = -1.074018, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1136.118 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 11.797 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.294 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.110 ms
rank =  0, finding HY took 19.116 ms
rank =  0, distributing HY into block cyclic form took 11.663 ms
rank =  0, finding Y'*HY took 4.272 ms
Rank 0, Project_Hamiltonian used 50.199 ms
Total time for projection: 50.212 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -1.073744886215130
    last  calculated eigval = 0.029849049895650
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07374488621513
lambda[   2] =  -0.86863495683338
lambda[   3] =  -0.62066251401015
lambda[   4] =  -0.52141892734883
lambda[   5] =  -0.46074277906576
lambda[   6] =  -0.42267434760182
lambda[   7] =  -0.35209070206695
lambda[   8] =  -0.26911029807771
lambda[   9] =  -0.19601465197719
lambda[  10] =  -0.09410847413350
lambda[  11] =  -0.03081124502204
lambda[  12] =   0.01054419235826
lambda[  13] =   0.01338954869723
lambda[  14] =   0.02613939414476
lambda[  15] =   0.02984904989565
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 3.503 ms
rank =  0, Distributing orbital back into band + domain format took 11.807 ms
rank = 0, Subspace_Rotation used 15.322 ms

Total time for subspace rotation: 15.328 ms
rank = 0, Efermi =  -0.123048949065 calculate fermi energy took 0.077 ms
rank = 0, --- Calculate rho: sum over local bands took 3.073 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.267 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.173 ms
rank = 0, Calculating density took 1208.494 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.494 ms
rank = 0, D2D took 1.592 ms
rank = 0, Transfering density took 1.595 ms
Etot    =   -38.397651224539
Eband   =    -9.570188128811
E1      =    20.487583770916
E2      =    -9.437258039593
E3      =   -12.203001971666
Exc     =   -10.893709154575
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 2.836e-06, dEband = 8.936e-04
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -38.397651225, dEtot = 2.836e-06, dEband = 8.936e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0357604368454, which took 0.100 ms

iter_count = 108, r_2norm = 1.356e-06, tol*||rhs|| = 1.430e-06

Anderson update took 57.337 ms, out of which F'*F took 26.892 ms; b-Ax took 181.442 ms, out of which Lap took 162.773 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 390.633 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568833, int_b + int_rho = -1.091e-14, checking this took 0.105 ms
2-norm of RHS = 577.6541000145970, which took 0.087 ms

iter_count = 180, r_2norm = 5.535e-04, tol*||rhs|| = 5.777e-04

Anderson update took 96.701 ms, out of which F'*F took 44.729 ms; b-Ax took 301.415 ms, out of which Lap took 270.726 ms
Solving Poisson took 641.475 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.097898 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 44.495 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.101799 
Total time for convolution: 	 convolve: 5.131101 
Total time for convolution: 	 convolve: 5.098333 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.327 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.958 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.337 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.318 ms

This SCF took 26765.955 ms, scf error = 2.283e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.129849, lowerbound = -1.073745, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1141.545 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.934 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.494 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 16.469 ms
rank =  0, finding HY took 19.071 ms
rank =  0, distributing HY into block cyclic form took 11.692 ms
rank =  0, finding Y'*HY took 4.163 ms
Rank 0, Project_Hamiltonian used 51.433 ms
Total time for projection: 51.446 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -1.073236231376912
    last  calculated eigval = 0.030950823902223
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07323623137691
lambda[   2] =  -0.86811093006295
lambda[   3] =  -0.62014909896048
lambda[   4] =  -0.52089918061034
lambda[   5] =  -0.46024781009812
lambda[   6] =  -0.42217106401721
lambda[   7] =  -0.35161353326593
lambda[   8] =  -0.26860531267095
lambda[   9] =  -0.19554574672180
lambda[  10] =  -0.09362835323747
lambda[  11] =  -0.02909083374099
lambda[  12] =   0.01067041311928
lambda[  13] =   0.01512858753545
lambda[  14] =   0.02794141824611
lambda[  15] =   0.03095082390222
==subpsace eigenproblem: bcast eigvals took 0.078 ms
Total time for solving subspace eigenvalue problem: 0.238 ms
rank =  0, subspace rotation using ScaLAPACK took 3.508 ms
rank =  0, Distributing orbital back into band + domain format took 11.734 ms
rank = 0, Subspace_Rotation used 15.254 ms

Total time for subspace rotation: 15.259 ms
rank = 0, Efermi =  -0.122568828183 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.434 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.607 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.162 ms
rank = 0, Calculating density took 1215.342 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.700 ms
rank = 0, D2D took 0.809 ms
rank = 0, Transfering density took 0.817 ms
Etot    =   -38.397688120714
Eband   =    -9.561157817975
E1      =    20.483225809333
E2      =    -9.432354584153
E3      =   -12.203781671413
Exc     =   -10.894294644311
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 7.379e-06, dEband = 1.806e-03
rank = 0, Calculating/Estimating energy took 1.099 ms, Etot = -38.397688121, dEtot = 7.379e-06, dEband = 1.806e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0368667227391, which took 0.096 ms

iter_count = 108, r_2norm = 1.092e-06, tol*||rhs|| = 1.475e-06

Anderson update took 57.410 ms, out of which F'*F took 26.891 ms; b-Ax took 181.410 ms, out of which Lap took 162.852 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 391.073 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568823, int_b + int_rho = -1.019e-13, checking this took 0.119 ms
2-norm of RHS = 577.6586859150867, which took 0.087 ms

iter_count = 144, r_2norm = 5.773e-04, tol*||rhs|| = 5.777e-04

Anderson update took 76.602 ms, out of which F'*F took 35.702 ms; b-Ax took 241.423 ms, out of which Lap took 217.017 ms
Solving Poisson took 513.434 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.101537 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 104.005 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.125672 
Total time for convolution: 	 convolve: 5.117019 
Total time for convolution: 	 convolve: 5.126189 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.584 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.504 ms
---Transfer Veff_loc: D2D took 0.970 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.328 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.319 ms

This SCF took 26693.974 ms, scf error = 1.315e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.130951, lowerbound = -1.073236, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1146.330 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 11.805 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.292 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 15.134 ms
rank =  0, finding HY took 19.113 ms
rank =  0, distributing HY into block cyclic form took 11.577 ms
rank =  0, finding Y'*HY took 4.387 ms
Rank 0, Project_Hamiltonian used 50.243 ms
Total time for projection: 50.259 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -1.073108975518339
    last  calculated eigval = 0.031996121550557
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07310897551834
lambda[   2] =  -0.86796714931268
lambda[   3] =  -0.62000399973082
lambda[   4] =  -0.52074488915438
lambda[   5] =  -0.46012119687735
lambda[   6] =  -0.42203610827060
lambda[   7] =  -0.35148759211290
lambda[   8] =  -0.26846489647211
lambda[   9] =  -0.19542305118839
lambda[  10] =  -0.09349637858452
lambda[  11] =  -0.02809901189453
lambda[  12] =   0.01092175302182
lambda[  13] =   0.01597329635008
lambda[  14] =   0.02910833663982
lambda[  15] =   0.03199612155056
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 3.460 ms
rank =  0, Distributing orbital back into band + domain format took 12.332 ms
rank = 0, Subspace_Rotation used 15.817 ms

Total time for subspace rotation: 15.821 ms
rank = 0, Efermi =  -0.122436853558 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.118 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.199 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.216 ms
rank = 0, Calculating density took 1219.276 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.526 ms
rank = 0, D2D took 0.634 ms
rank = 0, Transfering density took 0.639 ms
Etot    =   -38.397697739203
Eband   =    -9.558715719677
E1      =    20.482118890940
E2      =    -9.430984033088
E3      =   -12.203898702773
Exc     =   -10.894385923001
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 1.924e-06, dEband = 4.884e-04
rank = 0, Calculating/Estimating energy took 0.911 ms, Etot = -38.397697739, dEtot = 1.924e-06, dEband = 4.884e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0267751156173, which took 0.048 ms

iter_count = 108, r_2norm = 7.918e-07, tol*||rhs|| = 1.071e-06

Anderson update took 57.419 ms, out of which F'*F took 26.845 ms; b-Ax took 180.855 ms, out of which Lap took 162.436 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 390.728 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568830, int_b + int_rho = -3.638e-14, checking this took 0.097 ms
2-norm of RHS = 577.6584596657576, which took 0.084 ms

iter_count = 156, r_2norm = 4.907e-04, tol*||rhs|| = 5.777e-04

Anderson update took 82.778 ms, out of which F'*F took 38.734 ms; b-Ax took 260.605 ms, out of which Lap took 234.196 ms
Solving Poisson took 556.018 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.131189 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.113567 
Total time for convolution: 	 convolve: 5.173806 
Total time for convolution: 	 convolve: 5.102020 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.057 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 0.962 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.338 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.320 ms

This SCF took 26716.614 ms, scf error = 1.120e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.131996, lowerbound = -1.073109, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1147.817 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 11.811 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.255 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.087 ms
rank =  0, finding HY took 19.134 ms
rank =  0, distributing HY into block cyclic form took 11.760 ms
rank =  0, finding Y'*HY took 4.203 ms
Rank 0, Project_Hamiltonian used 50.221 ms
Total time for projection: 50.234 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -1.073038246116796
    last  calculated eigval = 0.033427183360297
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07303824611680
lambda[   2] =  -0.86786902710025
lambda[   3] =  -0.61989748967031
lambda[   4] =  -0.52062560793281
lambda[   5] =  -0.46003593706331
lambda[   6] =  -0.42194213022616
lambda[   7] =  -0.35139889593940
lambda[   8] =  -0.26836019920073
lambda[   9] =  -0.19533859909031
lambda[  10] =  -0.09340239892065
lambda[  11] =  -0.02716722432595
lambda[  12] =   0.01125089760116
lambda[  13] =   0.01625256025737
lambda[  14] =   0.03046726993388
lambda[  15] =   0.03342718336030
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 3.457 ms
rank =  0, Distributing orbital back into band + domain format took 11.759 ms
rank = 0, Subspace_Rotation used 15.233 ms

Total time for subspace rotation: 15.237 ms
rank = 0, Efermi =  -0.122342873856 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.023 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.231 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.180 ms
rank = 0, Calculating density took 1220.041 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
rank = 0, D2D took 0.698 ms
rank = 0, Transfering density took 0.704 ms
Etot    =   -38.397714441403
Eband   =    -9.557012267080
E1      =    20.481459912910
E2      =    -9.429964612012
E3      =   -12.203780344503
Exc     =   -10.894309320422
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 3.340e-06, dEband = 3.407e-04
rank = 0, Calculating/Estimating energy took 1.371 ms, Etot = -38.397714441, dEtot = 3.340e-06, dEband = 3.407e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0271629152662, which took 0.112 ms

iter_count = 108, r_2norm = 7.513e-07, tol*||rhs|| = 1.087e-06

Anderson update took 57.477 ms, out of which F'*F took 26.860 ms; b-Ax took 181.282 ms, out of which Lap took 162.897 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 390.727 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568826, int_b + int_rho = -7.276e-14, checking this took 0.101 ms
2-norm of RHS = 577.6563548329493, which took 0.099 ms

iter_count = 108, r_2norm = 5.677e-04, tol*||rhs|| = 5.777e-04

Anderson update took 57.498 ms, out of which F'*F took 26.887 ms; b-Ax took 180.598 ms, out of which Lap took 162.255 ms
Solving Poisson took 386.134 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.141949 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 100.260 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.103237 
Total time for convolution: 	 convolve: 5.150327 
Total time for convolution: 	 convolve: 5.097498 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.067 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.943 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.326 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.296 ms

This SCF took 26615.713 ms, scf error = 1.013e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.133427, lowerbound = -1.073038, upperbound = 267.572356

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1163.828 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.731 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.355 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.106 ms
rank =  0, finding HY took 20.904 ms
rank =  0, distributing HY into block cyclic form took 12.229 ms
rank =  0, finding Y'*HY took 3.883 ms
Rank 0, Project_Hamiltonian used 52.181 ms
Total time for projection: 52.199 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -1.072950753556422
    last  calculated eigval = 0.034015351838056
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07295075355642
lambda[   2] =  -0.86779394698504
lambda[   3] =  -0.61982574724315
lambda[   4] =  -0.52056211508568
lambda[   5] =  -0.45995169933253
lambda[   6] =  -0.42186060266044
lambda[   7] =  -0.35131757391064
lambda[   8] =  -0.26828623241516
lambda[   9] =  -0.19525681520127
lambda[  10] =  -0.09332215841268
lambda[  11] =  -0.02649530021122
lambda[  12] =   0.01146294728834
lambda[  13] =   0.01694138783350
lambda[  14] =   0.03103724956365
lambda[  15] =   0.03401535183806
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 3.531 ms
rank =  0, Distributing orbital back into band + domain format took 11.601 ms
rank = 0, Subspace_Rotation used 15.157 ms

Total time for subspace rotation: 15.162 ms
rank = 0, Efermi =  -0.122262633346 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.959 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.267 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.212 ms
rank = 0, Calculating density took 1237.943 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.588 ms
rank = 0, D2D took 0.762 ms
rank = 0, Transfering density took 0.768 ms
Etot    =   -38.397715273035
Eband   =    -9.555610975178
E1      =    20.480681205019
E2      =    -9.429312866392
E3      =   -12.203924988584
Exc     =   -10.894425634525
Esc     =   -60.061597722561
Entropy =    -0.000000000766
dE = 1.663e-07, dEband = 2.803e-04
rank = 0, Calculating/Estimating energy took 1.279 ms, Etot = -38.397715273, dEtot = 1.663e-07, dEband = 2.803e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0255850665096, which took 0.051 ms

iter_count = 102, r_2norm = 1.007e-06, tol*||rhs|| = 1.023e-06

Anderson update took 54.307 ms, out of which F'*F took 25.418 ms; b-Ax took 171.320 ms, out of which Lap took 153.983 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 370.126 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002568834, int_rho =  18.00000002568827, int_b + int_rho = -6.548e-14, checking this took 0.104 ms
2-norm of RHS = 577.6570726655114, which took 0.099 ms

iter_count = 126, r_2norm = 5.083e-04, tol*||rhs|| = 5.777e-04

Anderson update took 67.090 ms, out of which F'*F took 31.293 ms; b-Ax took 211.246 ms, out of which Lap took 189.719 ms
Solving Poisson took 449.841 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.130104 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 99.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.156958 
Total time for convolution: 	 convolve: 5.092860 
Total time for convolution: 	 convolve: 5.136157 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.961 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.325 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.307 ms

This SCF took 26672.599 ms, scf error = 8.207e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -1.07295075355642, occ[   1] =   2.00000000000000
lambda[   2] =  -0.86779394698504, occ[   2] =   2.00000000000000
lambda[   3] =  -0.61982574724315, occ[   3] =   2.00000000000000
lambda[   4] =  -0.52056211508568, occ[   4] =   2.00000000000000
lambda[   5] =  -0.45995169933253, occ[   5] =   2.00000000000000
lambda[   6] =  -0.42186060266044, occ[   6] =   2.00000000000000
lambda[   7] =  -0.35131757391064, occ[   7] =   2.00000000000000
lambda[   8] =  -0.26828623241516, occ[   8] =   2.00000000000000
lambda[   9] =  -0.19525681520127, occ[   9] =   2.00000000000000
lambda[  10] =  -0.09332215841268, occ[  10] =   0.00000002568831
lambda[  11] =  -0.02649530021122, occ[  11] =   0.00000000000000
lambda[  12] =   0.01146294728834, occ[  12] =   0.00000000000000
lambda[  13] =   0.01694138783350, occ[  13] =   0.00000000000000
lambda[  14] =   0.03103724956365, occ[  14] =   0.00000000000000
lambda[  15] =   0.03401535183806, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.549 ms, time for Allreduce/Reduce: 5.748 ms 
Time for calculating local force components: 15.138 ms
Start Calculating nonlocal forces
force_nloc = 
  1.05980982773633  -0.67640144295561  -0.00515364486469
  0.00269640008360  -0.06484711602813  -0.01064940802120
 -0.05473019334499   0.03749399225918  -0.01559746956178
 -0.01055261120284   1.07861454235776  -0.03791643926572
 -0.07210147980949  -0.06396708488162   0.25270226325825
force_loc = 
 -1.04104873464917   0.66229005731203   0.00496611427844
 -0.00098988864631   0.07243107779099   0.01030980022408
  0.06064198546828  -0.04052644680660   0.01547405788553
  0.01647586244486  -1.05210121806162   0.03532799455900
  0.07140176610833   0.05988359088259  -0.24537829949501
Time for calculating nonlocal force components: 26.209 ms
[32mforces_xc: 
[0m[32m -0.02858633281402   0.01740873714654   0.00021928001267
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00357470047328  -0.03155876338634   0.00145384996546
[0m[32m  0.00040946962728   0.00129382113979  -0.00579331409113
[0mTime for calculating XC forces components: 18.698 ms
 Cartesian force = 
 -0.00979551383257   0.00329460214917   0.00003879244964
  0.00173623733157   0.00758121240907  -0.00033256477390
  0.00594151801757  -0.00303520390121  -0.00011636865303
  0.00237827666302  -0.00504818844399  -0.00112755171804
 -0.00026051817960  -0.00279242221304   0.00153769269533
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.996 ms
Time for printing density: 387.916 ms
The program took 463.664 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:06
Job ID:        2266772
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:34:36,vmem=8436K,walltime=00:07:53,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-004-4-2
---------------------------------------
