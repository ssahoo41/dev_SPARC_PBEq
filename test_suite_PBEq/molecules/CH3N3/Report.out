---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:28
Job ID:    2266731
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:32
Job ID:    2266731
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 0.798 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 7.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 0.750 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 9.804 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.975 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.091 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.215706	    6.137428	   10.000000	
    8.670872	    7.523571	   11.684957	
    8.670872	    7.523571	    8.315043	
    9.855151	    7.674815	   10.000000	
   11.329128	   10.044841	   10.000000	
    9.989393	   11.964304	   10.000000	
    8.966257	   13.862572	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.164 ms
Set up communicators.

--set up spincomm took 2.282 ms

--set up kptcomm took 0.358 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 2}
gridsizes = [100, 100, 100], Nstates = 18, dmcomm dims = [1, 1, 2]

--set up dmcomm took 0.005 ms

--set up blacscomm took 0.011 ms
rank = 0, size_blacscomm = 6, ScaLAPACK topology Dims = (6, 1)
nproc = 12, size_blacscomm = 6 = dims[0] * dims[1] = (6, 1)
Nd_blacscomm 500000, Nstates 18 
rank =  0, my blacs rank = 0, BLCYC size (500000, 3), actual size (500000, 3)
rank = 0, mb = nb = 18, mbQ = nbQ = 64
rank = 0, nr_Hp = 18, nc_Hp = 18
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.074 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.985 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 6
# of bands per bandcomm          : 3
npdomain: 2
Embeded Cartesian topology dims: (1,1,2)
# of FD-grid points per processor: 500000 = (100,100,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.994 ms

Calculate_SplineDerivRadFun took 0.199 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.820 ms.
time spent on vectorized spline interp: 3.194 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.580 ms.
time spent on vectorized spline interp: 1.678 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.488 ms.
time spent on vectorized spline interp: 1.643 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.512 ms.

Calculating rb for all atom types took 15.948 ms
----------------------
Estimated memory usage
Total: 1.11 GB
orbitals             : 823.97 MB
global sized vectors : 213.62 MB
subspace matrices : 15.19 kB
others : 103.76 MB
----------------------------------------------
Estimated memory usage per processor: 95.11 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.053 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -22.0000000226189, sum_int_rho = 21.6949090459012
PosCharge = 22.000000022619, NegCharge = -21.694909045901, scal_fac = 1.014062791232
After scaling, int_rho = 22.0000000226189, PosCharge + NegCharge - NetCharge = 1.421e-14
--Calculate Vref took 0.471 ms
--Calculate rho_guess took 2.382 ms

 integral of b = -22.0000000226189,
 int{b} + Nelectron + NetCharge = -2.262e-08,
 Esc = -64.4195729380173,
 MPI_Reduce took 7.260 ms

Calculating b & b_ref took 16.190 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.044 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.053 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.028 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.227 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 34.134 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261896, int_b + int_rho = 1.310e-13, checking this took 5.645 ms
2-norm of RHS = 660.1283177104250, which took 0.387 ms

iter_count = 420, r_2norm = 6.028e-04, tol*||rhs|| = 6.601e-04

Anderson update took 236.342 ms, out of which F'*F took 106.078 ms; b-Ax took 728.130 ms, out of which Lap took 655.647 ms
Solving Poisson took 1526.775 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
Total time for convolution: 	 convolve: 5.130355 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.624 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.830 ms
Total time for convolution: 	 convolve: 5.147643 
Total time for convolution: 	 convolve: 5.146759 
Total time for convolution: 	 convolve: 5.229272 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.735 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.402 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
rank = 0, XC calculation took 24609.526 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 2.840 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 5.314 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 9.227 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.217 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.894 ms
    Lanczos iter 53, eigmin  = -1.055866851, eigmax = 264.926484029, err_eigmin = 1.479e-03, err_eigmax = 9.702e-03
rank =   0, Lanczos took 126.041 ms, eigmin = -1.055866851154, eigmax = 267.575748868805

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.209941, lowerbound = -1.155867, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1458.420 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 16.673 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.539 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 20.245 ms
rank =  0, finding HY took 27.009 ms
rank =  0, distributing HY into block cyclic form took 16.367 ms
rank =  0, finding Y'*HY took 5.136 ms
Rank 0, Project_Hamiltonian used 68.791 ms
Total time for projection: 68.802 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.333 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.936 ms
rank = 0, Solve_Generalized_EigenProblem used 1.287 ms
    first calculated eigval = 2.746352367004481
    last  calculated eigval = 3.221882479350515
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =   2.79445749679867
lambda[   3] =   2.80632027590529
lambda[   4] =   2.84284274630287
lambda[   5] =   2.84832104474963
lambda[   6] =   2.89438375597664
lambda[   7] =   2.93325361290149
lambda[   8] =   2.94954234528236
lambda[   9] =   2.96015455233102
lambda[  10] =   2.96933309577823
lambda[  11] =   3.03772234159630
lambda[  12] =   3.04893957773161
lambda[  13] =   3.07422561150087
lambda[  14] =   3.10595545817518
lambda[  15] =   3.12968607425895
lambda[  16] =   3.13733833975141
lambda[  17] =   3.20239706427801
lambda[  18] =   3.22188247935052
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 1.299 ms
rank =  0, subspace rotation using ScaLAPACK took 6.872 ms
rank =  0, Distributing orbital back into band + domain format took 15.974 ms
rank = 0, Subspace_Rotation used 22.860 ms

Total time for subspace rotation: 22.863 ms
rank = 0, Efermi =   3.043330959780 calculate fermi energy took 0.056 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.321882, lowerbound = -1.155867, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1448.587 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 15.498 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.451 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 18.985 ms
rank =  0, finding HY took 25.416 ms
rank =  0, distributing HY into block cyclic form took 15.736 ms
rank =  0, finding Y'*HY took 4.722 ms
Rank 0, Project_Hamiltonian used 64.887 ms
Total time for projection: 64.891 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.892199132047455
    last  calculated eigval = 0.446686485712199
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.73995785743729
lambda[   3] =  -0.63339975172503
lambda[   4] =  -0.30691686199386
lambda[   5] =  -0.22407438527396
lambda[   6] =  -0.07097903770242
lambda[   7] =   0.04217592239149
lambda[   8] =   0.12848062474668
lambda[   9] =   0.15360221603112
lambda[  10] =   0.20278315047152
lambda[  11] =   0.29167397296339
lambda[  12] =   0.30714113940194
lambda[  13] =   0.32267606737818
lambda[  14] =   0.35493073944284
lambda[  15] =   0.37249338062382
lambda[  16] =   0.37930474626645
lambda[  17] =   0.41631543925662
lambda[  18] =   0.44668648571220
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.188 ms
rank =  0, subspace rotation using ScaLAPACK took 7.096 ms
rank =  0, Distributing orbital back into band + domain format took 15.621 ms
rank = 0, Subspace_Rotation used 22.731 ms

Total time for subspace rotation: 22.736 ms
rank = 0, Efermi =   0.299407481877 calculate fermi energy took 0.023 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.546686, lowerbound = -1.155867, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1457.802 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.691 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.983 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.736 ms
rank =  0, finding HY took 25.101 ms
rank =  0, distributing HY into block cyclic form took 16.023 ms
rank =  0, finding Y'*HY took 4.653 ms
Rank 0, Project_Hamiltonian used 65.549 ms
Total time for projection: 65.564 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.184 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.255 ms
    first calculated eigval = -1.072586255124786
    last  calculated eigval = 0.145133889915110
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.95127127141910
lambda[   3] =  -0.78920537981786
lambda[   4] =  -0.58795361192306
lambda[   5] =  -0.52309129405769
lambda[   6] =  -0.51779153194449
lambda[   7] =  -0.44668661849417
lambda[   8] =  -0.43390146126150
lambda[   9] =  -0.42668266326899
lambda[  10] =  -0.30565481850462
lambda[  11] =  -0.23580015592455
lambda[  12] =  -0.01239458585442
lambda[  13] =   0.02635576012643
lambda[  14] =   0.07410716991534
lambda[  15] =   0.08192906076015
lambda[  16] =   0.10848660754892
lambda[  17] =   0.13340031606889
lambda[  18] =   0.14513388991511
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.270 ms
rank =  0, subspace rotation using ScaLAPACK took 7.007 ms
rank =  0, Distributing orbital back into band + domain format took 15.630 ms
rank = 0, Subspace_Rotation used 22.650 ms

Total time for subspace rotation: 22.655 ms
rank = 0, Efermi =  -0.041450098824 calculate fermi energy took 0.043 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.245134, lowerbound = -1.155867, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1459.997 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.650 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.302 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 18.972 ms
rank =  0, finding HY took 25.566 ms
rank =  0, distributing HY into block cyclic form took 15.662 ms
rank =  0, finding Y'*HY took 4.746 ms
Rank 0, Project_Hamiltonian used 64.986 ms
Total time for projection: 64.994 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -1.072810521424503
    last  calculated eigval = 0.081521353685776
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.95146100103055
lambda[   3] =  -0.78968674638550
lambda[   4] =  -0.59119570026960
lambda[   5] =  -0.52795933232233
lambda[   6] =  -0.52555903890777
lambda[   7] =  -0.45905371609527
lambda[   8] =  -0.45322283927735
lambda[   9] =  -0.43635555830668
lambda[  10] =  -0.33788877292440
lambda[  11] =  -0.27770089295386
lambda[  12] =  -0.07052176243954
lambda[  13] =  -0.04650067120777
lambda[  14] =  -0.00951255907235
lambda[  15] =   0.03403822268390
lambda[  16] =   0.06509928788779
lambda[  17] =   0.07871480609819
lambda[  18] =   0.08152135368578
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 7.314 ms
rank =  0, Distributing orbital back into band + domain format took 15.493 ms
rank = 0, Subspace_Rotation used 22.825 ms

Total time for subspace rotation: 22.829 ms
rank = 0, Efermi =  -0.099577275445 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 3.658 ms
rank = 0, --- Calculate rho: reduce over all band groups took 7.043 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.317 ms
rank = 0, Calculating density took 6321.779 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.024 ms
rank = 0, D2D took 1.135 ms
rank = 0, Transfering density took 1.140 ms
Etot    =   -38.954282660370
Eband   =   -12.845788241391
E1      =    26.141329083039
E2      =   -10.831194001375
E3      =   -13.187482962346
Exc     =   -11.848927527044
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 5.565e+00, dEband = 1.835e+00
rank = 0, Calculating/Estimating energy took 0.910 ms, Etot = -38.954282660, dEtot = 5.565e+00, dEband = 1.835e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 50.1253133359437, which took 0.081 ms

iter_count = 96, r_2norm = 1.491e-03, tol*||rhs|| = 2.005e-03

Anderson update took 52.548 ms, out of which F'*F took 24.208 ms; b-Ax took 164.452 ms, out of which Lap took 146.757 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.905 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261882, int_b + int_rho = -1.091e-14, checking this took 0.103 ms
2-norm of RHS = 656.7927312723094, which took 0.148 ms

iter_count = 288, r_2norm = 5.493e-04, tol*||rhs|| = 6.568e-04

Anderson update took 154.956 ms, out of which F'*F took 72.119 ms; b-Ax took 493.676 ms, out of which Lap took 439.855 ms
Solving Poisson took 1040.627 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.453 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.568 ms
Total time for convolution: 	 convolve: 5.172775 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.616 ms
Total time for convolution: 	 convolve: 5.186477 
Total time for convolution: 	 convolve: 5.242377 
Total time for convolution: 	 convolve: 5.173646 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.824 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.588 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 1.831 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.803 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.661 ms

This SCF took 32547.157 ms, scf error = 1.658e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.181521, lowerbound = -1.072811, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1456.564 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.817 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.263 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 19.109 ms
rank =  0, finding HY took 25.486 ms
rank =  0, distributing HY into block cyclic form took 16.555 ms
rank =  0, finding Y'*HY took 5.148 ms
Rank 0, Project_Hamiltonian used 66.334 ms
Total time for projection: 66.350 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.198 ms
    first calculated eigval = -1.072080217539726
    last  calculated eigval = 0.063054367057652
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.93718725081150
lambda[   3] =  -0.75605370014093
lambda[   4] =  -0.55702327592022
lambda[   5] =  -0.50152111700924
lambda[   6] =  -0.50005301742653
lambda[   7] =  -0.44675078123541
lambda[   8] =  -0.44403434916538
lambda[   9] =  -0.42034165996877
lambda[  10] =  -0.31292629451661
lambda[  11] =  -0.25672163646002
lambda[  12] =  -0.08489265467250
lambda[  13] =  -0.04760246528613
lambda[  14] =  -0.02901855697962
lambda[  15] =   0.02072075714883
lambda[  16] =   0.03931429272171
lambda[  17] =   0.05181293265872
lambda[  18] =   0.06305436705765
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 7.058 ms
rank =  0, Distributing orbital back into band + domain format took 15.544 ms
rank = 0, Subspace_Rotation used 22.617 ms

Total time for subspace rotation: 22.622 ms
rank = 0, Efermi =  -0.113948167668 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.582 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.100 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.317 ms
rank = 0, Calculating density took 1555.900 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.041 ms
rank = 0, D2D took 1.150 ms
rank = 0, Transfering density took 1.156 ms
Etot    =   -38.898978188608
Eband   =   -12.409386602309
E1      =    25.740381144179
E2      =   -10.824605086154
E3      =   -13.321867514177
Exc     =   -11.956872392114
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 7.901e-03, dEband = 6.234e-02
rank = 0, Calculating/Estimating energy took 0.891 ms, Etot = -38.898978189, dEtot = 7.901e-03, dEband = 6.234e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 21.4268851708264, which took 0.059 ms

iter_count = 102, r_2norm = 5.981e-04, tol*||rhs|| = 8.571e-04

Anderson update took 55.971 ms, out of which F'*F took 25.790 ms; b-Ax took 178.512 ms, out of which Lap took 160.670 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 382.349 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261900, int_b + int_rho = 1.673e-13, checking this took 0.118 ms
2-norm of RHS = 653.1154949595333, which took 0.115 ms

iter_count = 294, r_2norm = 5.860e-04, tol*||rhs|| = 6.531e-04

Anderson update took 158.281 ms, out of which F'*F took 75.590 ms; b-Ax took 505.650 ms, out of which Lap took 450.452 ms
Solving Poisson took 1062.813 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.220525 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.307612 
Total time for convolution: 	 convolve: 5.186539 
Total time for convolution: 	 convolve: 5.188038 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.724 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 1.920 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.784 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.730 ms

This SCF took 28006.066 ms, scf error = 1.063e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.163054, lowerbound = -1.072080, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1456.985 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.462 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.820 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.003 ms
rank =  0, Distribute data + matrix mult took 19.302 ms
rank =  0, finding HY took 26.986 ms
rank =  0, distributing HY into block cyclic form took 15.519 ms
rank =  0, finding Y'*HY took 5.774 ms
Rank 0, Project_Hamiltonian used 67.618 ms
Total time for projection: 67.632 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.196 ms
    first calculated eigval = -1.062025908531488
    last  calculated eigval = 0.057465163774393
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.91745936889543
lambda[   3] =  -0.70857724754723
lambda[   4] =  -0.51346843816998
lambda[   5] =  -0.47863224319133
lambda[   6] =  -0.47573265921058
lambda[   7] =  -0.41608837949213
lambda[   8] =  -0.41544282579639
lambda[   9] =  -0.39437157002616
lambda[  10] =  -0.28385274631886
lambda[  11] =  -0.23443087484632
lambda[  12] =  -0.07793445637619
lambda[  13] =  -0.03714732001211
lambda[  14] =  -0.02929017136437
lambda[  15] =   0.01791260732491
lambda[  16] =   0.02817179687755
lambda[  17] =   0.03593645608663
lambda[  18] =   0.05746516377439
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 7.124 ms
rank =  0, Distributing orbital back into band + domain format took 15.678 ms
rank = 0, Subspace_Rotation used 22.817 ms

Total time for subspace rotation: 22.822 ms
rank = 0, Efermi =  -0.106989969341 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.513 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.347 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.325 ms
rank = 0, Calculating density took 1557.989 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.049 ms
rank = 0, D2D took 1.168 ms
rank = 0, Transfering density took 1.174 ms
Etot    =   -38.864067925429
Eband   =   -11.800164525815
E1      =    25.198369785693
E2      =   -10.750468907196
E3      =   -13.529271472132
Exc     =   -12.122440625941
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 4.987e-03, dEband = 8.703e-02
rank = 0, Calculating/Estimating energy took 1.070 ms, Etot = -38.864067925, dEtot = 4.987e-03, dEband = 8.703e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 7.6903204472858, which took 0.057 ms

iter_count = 102, r_2norm = 2.345e-04, tol*||rhs|| = 3.076e-04

Anderson update took 54.501 ms, out of which F'*F took 25.826 ms; b-Ax took 174.304 ms, out of which Lap took 155.874 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.902 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261895, int_b + int_rho = 1.201e-13, checking this took 0.136 ms
2-norm of RHS = 652.3235760738693, which took 0.200 ms

iter_count = 276, r_2norm = 5.500e-04, tol*||rhs|| = 6.523e-04

Anderson update took 157.393 ms, out of which F'*F took 68.750 ms; b-Ax took 471.385 ms, out of which Lap took 420.375 ms
Solving Poisson took 1002.291 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.184959 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.176993 
Total time for convolution: 	 convolve: 5.191398 
Total time for convolution: 	 convolve: 5.247851 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.775 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.019 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 1.943 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.762 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.729 ms

This SCF took 27884.407 ms, scf error = 4.395e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.157465, lowerbound = -1.062026, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1466.691 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.403 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.429 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 18.853 ms
rank =  0, finding HY took 25.405 ms
rank =  0, distributing HY into block cyclic form took 15.655 ms
rank =  0, finding Y'*HY took 4.686 ms
Rank 0, Project_Hamiltonian used 64.634 ms
Total time for projection: 64.648 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -1.052071391095785
    last  calculated eigval = 0.050107148511210
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.90860058326375
lambda[   3] =  -0.69173674751565
lambda[   4] =  -0.49945153164783
lambda[   5] =  -0.46949659895903
lambda[   6] =  -0.46669464864418
lambda[   7] =  -0.40156431263883
lambda[   8] =  -0.39737243769218
lambda[   9] =  -0.37827509955560
lambda[  10] =  -0.27672639380354
lambda[  11] =  -0.22801743956494
lambda[  12] =  -0.07085937696502
lambda[  13] =  -0.02987491245201
lambda[  14] =  -0.02881012161815
lambda[  15] =   0.01571130262401
lambda[  16] =   0.02447213877884
lambda[  17] =   0.02714619924821
lambda[  18] =   0.05010714851121
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.218 ms
rank =  0, subspace rotation using ScaLAPACK took 3.054 ms
rank =  0, Distributing orbital back into band + domain format took 19.940 ms
rank = 0, Subspace_Rotation used 23.009 ms

Total time for subspace rotation: 23.013 ms
rank = 0, Efermi =  -0.099914889951 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.073 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.018 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 1564.379 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.179 ms
rank = 0, D2D took 1.493 ms
rank = 0, Transfering density took 1.500 ms
Etot    =   -38.857852044444
Eband   =   -11.540014370365
E1      =    24.989962290288
E2      =   -10.682978570187
E3      =   -13.628137872897
Exc     =   -12.199343468756
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 8.880e-04, dEband = 3.716e-02
rank = 0, Calculating/Estimating energy took 0.902 ms, Etot = -38.857852044, dEtot = 8.880e-04, dEband = 3.716e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.2006998242462, which took 0.057 ms

iter_count = 108, r_2norm = 8.080e-05, tol*||rhs|| = 1.280e-04

Anderson update took 61.044 ms, out of which F'*F took 26.620 ms; b-Ax took 185.123 ms, out of which Lap took 165.750 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.615 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261903, int_b + int_rho = 2.001e-13, checking this took 0.115 ms
2-norm of RHS = 652.5060579443593, which took 0.138 ms

iter_count = 252, r_2norm = 6.498e-04, tol*||rhs|| = 6.525e-04

Anderson update took 136.032 ms, out of which F'*F took 63.201 ms; b-Ax took 430.939 ms, out of which Lap took 384.622 ms
Solving Poisson took 909.386 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.186331 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.182814 
Total time for convolution: 	 convolve: 5.214628 
Total time for convolution: 	 convolve: 5.160146 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.617 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.686 ms
---Transfer Veff_loc: D2D took 3.307 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.517 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.854 ms

This SCF took 27689.608 ms, scf error = 1.798e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.150107, lowerbound = -1.052071, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1462.820 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.566 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.451 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 19.054 ms
rank =  0, finding HY took 25.765 ms
rank =  0, distributing HY into block cyclic form took 15.674 ms
rank =  0, finding Y'*HY took 4.729 ms
Rank 0, Project_Hamiltonian used 65.282 ms
Total time for projection: 65.306 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -1.048525424107471
    last  calculated eigval = 0.042085798654331
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.90483276657495
lambda[   3] =  -0.68570688584482
lambda[   4] =  -0.49388286913833
lambda[   5] =  -0.46606399168533
lambda[   6] =  -0.46324702517243
lambda[   7] =  -0.39728445543039
lambda[   8] =  -0.39073374522223
lambda[   9] =  -0.37232491827139
lambda[  10] =  -0.27381416894664
lambda[  11] =  -0.22517507261915
lambda[  12] =  -0.06850846039849
lambda[  13] =  -0.02849156835388
lambda[  14] =  -0.02709570917712
lambda[  15] =   0.01372343801778
lambda[  16] =   0.02241333120463
lambda[  17] =   0.02356458035725
lambda[  18] =   0.04208579865433
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 7.143 ms
rank =  0, Distributing orbital back into band + domain format took 15.459 ms
rank = 0, Subspace_Rotation used 22.619 ms

Total time for subspace rotation: 22.623 ms
rank = 0, Efermi =  -0.097563973403 calculate fermi energy took 1.554 ms
rank = 0, --- Calculate rho: sum over local bands took 4.098 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.883 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.301 ms
rank = 0, Calculating density took 1561.858 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.048 ms
rank = 0, D2D took 1.193 ms
rank = 0, Transfering density took 1.199 ms
Etot    =   -38.856582689397
Eband   =   -11.443182647576
E1      =    24.928067555719
E2      =   -10.639914206243
E3      =   -13.665210176529
Exc     =   -12.227019041617
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 1.813e-04, dEband = 1.383e-02
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -38.856582689, dEtot = 1.813e-04, dEband = 1.383e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0165829321728, which took 0.053 ms

iter_count = 114, r_2norm = 2.475e-05, tol*||rhs|| = 4.066e-05

Anderson update took 60.746 ms, out of which F'*F took 29.910 ms; b-Ax took 199.264 ms, out of which Lap took 178.560 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 423.071 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261889, int_b + int_rho = 5.821e-14, checking this took 0.098 ms
2-norm of RHS = 653.0064674238228, which took 0.283 ms

iter_count = 246, r_2norm = 6.045e-04, tol*||rhs|| = 6.530e-04

Anderson update took 132.795 ms, out of which F'*F took 61.676 ms; b-Ax took 419.677 ms, out of which Lap took 374.576 ms
Solving Poisson took 886.649 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.242221 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.181074 
Total time for convolution: 	 convolve: 5.190070 
Total time for convolution: 	 convolve: 5.307498 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 1.957 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.928 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.915 ms

This SCF took 27909.057 ms, scf error = 8.378e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.142086, lowerbound = -1.048525, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1458.367 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 15.649 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.371 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 19.053 ms
rank =  0, finding HY took 25.547 ms
rank =  0, distributing HY into block cyclic form took 15.779 ms
rank =  0, finding Y'*HY took 4.766 ms
Rank 0, Project_Hamiltonian used 65.179 ms
Total time for projection: 65.194 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.107 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -1.047729335087899
    last  calculated eigval = 0.035143253662206
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.90305453883140
lambda[   3] =  -0.68266425051715
lambda[   4] =  -0.49081244822152
lambda[   5] =  -0.46477655869934
lambda[   6] =  -0.46198733466701
lambda[   7] =  -0.39562385838302
lambda[   8] =  -0.38767218780404
lambda[   9] =  -0.36951360367429
lambda[  10] =  -0.27191892179590
lambda[  11] =  -0.22318741637007
lambda[  12] =  -0.06762282560289
lambda[  13] =  -0.02797465995160
lambda[  14] =  -0.02592800600436
lambda[  15] =   0.01293505239388
lambda[  16] =   0.02007437467355
lambda[  17] =   0.02344037995633
lambda[  18] =   0.03514325366221
==subpsace eigenproblem: bcast eigvals took 0.063 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 7.055 ms
rank =  0, Distributing orbital back into band + domain format took 15.519 ms
rank = 0, Subspace_Rotation used 22.589 ms

Total time for subspace rotation: 22.593 ms
rank = 0, Efermi =  -0.096678338589 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.247 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.605 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.314 ms
rank = 0, Calculating density took 1556.726 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.071 ms
rank = 0, D2D took 1.217 ms
rank = 0, Transfering density took 1.224 ms
Etot    =   -38.856215027338
Eband   =   -11.397880909633
E1      =    24.912937017072
E2      =   -10.605486996195
E3      =   -13.679580927357
Exc     =   -12.236766119635
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 5.252e-05, dEband = 6.472e-03
rank = 0, Calculating/Estimating energy took 0.899 ms, Etot = -38.856215027, dEtot = 5.252e-05, dEband = 6.472e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5642108907336, which took 0.055 ms

iter_count = 108, r_2norm = 1.891e-05, tol*||rhs|| = 2.257e-05

Anderson update took 57.627 ms, out of which F'*F took 27.116 ms; b-Ax took 184.886 ms, out of which Lap took 164.867 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.996 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261888, int_b + int_rho = 4.729e-14, checking this took 0.078 ms
2-norm of RHS = 653.3536337815556, which took 0.135 ms

iter_count = 240, r_2norm = 5.897e-04, tol*||rhs|| = 6.534e-04

Anderson update took 128.564 ms, out of which F'*F took 59.839 ms; b-Ax took 408.249 ms, out of which Lap took 363.833 ms
Solving Poisson took 863.745 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.386 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.228145 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.182461 
Total time for convolution: 	 convolve: 5.171793 
Total time for convolution: 	 convolve: 5.221853 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.140 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 2.017 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.937 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.993 ms

This SCF took 27717.698 ms, scf error = 3.756e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.135143, lowerbound = -1.047729, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1460.210 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.535 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.503 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 19.073 ms
rank =  0, finding HY took 25.200 ms
rank =  0, distributing HY into block cyclic form took 15.799 ms
rank =  0, finding Y'*HY took 4.579 ms
Rank 0, Project_Hamiltonian used 64.685 ms
Total time for projection: 64.701 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.200 ms
    first calculated eigval = -1.046615308289431
    last  calculated eigval = 0.030937779301225
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.90147598393835
lambda[   3] =  -0.67930459683953
lambda[   4] =  -0.48782215822926
lambda[   5] =  -0.46330952422084
lambda[   6] =  -0.46062312734503
lambda[   7] =  -0.39324280980978
lambda[   8] =  -0.38437118936394
lambda[   9] =  -0.36632032902410
lambda[  10] =  -0.27018092968675
lambda[  11] =  -0.22146750605883
lambda[  12] =  -0.06601452756686
lambda[  13] =  -0.02671082086767
lambda[  14] =  -0.02454481281564
lambda[  15] =   0.01391484025303
lambda[  16] =   0.01934920925575
lambda[  17] =   0.02431750053768
lambda[  18] =   0.03093777930122
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 7.196 ms
rank =  0, Distributing orbital back into band + domain format took 15.637 ms
rank = 0, Subspace_Rotation used 22.848 ms

Total time for subspace rotation: 22.852 ms
rank = 0, Efermi =  -0.095070040543 calculate fermi energy took 0.089 ms
rank = 0, --- Calculate rho: sum over local bands took 4.064 ms
rank = 0, --- Calculate rho: reduce over all band groups took 7.186 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.377 ms
rank = 0, Calculating density took 1559.792 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.927 ms
rank = 0, D2D took 1.042 ms
rank = 0, Transfering density took 1.047 ms
Etot    =   -38.856091438085
Eband   =   -11.349466927105
E1      =    24.892047618023
E2      =   -10.574837673250
E3      =   -13.689954205099
Exc     =   -12.243891068658
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 1.766e-05, dEband = 6.916e-03
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -38.856091438, dEtot = 1.766e-05, dEband = 6.916e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2752612850229, which took 0.053 ms

iter_count = 108, r_2norm = 1.027e-05, tol*||rhs|| = 1.101e-05

Anderson update took 58.036 ms, out of which F'*F took 27.036 ms; b-Ax took 184.063 ms, out of which Lap took 164.354 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.499 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261895, int_b + int_rho = 1.164e-13, checking this took 1.063 ms
2-norm of RHS = 653.4098278231735, which took 0.138 ms

iter_count = 222, r_2norm = 6.117e-04, tol*||rhs|| = 6.534e-04

Anderson update took 118.183 ms, out of which F'*F took 54.971 ms; b-Ax took 379.524 ms, out of which Lap took 336.515 ms
Solving Poisson took 799.578 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.287944 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.216398 
Total time for convolution: 	 convolve: 5.271200 
Total time for convolution: 	 convolve: 5.190862 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.214 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.441 ms
---Transfer Veff_loc: D2D took 2.059 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.975 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.076 ms

This SCF took 27827.860 ms, scf error = 1.859e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.130938, lowerbound = -1.046615, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1446.072 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.597 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.459 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.079 ms
rank =  0, finding HY took 25.453 ms
rank =  0, distributing HY into block cyclic form took 15.604 ms
rank =  0, finding Y'*HY took 4.810 ms
Rank 0, Project_Hamiltonian used 64.988 ms
Total time for projection: 65.011 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -1.045525957763126
    last  calculated eigval = 0.028938214044914
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.90013012549792
lambda[   3] =  -0.67735086593307
lambda[   4] =  -0.48594117826358
lambda[   5] =  -0.46207096259658
lambda[   6] =  -0.45945914343994
lambda[   7] =  -0.39238023200123
lambda[   8] =  -0.38266882692332
lambda[   9] =  -0.36468253128705
lambda[  10] =  -0.26878728283105
lambda[  11] =  -0.22029022394386
lambda[  12] =  -0.06496145105113
lambda[  13] =  -0.02539787779049
lambda[  14] =  -0.02351664817115
lambda[  15] =   0.01535471666897
lambda[  16] =   0.01954703490563
lambda[  17] =   0.02509781359258
lambda[  18] =   0.02893821404491
==subpsace eigenproblem: bcast eigvals took 0.041 ms
Total time for solving subspace eigenvalue problem: 0.227 ms
rank =  0, subspace rotation using ScaLAPACK took 6.990 ms
rank =  0, Distributing orbital back into band + domain format took 15.661 ms
rank = 0, Subspace_Rotation used 22.664 ms

Total time for subspace rotation: 22.669 ms
rank = 0, Efermi =  -0.094016964041 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.968 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.972 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.315 ms
rank = 0, Calculating density took 1544.358 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.044 ms
rank = 0, D2D took 1.157 ms
rank = 0, Transfering density took 1.159 ms
Etot    =   -38.856083103383
Eband   =   -11.318574662431
E1      =    24.875455023742
E2      =   -10.559075255314
E3      =   -13.695410300722
Exc     =   -12.247876082037
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 1.191e-06, dEband = 4.413e-03
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -38.856083103, dEtot = 1.191e-06, dEband = 4.413e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1430224691153, which took 0.101 ms

iter_count = 114, r_2norm = 3.591e-06, tol*||rhs|| = 5.721e-06

Anderson update took 61.698 ms, out of which F'*F took 28.759 ms; b-Ax took 193.850 ms, out of which Lap took 173.294 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.437 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261890, int_b + int_rho = 6.548e-14, checking this took 0.101 ms
2-norm of RHS = 653.3955992834510, which took 0.113 ms

iter_count = 210, r_2norm = 5.862e-04, tol*||rhs|| = 6.534e-04

Anderson update took 112.215 ms, out of which F'*F took 52.233 ms; b-Ax took 359.714 ms, out of which Lap took 319.464 ms
Solving Poisson took 757.767 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.208173 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.205946 
Total time for convolution: 	 convolve: 5.246213 
Total time for convolution: 	 convolve: 5.188950 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.422 ms
---Transfer Veff_loc: D2D took 2.021 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.014 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.067 ms

This SCF took 27692.490 ms, scf error = 1.129e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.128938, lowerbound = -1.045526, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1448.750 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.491 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.385 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 18.896 ms
rank =  0, finding HY took 25.422 ms
rank =  0, distributing HY into block cyclic form took 15.651 ms
rank =  0, finding Y'*HY took 4.714 ms
Rank 0, Project_Hamiltonian used 64.715 ms
Total time for projection: 64.728 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.080 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -1.044644738196610
    last  calculated eigval = 0.029282551433543
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.89933358358498
lambda[   3] =  -0.67652625132364
lambda[   4] =  -0.48512399986426
lambda[   5] =  -0.46126952300643
lambda[   6] =  -0.45869773820945
lambda[   7] =  -0.39127569643582
lambda[   8] =  -0.38178323281197
lambda[   9] =  -0.36369951159569
lambda[  10] =  -0.26803335921293
lambda[  11] =  -0.21951820339138
lambda[  12] =  -0.06395914397373
lambda[  13] =  -0.02375264703958
lambda[  14] =  -0.02268965240123
lambda[  15] =   0.01722717325821
lambda[  16] =   0.02078215746977
lambda[  17] =   0.02580196856562
lambda[  18] =   0.02928255143354
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.247 ms
rank =  0, subspace rotation using ScaLAPACK took 5.107 ms
rank =  0, Distributing orbital back into band + domain format took 17.531 ms
rank = 0, Subspace_Rotation used 22.653 ms

Total time for subspace rotation: 22.659 ms
rank = 0, Efermi =  -0.093014656985 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 4.056 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.831 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.305 ms
rank = 0, Calculating density took 1546.700 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.038 ms
rank = 0, D2D took 1.177 ms
rank = 0, Transfering density took 1.180 ms
Etot    =   -38.856105549449
Eband   =   -11.299811676713
E1      =    24.865431371018
E2      =   -10.549755522541
E3      =   -13.697706912958
Exc     =   -12.249614740559
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 3.207e-06, dEband = 2.680e-03
rank = 0, Calculating/Estimating energy took 1.671 ms, Etot = -38.856105549, dEtot = 3.207e-06, dEband = 2.680e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0960003639134, which took 0.108 ms

iter_count = 114, r_2norm = 2.449e-06, tol*||rhs|| = 3.840e-06

Anderson update took 61.165 ms, out of which F'*F took 29.048 ms; b-Ax took 194.616 ms, out of which Lap took 174.279 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.931 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261885, int_b + int_rho = 1.819e-14, checking this took 0.103 ms
2-norm of RHS = 653.3957784907392, which took 0.107 ms

iter_count = 198, r_2norm = 5.354e-04, tol*||rhs|| = 6.534e-04

Anderson update took 105.601 ms, out of which F'*F took 49.668 ms; b-Ax took 337.151 ms, out of which Lap took 300.254 ms
Solving Poisson took 712.523 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.101 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.217292 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 86.591 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.208094 
Total time for convolution: 	 convolve: 5.177802 
Total time for convolution: 	 convolve: 5.184682 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.407 ms
---Transfer Veff_loc: D2D took 1.966 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.950 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.946 ms

This SCF took 27647.075 ms, scf error = 6.390e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.129283, lowerbound = -1.044645, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1444.000 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.510 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.395 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 18.941 ms
rank =  0, finding HY took 25.359 ms
rank =  0, distributing HY into block cyclic form took 15.577 ms
rank =  0, finding Y'*HY took 4.754 ms
Rank 0, Project_Hamiltonian used 64.663 ms
Total time for projection: 64.677 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -1.044294693085572
    last  calculated eigval = 0.030024793986769
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.89885227984289
lambda[   3] =  -0.67584046873017
lambda[   4] =  -0.48442431302298
lambda[   5] =  -0.46082393404026
lambda[   6] =  -0.45828530362181
lambda[   7] =  -0.39093404292884
lambda[   8] =  -0.38116870109029
lambda[   9] =  -0.36309212338842
lambda[  10] =  -0.26745011368089
lambda[  11] =  -0.21900013005040
lambda[  12] =  -0.06355033553221
lambda[  13] =  -0.02240883957434
lambda[  14] =  -0.02229067111565
lambda[  15] =   0.01811224581559
lambda[  16] =   0.02164727560365
lambda[  17] =   0.02622202949305
lambda[  18] =   0.03002479398677
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 7.121 ms
rank =  0, Distributing orbital back into band + domain format took 15.674 ms
rank = 0, Subspace_Rotation used 22.813 ms

Total time for subspace rotation: 22.818 ms
rank = 0, Efermi =  -0.092605848494 calculate fermi energy took 0.093 ms
rank = 0, --- Calculate rho: sum over local bands took 3.980 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.718 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.407 ms
rank = 0, Calculating density took 1542.008 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.148 ms
rank = 0, D2D took 1.743 ms
rank = 0, Transfering density took 1.747 ms
Etot    =   -38.856145765054
Eband   =   -11.288332208402
E1      =    24.859729215533
E2      =   -10.543684754148
E3      =   -13.698853393553
Exc     =   -12.250507981191
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 5.745e-06, dEband = 1.640e-03
rank = 0, Calculating/Estimating energy took 0.897 ms, Etot = -38.856145765, dEtot = 5.745e-06, dEband = 1.640e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0548805911945, which took 0.054 ms

iter_count = 114, r_2norm = 1.658e-06, tol*||rhs|| = 2.195e-06

Anderson update took 61.016 ms, out of which F'*F took 29.029 ms; b-Ax took 195.045 ms, out of which Lap took 174.022 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.552 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261891, int_b + int_rho = 8.004e-14, checking this took 0.096 ms
2-norm of RHS = 653.3989197235346, which took 0.081 ms

iter_count = 186, r_2norm = 6.532e-04, tol*||rhs|| = 6.534e-04

Anderson update took 99.060 ms, out of which F'*F took 46.392 ms; b-Ax took 316.754 ms, out of which Lap took 282.578 ms
Solving Poisson took 670.174 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.178482 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 54.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.217293 
Total time for convolution: 	 convolve: 5.224127 
Total time for convolution: 	 convolve: 5.194773 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.424 ms
---Transfer Veff_loc: D2D took 1.980 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.971 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.984 ms

This SCF took 27583.084 ms, scf error = 4.999e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.130025, lowerbound = -1.044295, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1447.770 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.535 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.351 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 18.910 ms
rank =  0, finding HY took 25.299 ms
rank =  0, distributing HY into block cyclic form took 15.541 ms
rank =  0, finding Y'*HY took 4.793 ms
Rank 0, Project_Hamiltonian used 64.576 ms
Total time for projection: 64.587 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -1.043955741688176
    last  calculated eigval = 0.031051016114978
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.89853587638574
lambda[   3] =  -0.67538851788199
lambda[   4] =  -0.48401404881868
lambda[   5] =  -0.46046907871733
lambda[   6] =  -0.45794166126351
lambda[   7] =  -0.39052753402640
lambda[   8] =  -0.38069002142323
lambda[   9] =  -0.36260178646117
lambda[  10] =  -0.26715105148909
lambda[  11] =  -0.21868900737892
lambda[  12] =  -0.06315714094790
lambda[  13] =  -0.02194423199502
lambda[  14] =  -0.02085977905060
lambda[  15] =   0.01886969081849
lambda[  16] =   0.02281166798937
lambda[  17] =   0.02716797539617
lambda[  18] =   0.03105101611498
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.212 ms
rank =  0, subspace rotation using ScaLAPACK took 7.080 ms
rank =  0, Distributing orbital back into band + domain format took 15.500 ms
rank = 0, Subspace_Rotation used 22.615 ms

Total time for subspace rotation: 22.623 ms
rank = 0, Efermi =  -0.092212653948 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 3.836 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.016 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.299 ms
rank = 0, Calculating density took 1545.469 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.048 ms
rank = 0, D2D took 1.188 ms
rank = 0, Transfering density took 1.195 ms
Etot    =   -38.856190751767
Eband   =   -11.279928652497
E1      =    24.855854007925
E2      =   -10.539048230734
E3      =   -13.699278629487
Exc     =   -12.250870028721
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 6.427e-06, dEband = 1.201e-03
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -38.856190752, dEtot = 6.427e-06, dEband = 1.201e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0440148474647, which took 0.068 ms

iter_count = 114, r_2norm = 1.443e-06, tol*||rhs|| = 1.761e-06

Anderson update took 60.795 ms, out of which F'*F took 28.836 ms; b-Ax took 194.208 ms, out of which Lap took 173.475 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.912 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261888, int_b + int_rho = 4.729e-14, checking this took 0.118 ms
2-norm of RHS = 653.3989741759718, which took 0.079 ms

iter_count = 150, r_2norm = 5.642e-04, tol*||rhs|| = 6.534e-04

Anderson update took 79.884 ms, out of which F'*F took 37.898 ms; b-Ax took 257.835 ms, out of which Lap took 230.211 ms
Solving Poisson took 542.298 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.205443 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.239274 
Total time for convolution: 	 convolve: 5.173787 
Total time for convolution: 	 convolve: 5.184868 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.412 ms
---Transfer Veff_loc: D2D took 1.970 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.038 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.035 ms

This SCF took 27388.895 ms, scf error = 2.865e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.131051, lowerbound = -1.043956, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1449.363 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.447 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.411 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 18.892 ms
rank =  0, finding HY took 25.360 ms
rank =  0, distributing HY into block cyclic form took 15.553 ms
rank =  0, finding Y'*HY took 4.777 ms
Rank 0, Project_Hamiltonian used 64.616 ms
Total time for projection: 64.628 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -1.043765147500349
    last  calculated eigval = 0.031341095655871
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.89834302174763
lambda[   3] =  -0.67519552420056
lambda[   4] =  -0.48382960792087
lambda[   5] =  -0.46028775199793
lambda[   6] =  -0.45776054012787
lambda[   7] =  -0.39036554319996
lambda[   8] =  -0.38050756640276
lambda[   9] =  -0.36241657956997
lambda[  10] =  -0.26698474495992
lambda[  11] =  -0.21851895944908
lambda[  12] =  -0.06298753136998
lambda[  13] =  -0.02177392440150
lambda[  14] =  -0.02031431044333
lambda[  15] =   0.01897413186731
lambda[  16] =   0.02318304076527
lambda[  17] =   0.02723372441236
lambda[  18] =   0.03134109565587
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 7.115 ms
rank =  0, Distributing orbital back into band + domain format took 15.563 ms
rank = 0, Subspace_Rotation used 22.692 ms

Total time for subspace rotation: 22.697 ms
rank = 0, Efermi =  -0.092043044364 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.983 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.829 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.314 ms
rank = 0, Calculating density took 1547.156 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.055 ms
rank = 0, D2D took 1.204 ms
rank = 0, Transfering density took 1.208 ms
Etot    =   -38.856210589767
Eband   =   -11.275949975579
E1      =    24.853749593351
E2      =   -10.537084047401
E3      =   -13.699642739407
Exc     =   -12.251164055654
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 2.834e-06, dEband = 5.684e-04
rank = 0, Calculating/Estimating energy took 0.935 ms, Etot = -38.856210590, dEtot = 2.834e-06, dEband = 5.684e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0246489003425, which took 0.069 ms

iter_count = 114, r_2norm = 6.991e-07, tol*||rhs|| = 9.860e-07

Anderson update took 61.393 ms, out of which F'*F took 29.026 ms; b-Ax took 194.232 ms, out of which Lap took 173.926 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.320 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261895, int_b + int_rho = 1.164e-13, checking this took 0.099 ms
2-norm of RHS = 653.4040159538713, which took 0.147 ms

iter_count = 180, r_2norm = 5.449e-04, tol*||rhs|| = 6.534e-04

Anderson update took 95.751 ms, out of which F'*F took 45.095 ms; b-Ax took 307.396 ms, out of which Lap took 274.099 ms
Solving Poisson took 649.567 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.193712 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.180278 
Total time for convolution: 	 convolve: 5.185938 
Total time for convolution: 	 convolve: 5.206278 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.748 ms
---Transfer Veff_loc: D2D took 1.951 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.953 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.936 ms

This SCF took 27447.850 ms, scf error = 2.394e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.131341, lowerbound = -1.043765, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1445.132 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.846 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.260 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 19.144 ms
rank =  0, finding HY took 25.352 ms
rank =  0, distributing HY into block cyclic form took 15.644 ms
rank =  0, finding Y'*HY took 4.692 ms
Rank 0, Project_Hamiltonian used 64.867 ms
Total time for projection: 64.880 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -1.043229186087830
    last  calculated eigval = 0.032908328657889
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.89779690983524
lambda[   3] =  -0.67467680361274
lambda[   4] =  -0.48332639109489
lambda[   5] =  -0.45978162723642
lambda[   6] =  -0.45725366655291
lambda[   7] =  -0.38990641693709
lambda[   8] =  -0.38002156431097
lambda[   9] =  -0.36192273504381
lambda[  10] =  -0.26650672972830
lambda[  11] =  -0.21802924557621
lambda[  12] =  -0.06251584898947
lambda[  13] =  -0.02128889038900
lambda[  14] =  -0.01860026961400
lambda[  15] =   0.01968621300563
lambda[  16] =   0.02448403517367
lambda[  17] =   0.02853010270244
lambda[  18] =   0.03290832865789
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 7.190 ms
rank =  0, Distributing orbital back into band + domain format took 15.386 ms
rank = 0, Subspace_Rotation used 22.591 ms

Total time for subspace rotation: 22.596 ms
rank = 0, Efermi =  -0.091571361979 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 4.153 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.661 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.315 ms
rank = 0, Calculating density took 1543.100 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.054 ms
rank = 0, D2D took 1.202 ms
rank = 0, Transfering density took 1.209 ms
Etot    =   -38.856253599833
Eband   =   -11.264902553447
E1      =    24.847954490018
E2      =   -10.531573784903
E3      =   -13.700691550109
Exc     =   -12.251997932722
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 6.144e-06, dEband = 1.578e-03
rank = 0, Calculating/Estimating energy took 0.928 ms, Etot = -38.856253600, dEtot = 6.144e-06, dEband = 1.578e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0275472551367, which took 0.059 ms

iter_count = 108, r_2norm = 8.051e-07, tol*||rhs|| = 1.102e-06

Anderson update took 57.594 ms, out of which F'*F took 27.194 ms; b-Ax took 184.566 ms, out of which Lap took 165.055 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.923 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261882, int_b + int_rho = -7.276e-15, checking this took 0.103 ms
2-norm of RHS = 653.4123981693252, which took 0.076 ms

iter_count = 156, r_2norm = 6.404e-04, tol*||rhs|| = 6.534e-04

Anderson update took 82.807 ms, out of which F'*F took 38.983 ms; b-Ax took 266.018 ms, out of which Lap took 236.712 ms
Solving Poisson took 562.738 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.195903 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.180037 
Total time for convolution: 	 convolve: 5.211699 
Total time for convolution: 	 convolve: 5.201747 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 1.960 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.036 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.027 ms

This SCF took 27384.914 ms, scf error = 1.373e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.132908, lowerbound = -1.043229, upperbound = 267.575749

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1440.780 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.543 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.544 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.108 ms
rank =  0, finding HY took 25.257 ms
rank =  0, distributing HY into block cyclic form took 15.581 ms
rank =  0, finding Y'*HY took 4.828 ms
Rank 0, Project_Hamiltonian used 64.837 ms
Total time for projection: 64.852 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.100 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.271 ms
rank = 0, Solve_Generalized_EigenProblem used 1.377 ms
    first calculated eigval = -1.043006094378537
    last  calculated eigval = 0.034271895573084
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.89758185077225
lambda[   3] =  -0.67446483078357
lambda[   4] =  -0.48311009550529
lambda[   5] =  -0.45955320974921
lambda[   6] =  -0.45702974789020
lambda[   7] =  -0.38970756660868
lambda[   8] =  -0.37981779761284
lambda[   9] =  -0.36171805728948
lambda[  10] =  -0.26627633128235
lambda[  11] =  -0.21781148355369
lambda[  12] =  -0.06235308409577
lambda[  13] =  -0.02107797960370
lambda[  14] =  -0.01744492695435
lambda[  15] =   0.01942263911766
lambda[  16] =   0.02527144511712
lambda[  17] =   0.02932654242476
lambda[  18] =   0.03427189557308
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.393 ms
rank =  0, subspace rotation using ScaLAPACK took 7.125 ms
rank =  0, Distributing orbital back into band + domain format took 15.488 ms
rank = 0, Subspace_Rotation used 22.630 ms

Total time for subspace rotation: 22.635 ms
rank = 0, Efermi =  -0.091408597086 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.003 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.814 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.301 ms
rank = 0, Calculating density took 1539.914 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.052 ms
rank = 0, D2D took 1.199 ms
rank = 0, Transfering density took 1.207 ms
Etot    =   -38.856282235529
Eband   =   -11.260154132263
E1      =    24.845851209668
E2      =   -10.528862085379
E3      =   -13.700853181535
Exc     =   -12.252121641153
Esc     =   -64.419572938017
Entropy =    -0.000000000677
dE = 4.091e-06, dEband = 6.783e-04
rank = 0, Calculating/Estimating energy took 0.998 ms, Etot = -38.856282236, dEtot = 4.091e-06, dEband = 6.783e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0213999592201, which took 0.114 ms

iter_count = 108, r_2norm = 7.493e-07, tol*||rhs|| = 8.560e-07

Anderson update took 57.799 ms, out of which F'*F took 27.245 ms; b-Ax took 184.777 ms, out of which Lap took 165.414 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.561 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002261883, int_rho =  22.00000002261886, int_b + int_rho = 2.910e-14, checking this took 0.129 ms
2-norm of RHS = 653.4132397126232, which took 0.133 ms

iter_count = 102, r_2norm = 6.104e-04, tol*||rhs|| = 6.534e-04

Anderson update took 54.187 ms, out of which F'*F took 25.573 ms; b-Ax took 174.063 ms, out of which Lap took 155.226 ms
Solving Poisson took 369.135 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.184860 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.201996 
Total time for convolution: 	 convolve: 5.358309 
Total time for convolution: 	 convolve: 5.227196 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
---Transfer Veff_loc: D2D took 1.964 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.684 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.676 ms

This SCF took 27346.400 ms, scf error = 8.884e-05
The last 17 occupations of kpoints #1 are (Nelectron = 22):
lambda[   2] =  -0.89758185077225, occ[   2] =   2.00000000000000
lambda[   3] =  -0.67446483078357, occ[   3] =   2.00000000000000
lambda[   4] =  -0.48311009550529, occ[   4] =   2.00000000000000
lambda[   5] =  -0.45955320974921, occ[   5] =   2.00000000000000
lambda[   6] =  -0.45702974789020, occ[   6] =   2.00000000000000
lambda[   7] =  -0.38970756660868, occ[   7] =   2.00000000000000
lambda[   8] =  -0.37981779761284, occ[   8] =   2.00000000000000
lambda[   9] =  -0.36171805728948, occ[   9] =   2.00000000000000
lambda[  10] =  -0.26627633128235, occ[  10] =   2.00000000000000
lambda[  11] =  -0.21781148355369, occ[  11] =   2.00000000000000
lambda[  12] =  -0.06235308409577, occ[  12] =   0.00000002261891
lambda[  13] =  -0.02107797960370, occ[  13] =   0.00000000000000
lambda[  14] =  -0.01744492695435, occ[  14] =   0.00000000000000
lambda[  15] =   0.01942263911766, occ[  15] =   0.00000000000000
lambda[  16] =   0.02527144511712, occ[  16] =   0.00000000000000
lambda[  17] =   0.02932654242476, occ[  17] =   0.00000000000000
lambda[  18] =   0.03427189557308, occ[  18] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 16 (90%) = 0.000000000000000.
Occupation of state 18 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.510 ms, time for Allreduce/Reduce: 8.269 ms 
Time for calculating local force components: 18.361 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.03422896270812   0.03914838891223  -0.00000000683233
  0.02894825945244   0.00435344303540  -0.04129915863188
  0.02894824413649   0.00435342444058   0.04129910231164
  0.07870462970682   0.13550663798362  -0.00000046499742
 -0.93494027885654   0.33698898374468   0.00000120661800
  0.05601465737939   0.11271168972321   0.00000012495002
  0.55422172359353  -1.02825332486397  -0.00000103872790
force_loc = 
  0.03613742981615  -0.04202821719049  -0.00000028556215
 -0.03072875615386  -0.00467784374558   0.04384880647927
 -0.03072877033765  -0.00467871989481  -0.04384952021641
 -0.07112977606631  -0.13050354850766  -0.00000071243395
  0.90399467502084  -0.32725817837854   0.00000047541463
 -0.04025462962105  -0.12657655251618   0.00000068807349
 -0.54953274311288   1.02098294741339  -0.00000327276984
Time for calculating nonlocal force components: 36.917 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00399698150298  -0.00722742247297  -0.00000005406540
[0m[32m  0.02545339020080  -0.00674767566916  -0.00000001438771
[0m[32m -0.00617222393510   0.00436129497072   0.00000007875729
[0m[32m -0.01047651063694   0.01953459706017  -0.00000012502499
[0mTime for calculating XC forces components: 25.700 ms
 Cartesian force = 
  0.00187512762588  -0.00287838885607   0.00000030346918
 -0.00181383618357  -0.00032296128799   0.00255024371105
 -0.00181386568331  -0.00032385603204  -0.00254982204111
  0.00354453265538  -0.00222289357481  -0.00000063563310
 -0.00552555311704   0.00298456911918   0.00000226350859
  0.00955446434109  -0.00950212840005   0.00000148764446
 -0.00582086963843   0.01226565903179  -0.00000384065907
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.309 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.102 ms
Time for printing density: 397.351 ms
The program took 419.968 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:34
Job ID:        2266731
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:26:00,vmem=8284K,walltime=00:07:10,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-23-1
---------------------------------------
