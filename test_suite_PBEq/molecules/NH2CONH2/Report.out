---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:08
Job ID:    2266597
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:14
Job ID:    2266597
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.020 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 30.021 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 8.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 31.853 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 88.174 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.038 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.258 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   12.701379	
   10.469155	   13.723454	    9.990559	
   10.925947	   12.085105	    7.298621	
    9.530845	    6.276546	    9.990559	
    9.074053	    7.914895	    7.298621	
   10.000000	   10.000000	   10.405339	
   10.000000	   12.193687	    8.959003	
   10.000000	    7.806313	    8.959003	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.335 ms
Set up communicators.

--set up spincomm took 3.108 ms

--set up kptcomm took 0.365 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 19, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 19 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 19, mbQ = nbQ = 64
rank = 0, nr_Hp = 19, nc_Hp = 19
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.062 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.369 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.389 ms

Calculate_SplineDerivRadFun took 0.299 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.824 ms.
time spent on vectorized spline interp: 3.407 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.721 ms.
time spent on vectorized spline interp: 1.667 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.392 ms.
time spent on vectorized spline interp: 1.953 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.472 ms.
time spent on vectorized spline interp: 1.750 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.576 ms.

Calculating rb for all atom types took 21.789 ms
----------------------
Estimated memory usage
Total: 1.16 GB
orbitals             : 869.75 MB
global sized vectors : 213.62 MB
subspace matrices : 8.46 kB
others : 108.34 MB
----------------------------------------------
Estimated memory usage per processor: 99.31 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.904 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.024 ms
Calculating pseudocharge density ... 
the global sum of int_b = -24.0000000230792, sum_int_rho = 23.6000606859388
PosCharge = 24.000000023079, NegCharge = -23.600060685939, scal_fac = 1.016946538505
After scaling, int_rho = 24.0000000230792, PosCharge + NegCharge - NetCharge = -2.132e-14
--Calculate Vref took 0.497 ms
--Calculate rho_guess took 2.732 ms

 integral of b = -24.0000000230792,
 int{b} + Nelectron + NetCharge = -2.308e-08,
 Esc = -73.3198045644681,
 MPI_Reduce took 4.136 ms

Calculating b & b_ref took 13.845 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.062 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.129 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.078 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.554 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.006 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.007 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.007 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.579 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307911, int_b + int_rho = -1.055e-13, checking this took 0.182 ms
2-norm of RHS = 704.7900166519189, which took 0.483 ms

iter_count = 420, r_2norm = 5.904e-04, tol*||rhs|| = 7.048e-04

Anderson update took 265.610 ms, out of which F'*F took 121.674 ms; b-Ax took 817.237 ms, out of which Lap took 727.451 ms
Solving Poisson took 1842.050 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.496 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
Total time for convolution: 	 convolve: 5.112603 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 39.938 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
Total time for convolution: 	 convolve: 5.117590 
Total time for convolution: 	 convolve: 5.135120 
Total time for convolution: 	 convolve: 5.109288 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.712 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
rank = 0, XC calculation took 24398.331 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.590 ms
---Transfer Veff_loc: D2D took 5.625 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.480 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 17.226 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.157 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.874 ms
    Lanczos iter 54, eigmin  = -1.039969156, eigmax = 264.934478320, err_eigmin = 9.001e-04, err_eigmax = 9.685e-03
rank =   0, Lanczos took 137.366 ms, eigmin = -1.039969156090, eigmax = 267.583823103420

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.221927, lowerbound = -1.139969, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1635.545 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.208 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.878 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.107 ms
rank =  0, finding HY took 26.315 ms
rank =  0, distributing HY into block cyclic form took 22.955 ms
rank =  0, finding Y'*HY took 4.128 ms
Rank 0, Project_Hamiltonian used 78.530 ms
Total time for projection: 78.541 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.803 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.910 ms
    first calculated eigval = 2.734492470610827
    last  calculated eigval = 3.240893562716088
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =   2.80606395031702
lambda[   4] =   2.84736830953332
lambda[   5] =   2.86728920792479
lambda[   6] =   2.91455640682857
lambda[   7] =   2.91760215112312
lambda[   8] =   2.96981558514854
lambda[   9] =   2.98876662245182
lambda[  10] =   2.99675623273628
lambda[  11] =   3.01251959535288
lambda[  12] =   3.02887119361444
lambda[  13] =   3.08431051100023
lambda[  14] =   3.12648907053487
lambda[  15] =   3.14418502682484
lambda[  16] =   3.15714275953637
lambda[  17] =   3.18633131439086
lambda[  18] =   3.20107296749637
lambda[  19] =   3.24089356271609
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.924 ms
rank =  0, subspace rotation using ScaLAPACK took 8.336 ms
rank =  0, Distributing orbital back into band + domain format took 19.724 ms
rank = 0, Subspace_Rotation used 28.072 ms

Total time for subspace rotation: 28.075 ms
rank = 0, Efermi =   3.056703680585 calculate fermi energy took 0.053 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.340894, lowerbound = -1.139969, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1614.186 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 19.855 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.713 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.583 ms
rank =  0, finding HY took 25.976 ms
rank =  0, distributing HY into block cyclic form took 19.896 ms
rank =  0, finding Y'*HY took 3.791 ms
Rank 0, Project_Hamiltonian used 72.270 ms
Total time for projection: 72.273 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.152 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.705 ms
    first calculated eigval = -0.922525367425187
    last  calculated eigval = 0.455188123033981
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.71621294667690
lambda[   4] =  -0.34325870897971
lambda[   5] =  -0.24620949419628
lambda[   6] =  -0.19521492504595
lambda[   7] =  -0.13280949524034
lambda[   8] =  -0.05812616766622
lambda[   9] =   0.09001279985354
lambda[  10] =   0.20986952333976
lambda[  11] =   0.27766308254166
lambda[  12] =   0.31705144198205
lambda[  13] =   0.33798220810138
lambda[  14] =   0.35539538833383
lambda[  15] =   0.36432664033593
lambda[  16] =   0.37622346130636
lambda[  17] =   0.40795874565596
lambda[  18] =   0.41166999391263
lambda[  19] =   0.45518812303398
==subpsace eigenproblem: bcast eigvals took 0.036 ms
Total time for solving subspace eigenvalue problem: 0.744 ms
rank =  0, subspace rotation using ScaLAPACK took 8.512 ms
rank =  0, Distributing orbital back into band + domain format took 37.848 ms
rank = 0, Subspace_Rotation used 46.374 ms

Total time for subspace rotation: 46.383 ms
rank = 0, Efermi =   0.327516823601 calculate fermi energy took 0.022 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.555188, lowerbound = -1.139969, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1612.140 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 19.856 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.751 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.623 ms
rank =  0, finding HY took 25.802 ms
rank =  0, distributing HY into block cyclic form took 20.005 ms
rank =  0, finding Y'*HY took 3.811 ms
Rank 0, Project_Hamiltonian used 72.265 ms
Total time for projection: 72.269 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.180 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.282 ms
    first calculated eigval = -1.058015186137244
    last  calculated eigval = 0.132569311959882
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.91150708725462
lambda[   4] =  -0.64270906906405
lambda[   5] =  -0.58507048300517
lambda[   6] =  -0.57589852319561
lambda[   7] =  -0.51000904499969
lambda[   8] =  -0.46889667397566
lambda[   9] =  -0.43994515736329
lambda[  10] =  -0.32619598943517
lambda[  11] =  -0.28891626140047
lambda[  12] =  -0.20322725610855
lambda[  13] =   0.05422304620811
lambda[  14] =   0.08896773906928
lambda[  15] =   0.09224985123555
lambda[  16] =   0.10488443239577
lambda[  17] =   0.11305582791364
lambda[  18] =   0.12215152687768
lambda[  19] =   0.13256931195988
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.291 ms
rank =  0, subspace rotation using ScaLAPACK took 8.310 ms
rank =  0, Distributing orbital back into band + domain format took 19.415 ms
rank = 0, Subspace_Rotation used 27.737 ms

Total time for subspace rotation: 27.740 ms
rank = 0, Efermi =   0.025185717264 calculate fermi energy took 0.023 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.232569, lowerbound = -1.139969, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1613.667 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.068 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.665 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.749 ms
rank =  0, finding HY took 25.333 ms
rank =  0, distributing HY into block cyclic form took 19.857 ms
rank =  0, finding Y'*HY took 3.790 ms
Rank 0, Project_Hamiltonian used 72.781 ms
Total time for projection: 72.791 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.156 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.263 ms
    first calculated eigval = -1.058160231896876
    last  calculated eigval = 0.079745342173193
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.91202763123886
lambda[   4] =  -0.64501810610250
lambda[   5] =  -0.58829244577564
lambda[   6] =  -0.57961157705312
lambda[   7] =  -0.51447854456656
lambda[   8] =  -0.47695114893457
lambda[   9] =  -0.45612353632738
lambda[  10] =  -0.34832979645661
lambda[  11] =  -0.34496278076094
lambda[  12] =  -0.32376845517181
lambda[  13] =  -0.03126717775436
lambda[  14] =  -0.00332523986834
lambda[  15] =   0.03264961163740
lambda[  16] =   0.04636721485403
lambda[  17] =   0.05147105250177
lambda[  18] =   0.06197266330467
lambda[  19] =   0.07974534217319
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.271 ms
rank =  0, subspace rotation using ScaLAPACK took 8.333 ms
rank =  0, Distributing orbital back into band + domain format took 19.618 ms
rank = 0, Subspace_Rotation used 27.962 ms

Total time for subspace rotation: 27.966 ms
rank = 0, Efermi =  -0.060304506754 calculate fermi energy took 0.031 ms
rank = 0, --- Calculate rho: sum over local bands took 6.547 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.851 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 7062.616 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.941 ms
rank = 0, D2D took 2.049 ms
rank = 0, Transfering density took 2.051 ms
Etot    =   -45.831675774062
Eband   =   -14.389325792273
E1      =    28.089113111703
E2      =   -12.166922630889
E3      =   -15.045251382461
Exc     =   -13.423832541683
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 5.729e+00, dEband = 1.799e+00
rank = 0, Calculating/Estimating energy took 1.059 ms, Etot = -45.831675774, dEtot = 5.729e+00, dEband = 1.799e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 61.9579496571814, which took 0.633 ms

iter_count = 96, r_2norm = 1.522e-03, tol*||rhs|| = 2.478e-03

Anderson update took 58.047 ms, out of which F'*F took 27.470 ms; b-Ax took 190.706 ms, out of which Lap took 168.110 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 425.576 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307922, int_b + int_rho = 7.276e-15, checking this took 0.140 ms
2-norm of RHS = 699.7792106803768, which took 0.183 ms

iter_count = 282, r_2norm = 6.656e-04, tol*||rhs|| = 6.998e-04

Anderson update took 169.983 ms, out of which F'*F took 78.772 ms; b-Ax took 531.196 ms, out of which Lap took 476.342 ms
Solving Poisson took 1207.240 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.441 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.197709 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.186264 
Total time for convolution: 	 convolve: 5.162992 
Total time for convolution: 	 convolve: 5.159429 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.177 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 3.495 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.119 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.649 ms

This SCF took 33691.732 ms, scf error = 1.560e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.179745, lowerbound = -1.058160, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1611.749 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.945 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.757 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.720 ms
rank =  0, finding HY took 24.996 ms
rank =  0, distributing HY into block cyclic form took 22.257 ms
rank =  0, finding Y'*HY took 3.725 ms
Rank 0, Project_Hamiltonian used 73.728 ms
Total time for projection: 73.740 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.214 ms
    first calculated eigval = -1.027178841063397
    last  calculated eigval = 0.055492875266558
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.87304081696000
lambda[   4] =  -0.61458527513830
lambda[   5] =  -0.55669613445973
lambda[   6] =  -0.54463344014584
lambda[   7] =  -0.47992827752984
lambda[   8] =  -0.43803893933809
lambda[   9] =  -0.43231130402547
lambda[  10] =  -0.30753257408667
lambda[  11] =  -0.30602008084843
lambda[  12] =  -0.28383620824504
lambda[  13] =  -0.04489028246333
lambda[  14] =  -0.03435225453569
lambda[  15] =   0.01333691307658
lambda[  16] =   0.01734328003521
lambda[  17] =   0.03118030220066
lambda[  18] =   0.03850122572007
lambda[  19] =   0.05549287526656
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.227 ms
rank =  0, subspace rotation using ScaLAPACK took 8.669 ms
rank =  0, Distributing orbital back into band + domain format took 19.143 ms
rank = 0, Subspace_Rotation used 27.821 ms

Total time for subspace rotation: 27.825 ms
rank = 0, Efermi =  -0.073927612536 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 6.592 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.746 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.572 ms
rank = 0, Calculating density took 1732.566 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.916 ms
rank = 0, D2D took 2.011 ms
rank = 0, Transfering density took 2.013 ms
Etot    =   -45.761054515882
Eband   =   -13.548346341262
E1      =    27.398996314913
E2      =   -12.040274216921
E3      =   -15.265186999801
Exc     =   -13.597361141097
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 8.828e-03, dEband = 1.051e-01
rank = 0, Calculating/Estimating energy took 1.017 ms, Etot = -45.761054516, dEtot = 8.828e-03, dEband = 1.051e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 27.2162853524458, which took 0.150 ms

iter_count = 102, r_2norm = 6.702e-04, tol*||rhs|| = 1.089e-03

Anderson update took 62.432 ms, out of which F'*F took 28.199 ms; b-Ax took 193.192 ms, out of which Lap took 169.546 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 444.391 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307921, int_b + int_rho = -3.638e-15, checking this took 0.115 ms
2-norm of RHS = 696.3025215749446, which took 0.116 ms

iter_count = 288, r_2norm = 6.304e-04, tol*||rhs|| = 6.963e-04

Anderson update took 173.594 ms, out of which F'*F took 78.271 ms; b-Ax took 531.802 ms, out of which Lap took 471.237 ms
Solving Poisson took 1222.775 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.170926 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.160273 
Total time for convolution: 	 convolve: 5.163181 
Total time for convolution: 	 convolve: 5.180635 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.377 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 0.214 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.487 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.111 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.981 ms

This SCF took 28648.579 ms, scf error = 9.361e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.155493, lowerbound = -1.027179, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1593.884 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.968 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.883 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.865 ms
rank =  0, finding HY took 26.761 ms
rank =  0, distributing HY into block cyclic form took 20.711 ms
rank =  0, finding Y'*HY took 3.969 ms
Rank 0, Project_Hamiltonian used 74.334 ms
Total time for projection: 74.346 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.233 ms
    first calculated eigval = -0.993098907147168
    last  calculated eigval = 0.044685828936072
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.83189595827953
lambda[   4] =  -0.57960294153514
lambda[   5] =  -0.52137663870371
lambda[   6] =  -0.50827333581315
lambda[   7] =  -0.44282034033968
lambda[   8] =  -0.40586226052386
lambda[   9] =  -0.39948358833290
lambda[  10] =  -0.27085237292191
lambda[  11] =  -0.26483595773942
lambda[  12] =  -0.24535543277469
lambda[  13] =  -0.04046744064821
lambda[  14] =  -0.02958075233469
lambda[  15] =   0.00715209650104
lambda[  16] =   0.01047392210967
lambda[  17] =   0.02467681128540
lambda[  18] =   0.03223803664329
lambda[  19] =   0.04468582893607
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 8.753 ms
rank =  0, Distributing orbital back into band + domain format took 19.312 ms
rank = 0, Subspace_Rotation used 28.078 ms

Total time for subspace rotation: 28.082 ms
rank = 0, Efermi =  -0.069504770291 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 6.843 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.489 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.570 ms
rank = 0, Calculating density took 1715.567 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.917 ms
rank = 0, D2D took 2.023 ms
rank = 0, Transfering density took 2.030 ms
Etot    =   -45.731996994378
Eband   =   -12.670312647472
E1      =    26.704841452002
E2      =   -11.834981161168
E3      =   -15.503230927207
Exc     =   -13.784933322125
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 3.632e-03, dEband = 1.098e-01
rank = 0, Calculating/Estimating energy took 1.058 ms, Etot = -45.731996994, dEtot = 3.632e-03, dEband = 1.098e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.4828247588446, which took 0.618 ms

iter_count = 102, r_2norm = 2.576e-04, tol*||rhs|| = 2.993e-04

Anderson update took 62.270 ms, out of which F'*F took 27.848 ms; b-Ax took 194.043 ms, out of which Lap took 171.101 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 446.107 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307926, int_b + int_rho = 5.093e-14, checking this took 0.076 ms
2-norm of RHS = 697.2277872894011, which took 0.204 ms

iter_count = 282, r_2norm = 6.037e-04, tol*||rhs|| = 6.972e-04

Anderson update took 171.817 ms, out of which F'*F took 80.056 ms; b-Ax took 534.802 ms, out of which Lap took 475.517 ms
Solving Poisson took 1188.870 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.168825 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.621 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.170366 
Total time for convolution: 	 convolve: 5.166741 
Total time for convolution: 	 convolve: 5.168863 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.382 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.139 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.706 ms
---Transfer Veff_loc: D2D took 4.271 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.108 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.777 ms

This SCF took 28068.559 ms, scf error = 4.606e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.144686, lowerbound = -0.993099, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1609.100 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.984 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.795 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.799 ms
rank =  0, finding HY took 25.129 ms
rank =  0, distributing HY into block cyclic form took 19.909 ms
rank =  0, finding Y'*HY took 3.879 ms
Rank 0, Project_Hamiltonian used 71.743 ms
Total time for projection: 71.753 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.973507509851225
    last  calculated eigval = 0.039408184045178
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.81522105960902
lambda[   4] =  -0.56153612587151
lambda[   5] =  -0.50363072559654
lambda[   6] =  -0.49258118848008
lambda[   7] =  -0.42612381791602
lambda[   8] =  -0.38975665068313
lambda[   9] =  -0.38110905796835
lambda[  10] =  -0.25817112668163
lambda[  11] =  -0.25217237820929
lambda[  12] =  -0.23093190883113
lambda[  13] =  -0.04090896659935
lambda[  14] =  -0.01684043483297
lambda[  15] =   0.00470216190160
lambda[  16] =   0.01087834948096
lambda[  17] =   0.02164594964382
lambda[  18] =   0.03109390657580
lambda[  19] =   0.03940818404518
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 8.671 ms
rank =  0, Distributing orbital back into band + domain format took 19.234 ms
rank = 0, Subspace_Rotation used 27.916 ms

Total time for subspace rotation: 27.920 ms
rank = 0, Efermi =  -0.069946295652 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 6.893 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.009 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.319 ms
rank = 0, Calculating density took 1729.383 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.090 ms
rank = 0, D2D took 2.186 ms
rank = 0, Transfering density took 2.190 ms
Etot    =   -45.726406385481
Eband   =   -12.278686500633
E1      =    26.460486083111
E2      =   -11.669681642776
E3      =   -15.605979047189
Exc     =   -13.864062092766
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 6.988e-04, dEband = 4.895e-02
rank = 0, Calculating/Estimating energy took 1.004 ms, Etot = -45.726406385, dEtot = 6.988e-04, dEband = 4.895e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.5031563129486, which took 0.157 ms

iter_count = 108, r_2norm = 7.905e-05, tol*||rhs|| = 1.001e-04

Anderson update took 66.731 ms, out of which F'*F took 30.067 ms; b-Ax took 204.935 ms, out of which Lap took 181.407 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.713 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307924, int_b + int_rho = 2.547e-14, checking this took 0.150 ms
2-norm of RHS = 697.5518941874531, which took 0.157 ms

iter_count = 258, r_2norm = 6.811e-04, tol*||rhs|| = 6.976e-04

Anderson update took 940.070 ms, out of which F'*F took 352.912 ms; b-Ax took 1827.412 ms, out of which Lap took 1697.933 ms
Solving Poisson took 3518.891 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.171572 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.162426 
Total time for convolution: 	 convolve: 5.160462 
Total time for convolution: 	 convolve: 5.169331 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.007 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.376 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.732 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 3.423 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.497 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.959 ms

This SCF took 30577.148 ms, scf error = 1.271e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.139408, lowerbound = -0.973508, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1603.312 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.938 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.748 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.703 ms
rank =  0, finding HY took 25.133 ms
rank =  0, distributing HY into block cyclic form took 19.967 ms
rank =  0, finding Y'*HY took 4.166 ms
Rank 0, Project_Hamiltonian used 71.996 ms
Total time for projection: 72.008 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.203 ms
    first calculated eigval = -0.965823888433970
    last  calculated eigval = 0.036367198564848
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.80955211192522
lambda[   4] =  -0.55595892434622
lambda[   5] =  -0.49794909418665
lambda[   6] =  -0.48666833094965
lambda[   7] =  -0.42057560527514
lambda[   8] =  -0.38420866208628
lambda[   9] =  -0.37212398651516
lambda[  10] =  -0.25118765772081
lambda[  11] =  -0.24735642455697
lambda[  12] =  -0.22293446009648
lambda[  13] =  -0.04088524075136
lambda[  14] =  -0.01386877610108
lambda[  15] =   0.00386043133693
lambda[  16] =   0.01145510474654
lambda[  17] =   0.01980070296525
lambda[  18] =   0.03082566591492
lambda[  19] =   0.03636719856485
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 8.705 ms
rank =  0, Distributing orbital back into band + domain format took 19.093 ms
rank = 0, Subspace_Rotation used 27.808 ms

Total time for subspace rotation: 27.813 ms
rank = 0, Efermi =  -0.069922569852 calculate fermi energy took 0.727 ms
rank = 0, --- Calculate rho: sum over local bands took 6.591 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.707 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.604 ms
rank = 0, Calculating density took 1723.057 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.928 ms
rank = 0, D2D took 2.033 ms
rank = 0, Transfering density took 2.036 ms
Etot    =   -45.725307407069
Eband   =   -12.125261826812
E1      =    26.371493924356
E2      =   -11.596296231388
E3      =   -15.646593824230
Exc     =   -13.894624995073
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 1.374e-04, dEband = 1.918e-02
rank = 0, Calculating/Estimating energy took 1.027 ms, Etot = -45.725307407, dEtot = 1.374e-04, dEband = 1.918e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.5322277026341, which took 0.092 ms

iter_count = 108, r_2norm = 4.799e-05, tol*||rhs|| = 6.129e-05

Anderson update took 66.864 ms, out of which F'*F took 30.405 ms; b-Ax took 204.485 ms, out of which Lap took 182.210 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 473.624 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307919, int_b + int_rho = -2.547e-14, checking this took 0.135 ms
2-norm of RHS = 697.9853840795433, which took 0.225 ms

iter_count = 246, r_2norm = 5.684e-04, tol*||rhs|| = 6.980e-04

Anderson update took 146.664 ms, out of which F'*F took 68.820 ms; b-Ax took 469.145 ms, out of which Lap took 417.737 ms
Solving Poisson took 1045.421 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.160799 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.472 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Total time for convolution: 	 convolve: 5.172209 
Total time for convolution: 	 convolve: 5.173831 
Total time for convolution: 	 convolve: 5.161109 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.392 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.701 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.581 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.554 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.168 ms

This SCF took 27934.850 ms, scf error = 6.609e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.136367, lowerbound = -0.965824, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1606.666 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.905 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.769 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.695 ms
rank =  0, finding HY took 25.015 ms
rank =  0, distributing HY into block cyclic form took 20.115 ms
rank =  0, finding Y'*HY took 3.838 ms
Rank 0, Project_Hamiltonian used 71.687 ms
Total time for projection: 71.697 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -0.964494400679512
    last  calculated eigval = 0.034625839917262
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.80899393479033
lambda[   4] =  -0.55540404280895
lambda[   5] =  -0.49729119680623
lambda[   6] =  -0.48583012112182
lambda[   7] =  -0.42000647137913
lambda[   8] =  -0.38300620232198
lambda[   9] =  -0.37021264405289
lambda[  10] =  -0.24962964476309
lambda[  11] =  -0.24682320316657
lambda[  12] =  -0.22122237100965
lambda[  13] =  -0.04104242378399
lambda[  14] =  -0.01367390478327
lambda[  15] =   0.00346203093472
lambda[  16] =   0.01119282130800
lambda[  17] =   0.01864813811970
lambda[  18] =   0.03046924041406
lambda[  19] =   0.03462583991726
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 0.269 ms
rank =  0, subspace rotation using ScaLAPACK took 8.637 ms
rank =  0, Distributing orbital back into band + domain format took 19.106 ms
rank = 0, Subspace_Rotation used 27.754 ms

Total time for subspace rotation: 27.758 ms
rank = 0, Efermi =  -0.070079752819 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 6.872 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.610 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.574 ms
rank = 0, Calculating density took 1725.939 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.515 ms
rank = 0, D2D took 2.616 ms
rank = 0, Transfering density took 2.618 ms
Etot    =   -45.725095100531
Eband   =   -12.100737787279
E1      =    26.376056937273
E2      =   -11.566398554589
E3      =   -15.646193155954
Exc     =   -13.893201395909
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 2.654e-05, dEband = 3.066e-03
rank = 0, Calculating/Estimating energy took 1.048 ms, Etot = -45.725095101, dEtot = 2.654e-05, dEband = 3.066e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5744263451646, which took 0.143 ms

iter_count = 108, r_2norm = 2.292e-05, tol*||rhs|| = 2.298e-05

Anderson update took 67.023 ms, out of which F'*F took 31.239 ms; b-Ax took 209.574 ms, out of which Lap took 186.663 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 472.809 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307923, int_b + int_rho = 1.819e-14, checking this took 0.128 ms
2-norm of RHS = 698.2073791066894, which took 0.129 ms

iter_count = 240, r_2norm = 6.905e-04, tol*||rhs|| = 6.982e-04

Anderson update took 147.055 ms, out of which F'*F took 68.808 ms; b-Ax took 467.339 ms, out of which Lap took 415.116 ms
Solving Poisson took 1025.689 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.165797 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 995.441 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.161391 
Total time for convolution: 	 convolve: 5.165083 
Total time for convolution: 	 convolve: 5.168536 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.407 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.058 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
---Transfer Veff_loc: D2D took 3.559 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.051 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.646 ms

This SCF took 29055.185 ms, scf error = 3.737e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.134626, lowerbound = -0.964494, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1607.947 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.909 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.775 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.703 ms
rank =  0, finding HY took 25.115 ms
rank =  0, distributing HY into block cyclic form took 19.849 ms
rank =  0, finding Y'*HY took 3.885 ms
Rank 0, Project_Hamiltonian used 71.584 ms
Total time for projection: 71.596 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -0.961408853313190
    last  calculated eigval = 0.034333246104748
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.80616285214667
lambda[   4] =  -0.55282407152548
lambda[   5] =  -0.49464232346797
lambda[   6] =  -0.48318717788728
lambda[   7] =  -0.41743475176053
lambda[   8] =  -0.38013378002184
lambda[   9] =  -0.36673519293337
lambda[  10] =  -0.24648420091838
lambda[  11] =  -0.24400294034346
lambda[  12] =  -0.21797163262171
lambda[  13] =  -0.04097028351155
lambda[  14] =  -0.01268774122691
lambda[  15] =   0.00337585973551
lambda[  16] =   0.01201276189756
lambda[  17] =   0.01797356064804
lambda[  18] =   0.03051371263171
lambda[  19] =   0.03433324610475
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 8.677 ms
rank =  0, Distributing orbital back into band + domain format took 19.165 ms
rank = 0, Subspace_Rotation used 28.218 ms

Total time for subspace rotation: 28.223 ms
rank = 0, Efermi =  -0.070007612629 calculate fermi energy took 0.117 ms
rank = 0, --- Calculate rho: sum over local bands took 6.895 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.552 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1727.219 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.931 ms
rank = 0, D2D took 2.040 ms
rank = 0, Transfering density took 2.045 ms
Etot    =   -45.724847069866
Eband   =   -12.031068595419
E1      =    26.345668752608
E2      =   -11.524248906536
E3      =   -15.656036330765
Exc     =   -13.899927899197
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 3.100e-05, dEband = 8.709e-03
rank = 0, Calculating/Estimating energy took 1.034 ms, Etot = -45.724847070, dEtot = 3.100e-05, dEband = 8.709e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2932750623007, which took 0.073 ms

iter_count = 108, r_2norm = 1.153e-05, tol*||rhs|| = 1.173e-05

Anderson update took 65.968 ms, out of which F'*F took 30.541 ms; b-Ax took 204.542 ms, out of which Lap took 181.690 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 469.706 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307921, int_b + int_rho = 0.000e+00, checking this took 0.131 ms
2-norm of RHS = 698.1987722352510, which took 0.144 ms

iter_count = 240, r_2norm = 6.376e-04, tol*||rhs|| = 6.982e-04

Anderson update took 145.224 ms, out of which F'*F took 69.451 ms; b-Ax took 477.986 ms, out of which Lap took 427.050 ms
Solving Poisson took 1038.977 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.160632 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.582 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.165890 
Total time for convolution: 	 convolve: 5.185950 
Total time for convolution: 	 convolve: 5.170405 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.630 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.466 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.056 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.557 ms

This SCF took 28060.733 ms, scf error = 2.029e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.134333, lowerbound = -0.961409, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1606.825 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.881 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.770 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.668 ms
rank =  0, finding HY took 25.225 ms
rank =  0, distributing HY into block cyclic form took 19.915 ms
rank =  0, finding Y'*HY took 3.836 ms
Rank 0, Project_Hamiltonian used 71.673 ms
Total time for projection: 71.686 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -0.957534379652367
    last  calculated eigval = 0.035199696033420
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.80358535187817
lambda[   4] =  -0.55018319781174
lambda[   5] =  -0.49201528455191
lambda[   6] =  -0.48082879459610
lambda[   7] =  -0.41503805822528
lambda[   8] =  -0.37673989147729
lambda[   9] =  -0.36276759331511
lambda[  10] =  -0.24310171193452
lambda[  11] =  -0.24144581245915
lambda[  12] =  -0.21433613622065
lambda[  13] =  -0.04015388222023
lambda[  14] =  -0.01097938223656
lambda[  15] =   0.00410096236381
lambda[  16] =   0.01390617216977
lambda[  17] =   0.01806797937368
lambda[  18] =   0.03073856953566
lambda[  19] =   0.03519969603342
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 9.127 ms
rank =  0, Distributing orbital back into band + domain format took 19.083 ms
rank = 0, Subspace_Rotation used 28.222 ms

Total time for subspace rotation: 28.228 ms
rank = 0, Efermi =  -0.069191211301 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 6.967 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.482 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.588 ms
rank = 0, Calculating density took 1726.566 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.943 ms
rank = 0, D2D took 2.046 ms
rank = 0, Transfering density took 2.051 ms
Etot    =   -45.724896422425
Eband   =   -11.958198751915
E1      =    26.308669278364
E2      =   -11.486420437690
E3      =   -15.662905201884
Exc     =   -13.904888023289
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 6.169e-06, dEband = 9.109e-03
rank = 0, Calculating/Estimating energy took 1.027 ms, Etot = -45.724896422, dEtot = 6.169e-06, dEband = 9.109e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2270062355044, which took 0.111 ms

iter_count = 114, r_2norm = 5.765e-06, tol*||rhs|| = 9.080e-06

Anderson update took 69.215 ms, out of which F'*F took 32.165 ms; b-Ax took 215.726 ms, out of which Lap took 191.847 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 503.723 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307917, int_b + int_rho = -4.002e-14, checking this took 0.108 ms
2-norm of RHS = 698.2179612402067, which took 0.130 ms

iter_count = 210, r_2norm = 6.131e-04, tol*||rhs|| = 6.982e-04

Anderson update took 128.568 ms, out of which F'*F took 62.502 ms; b-Ax took 414.068 ms, out of which Lap took 368.232 ms
Solving Poisson took 910.318 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.159880 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.253 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.185704 
Total time for convolution: 	 convolve: 5.165536 
Total time for convolution: 	 convolve: 5.171051 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.097 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.155 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.734 ms
---Transfer Veff_loc: D2D took 3.564 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.352 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.953 ms

This SCF took 27855.191 ms, scf error = 1.044e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.135200, lowerbound = -0.957534, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1621.848 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.014 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.781 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.815 ms
rank =  0, finding HY took 25.109 ms
rank =  0, distributing HY into block cyclic form took 20.109 ms
rank =  0, finding Y'*HY took 3.832 ms
Rank 0, Project_Hamiltonian used 71.891 ms
Total time for projection: 71.906 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -0.956441827412322
    last  calculated eigval = 0.035315639095924
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.80276435347646
lambda[   4] =  -0.54933587279560
lambda[   5] =  -0.49115882109253
lambda[   6] =  -0.48000487198737
lambda[   7] =  -0.41421799192928
lambda[   8] =  -0.37575211572655
lambda[   9] =  -0.36164981440460
lambda[  10] =  -0.24214083091701
lambda[  11] =  -0.24068272441622
lambda[  12] =  -0.21330882182333
lambda[  13] =  -0.03925685718698
lambda[  14] =  -0.01000966286169
lambda[  15] =   0.00516430448087
lambda[  16] =   0.01466947997569
lambda[  17] =   0.01829482667441
lambda[  18] =   0.03074282629979
lambda[  19] =   0.03531563909592
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.245 ms
rank =  0, subspace rotation using ScaLAPACK took 8.656 ms
rank =  0, Distributing orbital back into band + domain format took 19.414 ms
rank = 0, Subspace_Rotation used 28.083 ms

Total time for subspace rotation: 28.088 ms
rank = 0, Efermi =  -0.068294186120 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 6.644 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.882 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1741.334 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.929 ms
rank = 0, D2D took 2.026 ms
rank = 0, Transfering density took 2.028 ms
Etot    =   -45.724950423278
Eband   =   -11.936159733873
E1      =    26.298182292268
E2      =   -11.474371809923
E3      =   -15.664656769955
Exc     =   -13.906196996393
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 6.750e-06, dEband = 2.755e-03
rank = 0, Calculating/Estimating energy took 1.030 ms, Etot = -45.724950423, dEtot = 6.750e-06, dEband = 2.755e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1189956241329, which took 0.126 ms

iter_count = 108, r_2norm = 4.312e-06, tol*||rhs|| = 4.760e-06

Anderson update took 68.154 ms, out of which F'*F took 32.018 ms; b-Ax took 212.964 ms, out of which Lap took 190.975 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.982 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307920, int_b + int_rho = -1.455e-14, checking this took 0.124 ms
2-norm of RHS = 698.1962567711491, which took 0.170 ms

iter_count = 216, r_2norm = 6.695e-04, tol*||rhs|| = 6.982e-04

Anderson update took 132.741 ms, out of which F'*F took 61.908 ms; b-Ax took 425.416 ms, out of which Lap took 375.226 ms
Solving Poisson took 933.903 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.130 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.179174 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.162051 
Total time for convolution: 	 convolve: 5.168382 
Total time for convolution: 	 convolve: 5.172105 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.776 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.705 ms
---Transfer Veff_loc: D2D took 3.511 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.061 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.605 ms

This SCF took 27859.224 ms, scf error = 7.979e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.135316, lowerbound = -0.956442, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1598.758 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.956 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.733 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.707 ms
rank =  0, finding HY took 25.166 ms
rank =  0, distributing HY into block cyclic form took 19.936 ms
rank =  0, finding Y'*HY took 4.033 ms
Rank 0, Project_Hamiltonian used 72.688 ms
Total time for projection: 72.702 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -0.955092336249701
    last  calculated eigval = 0.036409954696565
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.80154493693558
lambda[   4] =  -0.54815849773768
lambda[   5] =  -0.48995428184651
lambda[   6] =  -0.47878063509799
lambda[   7] =  -0.41300937078308
lambda[   8] =  -0.37443650983450
lambda[   9] =  -0.36027588729414
lambda[  10] =  -0.24078216048570
lambda[  11] =  -0.23946197602283
lambda[  12] =  -0.21193226863310
lambda[  13] =  -0.03569474415720
lambda[  14] =  -0.00704200824164
lambda[  15] =   0.01001031139991
lambda[  16] =   0.01702184809303
lambda[  17] =   0.01984099924263
lambda[  18] =   0.03173676614986
lambda[  19] =   0.03640995469657
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 8.694 ms
rank =  0, Distributing orbital back into band + domain format took 19.066 ms
rank = 0, Subspace_Rotation used 27.770 ms

Total time for subspace rotation: 27.775 ms
rank = 0, Efermi =  -0.064732073161 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 6.770 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.765 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 1718.726 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.950 ms
rank = 0, D2D took 2.053 ms
rank = 0, Transfering density took 2.060 ms
Etot    =   -45.725061176797
Eband   =   -11.905599830918
E1      =    26.283369367535
E2      =   -11.458435668519
E3      =   -15.665517308867
Exc     =   -13.906979125641
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 1.384e-05, dEband = 3.820e-03
rank = 0, Calculating/Estimating energy took 1.034 ms, Etot = -45.725061177, dEtot = 1.384e-05, dEband = 3.820e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0942481646964, which took 0.070 ms

iter_count = 108, r_2norm = 3.378e-06, tol*||rhs|| = 3.770e-06

Anderson update took 65.598 ms, out of which F'*F took 31.732 ms; b-Ax took 215.148 ms, out of which Lap took 192.778 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.239 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307918, int_b + int_rho = -2.910e-14, checking this took 0.115 ms
2-norm of RHS = 698.2106189772132, which took 0.184 ms

iter_count = 198, r_2norm = 5.709e-04, tol*||rhs|| = 6.982e-04

Anderson update took 121.246 ms, out of which F'*F took 57.583 ms; b-Ax took 385.023 ms, out of which Lap took 343.485 ms
Solving Poisson took 860.708 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.159430 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.178095 
Total time for convolution: 	 convolve: 5.172644 
Total time for convolution: 	 convolve: 5.163709 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.710 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.377 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.015 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.511 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.038 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.585 ms

This SCF took 27754.365 ms, scf error = 4.259e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.136410, lowerbound = -0.955092, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1607.718 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.094 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.746 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.859 ms
rank =  0, finding HY took 25.174 ms
rank =  0, distributing HY into block cyclic form took 20.266 ms
rank =  0, finding Y'*HY took 3.817 ms
Rank 0, Project_Hamiltonian used 72.823 ms
Total time for projection: 72.840 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.954138021007008
    last  calculated eigval = 0.036977328128822
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.80062235406796
lambda[   4] =  -0.54726307376144
lambda[   5] =  -0.48905713707519
lambda[   6] =  -0.47789962814760
lambda[   7] =  -0.41211977493155
lambda[   8] =  -0.37351264577623
lambda[   9] =  -0.35935769505217
lambda[  10] =  -0.23986434055271
lambda[  11] =  -0.23857796253986
lambda[  12] =  -0.21101217646344
lambda[  13] =  -0.03333791405436
lambda[  14] =  -0.00512980547438
lambda[  15] =   0.01382673081484
lambda[  16] =   0.01851863062496
lambda[  17] =   0.02083875490024
lambda[  18] =   0.03212127489084
lambda[  19] =   0.03697732812882
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 8.627 ms
rank =  0, Distributing orbital back into band + domain format took 19.076 ms
rank = 0, Subspace_Rotation used 27.714 ms

Total time for subspace rotation: 27.719 ms
rank = 0, Efermi =  -0.062375243055 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 6.731 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.609 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.585 ms
rank = 0, Calculating density took 1727.620 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.938 ms
rank = 0, D2D took 2.051 ms
rank = 0, Transfering density took 2.057 ms
Etot    =   -45.725159449586
Eband   =   -11.883711736260
E1      =    26.272164928543
E2      =   -11.447236988444
E3      =   -15.667491251295
Exc     =   -13.908536316450
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 1.228e-05, dEband = 2.736e-03
rank = 0, Calculating/Estimating energy took 1.037 ms, Etot = -45.725159450, dEtot = 1.228e-05, dEband = 2.736e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0884973901678, which took 0.057 ms

iter_count = 108, r_2norm = 2.403e-06, tol*||rhs|| = 3.540e-06

Anderson update took 66.565 ms, out of which F'*F took 31.809 ms; b-Ax took 214.201 ms, out of which Lap took 191.422 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.637 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307917, int_b + int_rho = -4.366e-14, checking this took 0.157 ms
2-norm of RHS = 698.2229457040866, which took 0.167 ms

iter_count = 174, r_2norm = 6.565e-04, tol*||rhs|| = 6.982e-04

Anderson update took 110.580 ms, out of which F'*F took 49.871 ms; b-Ax took 341.038 ms, out of which Lap took 301.964 ms
Solving Poisson took 759.100 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 5.175620 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.170808 
Total time for convolution: 	 convolve: 5.172674 
Total time for convolution: 	 convolve: 5.163244 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.781 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 3.502 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.403 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.432 ms

This SCF took 27703.843 ms, scf error = 2.757e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.136977, lowerbound = -0.954138, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1598.774 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.042 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.713 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.773 ms
rank =  0, finding HY took 25.151 ms
rank =  0, distributing HY into block cyclic form took 19.874 ms
rank =  0, finding Y'*HY took 3.853 ms
Rank 0, Project_Hamiltonian used 71.677 ms
Total time for projection: 71.688 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -0.953837169032848
    last  calculated eigval = 0.037866473610097
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.80031688484335
lambda[   4] =  -0.54695226723867
lambda[   5] =  -0.48874661097922
lambda[   6] =  -0.47759071643591
lambda[   7] =  -0.41181233651404
lambda[   8] =  -0.37318884210087
lambda[   9] =  -0.35909139335707
lambda[  10] =  -0.23957032124403
lambda[  11] =  -0.23828756570060
lambda[  12] =  -0.21073361577115
lambda[  13] =  -0.03136501244557
lambda[  14] =  -0.00398432933814
lambda[  15] =   0.01674340615159
lambda[  16] =   0.01948634886828
lambda[  17] =   0.02244173120945
lambda[  18] =   0.03253667558840
lambda[  19] =   0.03786647361010
==subpsace eigenproblem: bcast eigvals took 0.062 ms
Total time for solving subspace eigenvalue problem: 0.278 ms
rank =  0, subspace rotation using ScaLAPACK took 8.657 ms
rank =  0, Distributing orbital back into band + domain format took 19.070 ms
rank = 0, Subspace_Rotation used 27.739 ms

Total time for subspace rotation: 27.744 ms
rank = 0, Efermi =  -0.060402341542 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 6.782 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.826 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.573 ms
rank = 0, Calculating density took 1717.779 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.927 ms
rank = 0, D2D took 2.023 ms
rank = 0, Transfering density took 2.025 ms
Etot    =   -45.725210288756
Eband   =   -11.876502266259
E1      =    26.269032295975
E2      =   -11.443127211377
E3      =   -15.667542321950
Exc     =   -13.908605286639
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 6.355e-06, dEband = 9.012e-04
rank = 0, Calculating/Estimating energy took 1.042 ms, Etot = -45.725210289, dEtot = 6.355e-06, dEband = 9.012e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0720746835031, which took 0.069 ms

iter_count = 108, r_2norm = 1.911e-06, tol*||rhs|| = 2.883e-06

Anderson update took 66.233 ms, out of which F'*F took 31.285 ms; b-Ax took 213.765 ms, out of which Lap took 190.429 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.440 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307922, int_b + int_rho = 3.638e-15, checking this took 0.102 ms
2-norm of RHS = 698.2255058425826, which took 0.068 ms

iter_count = 150, r_2norm = 5.893e-04, tol*||rhs|| = 6.982e-04

Anderson update took 92.637 ms, out of which F'*F took 44.146 ms; b-Ax took 296.660 ms, out of which Lap took 263.994 ms
Solving Poisson took 654.683 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.171867 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.393 ms
Total time for convolution: 	 convolve: 5.169928 
Total time for convolution: 	 convolve: 5.168116 
Total time for convolution: 	 convolve: 5.167337 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.581 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.035 ms
---Transfer Veff_loc: D2D took 4.325 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.017 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.376 ms

This SCF took 27553.343 ms, scf error = 1.904e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.137866, lowerbound = -0.953837, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1608.251 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.922 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.775 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.715 ms
rank =  0, finding HY took 25.213 ms
rank =  0, distributing HY into block cyclic form took 20.001 ms
rank =  0, finding Y'*HY took 3.788 ms
Rank 0, Project_Hamiltonian used 71.748 ms
Total time for projection: 71.758 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.213 ms
    first calculated eigval = -0.953708863216394
    last  calculated eigval = 0.038504533896281
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.80017161594520
lambda[   4] =  -0.54680802647189
lambda[   5] =  -0.48860294218534
lambda[   6] =  -0.47744581389032
lambda[   7] =  -0.41166830218935
lambda[   8] =  -0.37304708033994
lambda[   9] =  -0.35897066955529
lambda[  10] =  -0.23943891743587
lambda[  11] =  -0.23814235638094
lambda[  12] =  -0.21061136250731
lambda[  13] =  -0.03045597623852
lambda[  14] =  -0.00342179703499
lambda[  15] =   0.01714642190294
lambda[  16] =   0.02012319315112
lambda[  17] =   0.02352239971188
lambda[  18] =   0.03324031319872
lambda[  19] =   0.03850453389628
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 8.776 ms
rank =  0, Distributing orbital back into band + domain format took 19.729 ms
rank = 0, Subspace_Rotation used 28.520 ms

Total time for subspace rotation: 28.524 ms
rank = 0, Efermi =  -0.059493305298 calculate fermi energy took 0.141 ms
rank = 0, --- Calculate rho: sum over local bands took 6.763 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.559 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.583 ms
rank = 0, Calculating density took 1727.885 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.947 ms
rank = 0, D2D took 2.054 ms
rank = 0, Transfering density took 2.060 ms
Etot    =   -45.725238843264
Eband   =   -11.873201446729
E1      =    26.267508004519
E2      =   -11.441318567839
E3      =   -15.667607772269
Exc     =   -13.908667176004
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 3.569e-06, dEband = 4.126e-04
rank = 0, Calculating/Estimating energy took 1.035 ms, Etot = -45.725238843, dEtot = 3.569e-06, dEband = 4.126e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0463936110283, which took 0.069 ms

iter_count = 108, r_2norm = 1.525e-06, tol*||rhs|| = 1.856e-06

Anderson update took 66.971 ms, out of which F'*F took 31.587 ms; b-Ax took 212.529 ms, out of which Lap took 189.429 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.025 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307921, int_b + int_rho = -7.276e-15, checking this took 0.122 ms
2-norm of RHS = 698.2259652639794, which took 0.171 ms

iter_count = 144, r_2norm = 6.717e-04, tol*||rhs|| = 6.982e-04

Anderson update took 90.945 ms, out of which F'*F took 40.863 ms; b-Ax took 279.173 ms, out of which Lap took 247.413 ms
Solving Poisson took 627.641 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.162789 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.821 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.181704 
Total time for convolution: 	 convolve: 5.180320 
Total time for convolution: 	 convolve: 5.165419 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.690 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 3.484 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.407 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.926 ms

This SCF took 27552.289 ms, scf error = 1.657e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.138505, lowerbound = -0.953709, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1607.843 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.939 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.917 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.878 ms
rank =  0, finding HY took 25.143 ms
rank =  0, distributing HY into block cyclic form took 19.855 ms
rank =  0, finding Y'*HY took 3.876 ms
Rank 0, Project_Hamiltonian used 71.780 ms
Total time for projection: 71.790 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -0.953603551511674
    last  calculated eigval = 0.039283157759359
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.80004440596298
lambda[   4] =  -0.54668267871665
lambda[   5] =  -0.48847853307145
lambda[   6] =  -0.47731519665714
lambda[   7] =  -0.41154114025071
lambda[   8] =  -0.37293021618132
lambda[   9] =  -0.35886070640605
lambda[  10] =  -0.23932583166604
lambda[  11] =  -0.23801319389804
lambda[  12] =  -0.21050520896504
lambda[  13] =  -0.03010504078733
lambda[  14] =  -0.00318838747823
lambda[  15] =   0.01723019441943
lambda[  16] =   0.02041659052460
lambda[  17] =   0.02364353918863
lambda[  18] =   0.03445231760064
lambda[  19] =   0.03928315775936
==subpsace eigenproblem: bcast eigvals took 0.046 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 8.683 ms
rank =  0, Distributing orbital back into band + domain format took 19.149 ms
rank = 0, Subspace_Rotation used 27.845 ms

Total time for subspace rotation: 27.849 ms
rank = 0, Efermi =  -0.059142369912 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 6.770 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.563 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.572 ms
rank = 0, Calculating density took 1726.820 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.936 ms
rank = 0, D2D took 2.030 ms
rank = 0, Transfering density took 2.033 ms
Etot    =   -45.725269606812
Eband   =   -11.870337392239
E1      =    26.266158696132
E2      =   -11.439768618427
E3      =   -15.667666822584
Exc     =   -13.908721786557
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 3.845e-06, dEband = 3.580e-04
rank = 0, Calculating/Estimating energy took 1.758 ms, Etot = -45.725269607, dEtot = 3.845e-06, dEband = 3.580e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0359773350680, which took 0.060 ms

iter_count = 108, r_2norm = 1.286e-06, tol*||rhs|| = 1.439e-06

Anderson update took 66.970 ms, out of which F'*F took 31.489 ms; b-Ax took 212.926 ms, out of which Lap took 190.127 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 479.609 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307918, int_b + int_rho = -3.274e-14, checking this took 0.126 ms
2-norm of RHS = 698.2254439113294, which took 0.144 ms

iter_count = 126, r_2norm = 6.669e-04, tol*||rhs|| = 6.982e-04

Anderson update took 78.025 ms, out of which F'*F took 36.367 ms; b-Ax took 248.223 ms, out of which Lap took 219.480 ms
Solving Poisson took 547.266 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.162949 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.791 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.178580 
Total time for convolution: 	 convolve: 5.165852 
Total time for convolution: 	 convolve: 6.488526 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.776 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.739 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.522 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.046 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.603 ms

This SCF took 28800.817 ms, scf error = 1.448e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.139283, lowerbound = -0.953604, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1602.790 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.945 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.761 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.723 ms
rank =  0, finding HY took 25.155 ms
rank =  0, distributing HY into block cyclic form took 19.916 ms
rank =  0, finding Y'*HY took 3.888 ms
Rank 0, Project_Hamiltonian used 71.708 ms
Total time for projection: 71.720 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -0.953505616144970
    last  calculated eigval = 0.039535025874296
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.79995136209568
lambda[   4] =  -0.54659162408302
lambda[   5] =  -0.48838734534631
lambda[   6] =  -0.47722092101223
lambda[   7] =  -0.41144950706535
lambda[   8] =  -0.37283630967725
lambda[   9] =  -0.35875655720648
lambda[  10] =  -0.23922785921678
lambda[  11] =  -0.23792147440473
lambda[  12] =  -0.21040548943835
lambda[  13] =  -0.03006709507904
lambda[  14] =  -0.00329290927481
lambda[  15] =   0.01753198272237
lambda[  16] =   0.02028588304128
lambda[  17] =   0.02406798366838
lambda[  18] =   0.03488771965641
lambda[  19] =   0.03953502587430
==subpsace eigenproblem: bcast eigvals took 0.039 ms
Total time for solving subspace eigenvalue problem: 0.266 ms
rank =  0, subspace rotation using ScaLAPACK took 8.686 ms
rank =  0, Distributing orbital back into band + domain format took 19.042 ms
rank = 0, Subspace_Rotation used 27.738 ms

Total time for subspace rotation: 27.744 ms
rank = 0, Efermi =  -0.059104424112 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 6.814 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.714 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 1721.776 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 3.228 ms
rank = 0, D2D took 3.344 ms
rank = 0, Transfering density took 3.349 ms
Etot    =   -45.725284337789
Eband   =   -11.868056103856
E1      =    26.265030328971
E2      =   -11.438576381381
E3      =   -15.667782122827
Exc     =   -13.908812501953
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 1.841e-06, dEband = 2.852e-04
rank = 0, Calculating/Estimating energy took 1.304 ms, Etot = -45.725284338, dEtot = 1.841e-06, dEband = 2.852e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0325243224439, which took 0.054 ms

iter_count = 108, r_2norm = 1.109e-06, tol*||rhs|| = 1.301e-06

Anderson update took 66.935 ms, out of which F'*F took 31.857 ms; b-Ax took 213.683 ms, out of which Lap took 190.881 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.178 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307925, int_b + int_rho = 3.638e-14, checking this took 0.130 ms
2-norm of RHS = 698.2276300223049, which took 0.164 ms

iter_count = 126, r_2norm = 6.400e-04, tol*||rhs|| = 6.982e-04

Anderson update took 78.902 ms, out of which F'*F took 36.495 ms; b-Ax took 248.757 ms, out of which Lap took 219.937 ms
Solving Poisson took 553.290 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.161050 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 28.375 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.183701 
Total time for convolution: 	 convolve: 5.168662 
Total time for convolution: 	 convolve: 5.172127 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.778 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.629 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.500 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.067 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.599 ms

This SCF took 27502.052 ms, scf error = 1.246e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.139535, lowerbound = -0.953506, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1605.929 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.985 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.719 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.723 ms
rank =  0, finding HY took 25.179 ms
rank =  0, distributing HY into block cyclic form took 19.924 ms
rank =  0, finding Y'*HY took 3.802 ms
Rank 0, Project_Hamiltonian used 71.658 ms
Total time for projection: 71.670 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -0.953343572674154
    last  calculated eigval = 0.039893568092908
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.79981454296727
lambda[   4] =  -0.54645542048537
lambda[   5] =  -0.48824969804740
lambda[   6] =  -0.47708788199184
lambda[   7] =  -0.41131636985871
lambda[   8] =  -0.37268455249705
lambda[   9] =  -0.35859901221905
lambda[  10] =  -0.23908070356450
lambda[  11] =  -0.23779157477139
lambda[  12] =  -0.21025392413493
lambda[  13] =  -0.02987459711186
lambda[  14] =  -0.00318486450297
lambda[  15] =   0.01778310935676
lambda[  16] =   0.02044981756296
lambda[  17] =   0.02474582559163
lambda[  18] =   0.03574366151308
lambda[  19] =   0.03989356809291
==subpsace eigenproblem: bcast eigvals took 0.047 ms
Total time for solving subspace eigenvalue problem: 0.262 ms
rank =  0, subspace rotation using ScaLAPACK took 8.678 ms
rank =  0, Distributing orbital back into band + domain format took 19.156 ms
rank = 0, Subspace_Rotation used 27.845 ms

Total time for subspace rotation: 28.539 ms
rank = 0, Efermi =  -0.058911926169 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 7.249 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.558 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.239 ms
rank = 0, Calculating density took 1726.580 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.013 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.123 ms
rank = 0, D2D took 2.231 ms
rank = 0, Transfering density took 2.236 ms
Etot    =   -45.725298169998
Eband   =   -11.864611081056
E1      =    26.263379882690
E2      =   -11.436717162053
E3      =   -15.667982020101
Exc     =   -13.908961588627
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 1.729e-06, dEband = 4.306e-04
rank = 0, Calculating/Estimating energy took 1.008 ms, Etot = -45.725298170, dEtot = 1.729e-06, dEband = 4.306e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0268193587720, which took 0.056 ms

iter_count = 114, r_2norm = 6.623e-07, tol*||rhs|| = 1.073e-06

Anderson update took 70.177 ms, out of which F'*F took 32.768 ms; b-Ax took 223.832 ms, out of which Lap took 199.476 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 505.794 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307919, int_b + int_rho = -2.183e-14, checking this took 0.152 ms
2-norm of RHS = 698.2275730561436, which took 0.136 ms

iter_count = 84, r_2norm = 6.659e-04, tol*||rhs|| = 6.982e-04

Anderson update took 52.253 ms, out of which F'*F took 24.619 ms; b-Ax took 164.686 ms, out of which Lap took 146.605 ms
Solving Poisson took 369.234 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.160060 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.493 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.171956 
Total time for convolution: 	 convolve: 5.181298 
Total time for convolution: 	 convolve: 5.189126 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.772 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 3.539 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.033 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.606 ms

This SCF took 27367.364 ms, scf error = 1.144e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.139894, lowerbound = -0.953344, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1601.241 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.924 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.743 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.686 ms
rank =  0, finding HY took 26.579 ms
rank =  0, distributing HY into block cyclic form took 19.914 ms
rank =  0, finding Y'*HY took 3.829 ms
Rank 0, Project_Hamiltonian used 73.038 ms
Total time for projection: 73.051 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -0.953280927043952
    last  calculated eigval = 0.040052399805190
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.79975741226290
lambda[   4] =  -0.54639992268806
lambda[   5] =  -0.48819346663220
lambda[   6] =  -0.47703350496211
lambda[   7] =  -0.41126145558647
lambda[   8] =  -0.37262763729387
lambda[   9] =  -0.35854110124579
lambda[  10] =  -0.23902454608129
lambda[  11] =  -0.23773877295776
lambda[  12] =  -0.21019598532652
lambda[  13] =  -0.02976660399609
lambda[  14] =  -0.00316180570315
lambda[  15] =   0.01799458256943
lambda[  16] =   0.02048013438208
lambda[  17] =   0.02504862283254
lambda[  18] =   0.03605366132483
lambda[  19] =   0.04005239980519
==subpsace eigenproblem: bcast eigvals took 0.058 ms
Total time for solving subspace eigenvalue problem: 0.273 ms
rank =  0, subspace rotation using ScaLAPACK took 8.682 ms
rank =  0, Distributing orbital back into band + domain format took 19.429 ms
rank = 0, Subspace_Rotation used 28.127 ms

Total time for subspace rotation: 28.133 ms
rank = 0, Efermi =  -0.058803933066 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 6.852 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.605 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 1721.947 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.952 ms
rank = 0, D2D took 2.057 ms
rank = 0, Transfering density took 2.063 ms
Etot    =   -45.725297798595
Eband   =   -11.863247127606
E1      =    26.262648475030
E2      =   -11.436050895413
E3      =   -15.668125684143
Exc     =   -13.909071160416
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 4.643e-08, dEband = 1.705e-04
rank = 0, Calculating/Estimating energy took 1.024 ms, Etot = -45.725297799, dEtot = 4.643e-08, dEband = 1.705e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0235871449856, which took 0.128 ms

iter_count = 102, r_2norm = 9.068e-07, tol*||rhs|| = 9.435e-07

Anderson update took 63.300 ms, out of which F'*F took 30.619 ms; b-Ax took 203.258 ms, out of which Lap took 181.926 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.203 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307915, int_b + int_rho = -5.821e-14, checking this took 0.119 ms
2-norm of RHS = 698.2313487563969, which took 0.159 ms

iter_count = 150, r_2norm = 6.647e-04, tol*||rhs|| = 6.982e-04

Anderson update took 94.984 ms, out of which F'*F took 45.026 ms; b-Ax took 295.737 ms, out of which Lap took 262.419 ms
Solving Poisson took 658.200 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.172621 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.386 ms
Total time for convolution: 	 convolve: 5.168455 
Total time for convolution: 	 convolve: 5.178543 
Total time for convolution: 	 convolve: 5.162239 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.642 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.503 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.065 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.601 ms

This SCF took 27550.258 ms, scf error = 1.014e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.140052, lowerbound = -0.953281, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1605.201 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.916 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.767 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.701 ms
rank =  0, finding HY took 25.090 ms
rank =  0, distributing HY into block cyclic form took 20.046 ms
rank =  0, finding Y'*HY took 3.874 ms
Rank 0, Project_Hamiltonian used 71.749 ms
Total time for projection: 71.759 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -0.953249816971957
    last  calculated eigval = 0.040720444617443
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.79969304133386
lambda[   4] =  -0.54633472412416
lambda[   5] =  -0.48812591139553
lambda[   6] =  -0.47696259214677
lambda[   7] =  -0.41119186787729
lambda[   8] =  -0.37258332793357
lambda[   9] =  -0.35853439526982
lambda[  10] =  -0.23899831963071
lambda[  11] =  -0.23768619190204
lambda[  12] =  -0.21017829036917
lambda[  13] =  -0.03025628931440
lambda[  14] =  -0.00358730232811
lambda[  15] =   0.01817202649987
lambda[  16] =   0.02018331317100
lambda[  17] =   0.02680669746375
lambda[  18] =   0.03751437702516
lambda[  19] =   0.04072044461744
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 8.649 ms
rank =  0, Distributing orbital back into band + domain format took 19.554 ms
rank = 0, Subspace_Rotation used 28.218 ms

Total time for subspace rotation: 28.223 ms
rank = 0, Efermi =  -0.059293618371 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 6.683 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.434 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.578 ms
rank = 0, Calculating density took 1724.840 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.966 ms
rank = 0, D2D took 2.069 ms
rank = 0, Transfering density took 2.075 ms
Etot    =   -45.725314274406
Eband   =   -11.862109779022
E1      =    26.262217309710
E2      =   -11.435355806530
E3      =   -15.668001278818
Exc     =   -13.908974325284
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 2.059e-06, dEband = 1.422e-04
rank = 0, Calculating/Estimating energy took 1.031 ms, Etot = -45.725314274, dEtot = 2.059e-06, dEband = 1.422e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0244733667943, which took 0.056 ms

iter_count = 102, r_2norm = 8.600e-07, tol*||rhs|| = 9.789e-07

Anderson update took 63.797 ms, out of which F'*F took 30.554 ms; b-Ax took 205.305 ms, out of which Lap took 183.350 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.766 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307917, int_b + int_rho = -4.366e-14, checking this took 0.140 ms
2-norm of RHS = 698.2332525760402, which took 0.175 ms

iter_count = 84, r_2norm = 6.631e-04, tol*||rhs|| = 6.982e-04

Anderson update took 51.832 ms, out of which F'*F took 24.715 ms; b-Ax took 167.028 ms, out of which Lap took 148.482 ms
Solving Poisson took 370.318 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.166844 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.442 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.378 ms
Total time for convolution: 	 convolve: 5.161160 
Total time for convolution: 	 convolve: 5.180028 
Total time for convolution: 	 convolve: 5.180826 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.582 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.511 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.034 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.579 ms

This SCF took 27300.646 ms, scf error = 1.020e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.140720, lowerbound = -0.953250, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1609.185 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.703 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.639 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.368 ms
rank =  0, finding HY took 24.678 ms
rank =  0, distributing HY into block cyclic form took 20.201 ms
rank =  0, finding Y'*HY took 3.816 ms
Rank 0, Project_Hamiltonian used 72.087 ms
Total time for projection: 72.098 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.635 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.370 ms
rank = 0, Solve_Generalized_EigenProblem used 1.013 ms
    first calculated eigval = -0.953277960736762
    last  calculated eigval = 0.041145042164521
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.79970283543351
lambda[   4] =  -0.54634574990803
lambda[   5] =  -0.48813662471472
lambda[   6] =  -0.47696844968319
lambda[   7] =  -0.41119969322602
lambda[   8] =  -0.37260085448383
lambda[   9] =  -0.35855704668782
lambda[  10] =  -0.23901542297110
lambda[  11] =  -0.23769323253413
lambda[  12] =  -0.21019904809634
lambda[  13] =  -0.02995374318584
lambda[  14] =  -0.00352038028595
lambda[  15] =   0.01862964506662
lambda[  16] =   0.02039598816184
lambda[  17] =   0.02776754175008
lambda[  18] =   0.03832689673105
lambda[  19] =   0.04114504216452
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 1.034 ms
rank =  0, subspace rotation using ScaLAPACK took 8.628 ms
rank =  0, Distributing orbital back into band + domain format took 19.090 ms
rank = 0, Subspace_Rotation used 27.730 ms

Total time for subspace rotation: 27.735 ms
rank = 0, Efermi =  -0.058991072118 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 6.805 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.721 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 1730.042 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.952 ms
rank = 0, D2D took 2.056 ms
rank = 0, Transfering density took 2.062 ms
Etot    =   -45.725310925246
Eband   =   -11.862460977806
E1      =    26.262523950867
E2      =   -11.435428484736
E3      =   -15.667894654140
Exc     =   -13.908892472025
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 4.186e-07, dEband = 4.390e-05
rank = 0, Calculating/Estimating energy took 1.034 ms, Etot = -45.725310925, dEtot = 4.186e-07, dEband = 4.390e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0225837031946, which took 0.053 ms

iter_count = 102, r_2norm = 8.141e-07, tol*||rhs|| = 9.033e-07

Anderson update took 63.926 ms, out of which F'*F took 32.802 ms; b-Ax took 204.376 ms, out of which Lap took 183.528 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.998 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307920, int_b + int_rho = -1.455e-14, checking this took 0.149 ms
2-norm of RHS = 698.2322320243459, which took 0.150 ms

iter_count = 36, r_2norm = 5.986e-04, tol*||rhs|| = 6.982e-04

Anderson update took 22.956 ms, out of which F'*F took 10.365 ms; b-Ax took 69.986 ms, out of which Lap took 61.991 ms
Solving Poisson took 159.329 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.167831 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.160812 
Total time for convolution: 	 convolve: 5.167864 
Total time for convolution: 	 convolve: 5.185961 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 3.524 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.071 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.630 ms

This SCF took 27062.579 ms, scf error = 1.246e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.141145, lowerbound = -0.953278, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1606.357 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.953 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.753 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.901 ms
rank =  0, finding HY took 23.413 ms
rank =  0, distributing HY into block cyclic form took 19.886 ms
rank =  0, finding Y'*HY took 3.852 ms
Rank 0, Project_Hamiltonian used 74.078 ms
Total time for projection: 74.095 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -0.953261553284870
    last  calculated eigval = 0.040743476966179
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.79969501182856
lambda[   4] =  -0.54633722998718
lambda[   5] =  -0.48812818670799
lambda[   6] =  -0.47696249382911
lambda[   7] =  -0.41119264455182
lambda[   8] =  -0.37258947164570
lambda[   9] =  -0.35854421179881
lambda[  10] =  -0.23900489838353
lambda[  11] =  -0.23768667688620
lambda[  12] =  -0.21018708554907
lambda[  13] =  -0.03024566494456
lambda[  14] =  -0.00361526390316
lambda[  15] =   0.01813305250885
lambda[  16] =   0.02019357650308
lambda[  17] =   0.02710022607742
lambda[  18] =   0.03775731868216
lambda[  19] =   0.04074347696618
==subpsace eigenproblem: bcast eigvals took 0.061 ms
Total time for solving subspace eigenvalue problem: 0.275 ms
rank =  0, subspace rotation using ScaLAPACK took 8.634 ms
rank =  0, Distributing orbital back into band + domain format took 19.041 ms
rank = 0, Subspace_Rotation used 27.686 ms

Total time for subspace rotation: 27.691 ms
rank = 0, Efermi =  -0.059282994028 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 6.790 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.548 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.581 ms
rank = 0, Calculating density took 1727.499 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.961 ms
rank = 0, D2D took 2.065 ms
rank = 0, Transfering density took 2.071 ms
Etot    =   -45.725317142562
Eband   =   -11.862224093466
E1      =    26.262341055175
E2      =   -11.435361549372
E3      =   -15.667918958376
Exc     =   -13.908910046859
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 7.772e-07, dEband = 2.961e-05
rank = 0, Calculating/Estimating energy took 1.037 ms, Etot = -45.725317143, dEtot = 7.772e-07, dEband = 2.961e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0231117333041, which took 0.076 ms

iter_count = 102, r_2norm = 8.201e-07, tol*||rhs|| = 9.245e-07

Anderson update took 63.152 ms, out of which F'*F took 30.195 ms; b-Ax took 202.062 ms, out of which Lap took 180.684 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.089 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307924, int_b + int_rho = 2.910e-14, checking this took 0.104 ms
2-norm of RHS = 698.2313527241258, which took 0.181 ms

iter_count = 42, r_2norm = 6.507e-04, tol*||rhs|| = 6.982e-04

Anderson update took 26.223 ms, out of which F'*F took 12.255 ms; b-Ax took 82.475 ms, out of which Lap took 73.076 ms
Solving Poisson took 185.595 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.099 ms
Total time for convolution: 	 convolve: 5.166547 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.835 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.171702 
Total time for convolution: 	 convolve: 5.168196 
Total time for convolution: 	 convolve: 5.172379 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.511 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.032 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.577 ms

This SCF took 27108.467 ms, scf error = 1.125e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.140743, lowerbound = -0.953262, upperbound = 267.583823

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1607.703 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.009 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.762 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.790 ms
rank =  0, finding HY took 25.165 ms
rank =  0, distributing HY into block cyclic form took 20.526 ms
rank =  0, finding Y'*HY took 3.871 ms
Rank 0, Project_Hamiltonian used 72.381 ms
Total time for projection: 72.391 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -0.953243772166751
    last  calculated eigval = 0.040532376356891
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.79968413911759
lambda[   4] =  -0.54632657879003
lambda[   5] =  -0.48811758422554
lambda[   6] =  -0.47695388198488
lambda[   7] =  -0.41118312858572
lambda[   8] =  -0.37257677993778
lambda[   9] =  -0.35852864212346
lambda[  10] =  -0.23899217458248
lambda[  11] =  -0.23767737105023
lambda[  12] =  -0.21017255244635
lambda[  13] =  -0.03048103453742
lambda[  14] =  -0.00370533386880
lambda[  15] =   0.01776433134907
lambda[  16] =   0.02005320088880
lambda[  17] =   0.02682005677288
lambda[  18] =   0.03749935808687
lambda[  19] =   0.04053237635689
==subpsace eigenproblem: bcast eigvals took 0.035 ms
Total time for solving subspace eigenvalue problem: 0.257 ms
rank =  0, subspace rotation using ScaLAPACK took 8.634 ms
rank =  0, Distributing orbital back into band + domain format took 19.075 ms
rank = 0, Subspace_Rotation used 27.719 ms

Total time for subspace rotation: 27.724 ms
rank = 0, Efermi =  -0.059518363570 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 6.575 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.759 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1727.110 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.946 ms
rank = 0, D2D took 2.050 ms
rank = 0, Transfering density took 2.052 ms
Etot    =   -45.725318165608
Eband   =   -11.861931474072
E1      =    26.262127516750
E2      =   -11.435265188381
E3      =   -15.667983045688
Exc     =   -13.908957877197
Esc     =   -73.319804564468
Entropy =    -0.000000000690
dE = 1.279e-07, dEband = 3.658e-05
rank = 0, Calculating/Estimating energy took 1.030 ms, Etot = -45.725318166, dEtot = 1.279e-07, dEband = 3.658e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0244663117889, which took 0.063 ms

iter_count = 102, r_2norm = 8.234e-07, tol*||rhs|| = 9.787e-07

Anderson update took 62.996 ms, out of which F'*F took 30.403 ms; b-Ax took 203.147 ms, out of which Lap took 182.047 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.085 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002307921, int_rho =  24.00000002307915, int_b + int_rho = -6.185e-14, checking this took 0.122 ms
2-norm of RHS = 698.2295815747336, which took 0.114 ms

iter_count = 66, r_2norm = 6.323e-04, tol*||rhs|| = 6.982e-04

Anderson update took 40.726 ms, out of which F'*F took 18.809 ms; b-Ax took 132.610 ms, out of which Lap took 118.250 ms
Solving Poisson took 291.317 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.155339 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.222 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.169756 
Total time for convolution: 	 convolve: 5.161927 
Total time for convolution: 	 convolve: 5.168061 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.607 ms
---Transfer Veff_loc: D2D took 4.294 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.064 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.393 ms

This SCF took 27197.436 ms, scf error = 9.898e-05
The last 17 occupations of kpoints #1 are (Nelectron = 24):
lambda[   3] =  -0.79968413911759, occ[   3] =   2.00000000000000
lambda[   4] =  -0.54632657879003, occ[   4] =   2.00000000000000
lambda[   5] =  -0.48811758422554, occ[   5] =   2.00000000000000
lambda[   6] =  -0.47695388198488, occ[   6] =   2.00000000000000
lambda[   7] =  -0.41118312858572, occ[   7] =   2.00000000000000
lambda[   8] =  -0.37257677993778, occ[   8] =   2.00000000000000
lambda[   9] =  -0.35852864212346, occ[   9] =   2.00000000000000
lambda[  10] =  -0.23899217458248, occ[  10] =   2.00000000000000
lambda[  11] =  -0.23767737105023, occ[  11] =   2.00000000000000
lambda[  12] =  -0.21017255244635, occ[  12] =   2.00000000000000
lambda[  13] =  -0.03048103453742, occ[  13] =   0.00000002307921
lambda[  14] =  -0.00370533386880, occ[  14] =   0.00000000000000
lambda[  15] =   0.01776433134907, occ[  15] =   0.00000000000000
lambda[  16] =   0.02005320088880, occ[  16] =   0.00000000000000
lambda[  17] =   0.02682005677288, occ[  17] =   0.00000000000000
lambda[  18] =   0.03749935808687, occ[  18] =   0.00000000000000
lambda[  19] =   0.04053237635689, occ[  19] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 17 (90%) = 0.000000000000000.
Occupation of state 19 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.385 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.618 ms, time for Allreduce/Reduce: 8.948 ms 
Time for calculating local force components: 20.493 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000002718472   0.00000002889414  -1.21093611382491
 -0.01533210450864  -0.05382462911669  -0.03674830597954
 -0.03162054111721   0.00326284568798   0.05835506723030
  0.01533203514826   0.05382446431119  -0.03674817954355
  0.03162043743945  -0.00326283768100   0.05835487761666
  0.00000083231450   0.00000365139123  -0.04762766316074
  0.43199433071335  -0.08495014604560   0.10736130549310
 -0.43199030927023   0.08494962230764   0.10736077125739
force_loc = 
  0.00000006279609  -0.00000115583361   1.19346428377687
  0.01511456067985   0.05780084659709   0.03794068178489
  0.03211961582270  -0.00178096552883  -0.06298618278862
 -0.01511406042859  -0.05779980854604   0.03793987356402
 -0.03211882763254   0.00178076653115  -0.06298517742099
  0.00000086869389   0.00000103334457   0.03114837778128
 -0.42015890564113   0.08423293607807  -0.10468617371997
  0.42016819699711  -0.08423434076886  -0.10469076816625
Time for calculating nonlocal force components: 45.490 ms
[32mforces_xc: 
[0m[32m -0.00000000888343  -0.00000004261572   0.02950297910657
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000002809744   0.00000009490724   0.01057697163722
[0m[32m -0.01038876344747   0.00157537461988  -0.00196318093591
[0m[32m  0.01038908980081  -0.00157538518820  -0.00196335930698
[0mTime for calculating XC forces components: 25.729 ms
 Cartesian force = 
 -0.00000198949749  -0.00000146372340   0.01194738850843
 -0.00021961442366   0.00397592331219   0.00110861525524
  0.00049700411062   0.00148158599095  -0.00471487610842
  0.00021590412481  -0.00397563840305   0.00110793347036
 -0.00050046078795  -0.00148236531806  -0.00471406035444
 -0.00000034148903   0.00000448547483  -0.00598607429235
  0.00144459102988   0.00085787048416   0.00062819028711
 -0.00143509306718  -0.00086039781762   0.00062288323405
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.344 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
Time for printing density: 380.237 ms
The program took 620.388 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:35
Job ID:        2266597
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:06:24,vmem=8440K,walltime=00:10:32,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-27-1
---------------------------------------
